import{d as w,r as l,D as z,aH as E,a as b,aW as H,c as M,o as V,w as u,f as d,a7 as y,a8 as C,e as R,aX as T,h as B,N as D,aj as F}from"./index-CcvFQduD.js";import{f as k}from"./product-8zZM2lsj.js";const I={class:"flex-col-top size-full min-h-420px gap-24px overflow-hidden"},L=w({name:"personal-content_select-optimization",__name:"index",setup(j){const i=l(""),a=l(null),v=z(),o=E({pageNo:1,pageSize:50,total:51}),_=b(()=>v.isMobile?0:16),r=l([]),t=l([]),f=l(!1),m=async()=>{await k({search:i.value,pageNo:o.pageNo,pageSize:o.pageSize}).then(e=>{var n,c;console.log("res",e);const s=((n=e==null?void 0:e.data)==null?void 0:n.products.map(p=>({value:p.product_id,label:p.product_name})))??[];o.total=((c=e==null?void 0:e.data)==null?void 0:c.total)??0,t.value.push(...s)}).finally(()=>{})},h=()=>{if(a.value){console.log("loadMore判断依据,scrollHeight,scrollTop,clientHeight,阈值,total,pageNo,pageSize",a.value.scrollHeight,a.value.scrollTop,a.value.clientHeight,0,o.total,o.pageNo,o.pageSize);const e=a.value.scrollHeight<=a.value.clientHeight+a.value.scrollTop+0&&o.total>o.pageNo*o.pageSize;console.log("加载更多 loadMore:",e),e&&(o.pageNo+=1,m())}},g=()=>{a.value=document.querySelector(".selectRef .el-select-dropdown__list"),console.log("element.value",a.value),a.value&&a.value.addEventListener("scroll",h)},x=H(async e=>{console.log("query",e),i.value=e,o.pageNo=1,o.pageSize=50,t.value.splice(0,t.value.length),m(),setTimeout(()=>{g()},2e3)},500);return(e,s)=>{const n=T,c=C,p=y,S=D;return V(),M(S,{class:"card-wrapper"},{default:u(()=>[d(p,{gutter:_.value,class:"px-8px"},{default:u(()=>[d(c,{md:18,sm:24},{default:u(()=>[R("div",I,[d(n,{modelValue:r.value,"onUpdate:modelValue":s[0]||(s[0]=N=>r.value=N),"popper-class":"selectRef",class:"m-6","popper-append-to-body":!1,multiple:"",filterable:"",remote:"","collapse-tags":"","max-collapse-tags":3,"remote-method":B(x),clearable:"",options:t.value,loading:f.value,placeholder:"请输入关键字再选择",style:{width:"240px"},onFocus:g},null,8,["modelValue","remote-method","options","loading"])])]),_:1})]),_:1},8,["gutter"])]),_:1})}}}),O=F(L,[["__scopeId","data-v-e4b3570c"]]);export{O as default};
