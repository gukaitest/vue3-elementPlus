import{_ as Jt}from"./web-site-link.vue_vue_type_script_setup_true_lang-DGBv_I_A.js";import{G as A,c as q,a as Ve,S as Mt,T as he,b as ei,I as Ze,C as Wt,L as ti,i as ii,B as si,d as ai,e as ni,P as ri,v as Re,f as oi,g as li,h as di,D as Xe,j as At,k as hi}from"./index-A-iWJHs4.js";import{i as G}from"./linear-scale-C88aT2VD.js";import{d as ci,G as pi,aE as Pe,Z as ui,i as gi,al as _i,c as bi,o as vi,w as Ge,f as je,N as mi,e as Bt,s as yi}from"./index-C6tnI6Xh.js";import"./get-Dx-ARM-V.js";import"./isSymbol-Dzdcm9yF.js";import"./index-CH7TBCPE.js";var P;(function(s){s.default="default",s.grabing="grabing",s.scrolling="scrolling"})(P||(P={}));var Y;(function(s){s.FinishToStart="finish_to_start",s.StartToStart="start_to_start",s.FinishToFinish="finish_to_finish",s.StartToFinish="start_to_finish"})(Y||(Y={}));var T;(function(s){s.Tasks_Separate="tasks_separate",s.Sub_Tasks_Inline="sub_tasks_inline",s.Sub_Tasks_Separate="sub_tasks_separate",s.Sub_Tasks_Arrange="sub_tasks_arrange",s.Sub_Tasks_Compact="sub_tasks_compact"})(T||(T={}));const I={SCROLL:"scroll",CHANGE_DATE_RANGE:"change_date_range",CLICK_TASK_BAR:"click_task_bar",CONTEXTMENU_TASK_BAR:"contextmenu_task_bar",MOUSEENTER_TASK_BAR:"mouseenter_task_bar",MOUSELEAVE_TASK_BAR:"mouseleave_task_bar",CREATE_TASK_SCHEDULE:"create_task_schedule",CREATE_DEPENDENCY_LINK:"create_dependency_link",DELETE_DEPENDENCY_LINK:"delete_dependency_link",CLICK_DEPENDENCY_LINK_POINT:"click_dependency_link_point",CONTEXTMENU_DEPENDENCY_LINK:"contextmenu_dependency_link"},Ct={barColor:"blue",completedBarColor:"gray",width:30,cornerRadius:3,borderWidth:0,fontFamily:"Arial",fontSize:14};function ki(s){Ct.width=s}const fi=typeof window>"u"||window.window===void 0,Si=864e5;function Fe(s,e){const t=s+e.stateManager.scroll.horizontalBarPos,i=e.getDateColWidth(0);return Math.floor((t-i)/e.parsedOptions.timelineColWidth)+1}function Dt(s){var e,t,i,a,n;return s?s===!0?[{date:j().toLocaleDateString(),scrollToMarkLine:!0,position:"left",style:{lineColor:"red",lineWidth:1}}]:Array.isArray(s)?s.map((r,l)=>{var o,h,d,c;return{date:r.date,scrollToMarkLine:r.scrollToMarkLine,position:(o=r.position)!==null&&o!==void 0?o:"left",style:{lineColor:((h=r.style)===null||h===void 0?void 0:h.lineColor)||"red",lineWidth:((d=r.style)===null||d===void 0?void 0:d.lineWidth)||1,lineDash:(c=r.style)===null||c===void 0?void 0:c.lineDash}}}):[{date:s.date,scrollToMarkLine:(e=s.scrollToMarkLine)===null||e===void 0||e,position:(t=s.position)!==null&&t!==void 0?t:"left",style:{lineColor:((i=s.style)===null||i===void 0?void 0:i.lineColor)||"red",lineWidth:((a=s.style)===null||a===void 0?void 0:a.lineWidth)||1,lineDash:(n=s.style)===null||n===void 0?void 0:n.lineDash}}]:[]}function Li(s){var e;return s!=null&&s.hoverOn||s!=null&&s.horizontalVisible&&(s==null?void 0:s.horizontalVisible)==="none"||!(s!=null&&s.horizontalVisible)&&(s==null?void 0:s.visible)==="none"?0:(e=s==null?void 0:s.width)!==null&&e!==void 0?e:7}function Ti(s){var e;return s!=null&&s.hoverOn||s!=null&&s.verticalVisible&&(s==null?void 0:s.verticalVisible)==="none"||!(s!=null&&s.verticalVisible)&&(s==null?void 0:s.visible)==="none"?0:(e=s==null?void 0:s.width)!==null&&e!==void 0?e:7}function zt(s){var e,t,i,a,n,r,l,o,h,d,c,p,u,g,_,b,S,y,v,L,k,f,x,C,w,O,B,D,M,N,X,E,R,$,K,V,ae,ne,re,oe,le,ee,Z,pe,ue,ge,_e,be,ve,me,ye,ke,fe,Se,Le,Te,xe,Be,we,Oe,Ce,De,He,Me,We,Ae,H,Ne,W,U,de,Q,Ie,tt,it,st,at,nt,rt,ot,lt,dt,ht,ct,pt,ut,gt,_t,bt,vt,mt,yt,kt,ft,St,Lt,Tt;const m=s.options;s.parsedOptions.tasksShowMode=(e=m==null?void 0:m.tasksShowMode)!==null&&e!==void 0?e:T.Tasks_Separate,s.parsedOptions.pixelRatio=(t=m==null?void 0:m.pixelRatio)!==null&&t!==void 0?t:1,s.parsedOptions.rowHeight=(i=m==null?void 0:m.rowHeight)!==null&&i!==void 0?i:40,s.parsedOptions.timelineColWidth=(n=(a=m==null?void 0:m.timelineHeader)===null||a===void 0?void 0:a.colWidth)!==null&&n!==void 0?n:60,s.parsedOptions.startDateField=(l=(r=m.taskBar)===null||r===void 0?void 0:r.startDateField)!==null&&l!==void 0?l:"startDate",s.parsedOptions.endDateField=(h=(o=m.taskBar)===null||o===void 0?void 0:o.endDateField)!==null&&h!==void 0?h:"endDate",s.parsedOptions.progressField=(c=(d=m.taskBar)===null||d===void 0?void 0:d.progressField)!==null&&c!==void 0?c:"progress";const{unit:xt,startOfWeek:Ht,step:Zt}=s.parsedOptions.reverseSortedTimelineScales[0];s.parsedOptions.minDate=m!=null&&m.minDate?ze(new Date(m.minDate),xt,Ht):void 0,s.parsedOptions.maxDate=m!=null&&m.maxDate?Ke(s.parsedOptions.minDate,new Date(m.maxDate),xt,Zt):void 0,s.parsedOptions._minDateTime=(p=s.parsedOptions.minDate)===null||p===void 0?void 0:p.getTime(),s.parsedOptions._maxDateTime=(u=s.parsedOptions.maxDate)===null||u===void 0?void 0:u.getTime(),s.parsedOptions.overscrollBehavior=(g=m==null?void 0:m.overscrollBehavior)!==null&&g!==void 0?g:"auto",s.parsedOptions.underlayBackgroundColor=(_=m==null?void 0:m.underlayBackgroundColor)!==null&&_!==void 0?_:"#FFF",s.parsedOptions.scrollStyle=Object.assign({},{scrollRailColor:"rgba(100, 100, 100, 0.2)",scrollSliderColor:"rgba(100, 100, 100, 0.5)",scrollSliderCornerRadius:4,width:10,visible:"always",hoverOn:!0,barToSide:!1},m==null?void 0:m.scrollStyle),s.parsedOptions.timelineHeaderHorizontalLineStyle=(b=m==null?void 0:m.timelineHeader)===null||b===void 0?void 0:b.horizontalLine,s.parsedOptions.timelineHeaderVerticalLineStyle=(S=m==null?void 0:m.timelineHeader)===null||S===void 0?void 0:S.verticalLine,s.parsedOptions.timelineHeaderBackgroundColor=(y=m==null?void 0:m.timelineHeader)===null||y===void 0?void 0:y.backgroundColor,s.parsedOptions.timeLineHeaderRowHeights=[],s.parsedOptions.timelineHeaderStyles=[];for(let te=0;(v=te<s.parsedOptions.sortedTimelineScales.length)!==null&&v!==void 0&&v;te++){const Qt=s.parsedOptions.sortedTimelineScales[te].style;s.parsedOptions.timelineHeaderStyles.push(Object.assign({fontSize:20,fontWeight:"bold",textAlign:"center",textBaseline:"middle",color:"#000",backgroundColor:"#fff"},Qt)),s.parsedOptions.timeLineHeaderRowHeights.push((k=(L=s.parsedOptions.sortedTimelineScales[te].rowHeight)!==null&&L!==void 0?L:m==null?void 0:m.headerRowHeight)!==null&&k!==void 0?k:40)}s.parsedOptions.grid=Object.assign({},m==null?void 0:m.grid),ki(3*s.parsedOptions.rowHeight/4),s.parsedOptions.taskBarStyle=!((f=m==null?void 0:m.taskBar)===null||f===void 0)&&f.barStyle&&typeof((x=m==null?void 0:m.taskBar)===null||x===void 0?void 0:x.barStyle)=="function"?m.taskBar.barStyle:Object.assign({},Ct,(C=m==null?void 0:m.taskBar)===null||C===void 0?void 0:C.barStyle),s.parsedOptions.taskBarMilestoneStyle=Object.assign(typeof s.parsedOptions.taskBarStyle=="function"?{}:{width:s.parsedOptions.taskBarStyle.width,borderColor:s.parsedOptions.taskBarStyle.borderColor,borderLineWidth:(w=s.parsedOptions.taskBarStyle.borderLineWidth)!==null&&w!==void 0?w:1,fillColor:s.parsedOptions.taskBarStyle.barColor,cornerRadius:0},(O=m==null?void 0:m.taskBar)===null||O===void 0?void 0:O.milestoneStyle),s.parsedOptions.taskBarMilestoneHypotenuse=s.parsedOptions.taskBarMilestoneStyle.width*Math.sqrt(2),s.parsedOptions.dateFormat=m==null?void 0:m.dateFormat,s.parsedOptions.taskBarHoverStyle=Object.assign({barOverlayColor:"rgba(99, 144, 0, 0.4)"},(B=m==null?void 0:m.taskBar)===null||B===void 0?void 0:B.hoverBarStyle),s.parsedOptions.taskBarSelectable=(M=(D=m==null?void 0:m.taskBar)===null||D===void 0?void 0:D.selectable)===null||M===void 0||M,s.parsedOptions.taskBarSelectedStyle=Object.assign(typeof s.parsedOptions.taskBarStyle=="function"?{shadowBlur:6,shadowOffsetX:0,shadowOffsetY:0,borderLineWidth:1}:{shadowBlur:6,shadowOffsetX:0,shadowOffsetY:0,shadowColor:s.parsedOptions.taskBarStyle.barColor,borderColor:s.parsedOptions.taskBarStyle.barColor,borderLineWidth:1},(N=m==null?void 0:m.taskBar)===null||N===void 0?void 0:N.selectedBarStyle),s.parsedOptions.taskBarLabelText=(E=(X=m==null?void 0:m.taskBar)===null||X===void 0?void 0:X.labelText)!==null&&E!==void 0?E:"",s.parsedOptions.taskBarMoveable=($=(R=m==null?void 0:m.taskBar)===null||R===void 0?void 0:R.moveable)===null||$===void 0||$,s.parsedOptions.moveTaskBarToExtendDateRange=(V=(K=m==null?void 0:m.taskBar)===null||K===void 0?void 0:K.moveToExtendDateRange)===null||V===void 0||V,s.parsedOptions.taskBarResizable=(ne=(ae=m==null?void 0:m.taskBar)===null||ae===void 0?void 0:ae.resizable)===null||ne===void 0||ne,s.parsedOptions.taskBarDragOrder=(oe=(re=m==null?void 0:m.taskBar)===null||re===void 0?void 0:re.dragOrder)===null||oe===void 0||oe,s.parsedOptions.taskBarLabelStyle={fontFamily:(Z=(ee=(le=m==null?void 0:m.taskBar)===null||le===void 0?void 0:le.labelTextStyle)===null||ee===void 0?void 0:ee.fontFamily)!==null&&Z!==void 0?Z:"Arial",fontSize:(ge=(ue=(pe=m==null?void 0:m.taskBar)===null||pe===void 0?void 0:pe.labelTextStyle)===null||ue===void 0?void 0:ue.fontSize)!==null&&ge!==void 0?ge:20,color:(ve=(be=(_e=m==null?void 0:m.taskBar)===null||_e===void 0?void 0:_e.labelTextStyle)===null||be===void 0?void 0:be.color)!==null&&ve!==void 0?ve:"#F01",textAlign:(ke=(ye=(me=m==null?void 0:m.taskBar)===null||me===void 0?void 0:me.labelTextStyle)===null||ye===void 0?void 0:ye.textAlign)!==null&&ke!==void 0?ke:"left",textBaseline:(Le=(Se=(fe=m==null?void 0:m.taskBar)===null||fe===void 0?void 0:fe.labelTextStyle)===null||Se===void 0?void 0:Se.textBaseline)!==null&&Le!==void 0?Le:"middle",padding:(Be=(xe=(Te=m==null?void 0:m.taskBar)===null||Te===void 0?void 0:Te.labelTextStyle)===null||xe===void 0?void 0:xe.padding)!==null&&Be!==void 0?Be:[0,0,0,10],textOverflow:(Oe=(we=m==null?void 0:m.taskBar)===null||we===void 0?void 0:we.labelTextStyle)===null||Oe===void 0?void 0:Oe.textOverflow},s.parsedOptions.taskBarCustomLayout=(Ce=m==null?void 0:m.taskBar)===null||Ce===void 0?void 0:Ce.customLayout,s.parsedOptions.taskBarCreatable=(He=(De=m==null?void 0:m.taskBar)===null||De===void 0?void 0:De.scheduleCreatable)!==null&&He!==void 0?He:!(s.parsedOptions.tasksShowMode!==T.Sub_Tasks_Separate&&s.parsedOptions.tasksShowMode!==T.Tasks_Separate),s.parsedOptions.taskBarCreationButtonStyle=Object.assign({lineColor:"rgb(99, 144, 0)",lineWidth:1,lineDash:[5,5],cornerRadius:4,backgroundColor:"#FFF"},(We=(Me=m==null?void 0:m.taskBar)===null||Me===void 0?void 0:Me.scheduleCreation)===null||We===void 0?void 0:We.buttonStyle),s.parsedOptions.taskBarCreationCustomLayout=(H=(Ae=m==null?void 0:m.taskBar)===null||Ae===void 0?void 0:Ae.scheduleCreation)===null||H===void 0?void 0:H.customLayout,s.parsedOptions.taskBarCreationMaxWidth=(W=(Ne=m==null?void 0:m.taskBar)===null||Ne===void 0?void 0:Ne.scheduleCreation)===null||W===void 0?void 0:W.maxWidth,s.parsedOptions.taskBarCreationMinWidth=(de=(U=m==null?void 0:m.taskBar)===null||U===void 0?void 0:U.scheduleCreation)===null||de===void 0?void 0:de.minWidth,s.parsedOptions.outerFrameStyle=Object.assign({borderColor:"#e1e4e8",borderLineWidth:1,cornerRadius:4},(Q=m.frame)===null||Q===void 0?void 0:Q.outerFrameStyle),s.parsedOptions.markLine=Dt(m==null?void 0:m.markLine),(tt=(Ie=s.parsedOptions.markLine)===null||Ie===void 0?void 0:Ie.length)!==null&&tt!==void 0&&tt&&(!((it=s.parsedOptions.markLine)===null||it===void 0)&&it.every(te=>te.scrollToMarkLine===void 0)&&(s.parsedOptions.markLine[0].scrollToMarkLine=!0),!((st=s.parsedOptions.markLine)===null||st===void 0)&&st.find(te=>te.scrollToMarkLine)&&(s.parsedOptions.scrollToMarkLineDate=ze(new Date((at=s.parsedOptions.markLine)===null||at===void 0?void 0:at.find(te=>te.scrollToMarkLine).date),xt,Ht))),s.parsedOptions.verticalSplitLineHighlight=(nt=m.frame)===null||nt===void 0?void 0:nt.verticalSplitLineHighlight,s.parsedOptions.verticalSplitLine=Object.assign({lineColor:(rt=s.parsedOptions.outerFrameStyle)===null||rt===void 0?void 0:rt.borderColor,lineWidth:(ot=s.parsedOptions.outerFrameStyle)===null||ot===void 0?void 0:ot.borderLineWidth},(lt=m.frame)===null||lt===void 0?void 0:lt.verticalSplitLine),s.parsedOptions.horizontalSplitLine=(dt=m.frame)===null||dt===void 0?void 0:dt.horizontalSplitLine,s.parsedOptions.verticalSplitLineMoveable=(ht=m.frame)===null||ht===void 0?void 0:ht.verticalSplitLineMoveable,s.parsedOptions.taskKeyField=(ct=m.taskKeyField)!==null&&ct!==void 0?ct:"id",s.parsedOptions.dependencyLinks=(ut=(pt=m.dependency)===null||pt===void 0?void 0:pt.links)!==null&&ut!==void 0?ut:[],s.parsedOptions.dependencyLinkCreatable=(_t=(gt=m.dependency)===null||gt===void 0?void 0:gt.linkCreatable)!==null&&_t!==void 0&&_t,s.parsedOptions.dependencyLinkSelectable=(vt=(bt=m.dependency)===null||bt===void 0?void 0:bt.linkSelectable)===null||vt===void 0||vt,s.parsedOptions.dependencyLinkDeletable=(yt=(mt=m.dependency)===null||mt===void 0?void 0:mt.linkDeletable)!==null&&yt!==void 0&&yt,s.parsedOptions.dependencyLinkLineStyle=Object.assign({lineColor:"red",lineWidth:1},(kt=m.dependency)===null||kt===void 0?void 0:kt.linkLineStyle),s.parsedOptions.dependencyLinkSelectedLineStyle=Object.assign({shadowBlur:4,shadowOffset:0,shadowColor:s.parsedOptions.dependencyLinkLineStyle.lineColor,lineColor:s.parsedOptions.dependencyLinkLineStyle.lineColor,lineWidth:s.parsedOptions.dependencyLinkLineStyle.lineWidth},(ft=m==null?void 0:m.dependency)===null||ft===void 0?void 0:ft.linkSelectedLineStyle),s.parsedOptions.dependencyLinkLineCreatePointStyle=Object.assign({strokeColor:"red",fillColor:"white",radius:5,strokeWidth:1},(St=m==null?void 0:m.dependency)===null||St===void 0?void 0:St.linkCreatePointStyle),s.parsedOptions.dependencyLinkLineCreatingPointStyle=Object.assign({strokeColor:"red",fillColor:"red",radius:5,strokeWidth:1},(Lt=m==null?void 0:m.dependency)===null||Lt===void 0?void 0:Lt.linkCreatingPointStyle),s.parsedOptions.dependencyLinkLineCreatingStyle=Object.assign({lineColor:"red",lineWidth:1,lineDash:[5,5]},(Tt=m==null?void 0:m.dependency)===null||Tt===void 0?void 0:Tt.linkCreatingLineStyle),s.parsedOptions.eventOptions=m==null?void 0:m.eventOptions,s.parsedOptions.keyboardOptions=m==null?void 0:m.keyboardOptions}function xi(s){var e,t,i,a,n;const r=s.options,{unit:l,startOfWeek:o,step:h}=s.parsedOptions.reverseSortedTimelineScales[0];s.parsedOptions.minDate=ze(new Date(s.parsedOptions.minDate),l,o),s.parsedOptions.maxDate=Ke(s.parsedOptions.minDate,new Date(s.parsedOptions.maxDate),l,h),s.parsedOptions._minDateTime=(e=s.parsedOptions.minDate)===null||e===void 0?void 0:e.getTime(),s.parsedOptions._maxDateTime=(t=s.parsedOptions.maxDate)===null||t===void 0?void 0:t.getTime(),s.parsedOptions.timeLineHeaderRowHeights=[],s.parsedOptions.timelineHeaderStyles=[];for(let d=0;(i=d<s.parsedOptions.sortedTimelineScales.length)!==null&&i!==void 0&&i;d++){const c=s.parsedOptions.sortedTimelineScales[d].style;s.parsedOptions.timelineHeaderStyles.push(Object.assign({fontSize:20,fontWeight:"bold",textAlign:"center",textBaseline:"middle",color:"#000",backgroundColor:"#fff"},c)),s.parsedOptions.timeLineHeaderRowHeights.push((n=(a=s.parsedOptions.sortedTimelineScales[d].rowHeight)!==null&&a!==void 0?a:r==null?void 0:r.headerRowHeight)!==null&&n!==void 0?n:40)}}function Bi(s,e,t){var i;const{unit:a,step:n,format:r}=t,l=[];for(;s<e;)if(a==="day"){const o=s.getFullYear(),h=s.getMonth(),d=s.getDate(),c=ce(new Date(o,h,d+n-1),!0);c.getTime()>e.getTime()&&c.setTime(e.getTime());const p=s,u=(r==null?void 0:r({dateIndex:d,startDate:p,endDate:c}))||d.toString(),g={days:Math.abs(c.getTime()-s.getTime()+1)/864e5,startDate:p,endDate:c,step:n,unit:"day",title:u,dateIndex:d};l.push(g),s=new Date(o,h,d+n)}else if(a==="month"){const o=s.getFullYear(),h=s.getMonth(),d=ce(new Date(o,h+n,0),!0);d.getTime()>e.getTime()&&d.setTime(e.getTime());const c=s,p=(r==null?void 0:r({dateIndex:h+1,startDate:c,endDate:d}))||(h+1).toString(),u={days:Math.abs(d.getTime()-s.getTime()+1)/864e5,startDate:c,step:n,unit:"month",endDate:d,title:p,dateIndex:h+1};l.push(u),s=new Date(o,h+n,1)}else if(a==="quarter"){const o=s.getFullYear(),h=Math.floor(s.getMonth()/3),d=ce(new Date(o,3*(h+n),0),!0);d.getTime()>e.getTime()&&d.setTime(e.getTime());const c=s,p=(r==null?void 0:r({dateIndex:h+1,startDate:c,endDate:d}))||(h+1).toString(),u={days:Math.abs(d.getTime()-s.getTime()+1)/864e5,startDate:c,step:n,unit:"quarter",endDate:d,title:p,dateIndex:h+1};l.push(u),s=new Date(o,3*(h+n),1)}else if(a==="year"){const o=s.getFullYear(),h=ce(new Date(o+n-1,11,31),!0);h.getTime()>e.getTime()&&h.setTime(e.getTime());const d=s,c=(r==null?void 0:r({dateIndex:o,startDate:d,endDate:h}))||o.toString(),p={days:Math.abs(h.getTime()-s.getTime()+1)/864e5,startDate:d,endDate:h,step:n,unit:"year",title:c,dateIndex:o};l.push(p),s=new Date(o+n,0,1)}else if(a==="week"){const o=(i=t.startOfWeek)!==null&&i!==void 0?i:"monday";let h=s.getDay();o==="monday"&&(h=h===0?6:h-1);const d=j(s),c=ce(s.getTime()+24*(7*n-h)*60*60*1e3-1,!0);c>e&&c.setTime(e.getTime());const p=Ei(d),u=(r==null?void 0:r({dateIndex:p,startDate:d,endDate:c}))||p.toString(),g={days:(c.getTime()-d.getTime()+1)/864e5,startDate:d,endDate:c,step:n,unit:"week",title:u,dateIndex:p};l.push(g),s.setTime(j(s.getTime()+24*(7*n-h)*60*60*1e3,!0).getTime())}else if(a==="hour"){const o=s.getFullYear(),h=s.getMonth(),d=s.getDate(),c=s.getHours(),p=Ni(new Date(o,h,d,c+n-1),!0);p.getTime()>e.getTime()&&p.setTime(e.getTime());const u=s,g=(r==null?void 0:r({dateIndex:c,startDate:u,endDate:p}))||c.toString(),_={days:Math.abs(p.getTime()-s.getTime()+1)/864e5,startDate:u,endDate:p,step:n,unit:"hour",title:g,dateIndex:s.getHours()};l.push(_),s=new Date(o,h,d,c+n)}else if(a==="minute"){const o=s.getFullYear(),h=s.getMonth(),d=s.getDate(),c=s.getHours(),p=s.getMinutes(),u=Gi(new Date(o,h,d,c,p+n-1),!0);u.getTime()>e.getTime()&&u.setTime(e.getTime());const g=s,_=(r==null?void 0:r({dateIndex:p,startDate:g,endDate:u}))||p.toString(),b={days:Math.abs(u.getTime()-s.getTime()+1)/864e5,startDate:g,endDate:u,step:n,unit:"minute",title:_,dateIndex:s.getMinutes()};l.push(b),s=new Date(o,h,d,c,p+n)}else if(a==="second"){const o=s.getFullYear(),h=s.getMonth(),d=s.getDate(),c=s.getHours(),p=s.getMinutes(),u=s.getSeconds(),g=Xt(new Date(o,h,d,c,p,u+n-1),!0);g.getTime()>e.getTime()&&g.setTime(e.getTime());const _=s,b=(r==null?void 0:r({dateIndex:u,startDate:_,endDate:g}))||u.toString(),S={days:Math.abs(g.getTime()-s.getTime()+1)/864e5,startDate:_,endDate:g,step:n,unit:"second",title:b,dateIndex:s.getSeconds()};l.push(S),s=new Date(o,h,d,c,p,u+n)}return l}function Je(s,e,t,i,a){var n,r,l,o,h,d,c,p,u;let g=(n=s[3])!==null&&n!==void 0?n:10;e==="right"||e==="end"?g=i-0-((r=s[1])!==null&&r!==void 0?r:10):e==="center"&&(g=0+(i-0+((l=s[3])!==null&&l!==void 0?l:10)-((o=s[1])!==null&&o!==void 0?o:10))/2);let _=0+((h=s[0])!==null&&h!==void 0?h:10);return t==="bottom"||t==="alphabetic"||t==="ideographic"?_=a-0-((d=s[2])!==null&&d!==void 0?d:10):t==="middle"&&(_=0+(a-0-((c=s[0])!==null&&c!==void 0?c:10)-((p=s[2])!==null&&p!==void 0?p:10))/2+((u=s[0])!==null&&u!==void 0?u:10)),{x:g,y:_}}function wi(s){return typeof s=="string"&&(s=s.replace("%",""),s=parseFloat(s)),Math.round(s)}function Oi(s){var e,t;if(s.taskListTableInstance){s.verticalSplitResizeLine=document.createElement("div"),s.verticalSplitResizeLine.style.position="absolute",s.verticalSplitResizeLine.style.top=s.tableY+"px",s.verticalSplitResizeLine.style.left=(s.taskTableWidth?s.taskTableWidth-7+s.parsedOptions.verticalSplitLine.lineWidth/2:0)+"px",s.verticalSplitResizeLine.style.width="14px",s.verticalSplitResizeLine.style.height=s.drawHeight+"px",s.verticalSplitResizeLine.style.backgroundColor="rgba(0,0,0,0)",s.verticalSplitResizeLine.style.zIndex="100",s.parsedOptions.verticalSplitLineMoveable&&(s.verticalSplitResizeLine.style.cursor="col-resize"),s.verticalSplitResizeLine.style.userSelect="none",s.verticalSplitResizeLine.style.opacity="1";const i=document.createElement("div");if(i.style.position="absolute",i.style.top="0px",i.style.left=(14-s.parsedOptions.verticalSplitLine.lineWidth)/2+"px",i.style.width=s.parsedOptions.verticalSplitLine.lineWidth+"px",i.style.height="100%",i.style.backgroundColor=s.parsedOptions.verticalSplitLine.lineColor,i.style.zIndex="100",i.style.userSelect="none",i.style.pointerEvents="none",i.style.transition="background-color 0.3s",s.verticalSplitResizeLine.appendChild(i),s.parsedOptions.verticalSplitLineHighlight){const a=document.createElement("div");a.style.position="absolute",a.style.top="0px",a.style.left=((e=14-s.parsedOptions.verticalSplitLineHighlight.lineWidth)!==null&&e!==void 0?e:2)/2+"px",a.style.width=((t=s.parsedOptions.verticalSplitLineHighlight.lineWidth)!==null&&t!==void 0?t:2)+"px",a.style.height="100%",a.style.backgroundColor=s.parsedOptions.verticalSplitLineHighlight.lineColor,a.style.zIndex="100",a.style.cursor="col-resize",a.style.userSelect="none",a.style.pointerEvents="none",a.style.opacity="0",a.style.transition="background-color 0.3s",s.verticalSplitResizeLine.appendChild(a)}s.container.appendChild(s.verticalSplitResizeLine)}}function qe(s){var e,t;if(s.verticalSplitResizeLine){s.verticalSplitResizeLine.style.position="absolute",s.verticalSplitResizeLine.style.top=s.tableY+"px",s.verticalSplitResizeLine.style.left=s.taskTableWidth?s.taskTableWidth-7+s.parsedOptions.verticalSplitLine.lineWidth/2+"px":"0px",s.verticalSplitResizeLine.style.width="14px",s.verticalSplitResizeLine.style.height=s.drawHeight+"px",s.verticalSplitResizeLine.style.backgroundColor="rgba(0,0,0,0)",s.verticalSplitResizeLine.style.zIndex="100",s.parsedOptions.verticalSplitLineMoveable&&(s.verticalSplitResizeLine.style.cursor="col-resize"),s.verticalSplitResizeLine.style.userSelect="none",s.verticalSplitResizeLine.style.opacity="1";const i=s.verticalSplitResizeLine.childNodes[0];if(i.style.position="absolute",i.style.top="0px",i.style.left=(14-s.parsedOptions.verticalSplitLine.lineWidth)/2+"px",i.style.width=s.parsedOptions.verticalSplitLine.lineWidth+"px",i.style.height="100%",i.style.backgroundColor=s.parsedOptions.verticalSplitLine.lineColor,i.style.zIndex="100",i.style.userSelect="none",i.style.pointerEvents="none",i.style.transition="background-color 0.3s",s.verticalSplitResizeLine.childNodes[1]){const a=s.verticalSplitResizeLine.childNodes[1];a.style.position="absolute",a.style.top="0px",a.style.left=((e=14-s.parsedOptions.verticalSplitLineHighlight.lineWidth)!==null&&e!==void 0?e:2)/2+"px",a.style.width=((t=s.parsedOptions.verticalSplitLineHighlight.lineWidth)!==null&&t!==void 0?t:2)+"px",a.style.height="100%",a.style.backgroundColor=s.parsedOptions.verticalSplitLineHighlight.lineColor,a.style.zIndex="100",a.style.cursor="col-resize",a.style.userSelect="none",a.style.pointerEvents="none",a.style.opacity="0",a.style.transition="background-color 0.3s"}}}function ie(s,e,t,i="children"){var a;for(let n=0;n<s.length;n++){if(Array.isArray(t)&&t.length===1&&s[n][e]===t[0]||s[n][e]===t)return{record:s[n],index:[n]};if(!((a=s[n][i])===null||a===void 0)&&a.length){if(Array.isArray(t)&&t[0]===s[n][e]){const r=ie(s[n][i],e,t.slice(1));if(r)return r.index.unshift(n),r}else if(!Array.isArray(t)){const r=ie(s[n][i],e,t);if(r)return r.index.unshift(n),r}}}}function Ft(s,e="children"){var t;for(let i=0;i<s.length;i++)!((t=s[i][e])===null||t===void 0)&&t.length?Ft(s[i][e],e):(delete s[i].vtable_gantt_linkedTo,delete s[i].vtable_gantt_linkedFrom)}function Nt(s,e="children"){var t;for(let i=0;i<s.length;i++)!((t=s[i][e])===null||t===void 0)&&t.length?Nt(s[i][e],e):delete s[i].vtable_gantt_showIndex}function J(s,e){let t,i;if(e.taskListTableInstance){const a=e.taskListTableInstance.getTargetRowAt(s+e.headerHeight);if(a){const{row:n}=a;t=n-e.taskListTableInstance.columnHeaderLevelCount;const r=e.getRowsHeightByIndex(0,t-1);e.parsedOptions.tasksShowMode!==T.Sub_Tasks_Inline&&e.parsedOptions.tasksShowMode!==T.Sub_Tasks_Arrange&&e.parsedOptions.tasksShowMode!==T.Sub_Tasks_Compact&&e.parsedOptions.tasksShowMode!==T.Sub_Tasks_Separate||(i=Math.floor((s-r)/e.parsedOptions.rowHeight))}}else t=Math.floor(s/e.parsedOptions.rowHeight);return{task_index:t,sub_task_index:i}}function Gt(s,e){var t;if(!e.children||e.children.length===1)return((t=e.children)===null||t===void 0?void 0:t.length)===1?e.children[0].vtable_gantt_showIndex=0:e.vtable_gantt_showIndex=0,1;const i=e.children.slice().sort((n,r)=>{const{startDate:l}=Ye(s,n),{startDate:o}=Ye(s,r);return l.getTime()-o.getTime()}),a=[];for(let n=0;n<=i.length-1;n++){const r=i[n],{startDate:l,endDate:o}=Ye(s,r);let h=!1;for(let d=0;d<a.length;d++)if(l.getTime()>a[d]){a[d]=o.getTime(),h=!0,r.vtable_gantt_showIndex=d;break}h||(a.push(o.getTime()),r.vtable_gantt_showIndex=a.length-1)}return a.length}function Ci(s,e,t,i){return t.some(a=>{const{startDate:n,endDate:r}=Ye(i,a);return s<=r&&n<=e})}function jt(s,e){var t;if(!e.children||e.children.length===1)return((t=e.children)===null||t===void 0?void 0:t.length)===1?e.children[0].vtable_gantt_showIndex=0:e.vtable_gantt_showIndex=0,1;const i=[];for(let a=0;a<=e.children.length-1;a++){const n=e.children[a],{startDate:r,endDate:l}=Ye(s,n);let o=!1;for(let h=0;h<i.length;h++)if(!Ci(r,l,e.children.filter(d=>d!==n&&d.vtable_gantt_showIndex===h),s)){i[h]=l.getTime(),o=!0,n.vtable_gantt_showIndex=h;break}o||(i.push(l.getTime()),n.vtable_gantt_showIndex=i.length-1)}return i.length}function Ye(s,e){const{timeScaleIncludeHour:t,startDateField:i,endDateField:a}=s.parsedOptions,n=e[i],r=e[a];return t?{startDate:j(n),endDate:ce(r)}:{startDate:j(n,!0),endDate:ce(r,!0)}}function Di(s){var e,t,i,a,n,r;const l=s.options,{unit:o,startOfWeek:h}=s.parsedOptions.reverseSortedTimelineScales[0];s.parsedOptions.markLine=Dt(l==null?void 0:l.markLine),(t=(e=s.parsedOptions.markLine)===null||e===void 0?void 0:e.length)!==null&&t!==void 0&&t&&(!((i=s.parsedOptions.markLine)===null||i===void 0)&&i.every(d=>d.scrollToMarkLine===void 0)&&(s.parsedOptions.markLine[0].scrollToMarkLine=!0),!((a=s.parsedOptions.markLine)===null||a===void 0)&&a.find(d=>d.scrollToMarkLine)&&(s.parsedOptions.scrollToMarkLineDate=ze(new Date((n=s.parsedOptions.markLine)===null||n===void 0?void 0:n.find(d=>d.scrollToMarkLine).date),o,h))),s.parsedOptions.dependencyLinks=(r=l.dependency)===null||r===void 0?void 0:r.links}function Hi(s){var e,t;const i=s.options,{unit:a,startOfWeek:n,step:r}=s.parsedOptions.reverseSortedTimelineScales[0];s.parsedOptions.minDate=i!=null&&i.minDate?ze(new Date(i.minDate),a,n):void 0,s.parsedOptions.maxDate=i!=null&&i.maxDate?Ke(s.parsedOptions.minDate,new Date(i.maxDate),a,r):void 0,s.parsedOptions._minDateTime=(e=s.parsedOptions.minDate)===null||e===void 0?void 0:e.getTime(),s.parsedOptions._maxDateTime=(t=s.parsedOptions.maxDate)===null||t===void 0?void 0:t.getTime()}function Mi(s){const e=s.options;s.parsedOptions.markLine=Dt(e==null?void 0:e.markLine)}function Wi(s,e,t){const i=J(e-t.headerHeight+t.stateManager.scrollTop,t),a=t.getRecordByIndex(i.task_index),n=Fe(s,t),r=t.getDateRangeByIndex(n);if(a!=null&&a.children){const l=J(e-t.headerHeight+t.stateManager.scrollTop,t);for(let o=0;o<a.children.length;o++){const{startDate:h,endDate:d,taskDays:c,progress:p,taskRecord:u}=t.getTaskInfoByTaskListIndex(l.task_index,o);if(((t.parsedOptions.tasksShowMode===T.Sub_Tasks_Compact||t.parsedOptions.tasksShowMode===T.Sub_Tasks_Arrange)&&u.vtable_gantt_showIndex===l.sub_task_index||t.parsedOptions.tasksShowMode===T.Sub_Tasks_Inline)&&r.startDate.getTime()>=h.getTime()&&r.endDate.getTime()<=d.getTime())return{startDate:h,endDate:d,taskDays:c,progress:p,taskRecord:u}}}}function It(s,e){let t=null;return function(...i){t||(s.apply(this,i),t=setTimeout(()=>{t=null},e))}}function se(s,e){const t=s.getFullYear().toString(),i=(s.getMonth()+1).toString().padStart(2,"0"),a=s.getDate().toString().padStart(2,"0");if((e=(e=(e=e.replace("yyyy",t)).replace("mm",i)).replace("dd",a)).length>10){const n=s.getHours().toString().padStart(2,"0"),r=s.getMinutes().toString().padStart(2,"0"),l=s.getSeconds().toString().padStart(2,"0");e=(e=(e=e.replace("hh",n)).replace("mm",r)).replace("ss",l)}return e}function Ai(s,e){const t=e.indexOf("yyyy"),i=e.indexOf("mm"),a=e.indexOf("dd"),n=i<t?i<a?0:1:i<a?1:2,r=a<t?a<i?0:1:a<i?1:2,l=parseInt(s[t<i?t<a?0:1:i<a?1:2],10),o=parseInt(s[n],10)-1,h=parseInt(s[r],10);if(isNaN(l)||l<1||isNaN(o)||o<0||o>11)return!1;const d=[31,Ii(l)?29:28,31,30,31,30,31,31,30,31,30,31];return!(isNaN(h)||h<1||h>d[o])}function zi(s,e){if(e.includes("hh")||e.includes("mm")||e.includes("ss")){const t=e.indexOf("hh")>-1?e.indexOf("hh"):e.indexOf("HH"),i=parseInt(s[t],10),a=parseInt(s[t+1],10),n=s.length>t+2?parseInt(s[t+2],10):0;if(isNaN(i)||i<0||i>23||isNaN(a)||a<0||a>59||isNaN(n)||n<0||n>59)return!1}return!0}function Ii(s){return s%4==0&&s%100!=0||s%400==0}function Ue(s){const e=["yyyy-mm-dd","dd-mm-yyyy","mm/dd/yyyy","yyyy/mm/dd","dd/mm/yyyy","yyyy.mm.dd","mm.dd.yyyy","dd.mm.yyyy"],t=["hh:mm:ss","hh:mm"],i=(s=s.trim()).split(" "),a=i[0],n=i[1];let r,l;if(a)for(let o=0;o<e.length;o++){const h=e[o],d=a.split(wt(h)),c=Ai(d,h);if(d.length===3&&c){r=h;break}}if(r&&n)for(let o=0;o<t.length;o++){const h=t[o],d=n.split(wt(h)),c=h.split(wt(h));if(zi(d,h)&&d.length===c.length){l=h;break}}return a&&n&&r&&l?r+" "+l:a&&!n?r:"yyyy-mm-dd hh:mm:ss"}function wt(s){const e=s.match(/[^\w]/g);if(e){const t=e.map(i=>"\\"+i).join("|");return new RegExp(t,"g")}return/[^\w]/}function Pi(s,e){return s.replace(/\{([^}]+)\}/g,(t,i)=>{const a=i.split(".");let n=e;for(const r of a){if(!n.hasOwnProperty(r)){n=t;break}n=n[r]}return n})}function et(s){return Array.isArray(s)?s.length===3?[s[0],s[1],s[2],s[1]]:s.length===2?[s[0],s[1],s[0],s[1]]:s.length===1?[s[0],s[0],s[0],s[0]]:[s[0],s[1],s[2],s[3]]:[s,s,s,s]}function Ei(s){const e=new Date(s.getFullYear(),0,1);return Math.ceil(((s.getTime()+1-e.getTime())/864e5+1)/7)}function Ri(s,e="long"){const t=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],i=new Date(s);return e==="short"?t[i.getDay()].substr(0,3):e==="long"?t[i.getDay()]:'Invalid format specified. Please use "short" or "long".'}function Fi(s,e){const t=Object.getOwnPropertyDescriptor(s,e);return!!t&&(!!t.set||t.writable===!0)}function j(s,e=!1){let t;if(s){if(t=new Date(s),typeof s=="string"){if(s.length>10)return e&&t.setHours(0,0,0,0),t;t.setHours(0,0,0,0)}}else t=new Date;return e&&t.setHours(0,0,0,0),t}function Ni(s,e=!1){let t;if(s){if(t=new Date(s),typeof s=="string"){if(s.length>10)return e&&t.setMinutes(59,59,999),t;t.setMinutes(59,59,999)}}else t=new Date;return e&&t.setMinutes(59,59,999),t}function Gi(s,e=!1){let t;if(s){if(t=new Date(s),typeof s=="string"){if(s.length>10)return e&&t.setSeconds(59,999),t;t.setSeconds(59,999)}}else t=new Date;return e&&t.setSeconds(59,999),t}function Xt(s,e=!1){let t;if(s){if(t=new Date(s),typeof s=="string"){if(s.length>10)return e&&t.setMilliseconds(999),t;t.setMilliseconds(999)}}else t=new Date;return e&&t.setMilliseconds(999),t}function ce(s,e=!1){let t;if(s){if(t=new Date(s),typeof s=="string"){if(s.length>10)return e&&t.setHours(23,59,59,999),t;t.setHours(23,59,59,999)}}else t=new Date;return e&&t.setHours(23,59,59,999),t}function Ke(s,e,t,i){let a=new Date(e);switch(t){case"second":a.setMilliseconds(999);break;case"minute":a.setSeconds(59,999);break;case"hour":a.setMinutes(59,59,999);break;case"day":a.setHours(23,59,59,999);break;case"week":const l=6-a.getDay();a.setDate(a.getDate()+l),a.setHours(23,59,59,999);break;case"month":const o=new Date(a.getFullYear(),a.getMonth()+1,0).getDate();a.setDate(o),a.setHours(23,59,59,999);break;case"quarter":const h=a.getMonth(),d=h-h%3+2,c=new Date(a.getFullYear(),d+1,0).getDate();a.setMonth(d,c),a.setHours(23,59,59,999);break;case"year":a.setMonth(11,31),a.setHours(23,59,59,999);break;default:throw new Error("Invalid time scale")}const n=z(a,s,t,i,1),r=Math.ceil(n);if(r>n){const l=(r-n)*i,o=1e3,h=60*o,d=60*h,c=24*d,p=7*c;switch(new Date(a.getTime()+1),t){case"second":a.setTime(a.getTime()+l*o);break;case"minute":a.setTime(a.getTime()+l*h);break;case"hour":a.setTime(a.getTime()+l*d);break;case"day":a.setTime(a.getTime()+l*c);break;case"week":a.setTime(a.getTime()+l*p);break;case"month":a=new Date(a.getFullYear(),a.getMonth()+1+Math.round(l),0),a.setHours(23,59,59,999);break;case"quarter":const u=a.getMonth(),g=u-u%3+2;a=new Date(a.getFullYear(),g+Math.round(3*l)+1,0),a.setHours(23,59,59,999);break;case"year":a.setFullYear(a.getFullYear()+Math.floor(l)),a.setHours(23,59,59,999);break;default:throw new Error("Invalid time scale")}}return a}function ze(s,e,t="monday"){const i=new Date(s);switch(e){case"second":i.setMilliseconds(0);break;case"minute":i.setSeconds(0,0);break;case"hour":i.setMinutes(0,0,0);break;case"day":i.setHours(0,0,0,0);break;case"week":const a=i.getDay();let n=a;n=t==="monday"?a===0?-6:1-a:-a,i.setDate(i.getDate()+n),i.setHours(0,0,0,0);break;case"month":i.setDate(1),i.setHours(0,0,0,0);break;case"quarter":const r=i.getMonth(),l=r-r%3;i.setMonth(l,1),i.setHours(0,0,0,0);break;case"year":i.setMonth(0,1),i.setHours(0,0,0,0);break;default:throw new Error("Invalid time scale")}return i}function z(s,e,t,i,a=0){let n;const r=new Date(s.getTime()+a);switch(t){case"second":n=(r.getTime()-e.getTime())/1e3;break;case"minute":n=(r.getTime()-e.getTime())/6e4;break;case"hour":n=(r.getTime()-e.getTime())/36e5;break;case"day":n=(r.getTime()-e.getTime())/864e5;break;case"week":n=(r.getTime()-e.getTime())/6048e5;break;case"month":n=12*(r.getFullYear()-e.getFullYear())+(r.getMonth()-e.getMonth()),n+=(r.getDate()-e.getDate())/new Date(r.getFullYear(),r.getMonth()+1,0).getDate();break;case"quarter":n=4*(r.getFullYear()-e.getFullYear())+Math.floor(r.getMonth()/3)-Math.floor(e.getMonth()/3),n+=(r.getTime()-e.getTime())/Si/(3*new Date(r.getFullYear(),r.getMonth()+1,0).getDate());break;case"year":n=r.getFullYear()-e.getFullYear(),n+=(r.getMonth()-e.getMonth())/12;break;default:throw new Error("Invalid time scale")}return n/i}class ji{constructor(e){var t;this._scene=e,this.scrollLeft=0,this.scrollTop=0,this.x=0,this.y=e._gantt.getAllHeaderRowsHeight(),this.width=e.ganttGroup.attribute.width,this.height=e.ganttGroup.attribute.height-e.timelineHeader.group.attribute.height,this.rowHeight=e._gantt.parsedOptions.rowHeight,this.rowCount=e._gantt.itemCount,this.allGridWidth=e._gantt.getAllDateColsWidth(),this.allGridHeight=e._gantt.getAllTaskBarsHeight(),this.group=new A({x:this.x,y:this.y,width:this.width,height:this.height,clip:!0,fill:(t=e._gantt.parsedOptions.grid)===null||t===void 0?void 0:t.backgroundColor}),this.group.name="grid-container",e.ganttGroup.addChild(this.group),this.createVerticalBackgroundRects(),this.createHorizontalBackgroundRects(),this.createVerticalLines(),this.createHorizontalLines(),this.createTimeLineHeaderBottomLine()}createTimeLineHeaderBottomLine(){var e,t,i,a,n,r;const l=this._scene._gantt.parsedOptions,o=(t=(e=l.horizontalSplitLine)===null||e===void 0?void 0:e.lineWidth)!==null&&t!==void 0?t:(i=l.timelineHeaderHorizontalLineStyle)===null||i===void 0?void 0:i.lineWidth,h=(1&o?-.5:0)+o/2,d=q({pickable:!1,stroke:(n=(a=l.horizontalSplitLine)===null||a===void 0?void 0:a.lineColor)!==null&&n!==void 0?n:(r=l.timelineHeaderHorizontalLineStyle)===null||r===void 0?void 0:r.lineColor,lineWidth:o+(1&o?1:0),points:[{x:0,y:h},{x:this._scene._gantt.getAllDateColsWidth(),y:h}]});d.name="timeLine-header-bottom-line",this.group.addChild(d)}createVerticalLines(){var e,t;const i=this._scene._gantt.parsedOptions.grid,a=(e=i.verticalLineDependenceOnTimeScale)!==null&&e!==void 0?e:this._scene._gantt.parsedOptions.reverseSortedTimelineScales[0].unit;if(i.verticalLine){this.verticalLineGroup=new A({x:0,y:0,width:this.allGridWidth,height:this.allGridHeight}),this.verticalLineGroup.name="grid-vertical",this.group.appendChild(this.verticalLineGroup);const n=(t=this._scene._gantt.parsedOptions.reverseSortedTimelineScales.find(d=>d.unit===a))!==null&&t!==void 0?t:this._scene._gantt.parsedOptions.reverseSortedTimelineScales[0],{unit:r,step:l}=this._scene._gantt.parsedOptions.reverseSortedTimelineScales[0],{timelineDates:o}=n,h=this._scene._gantt.parsedOptions.timelineColWidth;if(typeof i.verticalLine=="function")for(let d=0;d<(o==null?void 0:o.length)-1;d++){const{endDate:c}=o[d],p=i.verticalLine({index:d,dateIndex:o[d].dateIndex,date:o[d].endDate,ganttInstance:this._scene._gantt}),u=Math.ceil(z(c,this._scene._gantt.parsedOptions.minDate,r,l,1)*h)+(1&p.lineWidth?.5:0),g=q({pickable:!1,stroke:p.lineColor,lineWidth:p.lineWidth,points:[{x:u,y:0},{x:u,y:this.allGridHeight}]});this.verticalLineGroup.appendChild(g)}else{const d=i.verticalLine;for(let c=0;c<(o==null?void 0:o.length)-1;c++){const{endDate:p}=o[c],u=Math.ceil(z(p,this._scene._gantt.parsedOptions.minDate,r,l,1)*h)+(1&d.lineWidth?.5:0),g=q({pickable:!1,stroke:d.lineColor,lineWidth:d.lineWidth,points:[{x:u,y:0},{x:u,y:this.allGridHeight}]});this.verticalLineGroup.appendChild(g)}}}}createHorizontalLines(){const e=this._scene._gantt.parsedOptions.grid;if(e.horizontalLine)if(this.horizontalLineGroup=new A({x:0,y:0,width:this.allGridWidth,height:this.allGridHeight}),this.horizontalLineGroup.name="grid-horizontal",this.group.appendChild(this.horizontalLineGroup),typeof e.horizontalLine=="function"){let t=.5;for(let i=0;i<this.rowCount-1;i++){const a=e.horizontalLine({index:i,ganttInstance:this._scene._gantt});t+=this._scene._gantt.getRowHeightByIndex(i);const n=q({pickable:!1,stroke:a.lineColor,lineWidth:a.lineWidth,points:[{x:0,y:t},{x:this.allGridWidth,y:t}]});this.horizontalLineGroup.appendChild(n)}}else{const t=e.horizontalLine;let i=0;1&t.lineWidth&&(i+=.5);for(let a=0;a<this.rowCount-1;a++){i+=this._scene._gantt.getRowHeightByIndex(a);const n=q({pickable:!1,stroke:t.lineColor,lineWidth:t.lineWidth,points:[{x:0,y:i},{x:this.allGridWidth,y:i}]});this.horizontalLineGroup.appendChild(n)}}}createVerticalBackgroundRects(){const e=this._scene._gantt.parsedOptions.grid.verticalBackgroundColor,t=this._scene._gantt.parsedOptions.grid.weekendBackgroundColor;if(e||t){this.verticalBackgroundRectsGroup=new A({x:0,y:0,width:this.allGridWidth,height:this.allGridHeight}),this.verticalBackgroundRectsGroup.name="grid-vertical-background",this.group.appendChild(this.verticalBackgroundRectsGroup);const{timelineDates:i,unit:a,step:n}=this._scene._gantt.parsedOptions.reverseSortedTimelineScales[0],r=this._scene._gantt.parsedOptions.timelineColWidth;if(e||t)for(let l=0;l<=(i==null?void 0:i.length)-1;l++){let o;if(!t||a!=="day"||n!==1||i[l].startDate.getDay()!==0&&i[l].startDate.getDay()!==6?typeof e=="function"?o=e({index:l,dateIndex:i[l].dateIndex,date:i[l].endDate,ganttInstance:this._scene._gantt}):e&&(o=e[l%e.length]):o=t,o){const h=Math.ceil(r*l),d=Ve({pickable:!1,fill:o,x:h,y:0,width:r,height:this.allGridHeight});this.verticalBackgroundRectsGroup.appendChild(d)}}}}createHorizontalBackgroundRects(){const e=this._scene._gantt.parsedOptions.grid.horizontalBackgroundColor;if(e){this.horizontalBackgroundRectsGroup=new A({x:0,y:0,width:this.allGridWidth,height:this.allGridHeight}),this.horizontalBackgroundRectsGroup.name="grid-horizontal-background",this.group.appendChild(this.horizontalBackgroundRectsGroup);let t=0;for(let i=0;i<=this.rowCount-1;i++){let a;a=typeof e=="function"?e({index:i,ganttInstance:this._scene._gantt}):e[i%e.length];const n=Ve({pickable:!1,fill:a,x:0,y:t,width:this.allGridWidth,height:this._scene._gantt.getRowHeightByIndex(i)});this.horizontalBackgroundRectsGroup.appendChild(n),t+=this._scene._gantt.getRowHeightByIndex(i)}}}refresh(){this.width=this._scene.ganttGroup.attribute.width,this.height=this._scene.ganttGroup.attribute.height-this._scene.timelineHeader.group.attribute.height,this.group.setAttributes({width:this.width,height:this.height,y:this._scene._gantt.getAllHeaderRowsHeight()}),this.rowCount=this._scene._gantt.itemCount,this.allGridWidth=this._scene._gantt.getAllDateColsWidth(),this.allGridHeight=this._scene._gantt.getAllTaskBarsHeight(),this.group.removeAllChild(),this.createVerticalBackgroundRects(),this.createHorizontalBackgroundRects(),this.createVerticalLines(),this.createHorizontalLines(),this.createTimeLineHeaderBottomLine()}setX(e){var t,i,a,n;(t=this.verticalLineGroup)===null||t===void 0||t.setAttribute("x",e),(i=this.horizontalLineGroup)===null||i===void 0||i.setAttribute("x",e),(a=this.verticalBackgroundRectsGroup)===null||a===void 0||a.setAttribute("x",e),(n=this.horizontalBackgroundRectsGroup)===null||n===void 0||n.setAttribute("x",e)}setY(e){var t,i,a,n;(t=this.verticalLineGroup)===null||t===void 0||t.setAttribute("y",e),(i=this.horizontalLineGroup)===null||i===void 0||i.setAttribute("y",e),(a=this.verticalBackgroundRectsGroup)===null||a===void 0||a.setAttribute("y",e),(n=this.horizontalBackgroundRectsGroup)===null||n===void 0||n.setAttribute("y",e)}resize(){this.width=this._scene.ganttGroup.attribute.width,this.height=this._scene.ganttGroup.attribute.height-this._scene.timelineHeader.group.attribute.height,this.group.setAttribute("width",this.width),this.group.setAttribute("height",this.height)}}class F{static get mode(){return F._mode||(F._mode=Xi()),F._mode}static set mode(e){F._mode=e}static RegisterCreateCanvas(e){F.CreateCanvas=e}static RegisterLoadImage(e){F.LoadImage=e}static GetCreateCanvasFunc(){return F.CreateCanvas?F.CreateCanvas:F.mode==="worker"?(e=200,t=200)=>new OffscreenCanvas(e,t):void 0}static RegisterRequestAnimationFrame(e){F.RequestAnimationFrame=e()}static GetRequestAnimationFrame(){if(F.RequestAnimationFrame)return F.RequestAnimationFrame}static RegisterCancelAnimationFrame(e){F.CancelAnimationFrame=e()}static GetCancelAnimationFrame(){if(F.CancelAnimationFrame)return F.CancelAnimationFrame}}function Xi(){let s="browser";try{window.type==="node"?s="node":typeof window>"u"||window.performance?typeof window>"u"&&(s="node"):s="miniApp"}catch{s="node"}return s}F.dpr=0;class Yi{constructor(e){this._gantt=e,this.createScrollBar(e.tableNoFrameWidth,e.tableNoFrameHeight-e.getAllHeaderRowsHeight())}createScrollBar(e,t){var i,a;const n=this._gantt.parsedOptions.scrollStyle.scrollRailColor,r=this._gantt.parsedOptions.scrollStyle.scrollSliderColor,l=this._gantt.parsedOptions.scrollStyle.scrollSliderCornerRadius,o=this._gantt.parsedOptions.scrollStyle.width;let h;h=G(l)?{cornerRadius:l,fill:r}:{fill:r},(i=this._gantt.parsedOptions.scrollStyle)===null||i===void 0||i.visible,(a=this._gantt.parsedOptions.scrollStyle)===null||a===void 0||a.hoverOn,this.hScrollBar=new Mt({direction:"horizontal",x:2*-e,y:2*-t,width:e,height:o,padding:0,railStyle:{fill:n},sliderStyle:h,range:[0,.1],visible:!1}),this.hScrollBar.render(),this.hScrollBar.hideAll(),this.vScrollBar=new Mt({direction:"vertical",x:2*-e,y:2*-t,width:o,height:t,padding:0,railStyle:{fill:n},sliderStyle:h,range:[0,.1],visible:!1}),this.vScrollBar.render(),this.vScrollBar.hideAll()}refresh(){}hideVerticalScrollBar(){const e=this._gantt.parsedOptions.scrollStyle.visible;e!=="focus"&&e!=="scrolling"||(this.vScrollBar.setAttribute("visible",!1),this.vScrollBar.hideAll(),this._gantt.scenegraph.updateNextFrame())}showVerticalScrollBar(e){const t=this._gantt.parsedOptions.scrollStyle.visible;t!=="focus"&&t!=="scrolling"||(this.vScrollBar.setAttribute("visible",!0),this.vScrollBar.showAll(),this._gantt.scenegraph.updateNextFrame(),e&&(clearTimeout(this._clearVerticalScrollBar),this._clearVerticalScrollBar=setTimeout(()=>{this.hideVerticalScrollBar()},1e3)))}hideHorizontalScrollBar(){const e=this._gantt.parsedOptions.scrollStyle.visible;e!=="focus"&&e!=="scrolling"||(this.hScrollBar.setAttribute("visible",!1),this.hScrollBar.hideAll(),this._gantt.scenegraph.updateNextFrame())}showHorizontalScrollBar(e){const t=this._gantt.parsedOptions.scrollStyle.visible;t!=="focus"&&t!=="scrolling"||(this.hScrollBar.setAttribute("visible",!0),this.hScrollBar.showAll(),this._gantt.scenegraph.updateNextFrame(),e&&(clearTimeout(this._clearHorizontalScrollBar),this._clearHorizontalScrollBar=setTimeout(()=>{this.hideHorizontalScrollBar()},1e3)))}updateVerticalScrollBarPos(e){const t=this.vScrollBar.attribute.range,i=t[1]-t[0],a=e*(1-i);this.vScrollBar.setAttribute("range",[a,a+i]);const n=this.vScrollBar.AABBBounds&&this.vScrollBar.globalAABBBounds;this.vScrollBar._viewPosition={x:n.x1,y:n.y1}}updateHorizontalScrollBarPos(e){const t=this.hScrollBar.attribute.range,i=t[1]-t[0],a=e*(1-i);this.hScrollBar.setAttribute("range",[a,a+i]);const n=this.hScrollBar.AABBBounds&&this.hScrollBar.globalAABBBounds;this.hScrollBar._viewPosition={x:n.x1,y:n.y1}}updateScrollBar(){const e=this._gantt.stateManager.scroll.horizontalBarPos,t=this._gantt.stateManager.scroll.verticalBarPos,i=this._gantt.parsedOptions.scrollStyle,a=i==null?void 0:i.width,n=i==null?void 0:i.visible,r=Math.ceil(this._gantt.scenegraph.ganttGroup.attribute.width),l=Math.ceil(this._gantt.scenegraph.ganttGroup.attribute.height),o=this._gantt.getAllRowsHeight(),h=this._gantt.getAllDateColsWidth(),d=this._gantt.getAllHeaderRowsHeight();if(h>r){const c=Math.min(l,o),p=Math.max(.05,r/h),u=i.hoverOn;let g=0;g=i.barToSide?this._gantt.tableNoFrameHeight-(u?a:-this._gantt.scenegraph.ganttGroup.attribute.y)+this._gantt.tableY:c-(u?a:-this._gantt.scenegraph.ganttGroup.attribute.y)+this._gantt.tableY,this.hScrollBar.setAttributes({x:this._gantt.scenegraph.ganttGroup.attribute.x,y:g,width:r,range:[0,p],visible:n==="always"});const _=this.hScrollBar.AABBBounds&&this.hScrollBar.globalAABBBounds;this.hScrollBar._viewPosition={x:_.x1,y:_.y1},n==="always"&&this.hScrollBar.showAll()}else this.hScrollBar.setAttributes({x:2*-this._gantt.tableNoFrameWidth,y:2*-this._gantt.tableNoFrameHeight,width:0,visible:!1});if(o>l){const c=Math.min(r,h)+this._gantt.scenegraph.ganttGroup.attribute.x,p=Math.max(.05,(l-d)/(o-d));let u=0;const g=this._gantt.parsedOptions.scrollStyle.hoverOn;u=this._gantt.parsedOptions.scrollStyle.barToSide?this._gantt.tableNoFrameWidth-(g?a:-this._gantt.scenegraph.ganttGroup.attribute.x):c-(g?a:-this._gantt.scenegraph.ganttGroup.attribute.x),this.vScrollBar.setAttributes({x:u,y:d+(g?0:this._gantt.scenegraph.ganttGroup.attribute.y)+this._gantt.tableY,height:l-d,range:[0,p],visible:n==="always"});const _=this.vScrollBar.AABBBounds&&this.vScrollBar.globalAABBBounds;this.vScrollBar._viewPosition={x:_.x1,y:_.y1},n==="always"&&this.vScrollBar.showAll()}else this.vScrollBar.setAttributes({x:2*-this._gantt.tableNoFrameWidth,y:2*-this._gantt.tableNoFrameHeight,height:0,visible:!1});this._gantt.stateManager.setScrollLeft(e),this._gantt.stateManager.setScrollTop(t)}}function Vi(s,e,t,i=!0){let{deltaX:a,deltaY:n}=s;s.shiftKey&&s.deltaY&&(a=n,n=0);const[r,l]=Ki(a,n,{horizontal:1,vertical:1});r&&(e.setScrollLeft(e.scroll.horizontalBarPos+r),t.scenegraph.scrollbarComponent.showHorizontalScrollBar(!0)),l&&(e.setScrollTop(e.scroll.verticalBarPos+l),t.scenegraph.scrollbarComponent.showVerticalScrollBar(!0)),i&&e.resetInteractionState(),s.cancelable&&(e._gantt.parsedOptions.overscrollBehavior==="none"||Math.abs(n)>=Math.abs(a)&&n!==0&&Ui(n,e)||Math.abs(n)<=Math.abs(a)&&a!==0&&$i(a,e))&&s.preventDefault()}function Ki(s,e,t){var i,a;const n=Math.abs(s/e),r=n<=.5?0:s,l=n>2?0:e;return[Math.ceil(r*((i=t.horizontal)!==null&&i!==void 0?i:0)),Math.ceil(l*((a=t.vertical)!==null&&a!==void 0?a:0))]}function Ui(s,e){return e._gantt.getAllRowsHeight()-e._gantt.scenegraph.height!=0&&!qi(s,e)&&!Zi(s,e)}function $i(s,e){return e._gantt.getAllDateColsWidth()-e._gantt.scenegraph.width!=0&&!Qi(s,e)&&!Ji(s,e)}function qi(s,e){return e._gantt.getAllRowsHeight()-e._gantt.scenegraph.height!==0&&s<=0&&e.scroll.verticalBarPos<1}function Zi(s,e){const t=e._gantt.getAllRowsHeight()-e._gantt.scenegraph.height;return t!==0&&s>=0&&Math.abs(e.scroll.verticalBarPos-t)<1}function Qi(s,e){return e._gantt.getAllDateColsWidth()-e._gantt.scenegraph.width!==0&&s<=0&&e.scroll.horizontalBarPos<1}function Ji(s,e){const t=e._gantt.getAllDateColsWidth()-e._gantt.scenegraph.width;return t!==0&&s>=0&&Math.abs(e.scroll.horizontalBarPos-t)<1}function es(s){const e=s._gantt,t=e.stateManager,i=e.scenegraph;i.scrollbarComponent.vScrollBar.addEventListener("pointerover",r=>{i.scrollbarComponent.showVerticalScrollBar()}),i.scrollbarComponent.hScrollBar.addEventListener("pointerover",r=>{i.scrollbarComponent.showHorizontalScrollBar()}),i.scrollbarComponent.vScrollBar.addEventListener("pointerout",r=>{t.interactionState!==P.scrolling&&i.scrollbarComponent.hideVerticalScrollBar()}),i.scrollbarComponent.hScrollBar.addEventListener("pointerout",r=>{t.interactionState!==P.scrolling&&i.scrollbarComponent.hideHorizontalScrollBar()}),i.scrollbarComponent.vScrollBar.addEventListener("pointermove",r=>{r.stopPropagation()}),i.scrollbarComponent.vScrollBar.addEventListener("scrollDown",r=>{i._gantt.eventManager.isDown=!0}),i.scrollbarComponent.vScrollBar.addEventListener("pointerup",()=>{i._gantt.eventManager.isDraging=!1,t.interactionState===P.scrolling&&t.updateInteractionState(P.default)}),i.scrollbarComponent.vScrollBar.addEventListener("pointerupoutside",()=>{t.interactionState===P.scrolling&&t.updateInteractionState(P.default)}),i.scrollbarComponent.vScrollBar.addEventListener("scrollUp",r=>{i._gantt.eventManager.isDraging=!1}),i.scrollbarComponent.hScrollBar.addEventListener("pointermove",r=>{r.stopPropagation()}),i.scrollbarComponent.hScrollBar.addEventListener("pointerdown",r=>{r.stopPropagation()}),i.scrollbarComponent.hScrollBar.addEventListener("scrollDown",r=>{i._gantt.eventManager.isDown=!0,t.interactionState!==P.scrolling&&t.updateInteractionState(P.scrolling)}),i.scrollbarComponent.hScrollBar.addEventListener("pointerup",()=>{t.interactionState===P.scrolling&&t.updateInteractionState(P.default)}),i.scrollbarComponent.hScrollBar.addEventListener("pointerupoutside",()=>{t.interactionState===P.scrolling&&t.updateInteractionState(P.default)}),i.scrollbarComponent.hScrollBar.addEventListener("scrollUp",r=>{i._gantt.eventManager.isDraging=!1});const a=It(t.updateVerticalScrollBar,20),n=It(t.updateHorizontalScrollBar,20);i.scrollbarComponent.vScrollBar.addEventListener("scrollDrag",r=>{i._gantt.eventManager.isDown&&(i._gantt.eventManager.isDraging=!0),t.interactionState!==P.scrolling&&t.updateInteractionState(P.scrolling);const l=r.detail.value[0]/(1-r.detail.value[1]+r.detail.value[0]);a(l,r)}),i.scrollbarComponent.hScrollBar.addEventListener("scrollDrag",r=>{i._gantt.eventManager.isDown&&(i._gantt.eventManager.isDraging=!0),t.fastScrolling=!0,t.interactionState!==P.scrolling&&t.updateInteractionState(P.scrolling);const l=r.detail.value[0]/(1-r.detail.value[1]+r.detail.value[0]);n(l)})}class ts{constructor(e){this._scene=e,this.initNodes()}initNodes(){var e,t,i,a,n,r,l,o,h;const{_scene:d}=this,c=new A({x:0,y:0,width:d._gantt.getAllDateColsWidth(),height:d._gantt.getAllHeaderRowsHeight(),clip:!0,pickable:!1});this.group=c,c.name="date-header-container",d.ganttGroup.addChild(this.group);const{unit:p,step:u}=d._gantt.parsedOptions.reverseSortedTimelineScales[0];let g=0;for(let _=0;_<d._gantt.timeLineHeaderLevel;_++){const{timelineDates:b,customLayout:S,visible:y}=d._gantt.parsedOptions.sortedTimelineScales[_];if(y===!1)continue;const v=new A({x:0,y:g,width:d._gantt.getAllDateColsWidth(),height:d._gantt.parsedOptions.timeLineHeaderRowHeights[_],clip:!1});g+=v.attribute.height,v.name="row-header",c.addChild(v);for(let L=0;L<(b==null?void 0:b.length);L++){const{days:k,endDate:f,startDate:x,title:C,dateIndex:w,unit:O}=b[L],B=Math.ceil(z(x,d._gantt.parsedOptions.minDate,p,u)*d._gantt.parsedOptions.timelineColWidth),D=Math.ceil(z(f,d._gantt.parsedOptions.minDate,p,u,1)*d._gantt.parsedOptions.timelineColWidth)-B,M=new A({x:B,y:0,width:D,height:v.attribute.height,clip:!1,fill:d._gantt.parsedOptions.timelineHeaderBackgroundColor});let N;M.name="date-header-cell";let X=!0;const E=v.attribute.height;if(S){let R;typeof S=="function"?R=S({width:D,height:E,index:L,startDate:x,endDate:f,days:k,dateIndex:w,title:C,ganttInstance:this._scene._gantt}):R=S,R&&(N=R.rootContainer,X=(e=R.renderDefaultText)!==null&&e!==void 0&&e,N.name="task-bar-custom-render"),N&&M.appendChild(N)}if(X){const{padding:R,textAlign:$,textBaseline:K,textOverflow:V,fontSize:ae,fontWeight:ne,color:re,strokeColor:oe,textStick:le}=d._gantt.parsedOptions.timelineHeaderStyles[_],ee=Je(et(R),$,K,D,E),Z=new he({x:ee.x,y:ee.y,maxLineWidth:D,heightLimit:E,pickable:!0,text:C.toLocaleString(),fontSize:ae,fontWeight:ne,fill:re,stroke:oe,lineWidth:2,textAlign:$,textBaseline:K,ellipsis:V==="clip"?"":V==="ellipsis"?"...":G(V)?V:void 0});Z.attribute.textStick=le,M.appendChild(Z),Z.name="date-header-cell-text"}if(v.addChild(M),L>0){const R=q({pickable:!1,stroke:(t=d._gantt.parsedOptions.timelineHeaderVerticalLineStyle)===null||t===void 0?void 0:t.lineColor,lineWidth:(i=d._gantt.parsedOptions.timelineHeaderVerticalLineStyle)===null||i===void 0?void 0:i.lineWidth,points:[{x:1&((a=d._gantt.parsedOptions.timelineHeaderVerticalLineStyle)===null||a===void 0?void 0:a.lineWidth)?.5:0,y:0},{x:1&((n=d._gantt.parsedOptions.timelineHeaderVerticalLineStyle)===null||n===void 0?void 0:n.lineWidth)?.5:0,y:v.attribute.height}]});M.appendChild(R)}}if(_>0){const L=q({pickable:!1,stroke:(r=d._gantt.parsedOptions.timelineHeaderHorizontalLineStyle)===null||r===void 0?void 0:r.lineColor,lineWidth:(l=d._gantt.parsedOptions.timelineHeaderHorizontalLineStyle)===null||l===void 0?void 0:l.lineWidth,points:[{x:0,y:1&((o=d._gantt.parsedOptions.timelineHeaderHorizontalLineStyle)===null||o===void 0?void 0:o.lineWidth)?.5:0},{x:d._gantt.getAllDateColsWidth(),y:1&((h=d._gantt.parsedOptions.timelineHeaderHorizontalLineStyle)===null||h===void 0?void 0:h.lineWidth)?.5:0}]});v.addChild(L)}}}setX(e){this.group.setAttribute("x",e)}setY(e){this.group.setAttribute("y",e)}resize(){var e,t,i,a;this.group.setAttribute("width",(t=(e=this.group.attribute)===null||e===void 0?void 0:e.width)!==null&&t!==void 0?t:0),this.group.setAttribute("height",(a=(i=this.group.attribute)===null||i===void 0?void 0:i.height)!==null&&a!==void 0?a:0)}refresh(){var e;(e=this.group)===null||e===void 0||e.parent.removeChild(this.group),this.initNodes()}}class is extends A{constructor(e){super(e)}}const Pt=`<svg width="100" height="200" xmlns="http://www.w3.org/2000/svg">
  <line x1="30" y1="10" x2="30" y2="190" stroke="black" stroke-width="4"/>
  <line x1="70" y1="10" x2="70" y2="190" stroke="black" stroke-width="4"/>
</svg>`,Yt=10;class ss{constructor(e){this.selectedBorders=[],this._scene=e,this.width=e._gantt.tableNoFrameWidth,this.height=e._gantt.gridHeight,this.group=new A({x:0,y:e._gantt.getAllHeaderRowsHeight(),width:this.width,height:this.height,pickable:!1,clip:!0}),this.group.name="task-bar-container",e.ganttGroup.addChild(this.group),this.initBars(),this.initHoverBarIcons()}initBars(){var e,t;this.barContainer=new A({x:0,y:0,width:this._scene._gantt.getAllDateColsWidth(),height:this._scene._gantt.getAllTaskBarsHeight(),pickable:!1,clip:!0}),this.group.appendChild(this.barContainer);for(let i=0;i<this._scene._gantt.itemCount;i++)if(this._scene._gantt.parsedOptions.tasksShowMode!==T.Sub_Tasks_Inline&&this._scene._gantt.parsedOptions.tasksShowMode!==T.Sub_Tasks_Separate&&this._scene._gantt.parsedOptions.tasksShowMode!==T.Sub_Tasks_Arrange&&this._scene._gantt.parsedOptions.tasksShowMode!==T.Sub_Tasks_Compact){const a=this.initBar(i);a&&this.barContainer.appendChild(a)}else{const a=this._scene._gantt.getRecordByIndex(i);if(((e=a.children)===null||e===void 0?void 0:e.length)>0)for(let n=0;n<((t=a.children)===null||t===void 0?void 0:t.length);n++){const r=this.initBar(i,n,a.children.length);r&&this.barContainer.appendChild(r)}else{const n=this.initBar(i);n&&this.barContainer.appendChild(n)}}}initBar(e,t,i){var a,n,r;const l=this._scene._gantt.parsedOptions.taskBarCustomLayout,{startDate:o,endDate:h,taskDays:d,progress:c,taskRecord:p}=this._scene._gantt.getTaskInfoByTaskListIndex(e,t),u=p.type==="milestone";if(u&&!o||!u&&(d<=0||!o||!h||o.getTime()>h.getTime()))return null;const{unit:g,step:_}=this._scene._gantt.parsedOptions.reverseSortedTimelineScales[0],b=z(h,o,g,_,1)*this._scene._gantt.parsedOptions.timelineColWidth,S=this._scene._gantt.getTaskBarStyle(e,t),y=S.width,v=(j(this._scene._gantt.parsedOptions.minDate),this._scene._gantt.parsedOptions.tasksShowMode===T.Sub_Tasks_Separate||(this._scene._gantt.parsedOptions.tasksShowMode===T.Sub_Tasks_Arrange?jt(this._scene._gantt,this._scene._gantt.records[e]):this._scene._gantt.parsedOptions.tasksShowMode===T.Sub_Tasks_Compact&&Gt(this._scene._gantt,this._scene._gantt.records[e])),this._scene._gantt.parsedOptions.rowHeight),L=this._scene._gantt.parsedOptions.taskBarMilestoneStyle.width,k=z(o,this._scene._gantt.parsedOptions.minDate,g,_)*this._scene._gantt.parsedOptions.timelineColWidth-(u?L/2:0),f=this._scene._gantt.getRowsHeightByIndex(0,e-1)+(this._scene._gantt.parsedOptions.tasksShowMode===T.Sub_Tasks_Separate?(t??0)*v:this._scene._gantt.parsedOptions.tasksShowMode===T.Sub_Tasks_Arrange||this._scene._gantt.parsedOptions.tasksShowMode===T.Sub_Tasks_Compact?p.vtable_gantt_showIndex*v:0)+(v-(u?L:y))/2,x=new is({x:k,y:f,width:u?L:b,height:u?L:y,cornerRadius:u?this._scene._gantt.parsedOptions.taskBarMilestoneStyle.cornerRadius:S.cornerRadius,lineWidth:u?2*this._scene._gantt.parsedOptions.taskBarMilestoneStyle.borderLineWidth:2*((a=S.borderLineWidth)!==null&&a!==void 0?a:S.borderWidth),stroke:u?this._scene._gantt.parsedOptions.taskBarMilestoneStyle.borderColor:S.borderColor,angle:u?.25*Math.PI:0,anchor:u?[k+L/2,f+L/2]:void 0});x.name="task-bar",x.task_index=e,x.sub_task_index=t,x.record=p;const C=new A({x:0,y:0,width:x.attribute.width,height:x.attribute.height,cornerRadius:u?this._scene._gantt.parsedOptions.taskBarMilestoneStyle.cornerRadius:S.cornerRadius,clip:!0});let w;C.name="task-bar-group",x.appendChild(C),x.clipGroupBox=C;let O=!0,B=!0;if(l){let D;typeof l=="function"?D=l({width:b,height:y,index:e,startDate:o,endDate:h,taskDays:d,progress:c,taskRecord:p,ganttInstance:this._scene._gantt}):D=l,D&&(w=D.rootContainer,O=(n=D.renderDefaultBar)!==null&&n!==void 0&&n,B=(r=D.renderDefaultText)!==null&&r!==void 0&&r,w&&(w.name="task-bar-custom-render"))}if(O){const D=Ve({x:0,y:0,width:x.attribute.width,height:x.attribute.height,fill:u?this._scene._gantt.parsedOptions.taskBarMilestoneStyle.fillColor:S.barColor,pickable:!1});if(D.name="task-bar-rect",C.appendChild(D),x.barRect=D,p.type!=="milestone"){const M=Ve({x:0,y:0,width:b*c/100,height:y,fill:S.completedBarColor,pickable:!1});M.name="task-bar-progress-rect",C.appendChild(M),x.progressRect=M}}if(w&&C.appendChild(w),B&&p.type!=="milestone"){const{textAlign:D,textBaseline:M,fontSize:N,fontFamily:X,textOverflow:E,color:R,padding:$}=this._scene._gantt.parsedOptions.taskBarLabelStyle,K=Je(et($),D,M,b,y),V=ei({x:K.x,y:K.y,fontSize:N,fill:R,fontFamily:X,text:Pi(this._scene._gantt.parsedOptions.taskBarLabelText,p),maxLineWidth:b-10,textBaseline:M,textAlign:D,ellipsis:E==="clip"?"":E==="ellipsis"?"...":G(E)?E:void 0,poptip:{position:"bottom",dx:(b-10)/4}});C.appendChild(V),x.textLabel=V}return x}updateTaskBarNode(e,t){const i=this.getTaskBarNodeByIndex(e,t);i&&this.barContainer.removeChild(i);const a=this.initBar(e,t);a&&this.barContainer.insertInto(a,e)}initHoverBarIcons(){var e,t;const i=new A({x:0,y:0,width:100,height:100,clip:!0,pickable:!1,cornerRadius:(t=(e=this._scene._gantt.parsedOptions.taskBarHoverStyle.cornerRadius)!==null&&e!==void 0?e:Ct.cornerRadius)!==null&&t!==void 0?t:0,fill:this._scene._gantt.parsedOptions.taskBarHoverStyle.barOverlayColor,visibleAll:!1});if(this.hoverBarGroup=i,i.name="task-bar-hover-shadow",this._scene._gantt.parsedOptions.taskBarResizable){const a=new Ze({x:0,y:0,width:10,height:20,image:Pt,pickable:!0,cursor:"col-resize"});a.name="task-bar-hover-shadow-left-icon",this.hoverBarLeftIcon=a,i.appendChild(a);const n=new Ze({x:0,y:0,width:10,height:20,image:Pt,pickable:!0,cursor:"col-resize"});n.name="task-bar-hover-shadow-right-icon",this.hoverBarRightIcon=n,i.appendChild(n)}}setX(e){this.barContainer.setAttribute("x",e)}setY(e){this.barContainer.setAttribute("y",e)}refresh(){this.width=this._scene._gantt.tableNoFrameWidth,this.height=this._scene._gantt.gridHeight,this.group.setAttributes({height:this.height,width:this.width,y:this._scene._gantt.getAllHeaderRowsHeight()});const e=this.barContainer.attribute.x,t=this.barContainer.attribute.y;this.barContainer.removeAllChild(),this.group.removeChild(this.barContainer),this.initBars(),this.setX(e),this.setY(t)}resize(){this.width=this._scene._gantt.tableNoFrameWidth,this.height=this._scene._gantt.gridHeight,this.group.setAttribute("width",this.width),this.group.setAttribute("height",this.height)}showHoverBar(e,t,i,a,n){var r,l,o,h;const{startDate:d,endDate:c,taskRecord:p}=this._scene._gantt.getTaskInfoByTaskListIndex(n.task_index,n.sub_task_index);n&&n.name==="task-bar"&&n.appendChild(this.hoverBarGroup),this.hoverBarGroup.setAttribute("x",0),this.hoverBarGroup.setAttribute("y",0),this.hoverBarGroup.setAttribute("width",i),this.hoverBarGroup.setAttribute("height",a),this.hoverBarGroup.setAttribute("visibleAll",!0);const u=this._scene._gantt.getTaskBarStyle(n.task_index,n.sub_task_index);if(p.type==="milestone")this.hoverBarGroup.setAttribute("cornerRadius",n.attribute.cornerRadius);else{const b=(l=(r=this._scene._gantt.parsedOptions.taskBarHoverStyle.cornerRadius)!==null&&r!==void 0?r:u.cornerRadius)!==null&&l!==void 0?l:0;this.hoverBarGroup.setAttribute("cornerRadius",b)}(o=this.hoverBarLeftIcon)===null||o===void 0||o.setAttribute("visible",!1),(h=this.hoverBarRightIcon)===null||h===void 0||h.setAttribute("visible",!1);let g=!0,_=!0;if(p.type==="milestone")g=!1,_=!1;else if(typeof this._scene._gantt.parsedOptions.taskBarResizable=="function"){const b={index:n.task_index,startDate:d,endDate:c,taskRecord:p,ganttInstance:this._scene._gantt},S=this._scene._gantt.parsedOptions.taskBarResizable(b);Array.isArray(S)?[g,_]=S:(g=S,_=S)}else Array.isArray(this._scene._gantt.parsedOptions.taskBarResizable)?[g,_]=this._scene._gantt.parsedOptions.taskBarResizable:(g=this._scene._gantt.parsedOptions.taskBarResizable,_=this._scene._gantt.parsedOptions.taskBarResizable);g&&this.hoverBarLeftIcon.setAttribute("visible",!0),_&&this.hoverBarRightIcon.setAttribute("visible",!0),this.hoverBarLeftIcon&&(this.hoverBarLeftIcon.setAttribute("x",0),this.hoverBarLeftIcon.setAttribute("y",Math.ceil(a/10)),this.hoverBarLeftIcon.setAttribute("width",10),this.hoverBarLeftIcon.setAttribute("height",a-2*Math.ceil(a/10)),this.hoverBarRightIcon.setAttribute("x",i-10),this.hoverBarRightIcon.setAttribute("y",Math.ceil(a/10)),this.hoverBarRightIcon.setAttribute("width",10),this.hoverBarRightIcon.setAttribute("height",a-2*Math.ceil(a/10)))}hideHoverBar(){this.hoverBarGroup.setAttribute("visibleAll",!1)}createSelectedBorder(e,t,i,a,n,r=!1){const l=n.record,o=new A({x:e,y:t,width:i,height:a,pickable:!1,attachedToTaskBarNode:n,zIndex:1e4});o.name="task-bar-select-border",this.barContainer.appendChild(o),this.selectedBorders.push(o);const h=new A({x:0,y:0,width:i,height:a,lineWidth:this._scene._gantt.parsedOptions.taskBarSelectedStyle.borderLineWidth,pickable:!1,cornerRadius:n.attribute.cornerRadius,fill:!1,stroke:this._scene._gantt.parsedOptions.taskBarSelectedStyle.borderColor,shadowColor:this._scene._gantt.parsedOptions.taskBarSelectedStyle.shadowColor,shadowOffsetX:this._scene._gantt.parsedOptions.taskBarSelectedStyle.shadowOffsetX,shadowOffsetY:this._scene._gantt.parsedOptions.taskBarSelectedStyle.shadowOffsetY,shadowBlur:this._scene._gantt.parsedOptions.taskBarSelectedStyle.shadowBlur,angle:n.attribute.angle,anchor:[i/2,a/2]});if(o.appendChild(h),r){const d=l.type==="milestone"?15:10,c=new A({x:-d,y:0,width:10,height:a,pickable:!0}),p=new Wt({x:5,y:a/2,radius:this._scene._gantt.parsedOptions.dependencyLinkLineCreatePointStyle.radius,fill:this._scene._gantt.parsedOptions.dependencyLinkLineCreatePointStyle.fillColor,stroke:this._scene._gantt.parsedOptions.dependencyLinkLineCreatePointStyle.strokeColor,lineWidth:this._scene._gantt.parsedOptions.dependencyLinkLineCreatePointStyle.strokeWidth,pickable:!1});c.appendChild(p),c.name="task-bar-link-point-left",o.appendChild(c);const u=new A({x:i+(d-10),y:0,width:10,height:a,pickable:!0}),g=new Wt({x:5,y:a/2,radius:this._scene._gantt.parsedOptions.dependencyLinkLineCreatePointStyle.radius,fill:this._scene._gantt.parsedOptions.dependencyLinkLineCreatePointStyle.fillColor,stroke:this._scene._gantt.parsedOptions.dependencyLinkLineCreatePointStyle.strokeColor,lineWidth:this._scene._gantt.parsedOptions.dependencyLinkLineCreatePointStyle.strokeWidth,pickable:!1,pickStrokeBuffer:10});u.appendChild(g),u.name="task-bar-link-point-right",o.appendChild(u)}}removeSelectedBorder(){this.selectedBorders.forEach(e=>{e.delete()}),this.selectedBorders=[]}removeSecondSelectedBorder(){this.selectedBorders.length===2&&this.selectedBorders.pop().delete()}updateCreatingDependencyLine(e,t,i,a){this.creatingDependencyLine&&(this.creatingDependencyLine.delete(),this.creatingDependencyLine=void 0);const n=new ti({points:[{x:e,y:t},{x:i,y:a}],stroke:this._scene._gantt.parsedOptions.dependencyLinkLineCreatingStyle.lineColor,lineWidth:this._scene._gantt.parsedOptions.dependencyLinkLineCreatingStyle.lineWidth,lineDash:this._scene._gantt.parsedOptions.dependencyLinkLineCreatingStyle.lineDash,pickable:!1});this.creatingDependencyLine=n,this.selectedBorders[0].appendChild(n)}getTaskBarNodeByIndex(e,t){let i=this.barContainer.firstChild;if(!i)return null;for(let a=0;a<this.barContainer.childrenCount;a++){if(i.task_index===e&&(!G(t)||G(t)&&i.sub_task_index===t))return i;i=i._next}return null}}class as{constructor(e){this.markLineContainerWidth=20,this._scene=e,this.height=Math.min(e._gantt.tableNoFrameHeight,e._gantt.drawHeight)-e._gantt.getAllHeaderRowsHeight(),this.group=new A({x:0,y:e._gantt.getAllHeaderRowsHeight(),width:e._gantt.tableNoFrameWidth,height:this.height,pickable:!1,clip:!0}),this.group.name="mark-line-container",e.ganttGroup.addChild(this.group),this.markLIneContainer=new A({x:0,y:0,width:this._scene._gantt.getAllDateColsWidth(),height:this.height,pickable:!1,clip:!0}),this.group.appendChild(this.markLIneContainer),this.initMarkLines()}initMarkLines(){this._scene._gantt.parsedOptions.markLine.forEach(e=>{const t=e.style,i=this._scene._gantt.parsedOptions.timeScaleIncludeHour?j(e.date):j(e.date,!0),a=this._scene._gantt.parsedOptions.minDate,{unit:n,step:r}=this._scene._gantt.parsedOptions.reverseSortedTimelineScales[0],l=z(i,a,n,r),o=this._scene._gantt.parsedOptions.timelineColWidth*(Math.floor(l)+(e.position==="right"?1:e.position==="middle"?.5:0)),h=new A({pickable:!1,x:o-this.markLineContainerWidth/2,y:0,width:this.markLineContainerWidth,height:this.height});h.name="mark-line",this.markLIneContainer.appendChild(h);const d=q({pickable:!1,stroke:t.lineColor,lineWidth:t.lineWidth,lineDash:t.lineDash,points:[{x:this.markLineContainerWidth/2,y:0},{x:this.markLineContainerWidth/2,y:this.height}]});h.appendChild(d)})}refresh(){this.height=Math.min(this._scene._gantt.tableNoFrameHeight,this._scene._gantt.drawHeight)-this._scene._gantt.getAllHeaderRowsHeight(),this.markLIneContainer.removeAllChild(),this.group.setAttribute("height",this.height),this.markLIneContainer.setAttribute("height",this.height),this.initMarkLines()}setX(e){this.markLIneContainer.setAttribute("x",e)}}class ns{constructor(e){this._scene=e,this.createFrameBorder()}createFrameBorder(){var e,t,i,a,n,r;const l=this._scene.ganttGroup,o=this._scene._gantt.parsedOptions.outerFrameStyle;if(!o)return;const{cornerRadius:h,borderColor:d,borderLineWidth:c,borderLineDash:p}=o,u={},g={pickable:!1};if(c&&(g.stroke=!0,g.fill=!1,g.stroke=d,g.lineWidth=c,p&&(g.lineDash=p),g.lineCap="butt"),h&&(this._scene._gantt.taskListTableInstance?(g.cornerRadius=[0,(e=this._scene._gantt.parsedOptions.outerFrameStyle.cornerRadius)!==null&&e!==void 0?e:0,(t=this._scene._gantt.parsedOptions.outerFrameStyle.cornerRadius)!==null&&t!==void 0?t:0,0],u.cornerRadius=[0,(i=this._scene._gantt.parsedOptions.outerFrameStyle.cornerRadius)!==null&&i!==void 0?i:0,(a=this._scene._gantt.parsedOptions.outerFrameStyle.cornerRadius)!==null&&a!==void 0?a:0,0]):(g.cornerRadius=(n=this._scene._gantt.parsedOptions.outerFrameStyle.cornerRadius)!==null&&n!==void 0?n:0,u.cornerRadius=(r=this._scene._gantt.parsedOptions.outerFrameStyle.cornerRadius)!==null&&r!==void 0?r:0)),l.setAttributes(u),g.stroke){g.x=this._scene._gantt.taskListTableInstance?-c/2:c/2,g.y=c/2,g.pickable=!1,g.width=l.attribute.width+c+(this._scene._gantt.taskListTableInstance?this._scene._gantt.parsedOptions.verticalSplitLine.lineWidth:0),g.height=l.attribute.height+c/2+c/2;const _=Ve(g);_.name="border-rect",l.parent.insertAfter(_,l),l.border=_,this.border=_}}refresh(){this.border&&this.border.parent&&this.border.parent.removeChild(this.border),this.createFrameBorder()}resize(){var e;const{cornerRadius:t,borderColor:i,borderLineWidth:a,borderLineDash:n}=this._scene._gantt.parsedOptions.outerFrameStyle;(e=this.border)===null||e===void 0||e.setAttributes({width:this._scene.ganttGroup.attribute.width+a+(this._scene._gantt.taskListTableInstance?this._scene._gantt.parsedOptions.verticalSplitLine.lineWidth:0),height:this._scene._gantt.drawHeight+a})}}var rs=function(s,e,t,i){var a,n=arguments.length,r=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(s,e,t,i);else for(var l=s.length-1;l>=0;l--)(a=s[l])&&(r=(n<3?a(r):n>3?a(e,t,r):a(e,t))||r);return n>3&&r&&Object.defineProperty(e,t,r),r};let Qe=class{constructor(){this.time=si.beforeFillStroke,this.useStyle=!0,this.order=0,this.supportedAppName="vtable"}drawShape(s,e,t,i,a,n,r,l,o,h,d,c,p){s.name==="date-header-cell"&&s.forEachChildren(u=>{var g;if(u.name==="date-header-cell-text"&&u.attribute.textStick===!0){const _=u;_.setAttribute("dx",0);const b=_.globalAABBBounds,S=_.stage.globalAABBBounds,y=_.parent.globalAABBBounds,v=S.intersect(y);S.intersect(y)&&(b.width()>=v.width()&&_.attribute.last_dx?_.setAttribute("dx",(g=_.attribute.last_dx)!==null&&g!==void 0?g:0):S.x1>=b.x1?(_.setAttribute("dx",S.x1-b.x1),_.setAttribute("last_dx",S.x1-b.x1)):S.x2<=b.x2&&(_.setAttribute("dx",S.x2-b.x2),_.setAttribute("last_dx",S.x1-b.x1)))}})}};Qe=rs([ii()],Qe);const os=new ai((s,e,t,i)=>{s(Qe).toSelf().inSingletonScope(),s(ni).toService(Qe)});class ls{constructor(e){this._scene=e,this.createAddButton()}createAddButton(){var e;this._scene._gantt.parsedOptions.taskBarCreationCustomLayout?this.group=new A({x:0,y:0,width:100,height:100}):(this.group=new A({x:0,y:0,width:100,height:100,lineDash:this._scene._gantt.parsedOptions.taskBarCreationButtonStyle.lineDash,cursor:"pointer",lineWidth:this._scene._gantt.parsedOptions.taskBarCreationButtonStyle.lineWidth,stroke:this._scene._gantt.parsedOptions.taskBarCreationButtonStyle.lineColor,cornerRadius:(e=this._scene._gantt.parsedOptions.taskBarCreationButtonStyle.cornerRadius)!==null&&e!==void 0?e:0,fill:this._scene._gantt.parsedOptions.taskBarCreationButtonStyle.backgroundColor}),this.lineVertical=q({pickable:!1,stroke:this._scene._gantt.parsedOptions.taskBarCreationButtonStyle.lineColor,lineWidth:this._scene._gantt.parsedOptions.taskBarCreationButtonStyle.lineWidth,points:[{x:50,y:0},{x:50,y:100}]}),this.group.appendChild(this.lineVertical),this.lineHorizontal=q({pickable:!1,stroke:this._scene._gantt.parsedOptions.taskBarCreationButtonStyle.lineColor,lineWidth:this._scene._gantt.parsedOptions.taskBarCreationButtonStyle.lineWidth,points:[{x:0,y:50},{x:100,y:50}]}),this.group.appendChild(this.lineHorizontal)),this.group.name="task-creation-button",this._scene.taskBar.group.addChild(this.group)}show(e,t,i,a){if(this._scene._gantt.parsedOptions.taskBarCreationCustomLayout)this.group.appendChild(this._scene._gantt.parsedOptions.taskBarCreationCustomLayout({width:i,height:a,ganttInstance:this._scene._gantt}).rootContainer);else{const n=Math.min(i,a)/6;this.lineHorizontal.setAttribute("points",[{x:(i-4*n)/2,y:a/2},{x:(i-4*n)/2+4*n,y:a/2}]),this.lineVertical.setAttribute("points",[{x:i/2,y:(a-4*n)/2},{x:i/2,y:(a-4*n)/2+4*n}])}this.group.setAttribute("x",e),this.group.setAttribute("y",t),this.group.setAttribute("width",i),this.group.setAttribute("height",a),this.group.setAttribute("visibleAll",!0)}hide(){this.group.setAttribute("visibleAll",!1),this._scene._gantt.parsedOptions.taskBarCreationCustomLayout&&this.group.removeAllChild()}}class ds{constructor(e){this._scene=e,this.width=e._gantt.tableNoFrameWidth,this.height=e._gantt.gridHeight,this.group=new A({x:0,y:e._gantt.getAllHeaderRowsHeight(),width:this.width,height:this.height,pickable:!1,clip:!0}),this.group.name="dependency-link-container",e.ganttGroup.addChild(this.group),this.initLinkLines()}initLinkLines(){var e,t,i;if(Ft(this._scene._gantt.records),this.linkLinesContainer=new A({x:0,y:0,width:this._scene._gantt.getAllDateColsWidth(),height:this._scene._gantt.getAllTaskBarsHeight(),pickable:!1,clip:!0}),this.group.appendChild(this.linkLinesContainer),(e=this._scene._gantt.records)===null||e===void 0?void 0:e.length)for(let a=0;(i=a<((t=this._scene._gantt.parsedOptions.dependencyLinks)===null||t===void 0?void 0:t.length))!==null&&i!==void 0&&i;a++)this.initLinkLine(a)}initLinkLine(e){var t,i;const{taskKeyField:a,dependencyLinks:n}=this._scene._gantt.parsedOptions,r=n[e],{linkedToTaskKey:l,linkedFromTaskKey:o,type:h}=r,d=ie(this._scene._gantt.records,a,l),c=ie(this._scene._gantt.records,a,o);if(!d||!c)return;let p,u,g,_,b,S,y,v;if(d.record.vtable_gantt_linkedTo||(d.record.vtable_gantt_linkedTo=[]),d.record.vtable_gantt_linkedTo.push(r),c.record.vtable_gantt_linkedFrom||(c.record.vtable_gantt_linkedFrom=[]),c.record.vtable_gantt_linkedFrom.push(r),this._scene._gantt.parsedOptions.tasksShowMode===T.Sub_Tasks_Inline?(v=c.index[0],y=d.index[0],{startDate:p,endDate:u,taskDays:g}=this._scene._gantt.getTaskInfoByTaskListIndex(d.index[0],d.index[1]),{startDate:_,endDate:b,taskDays:S}=this._scene._gantt.getTaskInfoByTaskListIndex(c.index[0],c.index[1])):this._scene._gantt.parsedOptions.tasksShowMode===T.Sub_Tasks_Separate||this._scene._gantt.parsedOptions.tasksShowMode===T.Sub_Tasks_Arrange||this._scene._gantt.parsedOptions.tasksShowMode===T.Sub_Tasks_Compact?(v=this._scene._gantt.getRowsHeightByIndex(0,c.index[0]-1)/this._scene._gantt.parsedOptions.rowHeight+(this._scene._gantt.parsedOptions.tasksShowMode===T.Sub_Tasks_Arrange||this._scene._gantt.parsedOptions.tasksShowMode===T.Sub_Tasks_Compact?c.record.vtable_gantt_showIndex:(t=c.index[1])!==null&&t!==void 0?t:0),y=this._scene._gantt.getRowsHeightByIndex(0,d.index[0]-1)/this._scene._gantt.parsedOptions.rowHeight+(this._scene._gantt.parsedOptions.tasksShowMode===T.Sub_Tasks_Arrange||this._scene._gantt.parsedOptions.tasksShowMode===T.Sub_Tasks_Compact?d.record.vtable_gantt_showIndex:(i=d.index[1])!==null&&i!==void 0?i:0),{startDate:p,endDate:u,taskDays:g}=this._scene._gantt.getTaskInfoByTaskListIndex(d.index[0],d.index[1]),{startDate:_,endDate:b,taskDays:S}=this._scene._gantt.getTaskInfoByTaskListIndex(c.index[0],c.index[1])):(v=this._scene._gantt.getTaskShowIndexByRecordIndex(c.index),y=this._scene._gantt.getTaskShowIndexByRecordIndex(d.index),{startDate:p,endDate:u,taskDays:g}=this._scene._gantt.getTaskInfoByTaskListIndex(y),{startDate:_,endDate:b,taskDays:S}=this._scene._gantt.getTaskInfoByTaskListIndex(v)),!S||!g)return;j(this._scene._gantt.parsedOptions.minDate);const{arrowPoints:L,linePoints:k}=hs(h,_,b,v,S,c.record.type==="milestone",p,u,y,g,d.record.type==="milestone",this._scene._gantt),f=this._scene._gantt.parsedOptions.dependencyLinkLineStyle,x=q({pickable:!0,stroke:f.lineColor,lineWidth:f.lineWidth,lineDash:f.lineDash,points:k,pickStrokeBuffer:3,vtable_link:r});this.linkLinesContainer.appendChild(x),r.vtable_gantt_linkLineNode=x;const C=new ri({fill:f.lineColor,points:L});this.linkLinesContainer.appendChild(C),r.vtable_gantt_linkArrowNode=C}setX(e){this.linkLinesContainer.setAttribute("x",e)}setY(e){this.linkLinesContainer.setAttribute("y",e)}refresh(){this.width=this._scene._gantt.tableNoFrameWidth,this.height=this._scene._gantt.gridHeight,this.group.setAttributes({height:this.height,width:this.width,y:this._scene._gantt.getAllHeaderRowsHeight()});const e=this.linkLinesContainer.attribute.x,t=this.linkLinesContainer.attribute.y;this.linkLinesContainer.removeAllChild(),this.group.removeChild(this.linkLinesContainer),this.initLinkLines(),this.setX(e),this.setY(t)}resize(){this.width=this._scene._gantt.tableNoFrameWidth,this.height=this._scene._gantt.gridHeight,this.group.setAttribute("width",this.width),this.group.setAttribute("height",this.height)}createSelectedLinkLine(e){const t=e.vtable_gantt_linkLineNode,i=e.vtable_gantt_linkArrowNode,a=t.clone(),n=i.clone();a.setAttribute("stroke",this._scene._gantt.parsedOptions.dependencyLinkSelectedLineStyle.lineColor),a.setAttribute("lineWidth",this._scene._gantt.parsedOptions.dependencyLinkSelectedLineStyle.lineWidth),a.setAttribute("shadowColor",this._scene._gantt.parsedOptions.dependencyLinkSelectedLineStyle.shadowColor),a.setAttribute("shadowOffsetX",this._scene._gantt.parsedOptions.dependencyLinkSelectedLineStyle.shadowOffset),a.setAttribute("shadowOffsetY",this._scene._gantt.parsedOptions.dependencyLinkSelectedLineStyle.shadowOffset),a.setAttribute("shadowBlur",this._scene._gantt.parsedOptions.dependencyLinkSelectedLineStyle.shadowBlur),this.linkLinesContainer.appendChild(a),n.setAttribute("fill",this._scene._gantt.parsedOptions.dependencyLinkSelectedLineStyle.lineColor),this.linkLinesContainer.appendChild(n),this.selectedEffectNodes=[a,n]}removeSelectedLinkLine(){var e;(e=this.selectedEffectNodes)===null||e===void 0||e.forEach(t=>{t.delete()}),this.selectedEffectNodes=[]}deleteLink(e){const t=e.vtable_gantt_linkLineNode,i=e.vtable_gantt_linkArrowNode;t.delete(),i.delete()}}function hs(s,e,t,i,a,n,r,l,o,h,d,c){const{unit:p,step:u}=c.parsedOptions.reverseSortedTimelineScales[0],{minDate:g,rowHeight:_,timelineColWidth:b}=c.parsedOptions,S=c.parsedOptions.taskBarMilestoneHypotenuse;let y=[],v=[];if(s===Y.FinishToStart){let L=z(t,g,p,u,1)*b;n&&(L=z(e,g,p,u,1)*b+S/2);let k=z(r,g,p,u)*b;d&&(k-=S/2),y=[{x:L,y:_*(i+.5)},{x:L+20,y:_*(i+.5)},{x:L+20,y:_*(i+(i>o?0:1))},{x:k-20,y:_*(i+(i>o?0:1))},{x:k-20,y:_*(o+.5)},{x:k,y:_*(o+.5)}],L+20<=k-20&&y.splice(2,3,{x:L+20,y:_*(o+.5)});const f=y[y.length-1];v=[{x:f.x,y:f.y},{x:f.x-10,y:f.y-5},{x:f.x-10,y:f.y+5},{x:f.x,y:f.y}]}else if(s===Y.StartToFinish){let L=z(e,g,p,u)*b;n&&(L-=S/2);let k=z(l,g,p,u,1)*b;d&&(k=z(r,g,p,u,1)*b+S/2),y=[{x:L,y:_*(i+.5)},{x:L-20,y:_*(i+.5)},{x:L-20,y:_*(i+(i>o?0:1))},{x:k+20,y:_*(i+(i>o?0:1))},{x:k+20,y:_*(o+.5)},{x:k,y:_*(o+.5)}],L-20>=k+20&&y.splice(2,3,{x:L-20,y:_*(o+.5)});const f=y[y.length-1];v=[{x:f.x,y:f.y},{x:f.x+10,y:f.y-5},{x:f.x+10,y:f.y+5},{x:f.x,y:f.y}]}else if(s===Y.StartToStart){let L=z(e,g,p,u)*b;n&&(L-=S/2);let k=z(r,g,p,u)*b;d&&(k-=S/2),y=[{x:L,y:_*(i+.5)},{x:(i===o?L:Math.min(L,k))-20,y:_*(i+.5)},{x:(i===o?L:Math.min(L,k))-20,y:_*(o+(i===o?1:.5))},{x:k-20,y:_*(o+(i===o?1:.5))},{x:(i===o?k:Math.min(L,k))-20,y:_*(o+.5)},{x:k,y:_*(o+.5)}];const f=y[y.length-1];v=[{x:f.x,y:f.y},{x:f.x-10,y:f.y-5},{x:f.x-10,y:f.y+5},{x:f.x,y:f.y}]}else if(s===Y.FinishToFinish){let L=z(t,g,p,u,1)*b;n&&(L=z(e,g,p,u,1)*b+S/2);let k=z(l,g,p,u,1)*b;d&&(k=z(r,g,p,u,1)*b+S/2),y=[{x:L,y:_*(i+.5)},{x:(i===o?L:Math.max(L,k))+20,y:_*(i+.5)},{x:(i===o?L:Math.max(L,k))+20,y:_*(o+(i===o?1:.5))},{x:k+20,y:_*(o+(i===o?1:.5))},{x:k+20,y:_*(o+.5)},{x:k,y:_*(o+.5)}];const f=y[y.length-1];v=[{x:f.x,y:f.y},{x:f.x+10,y:f.y-5},{x:f.x+10,y:f.y+5},{x:f.x,y:f.y}]}return{linePoints:y,arrowPoints:v}}function Et(s,e,t,i,a,n,r,l,o,h,d,c,p,u,g,_){const{unit:b,step:S}=_.parsedOptions.reverseSortedTimelineScales[0],{minDate:y,rowHeight:v,timelineColWidth:L}=_.parsedOptions,k=_.parsedOptions.taskBarMilestoneHypotenuse,f=_.parsedOptions.taskBarMilestoneStyle.width;let x=[],C=[];if(s===Y.FinishToStart){let w=r?r.attribute.x+r.attribute.width:z(t,y,b,S,1)*L;n&&(w=r?r.attribute.x+r.attribute.width+(k-f)/2:z(e,y,b,S,1)*L+k/2);let O=u?u.attribute.x:z(o,y,b,S)*L;p&&(O-=(k-f)/2),x=[{x:w,y:v*(i+.5)+l},{x:w+20,y:v*(i+.5)+l},{x:w+20,y:v*(i+(i>d?0:1))+l},{x:O-20,y:v*(i+(i>d?0:1))+l},{x:O-20,y:v*(d+.5)+g},{x:O,y:v*(d+.5)+g}],w+20<=O-20&&x.splice(2,3,{x:w+20,y:v*(d+.5)+g});const B=x[x.length-1];C=[{x:B.x,y:B.y},{x:B.x-10,y:B.y-5},{x:B.x-10,y:B.y+5},{x:B.x,y:B.y}]}else if(s===Y.StartToFinish){let w=r?r.attribute.x:z(e,y,b,S)*L;n&&(w-=(k-f)/2);let O=u?u.attribute.x+u.attribute.width:z(h,y,b,S,1)*L;p&&(O=u?u.attribute.x+u.attribute.width+(k-f)/2:z(o,y,b,S,1)*L+k/2),x=[{x:w,y:v*(i+.5)+l},{x:w-20,y:v*(i+.5)+l},{x:w-20,y:v*(i+(i>d?0:1))+l},{x:O+20,y:v*(i+(i>d?0:1))+l},{x:O+20,y:v*(d+.5)+g},{x:O,y:v*(d+.5)+g}],w-20>=O+20&&x.splice(2,3,{x:w-20,y:v*(d+.5)+g});const B=x[x.length-1];C=[{x:B.x,y:B.y},{x:B.x+10,y:B.y-5},{x:B.x+10,y:B.y+5},{x:B.x,y:B.y}]}else if(s===Y.StartToStart){let w=r?r.attribute.x:z(e,y,b,S)*L;n&&(w-=(k-f)/2);let O=u?u.attribute.x:z(o,y,b,S)*L;p&&(O-=(k-f)/2),x=[{x:w,y:v*(i+.5)+l},{x:(i===d?w:Math.min(w,O))-20,y:v*(i+.5)+l},{x:(i===d?w:Math.min(w,O))-20,y:v*(d+(i===d?1:.5))+g},{x:O-20,y:v*(d+(i===d?1:.5))+g},{x:(i===d?O:Math.min(w,O))-20,y:v*(d+.5)+g},{x:O,y:v*(d+.5)+g}];const B=x[x.length-1];C=[{x:B.x,y:B.y},{x:B.x-10,y:B.y-5},{x:B.x-10,y:B.y+5},{x:B.x,y:B.y}]}else if(s===Y.FinishToFinish){let w=r?r.attribute.x+r.attribute.width:z(t,y,b,S,1)*L;n&&(w=r?r.attribute.x+r.attribute.width+(k-f)/2:z(e,y,b,S,1)*L+k/2);let O=u?u.attribute.x+u.attribute.width:z(h,y,b,S,1)*L;p&&(O=u?u.attribute.x+u.attribute.width+(k-f)/2:z(o,y,b,S,1)*L+k/2),x=[{x:w,y:v*(i+.5)+l},{x:(i===d?w:Math.max(w,O))+20,y:v*(i+.5)+l},{x:(i===d?w:Math.max(w,O))+20,y:v*(d+(i===d?1:.5))+g},{x:O+20,y:v*(d+(i===d?1:.5))+g},{x:O+20,y:v*(d+.5)+g},{x:O,y:v*(d+.5)+g}];const B=x[x.length-1];C=[{x:B.x,y:B.y},{x:B.x+10,y:B.y-5},{x:B.x+10,y:B.y+5},{x:B.x,y:B.y}]}return{linePoints:x,arrowPoints:C}}class cs{constructor(e){this._scene=e,this.dragLineContainer=new A({x:0,y:0,width:e._gantt.tableNoFrameWidth,height:Math.min(e._gantt.tableNoFrameHeight,e._gantt.drawHeight),pickable:!1,clip:!0,visible:!1}),this.dragLineContainer.name="drag-order-line-container",e.ganttGroup.addChild(this.dragLineContainer),this.initDragLine()}initDragLine(){if(this._scene._gantt.taskListTableInstance){const e=this._scene._gantt.taskListTableInstance.theme.dragHeaderSplitLine,t=q({pickable:!1,stroke:e.lineColor,lineWidth:e.lineWidth,points:[]});this.dragLine=t,this.dragLineContainer.appendChild(t)}}showDragLine(e){this.dragLineContainer.showAll(),this.dragLine.setAttribute("points",[{x:0,y:e},{x:this._scene._gantt.tableNoFrameWidth,y:e}])}hideDragLine(){this.dragLineContainer.hideAll()}}li.load(os);class ps{constructor(e){let t,i;this._gantt=e,this.tableGroupWidth=e.tableNoFrameWidth,this.tableGroupHeight=Math.min(e.tableNoFrameHeight,e.drawHeight),F.mode==="node"||(Re.setEnv("browser"),t=e.canvas.width,i=e.canvas.height),this.stage=oi({canvas:e.canvas,width:t,height:i,disableDirtyBounds:!1,background:e.parsedOptions.underlayBackgroundColor,enableLayout:!0,autoRender:!1,context:{appName:"vtable"},pluginList:["poptipForText"]}),this.stage.gantt=this._gantt,this.stage.table=this._gantt,this.stage.defaultLayer.setTheme({group:{boundsPadding:0,strokeBoundsBuffer:0,lineJoin:"round"},text:{ignoreBuf:!0}}),this.initSceneGraph()}initSceneGraph(){this.ganttGroup=new A({x:this._gantt.tableX,y:this._gantt.tableY,width:this.tableGroupWidth,height:this.tableGroupHeight,clip:!0,pickable:!1}),this.stage.defaultLayer.add(this.ganttGroup),this.ganttGroup.name="table",this.timelineHeader=new ts(this),this.grid=new ji(this),this.dependencyLink=new ds(this),this.taskBar=new ss(this),this.markLine=new as(this),this.frameBorder=new ns(this),this.scrollbarComponent=new Yi(this._gantt),this.stage.defaultLayer.addChild(this.scrollbarComponent.hScrollBar),this.stage.defaultLayer.addChild(this.scrollbarComponent.vScrollBar),this.dragOrderLine=new cs(this)}updateSceneGraph(){const e=this._gantt;let t,i;this.tableGroupWidth=e.tableNoFrameWidth,this.tableGroupHeight=Math.min(e.tableNoFrameHeight,e.drawHeight),F.mode==="node"||(Re.setEnv("browser"),t=e.canvas.width,i=e.canvas.height),this.stage.resize(t,i),this.refreshAll()}afterCreateSceneGraph(){this.scrollbarComponent.updateScrollBar(),es(this._gantt.eventManager)}refreshAll(){this.tableGroupHeight=Math.min(this._gantt.tableNoFrameHeight,this._gantt.drawHeight),this.tableGroupWidth=this._gantt.tableNoFrameWidth,this.ganttGroup.setAttribute("height",this.tableGroupHeight),this.ganttGroup.setAttribute("width",this.tableGroupWidth),this.timelineHeader.refresh(),this.grid.refresh(),this.taskBar.refresh(),this.dependencyLink.refresh(),this.markLine.refresh(),this.dependencyLink.refresh(),this.frameBorder.refresh(),this.scrollbarComponent.updateScrollBar(),this.updateNextFrame()}refreshTaskBars(){this.dependencyLink.refresh(),this.taskBar.refresh(),this.updateNextFrame()}refreshTaskBarsAndGrid(){this._gantt.verticalSplitResizeLine.style.height=this._gantt.drawHeight+"px",this.tableGroupHeight=Math.min(this._gantt.tableNoFrameHeight,this._gantt.drawHeight),this.ganttGroup.setAttribute("height",this.tableGroupHeight),this.grid.refresh(),this.taskBar.refresh(),this.dependencyLink.refresh(),this.markLine.refresh(),this.frameBorder.resize(),this.scrollbarComponent.updateScrollBar(),this.updateNextFrame()}updateTableSize(){this.tableGroupHeight=Math.min(this._gantt.tableNoFrameHeight,this._gantt.drawHeight),this.tableGroupWidth=this._gantt.tableNoFrameWidth,this.ganttGroup.setAttributes({x:this._gantt.tableX,y:this._gantt.tableY,width:this._gantt.tableNoFrameWidth,height:this.tableGroupHeight}),this.grid.resize(),this.taskBar.resize(),this.dependencyLink.resize(),this.markLine.refresh(),this.frameBorder.resize()}updateStageBackground(){this.stage.background=this._gantt.parsedOptions.underlayBackgroundColor,this.updateNextFrame()}renderSceneGraph(){this.stage.render()}updateNextFrame(){this.stage.renderNextFrame()}get width(){var e,t;return(t=(e=this.ganttGroup.attribute)===null||e===void 0?void 0:e.width)!==null&&t!==void 0?t:0}get height(){var e,t;return(t=(e=this.ganttGroup.attribute)===null||e===void 0?void 0:e.height)!==null&&t!==void 0?t:0}get x(){var e,t;return(t=(e=this.ganttGroup.attribute)===null||e===void 0?void 0:e.x)!==null&&t!==void 0?t:0}get y(){var e,t;return(t=(e=this.ganttGroup.attribute)===null||e===void 0?void 0:e.y)!==null&&t!==void 0?t:0}setX(e,t=!1){this.timelineHeader.setX(e),this.grid.setX(e),this.taskBar.setX(e),this.dependencyLink.setX(e),this.markLine.setX(e),this.updateNextFrame()}setY(e,t=!1){this.grid.setY(e),this.taskBar.setY(e),this.dependencyLink.setY(e),this.updateNextFrame()}setPixelRatio(e){this.stage.disableDirtyBounds(),this.stage.window.setDpr(e),this.stage.render(),this.stage.enableDirtyBounds()}resize(){this.updateTableSize(),this.scrollbarComponent.updateScrollBar(),this.updateNextFrame()}release(){this.stage.release()}showTaskCreationButton(e,t,i){this.taskCreationButton||(this.taskCreationButton=new ls(this._gantt.scenegraph));const a=this._gantt.parsedOptions.taskBarCreationMaxWidth,n=this._gantt.parsedOptions.taskBarCreationMinWidth,r=this._gantt.getDateColWidth(i),l=a?Math.min(a,n?Math.max(n,r):r):n?Math.max(n,r):r,o=e-(l-r)/2;this.taskCreationButton.show(o,t,l,this._gantt.parsedOptions.rowHeight),this.updateNextFrame()}hideTaskCreationButton(){this.taskCreationButton&&(this.taskCreationButton.hide(),this.updateNextFrame())}refreshRecordLinkNodes(e,t,i,a=0){const n=this._gantt,r=n.getRecordByIndex(e,t),l=r.vtable_gantt_linkedTo,o=r.vtable_gantt_linkedFrom;for(let h=0;h<(l==null?void 0:l.length);h++){const d=l[h],c=d.vtable_gantt_linkLineNode,p=d.vtable_gantt_linkArrowNode,{linkedToTaskKey:u,linkedFromTaskKey:g,type:_}=d,{taskKeyField:b,minDate:S}=n.parsedOptions,y=ie(n.records,b,g),v=ie(n.records,b,u);let L,k,f,x,C,w,O,B,D;const M=this._gantt.getTaskBarStyle(e,t);if(n.parsedOptions.tasksShowMode===T.Sub_Tasks_Inline){const E=J(i.attribute.y+a,n);B=y.index[0],O=n.getRowsHeightByIndex(0,E.task_index-1)/n.parsedOptions.rowHeight,{startDate:L,endDate:k,taskDays:f}=n.getTaskInfoByTaskListIndex(v.index[0],v.index[1]),{startDate:x,endDate:C,taskDays:w}=n.getTaskInfoByTaskListIndex(y.index[0],y.index[1]);const R=M.width;D=i.attribute.y+R/2-(O+.5)*n.parsedOptions.rowHeight}else if(n.parsedOptions.tasksShowMode===T.Sub_Tasks_Separate||n.parsedOptions.tasksShowMode===T.Sub_Tasks_Arrange||n.parsedOptions.tasksShowMode===T.Sub_Tasks_Compact){const E=J(i.attribute.y+a,n);B=n.getRowsHeightByIndex(0,y.index[0]-1)/n.parsedOptions.rowHeight+(n.parsedOptions.tasksShowMode===T.Sub_Tasks_Arrange||n.parsedOptions.tasksShowMode===T.Sub_Tasks_Compact?y.record.vtable_gantt_showIndex:y.index[1]),O=n.getRowsHeightByIndex(0,E.task_index-1)/n.parsedOptions.rowHeight+(n.parsedOptions.tasksShowMode===T.Sub_Tasks_Arrange||n.parsedOptions.tasksShowMode===T.Sub_Tasks_Compact?v.record.vtable_gantt_showIndex:E.sub_task_index),{startDate:L,endDate:k,taskDays:f}=n.getTaskInfoByTaskListIndex(v.index[0],v.index[1]),{startDate:x,endDate:C,taskDays:w}=n.getTaskInfoByTaskListIndex(y.index[0],y.index[1]);const R=M.width;D=i.attribute.y+R/2-(O+.5)*n.parsedOptions.rowHeight}else{if(B=n.getTaskShowIndexByRecordIndex(y.index),O=n.getTaskShowIndexByRecordIndex(v.index),B===-1||O===-1)continue;({startDate:L,endDate:k,taskDays:f}=n.getTaskInfoByTaskListIndex(O)),{startDate:x,endDate:C,taskDays:w}=n.getTaskInfoByTaskListIndex(B)}if(!(x&&C&&L&&k&&c&&p))return;const{linePoints:N,arrowPoints:X}=Et(_,x,C,B,w,y.record.type==="milestone",null,0,L,k,O,f,v.record.type==="milestone",i,D??0,this._gantt);c.setAttribute("points",N),p.setAttribute("points",X)}for(let h=0;h<(o==null?void 0:o.length);h++){const d=o[h],c=d.vtable_gantt_linkLineNode,p=d.vtable_gantt_linkArrowNode,{linkedToTaskKey:u,linkedFromTaskKey:g,type:_}=d,{taskKeyField:b,minDate:S}=n.parsedOptions,y=ie(n.records,b,u),v=ie(n.records,b,g);let L,k,f,x,C,w,O,B,D;const M=this._gantt.getTaskBarStyle(e,t);if(n.parsedOptions.tasksShowMode===T.Sub_Tasks_Inline){const E=J(i.attribute.y+a,n);B=n.getRowsHeightByIndex(0,E.task_index-1)/n.parsedOptions.rowHeight,O=y.index[0],{startDate:L,endDate:k,taskDays:f}=n.getTaskInfoByTaskListIndex(y.index[0],y.index[1]),{startDate:x,endDate:C,taskDays:w}=n.getTaskInfoByTaskListIndex(v.index[0],v.index[1]);const R=M.width;D=i.attribute.y+R/2-(B+.5)*n.parsedOptions.rowHeight}else if(n.parsedOptions.tasksShowMode===T.Sub_Tasks_Separate||n.parsedOptions.tasksShowMode===T.Sub_Tasks_Arrange||n.parsedOptions.tasksShowMode===T.Sub_Tasks_Compact){const E=J(i.attribute.y+a,n);B=n.getRowsHeightByIndex(0,E.task_index-1)/n.parsedOptions.rowHeight+(n.parsedOptions.tasksShowMode===T.Sub_Tasks_Arrange||n.parsedOptions.tasksShowMode===T.Sub_Tasks_Compact?v.record.vtable_gantt_showIndex:E.sub_task_index),O=n.getRowsHeightByIndex(0,y.index[0]-1)/n.parsedOptions.rowHeight+(n.parsedOptions.tasksShowMode===T.Sub_Tasks_Arrange||n.parsedOptions.tasksShowMode===T.Sub_Tasks_Compact?y.record.vtable_gantt_showIndex:y.index[1]),{startDate:L,endDate:k,taskDays:f}=n.getTaskInfoByTaskListIndex(y.index[0],y.index[1]),{startDate:x,endDate:C,taskDays:w}=n.getTaskInfoByTaskListIndex(v.index[0],v.index[1]);const R=M.width;D=i.attribute.y+R/2-(B+.5)*n.parsedOptions.rowHeight}else{if(B=n.getTaskShowIndexByRecordIndex(v.index),O=n.getTaskShowIndexByRecordIndex(y.index),B===-1||O===-1)continue;({startDate:L,endDate:k,taskDays:f}=n.getTaskInfoByTaskListIndex(O)),{startDate:x,endDate:C,taskDays:w}=n.getTaskInfoByTaskListIndex(B)}if(!(x&&C&&L&&k&&c&&p))return;const{linePoints:N,arrowPoints:X}=Et(_,x,C,B,w,v.record.type==="milestone",i,D??0,L,k,O,f,y.record.type==="milestone",null,0,this._gantt);c.setAttribute("points",N),p.setAttribute("points",X)}}}const us=s=>{switch(Object.prototype.toString.call(s)){case"[object Object]":return"object";case"[object Function]":return"function";case"[object Array]":return"array";case"[object String]":return"string";case"[object Number]":return"number";case"[object RegExp]":return"regExp";case"[object Boolean]":return"boolean";case"[object Symbol]":return"symbol";case"[object Date]":return"date";case"[object Undefined]":return"undefined";case"[object Null]":return"null";case"[object Error]":return"error";case"[object HTMLDocument]":return"document";case"[object global]":return"global";default:return null}},gs=(s,e)=>us(s)===e,_s=s=>gs(s,"object");function Vt(s,e,t){let i,a,n,r,l,o,h=0,d=!1,c=!1,p=!0;const u=!e&&e!==0&&typeof requestAnimationFrame=="function";if(typeof s!="function")throw new TypeError("Expected a function");function g(y){const v=i,L=a;return a=void 0,i=void 0,h=y,r=s.apply(L,v),r}function _(y,v){return u?requestAnimationFrame(y):setTimeout(y,v)}function b(y){const v=y-o;return o===void 0||v>=e||v<0||d&&y-h>=n}function S(){const y=Date.now();if(b(y))return function(v){return l=void 0,p&&i?g(v):(a=void 0,i=void 0,r)}(y);l=_(S,function(v){const L=v-h,k=e&&-(v-o);return d?Math.min(k,n-L):k}(y))}return e=+e||0,_s(t)&&(c=!!t.leading,d="maxWait"in t,d&&(n=Math.max(+t.maxWait||0,e)),p="trailing"in t?!!t.trailing:p),function(...y){const v=Date.now(),L=b(v);if(i=y,a=this,o=v,L){if(l===void 0)return function(k){return h=k,l=_(S,e),c?g(k):r}(o);if(d)return l=_(S,e),g(o)}return l===void 0&&(l=_(S,e)),r}}let bs=1;class vs{constructor(e,t,i){var a;if(this.resizeTime=100,this.lastSize={width:0,height:0},this.mutationResize=()=>{this.onResize()},this.callBack=()=>{const n=this.getSize();let r=!1;n.width===this.lastSize.width&&n.height===this.lastSize.height&&(r=!0),this.lastSize=n,this.cb&&this.cb(Object.assign(Object.assign({},this.lastSize),{windowSizeNotChange:r}))},this.onResize=()=>{this.callBackDebounce()},this.element=e,this.cb=t,this.lastSize=this.getSize(),i&&(this.resizeTime=Math.max(i,16)),this.callBackDebounce=Vt(this.callBack,this.resizeTime),window==null||window.addEventListener("resize",this.onResize),"ResizeObserver"in window){const n=window.ResizeObserver;this.observer=new n(this.mutationResize),(a=this.observer)===null||a===void 0||a.observe(this.element)}else"MutationObserver"in window&&(this.observer=new MutationObserver(this.mutationResize),this.observer.observe(this.element,{attributes:!0,attributeFilter:["style"]}))}disConnect(){window.removeEventListener("resize",this.onResize),this.observer&&(this.observer.disconnect(),this.observer=void 0)}setSize(e){this.lastSize=e}checkSize(){const e=this.getSize();return e.width!==this.lastSize.width||e.height!==this.lastSize.height}getSize(){return this.element?{width:Math.floor(this.element.clientWidth),height:Math.floor(this.element.clientHeight)}:Object.assign({},this.lastSize)}}class ms{constructor(){this.listeners={},this.reseizeListeners={}}on(e,t,i,...a){if(F.mode==="node")return-1;const n=bs++;if(e!=null&&e.addEventListener)if(t!=="resize"||e===window)e==null||e.addEventListener(t,i,...a);else{const l=new vs(e,i,this.resizeTime);this.reseizeListeners[n]=l}const r={target:e,type:t,listener:i,options:a};return this.listeners[n]=r,n}once(e,t,i,...a){if(F.mode==="node")return-1;const n=this.on(e,t,(...r)=>{this.off(n),i(...r)},...a);return n}off(e){var t;if(F.mode==="node"||e==null)return;const i=(t=this.listeners)===null||t===void 0?void 0:t[e];i&&(delete this.listeners[e],i.target.removeEventListener&&i.target.removeEventListener(i.type,i.listener,...i.options))}fire(e,t,...i){if(F.mode!=="node")for(const a in this.listeners){const n=this.listeners[a];n.target===e&&n.type===t&&n.listener.call(n.target,...i)}}hasListener(e,t){if(F.mode==="node")return!1;let i=!1;for(const a in this.listeners){const n=this.listeners[a];n.target===e&&n.type===t&&(i=!0)}return i}clear(){if(F.mode!=="node"){for(const e in this.listeners){const t=this.listeners[e];t.target.removeEventListener&&t.target.removeEventListener(t.type,t.listener,...t.options)}for(const e in this.reseizeListeners){const t=this.reseizeListeners[e];t==null||t.disConnect()}this.listeners={}}}release(){F.mode!=="node"&&(this.clear(),this.listeners={})}}let Ee=1;function Kt(){return fi?Ee=1:(Ee=Math.ceil(window.devicePixelRatio||1),Ee>1&&Ee%2!=0&&(Ee+=1)),Ee}Kt();class ys{constructor(e){this.isDown=!1,this.isDraging=!1,this.globalEventListeners=[],this._gantt=e,this._eventHandler=new ms,this.bindEvent()}release(){this._eventHandler.release(),this.globalEventListeners.forEach(e=>{e.env==="document"?document.removeEventListener(e.name,e.callback):e.env==="body"?document.body.removeEventListener(e.name,e.callback):e.env==="window"&&window.removeEventListener(e.name,e.callback)}),this.globalEventListeners=[]}bindEvent(){ks(this),fs(this)}}function ks(s){const e=s._gantt.scenegraph,t=s._gantt,i=t.stateManager;e.ganttGroup.addEventListener("pointerdown",a=>{if(a.button!==0)return;let n,r,l;if(a.detailPath.find(o=>o.name==="task-bar"?(n=o,!0):o.name==="task-creation-button"?!0:o.name==="task-bar-link-point-left"?(r=o,!0):o.name==="task-bar-link-point-right"?(l=o,!0):!!o.attribute.vtable_link&&(o.attribute.vtable_link,!0)),n){if(a.target.name==="task-bar-hover-shadow-left-icon")i.startResizeTaskBar(n,a.nativeEvent.x,a.nativeEvent.y,a.offset.y,"left"),i.updateInteractionState(P.grabing);else if(a.target.name==="task-bar-hover-shadow-right-icon")i.startResizeTaskBar(n,a.nativeEvent.x,a.nativeEvent.y,a.offset.y,"right"),i.updateInteractionState(P.grabing);else if(t.parsedOptions.taskBarMoveable){let o=!0;if(typeof t.parsedOptions.taskBarMoveable=="function"){const{startDate:h,endDate:d,taskRecord:c}=e._gantt.getTaskInfoByTaskListIndex(n.task_index,n.sub_task_index),p={index:n.task_index,startDate:h,endDate:d,taskRecord:c,ganttInstance:e._gantt};o=t.parsedOptions.taskBarMoveable(p)}else o=t.parsedOptions.taskBarMoveable;o&&(i.startMoveTaskBar(n,a.nativeEvent.x,a.nativeEvent.y,a.offset.y),i.updateInteractionState(P.grabing))}}else r?(i.startCreateDependencyLine(r,a.nativeEvent.x,a.nativeEvent.y,a.offset.y,"left"),i.updateInteractionState(P.grabing)):l&&(i.startCreateDependencyLine(l,a.nativeEvent.x,a.nativeEvent.y,a.offset.y,"right"),i.updateInteractionState(P.grabing))}),e.ganttGroup.addEventListener("pointermove",a=>{var n,r,l,o;if(i.interactionState===P.default){const h=a.detailPath.find(d=>d.name==="task-bar");if(h){if(e._gantt.stateManager.hoverTaskBar.target!==h&&(e._gantt.stateManager.hoverTaskBar.target=h,i.showTaskBarHover(),e._gantt.hasListeners(I.MOUSEENTER_TASK_BAR))){const d=h.task_index,c=h.sub_task_index,p=e._gantt.getRecordByIndex(d,c);e._gantt.fireListeners(I.MOUSEENTER_TASK_BAR,{federatedEvent:a,event:a.nativeEvent,index:d,sub_task_index:c,record:p})}}else{if(e._gantt.stateManager.hoverTaskBar.target){if(e._gantt.hasListeners(I.MOUSELEAVE_TASK_BAR)){const d=e._gantt.stateManager.hoverTaskBar.target.task_index,c=e._gantt.stateManager.hoverTaskBar.target.sub_task_index,p=e._gantt.getRecordByIndex(d,c);e._gantt.fireListeners(I.MOUSELEAVE_TASK_BAR,{federatedEvent:a,event:a.nativeEvent,index:d,sub_task_index:c,record:p})}i.hideTaskBarHover(a)}if(t.parsedOptions.taskBarCreatable){const d=J(a.offset.y-t.headerHeight+t.stateManager.scrollTop,t),c=t.getTaskInfoByTaskListIndex(d.task_index,d.sub_task_index);let p=!0;if(typeof t.parsedOptions.taskBarCreatable=="function"){const{startDate:u,endDate:g,taskRecord:_}=c,b={index:d.task_index,sub_task_index:d.sub_task_index,startDate:u,endDate:g,taskRecord:_,ganttInstance:t};p=t.parsedOptions.taskBarCreatable(b)}else p=t.parsedOptions.taskBarCreatable;if(p){const u=Wi(a.offset.x,a.offset.y,t);if((t.parsedOptions.tasksShowMode===T.Sub_Tasks_Separate||t.parsedOptions.tasksShowMode===T.Tasks_Separate)&&!c.taskDays&&c.taskRecord&&!c.taskRecord.vtableMerge||(t.parsedOptions.tasksShowMode===T.Sub_Tasks_Inline||t.parsedOptions.tasksShowMode===T.Sub_Tasks_Arrange||t.parsedOptions.tasksShowMode===T.Sub_Tasks_Compact)&&!u){const g=Fe(a.offset.x,t),_=(g>=1?t.getDateColsWidth(0,g-1):0)-t.stateManager.scroll.horizontalBarPos,b=t.taskListTableInstance.getRowsHeight(t.taskListTableInstance.columnHeaderLevelCount,d.task_index+t.taskListTableInstance.columnHeaderLevelCount-1)+((n=d.sub_task_index)!==null&&n!==void 0?n:0)*t.parsedOptions.rowHeight-t.stateManager.scroll.verticalBarPos;return void t.scenegraph.showTaskCreationButton(_,b,g)}}}}t.scenegraph.hideTaskCreationButton()}else if(i.interactionState===P.grabing){let h,d,c;a.detailPath.find(p=>p.name==="task-bar"?(h=p,!0):p.name==="task-creation-button"?!0:p.name==="task-bar-link-point-left"?(d=p,!0):p.name==="task-bar-link-point-right"?(c=p,!0):!!p.attribute.vtable_link&&(p.attribute.vtable_link,!0)),h=(l=h??((r=d==null?void 0:d.parent)===null||r===void 0?void 0:r.attribute.attachedToTaskBarNode))!==null&&l!==void 0?l:(o=c==null?void 0:c.parent)===null||o===void 0?void 0:o.attribute.attachedToTaskBarNode,e._gantt.stateManager.isCreatingDependencyLine()&&!h?i.hideSecondTaskBarSelectedBorder():e._gantt.stateManager.isCreatingDependencyLine()&&d&&e._gantt.stateManager.selectedTaskBar.target!==h?(i.highlightLinkPointNode(d),i.creatingDenpendencyLink.lastHighLightLinkPoint=d,i.creatingDenpendencyLink.secondTaskBarPosition="left"):e._gantt.stateManager.isCreatingDependencyLine()&&c&&e._gantt.stateManager.selectedTaskBar.target!==h?(i.highlightLinkPointNode(c),i.creatingDenpendencyLink.lastHighLightLinkPoint=c,i.creatingDenpendencyLink.secondTaskBarPosition="right"):e._gantt.stateManager.isCreatingDependencyLine()&&h&&e._gantt.stateManager.selectedTaskBar.target!==h&&(i.unhighlightLinkPointNode(i.creatingDenpendencyLink.lastHighLightLinkPoint),i.creatingDenpendencyLink.secondTaskBarNode&&i.creatingDenpendencyLink.secondTaskBarNode===h||(i.creatingDenpendencyLink.secondTaskBarNode&&i.creatingDenpendencyLink.secondTaskBarNode!==h&&i.hideSecondTaskBarSelectedBorder(),i.creatingDenpendencyLink.secondTaskBarNode=h,i.showSecondTaskBarSelectedBorder()))}}),e.ganttGroup.addEventListener("pointerup",a=>{var n,r;if(a.button===0){let l,o=!1,h=!1,d=!1,c=!1,p=!1;const u=a.detailPath.find(g=>g.name==="task-bar"?(o=!0,!0):g.name==="task-creation-button"?(h=!0,!1):g.name==="task-bar-link-point-left"?(c=!0,!1):g.name==="task-bar-link-point-right"?(p=!0,!1):!!g.attribute.vtable_link&&(d=!0,l=g.attribute.vtable_link,!1));if(o&&e._gantt.parsedOptions.taskBarSelectable&&s.poniterState==="down"){if(i.hideDependencyLinkSelectedLine(),i.showTaskBarSelectedBorder(u),t.hasListeners(I.CLICK_TASK_BAR)){const g=u.task_index,_=u.sub_task_index,b=t.getRecordByIndex(g,_);t.fireListeners(I.CLICK_TASK_BAR,{federatedEvent:a,event:a.nativeEvent,index:g,sub_task_index:_,record:b})}}else if(h&&s.poniterState==="down"){i.hideDependencyLinkSelectedLine(),i.hideTaskBarSelectedBorder();const g=J(a.offset.y-t.headerHeight+t.stateManager.scrollTop,t);if(t.parsedOptions.tasksShowMode===T.Sub_Tasks_Arrange||t.parsedOptions.tasksShowMode===T.Sub_Tasks_Inline||t.parsedOptions.tasksShowMode===T.Sub_Tasks_Compact){if(t.hasListeners(I.CREATE_TASK_SCHEDULE)){const _=Fe(a.offset.x,t),b=t.getDateRangeByIndex(_),S=(n=t.parsedOptions.dateFormat)!==null&&n!==void 0?n:t.parsedOptions.timeScaleIncludeHour?"yyyy-mm-dd hh:mm:ss":"yyyy-mm-dd";t.fireListeners(I.CREATE_TASK_SCHEDULE,{federatedEvent:a,event:a.nativeEvent,index:g.task_index,sub_task_index:g.sub_task_index,startDate:se(b.startDate,S),endDate:se(b.endDate,S),record:void 0,parentRecord:t.getRecordByIndex(g.task_index)})}}else{const _=t.getTaskInfoByTaskListIndex(g.task_index,g.sub_task_index);if(_.taskRecord){const b=(r=t.parsedOptions.dateFormat)!==null&&r!==void 0?r:t.parsedOptions.timeScaleIncludeHour?"yyyy-mm-dd hh:mm:ss":"yyyy-mm-dd",S=Fe(a.offset.x,t),y=t.getDateRangeByIndex(S);_.taskRecord[t.parsedOptions.startDateField]=se(y.startDate,b),_.taskRecord[t.parsedOptions.endDateField]=se(y.endDate,b),t.scenegraph.hideTaskCreationButton(),t.updateTaskRecord(_.taskRecord,g.task_index,g.sub_task_index),t.hasListeners(I.CREATE_TASK_SCHEDULE)&&t.fireListeners(I.CREATE_TASK_SCHEDULE,{federatedEvent:a,event:a.nativeEvent,index:g.task_index,sub_task_index:g.sub_task_index,startDate:_.taskRecord[t.parsedOptions.startDateField],endDate:_.taskRecord[t.parsedOptions.endDateField],record:_.taskRecord})}}}else if(d&&e._gantt.parsedOptions.dependencyLinkSelectable&&s.poniterState==="down")i.hideDependencyLinkSelectedLine(),i.hideTaskBarSelectedBorder(),e._gantt.stateManager.selectedDenpendencyLink.link=l,i.showDependencyLinkSelectedLine();else if((c||p)&&s.poniterState==="down"){if(t.hasListeners(I.CLICK_DEPENDENCY_LINK_POINT)){const g=J(a.offset.y-t.headerHeight+t.stateManager.scrollTop,t),_=t.getRecordByIndex(g.task_index,g.sub_task_index);t.fireListeners(I.CLICK_DEPENDENCY_LINK_POINT,{event:a.nativeEvent,index:g.task_index,sub_task_index:g.sub_task_index,point:c?"start":"end",record:_})}i.hideTaskBarSelectedBorder()}else if(c&&s.poniterState==="draging"){if(i.isCreatingDependencyLine()){const g=i.endCreateDependencyLine(a.offset.y);t.hasListeners(I.CREATE_DEPENDENCY_LINK)&&t.fireListeners(I.CREATE_DEPENDENCY_LINK,{federatedEvent:a,event:a.nativeEvent,link:g})}}else if(p&&s.poniterState==="draging"){if(i.isCreatingDependencyLine()){const g=i.endCreateDependencyLine(a.offset.y);t.hasListeners(I.CREATE_DEPENDENCY_LINK)&&t.fireListeners(I.CREATE_DEPENDENCY_LINK,{federatedEvent:a,event:a.nativeEvent,link:g})}}else i.hideDependencyLinkSelectedLine(),i.hideTaskBarSelectedBorder()}}),e.ganttGroup.addEventListener("rightdown",a=>{let n,r=!1,l=!1;const o=a.detailPath.find(h=>h.name==="task-bar"?(r=!0,!0):!!h.attribute.vtable_link&&(l=!0,n=h.attribute.vtable_link,!1));if(r){if(t.hasListeners(I.CONTEXTMENU_TASK_BAR)){const h=o.task_index,d=o.sub_task_index,c=t.getRecordByIndex(h,d);t.fireListeners(I.CONTEXTMENU_TASK_BAR,{federatedEvent:a,event:a.nativeEvent,index:h,sub_task_index:d,record:c})}}else l&&t.hasListeners(I.CONTEXTMENU_DEPENDENCY_LINK)&&t.fireListeners(I.CONTEXTMENU_DEPENDENCY_LINK,{federatedEvent:a,event:a.nativeEvent,link:n})}),e.ganttGroup.addEventListener("pointerenter",a=>{(t.parsedOptions.scrollStyle.horizontalVisible&&t.parsedOptions.scrollStyle.horizontalVisible==="focus"||!t.parsedOptions.scrollStyle.horizontalVisible&&t.parsedOptions.scrollStyle.visible==="focus")&&e.scrollbarComponent.showHorizontalScrollBar(),(t.parsedOptions.scrollStyle.verticalVisible&&t.parsedOptions.scrollStyle.verticalVisible==="focus"||!t.parsedOptions.scrollStyle.verticalVisible&&t.parsedOptions.scrollStyle.visible==="focus")&&e.scrollbarComponent.showVerticalScrollBar()}),e.ganttGroup.addEventListener("pointerleave",a=>{if((t.parsedOptions.scrollStyle.horizontalVisible&&t.parsedOptions.scrollStyle.horizontalVisible==="focus"||!t.parsedOptions.scrollStyle.horizontalVisible&&t.parsedOptions.scrollStyle.visible==="focus")&&e.scrollbarComponent.hideHorizontalScrollBar(),(t.parsedOptions.scrollStyle.verticalVisible&&t.parsedOptions.scrollStyle.verticalVisible==="focus"||!t.parsedOptions.scrollStyle.verticalVisible&&t.parsedOptions.scrollStyle.visible==="focus")&&e.scrollbarComponent.hideVerticalScrollBar(),e._gantt.stateManager.hoverTaskBar.target){if(e._gantt.hasListeners(I.MOUSELEAVE_TASK_BAR)){const n=e._gantt.stateManager.hoverTaskBar.target.task_index,r=e._gantt.stateManager.hoverTaskBar.target.sub_task_index,l=e._gantt.getRecordByIndex(n,r);e._gantt.fireListeners(I.MOUSELEAVE_TASK_BAR,{federatedEvent:a,event:a.nativeEvent,index:n,sub_task_index:r,record:l})}i.hideTaskBarHover(a)}}),e.ganttGroup.addEventListener("wheel",a=>{Vi(a,i,t)})}function fs(s){const e=s._gantt,t=(s._gantt.scenegraph,e.stateManager),i=s._eventHandler;i.on(e.getElement(),"contextmenu",o=>{var h;((h=e.parsedOptions.eventOptions)===null||h===void 0?void 0:h.preventDefaultContextMenu)!==!1&&o.preventDefault()}),i.on(e.getContainer(),"resize",o=>{o.width===0&&o.height===0||(G(e.options.pixelRatio)||e.setPixelRatio(Kt()),o.windowSizeNotChange||e._resize())}),e.taskListTableInstance&&e.parsedOptions.verticalSplitLineMoveable&&i.on(e.verticalSplitResizeLine,"mousedown",o=>{t.updateInteractionState(P.grabing),t.startResizeTableWidth(o)}),e.parsedOptions.verticalSplitLineHighlight&&(e.verticalSplitResizeLine&&i.on(e.verticalSplitResizeLine,"mouseover",o=>{e.verticalSplitResizeLine.childNodes[1].style.opacity="1"}),e.verticalSplitResizeLine&&i.on(e.verticalSplitResizeLine,"mouseout",o=>{e.verticalSplitResizeLine.childNodes[1].style.opacity="0"}));const a=o=>{e.eventManager.lastDragPointerXYOnWindow={x:o.x,y:o.y},e.eventManager.poniterState="down"};s.globalEventListeners.push({name:"mousedown",env:"document",callback:a}),Re.addEventListener("mousedown",a);const n=o=>{var h,d,c,p,u,g;if(e.eventManager.poniterState==="down"){const _=(h=e.eventManager.lastDragPointerXYOnWindow.x)!==null&&h!==void 0?h:o.x,b=o.x-_,S=(d=e.eventManager.lastDragPointerXYOnWindow.y)!==null&&d!==void 0?d:o.y,y=o.y-S;(Math.abs(b)>=1||Math.abs(y)>=1)&&(e.eventManager.poniterState="draging")}if(t.interactionState===P.grabing&&e.eventManager.poniterState==="draging"){const _=(p=(c=e.eventManager.lastDragPointerXYOnWindow)===null||c===void 0?void 0:c.x)!==null&&p!==void 0?p:o.x,b=(g=(u=e.eventManager.lastDragPointerXYOnWindow)===null||u===void 0?void 0:u.y)!==null&&g!==void 0?g:o.y;(Math.abs(_-o.x)>=1||Math.abs(b-o.y)>=1)&&(t.isResizingTableWidth()?(t.hideDependencyLinkSelectedLine(),t.hideTaskBarSelectedBorder(),t.dealResizeTableWidth(o)):t.isMoveingTaskBar()?(t.hideDependencyLinkSelectedLine(),t.hideTaskBarSelectedBorder(),t.dealTaskBarMove(o)):t.isResizingTaskBar()?(t.hideDependencyLinkSelectedLine(),t.hideTaskBarSelectedBorder(),t.dealTaskBarResize(o)):t.isCreatingDependencyLine()&&t.dealCreateDependencyLine(o),e.eventManager.lastDragPointerXYOnWindow={x:o.x,y:o.y})}};s.globalEventListeners.push({name:"mousemove",env:"document",callback:n}),Re.addEventListener("mousemove",n);const r=o=>{t.interactionState==="grabing"&&(t.updateInteractionState(P.default),t.isResizingTableWidth()?t.endResizeTableWidth():t.isMoveingTaskBar()?t.endMoveTaskBar():t.isResizingTaskBar()&&t.endResizeTaskBar(o.x)),e.eventManager.lastDragPointerXYOnWindow=void 0,e.eventManager.poniterState="up"};s.globalEventListeners.push({name:"mouseup",env:"document",callback:r}),Re.addEventListener("mouseup",r);const l=o=>{var h,d;if(e.parsedOptions.dependencyLinkDeletable&&(o.key==="Delete"&&(!((h=e.parsedOptions.keyboardOptions)===null||h===void 0)&&h.deleteLinkOnDel)||o.key==="Backspace"&&(!((d=e.parsedOptions.keyboardOptions)===null||d===void 0)&&d.deleteLinkOnBack))&&e.stateManager.selectedDenpendencyLink.link){const c=e.stateManager.selectedDenpendencyLink.link;e.deleteLink(e.stateManager.selectedDenpendencyLink.link),t.hideDependencyLinkSelectedLine(),t.hideTaskBarSelectedBorder(),e.hasListeners(I.DELETE_DEPENDENCY_LINK)&&e.fireListeners(I.DELETE_DEPENDENCY_LINK,{event:o,link:c})}};s.globalEventListeners.push({name:"keydown",env:"document",callback:l}),Re.addEventListener("keydown",l)}function Rt(s){const{scroll:e}=s.stateManager,{verticalBarPos:t}=e;s.taskListTableInstance.stateManager.setScrollTop(t,void 0,!1)}function Ss(s){var e;s.taskListTableInstance&&((e=s.taskListTableInstance)===null||e===void 0||e.on("scroll",t=>{if(t.scrollDirection==="vertical"){const{scroll:i}=s.taskListTableInstance.stateManager,{verticalBarPos:a}=i;s.stateManager.setScrollTop(a,!1)}}))}function Ls(s){var e;(e=s.taskListTableInstance)===null||e===void 0||e.on("change_cell_value",t=>{const{col:i,row:a,rawValue:n,changedValue:r}=t;s._refreshTaskBar(a-s.taskListTableInstance.columnHeaderLevelCount)})}function Ts(s){var e;(e=s.taskListTableInstance)===null||e===void 0||e.on("tree_hierarchy_state_change",t=>{var i;s._syncPropsFromTable(),s.scenegraph.refreshTaskBarsAndGrid(),!s.taskListTableInstance.checkHasColumnAutoWidth()||((i=s.options.taskListTable)===null||i===void 0?void 0:i.tableWidth)!=="auto"&&s.taskTableWidth!==-1||Ut(s);const a=s.stateManager.scroll.horizontalBarPos,n=s.stateManager.scroll.verticalBarPos;s.scenegraph.setX(-a),s.scenegraph.setY(-n)})}function xs(s){var e;(e=s.taskListTableInstance)===null||e===void 0||e.on("after_sort",t=>{s.scenegraph.refreshTaskBars();const i=s.stateManager.scroll.horizontalBarPos,a=s.stateManager.scroll.verticalBarPos;s.scenegraph.setX(-i),s.scenegraph.setY(-a)})}function Bs(s){var e,t,i,a;(e=s.taskListTableInstance)===null||e===void 0||e.on("change_header_position",n=>{s.parsedOptions.tasksShowMode===T.Sub_Tasks_Arrange||s.parsedOptions.tasksShowMode===T.Sub_Tasks_Compact||s.parsedOptions.tasksShowMode===T.Sub_Tasks_Separate?s.scenegraph.refreshTaskBarsAndGrid():s.scenegraph.refreshTaskBars(),s.scenegraph.dragOrderLine.hideDragLine();const r=s.stateManager.scroll.horizontalBarPos,l=s.stateManager.scroll.verticalBarPos;s.scenegraph.setX(-r),s.scenegraph.setY(-l)}),(t=s.taskListTableInstance)===null||t===void 0||t.on("change_header_position_start",n=>{const{col:r,row:l,x:o,y:h,backX:d,lineX:c,backY:p,lineY:u,event:g}=n;s.scenegraph.dragOrderLine.showDragLine(u),s.scenegraph.updateNextFrame()}),(i=s.taskListTableInstance)===null||i===void 0||i.on("changing_header_position",n=>{const{col:r,row:l,x:o,y:h,backX:d,lineX:c,backY:p,lineY:u,event:g}=n;s.scenegraph.dragOrderLine.showDragLine(u),s.scenegraph.updateNextFrame()}),(a=s.taskListTableInstance)===null||a===void 0||a.on("change_header_position_fail",n=>{s.scenegraph.dragOrderLine.hideDragLine(),s.scenegraph.updateNextFrame()})}function ws(s){var e;(e=s.taskListTableInstance)===null||e===void 0||e.on("resize_column",t=>{Ut(s)})}function Ut(s){var e,t,i,a,n,r,l,o;const h=s.taskTableWidth;s.taskTableWidth=s.taskListTableInstance.getAllColsWidth()+s.parsedOptions.outerFrameStyle.borderLineWidth,!((t=(e=s.options)===null||e===void 0?void 0:e.taskListTable)===null||t===void 0)&&t.maxTableWidth&&(s.taskTableWidth=Math.min((a=(i=s.options)===null||i===void 0?void 0:i.taskListTable)===null||a===void 0?void 0:a.maxTableWidth,s.taskTableWidth)),!((r=(n=s.options)===null||n===void 0?void 0:n.taskListTable)===null||r===void 0)&&r.minTableWidth&&(s.taskTableWidth=Math.max((o=(l=s.options)===null||l===void 0?void 0:l.taskListTable)===null||o===void 0?void 0:o.minTableWidth,s.taskTableWidth)),h!==s.taskTableWidth&&(s.element.style.left=s.taskTableWidth?`${s.taskTableWidth}px`:"0px",s.taskListTableInstance.setCanvasSize(s.taskTableWidth,s.tableNoFrameHeight+2*s.parsedOptions.outerFrameStyle.borderLineWidth),s._updateSize(),qe(s))}class Os{constructor(){}setScrollHandle(e){this.scrollHandle=e}startInertia(e,t,i){this.stopped=!1,this.lastTime=Date.now(),this.speedX=e,this.speedY=t,this.friction=i,this.runingId||(this.runingId=requestAnimationFrame(this.inertia.bind(this)))}inertia(){var e;if(this.stopped)return;const t=Date.now(),i=t-this.lastTime;let a=!0;const n=Math.pow(this.friction,i/16),r=n*this.speedX,l=n*this.speedY;let o=0,h=0;Math.abs(r)>.05&&(a=!1,o=(this.speedX+r)/2*i),Math.abs(l)>.05&&(a=!1,h=(this.speedY+l)/2*i),(e=this.scrollHandle)===null||e===void 0||e.call(this,o,h),a?this.runingId=null:(this.lastTime=t,this.speedX=r,this.speedY=l,this.runingId=requestAnimationFrame(this.inertia.bind(this)))}endInertia(){cancelAnimationFrame(this.runingId),this.runingId=null,this.stopped=!0}isInertiaScrolling(){return!!this.runingId}}class Cs{constructor(e){var t;this.interactionState=P.default,this.resetInteractionState=Vt(()=>{this.updateInteractionState(P.default)},100),this._gantt=e,this.scroll={horizontalBarPos:0,verticalBarPos:0},this.moveTaskBar={targetStartX:null,targetStartY:null,deltaX:0,deltaY:0,startOffsetY:null,startX:null,startY:null,moving:!1,target:null,moveTaskBarXSpeed:0,moveTaskBarXInertia:new Os},this.hoverTaskBar={targetStartX:null,startX:null,target:null},this.selectedTaskBar={target:null},this.resizeTaskBar={startOffsetY:null,targetStartX:null,targetEndX:null,startX:null,startY:null,target:null,resizing:!1,onIconName:""},this.resizeTableWidth={lastX:null,resizing:!1},this.selectedDenpendencyLink={link:null},this.creatingDenpendencyLink={startClickedPoint:null,startX:null,startY:null,startOffsetY:null,targetStartX:null,creating:!1,secondTaskBarNode:null},this.updateVerticalScrollBar=this.updateVerticalScrollBar.bind(this),this.updateHorizontalScrollBar=this.updateHorizontalScrollBar.bind(this),Ss(this._gantt),Ls(this._gantt),Bs(this._gantt),Ts(this._gantt),xs(this._gantt),((t=this._gantt.options.taskListTable)===null||t===void 0?void 0:t.tableWidth)!=="auto"&&this._gantt.taskTableWidth!==-1||ws(this._gantt)}setScrollTop(e,t=!0){const i=this._gantt.getAllRowsHeight();e=Math.max(0,Math.min(e,i-this._gantt.scenegraph.height)),e=Math.ceil(e);const a=this.scroll.verticalBarPos;this.scroll.verticalBarPos=e,G(this.scroll.verticalBarPos)&&!isNaN(this.scroll.verticalBarPos)||(this.scroll.verticalBarPos=0),this._gantt.scenegraph.setY(-e);const n=e/(i-this._gantt.scenegraph.height);this._gantt.scenegraph.scrollbarComponent.updateVerticalScrollBarPos(n),a!==e&&t&&(Rt(this._gantt),this._gantt.fireListeners(I.SCROLL,{scrollTop:this.scroll.verticalBarPos,scrollLeft:this.scroll.horizontalBarPos,scrollDirection:"vertical",scrollRatioY:n}))}get scrollLeft(){return this.scroll.horizontalBarPos}get scrollTop(){return this.scroll.verticalBarPos}setScrollLeft(e,t=!0){const i=this._gantt.getAllDateColsWidth();e=Math.max(0,Math.min(e,i-this._gantt.scenegraph.width)),e=Math.ceil(e);const a=this.scroll.horizontalBarPos;this.scroll.horizontalBarPos=e,G(this.scroll.horizontalBarPos)&&!isNaN(this.scroll.horizontalBarPos)||(this.scroll.horizontalBarPos=0),this._gantt.scenegraph.setX(-e);const n=e/(i-this._gantt.scenegraph.width);this._gantt.scenegraph.scrollbarComponent.updateHorizontalScrollBarPos(n),a!==e&&t&&this._gantt.fireListeners(I.SCROLL,{scrollTop:this.scroll.verticalBarPos,scrollLeft:this.scroll.horizontalBarPos,scrollDirection:"horizontal",scrollRatioX:n})}updateInteractionState(e){if(this.interactionState===e)return;const t=this.interactionState;this.interactionState=e,t===P.scrolling&&P.default}updateVerticalScrollBar(e){const t=this._gantt.getAllRowsHeight();this.scroll.verticalBarPos,this.scroll.verticalBarPos=Math.ceil(e*(t-this._gantt.scenegraph.height)),G(this.scroll.verticalBarPos)&&!isNaN(this.scroll.verticalBarPos)||(this.scroll.verticalBarPos=0),this._gantt.scenegraph.setY(-this.scroll.verticalBarPos,e===1),Rt(this._gantt),this._gantt.fireListeners(I.SCROLL,{scrollTop:this.scroll.verticalBarPos,scrollLeft:this.scroll.horizontalBarPos,scrollDirection:"vertical",scrollRatioY:e})}updateHorizontalScrollBar(e){const t=this._gantt.getAllDateColsWidth();this.scroll.horizontalBarPos,this.scroll.horizontalBarPos=Math.ceil(e*(t-this._gantt.scenegraph.width)),G(this.scroll.horizontalBarPos)&&!isNaN(this.scroll.horizontalBarPos)||(this.scroll.horizontalBarPos=0),this._gantt.scenegraph.setX(-this.scroll.horizontalBarPos,e===1),this._gantt.fireListeners(I.SCROLL,{scrollTop:this.scroll.verticalBarPos,scrollLeft:this.scroll.horizontalBarPos,scrollDirection:"horizontal",scrollRatioY:e})}startMoveTaskBar(e,t,i,a){e.name==="task-bar-hover-shadow"&&(e=e.parent),this.moveTaskBar.moving=!0,this.moveTaskBar.target=e,this.moveTaskBar.targetStartX=e.attribute.x,this.moveTaskBar.targetStartY=e.attribute.y,this.moveTaskBar.startX=t,this.moveTaskBar.startY=i,this.moveTaskBar.startOffsetY=a,e.setAttribute("zIndex",1e4)}isMoveingTaskBar(){return this.moveTaskBar.moving}endMoveTaskBar(){this.moveTaskBar.moveTaskBarXInertia.isInertiaScrolling()&&this.moveTaskBar.moveTaskBarXInertia.endInertia();const e=this.moveTaskBar.deltaX,t=this.moveTaskBar.deltaY,i=this.moveTaskBar.target;if(Math.abs(e)>=1||Math.abs(t)>=1){const a=i.task_index,n=i.sub_task_index,{startDate:r,endDate:l}=this._gantt.getTaskInfoByTaskListIndex(a,n),o=this.moveTaskBar.targetStartY+this._gantt.parsedOptions.rowHeight*Math.round(t/this._gantt.parsedOptions.rowHeight),h=this._gantt.parsedOptions.taskBarMilestoneStyle.width,d=this.moveTaskBar.target.attribute.x+(i.record.type==="milestone"?h/2:0),c=Fe(d-this._gantt.stateManager.scroll.horizontalBarPos,this._gantt),p=this._gantt.parsedOptions.reverseSortedTimelineScales[0].timelineDates[c].startDate,u=new Date(p.getTime()+(j(l).getTime()-j(r).getTime()));let g;if(j(r).getTime()!==p.getTime()){g=j(r).getTime()>p.getTime()?"left":"right",this._gantt._updateStartEndDateToTaskRecord(p,u,a,n);const _=this._gantt.getRecordByIndex(a,n);this._gantt.hasListeners(I.CHANGE_DATE_RANGE)&&this._gantt.fireListeners(I.CHANGE_DATE_RANGE,{startDate:_[this._gantt.parsedOptions.startDateField],endDate:_[this._gantt.parsedOptions.endDateField],oldStartDate:r,oldEndDate:l,index:a,record:_})}if(this._gantt.parsedOptions.tasksShowMode===T.Sub_Tasks_Arrange||this._gantt.parsedOptions.tasksShowMode===T.Sub_Tasks_Compact){const _=J(o,this._gantt);this._gantt._dragOrderTaskRecord(i.task_index,i.sub_task_index,_.task_index,_.sub_task_index),Nt(this._gantt.records),this._gantt.taskListTableInstance.renderWithRecreateCells(),this._gantt._syncPropsFromTable(),this._gantt.scenegraph.refreshTaskBarsAndGrid()}else if(this._gantt.parsedOptions.tasksShowMode!==T.Tasks_Separate&&Math.abs(Math.round(t/this._gantt.parsedOptions.rowHeight))>=1){const _=J(o,this._gantt);this._gantt._dragOrderTaskRecord(i.task_index,i.sub_task_index,_.task_index,_.sub_task_index),this._gantt.parsedOptions.tasksShowMode===T.Sub_Tasks_Separate?(this._gantt.taskListTableInstance.renderWithRecreateCells(),this._gantt.scenegraph.refreshTaskBarsAndGrid()):(this._gantt.scenegraph.taskBar.refresh(),this._gantt.scenegraph.dependencyLink.refresh())}else{let _=c>=1?this._gantt.getDateColsWidth(0,c-1):0;if(i.record.type==="milestone"&&(_-=this._gantt.parsedOptions.taskBarMilestoneStyle.width/2),$e(i,_-i.attribute.x,o-i.attribute.y,this),g==="right"){let b=i;for(;b.nextSibling&&b.nextSibling.attribute.y===i.attribute.y&&b.nextSibling.record[this._gantt.parsedOptions.startDateField]<=i.record[this._gantt.parsedOptions.startDateField];)b=b.nextSibling;b!==i&&b.parent.insertAfter(i,b)}else if(g==="left"){let b=i;for(;b.previousSibling&&b.previousSibling.attribute.y===i.attribute.y&&b.previousSibling.record[this._gantt.parsedOptions.startDateField]>=i.record[this._gantt.parsedOptions.startDateField];)b=b.previousSibling;b!==i&&b.parent.insertBefore(i,b)}}this._gantt.scenegraph.updateNextFrame()}this.moveTaskBar.moving=!1,this.selectedTaskBar.target!==i&&i.setAttribute("zIndex",0),this.moveTaskBar.target=null,this.moveTaskBar.deltaX=0,this.moveTaskBar.deltaY=0,this.moveTaskBar.moveTaskBarXSpeed=0}dealTaskBarMove(e){var t,i,a,n;const r=this._gantt;let l=this.moveTaskBar.target;l.setAttribute("zIndex",1e4);const o=r.eventManager.lastDragPointerXYOnWindow.x,h=e.x-o,d=r.eventManager.lastDragPointerXYOnWindow.y,c=e.y-d;if(this.moveTaskBar.deltaX+=h,this.moveTaskBar.deltaY+=c,$e(l,h,c,this),l.attribute.x<=r.stateManager.scrollLeft&&h<0)if(r.parsedOptions.moveTaskBarToExtendDateRange&&r.stateManager.scrollLeft===0){(t=this.moveTaskBar.moveTaskBarXInertia)===null||t===void 0||t.endInertia();const p=r.parsedOptions.reverseSortedTimelineScales[0].timelineDates[1].startDate.getTime()-r.parsedOptions.reverseSortedTimelineScales[0].timelineDates[0].startDate.getTime(),{unit:u,startOfWeek:g}=r.parsedOptions.reverseSortedTimelineScales[0];r.parsedOptions.minDate=ze(new Date(r.parsedOptions.reverseSortedTimelineScales[0].timelineDates[0].startDate.getTime()-p/2),u,g),r.parsedOptions._minDateTime=(i=r.parsedOptions.minDate)===null||i===void 0?void 0:i.getTime(),r._generateTimeLineDateMap(),r._updateSize(),r.scenegraph.refreshAll(),l=this.moveTaskBar.target=r.scenegraph.taskBar.getTaskBarNodeByIndex(this.moveTaskBar.target.task_index,this.moveTaskBar.target.sub_task_index),r.scrollLeft=r.parsedOptions.timelineColWidth-1,r.eventManager.lastDragPointerXYOnWindow.x=e.x,l.setAttribute("x",r.scrollLeft)}else this.moveTaskBar.moveTaskBarXSpeed=-r.parsedOptions.timelineColWidth/100,this.moveTaskBar.moveTaskBarXInertia.startInertia(this.moveTaskBar.moveTaskBarXSpeed,0,1),this.moveTaskBar.moveTaskBarXInertia.setScrollHandle((p,u)=>{this.moveTaskBar.deltaX+=p,this.moveTaskBar.deltaY+=u,$e(l,p,u,this),r.stateManager.setScrollLeft(l.attribute.x),r.stateManager.scrollLeft===0&&this.moveTaskBar.moveTaskBarXInertia.endInertia()});else if(l.attribute.x+l.attribute.width>=r.stateManager.scrollLeft+r.tableNoFrameWidth&&h>0)if(r.parsedOptions.moveTaskBarToExtendDateRange&&r.stateManager.scrollLeft+r.tableNoFrameWidth===r.getAllDateColsWidth()){(a=this.moveTaskBar.moveTaskBarXInertia)===null||a===void 0||a.endInertia();const p=r.parsedOptions.reverseSortedTimelineScales[0].timelineDates,u=p[1].startDate.getTime()-p[0].startDate.getTime(),{unit:g,startOfWeek:_,step:b}=r.parsedOptions.reverseSortedTimelineScales[0];r.parsedOptions.maxDate=Ke(r.parsedOptions.minDate,new Date(p[p.length-1].endDate.getTime()+u/2),g,b),r.parsedOptions._maxDateTime=(n=r.parsedOptions.maxDate)===null||n===void 0?void 0:n.getTime(),r._generateTimeLineDateMap(),r._updateSize(),r.scenegraph.refreshAll(),l=this.moveTaskBar.target=r.scenegraph.taskBar.getTaskBarNodeByIndex(this.moveTaskBar.target.task_index,this.moveTaskBar.target.sub_task_index),r.scrollLeft+=1,r.eventManager.lastDragPointerXYOnWindow.x=e.x,l.setAttribute("x",r.scrollLeft+r.tableNoFrameWidth-l.attribute.width)}else this.moveTaskBar.moveTaskBarXSpeed=r.parsedOptions.timelineColWidth/100,this.moveTaskBar.moveTaskBarXInertia.startInertia(this.moveTaskBar.moveTaskBarXSpeed,0,1),this.moveTaskBar.moveTaskBarXInertia.setScrollHandle((p,u)=>{this.moveTaskBar.deltaX+=p,this.moveTaskBar.deltaY+=u,$e(l,p,u,this),r.stateManager.setScrollLeft(l.attribute.x+l.attribute.width-r.tableNoFrameWidth),r.stateManager.scrollLeft===r.getAllDateColsWidth()-r.tableNoFrameWidth&&this.moveTaskBar.moveTaskBarXInertia.endInertia()});else this.moveTaskBar.moveTaskBarXInertia.isInertiaScrolling()?this.moveTaskBar.moveTaskBarXInertia.endInertia():this.moveTaskBar.moveTaskBarXSpeed=0;r.scenegraph.updateNextFrame()}startResizeTaskBar(e,t,i,a,n){this.resizeTaskBar.onIconName=n,this.resizeTaskBar.resizing=!0,this.resizeTaskBar.target=e,this.resizeTaskBar.targetStartX=e.attribute.x,this.resizeTaskBar.targetEndX=e.attribute.x+e.attribute.width,this.resizeTaskBar.startX=t,this.resizeTaskBar.startY=i,this.resizeTaskBar.startOffsetY=a}isResizingTaskBar(){return this.resizeTaskBar.resizing}endResizeTaskBar(e){const t=this._gantt.stateManager.resizeTaskBar.onIconName,i=e-this.resizeTaskBar.startX;if(Math.abs(i)>=1){const a=Fe((t==="left"?this.resizeTaskBar.target.attribute.x:this.resizeTaskBar.target.attribute.x+this.resizeTaskBar.target.attribute.width)-this._gantt.stateManager.scroll.horizontalBarPos,this._gantt),n=this._gantt.parsedOptions.reverseSortedTimelineScales[0].timelineDates[a],r=t==="left"?n.startDate:n.endDate,l=this.resizeTaskBar.target,o=l.clipGroupBox,h=l.barRect,d=l.progressRect,c=l.textLabel,p=l.task_index,u=l.sub_task_index,{taskDays:g,progress:_,startDate:b,endDate:S}=this._gantt.getTaskInfoByTaskListIndex(p,u);let y=!1;if(t==="left"?(this._gantt._updateStartDateToTaskRecord(r,p,u),r.getTime()!==new Date(b).getTime()&&(y=!0)):(this._gantt._updateEndDateToTaskRecord(r,p,u),r.getTime()!==new Date(S).getTime()&&(y=!0)),this._gantt.parsedOptions.tasksShowMode===T.Sub_Tasks_Arrange||this._gantt.parsedOptions.tasksShowMode===T.Sub_Tasks_Compact)this._gantt.taskListTableInstance.renderWithRecreateCells(),this._gantt._syncPropsFromTable(),this._gantt.scenegraph.refreshTaskBarsAndGrid();else{if(t==="left"){const v=a>=1?this._gantt.getDateColsWidth(0,a-1):0;l.setAttribute("x",v),l.setAttribute("width",this.resizeTaskBar.targetEndX-v)}else if(t==="right"){const v=this._gantt.getDateColsWidth(0,a);l.setAttribute("width",v-this.resizeTaskBar.targetStartX)}if(o.setAttribute("width",l.attribute.width),h==null||h.setAttribute("width",l.attribute.width),d==null||d.setAttribute("width",_/100*l.attribute.width),c){const{textAlign:v,textBaseline:L,padding:k}=this._gantt.parsedOptions.taskBarLabelStyle,f=Je(et(k),v,L,l.attribute.width,l.attribute.height);c.setAttribute("maxLineWidth",l.attribute.width-2*Yt),c.setAttribute("x",f.x)}this._gantt.scenegraph.refreshRecordLinkNodes(p,u,l,0),this.showTaskBarHover(),$t(this._gantt,l,p,u),l.setAttribute("zIndex",0)}if(this.resizeTaskBar.resizing=!1,this.resizeTaskBar.target=null,y&&this._gantt.hasListeners(I.CHANGE_DATE_RANGE)){const v=this._gantt.getRecordByIndex(p,u);this._gantt.fireListeners(I.CHANGE_DATE_RANGE,{startDate:v[this._gantt.parsedOptions.startDateField],endDate:v[this._gantt.parsedOptions.endDateField],oldStartDate:b,oldEndDate:S,index:p,record:v})}this._gantt.scenegraph.updateNextFrame()}}dealTaskBarResize(e){const t=this._gantt.eventManager.lastDragPointerXYOnWindow.x,i=e.x-t,a=this._gantt.stateManager.resizeTaskBar.target;let n=this._gantt.stateManager.resizeTaskBar.onIconName==="left"?-i:i;const r=Math.max(1,a.attribute.width+n);n=r-a.attribute.width,Ds(a,this._gantt.stateManager.resizeTaskBar.onIconName==="left"?-n:0,r,this),this._gantt.scenegraph.updateNextFrame()}startCreateDependencyLine(e,t,i,a,n){this.creatingDenpendencyLink.creating=!0,this.creatingDenpendencyLink.startClickedPoint=e,this.creatingDenpendencyLink.startX=t,this.creatingDenpendencyLink.startY=i,this.creatingDenpendencyLink.startOffsetY=a,this.creatingDenpendencyLink.firstTaskBarPosition=n,this.highlightLinkPointNode(e)}isCreatingDependencyLine(){return this.creatingDenpendencyLink.creating}endCreateDependencyLine(e){const t=this._gantt.parsedOptions.taskKeyField,i=this.selectedTaskBar.target.task_index,a=this.selectedTaskBar.target.sub_task_index,n=this.creatingDenpendencyLink.secondTaskBarNode.task_index,r=this.creatingDenpendencyLink.secondTaskBarNode.sub_task_index,l={linkedFromTaskKey:this._gantt.getRecordByIndex(i,a)[t],linkedToTaskKey:this._gantt.getRecordByIndex(n,r)[t],type:this.creatingDenpendencyLink.firstTaskBarPosition==="left"&&this.creatingDenpendencyLink.secondTaskBarPosition==="left"?Y.StartToStart:this.creatingDenpendencyLink.firstTaskBarPosition==="right"&&this.creatingDenpendencyLink.secondTaskBarPosition==="left"?Y.FinishToStart:this.creatingDenpendencyLink.firstTaskBarPosition==="right"&&this.creatingDenpendencyLink.secondTaskBarPosition==="right"?Y.FinishToFinish:Y.StartToFinish};return this._gantt.addLink(l),this.hideTaskBarSelectedBorder(),this._gantt.scenegraph.updateNextFrame(),this.creatingDenpendencyLink.creating=!1,l}dealCreateDependencyLine(e){const t=this.creatingDenpendencyLink.startX,i=this.creatingDenpendencyLink.startY,a=e.x-t,n=e.y-i,r=this.creatingDenpendencyLink.startClickedPoint,l=r.attribute.x+r.attribute.width/2,o=r.attribute.y+r.attribute.height/2;this._gantt.scenegraph.taskBar.updateCreatingDependencyLine(l,o,l+a,o+n),this._gantt.scenegraph.updateNextFrame()}startResizeTableWidth(e){this.resizeTableWidth.resizing=!0,this.resizeTableWidth.lastX=e.pageX}isResizingTableWidth(){return this.resizeTableWidth.resizing}endResizeTableWidth(){this.resizeTableWidth.resizing=!1}dealResizeTableWidth(e){var t,i;if(!this.resizeTableWidth.resizing)return;const a=e.pageX-this.resizeTableWidth.lastX;if(Math.abs(a)>=1){let n=this._gantt.taskTableWidth+a;const r=Math.min(this._gantt.taskListTableInstance.getAllColsWidth()+this._gantt.parsedOptions.outerFrameStyle.borderLineWidth,(t=this._gantt.options.taskListTable.maxTableWidth)!==null&&t!==void 0?t:1e5),l=Math.max(this._gantt.parsedOptions.outerFrameStyle.borderLineWidth,(i=this._gantt.options.taskListTable.minTableWidth)!==null&&i!==void 0?i:0);a>0&&n>r&&(n=r),a<0&&n<l&&(n=l),this._gantt.taskTableWidth=n,this._gantt.element.style.left=this._gantt.taskTableWidth?`${this._gantt.taskTableWidth}px`:"0px",this._gantt.verticalSplitResizeLine.style.left=this._gantt.taskTableWidth?this._gantt.taskTableWidth-7+"px":"0px",this._gantt._resize(),this.resizeTableWidth.lastX=e.pageX}}showTaskBarHover(){const e=this._gantt.stateManager.hoverTaskBar.target;if(e){const t=e.attribute.x,i=e.attribute.y,a=e.attribute.width,n=e.attribute.height;this._gantt.scenegraph.taskBar.showHoverBar(t,i,a,n,e),this._gantt.scenegraph.updateNextFrame()}}hideTaskBarHover(e){this._gantt.stateManager.hoverTaskBar.target=null,this._gantt.scenegraph.taskBar.hideHoverBar(),this._gantt.scenegraph.updateNextFrame()}showTaskBarSelectedBorder(e){var t;(t=this._gantt.stateManager.selectedTaskBar.target)===null||t===void 0||t.setAttribute("zIndex",0),this._gantt.stateManager.selectedTaskBar.target=e;const i=this._gantt.parsedOptions.dependencyLinkCreatable;e.setAttribute("zIndex",1e4);const a=e.attribute.x,n=e.attribute.y,r=e.attribute.width,l=e.attribute.height;this._gantt.scenegraph.taskBar.createSelectedBorder(a,n,r,l,e,i),this._gantt.scenegraph.updateNextFrame()}hideTaskBarSelectedBorder(){var e;(e=this._gantt.stateManager.selectedTaskBar.target)===null||e===void 0||e.setAttribute("zIndex",0),this._gantt.stateManager.selectedTaskBar.target=null,this._gantt.scenegraph.taskBar.removeSelectedBorder(),this._gantt.scenegraph.updateNextFrame()}showSecondTaskBarSelectedBorder(){const e=this._gantt.stateManager.creatingDenpendencyLink.secondTaskBarNode,t=e.attribute.x,i=e.attribute.y,a=e.attribute.width,n=e.attribute.height;this._gantt.scenegraph.taskBar.createSelectedBorder(t,i,a,n,e,!0),this._gantt.scenegraph.updateNextFrame()}hideSecondTaskBarSelectedBorder(){this._gantt.stateManager.creatingDenpendencyLink.secondTaskBarNode=null,this._gantt.scenegraph.taskBar.removeSecondSelectedBorder(),this._gantt.scenegraph.updateNextFrame()}showDependencyLinkSelectedLine(){const e=this._gantt.stateManager.selectedDenpendencyLink.link;this._gantt.scenegraph.dependencyLink.createSelectedLinkLine(e);const{taskKeyField:t,dependencyLinks:i}=this._gantt.parsedOptions,{linkedToTaskKey:a,linkedFromTaskKey:n,type:r}=e;let l,o,h,d;const c=ie(this._gantt.records,t,a),p=ie(this._gantt.records,t,n);this._gantt.parsedOptions.tasksShowMode===T.Sub_Tasks_Inline||this._gantt.parsedOptions.tasksShowMode===T.Sub_Tasks_Separate||this._gantt.parsedOptions.tasksShowMode===T.Sub_Tasks_Arrange||this._gantt.parsedOptions.tasksShowMode===T.Sub_Tasks_Compact?(l=p.index[0],o=p.index[1],h=c.index[0],d=c.index[1]):(l=this._gantt.getTaskShowIndexByRecordIndex(p.index),h=this._gantt.getTaskShowIndexByRecordIndex(c.index));const u=this._gantt.scenegraph.taskBar.getTaskBarNodeByIndex(l,o);this._gantt.scenegraph.taskBar.createSelectedBorder(u.attribute.x,u.attribute.y,u.attribute.width,u.attribute.height,u,!1);const g=this._gantt.scenegraph.taskBar.getTaskBarNodeByIndex(h,d);this._gantt.scenegraph.taskBar.createSelectedBorder(g.attribute.x,g.attribute.y,g.attribute.width,g.attribute.height,g,!1),this._gantt.scenegraph.updateNextFrame()}hideDependencyLinkSelectedLine(){this._gantt.stateManager.selectedDenpendencyLink.link=null,this._gantt.scenegraph.dependencyLink.removeSelectedLinkLine(),this._gantt.scenegraph.taskBar.removeSelectedBorder(),this._gantt.scenegraph.updateNextFrame()}highlightLinkPointNode(e){if((e==null?void 0:e.children.length)>0){const t=e.children[0];t.setAttribute("fill",this._gantt.parsedOptions.dependencyLinkLineCreatingPointStyle.fillColor),t.setAttribute("stroke",this._gantt.parsedOptions.dependencyLinkLineCreatingPointStyle.strokeColor),t.setAttribute("radius",this._gantt.parsedOptions.dependencyLinkLineCreatingPointStyle.radius),t.setAttribute("lineWidth",this._gantt.parsedOptions.dependencyLinkLineCreatingPointStyle.strokeWidth),this._gantt.scenegraph.updateNextFrame()}}unhighlightLinkPointNode(e){if((e==null?void 0:e.children.length)>0){const t=e.children[0];t.setAttribute("fill",this._gantt.parsedOptions.dependencyLinkLineCreatePointStyle.fillColor),t.setAttribute("stroke",this._gantt.parsedOptions.dependencyLinkLineCreatePointStyle.strokeColor),t.setAttribute("radius",this._gantt.parsedOptions.dependencyLinkLineCreatePointStyle.radius),t.setAttribute("lineWidth",this._gantt.parsedOptions.dependencyLinkLineCreatePointStyle.strokeWidth),this._gantt.scenegraph.updateNextFrame()}}}function $t(s,e,t,i){const a=s.parsedOptions.taskBarCustomLayout;if(a){let n;if(typeof a=="function"){const{startDate:r,endDate:l,taskDays:o,progress:h,taskRecord:d}=s.getTaskInfoByTaskListIndex(t,i);n=a({width:e.attribute.width,height:e.attribute.height,index:t,startDate:r,endDate:l,taskDays:o,progress:h,taskRecord:d,ganttInstance:s})}else n=a;if(n){const r=n.rootContainer;r.name="task-bar-custom-render";const l=e.children.find(o=>o.name==="task-bar-group");if(l){const o=l.children.findIndex(d=>d.name==="task-bar-custom-render"),h=l.children[o];h&&(l.removeChild(h),l.insertInto(r,o))}}}}function $e(s,e,t,i){const a=s.task_index,n=s.sub_task_index,r=s.record.type==="milestone";e&&s.setAttribute("x",Math.max(0,s.attribute.x+e)),i._gantt.parsedOptions.tasksShowMode!==T.Tasks_Separate?t&&s.setAttribute("y",s.attribute.y+t):t=0,r&&s.setAttribute("anchor",[s.attribute.x+s.attribute.width/2,s.attribute.y+s.attribute.height/2]),i._gantt.scenegraph.refreshRecordLinkNodes(a,n,s,t)}function Ds(s,e,t,i){const a=i._gantt.parsedOptions.progressField,n=s.clipGroupBox,r=s.barRect,l=s.progressRect,o=s.textLabel,h=s.task_index,d=s.sub_task_index,c=s.record,p=c[a],u=c.type==="milestone";if(s.setAttribute("zIndex",1e4),e&&s.setAttribute("x",s.attribute.x+e),u&&s.setAttribute("anchor",[s.attribute.x+s.attribute.width/2,s.attribute.y+s.attribute.height/2]),t&&s.setAttribute("width",t),n.setAttribute("width",s.attribute.width),r==null||r.setAttribute("width",s.attribute.width),l==null||l.setAttribute("width",p/100*s.attribute.width),o){const{textAlign:g,textBaseline:_,padding:b}=i._gantt.parsedOptions.taskBarLabelStyle,S=Je(et(b),g,_,t,s.attribute.height);o.setAttribute("maxLineWidth",t-2*Yt),o.setAttribute("x",S.x)}i.showTaskBarHover(),$t(i._gantt,s,h,d),i._gantt.scenegraph.refreshRecordLinkNodes(h,d,s,0)}let Hs=1;class Ms{constructor(){this.listenersData={listeners:{},listenerData:{}}}on(e,t){const i=this.listenersData.listeners[e]||(this.listenersData.listeners[e]=[]);i.push(t);const a=Hs++;return this.listenersData.listenerData[a]={type:e,listener:t,remove:()=>{delete this.listenersData.listenerData[a];const n=i.indexOf(t);i.splice(n,1),this.listenersData.listeners[e].length||delete this.listenersData.listeners[e]}},a}off(e,t){var i;if(t){const a=e;this.removeEventListener(a,t)}else{const a=e;if(!this.listenersData)return;(i=this.listenersData.listenerData[a])===null||i===void 0||i.remove()}}addEventListener(e,t,i){this.on(e,t)}removeEventListener(e,t){if(this.listenersData)for(const i in this.listenersData.listenerData){const a=this.listenersData.listenerData[i];a.type===e&&a.listener===t&&this.off(i)}}hasListeners(e){return!!this.listenersData&&!!this.listenersData.listeners[e]}fireListeners(e,t){if(!this.listenersData)return[];const i=this.listenersData.listeners[e];return i?i.map(a=>a.call(this,t)).filter(a=>G(a)):[]}release(){delete this.listenersData}}class Ws{constructor(e){this._gantt=e,this.records=e.records,this.processRecords()}processRecords(){const e=!this._gantt.options.minDate,t=!this._gantt.options.maxDate;let i=Number.MAX_SAFE_INTEGER,a=Number.MIN_SAFE_INTEGER;if((e||t||this._gantt.parsedOptions.tasksShowMode===T.Sub_Tasks_Inline||this._gantt.parsedOptions.tasksShowMode===T.Sub_Tasks_Compact)&&this.records.length){for(let o=0;o<this.records.length;o++){const h=this.records[o];if(e&&h[this._gantt.parsedOptions.startDateField]){const d=j(h[this._gantt.parsedOptions.startDateField]);i=Math.min(i,d.getTime())}if(t&&h[this._gantt.parsedOptions.endDateField]){const d=j(h[this._gantt.parsedOptions.endDateField]);a=Math.max(a,d.getTime())}this._gantt.parsedOptions.tasksShowMode!==T.Sub_Tasks_Inline&&this._gantt.parsedOptions.tasksShowMode!==T.Sub_Tasks_Compact||h.children&&h.children.sort((d,c)=>j(d[this._gantt.parsedOptions.startDateField]).getTime()-j(c[this._gantt.parsedOptions.startDateField]).getTime())}const{unit:n,startOfWeek:r,step:l}=this._gantt.parsedOptions.reverseSortedTimelineScales[0];e&&(this._gantt.parsedOptions.minDate=ze(new Date(i),n,r),this._gantt.parsedOptions._minDateTime=this._gantt.parsedOptions.minDate.getTime()),t&&(this._gantt.parsedOptions.maxDate=Ke(this._gantt.parsedOptions.minDate,new Date(a),n,l),this._gantt.parsedOptions._maxDateTime=this._gantt.parsedOptions.maxDate.getTime())}}adjustOrder(e,t,i,a){var n,r;if(this._gantt.parsedOptions.tasksShowMode!==T.Sub_Tasks_Arrange&&this._gantt.parsedOptions.tasksShowMode!==T.Sub_Tasks_Compact||e!==i){if(this._gantt.parsedOptions.tasksShowMode===T.Sub_Tasks_Inline){if(G(t)&&G(a)&&G(e)&&G(i)){const l=this.records[e].children[t];this.records[e].children.splice(t,1),this.records[i].children||(this.records[i].children=[]),this.records[i].children.splice(a,0,l)}(r=(n=this.records[i])===null||n===void 0?void 0:n.children)===null||r===void 0||r.sort((l,o)=>j(l[this._gantt.parsedOptions.startDateField]).getTime()-j(o[this._gantt.parsedOptions.startDateField]).getTime())}else if(G(t)&&G(a)&&G(e)&&G(i)){const l=this.records[e].children[t];this.records[e].children.splice(t,1),this.records[i].children||(this.records[i].children=[]),this.records[i].children.splice(a,0,l)}}}setRecords(e){this.records=e,this.processRecords()}}function As(s,e="vtable-gantt"){var t,i;const a=document.createElement("div");a.setAttribute("tabindex","0"),a.classList.add(e),a.style.outline="none",a.style.margin=`${s.top}px ${s.right}px ${s.bottom}px ${s.left}px`;const n=(a.offsetWidth||((t=a.parentElement)===null||t===void 0?void 0:t.offsetWidth)||1)-1,r=(a.offsetHeight||((i=a.parentElement)===null||i===void 0?void 0:i.offsetHeight)||1)-1;return a.style.width=n&&n-s.left-s.right+"px"||"0px",a.style.height=r&&r-s.top-s.bottom+"px"||"0px",a}class Ot extends Ms{constructor(e,t){var i,a,n,r,l;super(),this.parsedOptions={},this.container=e,this.options=t,this.taskTableWidth=typeof((i=t==null?void 0:t.taskListTable)===null||i===void 0?void 0:i.tableWidth)=="number"?(a=t==null?void 0:t.taskListTable)===null||a===void 0?void 0:a.tableWidth:-1,this.taskTableColumns=(r=(n=t==null?void 0:t.taskListTable)===null||n===void 0?void 0:n.columns)!==null&&r!==void 0?r:[],this.records=(l=t==null?void 0:t.records)!==null&&l!==void 0?l:[],this._sortScales(),zt(this),this.data=new Ws(this),this._generateTimeLineDateMap(),this.timeLineHeaderLevel=this.parsedOptions.sortedTimelineScales.length,this.element=As({top:0,right:0,left:0,bottom:0},"vtable-gantt"),this.element.style.left=this.taskTableWidth?`${this.taskTableWidth}px`:"0px",this.canvas=document.createElement("canvas"),this.element.appendChild(this.canvas),this.context=this.canvas.getContext("2d"),e?(e.appendChild(this.element),this._updateSize()):this._updateSize(),this._generateListTable(),this._syncPropsFromTable(),Oi(this),this.scenegraph=new ps(this),this.stateManager=new Cs(this),this.eventManager=new ys(this),this.scenegraph.afterCreateSceneGraph(),this._scrollToMarkLine()}renderTaskBarsTable(){this.scenegraph.updateNextFrame()}_updateSize(){var e,t,i,a,n,r,l,o;let h=0,d=0;if(F.mode==="browser"){const u=this.getElement();let g=0,_=0;if(u.parentElement){const v=u.parentElement.style||window.getComputedStyle(u.parentElement);g=u.parentElement.offsetWidth-parseInt(v.paddingLeft||"0px",10)-parseInt(v.paddingRight||"0px",10),_=u.parentElement.offsetHeight-parseInt(v.paddingTop||"0px",10)-parseInt(v.paddingBottom||"0px",20)}const b=(g??1)-1-this.taskTableWidth,S=(_??1)-1;u.style.width=b&&`${b}px`||"0px",u.style.height=S&&`${S}px`||"0px";const{canvas:y}=this;h=(t=(e=y.parentElement)===null||e===void 0?void 0:e.offsetWidth)!==null&&t!==void 0?t:1,d=(a=(i=y.parentElement)===null||i===void 0?void 0:i.offsetHeight)!==null&&a!==void 0?a:1,!((n=this==null?void 0:this.scenegraph)===null||n===void 0)&&n.stage?this.scenegraph.stage.resize(h,d):(y.style.width="",y.style.height="",y.width=h,y.height=d,y.style.width=`${h}px`,y.style.height=`${d}px`)}else F.mode;const c=Math.floor(h-Ti(this.parsedOptions.scrollStyle)),p=Math.floor(d-Li(this.parsedOptions.scrollStyle));if(this.tableNoFrameWidth=h,this.tableNoFrameHeight=Math.floor(d),this.parsedOptions.outerFrameStyle){const u=(r=this.parsedOptions.outerFrameStyle)===null||r===void 0?void 0:r.borderLineWidth;this.tableX=this.taskTableColumns.length>=1||!((l=this.options)===null||l===void 0)&&l.rowSeriesNumber?(o=this.parsedOptions.verticalSplitLine.lineWidth)!==null&&o!==void 0?o:0:u,this.tableY=u,this.tableNoFrameWidth=Math.min(c-u-this.tableX,this.getAllDateColsWidth()),this.tableNoFrameHeight=p-2*u}}_updateListTableSize(e){var t,i,a,n,r,l,o,h,d,c;if(e&&(((i=(t=this.options)===null||t===void 0?void 0:t.taskListTable)===null||i===void 0?void 0:i.tableWidth)!=="auto"&&this.taskTableWidth!==-1||(this.taskTableWidth=e.getAllColsWidth()+this.parsedOptions.outerFrameStyle.borderLineWidth,!((n=(a=this.options)===null||a===void 0?void 0:a.taskListTable)===null||n===void 0)&&n.maxTableWidth&&(this.taskTableWidth=Math.min((l=(r=this.options)===null||r===void 0?void 0:r.taskListTable)===null||l===void 0?void 0:l.maxTableWidth,this.taskTableWidth)),!((h=(o=this.options)===null||o===void 0?void 0:o.taskListTable)===null||h===void 0)&&h.minTableWidth&&(this.taskTableWidth=Math.max((c=(d=this.options)===null||d===void 0?void 0:d.taskListTable)===null||c===void 0?void 0:c.minTableWidth,this.taskTableWidth)),this.element.style.left=this.taskTableWidth?`${this.taskTableWidth}px`:"0px",e.setCanvasSize(this.taskTableWidth,this.tableNoFrameHeight+2*this.parsedOptions.outerFrameStyle.borderLineWidth),this._updateSize()),e.columnHeaderLevelCount>1))if(e.columnHeaderLevelCount===this.parsedOptions.timeLineHeaderRowHeights.length)for(let p=0;p<e.columnHeaderLevelCount;p++)e.setRowHeight(p,this.parsedOptions.timeLineHeaderRowHeights[p]);else{const p=this.getAllHeaderRowsHeight()/e.columnHeaderLevelCount;for(let u=0;u<e.columnHeaderLevelCount;u++)e.setRowHeight(u,p)}}_generateListTable(){var e;if(this.taskTableColumns.length>=1||!((e=this.options)===null||e===void 0)&&e.rowSeriesNumber){const t=this._generateListTableOptions();this.taskListTableInstance=new di(this.container,t),this._updateListTableSize(this.taskListTableInstance)}}_generateListTableOptions(){var e,t,i,a,n,r,l,o,h,d,c,p,u,g,_,b,S,y,v,L,k,f,x,C,w,O,B,D,M,N,X,E,R,$,K,V,ae,ne,re,oe,le,ee,Z,pe,ue,ge,_e,be,ve,me,ye,ke,fe,Se,Le,Te,xe,Be,we,Oe,Ce,De,He,Me,We,Ae;const H={},Ne=["container","records","rowSeriesNumber","overscrollBehavior","pixelRatio","eventOptions"];for(const W in this.options)Ne.indexOf(W)>=0&&(H[W]=this.options[W]);for(const W in this.options.taskListTable){if(H[W]=this.options.taskListTable[W],W==="columns"&&(H[W][H[W].length-1].disableColumnResize=!0,this.parsedOptions.tasksShowMode===T.Sub_Tasks_Inline||this.parsedOptions.tasksShowMode===T.Sub_Tasks_Separate||this.parsedOptions.tasksShowMode===T.Sub_Tasks_Arrange||this.parsedOptions.tasksShowMode===T.Sub_Tasks_Compact))for(let U=0;U<H.columns.length;U++)H.columns[U].tree&&(H.columns[U].tree=!1);W!=="hierarchyExpandLevel"||this.parsedOptions.tasksShowMode!==T.Sub_Tasks_Inline&&this.parsedOptions.tasksShowMode!==T.Sub_Tasks_Separate&&this.parsedOptions.tasksShowMode!==T.Sub_Tasks_Arrange&&this.parsedOptions.tasksShowMode!==T.Sub_Tasks_Compact||delete H[W]}if(!((e=this.options.taskListTable)===null||e===void 0)&&e.theme)if(H.theme=(t=this.options.taskListTable)===null||t===void 0?void 0:t.theme,H.theme.bodyStyle&&!Fi(H.theme,"bodyStyle")){H.theme=((i=this.options.taskListTable)===null||i===void 0?void 0:i.theme).extends(((a=this.options.taskListTable)===null||a===void 0?void 0:a.theme).getExtendTheme());const W=H.theme.getExtendTheme();H.theme.clearBodyStyleCache(),!((n=H.theme.headerStyle)===null||n===void 0)&&n.bgColor||(W.headerStyle?W.headerStyle.bgColor||(W.headerStyle.bgColor=this.parsedOptions.timelineHeaderBackgroundColor):W.headerStyle={bgColor:this.parsedOptions.timelineHeaderBackgroundColor}),W.bodyStyle?W.bodyStyle.frameStyle={borderLineWidth:[(l=(r=this.parsedOptions.horizontalSplitLine)===null||r===void 0?void 0:r.lineWidth)!==null&&l!==void 0?l:0,0,0,0],borderColor:(o=this.parsedOptions.horizontalSplitLine)===null||o===void 0?void 0:o.lineColor}:W.bodyStyle={frameStyle:{borderLineWidth:[(d=(h=this.parsedOptions.horizontalSplitLine)===null||h===void 0?void 0:h.lineWidth)!==null&&d!==void 0?d:0,0,0,0],borderColor:(c=this.parsedOptions.horizontalSplitLine)===null||c===void 0?void 0:c.lineColor}},W.cellInnerBorder=!1,W.frameStyle=Object.assign({},this.parsedOptions.outerFrameStyle,{shadowBlur:0,cornerRadius:[(u=(p=this.parsedOptions.outerFrameStyle)===null||p===void 0?void 0:p.cornerRadius)!==null&&u!==void 0?u:0,0,0,(_=(g=this.parsedOptions.outerFrameStyle)===null||g===void 0?void 0:g.cornerRadius)!==null&&_!==void 0?_:0],borderLineWidth:[(S=(b=this.parsedOptions.outerFrameStyle)===null||b===void 0?void 0:b.borderLineWidth)!==null&&S!==void 0?S:0,0,(v=(y=this.parsedOptions.outerFrameStyle)===null||y===void 0?void 0:y.borderLineWidth)!==null&&v!==void 0?v:0,(k=(L=this.parsedOptions.outerFrameStyle)===null||L===void 0?void 0:L.borderLineWidth)!==null&&k!==void 0?k:0]}),W.scrollStyle=Object.assign({},(x=(f=this.options.taskListTable)===null||f===void 0?void 0:f.theme)===null||x===void 0?void 0:x.scrollStyle,this.parsedOptions.scrollStyle,{verticalVisible:"none"}),W.columnResize=Object.assign({labelColor:"rgba(0,0,0,0)",labelBackgroundFill:"rgba(0,0,0,0)"},W==null?void 0:W.columnResize),W.underlayBackgroundColor||(W.underlayBackgroundColor=this.parsedOptions.underlayBackgroundColor)}else H.theme.headerStyle?H.theme.headerStyle.bgColor||(H.theme.headerStyle.bgColor=this.parsedOptions.timelineHeaderBackgroundColor):H.theme.headerStyle={bgColor:this.parsedOptions.timelineHeaderBackgroundColor},H.theme.headerStyle=Object.assign({},Xe.headerStyle,{bgColor:this.parsedOptions.timelineHeaderBackgroundColor},(w=(C=this.options.taskListTable)===null||C===void 0?void 0:C.theme)===null||w===void 0?void 0:w.headerStyle),H.theme.bodyStyle=Object.assign({},Xe.bodyStyle,(B=(O=this.options.taskListTable)===null||O===void 0?void 0:O.theme)===null||B===void 0?void 0:B.bodyStyle,{frameStyle:{borderLineWidth:[(M=(D=this.parsedOptions.horizontalSplitLine)===null||D===void 0?void 0:D.lineWidth)!==null&&M!==void 0?M:0,0,0,0],borderColor:(N=this.parsedOptions.horizontalSplitLine)===null||N===void 0?void 0:N.lineColor}}),H.theme.cellInnerBorder=!1,H.theme.frameStyle=Object.assign({},this.parsedOptions.outerFrameStyle,{cornerRadius:[(E=(X=this.parsedOptions.outerFrameStyle)===null||X===void 0?void 0:X.cornerRadius)!==null&&E!==void 0?E:0,0,0,($=(R=this.parsedOptions.outerFrameStyle)===null||R===void 0?void 0:R.cornerRadius)!==null&&$!==void 0?$:0],borderLineWidth:[(V=(K=this.parsedOptions.outerFrameStyle)===null||K===void 0?void 0:K.borderLineWidth)!==null&&V!==void 0?V:0,0,(ne=(ae=this.parsedOptions.outerFrameStyle)===null||ae===void 0?void 0:ae.borderLineWidth)!==null&&ne!==void 0?ne:0,(oe=(re=this.parsedOptions.outerFrameStyle)===null||re===void 0?void 0:re.borderLineWidth)!==null&&oe!==void 0?oe:0]}),H.theme.scrollStyle=Object.assign({},(ee=(le=this.options.taskListTable)===null||le===void 0?void 0:le.theme)===null||ee===void 0?void 0:ee.scrollStyle,this.parsedOptions.scrollStyle,{verticalVisible:"none"}),H.theme.columnResize=Object.assign({labelColor:"rgba(0,0,0,0)",labelBackgroundFill:"rgba(0,0,0,0)"},(pe=(Z=this.options.taskListTable)===null||Z===void 0?void 0:Z.theme)===null||pe===void 0?void 0:pe.columnResize),H.theme.underlayBackgroundColor||(H.theme.underlayBackgroundColor=this.parsedOptions.underlayBackgroundColor);else H.theme={scrollStyle:Object.assign({},(ge=(ue=this.options.taskListTable)===null||ue===void 0?void 0:ue.theme)===null||ge===void 0?void 0:ge.scrollStyle,this.parsedOptions.scrollStyle,{verticalVisible:"none"}),headerStyle:Object.assign({},Xe.headerStyle,{bgColor:this.parsedOptions.timelineHeaderBackgroundColor},(be=(_e=this.options.taskListTable)===null||_e===void 0?void 0:_e.theme)===null||be===void 0?void 0:be.headerStyle),bodyStyle:Object.assign({},Xe.bodyStyle,(me=(ve=this.options.taskListTable)===null||ve===void 0?void 0:ve.theme)===null||me===void 0?void 0:me.bodyStyle,{frameStyle:{borderLineWidth:[(ke=(ye=this.parsedOptions.horizontalSplitLine)===null||ye===void 0?void 0:ye.lineWidth)!==null&&ke!==void 0?ke:0,0,0,0],borderColor:(fe=this.parsedOptions.horizontalSplitLine)===null||fe===void 0?void 0:fe.lineColor}}),cellInnerBorder:!1,frameStyle:Object.assign({},this.parsedOptions.outerFrameStyle,{cornerRadius:[(Le=(Se=this.parsedOptions.outerFrameStyle)===null||Se===void 0?void 0:Se.cornerRadius)!==null&&Le!==void 0?Le:0,0,0,(xe=(Te=this.parsedOptions.outerFrameStyle)===null||Te===void 0?void 0:Te.cornerRadius)!==null&&xe!==void 0?xe:0],borderLineWidth:[(we=(Be=this.parsedOptions.outerFrameStyle)===null||Be===void 0?void 0:Be.borderLineWidth)!==null&&we!==void 0?we:0,0,(Ce=(Oe=this.parsedOptions.outerFrameStyle)===null||Oe===void 0?void 0:Oe.borderLineWidth)!==null&&Ce!==void 0?Ce:0,(He=(De=this.parsedOptions.outerFrameStyle)===null||De===void 0?void 0:De.borderLineWidth)!==null&&He!==void 0?He:0]}),columnResize:Object.assign({labelColor:"rgba(0,0,0,0)",labelBackgroundFill:"rgba(0,0,0,0)"},(We=(Me=this.options.taskListTable)===null||Me===void 0?void 0:Me.theme)===null||We===void 0?void 0:We.columnResize),underlayBackgroundColor:this.parsedOptions.underlayBackgroundColor};return H.canvasWidth=this.taskTableWidth,H.canvasHeight=this.canvas.height,H.defaultHeaderRowHeight=this.getAllHeaderRowsHeight(),this.parsedOptions.tasksShowMode===T.Sub_Tasks_Separate?(H.customComputeRowHeight=W=>{var U;const{row:de,table:Q}=W,Ie=Q.getRecordByRowCol(0,de);if(Ie)return(((U=Ie.children)===null||U===void 0?void 0:U.length)||1)*this.parsedOptions.rowHeight},H.defaultRowHeight="auto"):this.parsedOptions.tasksShowMode===T.Sub_Tasks_Compact?(H.customComputeRowHeight=W=>{const{row:U,table:de}=W,Q=de.getRecordByRowCol(0,U);if(Q)return Gt(this,Q)*this.parsedOptions.rowHeight},H.defaultRowHeight="auto"):this.parsedOptions.tasksShowMode===T.Sub_Tasks_Arrange?(H.customComputeRowHeight=W=>{const{row:U,table:de}=W,Q=de.getRecordByRowCol(0,U);if(Q)return jt(this,Q)*this.parsedOptions.rowHeight},H.defaultRowHeight="auto"):H.defaultRowHeight=(Ae=this.options.rowHeight)!==null&&Ae!==void 0?Ae:40,H.clearDOM=!1,H}getElement(){return this.element}getContainer(){return this.element.parentElement}_sortScales(){const{timelineHeader:e}=this.options;if(e){const t=e.scales,i=["year","quarter","month","week","day","hour","minute","second"];t.length===1&&(t[0].unit!=="hour"&&t[0].unit!=="minute"&&t[0].unit!=="second"||(this.parsedOptions.timeScaleIncludeHour=!0));const a=t.slice().sort((r,l)=>{r.unit!=="hour"&&r.unit!=="minute"&&r.unit!=="second"||(this.parsedOptions.timeScaleIncludeHour=!0);const o=i.indexOf(r.unit),h=i.indexOf(l.unit);return o===-1?1:h===-1?-1:o-h}),n=t.slice().sort((r,l)=>{const o=i.indexOf(r.unit),h=i.indexOf(l.unit);return o===-1?1:h===-1?-1:h-o});this.parsedOptions.sortedTimelineScales=a,this.parsedOptions.reverseSortedTimelineScales=n}}_generateTimeLineDateMap(){if(this.parsedOptions.minDate&&this.parsedOptions.maxDate)for(const e of this.parsedOptions.reverseSortedTimelineScales)e.timelineDates=Bi(new Date(this.parsedOptions.minDate),this.parsedOptions.maxDate,e)}getRowHeightByIndex(e){return this.taskListTableInstance?this.taskListTableInstance.getRowHeight(e+this.taskListTableInstance.columnHeaderLevelCount):this.parsedOptions.rowHeight}getRowsHeightByIndex(e,t){return this.taskListTableInstance?this.taskListTableInstance.getRowsHeight(e+this.taskListTableInstance.columnHeaderLevelCount,t+this.taskListTableInstance.columnHeaderLevelCount):this.parsedOptions.rowHeight*(t-e+1)}getAllRowsHeight(){return this.taskListTableInstance?this.taskListTableInstance.getAllRowsHeight():this.getAllHeaderRowsHeight()+this.itemCount*this.parsedOptions.rowHeight}getAllHeaderRowsHeight(){return this.parsedOptions.timeLineHeaderRowHeights.reduce((e,t,i)=>this.parsedOptions.sortedTimelineScales[i].visible===!1?e:e+t,0)}getAllDateColsWidth(){var e,t;return this.parsedOptions.timelineColWidth*((t=(e=this.parsedOptions.reverseSortedTimelineScales[0].timelineDates)===null||e===void 0?void 0:e.length)!==null&&t!==void 0?t:0)}getAllTaskBarsHeight(){return this.taskListTableInstance?this.taskListTableInstance.getRowsHeight(this.taskListTableInstance.columnHeaderLevelCount,this.taskListTableInstance.rowCount-1):this.itemCount*this.parsedOptions.rowHeight}getRecordIndexByTaskShowIndex(e){return this.taskListTableInstance?this.taskListTableInstance.getRecordIndexByCell(0,this.taskListTableInstance.columnHeaderLevelCount+e):e}getTaskShowIndexByRecordIndex(e){return this.taskListTableInstance.getBodyRowIndexByRecordIndex(e)}getRecordByIndex(e,t){var i,a;return G(t)?(a=(i=this.records[e])===null||i===void 0?void 0:i.children)===null||a===void 0?void 0:a[t]:this.taskListTableInstance?this.taskListTableInstance.getRecordByCell(0,e+this.taskListTableInstance.columnHeaderLevelCount):this.records[e]}_refreshTaskBar(e,t){this.scenegraph.taskBar.updateTaskBarNode(e,t),this.scenegraph.refreshRecordLinkNodes(e,void 0,this.scenegraph.taskBar.getTaskBarNodeByIndex(e,t)),this.scenegraph.updateNextFrame()}_updateRecordToListTable(e,t){Array.isArray(t)||(t=this.taskListTableInstance.getRecordIndexByCell(0,t+this.taskListTableInstance.columnHeaderLevelCount)),this.taskListTableInstance.updateRecords([e],[t])}getTaskInfoByTaskListIndex(e,t){const i=this.getRecordByIndex(e,t),a=i==null?void 0:i.type,n=this.parsedOptions.startDateField,r=this.parsedOptions.endDateField,l=this.parsedOptions.progressField,o=j(i==null?void 0:i[n]).getTime(),h=j(i==null?void 0:i[r]).getTime();if(a&&!(i!=null&&i[n])||!a&&(h<this.parsedOptions._minDateTime||o>this.parsedOptions._maxDateTime||!(i!=null&&i[n])||!(i!=null&&i[r])))return{taskDays:0,progress:0,startDate:null,endDate:null,taskRecord:i};const d=wi(i[l]);let c,p;return this.parsedOptions.timeScaleIncludeHour?(c=j(Math.min(Math.max(this.parsedOptions._minDateTime,o),this.parsedOptions._maxDateTime)),p=Xt(Math.max(Math.min(this.parsedOptions._maxDateTime,h),this.parsedOptions._minDateTime),!0)):(c=j(Math.min(Math.max(this.parsedOptions._minDateTime,o),this.parsedOptions._maxDateTime),!0),p=ce(Math.max(Math.min(this.parsedOptions._maxDateTime,h),this.parsedOptions._minDateTime),!0)),{taskRecord:i,taskDays:(p.getTime()-c.getTime()+1)/864e5,startDate:c,endDate:p,progress:d}}_updateStartDateToTaskRecord(e,t,i){var a;const n=this.getRecordByIndex(t,i),r=this.parsedOptions.startDateField,l=(a=this.parsedOptions.dateFormat)!==null&&a!==void 0?a:Ue(n[r]),o=se(e,l);if(n[r]=o,!G(i)){const h=this.getRecordIndexByTaskShowIndex(t);this._updateRecordToListTable(n,h)}}_updateEndDateToTaskRecord(e,t,i){var a;const n=this.getRecordByIndex(t,i),r=this.parsedOptions.endDateField,l=(a=this.parsedOptions.dateFormat)!==null&&a!==void 0?a:Ue(n[r]),o=se(e,l);if(n[r]=o,!G(i)){const h=this.getRecordIndexByTaskShowIndex(t);this._updateRecordToListTable(n,h)}}_updateStartEndDateToTaskRecord(e,t,i,a){var n;const r=this.getRecordByIndex(i,a),l=this.parsedOptions.startDateField,o=this.parsedOptions.endDateField,h=(n=this.parsedOptions.dateFormat)!==null&&n!==void 0?n:Ue(r[l]),d=se(e,h);r[l]=d;const c=se(t,h);if(r[o]=c,!G(a)){const p=this.getRecordIndexByTaskShowIndex(i);this._updateRecordToListTable(r,p)}}_dragOrderTaskRecord(e,t,i,a){this.data.adjustOrder(e,t,i,a)}updateTaskRecord(e,t,i){if(G(i)){const n=typeof t=="number"?t:t[0];return this._updateRecordToListTable(e,[n,i]),void this._refreshTaskBar(n,i)}if(Array.isArray(t)){const n=t[0],r=t[1];return this._updateRecordToListTable(e,G(r)?[n,r]:n),void this._refreshTaskBar(n,r)}const a=t;this._updateRecordToListTable(e,a),this._refreshTaskBar(a,void 0)}setPixelRatio(e){var t;(t=this.taskListTableInstance)===null||t===void 0||t.setPixelRatio(e),this.parsedOptions.pixelRatio=e,this.scenegraph.setPixelRatio(e)}_resize(){var e;this._updateSize(),(e=this.taskListTableInstance)===null||e===void 0||e.setCanvasSize(this.taskTableWidth,this.tableNoFrameHeight+2*this.parsedOptions.outerFrameStyle.borderLineWidth),this._syncPropsFromTable(),this.scenegraph.resize(),qe(this)}_syncPropsFromTable(){this.itemCount=this.taskListTableInstance?this.taskListTableInstance.rowCount-this.taskListTableInstance.columnHeaderLevelCount:this.records.length,this.headerHeight=this.getAllHeaderRowsHeight(),this.drawHeight=Math.min(this.getAllRowsHeight(),this.tableNoFrameHeight),this.gridHeight=this.drawHeight-this.headerHeight}getContext(){return this.context}release(){var e,t;(e=super.release)===null||e===void 0||e.call(this),this.eventManager.release(),(t=this.taskListTableInstance)===null||t===void 0||t.release();const{parentElement:i}=this.element;i&&(i.removeChild(this.element),this.verticalSplitResizeLine&&i.removeChild(this.verticalSplitResizeLine),this.horizontalSplitLine&&i.removeChild(this.horizontalSplitLine)),this.scenegraph=null}updateOption(e){var t,i,a,n,r;if(this.parsedOptions={},this.options=e,this.taskTableWidth=typeof((t=e==null?void 0:e.taskListTable)===null||t===void 0?void 0:t.tableWidth)=="number"?(i=e==null?void 0:e.taskListTable)===null||i===void 0?void 0:i.tableWidth:-1,this.taskTableColumns=(n=(a=e==null?void 0:e.taskListTable)===null||a===void 0?void 0:a.columns)!==null&&n!==void 0?n:[],this.records=(r=e==null?void 0:e.records)!==null&&r!==void 0?r:[],this._sortScales(),zt(this),this.data.setRecords(this.records),this._generateTimeLineDateMap(),this.timeLineHeaderLevel=this.parsedOptions.sortedTimelineScales.length,this._updateSize(),this.taskListTableInstance){const l=this._generateListTableOptions();this.taskListTableInstance.updateOption(l),this._updateListTableSize(this.taskListTableInstance)}this._syncPropsFromTable(),this.scenegraph.updateStageBackground(),this.element.style.left=this.taskTableWidth?`${this.taskTableWidth}px`:"0px",qe(this),this.scenegraph.updateSceneGraph(),this.scenegraph.afterCreateSceneGraph(),this._scrollToMarkLine()}setRecords(e){this.records=e,this.data.setRecords(e),Di(this),this.taskListTableInstance.setRecords(e),this._syncPropsFromTable(),this._generateTimeLineDateMap(),this.timeLineHeaderLevel=this.parsedOptions.sortedTimelineScales.length,this._updateSize(),this.scenegraph.refreshAll(),this.verticalSplitResizeLine.style.height=this.drawHeight+"px";const t=this.stateManager.scroll.horizontalBarPos,i=this.stateManager.scroll.verticalBarPos;this.scenegraph.setX(-t),this.scenegraph.setY(-i)}updateScales(e){const t=this.parsedOptions.sortedTimelineScales.length;if(this.options.timelineHeader.scales=e,this._sortScales(),xi(this),this._generateTimeLineDateMap(),this.timeLineHeaderLevel=this.parsedOptions.sortedTimelineScales.length,this.scenegraph.refreshAll(),qe(this),this.taskListTableInstance)if(this.taskListTableInstance.columnHeaderLevelCount===this.parsedOptions.timeLineHeaderRowHeights.length)for(let i=0;i<this.taskListTableInstance.columnHeaderLevelCount;i++)this.taskListTableInstance.setRowHeight(i,this.parsedOptions.timeLineHeaderRowHeights[i]);else{const i=this.getAllHeaderRowsHeight()/this.taskListTableInstance.columnHeaderLevelCount;for(let a=0;a<this.taskListTableInstance.columnHeaderLevelCount;a++)this.taskListTableInstance.setRowHeight(a,i)}t!==e.length&&this._resize()}updateDateRange(e,t){this.options.minDate=e,this.options.maxDate=t,Hi(this),this._generateTimeLineDateMap(),this._updateSize(),this.scenegraph.refreshAll(),this._scrollToMarkLine()}updateMarkLine(e){this.options.markLine=e,Mi(this),this.scenegraph.markLine.refresh(),this.scenegraph.renderSceneGraph()}_scrollToMarkLine(){if(this.parsedOptions.scrollToMarkLineDate&&this.parsedOptions.minDate){const e=this.parsedOptions.minDate,{unit:t,step:i}=this.parsedOptions.reverseSortedTimelineScales[0],a=z(this.parsedOptions.scrollToMarkLineDate,e,t,i)*this.parsedOptions.timelineColWidth-this.tableNoFrameWidth/2;this.stateManager.setScrollLeft(a)}}addLink(e){this.parsedOptions.dependencyLinks.push(e),this.scenegraph.dependencyLink.initLinkLine(this.parsedOptions.dependencyLinks.length-1),this.scenegraph.updateNextFrame()}deleteLink(e){if(this.parsedOptions.dependencyLinkDeletable){const t=this.parsedOptions.dependencyLinks.findIndex(i=>i.type===e.type&&i.linkedFromTaskKey===e.linkedFromTaskKey&&i.linkedToTaskKey===e.linkedToTaskKey);if(t!==-1){const i=this.parsedOptions.dependencyLinks[t];this.parsedOptions.dependencyLinks.splice(t,1),this.scenegraph.dependencyLink.deleteLink(i),this.scenegraph.updateNextFrame()}}}get scrollTop(){return this.stateManager.scrollTop}set scrollTop(e){this.stateManager.setScrollTop(e)}get scrollLeft(){return this.stateManager.scrollLeft}set scrollLeft(e){this.stateManager.setScrollLeft(e)}getTaskBarRelativeRect(e){const t=this.scenegraph.taskBar.getTaskBarNodeByIndex(e);return{left:t.attribute.x+this.taskListTableInstance.tableNoFrameWidth+this.taskListTableInstance.tableX+this.tableX-this.scrollLeft,top:t.attribute.y+this.tableY+this.headerHeight-this.scrollTop,width:t.attribute.width,height:t.attribute.height}}getDateColWidth(e){return this.parsedOptions.timelineColWidth}getDateColsWidth(e,t){return(t-e+1)*this.parsedOptions.timelineColWidth}getDateRangeByIndex(e){const t=this.parsedOptions.reverseSortedTimelineScales[0];return e<t.timelineDates.length?{startDate:t.timelineDates[e].startDate,endDate:t.timelineDates[e].endDate}:null}parseTimeFormat(e){return Ue(e)}getTaskBarStyle(e,t){if(typeof this.parsedOptions.taskBarStyle=="function"){const{startDate:i,endDate:a,taskRecord:n}=this.getTaskInfoByTaskListIndex(e,t),r={index:e,startDate:i,endDate:a,taskRecord:n,ganttInstance:this};return this.parsedOptions.taskBarStyle(r)}return this.parsedOptions.taskBarStyle}}class qt{constructor(e){this.editorType="Input",this.editorConfig=e}createElement(){var e;const t=document.createElement("input");t.setAttribute("type","text"),!((e=this.editorConfig)===null||e===void 0)&&e.readonly&&t.setAttribute("readonly",`${this.editorConfig.readonly}`),t.style.position="absolute",t.style.padding="4px",t.style.width="100%",t.style.boxSizing="border-box",t.style.backgroundColor="#FFFFFF",this.element=t,this.container.appendChild(t),t.addEventListener("keydown",i=>{i.key==="a"&&(i.ctrlKey||i.metaKey)&&i.stopPropagation()}),t.addEventListener("wheel",i=>{i.preventDefault()})}setValue(e){this.element.value=e!==void 0?e:""}getValue(){return this.element.value}onStart({value:e,referencePosition:t,container:i,endEdit:a}){this.container=i,this.successCallback=a,this.element||(this.createElement(),e!=null&&this.setValue(e),t!=null&&t.rect&&this.adjustPosition(t.rect)),this.element.focus()}adjustPosition(e){this.element.style.top=e.top+"px",this.element.style.left=e.left+"px",this.element.style.width=e.width+"px",this.element.style.height=e.height+"px"}endEditing(){}onEnd(){var e;!((e=this.container)===null||e===void 0)&&e.contains(this.element)&&this.container.removeChild(this.element),this.element=void 0}isEditorElement(e){return e===this.element}validateValue(e,t,i,a){return!0}}class zs extends qt{constructor(e){super(e),this.editorType="DateInput",this.editorConfig=e}createElement(){const e=document.createElement("input");e.setAttribute("type","date"),e.style.padding="4px",e.style.width="100%",e.style.boxSizing="border-box",e.style.position="absolute",e.style.backgroundColor="#FFFFFF",this.element=e,this.container.appendChild(e),e.addEventListener("keydown",t=>{t.key==="a"&&(t.ctrlKey||t.metaKey)&&t.stopPropagation()}),e.addEventListener("wheel",t=>{t.preventDefault()})}}const Is=[{id:1,title:"Software Development",developer:"liufangfang.jane@bytedance.com",start:"2024-07-24",end:"2024-08-15",progress:31,priority:"P0",children:[{id:2,title:"Project Feature Review",developer:"liufangfang.jane@bytedance.com",start:"2024-07-24",end:"2024-07-24",progress:60,priority:"P0"},{id:3,title:"Determine project scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-25",end:"2024-07-26",progress:100,priority:"P1"},{id:3,title:"Project Create",developer:"liufangfang.jane@bytedance.com",start:"2024-07-27",end:"2024-07-26",progress:100,priority:"P1"},{id:3,title:"Develop feature 1",developer:"liufangfang.jane@bytedance.com",start:"2024-08-01",end:"2024-08-15",progress:0,priority:"P1"}]},{id:2,title:"Scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-24",end:"2024-08-01",progress:60,priority:"P0"},{id:3,title:"Determine project scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-24",end:"2024-08-04",progress:100,priority:"P1",children:[{id:1,title:"Software Development",developer:"liufangfang.jane@bytedance.com",start:"2024-08-01",end:"2024-08-01",progress:90,priority:"P0"},{id:1,title:"Software Development",developer:"liufangfang.jane@bytedance.com",start:"2024-07-30",end:"2024-08-04",progress:31,priority:"P0"},{id:2,title:"Scope",developer:"liufangfang.jane@bytedance.com",start:"2024.07.26",end:"2024.07.08",progress:60,priority:"P0"},{id:3,title:"Determine project scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-29",end:"2024-07-31",progress:100,priority:"P1"},{id:1,title:"Software Development",developer:"liufangfang.jane@bytedance.com",start:"07.24.2024",end:"08.04.2024",progress:31,priority:"P0"},{id:2,title:"Scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-16",end:"2024-07-18",progress:60,priority:"P0"},{id:3,title:"Determine project scope",developer:"liufangfang.jane@bytedance.com",start:"2024-08-09",end:"2024-09-11",progress:100,priority:"P1"}]},{id:1,title:"Software Development",developer:"liufangfang.jane@bytedance.com",start:"2024-07-24",end:"2024-08-04",progress:31,priority:"P0"},{id:2,title:"Scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-26",end:"2024-07-28",progress:60,priority:"P0",children:[{id:3,title:"Determine project scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-29",end:"2024-07-31",progress:100,priority:"P1",children:[{id:1,title:"Software Development",developer:"liufangfang.jane@bytedance.com",start:"2024-07-24",end:"2024-08-04",progress:31,priority:"P0"},{id:2,title:"Scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-26",end:"2024-07-28",progress:60,priority:"P0"},{id:3,title:"Determine project scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-29",end:"2024-07-31",progress:100,priority:"P1"}]},{id:1,title:"Software Development",developer:"liufangfang.jane@bytedance.com",start:"2024-07-24",end:"2024-08-04",progress:31,priority:"P0",children:[{id:1,title:"Software Development",developer:"liufangfang.jane@bytedance.com",start:"2024-07-24",end:"2024-08-04",progress:31,priority:"P0"},{id:2,title:"Scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-06",end:"2024-07-08",progress:60,priority:"P0"},{id:3,title:"Determine project scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-29",end:"2024-07-31",progress:100,priority:"P1"}]},{id:2,title:"Scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-26",end:"2024-07-28",progress:60,priority:"P0"},{id:3,title:"Determine project scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-29",end:"2024-07-31",progress:100,priority:"P1",children:[{id:1,title:"Software Development",developer:"liufangfang.jane@bytedance.com",start:"2024-07-24",end:"2024-08-04",progress:31,priority:"P0"},{id:2,title:"Scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-06",end:"2024-07-08",progress:60,priority:"P0"}]},{id:1,title:"Software Development",developer:"liufangfang.jane@bytedance.com",start:"2024-07-24",end:"2024-08-04",progress:31,priority:"P0"},{id:2,title:"Scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-26",end:"2024-07-28",progress:60,priority:"P0"},{id:3,title:"Determine project scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-29",end:"2024-07-31",progress:100,priority:"P1"}]},{id:3,title:"Determine project scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-29",end:"2024-07-31",progress:100,priority:"P1",children:[{id:1,title:"Software Development",developer:"liufangfang.jane@bytedance.com",start:"2024-07-24",end:"2024-08-04",progress:31,priority:"P0"},{id:2,title:"Scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-23",end:"2024-07-28",progress:60,priority:"P0"},{id:3,title:"Determine project scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-29",end:"2024-07-31",progress:100,priority:"P1"},{id:1,title:"Software Development",developer:"liufangfang.jane@bytedance.com",start:"2024-07-30",end:"2024-08-14",progress:31,priority:"P0"},{id:2,title:"Scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-24",end:"2024-08-04",progress:60,priority:"P0"}]},{id:1,title:"Software Development",developer:"liufangfang.jane@bytedance.com",start:"2024-07-24",end:"2024-08-04",progress:31,priority:"P0",children:[{id:3,title:"Determine project scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-24",end:"2024-08-04",progress:100,priority:"P1"},{id:1,title:"Software Development",developer:"liufangfang.jane@bytedance.com",start:"2024-08-04",end:"2024-08-04",progress:90,priority:"P0"},{id:2,title:"Scope",developer:"liufangfang.jane@bytedance.com",start:"07/24/2024",end:"08/04/2024",progress:60,priority:"P0"}]},{id:2,title:"Scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-27",end:"2024-07-28",progress:60,priority:"P0"},{id:3,title:"Determine project scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-29",end:"2024-07-31",progress:100,priority:"P1",children:[{id:1,title:"Software Development",developer:"liufangfang.jane@bytedance.com",start:"07.24.2024",end:"08.04.2024",progress:31,priority:"P0"},{id:2,title:"Scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-26",end:"2024-07-28",progress:60,priority:"P0"},{id:3,title:"Determine project scope",developer:"liufangfang.jane@bytedance.com",start:"2024-08-09",end:"2024-09-11",progress:100,priority:"P1"},{id:1,title:"Software Development",developer:"liufangfang.jane@bytedance.com",start:"2024-07-24",end:"2024-08-04",progress:31,priority:"P0"},{id:2,title:"Scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-26",end:"2024-07-28",progress:60,priority:"P0"},{id:3,title:"Determine project scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-29",end:"2024-07-31",progress:100,priority:"P1"},{id:1,title:"Software Development",developer:"liufangfang.jane@bytedance.com",start:"2024-07-24",end:"2024-08-04",progress:31,priority:"P0"},{id:2,title:"Scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-26",end:"2024-07-28",progress:60,priority:"P0"},{id:3,title:"Determine project scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-29",end:"2024-07-31",progress:100,priority:"P1"}]},{id:1,title:"Software Development",developer:"liufangfang.jane@bytedance.com",start:"2024-07-24",end:"2024-08-04",progress:31,priority:"P0",children:[{id:3,title:"Determine project scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-24",end:"2024-08-04",progress:100,priority:"P1"},{id:1,title:"Software Development",developer:"liufangfang.jane@bytedance.com",start:"2024-07-24",end:"2024-08-04",progress:31,priority:"P0"},{id:2,title:"Scope",developer:"liufangfang.jane@bytedance.com",start:"2024.07.06",end:"2024.07.08",progress:60,priority:"P0"},{id:3,title:"Determine project scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-29",end:"2024-07-31",progress:100,priority:"P1"}]}],Ps=[{id:1,title:"Software Development",developer:"liufangfang.jane@bytedance.com",start:"2024-07-15",end:"2024-07-16",progress:31,priority:"P0"},{id:2,title:"Scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-16",end:"2024-07-17",progress:60,priority:"P0"},{id:3,title:"Software Development",developer:"liufangfang.jane@bytedance.com",start:"2024-07-18",end:"2024-07-19",progress:90,priority:"P0"},{id:4,title:"Determine project scope",developer:"liufangfang.jane@bytedance.com",start:"2024/07/17",end:"2024/07/18",progress:100,priority:"P1"},{id:5,title:"Scope",developer:"liufangfang.jane@bytedance.com",start:"07/19/2024",end:"07/20/2024",progress:60,priority:"P0"},{id:6,title:"Determine project scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-24",end:"2024-08-04",progress:100,priority:"P1"},{id:7,title:"Software Development",developer:"liufangfang.jane@bytedance.com",start:"2024-07-24",end:"2024-08-04",progress:31,priority:"P0"},{id:8,title:"Scope",developer:"liufangfang.jane@bytedance.com",start:"2024.07.06",end:"2024.07.08",progress:60,priority:"P0"},{id:9,title:"Determine project scope",developer:"liufangfang.jane@bytedance.com",start:"2024/07/09",end:"2024/07/11",progress:100,priority:"P1"},{id:10,title:"Software Development",developer:"liufangfang.jane@bytedance.com",start:"07.24.2024",end:"08.04.2024",progress:31,priority:"P0"},{id:11,title:"Software Development",developer:"liufangfang.jane@bytedance.com",start:"2024-07-24",end:"2024-08-04",progress:31,priority:"P0"},{id:12,title:"Scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-06",end:"2024-07-08",progress:60,priority:"P0"},{id:13,title:"Determine project scope",developer:"liufangfang.jane@bytedance.com",start:"2024-07-09",end:"2024-07-11",progress:100,priority:"P1"}],Es=[{id:1,title:"Project Task 1",developer:"bear.xiong",avatar:"https://lf9-dp-fe-cms-tos.byteorg.com/obj/bit-cloud/VTable/custom-render/bear.jpg",start:"2024-07-24",end:"2024-07-26",progress:31,priority:"P0"},{id:2,title:"Project Task 2",developer:"wolf.lang",avatar:"https://lf9-dp-fe-cms-tos.byteorg.com/obj/bit-cloud/VTable/custom-render/wolf.jpg",start:"07/25/2024",end:"07/28/2024",progress:60,priority:"P0"},{id:3,title:"Project Task 3",developer:"rabbit.tu",avatar:"https://lf9-dp-fe-cms-tos.byteorg.com/obj/bit-cloud/VTable/custom-render/rabbit.jpg",start:"2024-07-28",end:"2024-08-01",progress:100,priority:"P1"},{id:1,title:"Project Task 4",developer:"cat.mao",avatar:"https://lf9-dp-fe-cms-tos.byteorg.com/obj/bit-cloud/VTable/custom-render/cat.jpg",start:"2024-07-31",end:"2024-08-03",progress:31,priority:"P0"},{id:2,title:"Project Task 5",developer:"bird.niao",avatar:"https://lf9-dp-fe-cms-tos.byteorg.com/obj/bit-cloud/VTable/custom-render/bird.jpeg",start:"2024-08-02",end:"2024-08-04",progress:60,priority:"P0"},{id:3,title:"Project Task 6",developer:"flower.hua",avatar:"https://lf9-dp-fe-cms-tos.byteorg.com/obj/bit-cloud/VTable/custom-render/flower.jpg",start:"2024-08-03",end:"2024-08-10",progress:100,priority:"P1"}],Vs=ci({name:"plugin_gantt_vtable",__name:"index",setup(s){const e=pi(),t=new qt,i=new zs;At("input",t),At("date-input",i);const a=Pe(),n=Pe(),r=Pe(),l=Pe(),o=Pe(),h=Pe(),c={overscrollBehavior:"none",records:Is,taskListTable:{columns:[{field:"title",title:"title",width:"auto",sort:!0,tree:!0,editor:"input"},{field:"start",title:"start",width:"auto",sort:!0,editor:"date-input"},{field:"end",title:"end",width:"auto",sort:!0,editor:"date-input"},{field:"priority",title:"priority",width:"auto",sort:!0,editor:"input"},{field:"progress",title:"progress",width:"auto",sort:!0,headerStyle:{borderColor:"#e1e4e8"},style:{borderColor:"#e1e4e8",color:"green"},editor:"input"}],tableWidth:250,minTableWidth:100,maxTableWidth:600},frame:{outerFrameStyle:{borderLineWidth:2,borderColor:"#e1e4e8",cornerRadius:8},verticalSplitLine:{lineColor:"#e1e4e8",lineWidth:3},horizontalSplitLine:{lineColor:"#e1e4e8",lineWidth:3},verticalSplitLineMoveable:!0,verticalSplitLineHighlight:{lineColor:"green",lineWidth:3}},grid:{verticalLine:{lineWidth:1,lineColor:"#e1e4e8"},horizontalLine:{lineWidth:1,lineColor:"#e1e4e8"}},headerRowHeight:40,rowHeight:40,taskBar:{startDateField:"start",endDateField:"end",progressField:"progress",moveable:!0,hoverBarStyle:{barOverlayColor:"rgba(99, 144, 0, 0.4)"},labelText:"{title} {progress}%",labelTextStyle:{fontFamily:"Arial",fontSize:16,textAlign:"left",textOverflow:"ellipsis"},barStyle:{width:20,barColor:"#ee8800",completedBarColor:"#91e8e0",cornerRadius:8}},timelineHeader:{colWidth:100,backgroundColor:"#EEF1F5",horizontalLine:{lineWidth:1,lineColor:"#e1e4e8"},verticalLine:{lineWidth:1,lineColor:"#e1e4e8"},scales:[{unit:"week",step:1,startOfWeek:"sunday",format(k){return`Week ${k.dateIndex}`},style:{fontSize:20,fontWeight:"bold",color:"white",strokeColor:"black",textAlign:"right",textBaseline:"bottom",textStick:!0}},{unit:"day",step:1,format(k){return k.dateIndex.toString()},style:{fontSize:20,fontWeight:"bold",color:"white",strokeColor:"black",textAlign:"right",textBaseline:"bottom"}}]},markLine:[{date:"2024-07-28",style:{lineWidth:1,lineColor:"blue",lineDash:[8,4]}},{date:"2024-08-17",style:{lineWidth:2,lineColor:"red",lineDash:[8,4]}}],rowSeriesNumber:{title:"",dragOrder:!0},scrollStyle:{scrollRailColor:"RGBA(246,246,246,0.5)",visible:"scrolling",width:6,scrollSliderCornerRadius:2,scrollSliderColor:"#5cb85c"}},u={records:Ps,taskListTable:{columns:[{field:"title",title:"title",width:"auto",tree:!0},{field:"start",title:"start",width:"auto",editor:"date-input"},{field:"end",title:"end",width:"auto",editor:"date-input"},{field:"priority",title:"priority",width:"auto",editor:"input"},{field:"progress",title:"progress",width:"auto",headerStyle:{borderColor:"#e1e4e8"},style:{borderColor:"#e1e4e8",color:"green"},editor:"input"}],tableWidth:400,minTableWidth:100,maxTableWidth:600},dependency:{links:[{type:Y.FinishToStart,linkedFromTaskKey:1,linkedToTaskKey:2},{type:Y.StartToFinish,linkedFromTaskKey:2,linkedToTaskKey:3},{type:Y.StartToStart,linkedFromTaskKey:3,linkedToTaskKey:4},{type:Y.FinishToFinish,linkedFromTaskKey:4,linkedToTaskKey:5}],linkSelectedLineStyle:{shadowBlur:5,shadowColor:"red",lineColor:"red",lineWidth:1}},frame:{verticalSplitLineMoveable:!0,outerFrameStyle:{borderLineWidth:2,cornerRadius:8},verticalSplitLine:{lineWidth:3,lineColor:"#e1e4e8"},verticalSplitLineHighlight:{lineColor:"green",lineWidth:3}},grid:{verticalLine:{lineWidth:1,lineColor:"#e1e4e8"},horizontalLine:{lineWidth:1,lineColor:"#e1e4e8"}},headerRowHeight:60,rowHeight:40,taskBar:{startDateField:"start",endDateField:"end",progressField:"progress",labelText:"{title} {progress}%",labelTextStyle:{fontFamily:"Arial",fontSize:16,textAlign:"left"},barStyle:{width:20,barColor:"#ee8800",completedBarColor:"#91e8e0",cornerRadius:10},selectedBarStyle:{shadowBlur:5,shadowOffsetX:0,shadowOffsetY:0,shadowColor:"black",borderColor:"red",borderLineWidth:1}},timelineHeader:{verticalLine:{lineWidth:1,lineColor:"#e1e4e8"},horizontalLine:{lineWidth:1,lineColor:"#e1e4e8"},backgroundColor:"#EEF1F5",colWidth:60,scales:[{unit:"week",step:1,startOfWeek:"sunday",format(k){return`Week ${k.dateIndex}`},style:{fontSize:20,fontWeight:"bold",color:"red"}},{unit:"day",step:1,format(k){return k.dateIndex.toString()},style:{fontSize:20,fontWeight:"bold",color:"red"}}]},minDate:"2024-07-14",maxDate:"2024-10-15",rowSeriesNumber:{title:"",dragOrder:!0},scrollStyle:{visible:"scrolling"},overscrollBehavior:"none"},g=["#aecde6","#c6a49a","#ffb582","#eec1de","#b3d9b3","#cccccc","#e59a9c","#d9d1a5","#c9bede"],_=["#1f77b4","#8c564b","#ff7f0e","#e377c2","#2ca02c","#7f7f7f","#d62728","#bcbd22","#9467bd"],S={records:Es,taskListTable:{columns:[{field:"title",title:"TASK",width:"200",headerStyle:{textAlign:"center",fontSize:20,fontWeight:"bold"},style:{},customLayout:k=>{const{table:f,row:x,col:C,rect:w}=k,O=f.getCellOriginRecord(C,x),{height:B,width:D}=w??f.getCellRect(C,x),M=new A({y:10,x:20,height:B-20,width:D-40,fill:"#ddd",display:"flex",flexDirection:"column",cornerRadius:30}),N=new he({text:O.developer,fontSize:16,fontFamily:"sans-serif",fill:_[k.row],fontWeight:"bold",maxLineWidth:D-120,boundsPadding:[10,0,0,0],alignSelf:"center"});M.add(N);const X=new he({text:`${se(new Date(O.start),"mm/dd")}-${se(new Date(O.end),"mm/dd")}`,fontSize:12,fontFamily:"sans-serif",fontWeight:"bold",fill:"black",boundsPadding:[10,0,0,0],alignSelf:"center"});return M.add(X),{rootContainer:M,expectedWidth:160}}}],tableWidth:"auto"},frame:{outerFrameStyle:{borderLineWidth:2,borderColor:"#E1E4E8",cornerRadius:8}},grid:{horizontalLine:{lineWidth:2,lineColor:"#d5d9ee"}},headerRowHeight:60,rowHeight:80,taskBar:{startDateField:"start",endDateField:"end",progressField:"progress",barStyle:{width:60},customLayout:k=>{const f=_.length,{width:x,height:C,index:w,taskDays:O,progress:B,taskRecord:D}=k,M=new A({width:x,height:C,cornerRadius:30,fill:{gradient:"linear",x0:0,y0:0,x1:1,y1:0,stops:[{offset:0,color:g[w%f]},{offset:.5,color:_[w%f]},{offset:1,color:g[w%f]}]},display:"flex",flexDirection:"row",flexWrap:"nowrap"}),N=new A({height:C,width:60,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"space-around"});M.add(N);const X=new Ze({width:50,height:50,image:D.avatar,cornerRadius:25});N.add(X);const E=new A({height:C,width:x-120,display:"flex",flexDirection:"column"});M.add(E);const R=new he({text:D.developer,fontSize:16,fontFamily:"sans-serif",fill:"white",fontWeight:"bold",maxLineWidth:x-120,boundsPadding:[10,0,0,0]});E.add(R);const $=new he({text:`${O}`,fontSize:13,fontFamily:"sans-serif",fill:"white",boundsPadding:[10,0,0,0]});if(E.add($),x>=120){const K=new A({cornerRadius:20,fill:"white",height:40,width:40,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",boundsPadding:[10,0,0,0]});M.add(K);const V=new he({text:`${B}%`,fontSize:12,fontFamily:"sans-serif",fill:"black",alignSelf:"center",fontWeight:"bold",maxLineWidth:(x-60)/2,boundsPadding:[0,0,0,0]});K.add(V)}return{rootContainer:M}},hoverBarStyle:{cornerRadius:30}},timelineHeader:{backgroundColor:"#f0f0fb",colWidth:80,scales:[{unit:"day",step:1,format(k){return k.dateIndex.toString()},customLayout:k=>{const{width:f,height:x,startDate:C,dateIndex:w}=k,O=new A({width:f,height:x,display:"flex",flexDirection:"row",flexWrap:"nowrap"}),B=new A({height:x,width:30,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"space-around"});O.add(B);const D=new Ze({width:20,height:30,image:'<svg t="1724675965803" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4299" width="200" height="200"><path d="M53.085678 141.319468C23.790257 141.319468 0 165.035326 0 194.34775L0 918.084273C0 947.295126 23.796789 971.112572 53.085678 971.112572L970.914322 971.112572C1000.209743 971.112572 1024 947.396696 1024 918.084273L1024 194.34775C1024 165.136896 1000.203211 141.319468 970.914322 141.319468L776.827586 141.319468 812.137931 176.629813 812.137931 88.275862C812.137931 68.774506 796.328942 52.965517 776.827586 52.965517 757.32623 52.965517 741.517241 68.774506 741.517241 88.275862L741.517241 176.629813 741.517241 211.940158 776.827586 211.940158 970.914322 211.940158C961.186763 211.940158 953.37931 204.125926 953.37931 194.34775L953.37931 918.084273C953.37931 908.344373 961.25643 900.491882 970.914322 900.491882L53.085678 900.491882C62.813237 900.491882 70.62069 908.306097 70.62069 918.084273L70.62069 194.34775C70.62069 204.087649 62.74357 211.940158 53.085678 211.940158L247.172414 211.940158C266.67377 211.940158 282.482759 196.131169 282.482759 176.629813 282.482759 157.128439 266.67377 141.319468 247.172414 141.319468L53.085678 141.319468ZM211.862069 176.629813C211.862069 196.131169 227.671058 211.940158 247.172414 211.940158 266.67377 211.940158 282.482759 196.131169 282.482759 176.629813L282.482759 88.275862C282.482759 68.774506 266.67377 52.965517 247.172414 52.965517 227.671058 52.965517 211.862069 68.774506 211.862069 88.275862L211.862069 176.629813ZM1024 353.181537 1024 317.871192 988.689655 317.871192 35.310345 317.871192 0 317.871192 0 353.181537 0 441.457399C0 460.958755 15.808989 476.767744 35.310345 476.767744 54.811701 476.767744 70.62069 460.958755 70.62069 441.457399L70.62069 353.181537 35.310345 388.491882 988.689655 388.491882 953.37931 353.181537 953.37931 441.457399C953.37931 460.958755 969.188299 476.767744 988.689655 476.767744 1008.191011 476.767744 1024 460.958755 1024 441.457399L1024 353.181537ZM776.937913 582.62069C796.439287 582.62069 812.248258 566.811701 812.248258 547.310345 812.248258 527.808989 796.439287 512 776.937913 512L247.172414 512C227.671058 512 211.862069 527.808989 211.862069 547.310345 211.862069 566.811701 227.671058 582.62069 247.172414 582.62069L776.937913 582.62069ZM247.172414 688.551724C227.671058 688.551724 211.862069 704.360713 211.862069 723.862069 211.862069 743.363425 227.671058 759.172414 247.172414 759.172414L600.386189 759.172414C619.887563 759.172414 635.696534 743.363425 635.696534 723.862069 635.696534 704.360713 619.887563 688.551724 600.386189 688.551724L247.172414 688.551724ZM776.827586 211.940158 741.517241 176.629813 741.517241 247.328574C741.517241 266.829948 757.32623 282.638919 776.827586 282.638919 796.328942 282.638919 812.137931 266.829948 812.137931 247.328574L812.137931 176.629813 812.137931 141.319468 776.827586 141.319468 247.172414 141.319468C227.671058 141.319468 211.862069 157.128439 211.862069 176.629813 211.862069 196.131169 227.671058 211.940158 247.172414 211.940158L776.827586 211.940158ZM282.482759 176.629813C282.482759 157.128439 266.67377 141.319468 247.172414 141.319468 227.671058 141.319468 211.862069 157.128439 211.862069 176.629813L211.862069 247.328574C211.862069 266.829948 227.671058 282.638919 247.172414 282.638919 266.67377 282.638919 282.482759 266.829948 282.482759 247.328574L282.482759 176.629813Z" fill="#389BFF" p-id="4300"></path></svg>'});B.add(D);const M=new A({height:x,width:f-30,display:"flex",flexDirection:"column"});O.add(M);const N=new he({text:String(w).padStart(2,"0"),fontSize:20,fontWeight:"bold",fontFamily:"sans-serif",fill:"#777",textAlign:"right",maxLineWidth:f-30,boundsPadding:[15,0,0,0]});M.add(N);const X=new he({text:Ri(C,"short").toLocaleUpperCase(),fontSize:12,fontFamily:"sans-serif",fill:"#777",boundsPadding:[0,0,0,0]});return M.add(X),{rootContainer:O}}}]},minDate:"2024-07-20",maxDate:"2024-08-15",markLine:[{date:"2024-07-29",style:{lineWidth:1,lineColor:"blue",lineDash:[8,4]}},{date:"2024-08-17",style:{lineWidth:2,lineColor:"red",lineDash:[8,4]}}],scrollStyle:{scrollRailColor:"RGBA(246,246,246,0.5)",visible:"focus",width:6,scrollSliderCornerRadius:2,scrollSliderColor:"#5cb85c"}};function y(){l.value=new Ot(a.value,v(c)),o.value=new Ot(n.value,v(u)),h.value=new Ot(r.value,v(S))}function v(k){return e.darkMode?(k.taskListTable.theme=hi,k.timelineHeader.backgroundColor="#212121",k.underlayBackgroundColor="#000"):(k.taskListTable.theme=Xe,k.timelineHeader.backgroundColor="#f0f0fb",k.underlayBackgroundColor="#fff"),k}const L=ui(()=>e.darkMode,k=>{var f,x,C;(f=l.value)==null||f.release(),(x=o.value)==null||x.release(),(C=h.value)==null||C.release(),y()});return gi(()=>{y()}),_i(()=>{L()}),(k,f)=>{const x=Jt,C=mi,w=yi;return vi(),bi(w,{direction:"vertical",fill:"",size:16},{default:Ge(()=>[je(C,{header:"VTableGantt",class:"h-full card-wrapper"},{default:Ge(()=>[je(x,{label:"More Demos: ",link:"https://www.visactor.com/vtable/example"})]),_:1}),je(C,{class:"h-full card-wrapper"},{default:Ge(()=>[Bt("div",{ref_key:"basicGanttDomRef",ref:a,class:"relative h-400px"},null,512)]),_:1}),je(C,{class:"h-full card-wrapper"},{default:Ge(()=>[Bt("div",{ref_key:"linkGanttDomRef",ref:n,class:"relative h-400px"},null,512)]),_:1}),je(C,{class:"h-full card-wrapper"},{default:Ge(()=>[Bt("div",{ref_key:"customGanttDomRef",ref:r,class:"relative h-400px"},null,512)]),_:1})]),_:1})}}});export{Vs as default};
