import{r as k,R as r,aH as H,bP as N,t as g,v as n,z as f,F as S,al as z,y as O,C as oe,ae as P,D as R,K as C,P as L,J as x,aP as ne,aO as le}from"./vue-vendor-DLKW-W3j.js";import{j as B}from"./index-BRPcTNaf.js";const V="/assets/jpg/001-Bg3uSwIK.jpg",J="/assets/jpg/002-CQfIn_Jg.jpg",M="/assets/jpg/003-BQJ3SB9i.jpg",$="/assets/jpg/004-D_CqIUBy.jpg",Q="/assets/jpg/005-B44vLpON.jpg",D="/assets/jpg/006-XFl_NOhH.jpg",F="/assets/jpg/007-2OPtZVUF.jpg",G="/assets/jpg/008-z0s8QBQE.jpg",K="/assets/jpg/009-6TAqM2n1.jpg",A="/assets/jpg/soybean-JC38yUrs.jpg",W=new URL("../webp/001-Dof7QgU7.webp",import.meta.url).href,q=new URL("../webp/002-geKJjPWA.webp",import.meta.url).href,Z=new URL("../webp/003-C9TvG0GK.webp",import.meta.url).href,X=new URL("../webp/004-Bb3ZW5cC.webp",import.meta.url).href,Y=new URL("../webp/005-Bw145vG1.webp",import.meta.url).href,ee=new URL("../webp/006-CVKYCPyL.webp",import.meta.url).href,se=new URL("../webp/007-c6QVvuxR.webp",import.meta.url).href,te=new URL("../webp/008-DUhcisu3.webp",import.meta.url).href,ae=new URL("../webp/009-BDjlWtJA.webp",import.meta.url).href,ce={class:"scroll-container"},re=["src","onLoad"],ie={key:0,class:"loading-indicator"},ge={key:0,class:"loading-more"},me={key:1,class:"no-more"},pe=k({__name:"image-load-new",setup(U){let t=null;const j=Object.assign({"../../assets/imgs/001.jpg":V,"../../assets/imgs/002.jpg":J,"../../assets/imgs/003.jpg":M,"../../assets/imgs/004.jpg":$,"../../assets/imgs/005.jpg":Q,"../../assets/imgs/006.jpg":D,"../../assets/imgs/007.jpg":F,"../../assets/imgs/008.jpg":G,"../../assets/imgs/009.jpg":K,"../../assets/imgs/soybean.jpg":A}),p=[W,q,Z,X,Y,ee,se,te,ae];Object.entries(j).sort(([s],[a])=>s.localeCompare(a)).map(([,s])=>s);const m=p;m.length;const c={pageSize:3,allImages:m,observerOptions:{root:null,rootMargin:"0px 0px 200px 0px",threshold:.1}},i=r([]),u=r(1),l=r(!1),_=r(!0),v=r([]),w=r([]),h=s=>{if(!s)return;const a=s.$el??s;a instanceof HTMLElement&&(w.value.includes(a)||w.value.push(a))},e=s=>{console.log("Intersection Observer triggered,entries:",s),s.forEach(a=>{a.isIntersecting&&!l.value&&(b(),t==null||t.unobserve(a.target))})},o=()=>{t==null||t.disconnect(),P(()=>{t=new IntersectionObserver(e,c.observerOptions);const s=w.value.filter(I=>I.isConnected&&I.offsetParent!==null),a=s[s.length-1];a?(console.log("添加观察元素Observing element:",a),t.observe(a)):console.warn("No valid elements to observe")})},d=s=>{v.value[s]=!0},b=async()=>{if(l.value||!_.value)return;l.value=!0;const s=(u.value-1)*c.pageSize,a=s+c.pageSize;i.value=[...i.value,...c.allImages.slice(s,a)],v.value=[...v.value,...Array.from({length:Math.min(c.pageSize,c.allImages.length-s)})],_.value=a<c.allImages.length,u.value+=1,l.value=!1,P(()=>o())};return H(async()=>{await b()}),N(()=>{t==null||t.disconnect(),t=null}),(s,a)=>(n(),g("div",ce,[(n(!0),g(S,null,z(i.value,(I,y)=>(n(),g("div",{key:y,ref_for:!0,ref:T=>h(T),class:"image-item"},[O("img",{src:I,alt:"Gallery Image",class:oe({loaded:v.value[y]}),onLoad:T=>d(y)},null,42,re),v.value[y]?f("",!0):(n(),g("div",ie,a[0]||(a[0]=[O("div",{class:"loader"},null,-1)])))]))),128)),l.value?(n(),g("div",ge,"加载中...")):f("",!0),_.value?f("",!0):(n(),g("div",me,"已加载全部内容"))]))}}),ue=B(pe,[["__scopeId","data-v-a0829b3a"]]),_e=["src"],de={key:0,class:"loading"},ve={key:1,class:"no-more"},E=3,fe=k({name:"ImageLoadOld",__name:"image-load-old",setup(U){const t=Object.assign({"../../assets/imgs/001.jpg":V,"../../assets/imgs/002.jpg":J,"../../assets/imgs/003.jpg":M,"../../assets/imgs/004.jpg":$,"../../assets/imgs/005.jpg":Q,"../../assets/imgs/006.jpg":D,"../../assets/imgs/007.jpg":F,"../../assets/imgs/008.jpg":G,"../../assets/imgs/009.jpg":K,"../../assets/imgs/soybean.jpg":A}),j=[W,q,Z,X,Y,ee,se,te,ae];Object.entries(t).sort(([e],[o])=>e.localeCompare(o)).map(([,e])=>e);const p=j;p.length;const m=r([]),c=r(1),i=r(!1),u=r(!0),l=r(null),_=async()=>{if(i.value||!u.value)return;i.value=!0;const e=(c.value-1)*E,o=e+E;m.value.push(...p.slice(e,o)),u.value=o<p.length,c.value+=1,i.value=!1},v=(e,o=100)=>(console.log("isNearBottom:el.scrollTop, el.clientHeight, el.scrollHeight, threshold",e.scrollTop+e.clientHeight>=e.scrollHeight-o,e.scrollTop,e.clientHeight,e.scrollHeight,o),e.scrollTop+e.clientHeight>=e.scrollHeight-o),h=((e,o)=>{let d;return(...b)=>{clearTimeout(d),d=setTimeout(()=>e(...b),o)}})(()=>{l.value&&v(l.value)&&_()},300);return H(async()=>{await _()}),N(()=>{l.value&&l.value.removeEventListener("scroll",h)}),(e,o)=>(n(),g("div",{ref_key:"scrollContainer",ref:l,class:"scroll-container",onScroll:o[0]||(o[0]=(...d)=>R(h)&&R(h)(...d))},[(n(!0),g(S,null,z(m.value,(d,b)=>(n(),g("div",{key:b,class:"image-item"},[O("img",{src:d,alt:"图片"},null,8,_e)]))),128)),i.value?(n(),g("div",de,"加载中...")):f("",!0),u.value?f("",!0):(n(),g("div",ve,"没有更多了~"))],544))}}),be=B(fe,[["__scopeId","data-v-43ff014b"]]),je=k({name:"personal-content_image-loading-optimization",__name:"index",setup(U){const t=r("first"),j=(p,m)=>{console.log(p,m)};return(p,m)=>{const c=be,i=ne,u=ue,l=le;return n(),C(l,{modelValue:t.value,"onUpdate:modelValue":m[0]||(m[0]=_=>t.value=_),class:"demo-tabs",onTabClick:j},{default:L(()=>[x(i,{label:"传统实现方式",name:"first"},{default:L(()=>[t.value==="first"?(n(),C(c,{key:0})):f("",!0)]),_:1}),x(i,{label:"IntersectionObserver实现方式",name:"second"},{default:L(()=>[t.value==="second"?(n(),C(u,{key:0})):f("",!0)]),_:1})]),_:1},8,["modelValue"])}}}),Ie=B(je,[["__scopeId","data-v-ca423d0c"]]);export{Ie as default};
