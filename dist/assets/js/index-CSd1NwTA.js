import{r as T,R as c,aH as x,bP as z,t as _,v as n,z as v,F as P,al as U,y as O,C as G,ae as E,D as H,K as y,P as k,J as N,aP as K,aO as X}from"./vue-vendor-DLKW-W3j.js";import{j as C}from"./index-CE1BUwf_.js";const $="/assets/jpg/001-Bg3uSwIK.jpg",M="/assets/jpg/002-CQfIn_Jg.jpg",V="/assets/jpg/003-BQJ3SB9i.jpg",F="/assets/jpg/004-D_CqIUBy.jpg",R="/assets/jpg/005-B44vLpON.jpg",A="/assets/jpg/006-XFl_NOhH.jpg",J="/assets/jpg/007-2OPtZVUF.jpg",Q="/assets/jpg/008-z0s8QBQE.jpg",q="/assets/jpg/009-6TAqM2n1.jpg",D="/assets/jpg/soybean-JC38yUrs.jpg",Z={class:"scroll-container"},W=["src","onLoad"],Y={key:0,class:"loading-indicator"},ee={key:0,class:"loading-more"},se={key:1,class:"no-more"},te=T({__name:"image-load-new",setup(S){let e=null;const i={totalImages:9,pageSize:3,pathTemplate:t=>new URL(Object.assign({"../../assets/imgs/001.jpg":$,"../../assets/imgs/002.jpg":M,"../../assets/imgs/003.jpg":V,"../../assets/imgs/004.jpg":F,"../../assets/imgs/005.jpg":R,"../../assets/imgs/006.jpg":A,"../../assets/imgs/007.jpg":J,"../../assets/imgs/008.jpg":Q,"../../assets/imgs/009.jpg":q,"../../assets/imgs/soybean.jpg":D})[`../../assets/imgs/${t}.jpg`],import.meta.url).href,observerOptions:{root:null,rootMargin:"0px 0px 200px 0px",threshold:.1}},p=c([]),l=c(1),g=c(!1),r=c(!0),u=c([]),d=c([]),h=t=>{if(!t)return;const a=t.$el??t;a instanceof HTMLElement&&(d.value.includes(a)||d.value.push(a))},s=Array.from({length:i.totalImages},(t,a)=>{const f=(a+1).toString().padStart(3,"0");return i.pathTemplate(f)}),o=t=>{console.log("Intersection Observer triggered,entries:",t),t.forEach(a=>{a.isIntersecting&&!g.value&&(B(),e==null||e.unobserve(a.target))})},m=()=>{e==null||e.disconnect(),E(()=>{e=new IntersectionObserver(o,i.observerOptions);const t=d.value.filter(f=>f.isConnected&&f.offsetParent!==null),a=t[t.length-1];a?(console.log("添加观察元素Observing element:",a),e.observe(a)):console.warn("No valid elements to observe")})},j=t=>{u.value[t]=!0},B=async()=>{if(g.value||!r.value)return;g.value=!0;const t=(l.value-1)*i.pageSize,a=t+i.pageSize;p.value=[...p.value,...s.slice(t,a)],u.value=[...u.value,...Array.from({length:Math.min(i.pageSize,s.length-t)})],r.value=a<s.length,l.value+=1,g.value=!1,E(()=>m())};return x(async()=>{await B()}),z(()=>{e==null||e.disconnect(),e=null}),(t,a)=>(n(),_("div",Z,[(n(!0),_(P,null,U(p.value,(f,I)=>(n(),_("div",{key:I,ref_for:!0,ref:L=>h(L),class:"image-item"},[O("img",{src:f,alt:"Gallery Image",class:G({loaded:u.value[I]}),onLoad:L=>j(I)},null,42,W),u.value[I]?v("",!0):(n(),_("div",Y,a[0]||(a[0]=[O("div",{class:"loader"},null,-1)])))]))),128)),g.value?(n(),_("div",ee,"加载中...")):v("",!0),r.value?v("",!0):(n(),_("div",se,"已加载全部内容"))]))}}),ae=C(te,[["__scopeId","data-v-ce190717"]]),oe=["src"],ne={key:0,class:"loading"},le={key:1,class:"no-more"},re=9,w=3,ce=T({name:"ImageLoadOld",__name:"image-load-old",setup(S){const e=Array.from({length:re},(s,o)=>{const m=(o+1).toString().padStart(3,"0");return new URL(Object.assign({"../../assets/imgs/001.jpg":$,"../../assets/imgs/002.jpg":M,"../../assets/imgs/003.jpg":V,"../../assets/imgs/004.jpg":F,"../../assets/imgs/005.jpg":R,"../../assets/imgs/006.jpg":A,"../../assets/imgs/007.jpg":J,"../../assets/imgs/008.jpg":Q,"../../assets/imgs/009.jpg":q,"../../assets/imgs/soybean.jpg":D})[`../../assets/imgs/${m}.jpg`],import.meta.url).href}),i=c([]),p=c(1),l=c(!1),g=c(!0),r=c(null),u=async()=>{if(l.value||!g.value)return;l.value=!0;const s=(p.value-1)*w,o=s+w;i.value.push(...e.slice(s,o)),g.value=o<e.length,p.value+=1,l.value=!1},d=(s,o=100)=>(console.log("isNearBottom:el.scrollTop, el.clientHeight, el.scrollHeight, threshold",s.scrollTop+s.clientHeight>=s.scrollHeight-o,s.scrollTop,s.clientHeight,s.scrollHeight,o),s.scrollTop+s.clientHeight>=s.scrollHeight-o),b=((s,o)=>{let m;return(...j)=>{clearTimeout(m),m=setTimeout(()=>s(...j),o)}})(()=>{r.value&&d(r.value)&&u()},300);return x(async()=>{await u()}),z(()=>{r.value&&r.value.removeEventListener("scroll",b)}),(s,o)=>(n(),_("div",{ref_key:"scrollContainer",ref:r,class:"scroll-container",onScroll:o[0]||(o[0]=(...m)=>H(b)&&H(b)(...m))},[(n(!0),_(P,null,U(i.value,(m,j)=>(n(),_("div",{key:j,class:"image-item"},[O("img",{src:m,alt:"图片"},null,8,oe)]))),128)),l.value?(n(),_("div",ne,"加载中...")):v("",!0),g.value?v("",!0):(n(),_("div",le,"没有更多了~"))],544))}}),ie=C(ce,[["__scopeId","data-v-3343a20c"]]),ge=T({name:"personal-content_image-loading-optimization",__name:"index",setup(S){const e=c("first"),i=(p,l)=>{console.log(p,l)};return(p,l)=>{const g=ie,r=K,u=ae,d=X;return n(),y(d,{modelValue:e.value,"onUpdate:modelValue":l[0]||(l[0]=h=>e.value=h),class:"demo-tabs",onTabClick:i},{default:k(()=>[N(r,{label:"传统实现方式",name:"first"},{default:k(()=>[e.value==="first"?(n(),y(g,{key:0})):v("",!0)]),_:1}),N(r,{label:"IntersectionObserver实现方式",name:"second"},{default:k(()=>[e.value==="second"?(n(),y(u,{key:0})):v("",!0)]),_:1})]),_:1},8,["modelValue"])}}}),me=C(ge,[["__scopeId","data-v-ca423d0c"]]);export{me as default};
