import{a as Qn,r as Jn,ak as bt,al as dn,i as Yn,Z as fn,n as An,am as st,an as In,$ as hn}from"./index-DSrCSEjU.js";const xt="undefined",J=Promise,ut=e=>J.resolve(e),Vt=e=>J.reject(e),_e=Object,zt=RegExp,p=void 0,jt=null,b=!0,S=!1,Re=(e,t,n)=>e.then(t,n),je=(e,t)=>e.catch(t),Dn=(e,t)=>e.finally(t),Wt=(e,t,n)=>JSON.stringify(e,t,n),Xn=e=>JSON.parse(e),dt=(e,t=0)=>setTimeout(e,t),At=e=>clearTimeout(e),me=e=>_e.keys(e),Dt=e=>_e.values(e),ae=(e,t)=>e.forEach(t),ee=(e,...t)=>e.push(...t),ie=(e,t)=>e.map(t),ge=(e,t)=>e.filter(t),Zn=e=>e.shift(),Le=(e,t,n=0,...s)=>e.splice(t,n,...s),O=e=>e.length,fe=e=>Array.isArray(e),qe=(e,t)=>delete e[t],ft=e=>typeof e,ot=(e,t)=>e.includes(t),es=typeof window===xt&&(typeof process!==xt?typeof process.cwd=="function":typeof Deno!==xt),Qe="memory",Pe="restore",I=()=>{},Je=e=>e,k=e=>ft(e)==="function",de=e=>ft(e)==="number"&&!Number.isNaN(e),Ye=e=>ft(e)==="string",Ft=e=>e!==jt&&ft(e)==="object",Gt=e=>_e.prototype.toString.call(e),ye=e=>Gt(e)==="[object Object]",se=(e,t)=>e instanceof t,Te=e=>e?e.getTime():Date.now(),we=e=>e.context,$e=e=>e.config,Fn=e=>e.options,ts=e=>Fn(we(e)),ns=e=>{const{params:t,headers:n}=$e(e);return Wt([e.type,e.url,t,e.data,n])},le=e=>e.key,Un=(e,t,n=[])=>{const s=k(e)?e(...n):e;return t(!!s.key,"hook handler must be a method instance or a function that returns method instance"),s},Qt=e=>{const t=Gt(e);return/^\[object (Blob|FormData|ReadableStream|URLSearchParams)\]$/i.test(t)||se(e,ArrayBuffer)},Ie=(e,...t)=>_e.assign(e,...t),ss=(e,...t)=>{const n={};for(const s in e)t.includes(s)||(n[s]=e[s]);return n};function Ln(){let e,t;return{promise:new Promise((s,o)=>{e=s,t=o}),resolve:e,reject:t}}const Xe=e=>{const{cacheFor:t}=$e(e),n=u=>de(u)?Te()+u:Te(u||p);let s=Qe,o=()=>0,a=S,r=p;const i=k(t);if(!i){let u=t;if(ye(t)){const{mode:h=Qe,expire:c,tag:l}=t||{};s=h,a=h===Pe,r=l?l.toString():p,u=c}o=h=>n(k(u)?u({method:e,mode:h}):u)}return{f:t,c:i,e:o,m:s,s:a,t:r}},U=(e,...t)=>new e(...t),Jt=(e,t=[])=>k(e)?e(...t):e,os=(e,t)=>k(e)?e:[S,jt].includes(e)?I:t,rs=(e=0)=>{let t=p;return n=>{t&&clearTimeout(t),t=dt(n,e)}},as=(e=S)=>{const t=[];let n=p,s=!1;const o=async()=>{for(s=!0;O(t)>0;){const i=Zn(t);i&&await i()}n&&n(),s=!1};return{addQueue:i=>U(J,(u,h)=>{ee(t,()=>Re(i(),u,l=>{e?u(p):h(l)})),s||o()}),onComplete:i=>{n=i}}},rt=(e,t,n=b,s,o)=>{const a=()=>{o&&s&&(e=t(e,s,o),e!==o[s]&&(o[s]=e))};if(n&&a(),Ft(e))for(const r in e)se(e,String)||rt(e[r],t,n,r,e);return!n&&a(),e},cs="$a.",ht=(e,t)=>cs+e+t,is=(e,t,n)=>{e=e.endsWith("/")?e.slice(0,-1):e,t!==""&&(t=t.match(/^(\/|https?:\/\/)/)?t:`/${t}`);const s=e+t,o=ie(ge(me(n),a=>n[a]!==p),a=>`${a}=${n[a]}`).join("&");return o?+s.includes("?")?`${s}&${o}`:`${s}?${o}`:s},Ut=e=>{if(fe(e))return ie(e,Ut);if(ye(e)&&e.constructor===_e){const t={};return ae(me(e),n=>{t[n]=Ut(e[n])}),t}return e};class qn extends Error{constructor(t,n,s){super(n+(s?`

For detailed: https://alova.js.org/error#${s}`:"")),this.name=`[alova${t?`/${t}`:""}]`}}const ke=(e="")=>(t,n,s)=>{if(!t)throw U(qn,e,n,s)},pt=()=>{const e={};return{eventMap:e,on(t,n){const s=e[t]=e[t]||[];return ee(s,n),()=>{e[t]=ge(s,o=>o!==n)}},off(t,n){const s=e[t];if(s)if(n){const o=s.indexOf(n);o>-1&&s.splice(o,1)}else delete e[t]},emit(t,n){const s=e[t]||[];return ie(s,o=>o(n))}}};class ze{constructor(t,n,s,o){this.s=t,this.k=n,this.$dhy=s,this.$exp=o}get v(){return this.$dhy(this.s)}get e(){return this.$exp(this.s)}}class pn extends ze{constructor(t,n,s,o,a){super(t,n,s,o),this.$upd=a}set v(t){this.$upd(this.s,t)}get v(){return super.v}}let mt={autoHitCache:"global",ssr:es};const et="color: black; font-size: 12px; font-weight: bolder";var ls=(e,t,n,s)=>{const o=console,a=(...d)=>console.log(...d),{url:r}=t,i=n===Pe,u="\x1B[42m%s\x1B[49m",h="\x1B[32m%s\x1B[39m",c=` [HitCache]${r} `,l=()=>Array(O(c)+1).join("^");mt.ssr?(a(u,c),a(h," Cache ",e),a(h," Mode  ",n),i&&a(h," Tag   ",s),a(h,l())):(o.groupCollapsed?o.groupCollapsed("%cHitCache","padding: 2px 6px; background: #c4fcd3; color: #53b56d;",r):a(u,c),a("%c[Cache]",et,e),a("%c[Mode]",et,n),i&&a("%c[Tag]",et,s),a("%c[Method]",et,t),o.groupEnd?o.groupEnd():a(h,l()))};const Lt=e=>`hss.${e}`,$n="hsr.",qt=e=>$n+e,at="$$hsrs",Kn="__$<>$__",$t=(e,t)=>{e[t]=0},We=async(e,t,n,s,o,a,r)=>{if(s>Te()&&n){const i=ht(e,t);if(await o.set(i,ge([n,s===1/0?p:s,r],Boolean)),a){const u={},h=[];ae(a,d=>{const f=se(d,zt),w=f?d.source+(d.flags?Kn+d.flags:""):d;w&&(f&&!u[w]&&ee(h,w),$t(u,f?qt(w):Lt(w)))});const c=ie(me(u),async d=>{const f=await o.get(d)||{};$t(f,i),await o.set(d,f)}),l=async()=>{if(O(h)){const d=await o.get(at)||[];ee(d,...h),await o.set(at,d)}};await J.all([...c,l()])}}},Kt=async(e,t,n)=>{const s=ht(e,t);await n.remove(s)},Nn=async(e,t,n,s)=>{const o=await n.get(ht(e,t));if(o){const[a,r,i]=o;if(i===s&&(!r||r>Te()))return o;await Kt(e,t,n)}},Be=async(e,t,n,s)=>{const o=await Nn(e,t,n,s);return o?o[0]:p},mn=async e=>J.all(e.map(t=>t.clear())),us=async(e,t,n)=>{const s=`${t}`,o={},a=Lt(e);o[a]=await n.get(a);let r;if(t){const c=Lt(s);o[c]=await n.get(c),r=await n.get(at);const l=[];r&&O(r)&&(ae(r,d=>{const[f,w]=d.split(Kn);U(zt,f,w).test(s)&&ee(l,d)}),await J.all(ie(l,async d=>{const f=qt(d);o[f]=await n.get(f)})))}const i=async c=>{try{await n.remove(c);for(const l in o){const d=o[l];d&&qe(d,c)}}catch{}},u={};await J.all(ie(me(o),async c=>{const l=o[c];if(l){const d=[];for(const f in l)u[f]||($t(u,f),ee(d,i(f)));await J.all(d)}}));const h=O(r||[]);await J.all(ie(me(o),async c=>{const l=o[c];l&&(O(me(l))?await n.set(c,l):(await n.remove(c),c.includes($n)&&r&&(r=ge(r,d=>qt(d)!==c))))})),h!==O(r||[])&&await n.set(at,r)};var ds=e=>{const{data:t,config:n}=e,s={...n},{headers:o={},params:a={}}=s,r=we(e);s.headers={...o},s.params={...a};const i=U(ue,e.type,r,e.url,s,t);return Ie(i,{...e,config:s})};const Nt=async(e,{policy:t="all"}={})=>{if(e&&e.key){const{id:n,l1Cache:s,l2Cache:o}=we(e),a=le(e),{f:r,c:i,s:u,e:h,t:c}=Xe(e);if(i)return r();let l=t!=="l2"?await Be(n,a,s):p;return t==="l2"?l=await Be(n,a,o,c):t==="all"&&!l&&u&&h(Pe)>Te()&&(l=await Be(n,a,o,c)),l}},Mt=async(e,t,{policy:n="all"}={})=>{const o=(fe(e)?e:[e]).map(async a=>{const{hitSource:r}=a,{id:i,l1Cache:u,l2Cache:h}=we(a),c=le(a),{e:l,s:d,t:f,c:w}=Xe(a);if(w)return;let x=t;if(k(t)){let T=n!=="l2"?await Be(i,c,u):p;if((n==="l2"||n==="all"&&!T&&d&&l(Pe)>Te())&&(T=await Be(i,c,h,f)),x=t(T),x===p)return}return J.all([n!=="l2"&&We(i,c,x,l(Qe),u,r),n==="l2"||n==="all"&&d?We(i,c,x,l(Pe),h,r,f):p])});return J.all(o)},fs=async e=>{if(!e){await J.all([mn(ct),mn(it)]);return}const n=(fe(e)?e:[e]).map(s=>{const{id:o,l1Cache:a,l2Cache:r}=we(s),{c:i,m:u}=Xe(s);if(i)return;const h=le(s);return J.all([Kt(o,h,a),u===Pe?Kt(o,h,r):ut()])});await J.all(n)},hs=async e=>{const{autoHitCache:t}=mt,{l1Cache:n,l2Cache:s}=we(e),o=le(e),{name:a}=$e(e),r={global:[...ct,...it],self:[n,s],close:[]}[t];r&&O(r)&&await J.all(ie(r,i=>us(o,a,i)))},gn={};function ps(e,t){let n=b,s;const o=U(J,r=>{s=r});return{abort:()=>{Re(o,r=>r&&r.abort())},onDownload:r=>{Re(o,i=>i&&i.onDownload&&i.onDownload(r))},onUpload:r=>{Re(o,i=>i&&i.onUpload&&i.onUpload(r))},response:async()=>{const{beforeRequest:r=I,responded:i,requestAdapter:u,cacheLogger:h}=ts(e),c=le(e),{s:l,t:d,m:f,e:w}=Xe(e),{id:x,l1Cache:T,l2Cache:C,snapshots:_}=we(e),{cacheFor:L}=$e(e),{hitSource:q}=e;let W=await(k(L)?L():t?p:Be(x,c,T));if(f===Pe&&!W&&!t){const V=await Nn(x,c,C,d);if(V){const[re,ce]=V;await We(x,c,re,ce,T,q),W=re}}const $=ds(e);await r($);const{baseURL:G,url:M,type:F,data:P}=$,{params:v={},headers:Q={},transform:D=Je,shareRequest:z}=$e($),K=gn[x]=gn[x]||{},H=$.data,E=Qt(H);let R=E?p:K[c],j=Je,N=p,te=I;if(k(i))j=i;else if(ye(i)){const{onSuccess:V,onError:re,onComplete:ce}=i;j=k(V)?V:j,N=k(re)?re:N,te=k(ce)?ce:te}if(W!==p)return s(),$.fromCache=b,os(h,ls)(W,$,f,d),te($),W;if(n=S,!z||!R){const V=u({url:is(G,M,v),type:F,data:P,headers:Q},$);R=K[c]=V}s(R);const oe=async(V,re,ce=b)=>{const Ce=await V,ve=await D(Ce,re||{});_.save(e);try{await hs($)}catch{}if((!H||!E)&&ce)try{await J.all([We(x,c,ve,w(Qe),T,q),l&&We(x,c,ve,w(Pe),C,q,d)])}catch{}return Ut(ve)};return Dn(Re(J.all([R.response(),R.headers()]),([V,re])=>(qe(K,c),oe(j(V,$),re)),V=>(qe(K,c),k(N)?oe(N(V,$),p,S):Vt(V))),()=>{te($)})},fromCache:()=>n}}const vn=(e,t)=>()=>{const n=t.indexOf(e);n>=0&&t.splice(n,1)};class ue{constructor(t,n,s,o,a){this.dhs=[],this.uhs=[],this.fromCache=p;const r=()=>{r.a()};r.a=I;const i=this,u=Fn(n);i.abort=r,i.baseURL=u.baseURL||"",i.url=s,i.type=t,i.context=n;const h={},c="cacheFor",l=ye(u[c])?u[c][t]:p,d=o&&o.hitSource;ae(["timeout","shareRequest"],f=>{u[f]!==p&&(h[f]=u[f])}),l!==p&&(h[c]=l),d&&(i.hitSource=ie(fe(d)?d:[d],f=>se(f,ue)?le(f):f),qe(o,"hitSource")),i.config={...h,headers:{},params:{},...o||{}},i.data=a,i.meta=o?o.meta:i.meta,i.key=i.generateKey()}onDownload(t){return ee(this.dhs,t),vn(t,this.dhs)}onUpload(t){return ee(this.uhs,t),vn(t,this.uhs)}send(t=S){const n=this,{response:s,onDownload:o,onUpload:a,abort:r,fromCache:i}=ps(n,t);return O(n.dhs)>0&&o((u,h)=>ae(n.dhs,c=>c({loaded:u,total:h}))),O(n.uhs)>0&&a((u,h)=>ae(n.uhs,c=>c({loaded:u,total:h}))),n.abort.a=r,n.fromCache=p,n.promise=Re(s(),u=>(n.fromCache=i(),u)),n.promise}setName(t){$e(this).name=t}generateKey(){return ns(this)}then(t,n){return Re(this.send(),t,n)}catch(t){return je(this.send(),t)}finally(t){return Dn(this.send(),t)}}const gt=ke(),be="success",ms=()=>{let e={};const t=pt();return{set(s,o){e[s]=o,t.emit(be,{type:"set",key:s,value:o,container:e})},get:s=>{const o=e[s];return t.emit(be,{type:"get",key:s,value:o,container:e}),o},remove(s){qe(e,s),t.emit(be,{type:"remove",key:s,container:e})},clear:()=>{e={},t.emit(be,{type:"clear",key:"",container:e})},emitter:t}},Ee=()=>(gt(typeof localStorage<"u","l2Cache is not defined."),localStorage),gs=()=>{const e=pt();return{set:(n,s)=>{Ee().setItem(n,Wt(s)),e.emit(be,{type:"set",key:n,value:s,container:Ee()})},get:n=>{const s=Ee().getItem(n),o=s&&Xn(s);return e.emit(be,{type:"get",key:n,value:o,container:Ee()}),o},remove:n=>{Ee().removeItem(n),e.emit(be,{type:"remove",key:n,container:Ee()})},clear:()=>{Ee().clear(),e.emit(be,{type:"clear",key:"",container:Ee()})},emitter:e}},Sn=Set;class vs{constructor(t){this.records={},this.occupy=0,gt(t>=0,"expected snapshots limit to be >= 0"),this.capacity=t}save(t){const{name:n}=$e(t),{records:s,occupy:o,capacity:a}=this;n&&o<a&&((s[n]=s[n]||U(Sn)).add(t),this.occupy+=1)}match(t,n=!0){let s,o,a,r=t;ye(t)&&(r=t.name,a=t.filter),se(r,zt)?o=r:Ye(r)&&(s=r);const{records:i}=this;let u=U(Sn);s?u=i[s]||u:o&&ae(ge(me(i),c=>o.test(c)),c=>{i[c].forEach(l=>u.add(l))});const h=k(a)?ge([...u],a):[...u];return n?h:h[0]}}const kn="GET",Ss="HEAD",ys="POST",ws="PUT",Cs="PATCH",Es="DELETE",Rs="OPTIONS",yn={cacheFor:{[kn]:3e5},shareRequest:b,snapshots:1e3};let bs=0;class xs{constructor(t){var n,s;const o=this;o.id=(t.id||(bs+=1)).toString(),o.l1Cache=t.l1Cache||ms(),o.l2Cache=t.l2Cache||gs(),o.options={...yn,...t},o.snapshots=U(vs,(s=(n=t.snapshots)!==null&&n!==void 0?n:yn.snapshots)!==null&&s!==void 0?s:0)}Get(t,n){return U(ue,kn,this,t,n)}Post(t,n,s){return U(ue,ys,this,t,s,n)}Delete(t,n,s){return U(ue,Es,this,t,s,n)}Put(t,n,s){return U(ue,ws,this,t,s,n)}Head(t,n){return U(ue,Ss,this,t,n)}Patch(t,n,s){return U(ue,Cs,this,t,s,n)}Options(t,n){return U(ue,Rs,this,t,n)}}let Ge=p;const ct=[],it=[],Ms=e=>{const t=U(xs,e),n=t.options.statesHook;Ge&&gt(Ge===n,"expected to use the same `statesHook`"),Ge=n;const{l1Cache:s,l2Cache:o}=t;return!ct.includes(s)&&ee(ct,s),!it.includes(o)&&ee(it,o),t},Ke=()=>(gt(!!Ge,"`statesHook` is not set in alova instance"),Ge);var Ps={name:"Vue",create:e=>Jn(e),dehydrate:e=>e.value,update:(e,t)=>{t.value=e},effectRequest({handler:e,removeStates:t,immediate:n,watchingStates:s}){bt()&&dn(t),n&&e(),ae(s||[],(o,a)=>{fn(o,()=>{e(a)},{deep:b})})},computed:e=>Qn(e),watch:(e,t)=>{fn(e,t,{deep:b})},onMounted:e=>{bt()?Yn(e):dt(e,10)},onUnmounted:e=>{bt()&&dn(e)}};const Ts=e=>Ye(e)||Qt(e);function Yt(){return(e,t)=>{const n=t.config,s=n.timeout||0,o=new AbortController,{data:a,headers:r}=e,i=/content-type/i.test(_e.keys(r).join()),u=a&&a.toString()==="[object FormData]";!i&&!u&&(r["Content-Type"]="application/json;charset=UTF-8");const h=fetch(e.url,{...n,method:e.type,signal:o.signal,body:Ts(a)?a:Wt(a)});let c,l=S;return s>0&&(c=dt(()=>{l=b,o.abort()},s)),{response:()=>h.then(d=>(At(c),d.clone()),d=>Vt(l?U(Error,"fetchError: network timeout"):d)),headers:()=>h.then(({headers:d})=>d,()=>({})),onDownload:async d=>{let f=S;const w=await h.catch(()=>{f=b});if(!w)return;const{headers:x,body:T}=w.clone(),C=T?T.getReader():p,_=Number(x.get("Content-Length")||x.get("content-length")||0);if(_<=0)return;let L=0;if(C){const q=()=>C.read().then(({done:W,value:$=new Uint8Array})=>{if(W||f)f&&d(_,0);else return L+=$.byteLength,d(_,L),q()});q()}},onUpload(){console.error("fetch API does'nt support uploading progress. please consider to change `@alova/adapter-xhr` or `@alova/adapter-axios`")},abort:()=>{o.abort(),At(c)}}}}const Pt={authRole:null},tt={authRole:"login"},_s={authRole:"logout"},nt={authRole:"refreshToken"},pe=({meta:e},t)=>{if(ye(e)){for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)){const s=t[n];if(se(s,RegExp)?s.test(e[n]):e[n]===s)return b}}return S},On=(e,t)=>U(J,n=>{ee(t,{method:e,resolve:n})}),wn=(e,t,n,s)=>{if(pe(e,(t==null?void 0:t.metaMatches)||n))return(k(t)?t:ye(t)&&k(t.handler)?t.handler:I)(s,e)},Cn=async(e,t,n,s,o,a)=>{const r=O(s)>=2;let i=o==null?void 0:o.isExpired(...s);if(se(i,J)&&(i=await i),i)try{let u=b;if(r&&a&&(u=S,await On(e,t)),u&&(n(b),await(o==null?void 0:o.handler(...s)),n(S),ae(t,({resolve:h})=>h())),r){const{config:h}=e,c=h.transform;h.transform=p;const l=await e;return h.transform=c,l}}finally{n(S),Le(t,0,O(t))}},As=e=>{let t=p,n=p,s=p;if(k(e))t=e;else if(ye(e)){const{onSuccess:o,onError:a,onComplete:r}=e;t=k(o)?o:t,n=k(a)?a:n,s=k(r)?r:s}return{onSuccess:t,onError:n,onComplete:s}},Ds=({visitorMeta:e,login:t,logout:n,refreshTokenOnSuccess:s,refreshTokenOnError:o,assignToken:a=I})=>{let r=S;const i=[];return{waitingList:i,onAuthRequired:c=>async l=>{const d=pe(l,e||Pt),f=pe(l,(t==null?void 0:t.metaMatches)||tt);return!d&&!f&&!pe(l,(s==null?void 0:s.metaMatches)||nt)&&!pe(l,(o==null?void 0:o.metaMatches)||nt)&&r&&await On(l,i),!d&&!f&&await a(l),c==null?void 0:c(l)},onResponseRefreshToken:c=>{const l=As(c);return{...l,onSuccess:async(d,f)=>{if(!pe(f,e||Pt)&&!pe(f,(t==null?void 0:t.metaMatches)||tt)&&!pe(f,(s==null?void 0:s.metaMatches)||nt)){const w=await Cn(f,i,x=>{r=x},[d,f],s,r);if(w)return w}return await wn(f,t,tt,d),await wn(f,n,_s,d),(l.onSuccess||Je)(d,f)},onError:async(d,f)=>{if(!pe(f,e||Pt)&&!pe(f,(t==null?void 0:t.metaMatches)||tt)&&!pe(f,(o==null?void 0:o.metaMatches)||nt)){const w=await Cn(f,i,x=>{r=x},[d,f],o,r);if(w)return w}return(l.onError||I)(d,f)}}}}},Fs=(e,t)=>{let n=jt;return function(...o){const a=e.bind(this,...o),r=de(t)?t:t(...o);n&&At(n),r>0?n=dt(a,r):a()}},Us=(e,t)=>{const n={};for(const s in e)n[s]=t(e[s],s,e);return n};var Se;(function(e){e[e.USE_REQUEST=1]="USE_REQUEST",e[e.USE_WATCHER=2]="USE_WATCHER",e[e.USE_FETCHER=3]="USE_FETCHER"})(Se||(Se={}));function Ve(e,t={trackedKeys:{},bindError:S}){const n=c=>e.ref?e.ref(c):{current:c};t=n(t).current;const s=c=>(e.export||Je)(c,t),o=c=>{if(!k(e.memorize))return c;const l=e.memorize(c);return l.memorized=!0,l},{dehydrate:a}=e,r=(c,l,d)=>c!==a(l,d,t)&&t.trackedKeys[d]&&e.update(c,l,d,t),i=c=>ie(c,l=>se(l,ze)?l.e:l),u=[],h={};return{create:(c,l)=>(ee(u,l),U(pn,e.create(c,l,t),l,d=>a(d,l,t),s,(d,f)=>r(f,d,l))),computed:(c,l,d)=>(ae(l,f=>{f.k&&(h[f.k]=!0)}),U(ze,e.computed(c,i(l),d,t),d,f=>a(f,d,t),s)),effectRequest:c=>e.effectRequest(c,t),ref:n,watch:(c,l)=>e.watch(i(c),l,t),onMounted:c=>e.onMounted(c,t),onUnmounted:c=>e.onUnmounted(c,t),memorize:o,__referingObj:t,exposeProvider:c=>{const l={},d={};for(const C in c){const _=c[C];if(k(_)&&!t.trackedKeys[C])l[C]=C.startsWith("on")?(...q)=>(_(...q),T):_.memorized?_:o(_);else{const q=se(_,ze);q&&(d[C]=_.s),_e.defineProperty(l,C,{get:()=>(t.trackedKeys[C]=b,q?_.e:_),set:I,enumerable:b,configurable:b})}}const{update:f,__proxyState:w}=l;t.trackedKeys={...h},t.bindError=S;const x={__referingObj:t,update:o(C=>{me(C).forEach(_=>{ot(u,_)?r(C[_],d[_],_):_ in l&&k(f)&&f({[_]:C[_]})})}),__proxyState:o(C=>ot(u,C)&&se(c[C],ze)?(t.trackedKeys[C]=b,c[C]):w(C))},T=Ie(l,x);return T},objectify:(c,l)=>c.reduce((d,f)=>(d[f.k]=l?f[l]:f,d),{}),transformState2Proxy:(c,l)=>U(pn,c,l,d=>a(d,l,t),s,(d,f)=>r(f,d,l))}}const Ls=ke("useRequest"),Hn=ke("useWatcher"),Bn=ke("useFetcher"),Vn=e=>({[Se.USE_REQUEST]:Ls,[Se.USE_WATCHER]:Hn,[Se.USE_FETCHER]:Bn})[e],zn=(e,t)=>e(se(t,ue),"expected a method instance."),kt="success",Ot="error",Ht="complete";var qs=(e,t,n,s)=>({m:p,sf:[],rf:[],fs:{},em:n,ht:e,c:t,ro:s,ms:{}});class Ne{constructor(t,n){this.method=t,this.args=n}clone(){return{...this}}static spawn(t,n){return new Ne(t,n)}}class $s extends Ne{constructor(t,n,s){super(t.method,t.args),this.data=n,this.fromCache=s}}class Ks extends Ne{constructor(t,n){super(t.method,t.args),this.error=n}}class En extends Ne{constructor(t,n,s,o,a){super(t.method,t.args),this.status=n,this.data=s,this.fromCache=n==="error"?!1:o,this.error=a}}const Ns=(e,t)=>t(),lt={},ks=(e,t)=>(lt[e]||{})[t]||{},Os=(e,t,n,s)=>{const o=lt[e]=lt[e]||{};o[t]={s:n,h:s}},Hs=(e,t)=>{const n=lt[e];n&&qe(n,t)};function Bt(e,t,n=[]){const s=Vn(e.ht);let o=Un(t,s,n);const{fs:a,ht:r,c:i,ms:u}=e,{loading:h,data:c,error:l}=a,d=r===Se.USE_FETCHER,{force:f=S,middleware:w=Ns}=i,x=we(o),{id:T}=x,C=le(o),{abortLast:_=b}=i,L=!e.m;return e.m=o,(async()=>{let q=I,W=I,$=S,G=ut(p),M=I,F=I;const P=await Nt(o);let v=()=>!!P,Q=S;d||(W=N=>Os(T,C,N,e),W({...a,...u}),q=()=>Hs(T,C));const D=N=>{$=b;const{force:te=f,method:oe=o}=N||{},V=Jt(te,[U(Ne,o,n)]),re=ve=>({loaded:Ae,total:De})=>{a[ve].v={loaded:Ae,total:De}};o=oe,ee(e.sf,W),ee(e.rf,q),Q||(h.v=!!V||!P);const{downloading:ce,uploading:Ce}=e.ro.trackedKeys;return M=ce?o.onDownload(re("downloading")):M,F=Ce?o.onUpload(re("uploading")):F,G=o.send(V),v=()=>o.fromCache||S,G},z={method:o,cachedResponse:P,config:i,abort:()=>o.abort()},K=()=>r!==Se.USE_WATCHER||!_||e.m===o,H=(N=b)=>{N&&L&&(h.v=S),Q=N},E=w(d?{...z,args:n,fetch:(N,...te)=>(zn(s,N),Bt(e,N,te)),proxyStates:ss(a,"data"),controlLoading:H}:{...z,args:n,send:(...N)=>Bt(e,t,N),proxyStates:a,controlLoading:H},D);let R=p;const j=Ne.spawn(o,n);try{const N=await E,te=oe=>{if(!d)K()&&(c.v=oe);else if(e.c.updateState!==S){const V=ks(T,C).s;V&&(V.data.v=oe)}return K()&&(l.v=p,!Q&&(h.v=S),e.em.emit(kt,U($s,j,oe,v())),e.em.emit(Ht,U(En,j,kt,oe,v(),p))),oe};R=N!==p?te(N):$?await Re(G,te,()=>te(p)):p,!$&&!Q&&(h.v=S)}catch(N){throw K()&&(l.v=N,!Q&&(h.v=S),e.em.emit(Ot,U(Ks,j,N)),e.em.emit(Ht,U(En,j,Ot,p,v(),N))),N}return M(),F(),R})()}const Rn=e=>e.current;function It(e,t,n,s,o=S,a,r=0){var i;n={...n};const{__referingObj:u={trackedKeys:{},bindError:S}}=n;let h=!!o,c=p;if(o)try{const E=Un(t,Vn(e)),R=we(E),j=R.l1Cache.get(ht(R.id,le(E)));if(j&&!se(j,J)){const[te,oe]=j;(!oe||oe>Te())&&(c=te)}h=!!Jt((i=n.force)!==null&&i!==void 0?i:S)||!c}catch{}const{create:l,effectRequest:d,ref:f,objectify:w,exposeProvider:x,transformState2Proxy:T}=Ve(Ke(),u),C={total:0,loaded:0},{managedStates:_={}}=n,L=Us(_,(E,R)=>T(E,R)),q=l(c??(k(s)?s():s),"data"),W=l(h,"loading"),$=l(p,"error"),G=l({...C},"downloading"),M=l({...C},"uploading"),F=w([q,W,$,G,M]),P=pt(),v=Rn(f(qs(e,n,P,u)));v.fs=F,v.em=P,v.c=n,v.ms=L;const Q=a!==p,D=(E=t,R)=>Bt(v,E,R),z=Rn(f(rs())),K=(E=u,R)=>{z(()=>{je(D(R),j=>{if(!E.bindError&&!E.trackedKeys.error)throw j})})},H=f(Fs((E,R,j)=>K(R,j),E=>de(E)?fe(r)?r[E]:r:0));return mt.ssr||d({handler:Q?E=>H.current(E,u,t):()=>K(u),removeStates:()=>ae(v.rf,E=>E()),saveStates:E=>ae(v.sf,R=>R(E)),frontStates:{...F,...L},watchingStates:a,immediate:o??b}),x({...w([q,W,$,G,M]),abort:()=>v.m&&v.m.abort(),send:(E,R)=>D(R,E),onSuccess(E){P.on(kt,E)},onError(E){u.bindError=b,P.on(Ot,E)},onComplete(E){P.on(Ht,E)}})}function Bs(e={}){const t=It(Se.USE_FETCHER,I,e),{send:n}=t;return qe(t,"send"),Ie(t,{fetch:(s,...o)=>(zn(Bn,s),n(o,s))})}function Xt(e,t={}){const{immediate:n=b,initialData:s}=t,o=It(Se.USE_REQUEST,e,t,s,!!n),{send:a}=o;return Ie(o,{send:(...r)=>a(r)})}function Vs(e,t,n={}){Hn(t&&O(t)>0,"expected at least one watching state");const{immediate:s,debounce:o=0,initialData:a}=n,r=It(Se.USE_WATCHER,e,n,a,!!s,t,o),{send:i}=r;return Ie(r,{send:(...u)=>i(u)})}var zs=e=>{let t={};return{snapshots:()=>t,save(n,s=S){const o=le(n);(!t[o]||s)&&(t[o]={entity:n})},get:n=>t[le(se(n,ue)?n:e(n))],remove(n){n?delete t[n]:t={}}}};const He=ke("usePagination"),bn=(e,t)=>He(de(e)&&e<O(t),"index must be a number that less than list length"),xn=e=>[e[e.length-2],e[e.length-1],e.slice(0,e.length-2)];var bo=(e,t={})=>{const{create:n,computed:s,ref:o,watch:a,exposeProvider:r,objectify:i,__referingObj:u}=Ve(Ke()),{preloadPreviousPage:h=b,preloadNextPage:c=b,total:l=m=>m.total,data:d=m=>m.data,append:f=S,initialPage:w=1,initialPageSize:x=10,watchingStates:T=[],initialData:C,immediate:_=b,middleware:L,force:q=I,...W}=t,$=o(e),G=o(S),M=n(w,"page"),F=n(x,"pageSize"),P=n(C?d(C)||[]:[],"data"),v=n(C?l(C):p,"total"),{snapshots:Q,get:D,save:z,remove:K}=o(zs(m=>$.current(m,F.v))).current,H=m=>d(m)||m,E=Bs({__referingObj:u,updateState:S,force:({args:m})=>m[O(m)-1]}),{loading:R,fetch:j,abort:N,onSuccess:te}=E,oe=o(R),V=(m=M.v,g=[])=>{const y=e(m,F.v,...g);return z(y),y};a(T,()=>{M.v=w,G.current=b});const re=o({}),ce=s(()=>{const m=v.v;return m!==p?Math.ceil(m/F.v):p},[F,v],"pageCount"),Ce=m=>(...g)=>re.current[m](...g),ve=Vs((...m)=>{const[g,,y]=xn(m);return V(g,y)},[...T,M.e,F.e],{__referingObj:u,immediate:_,initialData:C,managedStates:i([P,M,F,v],"s"),middleware(m,g){return L?L({...m,delegatingActions:{refresh:Ce("refresh"),insert:Ce("insert"),remove:Ce("remove"),replace:Ce("replace"),reload:Ce("reload"),getState:y=>({page:M,pageSize:F,data:P,pageCount:ce,total:v,isLastPage:St})[y].v}},g):g()},force:m=>m.args[1]||(k(q)?q(m):q),...W}),{send:Ae}=ve,De=ve.__proxyState("data"),en=async m=>{const{rawData:g=De.v,preloadPage:y,fetchMethod:A,forceRequest:B=S,isNextPage:Y=S}=m,X=ce.v,ne=X?y>X:Y?O(H(g))<F.v:S;if(!(y>0&&!ne))return S;const{e:Z}=Xe(A),he=await Nt(A);return Z(Qe)<=Te()?S:B||!he},tn=async(m,g,y=[])=>{const A=M.v+1,B=V(A,y);c&&await en({rawData:m,preloadPage:A,fetchMethod:B,isNextPage:b,forceRequest:g})&&je(j(B,...y,g),I)},Wn=async(m,g=[])=>{const y=M.v-1,A=V(y,g);h&&await en({rawData:m,preloadPage:y,fetchMethod:A})&&je(j(A,...g,p),I)},St=s(()=>{const m=De.v;if(!m)return b;const g=H(m),y=M.v,A=ce.v,B=fe(g)?O(g):0;return A?y>=A:B<F.v},[M,ce,De,F],"isLastPage"),yt=async()=>{const m=D(M.v);m&&await Mt(m.entity,g=>{if(g){const y=H(g)||[];return Le(y,0,O(y),...P.v),g}})};te(({method:m,data:g})=>{const y=D(M.v);if(y&&le(y.entity)===le(m)){const A=H(g);if(f){const B=P.v,Y=F.v,X=O(B)%Y;if(X>0){const ne=[...P.v];Le(ne,(M.v-1)*Y,X,...A),P.v=ne}}else P.v=A}});const wt=o(p),Ct=o(p);ve.onSuccess(({data:m,args:g,method:y})=>{const[A,B,Y]=xn(g),{total:X}=D(y)||{},ne=m;v.v=X!==p?X:l(ne),B||(Wn(ne,Y),tn(ne,S,Y));const Fe=F.v,Z=H(ne);if(He(fe(Z),"Got wrong array, did you return the correct array of list in `data` function"),f){if(G.current&&(P.v=[]),A===p)P.v=[...P.v,...Z];else if(A){const he=[...P.v];Le(he,(A-1)*Fe,Fe,...Z),P.v=he}}else P.v=Z}).onSuccess(({data:m})=>{var g;(g=wt.current)===null||g===void 0||g.call(wt,m)}).onError(({error:m})=>{var g;(g=Ct.current)===null||g===void 0||g.call(Ct,m)}).onComplete(()=>{G.current=S});const Ze=m=>{const g=P.v.indexOf(m);return He(g>=0,"item is not found in list"),g},{addQueue:Et,onComplete:nn}=o(as()).current,Rt=async(m=M.v)=>{let g=m,y=ut();if(f){if(!de(m)){const A=Ze(m);g=Math.floor(A/F.v)+1}He(g<=M.v,"refresh page can't greater than page"),y=Ae(g,b)}else He(de(g),"unable to calculate refresh page by item in pagination mode"),y=g===M.v?Ae(p,b):j(e(g,F.v),b);return y},sn=async(m=S)=>{const g=M.v,y=Q();let A=Dt(y);if(m)K();else{const B=ie(ge([D(g-1),D(g),D(g+1)],Boolean),({entity:Y})=>le(Y));A=ie(ge(me(y),Y=>!ot(B,Y)),Y=>{const X=y[Y];return delete y[Y],X})}await fs(ie(A,({entity:B})=>B))},on=async()=>{oe.current&&N(),await sn();const m=D(M.v+1);if(m){const g=H(await Nt(m.entity)||{})||[];tn(p,O(g)<F.v)}},rn=m=>{if(m===0)return;const g=v.v;if(de(g)){const y=Math.max(g+m,0);v.v=y;const A=M.v;ae([D(A-1),D(A),D(A+1)],B=>{B&&(B.total=y)})}},an=(m,g=0)=>(nn(on),Et(async()=>{const y=de(g)?g:Ze(g)+1;let A=p;const B=[...P.v];if(O(B)%F.v===0&&(A=B.pop()),Le(B,y,0,m),P.v=B,rn(1),await yt(),A){const Y=D(M.v+1);Y&&await Mt(Y.entity,X=>{if(X){const ne=H(X)||[];return ne.unshift(A),ne.pop(),X}})}})),cn=(...m)=>(nn(on),Et(async()=>{const g=ie(m,Z=>{const he=de(Z)?Z:Ze(Z);return bn(he,P.v),he}),y=M.v,A=y+1,B=D(A),Y=[];B&&await Mt(B.entity,Z=>{if(Z){const he=H(Z);return fe(he)&&ee(Y,...Le(he,0,O(g))),Z}});const X=St.v,ne=O(Y);let Fe=!1;if(ne>0||X){const Z=ge(P.v,(he,Gn)=>!ot(g,Gn));Fe=!f&&X&&O(Z)<=0,!Fe&&ne>0&&ee(Z,...Y),P.v=Z}else ne<=0&&!X&&Rt(y);return rn(-O(g)),yt().then(()=>{Fe&&(M.v=y-1)})})),ln=(m,g)=>Et(async()=>{He(g!==p,"expect specify the replace position");const y=de(g)?g:Ze(g);bn(y,P.v);const A=[...P.v];Le(A,y,1,m),P.v=A,await yt()}),un=async()=>{await sn(b),G.current=b,M.v===w?je(Ae(),I):M.v=w;const{resolve:m,reject:g,promise:y}=Ln();return wt.current=m,Ct.current=g,y};return re.current={refresh:Rt,insert:an,remove:cn,replace:ln,reload:un},r({...ve,...i([P,M,ce,F,v,St]),send:(...m)=>Ae(...m,p,p),fetching:E.loading,onFetchSuccess:E.onSuccess,onFetchError:E.onError,onFetchComplete:E.onComplete,refresh:Rt,insert:an,remove:cn,replace:ln,reload:un})},js={forward:e=>se(e,Date)?e.getTime():p,backward:e=>U(Date,e)},Ws={forward:e=>se(e,RegExp)?e.source:void 0,backward:e=>U(RegExp,e)};const Gs=(e={})=>{const t={date:js,regexp:Ws,...e};return{serialize:o=>(Ft(o)&&(o=rt(fe(o)?[...o]:{...o},a=>{let r=p;const i=me(t).reduce((h,c)=>{if(!r){const l=t[c].forward(h);l!==p&&(r=c,h=l)}return h},a);return _e.prototype.toString.call(a)==="[object Object]"?a={...a}:fe(a)&&(a=[...a]),r!==p?[r,i]:a})),o),deserialize:o=>Ft(o)?rt(o,a=>{if(fe(a)&&O(a)===2){const r=t[a[0]];a=r?r.backward(a[1]):a}return a},S):o}},xe=(e,t={})=>{let n=b;const{enableFocus:s=b,enableVisibility:o=b,enableNetwork:a=b,pollingTime:r=0,throttle:i=1e3}=t,{onMounted:u,onUnmounted:h,__referingObj:c}=Ve(Ke()),l=Xt(e,{...t,__referingObj:c}),d=()=>{n&&(l.send(),i>0&&(n=S,setTimeout(()=>{n=b},i)))};let f=I,w=I,x=I,T=I;return u(()=>{mt.ssr||(f=a?xe.onNetwork(d,t):f,w=s?xe.onFocus(d,t):w,x=o?xe.onVisibility(d,t):x,T=r>0?xe.onPolling(d,t):T)}),h(()=>{f(),w(),x(),T()}),l},Zt=(e,t)=>(window.addEventListener(e,t),()=>window.removeEventListener(e,t));xe.onNetwork=e=>Zt("online",e);xe.onFocus=e=>Zt("focus",e);xe.onVisibility=e=>Zt("visibilitychange",()=>document.visibilityState==="visible"&&e());xe.onPolling=(e,t)=>{const n=setInterval(e,t.pollingTime);return()=>clearInterval(n)};const jn="useCaptcha",Qs=ke(jn);var xo=(e,t={})=>{const{initialCountdown:n,middleware:s}=t;Qs(n===p||n>0,"initialCountdown must be greater than 0");const{create:o,ref:a,objectify:r,exposeProvider:i,__referingObj:u}=Ve(Ke()),h=o(0,"countdown"),c=Xt(e,{...t,__referingObj:u,immediate:S,managedStates:r([h],"s"),middleware:s?(f,w)=>s({...f,send:d},w):p}),l=a(p),d=(...f)=>U(J,(w,x)=>{h.v<=0?c.send(...f).then(T=>{h.v=t.initialCountdown||60,l.current=setInterval(()=>{h.v-=1,h.v<=0&&clearInterval(l.current)},1e3),w(T)}).catch(T=>x(T)):x(U(qn,jn,"the countdown is not over yet"))});return i({...c,send:d,...r([h])})};const Mn=Symbol("FormRestore"),Js=(e,t)=>`alova/form-${t||le(e)}`,Ys={},Pn=e=>{const t=n=>fe(n)?[...n]:ye(n)?{...n}:n;return rt(t(e),t)};var Mo=(e,t={})=>{const n=Ys,{id:s,initialForm:o,store:a,resetAfterSubmiting:r,immediate:i=S,middleware:u}=t;Ke();const{create:h,ref:c,onMounted:l,watch:d,objectify:f,exposeProvider:w,__referingObj:x}=Ve(Ke()),T=ye(a),C=T?a.enable:a,_=s?n[s]:p,L=h(Pn(o),"form"),q=e,W=pt(),$=c(Jt(q,[L.v])),G=we($.current).l2Cache,M=Js($.current,s),F=c(S),P=c(Gs(T?a.serializers:p)),v=c(!1),Q=Xt((...R)=>q(L.v,...R),{...t,__referingObj:x,middleware:u?(R,j)=>u({...R,delegatingActions:{updateForm:z,reset:D}},j):p,immediate:C||_?S:i}),D=()=>{F.current=b;const R=Pn(o);R&&(L.v=R),C&&G.remove(M)},z=R=>{L.v={...L.v,...R}},K=w({...Q,...f([L]),updateForm:z,reset:D,onRestore(R){W.on(Mn,R)}});s&&(_||(v.current=b),v.current&&(n[s]={hookProvider:K,config:t}));const{send:H,onSuccess:E}=K;return l(()=>{if(C&&!_){const R=P.current.deserialize(G.get(M));R&&(L.v=R,W.emit(Mn,p)),C&&i&&H()}}),d([L],()=>{if(F.current||!C){F.current=S;return}G.set(M,P.current.serialize(L.v))}),E(()=>{r&&D()}),_&&!v.current?_.hookProvider:K},Tn;(function(e){e[e.CONNECTING=0]="CONNECTING",e[e.OPEN=1]="OPEN",e[e.CLOSED=2]="CLOSED"})(Tn||(Tn={}));let Tt=0;const Me={},Is=e=>!!e.send,Xs=ke("subscriber"),Po=e=>{const{ref:t,onUnmounted:n}=Ve(Ke()),s=t(Tt+1);return s.current>Tt&&(Tt+=1),n(()=>{var o;!((o=Me[e])===null||o===void 0)&&o[s.current]&&delete Me[e][s.current]}),(o,a)=>{const{abort:r,proxyStates:i,delegatingActions:u={}}=o,h=d=>{for(const f in d)i[f]&&(i[f].v=d[f])},c=Me[e]=Me[e]||[],l=Is(o)?{...u,send:o.send,abort:r,update:h}:{...u,fetch:o.fetch,abort:r,update:h};return c[s.current]=l,a()}},To=(e,t,n=!1)=>{const s=[];typeof e=="symbol"||Ye(e)||de(e)?Me[e]&&ee(s,...Dt(Me[e])):se(e,RegExp)&&ae(ge(me(Me),o=>e.test(o)),o=>{ee(s,...Dt(Me[o]))}),s.length===0&&!n&&Xs(!1,`no handler can be matched by using \`${e.toString()}\``),ae(ge(s,Je),t)},Zs="BACKEND_ERROR",eo=(e,t)=>{const{tokenRefresher:n}=t,{onAuthRequired:s,onResponseRefreshToken:o}=Ds({refreshTokenOnSuccess:{isExpired:(r,i)=>(n==null?void 0:n.isExpired(r,i))||!1,handler:async(r,i)=>n==null?void 0:n.handler(r,i)},refreshTokenOnError:{isExpired:(r,i)=>(n==null?void 0:n.isExpired(r,i))||!1,handler:async(r,i)=>n==null?void 0:n.handler(r,i)}});return Ms({...e,timeout:e.timeout??10*1e3,requestAdapter:e.requestAdapter??Yt(),statesHook:Ps,beforeRequest:s(t.onRequest),responded:o({onSuccess:async(r,i)=>{var c;let u=null,h=null;try{await t.isBackendSuccess(r)?h=await t.transformBackendResponse(r):(u=new Error("the backend request error"),u.code=Zs)}catch(l){u=l}if(u)throw await((c=t.onError)==null?void 0:c.call(t,u,r,i)),u;return h},onComplete:t.onComplete,onError:(r,i)=>{var u;return(u=t.onError)==null?void 0:u.call(t,r,null,i)}})})},to="mock",no="#64bde8",so="#ccefff",oo="Realtime",ro="#999999",ao="#ededed",co=(e,t)=>`padding: 2px 6px; background: ${e}; color: ${t};`,Oe="color: black; font-size: 12px; font-weight: bolder",_t=e=>{const t={};for(const n in e)t[n]={value:e[n]};return t},io=({isMock:e,url:t,method:n,headers:s,query:o,data:a,responseHeaders:r,response:i})=>{const u=console;u.groupCollapsed(`%c${e?to:oo}`,co(e?so:ao,e?no:ro),t),u.log("%c[Method]",Oe,n.toUpperCase()),u.log("%c[Request Headers]",Oe),u.table(_t(s)),u.log("%c[Query String Parameters]",Oe),u.table(_t(o)),u.log("%c[Request Body]",Oe,a||""),e&&(Object.keys(r).length>0&&(u.log("%c[Response Headers]",Oe),u.table(_t(r))),u.log("%c[Response Body]",Oe,i||"")),u.groupEnd()},lo=({status:e=200,responseHeaders:t,statusText:n="ok",body:s})=>({response:new Response(Qt(s)?s:JSON.stringify(s),{status:e,statusText:n}),headers:new Headers(t)}),uo=e=>e,fo=e=>{e=/^[^/]*\/\//.test(e)?e:`//${e}`;const t=e.split("/").slice(3),n={};let s=t.pop(),o="",a="";return s&&(s=s.replace(/\?[^?#]+/,r=>(r.substring(1).split("&").forEach(i=>{const[u,h]=i.split("=");u&&(n[u]=h)}),"")),s=s.replace(/#[^#]*/,r=>(a=r,"")),t.push(s),o=`/${t.join("/")}`),{pathname:o,query:n,hash:a}};function ho({enable:e=b,delay:t=2e3,httpAdapter:n,mockRequestLogger:s=io,mock:o,onMockResponse:a=lo,onMockError:r=uo,matchMode:i="pathname"}={mock:{}}){return(u,h)=>{o=e&&o||{};const{url:c,data:l,type:d,headers:f}=u;let w=h.url,x=h.config.params||{};if(i==="pathname"){const v=fo(c);w=v.pathname,x=v.query}const T={},C=w.split("/"),_=Object.keys(o).filter(v=>{if(v.startsWith("-"))return S;let Q="GET";if(v=v.replace(/^\[(GET|POST|PUT|DELETE|PATCH|HEAD|OPTIONS|TRACE|CONNECT)\]/i,(z,K)=>(Q=K.toUpperCase(),"")),Q!==d.toUpperCase())return S;const D=v.split("/");if(D.length!==C.length)return S;for(let z=0;z<D.length;z+=1){const K=D[z],H=(K.match(/^\{(.*)\}$/)||["",""])[1];if(H)T[H]=C[z];else if(K!==C[z])return S}return b});let L=_.find(v=>!/\{.*\}/.test(v));L=L||_.shift();const q=L?o[L]:p;if(q===p){if(n)return k(s)&&s({isMock:S,url:c,method:d,params:T,headers:f,query:x,data:{},responseHeaders:{}}),n(u,h);throw new Error(`cannot find the httpAdapter.
[url]${c}`)}const W=Ln(),{resolve:$}=W;let{promise:G,reject:M}=W;const F=h.config.timeout||0;F>0&&setTimeout(()=>{M(new Error("request timeout"))},F);const P=setTimeout(()=>{try{const v=k(q)?q({query:x,params:T,data:Ye(l)||!l?{}:l,headers:f}):q;$(U(Promise,(Q,D)=>{M=D,ut(v).then(Q).catch(D)}))}catch(v){M(v)}},t);return G=G.then(v=>{let Q=200,D="ok",z={},K=p;return v===p?(Q=404,D="api not found"):v&&de(v.status)&&Ye(v.statusText)?(Q=v.status,D=v.statusText,z=v.responseHeaders||z,K=v.body):K=v,U(Promise,(H,E)=>{try{const R=a({status:Q,statusText:D,responseHeaders:z,body:K},{headers:f,query:x,params:T,data:l||{}},h);H(R)}catch(R){E(R)}}).then(H=>(k(s)&&s({isMock:b,url:c,method:d,params:T,headers:f,query:x,data:l||{},responseHeaders:z,response:K}),H))}).catch(v=>Vt(r(v,h))),{response:()=>G.then(({response:v})=>v&&Gt(v)==="[object Response]"?v.clone():v),headers:()=>G.then(({headers:v})=>v),abort:()=>{clearTimeout(P),M(new Error("The user abort request"))}}}}function po(e,t={enable:!0}){let n={};return e.filter(({enable:s})=>s).forEach(({data:s})=>{n={...s,...n}}),ho({...t,mock:n})}var mo=(e,t=!0)=>({enable:t,data:e});const go=mo({"[POST]/systemManage/addUser":()=>({code:"0000",msg:"success",data:null}),"[POST]/systemManage/updateUser":()=>({code:"0000",msg:"success",data:null}),"[DELETE]/systemManage/deleteUser":()=>({code:"0000",msg:"success",data:null}),"[DELETE]/systemManage/batchDeleteUser":()=>({code:"0000",msg:"success",data:null}),"[POST]/auth/sendCaptcha":()=>({code:"0000",msg:"success",data:null}),"[POST]/auth/verifyCaptcha":()=>({code:"0000",msg:"success",data:null}),"/mock/getLastTime":()=>({code:"0000",msg:"success",data:{time:new Date().toLocaleTimeString()}})});function vo(){const e=st.get("token");return e?`Bearer ${e}`:null}async function So(){const{resetStore:e}=An(),t=st.get("refreshToken")||"",n=Eo(t);n.meta.authRole="refreshToken";try{const s=await n;st.set("token",s.token),st.set("refreshToken",s.refreshToken)}catch(s){throw e(),s}}function _n(e,t){var s;(s=e.errMsgStack)!=null&&s.length||(e.errMsgStack=[]),e.errMsgStack.includes(t)||(e.errMsgStack.push(t),window.$message&&window.$message({type:"error",message:t,onClose:()=>{e.errMsgStack=e.errMsgStack.filter(o=>o!==t),setTimeout(()=>{e.errMsgStack=[]},5e3)}}))}const yo={VITE_OTHER_SERVICE_BASE_URL:`{
  "demo": "http://localhost:9529"
}`,VITE_SERVICE_BASE_URL:"http://47.103.169.121:3000"},wo=!1,{baseURL:Co}=In(yo,wo),Ue={errMsgStack:[]};po([go],{httpAdapter:Yt(),delay:1e3,enable:!0,matchMode:"methodurl"});const vt=eo({baseURL:Co,requestAdapter:Yt()},{onRequest({config:e}){const t=vo();e.headers.Authorization=t,e.headers.apifoxToken="XL299LiMEDZ0H5h3A29PxwQXdMJqWyY2"},tokenRefresher:{async isExpired(e){const t="9999,9998,3333".split(",")||[],{code:n}=await e.clone().json();return t.includes(String(n))},async handler(){await So()}},async isBackendSuccess(e){const n=await e.clone().json();return String(n.code)==="0000"},async transformBackendResponse(e){return(await e.clone().json()).data},async onError(e,t){var h;const n=An();let s=e.message,o="";if(t){const c=await(t==null?void 0:t.clone().json());s=c.msg,o=String(c.code)}function a(){_n(Ue,s),n.resetStore()}function r(){a(),window.removeEventListener("beforeunload",a),Ue.errMsgStack=Ue.errMsgStack.filter(c=>c!==s)}throw("8888,8889".split(",")||[]).includes(o)?(a(),e):("7777,7778".split(",")||[]).includes(o)&&!((h=Ue.errMsgStack)!=null&&h.includes(s))?(Ue.errMsgStack=[...Ue.errMsgStack||[],s],window.addEventListener("beforeunload",a),window.$messageBox&&window.$messageBox({type:"error",title:hn("common.error"),message:s,confirmButtonText:hn("common.confirm"),closeOnClickModal:!1,closeOnPressEscape:!1,callback(){r()}}),e):(_n(Ue,s),e)}});function _o(e){return vt.Post("/auth/sendCaptcha",{phone:e})}function Ao(e,t){return vt.Post("/auth/verifyCaptcha",{phone:e,code:t})}function Eo(e){return vt.Post("/auth/refreshToken",{refreshToken:e},{meta:{authRole:"refreshToken"}})}function Do(e,t){return vt.Get("/auth/error",{params:{code:e,msg:t},shareRequest:!1})}export{Po as a,Mo as b,vt as c,xe as d,To as e,Do as f,Vs as g,bo as h,_o as s,xo as u,Ao as v};
