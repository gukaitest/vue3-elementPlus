import{d as O,r as c,i as H,aN as z,b as _,o as n,J as v,F as U,z as $,e as T,aL as D,au as N,aj as S,h as w,c as y,w as k,f as E,aR as K,aS as X}from"./index-NHnUW4Mz.js";const M="/assets/001-Bg3uSwIK.jpg",V="/assets/002-CQfIn_Jg.jpg",P="/assets/003-BQJ3SB9i.jpg",F="/assets/004-D_CqIUBy.jpg",R="/assets/005-B44vLpON.jpg",A="/assets/006-XFl_NOhH.jpg",J="/assets/007-2OPtZVUF.jpg",Q="/assets/008-z0s8QBQE.jpg",q="/assets/009-6TAqM2n1.jpg",G="/assets/soybean-JC38yUrs.jpg",Z={class:"scroll-container"},W=["src","onLoad"],Y={key:0,class:"loading-indicator"},ee={key:0,class:"loading-more"},se={key:1,class:"no-more"},te=O({__name:"image-load-new",setup(B){let e=null;const i={totalImages:9,pageSize:3,pathTemplate:t=>new URL(Object.assign({"../../assets/imgs/001.jpg":M,"../../assets/imgs/002.jpg":V,"../../assets/imgs/003.jpg":P,"../../assets/imgs/004.jpg":F,"../../assets/imgs/005.jpg":R,"../../assets/imgs/006.jpg":A,"../../assets/imgs/007.jpg":J,"../../assets/imgs/008.jpg":Q,"../../assets/imgs/009.jpg":q,"../../assets/imgs/soybean.jpg":G})[`../../assets/imgs/${t}.jpg`],import.meta.url).href,observerOptions:{root:null,rootMargin:"0px 0px 200px 0px",threshold:.1}},d=c([]),l=c(1),g=c(!1),r=c(!0),u=c([]),p=c([]),j=t=>{if(!t)return;const a=t.$el??t;a instanceof HTMLElement&&(p.value.includes(a)||p.value.push(a))},s=Array.from({length:i.totalImages},(t,a)=>{const f=(a+1).toString().padStart(3,"0");return i.pathTemplate(f)}),o=t=>{console.log("Intersection Observer triggered,entries:",t),t.forEach(a=>{a.isIntersecting&&!g.value&&(C(),e==null||e.unobserve(a.target))})},m=()=>{e==null||e.disconnect(),N(()=>{e=new IntersectionObserver(o,i.observerOptions);const t=p.value.filter(f=>f.isConnected&&f.offsetParent!==null),a=t[t.length-1];a?(console.log("添加观察元素Observing element:",a),e.observe(a)):console.warn("No valid elements to observe")})},h=t=>{u.value[t]=!0},C=async()=>{if(g.value||!r.value)return;g.value=!0;const t=(l.value-1)*i.pageSize,a=t+i.pageSize;d.value=[...d.value,...s.slice(t,a)],u.value=[...u.value,...Array.from({length:Math.min(i.pageSize,s.length-t)})],r.value=a<s.length,l.value+=1,g.value=!1,N(()=>m())};return H(async()=>{await C()}),z(()=>{e==null||e.disconnect(),e=null}),(t,a)=>(n(),_("div",Z,[(n(!0),_(U,null,$(d.value,(f,I)=>(n(),_("div",{key:I,ref_for:!0,ref:L=>j(L),class:"image-item"},[T("img",{src:f,alt:"Gallery Image",class:D({loaded:u.value[I]}),onLoad:L=>h(I)},null,42,W),u.value[I]?v("",!0):(n(),_("div",Y,a[0]||(a[0]=[T("div",{class:"loader"},null,-1)])))]))),128)),g.value?(n(),_("div",ee,"加载中...")):v("",!0),r.value?v("",!0):(n(),_("div",se,"已加载全部内容"))]))}}),ae=S(te,[["__scopeId","data-v-ce190717"]]),oe=["src"],ne={key:0,class:"loading"},le={key:1,class:"no-more"},re=9,x=3,ce=O({name:"ImageLoadOld",__name:"image-load-old",setup(B){const e=Array.from({length:re},(s,o)=>{const m=(o+1).toString().padStart(3,"0");return new URL(Object.assign({"../../assets/imgs/001.jpg":M,"../../assets/imgs/002.jpg":V,"../../assets/imgs/003.jpg":P,"../../assets/imgs/004.jpg":F,"../../assets/imgs/005.jpg":R,"../../assets/imgs/006.jpg":A,"../../assets/imgs/007.jpg":J,"../../assets/imgs/008.jpg":Q,"../../assets/imgs/009.jpg":q,"../../assets/imgs/soybean.jpg":G})[`../../assets/imgs/${m}.jpg`],import.meta.url).href}),i=c([]),d=c(1),l=c(!1),g=c(!0),r=c(null),u=async()=>{if(l.value||!g.value)return;l.value=!0;const s=(d.value-1)*x,o=s+x;i.value.push(...e.slice(s,o)),g.value=o<e.length,d.value+=1,l.value=!1},p=(s,o=100)=>(console.log("isNearBottom:el.scrollTop, el.clientHeight, el.scrollHeight, threshold",s.scrollTop+s.clientHeight>=s.scrollHeight-o,s.scrollTop,s.clientHeight,s.scrollHeight,o),s.scrollTop+s.clientHeight>=s.scrollHeight-o),b=((s,o)=>{let m;return(...h)=>{clearTimeout(m),m=setTimeout(()=>s(...h),o)}})(()=>{r.value&&p(r.value)&&u()},300);return H(async()=>{await u()}),z(()=>{r.value&&r.value.removeEventListener("scroll",b)}),(s,o)=>(n(),_("div",{ref_key:"scrollContainer",ref:r,class:"scroll-container",onScroll:o[0]||(o[0]=(...m)=>w(b)&&w(b)(...m))},[(n(!0),_(U,null,$(i.value,(m,h)=>(n(),_("div",{key:h,class:"image-item"},[T("img",{src:m,alt:"图片"},null,8,oe)]))),128)),l.value?(n(),_("div",ne,"加载中...")):v("",!0),g.value?v("",!0):(n(),_("div",le,"没有更多了~"))],544))}}),ie=S(ce,[["__scopeId","data-v-3343a20c"]]),ge=O({name:"personal-content_image-loading-optimization",__name:"index",setup(B){const e=c("first"),i=(d,l)=>{console.log(d,l)};return(d,l)=>{const g=ie,r=K,u=ae,p=X;return n(),y(p,{modelValue:e.value,"onUpdate:modelValue":l[0]||(l[0]=j=>e.value=j),class:"demo-tabs",onTabClick:i},{default:k(()=>[E(r,{label:"传统实现方式",name:"first"},{default:k(()=>[e.value==="first"?(n(),y(g,{key:0})):v("",!0)]),_:1}),E(r,{label:"IntersectionObserver实现方式",name:"second"},{default:k(()=>[e.value==="second"?(n(),y(u,{key:0})):v("",!0)]),_:1})]),_:1},8,["modelValue"])}}}),ue=S(ge,[["__scopeId","data-v-ca423d0c"]]);export{ue as default};
