import{aU as A,d as M,r as p,aH as z,aV as N,i as H,b as k,o as g,f as c,J as v,h as L,aW as P,aX as V,aI as n,e as D,w as f,g as x,E as B,aY as R,aZ as I,aj as j,c as K,aR as q,aS as W}from"./index-C-okMWSa.js";function G(C){return A({url:"/monitor/webvitals/stats",method:"get",params:C})}function U(C){return A({url:"/monitor/errors",method:"get",params:C})}function J(C){return A({url:"/monitor/behaviors",method:"get",params:C})}const X={style:{width:"100%"}},Y={key:0,class:"loading-container"},Z={key:1,class:"no-more-data"},Q=M({__name:"behavior",setup(C){const y=p(null),s=p(!1),h=p(!0),i=p([]),r=z({pageNo:0,pageSize:50,total:51}),_=[{key:"behaviorId",dataKey:"behaviorId",title:"行为ID",width:200},{key:"type",dataKey:"type",title:"行为类型",width:150},{key:"level",dataKey:"level",title:"级别",width:120,cellRenderer:({rowData:o})=>{const l=o.level;if(!l)return n("span","");const u={high:{color:"#F56C6C",bgColor:"#FEF0F0",text:"高"},medium:{color:"#E6A23C",bgColor:"#FDF6EC",text:"中"},low:{color:"#67C23A",bgColor:"#F0F9FF",text:"低"}}[l]||{color:"#909399",bgColor:"#F4F4F5",text:l};return n("span",{style:{color:u.color,backgroundColor:u.bgColor,padding:"4px 8px",borderRadius:"4px",fontSize:"12px",fontWeight:"500",display:"inline-block",minWidth:"50px",textAlign:"center"}},u.text)}},{key:"sessionId",dataKey:"sessionId",title:"会话ID",width:250},{key:"userId",dataKey:"userId",title:"用户ID",width:150,cellRenderer:({rowData:o})=>{const l=o.userId;return n("span",l||"未登录")}},{key:"pageLoadTime",dataKey:"pageLoadTime",title:"页面加载时间",width:150,cellRenderer:({rowData:o})=>{const l=o.pageLoadTime;return n("span",l?`${l} ms`:"")}},{key:"timestamp",dataKey:"timestamp",title:"时间戳",width:180,cellRenderer:({rowData:o})=>{const l=o.timestamp;if(!l)return n("span","");const m=new Date(l);return n("span",m.toLocaleString("zh-CN"))}},{key:"url",dataKey:"url",title:"URL",width:300},{key:"userAgent",dataKey:"userAgent",title:"用户代理",width:300},{key:"customData",dataKey:"customData",title:"自定义数据",width:200,cellRenderer:({rowData:o})=>{const l=o.customData;return!l||Object.keys(l).length===0?n("span","-"):n("span",JSON.stringify(l))}}],b=async()=>{console.log("加载用户行为数据"),s.value=!0,await J({pageNo:r.pageNo,pageSize:r.pageSize}).then(o=>{var l;console.log("res",o),i.value=[...i.value,...((l=o==null?void 0:o.data)==null?void 0:l.list)||[]]}).finally(()=>{s.value=!1})},F=async()=>{r.pageNo+=1,b()},w=N(()=>{const o=document.querySelector(".el-table-v2__body div");s.value||!h.value||(console.log("element.scrollHeight,element.scrollTop,element.clientHeight,阈值:",o.scrollHeight,o.scrollTop,o.clientHeight,0),o.scrollHeight<=o.scrollTop+o.clientHeight+0&&r.total>r.pageNo*r.pageSize&&F())},300);return H(()=>{}),(o,l)=>{const m=P,u=V;return g(),k("div",X,[c(m,{ref_key:"tableRef",ref:y,columns:_,data:i.value,width:1e3,height:400,fixed:"",onScroll:L(w)},null,8,["data","onScroll"]),s.value?(g(),k("div",Y,[c(u,{animated:"",row:"1","column-width":[200]})])):v("",!0),!s.value&&h.value===!1?(g(),k("div",Z,"没有更多数据了")):v("",!0)])}}}),ee={style:{width:"100%"}},te={class:"error-test-buttons mb-4"},oe={class:"grid grid-cols-2 gap-3 lg:grid-cols-7 md:grid-cols-4"},ae={key:0,class:"loading-container"},le={key:1,class:"no-more-data"},ne=M({__name:"error-monitor",setup(C){const y=p(null),s=p(!1),h=p(!0),i=p([]),r=z({pageNo:0,pageSize:50,total:51}),_=[{key:"_id",dataKey:"_id",title:"错误ID",width:150},{key:"type",dataKey:"type",title:"错误类型",width:120,cellRenderer:({rowData:e})=>{const a={javascript:{color:"#E6A23C",bgColor:"#FDF6EC",text:"JS错误"},vue:{color:"#409EFF",bgColor:"#ECF5FF",text:"Vue错误"},promise:{color:"#9C27B0",bgColor:"#F3E5F5",text:"Promise错误"},resource:{color:"#FF9800",bgColor:"#FFF3E0",text:"资源错误"},ajax:{color:"#F56C6C",bgColor:"#FEF0F0",text:"请求错误"},custom:{color:"#909399",bgColor:"#F4F4F5",text:"自定义错误"}}[e.type]||{color:"#909399",bgColor:"#F4F4F5",text:e.type};return n("span",{style:{color:a.color,backgroundColor:a.bgColor,padding:"4px 8px",borderRadius:"4px",fontSize:"12px",fontWeight:"500",display:"inline-block"}},a.text)}},{key:"level",dataKey:"level",title:"错误级别",width:100,cellRenderer:({rowData:e})=>{const a={low:{color:"#67C23A",bgColor:"#F0F9FF",text:"低"},medium:{color:"#E6A23C",bgColor:"#FDF6EC",text:"中"},high:{color:"#F56C6C",bgColor:"#FEF0F0",text:"高"},critical:{color:"#F56C6C",bgColor:"#FEF0F0",text:"严重"}}[e.level||"medium"]||{color:"#909399",bgColor:"#F4F4F5",text:e.level||"未知"};return n("span",{style:{color:a.color,backgroundColor:a.bgColor,padding:"4px 8px",borderRadius:"4px",fontSize:"12px",fontWeight:"500",display:"inline-block"}},a.text)}},{key:"message",dataKey:"message",title:"错误消息",width:200},{key:"url",dataKey:"url",title:"页面URL",width:200},{key:"timestamp",dataKey:"timestamp",title:"时间戳",width:150,cellRenderer:({rowData:e})=>n("span",new Date(e.timestamp).toLocaleString())},{key:"filename",dataKey:"filename",title:"文件名",width:150},{key:"lineno",dataKey:"lineno",title:"行号",width:80},{key:"colno",dataKey:"colno",title:"列号",width:80},{key:"userId",dataKey:"userId",title:"用户ID",width:120},{key:"sessionId",dataKey:"sessionId",title:"会话ID",width:150},{key:"componentName",dataKey:"componentName",title:"组件名称",width:120},{key:"route",dataKey:"route",title:"路由路径",width:150},{key:"resourceType",dataKey:"resourceType",title:"资源类型",width:100},{key:"resourceUrl",dataKey:"resourceUrl",title:"资源URL",width:200},{key:"requestUrl",dataKey:"requestUrl",title:"请求URL",width:200},{key:"requestMethod",dataKey:"requestMethod",title:"请求方法",width:100,cellRenderer:({rowData:e})=>{if(!e.requestMethod)return n("span","-");const a={GET:"#67C23A",POST:"#409EFF",PUT:"#E6A23C",DELETE:"#F56C6C",PATCH:"#9C27B0"}[e.requestMethod.toUpperCase()]||"#909399";return n("span",{style:{color:"#fff",backgroundColor:a,padding:"2px 6px",borderRadius:"3px",fontSize:"11px",fontWeight:"500",display:"inline-block"}},e.requestMethod.toUpperCase())}},{key:"responseStatus",dataKey:"responseStatus",title:"响应状态",width:100,cellRenderer:({rowData:e})=>{if(!e.responseStatus)return n("span","-");const t=e.responseStatus;let a="#909399";return t>=200&&t<300?a="#67C23A":t>=300&&t<400?a="#E6A23C":(t>=400&&t<500||t>=500)&&(a="#F56C6C"),n("span",{style:{color:"#fff",backgroundColor:a,padding:"2px 6px",borderRadius:"3px",fontSize:"11px",fontWeight:"500",display:"inline-block"}},t.toString())}},{key:"userAgent",dataKey:"userAgent",title:"用户代理",width:200,cellRenderer:({rowData:e})=>{if(!e.userAgent)return n("span","-");const t=e.userAgent;let a="Unknown";return t.includes("Chrome")?a="Chrome":t.includes("Firefox")?a="Firefox":t.includes("Safari")&&!t.includes("Chrome")?a="Safari":t.includes("Edge")?a="Edge":t.includes("Opera")&&(a="Opera"),n("span",{title:t},a)}},{key:"stack",dataKey:"stack",title:"错误堆栈",width:300,cellRenderer:({rowData:e})=>{if(!e.stack)return n("span","-");const t=e.stack.split(`
`)[0];return n("span",{style:{cursor:"pointer",color:"#409EFF",textDecoration:"underline"},title:e.stack},t.length>50?`${t.substring(0,50)}...`:t)}},{key:"customData",dataKey:"customData",title:"自定义数据",width:150,cellRenderer:({rowData:e})=>e.customData?n("span",{style:{cursor:"pointer",color:"#409EFF"},title:JSON.stringify(e.customData,null,2)},"查看详情"):n("span","-")},{key:"created_at",dataKey:"created_at",title:"创建时间",width:150,cellRenderer:({rowData:e})=>e.created_at?n("span",new Date(e.created_at).toLocaleString()):n("span","-")},{key:"errorId",dataKey:"errorId",title:"错误标识",width:120}],b=async()=>{console.log("2222222222222"),s.value=!0,await U({pageNo:r.pageNo,pageSize:r.pageSize}).then(e=>{var t;console.log("res",e),i.value=[...i.value,...((t=e==null?void 0:e.data)==null?void 0:t.list)||[]]}).finally(()=>{s.value=!1})},F=async()=>{r.pageNo+=1,b()},w=N(()=>{const e=document.querySelector(".el-table-v2__body div");s.value||!h.value||(console.log("element.scrollHeight,element.scrollTop,element.clientHeight,阈值:",e.scrollHeight,e.scrollTop,e.clientHeight,0),e.scrollHeight<=e.scrollTop+e.clientHeight+0&&r.total>r.pageNo*r.pageSize&&F())},300),o=()=>{undefinedVariable.someMethod()},l=()=>{const e=p({nested:{value:1}});e.value.nested.undefinedProperty.trigger="error"},m=()=>{Promise.reject(new Error("这是一个测试的Promise错误"))},u=()=>{const e=new Image;e.src="https://testtesttesterror.com/test-image.jpg",e.onerror=()=>{console.log("图片加载失败，资源错误已触发")},document.body.appendChild(e),console.log("图片加载失败，资源错误已触发")},E=async()=>{const e=[()=>fetch("/api/nonexistent-endpoint",{method:"GET"}),()=>U({pageNo:-1,pageSize:"invalid",invalidParam:"test"}),()=>fetch("/api/timeout-test",{method:"GET",signal:AbortSignal.timeout(100)}),()=>fetch("/api/server-error",{method:"GET"}),()=>fetch("/monitor/errors",{method:"INVALID_METHOD",headers:{"Content-Type":"application/json"}})],t=e[Math.floor(Math.random()*e.length)];try{await t()}catch(a){console.log("请求错误已触发111:",a);const d=a;R(`HTTP请求错误: ${d.message||"未知错误"}`,{errorType:"ajax",url:window.location.href,timestamp:Date.now(),userAgent:navigator.userAgent,errorDetails:{name:d.name,message:d.message,stack:d.stack}},I.HIGH)}},T=()=>{R("这是一个测试的自定义错误",{testData:"custom error data",timestamp:Date.now(),source:"error-monitor-component"},I.MEDIUM)},O=async()=>{const e=[async()=>{await(await fetch("/api/invalid-json")).json()},async()=>{await fetch("https://cors-test.example.com/api/data",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({test:"data"})})},async()=>{const a=new AbortController,d=fetch("/api/slow-endpoint",{signal:a.signal});setTimeout(()=>a.abort(),10),await d}],t=e[Math.floor(Math.random()*e.length)];try{await t()}catch(a){console.log("高级请求错误已触发:",a);const d=a;R(`高级HTTP请求错误: ${d.name} - ${d.message}`,{errorType:"ajax",errorCategory:"advanced",url:window.location.href,timestamp:Date.now(),userAgent:navigator.userAgent,errorDetails:{name:d.name,message:d.message,stack:d.stack,cause:d.cause}},I.CRITICAL)}};return H(()=>{}),(e,t)=>{const a=B,d=P,$=V;return g(),k("div",ee,[D("div",te,[t[7]||(t[7]=D("h4",{class:"mb-3 text-lg font-semibold"},"错误测试",-1)),D("div",oe,[c(a,{type:"danger",size:"small",onClick:o},{default:f(()=>t[0]||(t[0]=[x("生成JS错误")])),_:1}),c(a,{type:"warning",size:"small",onClick:l},{default:f(()=>t[1]||(t[1]=[x("生成Vue错误")])),_:1}),c(a,{type:"info",size:"small",onClick:m},{default:f(()=>t[2]||(t[2]=[x("生成Promise错误")])),_:1}),c(a,{type:"primary",size:"small",onClick:u},{default:f(()=>t[3]||(t[3]=[x("生成资源错误")])),_:1}),c(a,{type:"success",size:"small",onClick:E},{default:f(()=>t[4]||(t[4]=[x("生成请求错误")])),_:1}),c(a,{type:"danger",size:"small",onClick:O},{default:f(()=>t[5]||(t[5]=[x("生成高级请求错误")])),_:1}),c(a,{type:"default",size:"small",onClick:T},{default:f(()=>t[6]||(t[6]=[x("生成自定义错误")])),_:1})])]),c(d,{ref_key:"tableRef",ref:y,columns:_,data:i.value,width:2e3,height:400,fixed:"",onScroll:L(w)},null,8,["data","onScroll"]),s.value?(g(),k("div",ae,[c($,{animated:"",row:"1","column-width":[200]})])):v("",!0),!s.value&&h.value===!1?(g(),k("div",le,"没有更多数据了")):v("",!0)])}}}),re=j(ne,[["__scopeId","data-v-a0760b3a"]]),se={style:{width:"100%"}},ie={key:0,class:"loading-container"},ce={key:1,class:"no-more-data"},de=M({__name:"performance-optimization",setup(C){const y=p(null),s=p(!1),h=p(!0),i=p([]),r=z({pageNo:0,pageSize:50,total:51}),_=[{key:"_id",dataKey:"_id",title:"性能指标id",width:150},{key:"name",dataKey:"name",title:"性能指标名称",width:150},{key:"value",dataKey:"value",title:"性能指标值",width:150,cellRenderer:({rowData:o})=>{const l=o.value,m=o.name;if(console.log("value",l),!l||!m)return n("span",l||"0");const E={FCP:"ms","First Contentful Paint":"ms",LCP:"ms","Largest Contentful Paint":"ms",FID:"ms","First Input Delay":"ms",TTFB:"ms","Time to First Byte":"ms",FMP:"ms","First Meaningful Paint":"ms","Speed Index":"ms",CLS:"","Cumulative Layout Shift":"",INP:"ms",Memory:"MB","Memory Usage":"MB",MemoryLeak:"%",LongTask:"ms",FPS:"fps"}[m]||"",T=E?`${l} ${E}`:l;return console.log("displayValue",T),n("span",T)}},{key:"rating",dataKey:"rating",title:"性能指标评级",width:150,cellRenderer:({rowData:o})=>{const l=o.rating;if(!l)return n("span",l||"");const u={good:{color:"#67C23A",bgColor:"#F0F9FF",text:"良好"},"needs-improvement":{color:"#E6A23C",bgColor:"#FDF6EC",text:"需改进"},poor:{color:"#F56C6C",bgColor:"#FEF0F0",text:"较差"}}[l]||{color:"#909399",bgColor:"#F4F4F5",text:l};return n("span",{style:{color:u.color,backgroundColor:u.bgColor,padding:"4px 8px",borderRadius:"4px",fontSize:"12px",fontWeight:"500",display:"inline-block",minWidth:"60px",textAlign:"center"}},u.text)}},{key:"delta",dataKey:"delta",title:"性能指标增量",width:150},{key:"navigationType",dataKey:"navigationType",title:"导航类型",width:150},{key:"timestamp",dataKey:"timestamp",title:"时间戳",width:150},{key:"url",dataKey:"url",title:"URL",width:150},{key:"userAgent",dataKey:"userAgent",title:"用户代理",width:150},{key:"taskType",dataKey:"taskType",title:"任务类型",width:150},{key:"leakType",dataKey:"leakType",title:"泄漏类型",width:150},{key:"created_at",dataKey:"created_at",title:"创建时间",width:150},{key:"__v",dataKey:"__v",title:"版本号",width:150}],b=async()=>{console.log("2222222222222"),s.value=!0,await G({pageNo:r.pageNo,pageSize:r.pageSize}).then(o=>{var l;console.log("res",o),i.value=[...i.value,...((l=o==null?void 0:o.data)==null?void 0:l.list)||[]]}).finally(()=>{s.value=!1})},F=async()=>{r.pageNo+=1,b()},w=N(()=>{const o=document.querySelector(".el-table-v2__body div");s.value||!h.value||(console.log("element.scrollHeight,element.scrollTop,element.clientHeight,阈值:",o.scrollHeight,o.scrollTop,o.clientHeight,0),o.scrollHeight<=o.scrollTop+o.clientHeight+0&&r.total>r.pageNo*r.pageSize&&F())},300);return H(()=>{}),(o,l)=>{const m=P,u=V;return g(),k("div",se,[c(m,{ref_key:"tableRef",ref:y,columns:_,data:i.value,width:1e3,height:400,fixed:"",onScroll:L(w)},null,8,["data","onScroll"]),s.value?(g(),k("div",ie,[c(u,{animated:"",row:"1","column-width":[200]})])):v("",!0),!s.value&&h.value===!1?(g(),k("div",ce,"没有更多数据了")):v("",!0)])}}}),ue=M({name:"personal-content_frontendmonitoring",__name:"index",setup(C){const y=p("first"),s=(h,i)=>{console.log(h,i)};return(h,i)=>{const r=de,_=q,b=re,F=Q,S=W;return g(),K(S,{modelValue:y.value,"onUpdate:modelValue":i[0]||(i[0]=w=>y.value=w),class:"demo-tabs",onTabClick:s},{default:f(()=>[c(_,{label:"前端性能监控",name:"first"},{default:f(()=>[y.value==="first"?(g(),K(r,{key:0})):v("",!0)]),_:1}),c(_,{label:"前端错误监控",name:"second"},{default:f(()=>[y.value==="second"?(g(),K(b,{key:0})):v("",!0)]),_:1}),c(_,{label:"前端用户行为监控",name:"third"},{default:f(()=>[y.value==="third"?(g(),K(F,{key:0})):v("",!0)]),_:1})]),_:1},8,["modelValue"])}}}),ge=j(ue,[["__scopeId","data-v-63ea29a6"]]);export{ge as default};
