import{_ as ie}from"./table-header-operation.vue_vue_type_script_setup_true_lang-B5VL-Vmb.js";import{u as Y,e as ee,a as ce,b as fe}from"./business-Cz9mbydA.js";import{$ as l,t as J,j as ge}from"./index-BBz38mVY.js";import{f as _e,e as be}from"./system-manage-2LvFOrFi.js";import{u as ve,a as he}from"./table-CmcEG2W6.js";import{u as ae,a as le}from"./form-DM51Q6bB.js";import{r as K,av as q,aw as oe,s as ne,R as Z,a5 as Ee,K as V,v as c,P as o,J as a,i as te,be as se,D as e,aA as re,br as Ve,t as G,F as U,al as D,bs as ye,aU as ue,aV as de,bf as me,E as A,an as $,ao as I,aZ as Ne,bt as ke,bu as we,bv as Re,bw as Ce,g as pe,aE as W,y as j,A as Se,f as Ge,bz as Pe,O as Q,bA as xe,z as Ue,bB as De,bj as X,by as Oe,bC as Te}from"./vue-vendor-DLKW-W3j.js";import{_ as Be,a as ze}from"./round-refresh-B3482ack.js";const Fe=K({name:"UserOperateDrawer",__name:"user-operate-drawer",props:q({operateType:{},rowData:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:q(["submitted"],["update:visible"]),setup(y,{emit:O}){const g=y,P=O,h=oe(y,"visible"),{formRef:x,validate:m,restoreValidation:k}=ae(),{defaultRequiredRule:w}=le(),T=ne(()=>({add:l("page.manage.user.addUser"),edit:l("page.manage.user.editUser")})[g.operateType]),s=Z(i());function i(){return{userName:"",userGender:void 0,nickName:"",userPhone:"",userEmail:"",userRoles:[],status:void 0}}const R={userName:w,status:w},_=Z([]);async function b(){const{error:v,data:u}=await _e();if(!v){const E=u.map(t=>({label:t.roleName,value:t.roleCode})),n=s.value.userRoles.map(t=>({label:t,value:t}));_.value=[...n,...E]}}function C(){s.value=i(),g.operateType==="edit"&&g.rowData&&Object.assign(s.value,g.rowData)}function S(){h.value=!1}async function B(){var v;await m(),(v=window.$message)==null||v.success(l("common.updateSuccess")),S(),P("submitted")}return Ee(h,()=>{h.value&&(C(),k(),b())}),(v,u)=>{const E=re,n=se,t=ye,p=Ve,z=de,F=ue,d=te,N=A,L=me,f=Ne;return c(),V(f,{modelValue:h.value,"onUpdate:modelValue":u[7]||(u[7]=r=>h.value=r),title:T.value,size:360},{footer:o(()=>[a(L,{size:16},{default:o(()=>[a(N,{onClick:S},{default:o(()=>[$(I(e(l)("common.cancel")),1)]),_:1}),a(N,{type:"primary",onClick:B},{default:o(()=>[$(I(e(l)("common.confirm")),1)]),_:1})]),_:1})]),default:o(()=>[a(d,{ref_key:"formRef",ref:x,model:s.value,rules:R,"label-position":"top"},{default:o(()=>[a(n,{label:e(l)("page.manage.user.userName"),prop:"userName"},{default:o(()=>[a(E,{modelValue:s.value.userName,"onUpdate:modelValue":u[0]||(u[0]=r=>s.value.userName=r),placeholder:e(l)("page.manage.user.form.userName")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(n,{label:e(l)("page.manage.user.userGender"),prop:"userGender"},{default:o(()=>[a(p,{modelValue:s.value.userGender,"onUpdate:modelValue":u[1]||(u[1]=r=>s.value.userGender=r)},{default:o(()=>[(c(!0),G(U,null,D(e(Y),r=>(c(),V(t,{key:r.value,value:r.value,label:e(l)(r.label)},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),a(n,{label:e(l)("page.manage.user.nickName"),prop:"nickName"},{default:o(()=>[a(E,{modelValue:s.value.nickName,"onUpdate:modelValue":u[2]||(u[2]=r=>s.value.nickName=r),placeholder:e(l)("page.manage.user.form.nickName")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(n,{label:e(l)("page.manage.user.userPhone"),prop:"userPhone"},{default:o(()=>[a(E,{modelValue:s.value.userPhone,"onUpdate:modelValue":u[3]||(u[3]=r=>s.value.userPhone=r),placeholder:e(l)("page.manage.user.form.userPhone")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(n,{label:e(l)("page.manage.user.userEmail"),prop:"email"},{default:o(()=>[a(E,{modelValue:s.value.userEmail,"onUpdate:modelValue":u[4]||(u[4]=r=>s.value.userEmail=r),placeholder:e(l)("page.manage.user.form.userEmail")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(n,{label:e(l)("page.manage.user.userStatus"),prop:"status"},{default:o(()=>[a(p,{modelValue:s.value.status,"onUpdate:modelValue":u[5]||(u[5]=r=>s.value.status=r)},{default:o(()=>[(c(!0),G(U,null,D(e(ee),r=>(c(),V(t,{key:r.value,value:r.value,label:e(l)(r.label)},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),a(n,{label:e(l)("page.manage.user.userRole"),prop:"roles"},{default:o(()=>[a(F,{modelValue:s.value.userRoles,"onUpdate:modelValue":u[6]||(u[6]=r=>s.value.userRoles=r),multiple:"",placeholder:e(l)("page.manage.user.form.userRole")},{default:o(()=>[(c(!0),G(U,null,D(_.value,({label:r,value:H})=>(c(),V(z,{key:H,label:r,value:H},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}}),Ie=K({name:"UserSearch",__name:"user-search",props:{model:{required:!0},modelModifiers:{}},emits:q(["reset","search"],["update:model"]),setup(y,{emit:O}){const g=O,{formRef:P,validate:h,restoreValidation:x}=ae(),m=oe(y,"model"),k=ne(()=>{const{patternRules:s}=le();return{userEmail:s.email,userPhone:s.phone}});async function w(){await x(),g("reset")}async function T(){await h(),g("search")}return(s,i)=>{const R=re,_=se,b=Ce,C=de,S=ue,B=Be,v=A,u=ze,E=me,n=Re,t=te,p=we,z=ke,F=pe;return c(),V(F,{class:"card-wrapper"},{default:o(()=>[a(z,null,{default:o(()=>[a(p,{title:e(l)("common.search"),name:"user-search"},{default:o(()=>[a(t,{ref_key:"formRef",ref:P,model:m.value,rules:k.value,"label-position":"right","label-width":80},{default:o(()=>[a(n,{gutter:24},{default:o(()=>[a(b,{lg:6,md:8,sm:12},{default:o(()=>[a(_,{label:e(l)("page.manage.user.userName"),prop:"userName"},{default:o(()=>[a(R,{modelValue:m.value.userName,"onUpdate:modelValue":i[0]||(i[0]=d=>m.value.userName=d),placeholder:e(l)("page.manage.user.form.userName")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),a(b,{lg:6,md:8,sm:12,label:e(l)("page.manage.user.userGender")},{default:o(()=>[a(_,{label:e(l)("page.manage.user.userGender"),prop:"userGender"},{default:o(()=>[a(S,{modelValue:m.value.userGender,"onUpdate:modelValue":i[1]||(i[1]=d=>m.value.userGender=d),clearable:"",placeholder:e(l)("page.manage.user.form.userGender")},{default:o(()=>[(c(!0),G(U,null,D(e(J)(e(Y)),(d,N)=>(c(),V(C,{key:N,label:d.label,value:d.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1},8,["label"]),a(b,{lg:6,md:8,sm:12},{default:o(()=>[a(_,{label:e(l)("page.manage.user.nickName"),prop:"nickName"},{default:o(()=>[a(R,{modelValue:m.value.nickName,"onUpdate:modelValue":i[2]||(i[2]=d=>m.value.nickName=d),placeholder:e(l)("page.manage.user.form.nickName")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),a(b,{lg:6,md:8,sm:12},{default:o(()=>[a(_,{label:e(l)("page.manage.user.userPhone"),prop:"userPhone"},{default:o(()=>[a(R,{modelValue:m.value.userPhone,"onUpdate:modelValue":i[3]||(i[3]=d=>m.value.userPhone=d),placeholder:e(l)("page.manage.user.form.userPhone")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),a(b,{lg:6,md:8,sm:12},{default:o(()=>[a(_,{label:e(l)("page.manage.user.userEmail"),prop:"userEmail"},{default:o(()=>[a(R,{modelValue:m.value.userEmail,"onUpdate:modelValue":i[4]||(i[4]=d=>m.value.userEmail=d),placeholder:e(l)("page.manage.user.form.userEmail")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),a(b,{lg:6,md:8,sm:12},{default:o(()=>[a(_,{label:e(l)("page.manage.user.userStatus"),prop:"userStatus"},{default:o(()=>[a(S,{modelValue:m.value.userGender,"onUpdate:modelValue":i[5]||(i[5]=d=>m.value.userGender=d),clearable:"",placeholder:e(l)("page.manage.user.form.userStatus")},{default:o(()=>[(c(!0),G(U,null,D(e(J)(e(ee)),({label:d,value:N})=>(c(),V(C,{key:N,label:d,value:N},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),a(b,{lg:12,md:24,sm:24},{default:o(()=>[a(E,{class:"w-full justify-end",alignment:"end"},{default:o(()=>[a(v,{onClick:w},{icon:o(()=>[a(B,{class:"text-icon"})]),default:o(()=>[$(" "+I(e(l)("common.reset")),1)]),_:1}),a(v,{type:"primary",plain:"",onClick:T},{icon:o(()=>[a(u,{class:"text-icon"})]),default:o(()=>[$(" "+I(e(l)("common.search")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title"])]),_:1})]),_:1})}}}),je={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"},Me={class:"flex items-center justify-between"},Ae={class:"h-[calc(100%-50px)]"},$e={class:"mt-20px flex justify-end"};function M(y){return typeof y=="function"||Object.prototype.toString.call(y)==="[object Object]"&&!Te(y)}const Le=K({name:"manage_user",__name:"index",setup(y){const{columns:O,columnChecks:g,data:P,getData:h,getDataByPage:x,loading:m,mobilePagination:k,searchParams:w,resetSearchParams:T}=ve({apiFn:be,apiParams:{current:1,size:10,status:void 0,userName:void 0,userGender:void 0,nickName:void 0,userPhone:void 0,userEmail:void 0},columns:()=>[{type:"selection",width:48},{prop:"index",label:l("common.index"),width:64},{prop:"userName",label:l("page.manage.user.userName"),minWidth:100},{prop:"userGender",label:l("page.manage.user.userGender"),width:100,formatter:n=>{if(n.userGender===void 0)return"";const t={1:"primary",2:"danger"},p=l(ce[n.userGender]);return a(X,{type:t[n.userGender]},M(p)?p:{default:()=>[p]})}},{prop:"nickName",label:l("page.manage.user.nickName"),minWidth:100},{prop:"userPhone",label:l("page.manage.user.userPhone"),width:120},{prop:"userEmail",label:l("page.manage.user.userEmail"),minWidth:200},{prop:"status",label:l("page.manage.user.userStatus"),align:"center",formatter:n=>{if(n.status===void 0)return"";const t={1:"success",2:"warning"},p=l(fe[n.status]);return a(X,{type:t[n.status]},M(p)?p:{default:()=>[p]})}},{prop:"operate",label:l("common.operate"),align:"center",formatter:n=>{let t;return a("div",{class:"flex-center"},[a(A,{type:"primary",plain:!0,size:"small",onClick:()=>E(n.id)},M(t=l("common.edit"))?t:{default:()=>[t]}),a(Oe,{title:l("common.confirmDelete"),onConfirm:()=>u(n.id)},{reference:()=>{let p;return a(A,{type:"danger",plain:!0,size:"small"},M(p=l("common.delete"))?p:{default:()=>[p]})}})])}}]}),{drawerVisible:s,operateType:i,editingData:R,handleAdd:_,handleEdit:b,checkedRowKeys:C,onBatchDeleted:S,onDeleted:B}=he(P,h);async function v(){console.log(C.value),S()}function u(n){console.log(n),B()}function E(n){b(n)}return(n,t)=>{const p=ie,z=Pe,F=Ge,d=De,N=pe,L=xe;return c(),G("div",je,[a(Ie,{model:e(w),"onUpdate:model":t[0]||(t[0]=f=>W(w)?w.value=f:null),onReset:e(T),onSearch:e(x)},null,8,["model","onReset","onSearch"]),a(N,{class:"sm:flex-1-hidden card-wrapper","body-class":"ht50"},{header:o(()=>[j("div",Me,[j("p",null,I(e(l)("page.manage.user.title")),1),a(p,{columns:e(g),"onUpdate:columns":t[1]||(t[1]=f=>W(g)?g.value=f:null),"disabled-delete":e(C).length===0,loading:e(m),onAdd:e(_),onDelete:v,onRefresh:e(h)},null,8,["columns","disabled-delete","loading","onAdd","onRefresh"])])]),default:o(()=>[j("div",Ae,[Se((c(),V(F,{height:"100%",border:"",class:"sm:h-full",data:e(P),"row-key":"id",onSelectionChange:t[2]||(t[2]=f=>C.value=f)},{default:o(()=>[(c(!0),G(U,null,D(e(O),f=>(c(),V(z,Q({key:f.prop,ref_for:!0},f),null,16))),128))]),_:1},8,["data"])),[[L,e(m)]])]),j("div",$e,[e(k).total?(c(),V(d,Q({key:0,layout:"total,prev,pager,next,sizes"},e(k),{onCurrentChange:e(k)["current-change"],onSizeChange:e(k)["size-change"]}),null,16,["onCurrentChange","onSizeChange"])):Ue("",!0)]),a(Fe,{visible:e(s),"onUpdate:visible":t[3]||(t[3]=f=>W(s)?s.value=f:null),"operate-type":e(i),"row-data":e(R),onSubmitted:e(x)},null,8,["visible","operate-type","row-data","onSubmitted"])]),_:1})])}}}),Ye=ge(Le,[["__scopeId","data-v-eac32c8c"]]);export{Ye as default};
