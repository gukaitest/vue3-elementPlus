import{n as ai,o as Vn,A as Gt,d as To,P as ye,q as bn,s as Dt,m as Jn,u as Ie,v as Ft,w as Kt,M as Pe,L as ze,x as Vt,y as Xt,j as Q,z as Cn,T as wn,h as He,f as kt,B as Mt,g as jt,C as kb,D as ee,F as ve,G as ie,E as cf,l as Pt,K as gf,I as Z,O as py,Q as vy,R as my,S as by,N as Xn,U as Cy,V as _y,W as Eb,$ as rs,X as yu,Y as Lb,Z as wy,_ as ff,a0 as Rn,a1 as Fb,a2 as Su,a5 as Hd,k as rt,b as Yt,H as Li,a6 as zb,a7 as yy,a8 as lo,a9 as Qi,ab as Sy,i as O,ac as wt,ad as xy,af as pf,ag as vf,ah as xu,ai as Ry,a4 as Ay,e as Do,a3 as we,aj as Co,ak as By,aN as Ib,aO as Kh,aP as vg,aQ as My,aV as Ty,aH as Py,am as mg,aZ as Hy}from"./linear-scale-DODXZuke.js";import{aT as Ob}from"./index-DGYzl205.js";import{j as ky}from"./get-Dgs8c9jn.js";import{E as Lr}from"./index-Bn5W5Lup.js";var ln={},kd={},an={},mf;function Db(){if(mf)return an;mf=1,Object.defineProperty(an,"__esModule",{value:!0}),an.loop=an.conditional=an.parse=void 0;var i=function n(o,r){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:s;if(Array.isArray(r))r.forEach(function(h){return n(o,h,s,l)});else if(typeof r=="function")r(o,s,l,n);else{var a=Object.keys(r)[0];Array.isArray(r[a])?(l[a]={},n(o,r[a],s,l[a])):l[a]=r[a](o,s,l,n)}return s};an.parse=i;var t=function(o,r){return function(s,l,a,h){r(s,l,a)&&h(s,o,l,a)}};an.conditional=t;var e=function(o,r){return function(s,l,a,h){for(var d=[],u=s.pos;r(s,l,a);){var c={};if(h(s,o,l,c),s.pos===u)break;u=s.pos,d.push(c)}return d}};return an.loop=e,an}var de={},bf;function Wb(){if(bf)return de;bf=1,Object.defineProperty(de,"__esModule",{value:!0}),de.readBits=de.readArray=de.readUnsigned=de.readString=de.peekBytes=de.readBytes=de.peekByte=de.readByte=de.buildStream=void 0;var i=function(u){return{data:u,pos:0}};de.buildStream=i;var t=function(){return function(u){return u.data[u.pos++]}};de.readByte=t;var e=function(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return function(c){return c.data[c.pos+u]}};de.peekByte=e;var n=function(u){return function(c){return c.data.subarray(c.pos,c.pos+=u)}};de.readBytes=n;var o=function(u){return function(c){return c.data.subarray(c.pos,c.pos+u)}};de.peekBytes=o;var r=function(u){return function(c){return Array.from(n(u)(c)).map(function(f){return String.fromCharCode(f)}).join("")}};de.readString=r;var s=function(u){return function(c){var f=n(2)(c);return u?(f[1]<<8)+f[0]:(f[0]<<8)+f[1]}};de.readUnsigned=s;var l=function(u,c){return function(f,g,p){for(var v=typeof c=="function"?c(f,g,p):c,m=n(u),b=new Array(v),C=0;C<v;C++)b[C]=m(f);return b}};de.readArray=l;var a=function(u,c,f){for(var g=0,p=0;p<f;p++)g+=u[c+p]&&Math.pow(2,f-p-1);return g},h=function(u){return function(c){for(var f=t()(c),g=new Array(8),p=0;p<8;p++)g[7-p]=!!(f&1<<p);return Object.keys(u).reduce(function(v,m){var b=u[m];return b.length?v[m]=a(g,b.index,b.length):v[m]=g[b.index],v},{})}};return de.readBits=h,de}var Cf;function Ey(){return Cf||(Cf=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var t=Db(),e=Wb(),n={blocks:function(c){for(var f=0,g=[],p=c.data.length,v=0,m=(0,e.readByte)()(c);m!==f&&m;m=(0,e.readByte)()(c)){if(c.pos+m>=p){var b=p-c.pos;g.push((0,e.readBytes)(b)(c)),v+=b;break}g.push((0,e.readBytes)(m)(c)),v+=m}for(var C=new Uint8Array(v),_=0,w=0;w<g.length;w++)C.set(g[w],_),_+=g[w].length;return C}},o=(0,t.conditional)({gce:[{codes:(0,e.readBytes)(2)},{byteSize:(0,e.readByte)()},{extras:(0,e.readBits)({future:{index:0,length:3},disposal:{index:3,length:3},userInput:{index:6},transparentColorGiven:{index:7}})},{delay:(0,e.readUnsigned)(!0)},{transparentColorIndex:(0,e.readByte)()},{terminator:(0,e.readByte)()}]},function(u){var c=(0,e.peekBytes)(2)(u);return c[0]===33&&c[1]===249}),r=(0,t.conditional)({image:[{code:(0,e.readByte)()},{descriptor:[{left:(0,e.readUnsigned)(!0)},{top:(0,e.readUnsigned)(!0)},{width:(0,e.readUnsigned)(!0)},{height:(0,e.readUnsigned)(!0)},{lct:(0,e.readBits)({exists:{index:0},interlaced:{index:1},sort:{index:2},future:{index:3,length:2},size:{index:5,length:3}})}]},(0,t.conditional)({lct:(0,e.readArray)(3,function(u,c,f){return Math.pow(2,f.descriptor.lct.size+1)})},function(u,c,f){return f.descriptor.lct.exists}),{data:[{minCodeSize:(0,e.readByte)()},n]}]},function(u){return(0,e.peekByte)()(u)===44}),s=(0,t.conditional)({text:[{codes:(0,e.readBytes)(2)},{blockSize:(0,e.readByte)()},{preData:function(c,f,g){return(0,e.readBytes)(g.text.blockSize)(c)}},n]},function(u){var c=(0,e.peekBytes)(2)(u);return c[0]===33&&c[1]===1}),l=(0,t.conditional)({application:[{codes:(0,e.readBytes)(2)},{blockSize:(0,e.readByte)()},{id:function(c,f,g){return(0,e.readString)(g.blockSize)(c)}},n]},function(u){var c=(0,e.peekBytes)(2)(u);return c[0]===33&&c[1]===255}),a=(0,t.conditional)({comment:[{codes:(0,e.readBytes)(2)},n]},function(u){var c=(0,e.peekBytes)(2)(u);return c[0]===33&&c[1]===254}),h=[{header:[{signature:(0,e.readString)(3)},{version:(0,e.readString)(3)}]},{lsd:[{width:(0,e.readUnsigned)(!0)},{height:(0,e.readUnsigned)(!0)},{gct:(0,e.readBits)({exists:{index:0},resolution:{index:1,length:3},sort:{index:4},size:{index:5,length:3}})},{backgroundColorIndex:(0,e.readByte)()},{pixelAspectRatio:(0,e.readByte)()}]},(0,t.conditional)({gct:(0,e.readArray)(3,function(u,c){return Math.pow(2,c.lsd.gct.size+1)})},function(u,c){return c.lsd.gct.exists}),{frames:(0,t.loop)([o,l,a,r,s],function(u){var c=(0,e.peekByte)()(u);return c===33||c===44})}],d=h;i.default=d}(kd)),kd}var Ur={},_f;function Ly(){if(_f)return Ur;_f=1,Object.defineProperty(Ur,"__esModule",{value:!0}),Ur.deinterlace=void 0;var i=function(e,n){for(var o=new Array(e.length),r=e.length/n,s=function(f,g){var p=e.slice(g*n,(g+1)*n);o.splice.apply(o,[f*n,n].concat(p))},l=[0,4,2,1],a=[8,8,4,2],h=0,d=0;d<4;d++)for(var u=l[d];u<r;u+=a[d])s(u,h),h++;return o};return Ur.deinterlace=i,Ur}var $r={},wf;function Fy(){if(wf)return $r;wf=1,Object.defineProperty($r,"__esModule",{value:!0}),$r.lzw=void 0;var i=function(e,n,o){var r=4096,s=-1,l=o,a,h,d,u,c,f,g,x,p,v,y,m,S,R,A,B,b=new Array(o),C=new Array(r),_=new Array(r),w=new Array(r+1);for(m=e,h=1<<m,c=h+1,a=h+2,g=s,u=m+1,d=(1<<u)-1,p=0;p<h;p++)C[p]=0,_[p]=p;var y,x,S,R,B,A;for(y=x=S=R=B=A=0,v=0;v<l;){if(R===0){if(x<u){y+=n[A]<<x,x+=8,A++;continue}if(p=y&d,y>>=u,x-=u,p>a||p==c)break;if(p==h){u=m+1,d=(1<<u)-1,a=h+2,g=s;continue}if(g==s){w[R++]=_[p],g=p,S=p;continue}for(f=p,p==a&&(w[R++]=S,p=g);p>h;)w[R++]=_[p],p=C[p];S=_[p]&255,w[R++]=S,a<r&&(C[a]=g,_[a]=S,a++,(a&d)===0&&a<r&&(u++,d+=a)),g=f}R--,b[B++]=w[R],v++}for(v=B;v<l;v++)b[v]=0;return b};return $r.lzw=i,$r}var yf;function zy(){if(yf)return ln;yf=1,Object.defineProperty(ln,"__esModule",{value:!0}),ln.decompressFrames=ln.decompressFrame=ln.parseGIF=void 0;var i=r(Ey()),t=Db(),e=Wb(),n=Ly(),o=Fy();function r(d){return d&&d.__esModule?d:{default:d}}var s=function(u){var c=new Uint8Array(u);return(0,t.parse)((0,e.buildStream)(c),i.default)};ln.parseGIF=s;var l=function(u){for(var c=u.pixels.length,f=new Uint8ClampedArray(c*4),g=0;g<c;g++){var p=g*4,v=u.pixels[g],m=u.colorTable[v]||[0,0,0];f[p]=m[0],f[p+1]=m[1],f[p+2]=m[2],f[p+3]=v!==u.transparentIndex?255:0}return f},a=function(u,c,f){if(!u.image){console.warn("gif frame does not have associated image.");return}var g=u.image,p=g.descriptor.width*g.descriptor.height,v=(0,o.lzw)(g.data.minCodeSize,g.data.blocks,p);g.descriptor.lct.interlaced&&(v=(0,n.deinterlace)(v,g.descriptor.width));var m={pixels:v,dims:{top:u.image.descriptor.top,left:u.image.descriptor.left,width:u.image.descriptor.width,height:u.image.descriptor.height}};return g.descriptor.lct&&g.descriptor.lct.exists?m.colorTable=g.lct:m.colorTable=c,u.gce&&(m.delay=(u.gce.delay||10)*10,m.disposalType=u.gce.extras.disposal,u.gce.extras.transparentColorGiven&&(m.transparentIndex=u.gce.transparentColorIndex)),f&&(m.patch=l(m)),m};ln.decompressFrame=a;var h=function(u,c){return u.frames.filter(function(f){return f.image}).map(function(f){return a(f,u.gct,c)})};return ln.decompressFrames=h,ln}var Sf=zy();class fe{static GenAutoIncrementId(){return fe.auto_increment_id++}}fe.auto_increment_id=0;class Ct{constructor(t){this.id=fe.GenAutoIncrementId(),this.registry=t}}const Yh="named",Nb="inject",Vb="multi_inject",Gb="inversify:tagged",jb="inversify:paramtypes";class bg{constructor(t,e){this.key=t,this.value=e}toString(){return this.key===Yh?`named: ${String(this.value).toString()} `:`tagged: { key:${this.key.toString()}, value: ${String(this.value)} }`}}const hr=function(i){var t;return function(e){const n=typeof Symbol=="function",o=n&&Symbol.toPrimitive!==void 0?Symbol.toPrimitive:"@@toPrimitive",r=Object.getPrototypeOf(Function),s=Map,l=new WeakMap;function a(T,P,H,L){if(!y(H))throw new TypeError;return m(T,P,H,L)}function h(T,P,H){if(!y(P))throw new TypeError;return C(H)||(H=A(H)),f(T,P,H)}function d(T,P,H){if(!y(P))throw new TypeError;return C(H)||(H=A(H)),g(T,P,H)}function u(T,P,H){if(!y(P))throw new TypeError;return C(H)||(H=A(H)),p(T,P,H)}function c(T,P,H){let L=l.get(T);if(C(L)){if(!H)return;L=new s,l.set(T,L)}let F=L.get(P);if(C(F)){if(!H)return;F=new s,L.set(P,F)}return F}function f(T,P,H){if(g(T,P,H))return!0;const L=E(P);return!_(L)&&f(T,L,H)}function g(T,P,H){const L=c(P,H,!1);return!C(L)&&R(L.has(T))}function p(T,P,H){if(g(T,P,H))return v(T,P,H);const L=E(P);return _(L)?void 0:p(T,L,H)}function v(T,P,H){const L=c(P,H,!1);if(!C(L))return L.get(T)}function m(T,P,H,L){c(H,L,!0).set(T,P)}function b(T){if(T===null)return 1;switch(typeof T){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return T===null?1:6;default:return 6}}function C(T){return T===void 0}function _(T){return T===null}function w(T){return typeof T=="symbol"}function y(T){return typeof T=="object"?T!==null:typeof T=="function"}function x(T,P){switch(b(T)){case 0:case 1:case 2:case 3:case 4:case 5:return T}const H="string",L=k(T,o);if(L!==void 0){const F=L.call(T,H);if(y(F))throw new TypeError;return F}return S(T)}function S(T,P){{const H=T.toString;if(M(H)){const F=H.call(T);if(!y(F))return F}const L=T.valueOf;if(M(L)){const F=L.call(T);if(!y(F))return F}}throw new TypeError}function R(T){return!!T}function B(T){return""+T}function A(T){const P=x(T);return w(P)?P:B(P)}function M(T){return typeof T=="function"}function k(T,P){const H=T[P];if(H!=null){if(!M(H))throw new TypeError;return H}}function E(T){const P=Object.getPrototypeOf(T);if(typeof T!="function"||T===r||P!==r)return P;const H=T.prototype,L=H&&Object.getPrototypeOf(H);if(L==null||L===Object.prototype)return P;const F=L.constructor;return typeof F!="function"||F===T?P:F}e("defineMetadata",a),e("hasMetadata",h),e("hasOwnMetadata",d),e("getMetadata",u)}((t=i,function(e,n){typeof t[e]!="function"&&Object.defineProperty(t,e,{configurable:!0,writable:!0,value:n})})),i}({});function Iy(i,t,e,n){const o=[n];let r={};hr.hasOwnMetadata(i,t)&&(r=hr.getMetadata(i,t));let s=r[e];s===void 0&&(s=[]),s.push(...o),r[e]=s,hr.defineMetadata(i,r,t)}function Oy(i,t,e,n){Iy(Gb,i,e.toString(),n)}function Ub(i){return(t,e,n)=>{Oy(t,e,n,i)}}function $b(i){return t=>(e,n,o)=>Ub(new bg(i,t))(e,n,o)}const At=$b(Nb),Kb=$b(Vb);function st(){return function(i){return hr.defineMetadata(jb,null,i),i}}function Re(i){return Ub(new bg(Yh,i))}const Po={Singleton:"Singleton",Transient:"Transient"},Un={ConstantValue:"ConstantValue",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid"};class Cg{constructor(t,e){this.id=fe.GenAutoIncrementId(),this.activated=!1,this.serviceIdentifier=t,this.scope=e,this.type=Un.Invalid,this.constraint=n=>!0,this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.dynamicValue=null}clone(){const t=new Cg(this.serviceIdentifier,this.scope);return t.activated=t.scope===Po.Singleton&&this.activated,t.implementationType=this.implementationType,t.dynamicValue=this.dynamicValue,t.scope=this.scope,t.type=this.type,t.provider=this.provider,t.constraint=this.constraint,t.cache=this.cache,t}}class Dy{getConstructorMetadata(t){return{compilerGeneratedMetadata:hr.getMetadata(jb,t),userGeneratedMetadata:hr.getMetadata(Gb,t)||{}}}getPropertiesMetadata(t){throw new Error("暂未实现")}}const Wy=i=>t=>{const e=n=>{if(n==null)return!1;if(n.key===i&&n.value===t)return!0;if(n.constructorArgsMetadata==null)return!1;const o=n.constructorArgsMetadata;for(let r=0;r<o.length;r++)if(o[r].key===i&&o[r].value===t)return!0;return!1};return e.metaData=new bg(i,t),e},Ny=Wy(Yh);class Cl{constructor(t){this._binding=t}inRequestScope(){throw new Error("暂未实现")}inSingletonScope(){return this._binding.scope=Po.Singleton,this}inTransientScope(){return this._binding.scope=Po.Transient,this}whenTargetNamed(t){return this._binding.constraint=Ny(t),this}}class Vy{constructor(t){this._binding=t}to(t){return this._binding.type=Un.Instance,this._binding.implementationType=t,new Cl(this._binding)}toSelf(){const t=this._binding.serviceIdentifier;return this.to(t)}toDynamicValue(t){return this._binding.type=Un.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=t,this._binding.implementationType=null,new Cl(this._binding)}toConstantValue(t){return this._binding.type=Un.ConstantValue,this._binding.cache=t,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=Po.Singleton,new Cl(this._binding)}toFactory(t){return this._binding.type=Un.Factory,this._binding.factory=t,this._binding.scope=Po.Singleton,new Cl(this._binding)}toService(t){this.toDynamicValue(e=>e.container.get(t))}}let Gy=class{constructor(t){const e=t||{};e.defaultScope=e.defaultScope||Po.Transient,this.options=e,this.id=fe.GenAutoIncrementId(),this._bindingDictionary=new Map,this._metadataReader=new Dy}load(t){const e=this._getContainerModuleHelpersFactory()(t.id);t.registry(e.bindFunction,e.unbindFunction,e.isboundFunction,e.rebindFunction)}get(t){const e=this._getNotAllArgs(t,!1);return this._get(e)}getAll(t){const e=this._getAllArgs(t);return this._get(e)}getTagged(t,e,n){const o=this._getNotAllArgs(t,!1,e,n);return this._get(o)}getNamed(t,e){return this.getTagged(t,Yh,e)}isBound(t){return this._bindingDictionary.has(t)}bind(t){const e=this.options.defaultScope,n=new Cg(t,e),o=this._bindingDictionary.get(t)||[];return o.push(n),this._bindingDictionary.set(t,o),new Vy(n)}unbind(t){this._bindingDictionary.delete(t)}rebind(t){return this.unbind(t),this.bind(t)}_getContainerModuleHelpersFactory(){const t=(s,l)=>{s._binding.moduleId=l},e=s=>l=>{const a=this.bind(l);return t(a,s),a},n=()=>s=>this.unbind(s),o=()=>s=>this.isBound(s),r=s=>l=>{const a=this.rebind(l);return t(a,s),a};return s=>({bindFunction:e(s),isboundFunction:o(),rebindFunction:r(s),unbindFunction:n(),unbindAsyncFunction:l=>null})}_getNotAllArgs(t,e,n,o){return{avoidConstraints:!1,isMultiInject:e,serviceIdentifier:t,key:n,value:o}}_getAllArgs(t){return{avoidConstraints:!0,isMultiInject:!0,serviceIdentifier:t}}_get(t){const e=[];return this._bindingDictionary.get(t.serviceIdentifier).filter(n=>n.constraint(t)).forEach(n=>{e.push(this._resolveFromBinding(n))}),t.isMultiInject||e.length!==1?e:e[0]}_getChildRequest(t){const e=t.implementationType,{userGeneratedMetadata:n}=this._metadataReader.getConstructorMetadata(e),o=Object.keys(n),r=[];for(let s=0;s<o.length;s++){const l=n[s],a={};l.forEach(f=>{a[f.key]=f.value});const h={inject:a[Nb],multiInject:a[Vb]},d=h.inject||h.multiInject,u={serviceIdentifier:d,constructorArgsMetadata:l},c={injectIdentifier:d,metadata:l,bindings:this._bindingDictionary.get(d).filter(f=>f.constraint(u))};r.push(c)}return r}_resolveFromBinding(t){const e=this._getResolvedFromBinding(t);return this._saveToScope(t,e),e}_getResolvedFromBinding(t){let e;switch(t.type){case Un.ConstantValue:case Un.Function:e=t.cache;break;case Un.Instance:e=this._resolveInstance(t,t.implementationType);break;default:e=t.dynamicValue({container:this})}return e}_resolveInstance(t,e){if(t.activated)return t.cache;const n=this._getChildRequest(t);return this._createInstance(e,n)}_createInstance(t,e){return e.length?new t(...this._resolveRequests(e)):new t}_resolveRequests(t){return t.map(e=>e.bindings.length>1?e.bindings.map(n=>this._resolveFromBinding(n)):this._resolveFromBinding(e.bindings[0]))}_saveToScope(t,e){t.scope===Po.Singleton&&(t.cache=e,t.activated=!0)}};const ge=Symbol("ContributionProvider");class Yb{constructor(t,e){this.serviceIdentifier=t,this.container=e}getContributions(){return this.caches||(this.caches=[],this.container&&this.container.isBound(this.serviceIdentifier)&&this.caches.push(...this.container.getAll(this.serviceIdentifier))),this.caches}}function Oe(i,t){i(ge).toDynamicValue(({container:e})=>new Yb(t,e)).inSingletonScope().whenTargetNamed(t)}function jy(i,t){i(ge).toDynamicValue(({container:e})=>new Yb(t,e)).whenTargetNamed(t)}class Uy{constructor(t,e){this._args=t,this.name=e,this.taps=[]}tap(t,e){this._tap("sync",t,e)}unTap(t,e){const n=typeof t=="string"?t.trim():t.name;n&&(this.taps=this.taps.filter(o=>!(o.name===n&&(!e||o.fn===e))))}_parseOptions(t,e,n){let o;if(typeof e=="string")o={name:e.trim()};else if(typeof e!="object"||e===null)throw new Error("Invalid tap options");if(typeof o.name!="string"||o.name==="")throw new Error("Missing name for tap");return o=Object.assign({type:t,fn:n},o),o}_tap(t,e,n){this._insert(this._parseOptions(t,e,n))}_insert(t){let e;typeof t.before=="string"?e=new Set([t.before]):Array.isArray(t.before)&&(e=new Set(t.before));let n=0;typeof t.stage=="number"&&(n=t.stage);let o=this.taps.length;for(;o>0;){o--;const r=this.taps[o];this.taps[o+1]=r;const s=r.stage||0;if(e){if(e.has(r.name)){e.delete(r.name);continue}if(e.size>0)continue}if(!(s>n)){o++;break}}this.taps[o]=t}}class Xe extends Uy{call(...t){this.taps.map(e=>e.fn).forEach(e=>e(...t))}}const Xh=Symbol.for("EnvContribution"),_g=Symbol.for("VGlobal");var $y=function(i,t,e,n){var o,r=arguments.length,s=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var l=i.length-1;l>=0;l--)(o=i[l])&&(s=(r<3?o(s):r>3?o(t,e,s):o(t,e))||s);return r>3&&s&&Object.defineProperty(t,e,s),s},Ky=function(i,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,t)},xf=function(i,t){return function(e,n){t(e,n,i)}},Yy=function(i,t,e,n){return new(e||(e=Promise))(function(o,r){function s(h){try{a(n.next(h))}catch(d){r(d)}}function l(h){try{a(n.throw(h))}catch(d){r(d)}}function a(h){var d;h.done?o(h.value):(d=h.value,d instanceof e?d:new e(function(u){u(d)})).then(s,l)}a((n=n.apply(i,t||[])).next())})};let Ru=class{get env(){return this._env}get isImageAnonymous(){return this._isImageAnonymous}set isImageAnonymous(i){this._isImageAnonymous=i}get devicePixelRatio(){return this._env||this.setEnv("browser"),this.envContribution.getDevicePixelRatio()}get supportEvent(){return this._env||this.setEnv("browser"),this.envContribution.supportEvent}set supportEvent(i){this._env||this.setEnv("browser"),this.envContribution.supportEvent=i}get supportsTouchEvents(){return this._env||this.setEnv("browser"),this.envContribution.supportsTouchEvents}set supportsTouchEvents(i){this._env||this.setEnv("browser"),this.envContribution.supportsTouchEvents=i}get supportsPointerEvents(){return this._env||this.setEnv("browser"),this.envContribution.supportsPointerEvents}set supportsPointerEvents(i){this._env||this.setEnv("browser"),this.envContribution.supportsPointerEvents=i}get supportsMouseEvents(){return this._env||this.setEnv("browser"),this.envContribution.supportsMouseEvents}set supportsMouseEvents(i){this._env||this.setEnv("browser"),this.envContribution.supportsMouseEvents=i}get applyStyles(){return this._env||this.setEnv("browser"),this.envContribution.applyStyles}set applyStyles(i){this._env||this.setEnv("browser"),this.envContribution.applyStyles=i}constructor(i){this.contributions=i,this._isImageAnonymous=!0,this.id=fe.GenAutoIncrementId(),this.hooks={onSetEnv:new Xe(["lastEnv","env","global"])},this.measureTextMethod="native",this.optimizeVisible=!1}bindContribution(i){const t=[];if(this.contributions.getContributions().forEach(e=>{const n=e.configure(this,i);n&&n.then&&t.push(n)}),t.length)return Promise.all(t)}getDynamicCanvasCount(){return this._env||this.setEnv("browser"),this.envContribution.getDynamicCanvasCount()}getStaticCanvasCount(){return this._env||this.setEnv("browser"),this.envContribution.getStaticCanvasCount()}setEnv(i,t){if(t&&t.force===!0||this._env!==i)return this.deactiveCurrentEnv(),this.activeEnv(i,t)}deactiveCurrentEnv(){this.envContribution&&this.envContribution.release()}activeEnv(i,t){const e=this._env;this._env=i;const n=this.bindContribution(t);if(n&&n.then)return n.then(()=>{this.envParams=t,this.hooks.onSetEnv.call(e,i,this)});this.envParams=t,this.hooks.onSetEnv.call(e,i,this)}setActiveEnvContribution(i){this.envContribution=i}createCanvas(i){return this._env||this.setEnv("browser"),this.envContribution.createCanvas(i)}createOffscreenCanvas(i){return this._env||this.setEnv("browser"),this.envContribution.createOffscreenCanvas(i)}releaseCanvas(i){return this._env||this.setEnv("browser"),this.envContribution.releaseCanvas(i)}addEventListener(i,t,e){return this._env||this.setEnv("browser"),this.envContribution.addEventListener(i,t,e)}removeEventListener(i,t,e){return this._env||this.setEnv("browser"),this.envContribution.removeEventListener(i,t,e)}dispatchEvent(i){return this._env||this.setEnv("browser"),this.envContribution.dispatchEvent(i)}getRequestAnimationFrame(){return this._env||this.setEnv("browser"),this.envContribution.getRequestAnimationFrame()}getCancelAnimationFrame(){return this._env||this.setEnv("browser"),this.envContribution.getCancelAnimationFrame()}getElementById(i){return this._env||this.setEnv("browser"),this.envContribution.getElementById?this.envContribution.getElementById(i):null}getRootElement(){return this._env||this.setEnv("browser"),this.envContribution.getRootElement?this.envContribution.getRootElement():null}getDocument(){return this._env||this.setEnv("browser"),this.envContribution.getDocument?this.envContribution.getDocument():null}mapToCanvasPoint(i,t){return this._env||this.setEnv("browser"),this.envContribution.mapToCanvasPoint?this.envContribution.mapToCanvasPoint(i,t):null}loadImage(i){return this._env||this.setEnv("browser"),this.envContribution.loadImage(i)}loadSvg(i){return this._env||this.setEnv("browser"),this.envContribution.loadSvg(i)}loadJson(i){return this._env||this.setEnv("browser"),this.envContribution.loadJson(i)}loadArrayBuffer(i){return this._env||this.setEnv("browser"),this.envContribution.loadArrayBuffer(i)}loadBlob(i){return this._env||this.setEnv("browser"),this.envContribution.loadBlob(i)}loadFont(i,t,e){return Yy(this,void 0,void 0,function*(){return this._env||this.setEnv("browser"),this.envContribution.loadFont(i,t,e)})}isChrome(){return this._isChrome!=null||(this._env||this.setEnv("browser"),this._isChrome=this._env==="browser"&&navigator.userAgent.indexOf("Chrome")>-1),this._isChrome}isSafari(){return this._isSafari!=null||(this._env||this.setEnv("browser"),this._isSafari=this._env==="browser"&&/Safari/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)),this._isSafari}getNativeAABBBounds(i){return this._env||this.setEnv("browser"),this.envContribution.getNativeAABBBounds(i)}removeDom(i){return this._env||this.setEnv("browser"),this.envContribution.removeDom(i)}createDom(i){return this._env||this.setEnv("browser"),this.envContribution.createDom(i)}updateDom(i,t){return this._env||this.setEnv("browser"),this.envContribution.updateDom(i,t)}getElementTop(i,t=!1){return this._env||this.setEnv("browser"),this.envContribution.getElementTop(i,t)}getElementLeft(i,t=!1){return this._env||this.setEnv("browser"),this.envContribution.getElementLeft(i,t)}getElementTopLeft(i,t=!1){return this._env||this.setEnv("browser"),this.envContribution.getElementTopLeft(i,t)}};Ru=$y([st(),xf(0,At(ge)),xf(0,Re(Xh)),Ky("design:paramtypes",[Object])],Ru);var xo;(function(i){i[i.estimate=0]="estimate",i[i.actualBounding=1]="actualBounding",i[i.fontBounding=2]="fontBounding"})(xo||(xo={}));const Xy=ai-1e-8;class wg{constructor(t){this.init(t)}init(t){this.bounds=t}arc(t,e,n,o,r,s){if(Math.abs(r-o)>Xy)return this.bounds.add(t-n,e-n),void this.bounds.add(t+n,e+n);let l,a,h,d,u=1/0,c=-1/0,f=1/0,g=-1/0;function p(v){h=n*Math.cos(v),d=n*Math.sin(v),h<u&&(u=h),h>c&&(c=h),d<f&&(f=d),d>g&&(g=d)}if(p(o),p(r),r!==o)if((o%=ai)<0&&(o+=ai),(r%=ai)<0&&(r+=ai),r<o&&(s=!s,l=o,o=r,r=l),s)for(r-=ai,l=o-o%Vn,a=0;a<4&&l>r;++a,l-=Vn)p(l);else for(l=o-o%Vn+Vn,a=0;a<4&&l<r;++a,l+=Vn)p(l);this.bounds.add(t+u,e+f),this.bounds.add(t+c,e+g)}arcTo(t,e,n,o,r){this.bounds.add(t,e)}bezierCurveTo(t,e,n,o,r,s){this.bounds.add(t,e),this.bounds.add(n,o),this.bounds.add(r,s)}closePath(){}ellipse(){throw new Error("不支持ellipse")}lineTo(t,e){this.bounds.add(t,e)}moveTo(t,e){this.bounds.add(t,e)}quadraticCurveTo(t,e,n,o){this.bounds.add(t,e),this.bounds.add(n,o)}rect(t,e,n,o){this.bounds.add(t,e),this.bounds.add(t+n,e+o)}clear(){this.bounds.clear()}release(...t){}}class qy{constructor(){this.curves=[],this.bounds=new Gt}getCurveLengths(){return this.curves.map(t=>t.getLength())}getPointAt(t){return{x:0,y:0}}getLength(){return 0}getBounds(){return this.bounds}}const Zy=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:[eE][-+]?\d+)?)/gi,Jy={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,M:2,L:2,H:1,V:1,C:6,S:4,Q:4,T:2,A:7},Lt={A:0,AT:1,C:2,Z:3,E:4,L:5,M:6,Q:7,R:8};let Ed,Rf,_l,Af,Ld,wl;function Qy(i){if(!i)return[];const t=i.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi);if(t===null)return[];let e,n;const o=[];for(let r=0,s=t.length;r<s;r++)if(Ed=t[r],Rf=Ed.slice(1),_l=Ed[0],e=[_l],n=Rf.match(Zy),n!==null){for(let l=0,a=n.length;l<a;l++)Af=n[l],Ld=parseFloat(Af),Number.isNaN(Ld)||e.push(Ld);if(wl=Jy[_l],e.length-1>wl){let l,a=_l;for(let h=1,d=e.length;h<d;h+=wl){l=[a];for(let u=h,c=h+wl;u<c;u++)l.push(e[u]);o.push(l),a==="m"?a="l":a==="M"&&(a="L")}}else o.push(e)}else o.push(e);return o}var Nt;(function(i){i[i.NONE=0]="NONE",i[i.UPDATE_BOUNDS=1]="UPDATE_BOUNDS",i[i.UPDATE_SHAPE=2]="UPDATE_SHAPE",i[i.CLEAR_SHAPE=253]="CLEAR_SHAPE",i[i.UPDATE_SHAPE_AND_BOUNDS=3]="UPDATE_SHAPE_AND_BOUNDS",i[i.INIT=179]="INIT",i[i.CLEAR_BOUNDS=254]="CLEAR_BOUNDS",i[i.UPDATE_GLOBAL_MATRIX=32]="UPDATE_GLOBAL_MATRIX",i[i.CLEAR_GLOBAL_MATRIX=223]="CLEAR_GLOBAL_MATRIX",i[i.UPDATE_LOCAL_MATRIX=16]="UPDATE_LOCAL_MATRIX",i[i.CLEAR_LOCAL_MATRIX=239]="CLEAR_LOCAL_MATRIX",i[i.UPDATE_GLOBAL_LOCAL_MATRIX=48]="UPDATE_GLOBAL_LOCAL_MATRIX",i[i.UPDATE_LAYOUT=128]="UPDATE_LAYOUT",i[i.CLEAR_LAYOUT=127]="CLEAR_LAYOUT"})(Nt||(Nt={}));var Ts;(function(i){i[i.GLOBAL=1]="GLOBAL",i[i.LOCAL=16]="LOCAL",i[i.GLOBAL_ACCURATE=3]="GLOBAL_ACCURATE",i[i.LOCAL_ACCURATE=48]="LOCAL_ACCURATE"})(Ts||(Ts={}));var Ye;(function(i){i[i.INIT=0]="INIT",i[i.DEFAULT=1]="DEFAULT",i[i.STATE=2]="STATE",i[i.ANIMATE_BIND=10]="ANIMATE_BIND",i[i.ANIMATE_PLAY=11]="ANIMATE_PLAY",i[i.ANIMATE_START=12]="ANIMATE_START",i[i.ANIMATE_UPDATE=13]="ANIMATE_UPDATE",i[i.ANIMATE_END=14]="ANIMATE_END",i[i.TRANSLATE=20]="TRANSLATE",i[i.TRANSLATE_TO=21]="TRANSLATE_TO",i[i.SCALE=22]="SCALE",i[i.SCALE_TO=23]="SCALE_TO",i[i.ROTATE=24]="ROTATE",i[i.ROTATE_TO=25]="ROTATE_TO"})(Ye||(Ye={}));var Le;(function(i){i[i.INITIAL=0]="INITIAL",i[i.RUNNING=1]="RUNNING",i[i.PAUSED=2]="PAUSED",i[i.END=3]="END"})(Le||(Le={}));var la;(function(i){i[i.NORMAL=0]="NORMAL",i[i.SET_ATTR_IMMEDIATELY=1]="SET_ATTR_IMMEDIATELY"})(la||(la={}));var er;(function(i){i.wait="wait",i.from="from",i.to="to",i.customAnimate="customAnimate"})(er||(er={}));var Ut;(function(i){i[i.ROW=1]="ROW",i[i.COLUMN=2]="COLUMN"})(Ut||(Ut={}));var aa;(function(i){i[i.CubicBezierCurve=0]="CubicBezierCurve",i[i.QuadraticBezierCurve=1]="QuadraticBezierCurve",i[i.ArcCurve=2]="ArcCurve",i[i.LineCurve=3]="LineCurve",i[i.EllipseCurve=4]="EllipseCurve",i[i.MoveCurve=5]="MoveCurve"})(aa||(aa={}));var Et;(function(i){i[i.beforeFillStroke=0]="beforeFillStroke",i[i.afterFillStroke=1]="afterFillStroke"})(Et||(Et={}));function t1(i,t,e,n,o,r,s,l,a){const h=To(s),d=Math.sin(h),u=Math.cos(h),c=u*(l-i)*.5+d*(a-t)*.5,f=u*(a-t)*.5-d*(l-i)*.5;let g=c*c/((e=Math.abs(e))*e)+f*f/((n=Math.abs(n))*n);g>1&&(g=Math.sqrt(g),e*=g,n*=g);const p=u/e,v=d/e,m=-d/n,b=u/n,C=p*l+v*a,_=m*l+b*a,w=p*i+v*t,y=m*i+b*t;let x=1/((w-C)*(w-C)+(y-_)*(y-_))-.25;x<0&&(x=0);let S=Math.sqrt(x);r===o&&(S=-S);const R=.5*(C+w)-S*(y-_),B=.5*(_+y)+S*(w-C),A=Math.atan2(_-B,C-R);let M=Math.atan2(y-B,w-R)-A;M<0&&r===1?M+=ai:M>0&&r===0&&(M-=ai);const k=Math.ceil(Math.abs(M/(Vn+.001))),E=[];for(let T=0;T<k;++T){const P=A+T*M/k,H=A+(T+1)*M/k;E[T]=[R,B,P,H,e,n,d,u]}return E}function e1(i){const t=i[0],e=i[1],n=i[2],o=i[3],r=i[4],s=i[5],l=i[6],a=i[7],h=a*r,d=-l*s,u=l*r,c=a*s,f=Math.cos(n),g=Math.sin(n),p=Math.cos(o),v=Math.sin(o),m=.5*(o-n),b=Math.sin(.5*m),C=8/3*b*b/Math.sin(m),_=t+f-C*g,w=e+g+C*f,y=t+p,x=e+v,S=y+C*v,R=x-C*p;return[h*_+d*w,u*_+c*w,h*S+d*R,u*S+c*R,h*y+d*x,u*y+c*x]}function Bf(i,t,e,n){const o=t1(n[5],n[6],n[0],n[1],n[3],n[4],n[2],t,e);for(let r=0;r<o.length;++r){const s=e1(o[r]);i.bezierCurveTo(s[0],s[1],s[2],s[3],s[4],s[5])}}const i1=(i,t,e,n,o,r,s)=>{const l=Math.abs(e-t),a=l>.5*Math.PI?Math.ceil(2*l/Math.PI):1,h=(e-t)/a;for(let d=0;d<a;d++){const u=t+h*d,c=t+h*(d+1),f=4*Math.tan(Math.abs(h)/4)/3,g=c<u?-1:1,p=Math.cos(u),v=Math.sin(u),m=Math.cos(c),b=Math.sin(c),C=p*r+n,_=v*s+o,w=m*r+n,y=b*s+o,x=r*f*g,S=s*f*g;i.push(C-x*v,_+S*p,w+x*b,y-S*m,w,y)}},n1=[(i,t,e,n,o,r,s)=>t.arc(i[1]*o+e,i[2]*r+n,i[3]*(o+r)/2,i[4],i[5],i[6],s),(i,t,e,n,o,r,s)=>t.arcTo(i[1]*o+e,i[2]*r+n,i[3]*o+e,i[4]*r+n,i[5]*(o+r)/2,s),(i,t,e,n,o,r,s)=>t.bezierCurveTo(i[1]*o+e,i[2]*r+n,i[3]*o+e,i[4]*r+n,i[5]*o+e,i[6]*r+n,s),(i,t,e,n)=>t.closePath(),(i,t,e,n,o,r)=>t.ellipse(i[1]*o+e,i[2]*r+n,i[3]*o,i[4]*r,i[5],i[6],i[7],i[8]),(i,t,e,n,o,r,s)=>t.lineTo(i[1]*o+e,i[2]*r+n,s),(i,t,e,n,o,r,s)=>t.moveTo(i[1]*o+e,i[2]*r+n,s),(i,t,e,n,o,r,s)=>t.quadraticCurveTo(i[1]*o+e,i[2]*r+n,i[3]*o+e,i[4]*r+n,s),(i,t,e,n,o,r,s)=>t.rect(i[1]*o+e,i[2]*r+n,i[3]*o,i[4]*r,s)];function Qn(i,t,e=0,n=0,o=1,r=1,s){for(let l=0;l<i.length;l++){const a=i[l];n1[a[0]](a,t,e,n,o,r,s)}}class Xb{getLength(t){return t!=null?this.calcProjLength(t):(Number.isFinite(this.length)||(this.length=this.calcLength()),this.length)}}function o1(i,t){let e=0;const n=i.length;for(let o=0;o<n;o++){const r=i[o],s=t[o],l=i[(o+1)%n],a=t[(o+1)%n];e+=bn.distanceNN(r,s,l,a)}return e/2}function r1(i,t,e,n,o){return o1([i.x,t.x,e.x,n.x],[i.y,t.y,e.y,n.y])}function Mf(i,t,e,n,o){const r=1-o;return r*r*r*i+3*t*o*r*r+3*e*o*o*r+n*o*o*o}function qb(i,t,e,n,o){const r=Mf(i.x,t.x,e.x,n.x,o),s=Mf(i.y,t.y,e.y,n.y,o);return new ye(r,s)}function Au(i,t){const{p0:e,p1:n,p2:o,p3:r}=i,s=qb(e,n,o,r,t),l=bn.pointAtPP(e,n,t),a=bn.pointAtPP(n,o,t),h=bn.pointAtPP(o,r,t),d=bn.pointAtPP(l,a,t),u=bn.pointAtPP(a,h,t);return[new Bu(e,l,d,s),new Bu(s,u,h,r)]}class Bu extends Xb{constructor(t,e,n,o){super(),this.type=aa.CubicBezierCurve,this.p0=t,this.p1=e,this.p2=n,this.p3=o}_validPoint(){return Number.isFinite(this.p0.x+this.p0.y+this.p1.x+this.p1.y+this.p2.x+this.p2.y+this.p3.x+this.p3.y)}getPointAt(t){if(this.defined!==!1)return qb(this.p0,this.p1,this.p2,this.p3,t);throw new Error("defined为false的点不能getPointAt")}calcLength(){return this._validPoint()?r1(this.p0,this.p1,this.p2,this.p3):60}calcProjLength(t){return t===Ut.ROW?Dt(this.p0.x-this.p3.x):t===Ut.COLUMN?Dt(this.p0.y-this.p3.y):0}getAngleAt(t){const e=Jn(t-.01,0),n=Ie(t+.01,1),o=this.getPointAt(e),r=this.getPointAt(n);return Ft(r.y-o.y,r.x-o.x)}}function Tf(i,t){const{p0:e,p1:n}=i,o=bn.pointAtPP(e,n,t);return[new Mu(e,o),new Mu(o,n)]}class Mu extends Xb{constructor(t,e){super(),this.type=aa.LineCurve,this.p0=t,this.p1=e}getPointAt(t){if(this.defined!==!1)return bn.pointAtPP(this.p0,this.p1,t);throw new Error("defined为false的点不能getPointAt")}getAngleAt(t){return this.angle==null&&(this.angle=Ft(this.p1.y-this.p0.y,this.p1.x-this.p0.x)),this.angle}_validPoint(){return Number.isFinite(this.p0.x+this.p0.y+this.p1.x+this.p1.y)}calcLength(){return this._validPoint()?bn.distancePP(this.p0,this.p1):60}calcProjLength(t){return t===Ut.ROW?Dt(this.p0.x-this.p1.x):t===Ut.COLUMN?Dt(this.p0.y-this.p1.y):0}}class yg{get endX(){return this._lastX}get endY(){return this._lastY}constructor(t,e){this.init(t,e)}init(t,e){this._lastX=this._lastY=this._startX=this._startY=0,this.curveType=t,this.direction=e,this.curves=[]}bezierCurveTo(t,e,n,o,r,s,l,a){const h=new Bu(new ye(this._lastX,this._lastY),new ye(t,e),new ye(n,o),new ye(r,s));h.originP1=this._lastOriginP,h.originP2=a,h.defined=l,this.curves.push(h),this._lastX=r,this._lastY=s,this._lastOriginP=a}closePath(){if(this.curves.length<2)return;const t=this.curves[this.curves.length-1];this.lineTo(this._startX,this._startY,t.defined,this._startOriginP)}ellipse(){throw new Error("SegContext不支持调用ellipse")}lineTo(t,e,n,o){const r=this.addLinearCurve(t,e,n,this._lastOriginP,o);this.curves.push(r),this._lastX=t,this._lastY=e,this._lastOriginP=o}moveTo(t,e,n){return this._lastX=this._startX=t,this._lastY=this._startY=e,this._lastOriginP=n,this._startOriginP=n,this}quadraticCurveTo(t,e,n,o){throw new Error("SegContext不支持调用quadraticCurveTo")}clear(){this.curves=[],this.length=NaN}tryUpdateLength(t){return this.getLength(t)}addLinearCurve(t,e,n,o,r){const s=new Mu(new ye(this._lastX,this._lastY),new ye(t,e));return s.originP1=o,s.originP2=r,s.defined=n,s}getPointAt(t){throw new Error("暂未实现")}getCurveLengths(){return[]}getLength(t){var e,n;if(t===Ut.COLUMN){if(!this.curves.length)return 0;const o=this.curves[0],r=this.curves[this.curves.length-1],s=(e=r.p3)!==null&&e!==void 0?e:r.p1;return Dt(o.p0.y-s.y)}if(t===Ut.ROW){if(!this.curves.length)return 0;const o=this.curves[0],r=this.curves[this.curves.length-1],s=(n=r.p3)!==null&&n!==void 0?n:r.p1;return Dt(o.p0.x-s.x)}return Number.isFinite(this.length)||(this.length=this.curves.reduce((o,r)=>o+r.getLength(),0)),this.length}}class s1 extends yg{bezierCurveTo(t,e,n,o,r,s,l,a){return super.bezierCurveTo(e,t,o,n,s,r,l,a)}lineTo(t,e,n,o){return super.lineTo(e,t,n,o)}moveTo(t,e,n){return super.moveTo(e,t,n)}clear(){return super.clear()}}function Wo(i,t,e=1){let n=!1;for(let o=0,r=t.length;o<=r;o++)o>=r===n&&((n=!n)?i.lineStart():i.lineEnd()),n&&i.point(t[o])}function Fr(i,t,e){const n=t??(Dt(e[e.length-1].x-e[0].x)>Dt(e[e.length-1].y-e[0].y)?Ut.ROW:Ut.COLUMN);return i==="monotoneY"?new s1(i,n):new yg(i,n)}class Zb{constructor(t,e){this.context=t,e&&(this.startPoint=e)}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0,this.startPoint&&this.point(this.startPoint)}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this.context.closePath(),this._line=1-this._line}point(t){const e=t.x,n=t.y;switch(this._point){case 0:this._point=1,this._line?this.context.lineTo(e,n,this._lastDefined!==!1&&t.defined!==!1,t):this.context.moveTo(e,n,t);break;case 1:this._point=2;default:this.context.lineTo(e,n,this._lastDefined!==!1&&t.defined!==!1,t)}this._lastDefined=t.defined}tryUpdateLength(){return this.context.tryUpdateLength()}}function tl(i,t={}){const{direction:e,startPoint:n}=t;if(i.length<2-+!!n)return null;const o=Fr("linear",e,i);return l1(new Zb(o,n),i),o}function l1(i,t){return Wo(i,t,1)}function Pf(i,t,e,n,o){i.context.bezierCurveTo((2*i._x0+i._x1)/3,(2*i._y0+i._y1)/3,(i._x0+2*i._x1)/3,(i._y0+2*i._y1)/3,(i._x0+4*i._x1+t)/6,(i._y0+4*i._y1+e)/6,n,i.lastPoint1)}class a1{constructor(t,e){this.context=t,this.startPoint=e}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0,this.startPoint&&this.point(this.startPoint)}lineEnd(){this._point===2&&Pf(this,6*this._x1-(this._x0+4*this._x1),6*this._y1-(this._y0+4*this._y1),this._lastDefined1!==!1&&this._lastDefined2!==!1,this.lastPoint1),(this._line||this._line!==0&&this._point===1)&&this.context.closePath(),this._line=1-this._line}point(t){const e=t.x,n=t.y;switch(this._point){case 0:this._point=1,this._line?this.context.lineTo(e,n,this._lastDefined1!==!1&&this._lastDefined2!==!1,t):this.context.moveTo(e,n,t);break;case 1:this._point=2;break;default:Pf(this,e,n,this._lastDefined1!==!1&&this._lastDefined2!==!1)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=n,this._lastDefined1=this._lastDefined2,this._lastDefined2=t.defined,this.lastPoint0=this.lastPoint1,this.lastPoint1=t}tryUpdateLength(){return this.context.tryUpdateLength()}}function h1(i,t){return Wo(i,t,2)}function d1(i,t={}){const{direction:e,startPoint:n}=t;if(i.length<2-+!!n)return null;if(i.length<3-+!!n)return tl(i,t);const o=Fr("basis",e,i);return h1(new a1(o,n),i),o}function Hf(i){return i<0?-1:1}function kf(i,t,e){const n=i._x1-i._x0,o=t-i._x1,r=(i._y1-i._y0)/(n||Number(o<0&&-0)),s=(e-i._y1)/(o||Number(n<0&&-0)),l=(r*o+s*n)/(n+o);return(Hf(r)+Hf(s))*Math.min(Math.abs(r),Math.abs(s),.5*Math.abs(l))||0}function Ef(i,t){const e=i._x1-i._x0;return e?(3*(i._y1-i._y0)/e-t)/2:t}function Fd(i,t,e,n,o){const r=i._x0,s=i._y0,l=i._x1,a=i._y1,h=(l-r)/3;i.context.bezierCurveTo(r+h,s+h*t,l-h,a-h*e,l,a,n,i.lastPoint1)}class Jb{constructor(t,e){this.context=t,this.startPoint=e}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0,this.startPoint&&this.point(this.startPoint)}lineEnd(){switch(this._point){case 2:this.context.lineTo(this._x1,this._y1,this._lastDefined1!==!1&&this._lastDefined2!==!1,this.lastPoint1);break;case 3:Fd(this,this._t0,Ef(this,this._t0),this._lastDefined1!==!1&&this._lastDefined2!==!1,this.lastPoint1)}(this._line||this._line!==0&&this._point===1)&&this.context.closePath(),this._line=1-this._line}point(t){let e=NaN;const n=t.x,o=t.y;switch(this._point){case 0:this._point=1,this._line?this.context.lineTo(n,o,this._lastDefined1!==!1&&this._lastDefined2!==!1,t):this.context.moveTo(n,o,t);break;case 1:this._point=2;break;case 2:this._point=3,Fd(this,Ef(this,e=kf(this,n,o)),e,this._lastDefined1!==!1&&this._lastDefined2!==!1);break;default:Fd(this,this._t0,e=kf(this,n,o),this._lastDefined1!==!1&&this._lastDefined2!==!1)}this._x0=this._x1,this._x1=n,this._y0=this._y1,this._y1=o,this._t0=e,this._lastDefined1=this._lastDefined2,this._lastDefined2=t.defined!==!1,this.lastPoint0=this.lastPoint1,this.lastPoint1=t}tryUpdateLength(){return this.context.tryUpdateLength()}}class u1 extends Jb{constructor(t,e){super(t,e)}point(t){return super.point({y:t.x,x:t.y,defined:t.defined})}}function c1(i,t){return Wo(i,t,2)}function g1(i,t={}){const{direction:e,startPoint:n}=t;if(i.length<2-+!!n)return null;if(i.length<3-+!!n)return tl(i,t);const o=Fr("monotoneX",e,i);return c1(new Jb(o,n),i),o}function f1(i,t){return Wo(i,t,2)}function p1(i,t={}){const{direction:e,startPoint:n}=t;if(i.length<2-+!!n)return null;if(i.length<3-+!!n)return tl(i,t);const o=Fr("monotoneY",e,i);return f1(new u1(o,n),i),o}let v1=class{constructor(t,e=.5,n){this.context=t,this._t=e,this.startPoint=n}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._x=this._y=NaN,this._point=0,this.startPoint&&this.point(this.startPoint)}lineEnd(){0<this._t&&this._t<1&&this._point===2&&this.context.lineTo(this._x,this._y,this._lastDefined!==!1,this.lastPoint),(this._line||this._line!==0&&this._point===1)&&this.context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)}point(t){const e=t.x,n=t.y;switch(this._point){case 0:this._point=1,this._line?this.context.lineTo(e,n,this._lastDefined!==!1&&t.defined!==!1,t):this.context.moveTo(e,n,t);break;case 1:this._point=2;default:if(this._t<=0)this.context.lineTo(this._x,n,this._lastDefined!==!1&&t.defined!==!1,this.lastPoint),this.context.lineTo(e,n,this._lastDefined!==!1&&t.defined!==!1,t);else{const o=this._x*(1-this._t)+e*this._t;this.context.lineTo(o,this._y,this._lastDefined!==!1&&t.defined!==!1,this.lastPoint),this.context.lineTo(o,n,this._lastDefined!==!1&&t.defined!==!1,t)}}this._lastDefined=t.defined,this._x=e,this._y=n,this.lastPoint=t}tryUpdateLength(){return this.context.tryUpdateLength()}};function zd(i,t,e={}){const{direction:n,startPoint:o}=e;if(i.length<2-+!!o)return null;const r=new yg("step",n??(Dt(i[i.length-1].x-i[0].x)>Dt(i[i.length-1].y-i[0].y)?Ut.ROW:Ut.COLUMN));return m1(new v1(r,t,o),i),r}function m1(i,t){return Wo(i,t,1)}class b1 extends Zb{lineEnd(){this.context.closePath()}}function C1(i,t={}){const{direction:e,startPoint:n}=t;if(i.length<2-+!!n)return null;const o=Fr("linear",e,i);return _1(new b1(o,n),i),o}function _1(i,t){return Wo(i,t,1)}function Qb(i,t,e,n,o){let r=i._x1,s=i._y1,l=i._x2,a=i._y2;if(i._l01_a>Kt){const h=2*i._l01_2a+3*i._l01_a*i._l12_a+i._l12_2a,d=3*i._l01_a*(i._l01_a+i._l12_a);r=(r*h-i._x0*i._l12_2a+i._x2*i._l01_2a)/d,s=(s*h-i._y0*i._l12_2a+i._y2*i._l01_2a)/d}if(i._l23_a>Kt){const h=2*i._l23_2a+3*i._l23_a*i._l12_a+i._l12_2a,d=3*i._l23_a*(i._l23_a+i._l12_a);l=(l*h+i._x1*i._l23_2a-t*i._l12_2a)/d,a=(a*h+i._y1*i._l23_2a-e*i._l12_2a)/d}i.context.bezierCurveTo(r,s,l,a,i._x2,i._y2,n,i.lastPoint1)}class w1{constructor(t,e=.5,n){this.context=t,this.startPoint=n,this._alpha=e}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0}lineEnd(){switch(this._point){case 2:this.context.lineTo(this._x2,this._y2,this._lastDefined1!==!1&&this._lastDefined2!==!1,this.lastPoint1);break;case 3:this.point({x:this._x2,y:this._y2})}(this._line||this._line!==0&&this._point===1)&&this.context.closePath(),this._line=1-this._line}point(t){const{x:e,y:n}=t;if(this._point){const o=this._x2-e,r=this._y2-n;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(o*o+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this.context.lineTo(e,n,this._lastDefined1!==!1&&this._lastDefined2!==!1):this.context.moveTo(e,n);break;case 1:this._point=2;break;case 2:this._point=3;default:Qb(this,e,n,this._lastDefined1!==!1&&this._lastDefined2!==!1)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=n,this._lastDefined1=this._lastDefined2,this._lastDefined2=t.defined,this.lastPoint0=this.lastPoint1,this.lastPoint1=t}tryUpdateLength(){return this.context.tryUpdateLength()}}function tC(i,t){return function(e,n,o={}){const{direction:r,startPoint:s}=o;if(e.length<2-+!!s)return null;if(e.length<3-+!!s)return tl(e,o);const l=Fr(i,r,e),a=new t(l,n,s);return Wo(a,e,2),l}}const y1=tC("catmullRom",w1);class S1{constructor(t,e=.5,n){this.context=t,this.startPoint=n,this._alpha=e}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0}lineEnd(){switch(this._point){case 1:this.context.moveTo(this._x3,this._y3,this.lastPoint1),this.context.closePath();break;case 2:this.context.lineTo(this._x3,this._y3,this._lastDefined1!==!1&&this._lastDefined2!==!1,this.lastPoint1),this.context.closePath();break;case 3:this.point({x:this._x3,y:this._y3}),this.point({x:this._x4,y:this._y4}),this.point({x:this._x5,y:this._y5})}}point(t){const{x:e,y:n}=t;if(this._point){const o=this._x2-e,r=this._y2-n;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(o*o+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=n;break;case 1:this._point=2,this.context.moveTo(this._x4=e,this._y4=n,t);break;case 2:this._point=3,this._x5=e,this._y5=n;break;default:Qb(this,e,n,this._lastDefined1!==!1&&this._lastDefined2!==!1)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=n,this._lastDefined1=this._lastDefined2,this._lastDefined2=t.defined,this.lastPoint0=this.lastPoint1,this.lastPoint1=t}tryUpdateLength(){return this.context.tryUpdateLength()}}const x1=tC("catmullRomClosed",S1);function _o(i,t,e){var n,o;switch(t){case"linear":default:return tl(i,e);case"basis":return d1(i,e);case"monotoneX":return g1(i,e);case"monotoneY":return p1(i,e);case"step":return zd(i,.5,e);case"stepBefore":return zd(i,0,e);case"stepAfter":return zd(i,1,e);case"catmullRom":return y1(i,(n=e==null?void 0:e.curveTension)!==null&&n!==void 0?n:.5,e);case"catmullRomClosed":return x1(i,(o=e==null?void 0:e.curveTension)!==null&&o!==void 0?o:.5,e);case"linearClosed":return C1(i,e)}}class Ae extends qy{constructor(t){super(),this.commandList=[],t&&(this._ctx=t),this._boundsContext=new wg(this.bounds)}setCtx(t){this._ctx=t}moveTo(t,e){return this.commandList.push([Lt.M,t,e]),this._ctx&&this._ctx.moveTo(t,e),this}lineTo(t,e){return this.commandList.push([Lt.L,t,e]),this._ctx&&this._ctx.lineTo(t,e),this}quadraticCurveTo(t,e,n,o){return this.commandList.push([Lt.Q,t,e,n,o]),this._ctx&&this._ctx.quadraticCurveTo(t,e,n,o),this}bezierCurveTo(t,e,n,o,r,s){return this.commandList.push([Lt.C,t,e,n,o,r,s]),this._ctx&&this._ctx.bezierCurveTo(t,e,n,o,r,s),this}arcTo(t,e,n,o,r){return this.commandList.push([Lt.AT,t,e,n,o,r]),this._ctx&&this._ctx.arcTo(t,e,n,o,r),this}ellipse(t,e,n,o,r,s,l,a){return this.commandList.push([Lt.E,t,e,n,o,r,s,l,a]),this._ctx&&this._ctx.ellipse(t,e,n,o,r,s,l,a),this}rect(t,e,n,o){return this.commandList.push([Lt.R,t,e,n,o]),this._ctx&&this._ctx.rect(t,e,n,o),this}arc(t,e,n,o,r,s){return this.commandList.push([Lt.A,t,e,n,o,r,s]),this._ctx&&this._ctx.arc(t,e,n,o,r,s),this}closePath(){return this.commandList.push([Lt.Z]),this._ctx&&this._ctx.closePath(),this}addCurve(t){this.curves.push(t)}clear(){this.transformCbList=null,this.commandList.length=0,this.curves.length=0}beginPath(){this.clear()}toString(){if(!this.toStringCbList){const n=[];n[Lt.M]=o=>`M${o[1]} ${o[2]}`,n[Lt.L]=o=>`L${o[1]} ${o[2]}`,n[Lt.Q]=o=>`Q${o[1]} ${o[2]} ${o[3]} ${o[4]}`,n[Lt.C]=o=>`C${o[1]} ${o[2]} ${o[3]} ${o[4]} ${o[5]} ${o[6]}`,n[Lt.A]=o=>{const r=[];i1(r,o[4],o[5],o[1],o[2],o[3],o[3]);let s="";for(let l=0;l<r.length;l+=6)s+=`C${r[l]} ${r[l+1]} ${r[l+2]} ${r[l+3]} ${r[l+4]} ${r[l+5]}`;return s},n[Lt.R]=o=>`M${o[1]} ${o[2]} h${o[3]} v${o[4]} H${o[1]}Z`,n[Lt.Z]=o=>"Z",this.toStringCbList=n}const t=this.toStringCbList;let e="";return this.commandList.forEach(n=>{e+=t[n[0]](n)}),e}fromString(t,e,n,o,r){this.clear();const s=Qy(t);return this._runCommandStrList(s,e,n,o,r),this._updateBounds(),this}fromLine(t){const{points:e,curveType:n,clipRangeByDimension:o}=t.attribute;if(!e)return;const r=_o(e,n);o==="x"?this.direction=Ut.ROW:o==="y"?this.direction=Ut.COLUMN:o==="auto"&&(this.direction=r.direction),this.curves=r.curves}fromCustomPath2D(t,e,n,o,r){return this.clear(),this._runCommandList(t.commandList,e,n,o,r),this._updateBounds(),this}transform(t,e,n,o){const r=this.commandList;if(!this.transformCbList){const s=[];s[Lt.M]=this.moveToTransform,s[Lt.L]=this.lineToTransform,s[Lt.Q]=this.quadraticCurveToTransform,s[Lt.C]=this.bezierCurveToTransform,s[Lt.AT]=this.arcToTransform,s[Lt.E]=this.ellipseTransform,s[Lt.R]=this.rectTransform,s[Lt.A]=this.arcTransform,s[Lt.Z]=this.closePathTransform,this.transformCbList=s}r.forEach(s=>{this.transformCbList[s[0]](s,t,e,n,o)}),this._updateBounds()}moveToTransform(t,e,n,o,r){t[1]=t[1]*o+e,t[2]=t[2]*r+n}lineToTransform(t,e,n,o,r){t[1]=t[1]*o+e,t[2]=t[2]*r+n}quadraticCurveToTransform(t,e,n,o,r){t[1]=t[1]*o+e,t[2]=t[2]*r+n,t[3]=t[3]*o+e,t[4]=t[4]*r+n}bezierCurveToTransform(t,e,n,o,r){t[1]=t[1]*o+e,t[2]=t[2]*r+n,t[3]=t[3]*o+e,t[4]=t[4]*r+n,t[5]=t[5]*o+e,t[6]=t[6]*r+n}arcToTransform(t,e,n,o,r){t[1]=t[1]*o+e,t[2]=t[2]*r+n,t[3]=t[3]*o+e,t[4]=t[4]*r+n,t[5]=t[5]*(o+r)/2}ellipseTransform(t,e,n,o,r){t[1]=t[1]*o+e,t[2]=t[2]*r+n,t[3]=t[3]*o,t[4]=t[4]*r}rectTransform(t,e,n,o,r){t[1]=t[1]*o+e,t[2]=t[2]*r+n,t[3]=t[3]*o,t[4]=t[4]*r}arcTransform(t,e,n,o,r){t[1]=t[1]*o+e,t[2]=t[2]*r+n,t[3]=t[3]*(o+r)/2}closePathTransform(){}_runCommandStrList(t,e=0,n=0,o=1,r=1){let s,l,a,h,d,u=null,c=0,f=0,g=0,p=0;for(let v=0,m=t.length;v<m;++v){switch(s=t[v],o===1&&r===1||(s=R1(s,o,r)),s[0]){case"l":c+=s[1],f+=s[2],this.lineTo(c+e,f+n);break;case"L":c=s[1],f=s[2],this.lineTo(c+e,f+n);break;case"h":c+=s[1],this.lineTo(c+e,f+n);break;case"H":c=s[1],this.lineTo(c+e,f+n);break;case"v":f+=s[1],this.lineTo(c+e,f+n);break;case"V":f=s[1],this.lineTo(c+e,f+n);break;case"m":c+=s[1],f+=s[2],this.moveTo(c+e,f+n);break;case"M":c=s[1],f=s[2],this.moveTo(c+e,f+n);break;case"c":l=c+s[5],a=f+s[6],g=c+s[3],p=f+s[4],this.bezierCurveTo(c+s[1]+e,f+s[2]+n,g+e,p+n,l+e,a+n),c=l,f=a;break;case"C":c=s[5],f=s[6],g=s[3],p=s[4],this.bezierCurveTo(s[1]+e,s[2]+n,g+e,p+n,c+e,f+n);break;case"s":l=c+s[3],a=f+s[4],g=2*c-g,p=2*f-p,this.bezierCurveTo(g+e,p+n,c+s[1]+e,f+s[2]+n,l+e,a+n),g=c+s[1],p=f+s[2],c=l,f=a;break;case"S":l=s[3],a=s[4],g=2*c-g,p=2*f-p,this.bezierCurveTo(g+e,p+n,s[1]+e,s[2]+n,l+e,a+n),c=l,f=a,g=s[1],p=s[2];break;case"q":l=c+s[3],a=f+s[4],g=c+s[1],p=f+s[2],this.quadraticCurveTo(g+e,p+n,l+e,a+n),c=l,f=a;break;case"Q":l=s[3],a=s[4],this.quadraticCurveTo(s[1]+e,s[2]+n,l+e,a+n),c=l,f=a,g=s[1],p=s[2];break;case"t":l=c+s[1],a=f+s[2],u[0].match(/[QqTt]/)===null?(g=c,p=f):u[0]==="t"?(g=2*c-h,p=2*f-d):u[0]==="q"&&(g=2*c-g,p=2*f-p),h=g,d=p,this.quadraticCurveTo(g+e,p+n,l+e,a+n),c=l,f=a,g=c+s[1],p=f+s[2];break;case"T":l=s[1],a=s[2],g=2*c-g,p=2*f-p,this.quadraticCurveTo(g+e,p+n,l+e,a+n),c=l,f=a;break;case"a":Bf(this,c+e,f+n,[s[1],s[2],s[3],s[4],s[5],s[6]+c+e,s[7]+f+n]),c+=s[6],f+=s[7];break;case"A":Bf(this,c+e,f+n,[s[1],s[2],s[3],s[4],s[5],s[6]+e,s[7]+n]),c=s[6],f=s[7];break;case"z":case"Z":this.closePath()}u=s}}_runCommandList(t,e=0,n=0,o=1,r=1){if(e!==0||n!==0||o!==1||r!==1)for(let s=0,l=t.length;s<l;++s){const a=t[s].slice();switch(a[0]){case Lt.L:this.lineToTransform(a,e,n,o,r);break;case Lt.M:this.moveToTransform(a,e,n,o,r);break;case Lt.C:this.bezierCurveToTransform(a,e,n,o,r);break;case Lt.Q:this.quadraticCurveToTransform(a,e,n,o,r);break;case Lt.A:this.arcToTransform(a,e,n,o,r);break;case Lt.E:this.ellipseTransform(a,e,n,o,r);break;case Lt.R:this.rectTransform(a,e,n,o,r);break;case Lt.AT:this.arcToTransform(a,e,n,o,r);break;case Lt.Z:this.closePath()}}else this.commandList=t.map(s=>s.slice())}_updateBounds(){this.bounds.clear(),Qn(this.commandList,this._boundsContext)}release(){this.commandList=[],this._boundsContext=null,this._ctx=null}getLength(){if(this.direction===Ut.COLUMN){if(!this.curves.length)return 0;const t=this.curves[0],e=this.curves[this.curves.length-1];return Dt(t.p0.y-e.p1.y)}if(this.direction===Ut.ROW){if(!this.curves.length)return 0;const t=this.curves[0],e=this.curves[this.curves.length-1];return Dt(t.p0.x-e.p1.x)}return this.curves.reduce((t,e)=>t+e.getLength(),0)}getAttrAt(t){if(!this.curves)return{pos:{x:0,y:0},angle:0};let e,n=0;for(let r=0;r<this.curves.length;r++){e=this.curves[r];const s=e.getLength(this.direction);if(n+s>=t)break;n+=s}const o=(t-n)/e.getLength(this.direction);return{pos:e.getPointAt(o),angle:e.getAngleAt(o)}}}const pi=["l",0,0,0,0,0,0,0];function R1(i,t,e){const n=pi[0]=i[0];if(n==="a"||n==="A")pi[1]=t*i[1],pi[2]=e*i[2],pi[3]=i[3],pi[4]=i[4],pi[5]=i[5],pi[6]=t*i[6],pi[7]=e*i[7];else if(n==="h"||n==="H")pi[1]=t*i[1];else if(n==="v"||n==="V")pi[1]=e*i[1];else for(let o=1,r=i.length;o<r;++o)pi[o]=(o%2==1?t:e)*i[o];return pi}const A1={alignSelf:"auto"},_e={x:0,y:0,z:0,dx:0,dy:0,dz:0,scrollX:0,scrollY:0,scaleX:1,scaleY:1,scaleZ:1,angle:0,alpha:0,beta:0,scaleCenter:[0,0],anchor:[0,0],anchor3d:[0,0],postMatrix:new Pe},eC={fillOpacity:1,fill:!1,shadowBlur:0,shadowColor:"black",shadowOffsetX:0,shadowOffsetY:0},Id={strokeOpacity:1,lineDash:[],lineDashOffset:0,lineWidth:1,lineCap:"butt",lineJoin:"miter",miterLimit:10,strokeBoundsBuffer:2,stroke:!1},iC=Object.assign({outerBorder:Object.assign(Object.assign({},Id),{distance:0}),innerBorder:Object.assign(Object.assign({},Id),{distance:0})},Id),qe={text:"",maxLineWidth:1/0,maxWidth:1/0,textAlign:"left",textBaseline:"alphabetic",fontSize:16,fontFamily:`PingFang SC,Microsoft Yahei,system-ui,-apple-system,segoe ui,
    Roboto,Helvetica,Arial,sans-serif, apple color emoji,segoe ui emoji,segoe ui symbol`,fontWeight:"",ellipsis:"…",fontVariant:"",fontStyle:"",lineHeight:void 0,underline:0,lineThrough:0,scaleIn3d:!1,direction:"horizontal",wordBreak:"break-all",ignoreBuf:!1,verticalMode:0,wrap:!1,whiteSpace:"no-wrap",heightLimit:1/0,lineClamp:1/0,suffixPosition:"end",underlineDash:[],underlineOffset:0,disableAutoClipedPoptip:void 0,measureMode:xo.fontBounding,keepCenterInLine:!1},B1={pickStrokeBuffer:0},M1=Object.assign(Object.assign(Object.assign(Object.assign({forceBoundsWidth:void 0,forceBoundsHeight:void 0,opacity:1,background:null,backgroundOpacity:1,backgroundCornerRadius:0,texture:null,textureColor:"black",textureSize:10,texturePadding:2,backgroundMode:"no-repeat",backgroundFit:!0,blur:0,cursor:null,html:null,react:null},eC),iC),A1),B1),nC={connectedType:"none",connectedStyle:{},connectedX:NaN,connectedY:NaN},T1={_debug_bounds:!1},re=Object.assign(Object.assign(Object.assign({strokeSeg:null,renderable:!0,pickable:!0,shadowGraphic:void 0,childrenPickable:!0,fillPickable:!0,strokePickable:!0,visible:!0,zIndex:0,layout:null,boundsPadding:0,fillStrokeOrder:0,renderStyle:"default",pickMode:"accurate",customPickShape:null,boundsMode:"accurate",keepDirIn3d:!0,shadowRootIdx:1,globalZIndex:1,globalCompositeOperation:"",overflow:"hidden",shadowPickMode:"graphic",keepStrokeScale:!1},T1),M1),_e),P1=Object.assign(Object.assign({},re),{startAngle:0,endAngle:Vt,innerRadius:0,outerRadius:1,innerPadding:0,outerPadding:0,cornerRadius:0,padRadius:0,padAngle:0,cap:!1,forceShowCap:!1}),H1=Object.assign(Object.assign(Object.assign({},re),nC),{points:[],segments:[],curveType:"linear",clipRange:1,closePath:!1,curveTension:1}),k1=Object.assign(Object.assign({},re),{radius:1,startAngle:0,endAngle:Vt}),E1=Object.assign(Object.assign({},re),{width:0,height:0,cornerRadius:0,path:[],clip:!1,visibleAll:!0,display:"relative",flexDirection:"row",flexWrap:"wrap",justifyContent:"flex-start",alignItems:"flex-start",alignContent:"flex-start",baseOpacity:1}),L1=Object.assign(Object.assign({},re),{path:"",width:0,height:0,cornerRadius:0,clip:!1}),F1=Object.assign(Object.assign(Object.assign({},re),nC),{points:[],segments:[],curveType:"linear",clipRange:1,clipRangeByDimension:"default",closePath:!1,curveTension:1}),z1=Object.assign(Object.assign({},re),{path:new Ae,fillStrokeOrder:1,customPath:()=>{ze.getInstance().warn("空函数")}}),I1=Object.assign(Object.assign({},re),{points:[],cornerRadius:0,closePath:!0}),O1=Object.assign(Object.assign({},re),{width:0,height:0,x1:0,y1:0,strokeBoundsBuffer:0,cornerRadius:0});Object.assign(Object.assign({},re),{width:0,height:0,x1:0,y1:0,cornerRadius:0,length:0});const D1=Object.assign(Object.assign({},re),{symbolType:"circle",size:10,keepDirIn3d:!0}),oC=Object.assign(Object.assign(Object.assign({},re),qe),{strokeBoundsBuffer:0,keepDirIn3d:!0}),vn=Object.assign(Object.assign(Object.assign({},re),qe),{editable:!1,width:300,height:300,ellipsis:!0,wordBreak:"break-word",verticalDirection:"top",textAlign:"left",textBaseline:"top",layoutDirection:"horizontal",textConfig:[],disableAutoWrapLine:!1,maxHeight:void 0,maxWidth:void 0,singleLine:!1}),Ps=Object.assign(Object.assign({repeatX:"no-repeat",repeatY:"no-repeat",image:"",width:0,height:0},re),{fill:!0,cornerRadius:0}),W1=Object.assign(Object.assign({},Ps),{backgroundShowMode:"never",backgroundWidth:0,backgroundHeight:0,textAlign:"left",textBaseline:"middle",direction:"horizontal",margin:0,id:"",width:20,height:20,backgroundFill:"rgba(101, 117, 168, 0.1)",backgroundFillOpacity:1,backgroundStroke:!1,backgroundStrokeOpacity:1,backgroundRadius:4,opacity:1});class N1{}const G=new N1,V1=function(){const i={linearGradient:/^(linear\-gradient)/i,radialGradient:/^(radial\-gradient)/i,conicGradient:/^(conic\-gradient)/i,sideOrCorner:/^to (left (top|bottom)|right (top|bottom)|top (left|right)|bottom (left|right)|left|right|top|bottom)/i,extentKeywords:/^(closest\-side|closest\-corner|farthest\-side|farthest\-corner|contain|cover)/,positionKeywords:/^(left|center|right|top|bottom)/i,pixelValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))px/,percentageValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))\%/,emValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))em/,angleValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,fromAngleValue:/^from\s*(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,startCall:/^\(/,endCall:/^\)/,comma:/^,/,hexColor:/(^\#[0-9a-fA-F]+)/,literalColor:/^([a-zA-Z]+)/,rgbColor:/^(rgb\(\d{1,3},\s*\d{1,3},\s*\d{1,3}\))/i,rgbaColor:/^(rgba\(\d{1,3},\s*\d{1,3},\s*\d{1,3},\s*((\d\.\d+)|\d{1,3})\))/i};let t="";function e(_){const w=new Error(t+": "+_);throw w.source=t,w}function n(){const _=f(o);return t.length>0&&e("Invalid input not EOF"),_}function o(){return r("linear",i.linearGradient,s)||r("radial",i.radialGradient,a)||r("conic",i.conicGradient,l)}function r(_,w,y){return function(x,S){const R=b(x);if(R){b(i.startCall)||e("Missing (");const B=S(R);return b(i.endCall)||e("Missing )"),B}}(w,function(x){const S=y();return S&&(b(i.comma)||e("Missing comma before color stops")),{type:_,orientation:S,colorStops:f(g)}})}function s(){return m("directional",i.sideOrCorner,1)||m("angular",i.angleValue,1)}function l(){return m("angular",i.fromAngleValue,1)}function a(){let _,w,y=h();return y&&(_=[],_.push(y),w=t,b(i.comma)&&(y=h(),y?_.push(y):t=w)),_}function h(){let _=function(){const w=m("shape",/^(circle)/i,0);return w&&(w.style=v()||d()),w}()||function(){const w=m("shape",/^(ellipse)/i,0);return w&&(w.style=p()||d()),w}();if(_)_.at=u();else{const w=d();if(w){_=w;const y=u();y&&(_.at=y)}else{const y=c();y&&(_={type:"default-radial",at:y})}}return _}function d(){return m("extent-keyword",i.extentKeywords,1)}function u(){if(m("position",/^at/,0)){const _=c();return _||e("Missing positioning value"),_}}function c(){const _={x:p(),y:p()};if(_.x||_.y)return{type:"position",value:_}}function f(_){let w=_();const y=[];if(w)for(y.push(w);b(i.comma);)w=_(),w?y.push(w):e("One extra comma");return y}function g(){const _=m("hex",i.hexColor,1)||m("rgba",i.rgbaColor,1)||m("rgb",i.rgbColor,1)||m("literal",i.literalColor,0);return _||e("Expected color definition"),_.length=p(),_}function p(){return m("%",i.percentageValue,1)||m("position-keyword",i.positionKeywords,1)||v()}function v(){return m("px",i.pixelValue,1)||m("em",i.emValue,1)}function m(_,w,y){const x=b(w);if(x)return{type:_,value:x[y]}}function b(_){const w=/^[\n\r\t\s]+/.exec(t);w&&C(w[0].length);const y=_.exec(t);return y&&C(y[0].length),y}function C(_){t=t.substr(_)}return function(_){return t=_.toString(),n()}}();class ir{static IsGradient(t){return!(typeof t=="string"&&!t.includes("gradient"))}static IsGradientStr(t){return typeof t=="string"&&t.includes("gradient")}static Parse(t){if(ir.IsGradientStr(t))try{const e=V1(t)[0];if(e){if(e.type==="linear")return ir.ParseLinear(e);if(e.type==="radial")return ir.ParseRadial(e);if(e.type==="conic")return ir.ParseConic(e)}}catch{return t}return t}static ParseConic(t){const{orientation:e,colorStops:n=[]}=t,o=Xt/2,r=parseFloat(e.value)/180*Xt-o;return{gradient:"conical",x:.5,y:.5,startAngle:r,endAngle:r+Vt,stops:n.map(s=>({color:s.value,offset:parseFloat(s.length.value)/100}))}}static ParseRadial(t){const{colorStops:e=[]}=t;return{gradient:"radial",x0:.5,y0:.5,x1:.5,y1:.5,r0:0,r1:1,stops:e.map(n=>({color:n.value,offset:parseFloat(n.length.value)/100}))}}static ParseLinear(t){const{orientation:e,colorStops:n=[]}=t,o=Xt/2;let r=e.type==="angular"?parseFloat(e.value)/180*Xt:0;for(;r<0;)r+=Vt;for(;r>=Vt;)r-=Vt;let s=0,l=0,a=0,h=0;return r<o?(s=0,l=1,a=Math.sin(r),h=l-Math.cos(r)):r<Xt?(s=0,l=0,a=Math.cos(r-o),h=Math.sin(r-o)):r<Xt+o?(s=1,l=0,a=s-Math.sin(r-Xt),h=Math.cos(r-Xt)):(s=1,a=s-Math.cos(r-o-Xt),h-=Math.sin(r-o-Xt)),{gradient:"linear",x0:s,y0:l,x1:a,y1:h,stops:n.map(d=>({color:d.value,offset:parseFloat(d.length.value)/100}))}}}function Bn(i,t,e){let n=t;const{a:o,b:r,c:s,d:l}=i.currentMatrix,a=Math.sign(o)*Math.sqrt(o*o+r*r),h=Math.sign(l)*Math.sqrt(s*s+l*l);return a+h===0?0:(n=n/Math.abs(a+h)*2*e,n)}function ha(i,t,e,n=0,o=0){if(!t||t===!0)return"black";let r,s;if(Q(t))for(let l=0;l<t.length&&(s=t[l],!s);l++);else s=t;if(s=ir.Parse(s),typeof s=="string")return s;if(e.AABBBounds&&(!e.attribute||e.attribute.scaleX!==0||e.attribute.scaleY!==0)){const l=e.AABBBounds;let a=l.x2-l.x1,h=l.y2-l.y1,d=l.x1-n,u=l.y1-o;if(e.attribute){const{scaleX:c=1,scaleY:f=1}=e.attribute;a/=c,h/=f,d/=c,u/=f}s.gradient==="linear"?r=G1(i,s,d,u,a,h):s.gradient==="conical"?r=U1(i,s,d,u,a,h):s.gradient==="radial"&&(r=j1(i,s,d,u,a,h))}return r||"orange"}function G1(i,t,e,n,o,r){var s,l,a,h;const d=i.createLinearGradient(e+((s=t.x0)!==null&&s!==void 0?s:0)*o,n+((l=t.y0)!==null&&l!==void 0?l:0)*r,e+((a=t.x1)!==null&&a!==void 0?a:1)*o,n+((h=t.y1)!==null&&h!==void 0?h:0)*r);return t.stops.forEach(u=>{d.addColorStop(u.offset,u.color)}),d}function j1(i,t,e,n,o,r){var s,l,a,h,d,u;const c=i.createRadialGradient(e+((s=t.x0)!==null&&s!==void 0?s:.5)*o,n+((l=t.y0)!==null&&l!==void 0?l:.5)*r,Math.max(o,r)*((a=t.r0)!==null&&a!==void 0?a:0),e+((h=t.x1)!==null&&h!==void 0?h:.5)*o,n+((d=t.y1)!==null&&d!==void 0?d:.5)*r,Math.max(o,r)*((u=t.r1)!==null&&u!==void 0?u:.5));return t.stops.forEach(f=>{c.addColorStop(f.offset,f.color)}),c}function U1(i,t,e,n,o,r){var s,l;const a=i.createConicGradient(e+((s=t.x)!==null&&s!==void 0?s:0)*o,n+((l=t.y)!==null&&l!==void 0?l:0)*r,t.startAngle,t.endAngle);return t.stops.forEach(h=>{a.addColorStop(h.offset,h.color)}),a.GetPattern(o+e,r+n,void 0)}const Sg={horizontal:{width:"width",height:"height",left:"left",top:"top",x:"x",y:"y",bottom:"bottom"},vertical:{width:"height",height:"width",left:"top",top:"left",x:"y",y:"x",bottom:"right"}},rC={fill:!0,stroke:!1},da=/\w|\(|\)|-/,sC=/[.?!,;:/，。？！、；：]/,$1=/\S/,lC=(i,t)=>{let e=t.fontSize||16;switch(t.script){case"super":case"sub":e*=.8}i.setTextStyle({textAlign:"left",textBaseline:t.textBaseline||"alphabetic",fontStyle:t.fontStyle||"",fontWeight:t.fontWeight||"",fontSize:e,fontFamily:t.fontFamily})};function K1(i,t,e){const n=t&&t.fill||rC.fill,{fillOpacity:o=1,opacity:r=1}=t;i.globalAlpha=o*r,i.fillStyle=e?ha(i,n,{AABBBounds:e}):n,lC(i,t)}function Y1(i,t){const e=t&&t.stroke||rC.stroke;if(!e)return void(i.globalAlpha=0);const{strokeOpacity:n=1,opacity:o=1}=t;i.globalAlpha=n*o,i.lineWidth=t&&typeof t.lineWidth=="number"?t.lineWidth:1,i.strokeStyle=e,lC(i,t)}function Tu(i,t,e,n,o){if(!t||t<=0)return 0;const r=G.graphicUtil.textMeasure;let s=n,l=i.slice(0,s),a=Math.floor(r.measureText(l,e).width),h=i.slice(0,s+1),d=Math.floor(r.measureText(h,e).width);for(;a>t||d<=t;){if(a>t?s--:s++,s>i.length){s=i.length;break}if(s<0){s=0;break}l=i.slice(0,s),a=Math.floor(r.measureText(l,e).width),h=i.slice(0,s+1),d=Math.floor(r.measureText(h,e).width)}return o&&(s=Zl(i,s)),s}function Zl(i,t,e=!1){let n=t;for(;da.test(i[n-1])&&da.test(i[n])||sC.test(i[n]);)if(n--,n<=0)return e?X1(i,t):t;return n}function X1(i,t){let e=t;for(;da.test(i[e-1])&&da.test(i[e])||sC.test(i[e]);)if(e++,e>=i.length)return e;return e}function nr(i,t){const e=G.graphicUtil.textMeasure.measureText(i,t),n={ascent:0,height:0,descent:0,width:0};return typeof e.actualBoundingBoxAscent!="number"||typeof e.actualBoundingBoxDescent!="number"?(n.width=Math.floor(e.width),n.height=t.fontSize||0,n.ascent=n.height,n.descent=0):(n.width=Math.floor(e.width),n.height=Math.floor(e.actualBoundingBoxAscent+e.actualBoundingBoxDescent),n.ascent=Math.floor(e.actualBoundingBoxAscent),n.descent=n.height-n.ascent),n}var q1=function(i,t,e,n){var o,r=arguments.length,s=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var l=i.length-1;l>=0;l--)(o=i[l])&&(s=(r<3?o(s):r>3?o(t,e,s):o(t,e))||s);return r>3&&s&&Object.defineProperty(t,e,s),s};let Pu=class{configure(i,t){this.canvas=i.canvas,this.context=i.context,i.bindTextMeasure(this)}_measureTextWithoutAlignBaseline(i,t,e){this.context.setTextStyleWithoutAlignBaseline(t);const n=this.context.measureText(i);return e?this.compatibleMetrics(n,t):n}_measureTextWithAlignBaseline(i,t,e){this.context.setTextStyle(t);const n=this.context.measureText(i);return e?this.compatibleMetrics(n,t):n}compatibleMetrics(i,t){if(i.actualBoundingBoxAscent==null||i.actualBoundingBoxDescent==null||i.fontBoundingBoxAscent==null||i.fontBoundingBoxDescent==null){const{ascent:e,descent:n}=this.measureTextBoundADscentEstimate(t);i.actualBoundingBoxAscent=e,i.actualBoundingBoxDescent=n,i.fontBoundingBoxAscent=e,i.fontBoundingBoxDescent=n}if(i.actualBoundingBoxLeft==null||i.actualBoundingBoxRight==null){const{left:e,right:n}=this.measureTextBoundLeftRightEstimate(t);i.actualBoundingBoxLeft=e,i.actualBoundingBoxRight=n}return i}estimate(i,{fontSize:t=oC.fontSize}){let e=0,n=0;for(let o=0;o<i.length;o++)i.charCodeAt(o)<128?e++:n++;return{width:~~(.8*e*t+n*t),height:t}}measureTextWidth(i,t,e){return this.context?(e=e??this._measureTextWithoutAlignBaseline(i,t)).width:this.estimate(i,t).width}measureTextBoundsWidth(i,t,e){return this.context?(e=e??this._measureTextWithoutAlignBaseline(i,t)).width:this.estimate(i,t).width}measureTextBoundsLeftRight(i,t,e){return this.context?{left:(e=e??this._measureTextWithAlignBaseline(i,t,!0)).actualBoundingBoxLeft,right:e.actualBoundingBoxRight}:this.measureTextBoundLeftRightEstimate(t)}measureTextPixelHeight(i,t,e){var n;return this.context?(e=e??this._measureTextWithoutAlignBaseline(i,t,!0),Math.abs(e.actualBoundingBoxAscent-e.actualBoundingBoxDescent)):(n=t.fontSize)!==null&&n!==void 0?n:qe.fontSize}measureTextPixelADscent(i,t,e){return this.context?{ascent:(e=e??this._measureTextWithAlignBaseline(i,t,!0)).actualBoundingBoxAscent,descent:e.actualBoundingBoxDescent}:this.measureTextBoundADscentEstimate(t)}measureTextBoundHieght(i,t,e){var n;return this.context?(e=e??this._measureTextWithoutAlignBaseline(i,t,!0),Math.abs(e.fontBoundingBoxAscent-e.fontBoundingBoxDescent)):(n=t.fontSize)!==null&&n!==void 0?n:qe.fontSize}measureTextBoundADscent(i,t,e){return this.context?{ascent:(e=e??this._measureTextWithAlignBaseline(i,t,!0)).fontBoundingBoxAscent,descent:e.fontBoundingBoxDescent}:this.measureTextBoundADscentEstimate(t)}measureTextBoundADscentEstimate(i){var t;const e=(t=i.fontSize)!==null&&t!==void 0?t:qe.fontSize;return{ascent:.79*e,descent:.21*e}}measureTextBoundLeftRightEstimate(i){var t;const e=(t=i.fontSize)!==null&&t!==void 0?t:qe.fontSize,{textAlign:n}=i;return n==="center"?{left:e/2,right:e/2}:n==="right"||n==="end"?{left:e,right:0}:{left:0,right:e}}measureTextPixelADscentAndWidth(i,t,e){if(!this.context)return Object.assign(Object.assign({},this.measureTextBoundADscentEstimate(t)),{width:this.estimate(i,t).width});const n=this._measureTextWithoutAlignBaseline(i,t,!0);if(e===xo.actualBounding)return{ascent:n.actualBoundingBoxAscent,descent:n.actualBoundingBoxDescent,width:n.width};if(e===xo.estimate)return Object.assign(Object.assign({},this.measureTextBoundADscentEstimate(t)),{width:n.width});if(e===xo.fontBounding){let o=n.fontBoundingBoxAscent,r=n.fontBoundingBoxDescent;if(n.actualBoundingBoxDescent&&r<n.actualBoundingBoxDescent){const s=n.actualBoundingBoxDescent-r;r+=s,o-=s}else if(n.actualBoundingBoxAscent&&o<n.actualBoundingBoxAscent){const s=n.actualBoundingBoxAscent-o;o+=s,r-=s}return{ascent:o,descent:r,width:n.width}}return{ascent:n.actualBoundingBoxAscent,descent:n.actualBoundingBoxDescent,width:n.width}}measureText(i,t){return this.context?(this.context.setTextStyleWithoutAlignBaseline(t),this.context.measureText(i)):this.estimate(i,t)}clipTextVertical(i,t,e,n){if(i.length===0)return{verticalList:i,width:0};const{fontSize:o=12}=t;i.forEach(a=>{a.width=a.direction===0?o:this.measureTextWidth(a.text,t)});const r=[];let s=0,l=0;for(;l<i.length&&s+i[l].width<e;l++)s+=i[l].width,r.push(i[l]);if(i[l]&&i[l].text.length>1){const a=this._clipText(i[l].text,t,e-s,0,i[l].text.length-1,"end",!1);if(n&&a.str!==i[l].text){let h="",d=0;for(let f=0;f<l;f++){const g=i[f];h+=g.text,d+=g.text.length}h+=i[l].text;const u=d+a.str.length;let c=Zl(h,u);c-=d,c!==a.str.length-1&&(a.str=a.str.substring(0,c),a.width=this.measureTextWidth(a.str,t))}r.push(Object.assign(Object.assign({},i[l]),{text:a.str,width:a.width})),s+=a.width}return{verticalList:r,width:s}}clipText(i,t,e,n,o){if(i.length===0)return{str:"",width:0};let r=this.measureTextWidth(i,t);if(r<=e)return{str:i,width:r};if(r=this.measureTextWidth(i[0],t),r>e)return{str:"",width:0};const s=this._clipText(i,t,e,0,i.length-1,"end",!1);if(n&&s.str!==i){let l=Zl(i,s.str.length,o);l!==s.str.length&&(l>s.str.length&&(s.wordBreaked=l,l=s.str.length),s.str=i.substring(0,l),s.width=this.measureTextWidth(s.str,t))}return s}_clipText(i,t,e,n,o,r,s){let l;if(r==="start")l=this._clipTextStart(i,t,e,n,o),s&&(l.result=s+l.str);else if(r==="middle"){const a=this._clipTextMiddle(i,t,e,"","",0,0,1);l={str:"none",width:a.width,result:a.left+s+a.right}}else l=this._clipTextEnd(i,t,e,n,o),s&&(l.result=l.str+s);return l}_clipTextEnd(i,t,e,n,o){if(n===o){ze.getInstance().warn(`【_clipTextEnd】不应该走到这里${i}, ${n}, ${o}`);const h=i.substring(0,o+1);return{str:h,width:this.measureTextWidth(h,t)}}const r=Math.floor((n+o)/2),s=i.substring(0,r+1),l=this.measureTextWidth(s,t);let a;if(l>e){if(s.length<=1)return{str:"",width:0};const h=i.substring(0,r);return a=this.measureTextWidth(h,t),a<=e?{str:h,width:a}:this._clipTextEnd(i,t,e,n,r)}if(l<e){if(r>=i.length-1)return{str:i,width:this.measureTextWidth(i,t)};const h=i.substring(0,r+2);return a=this.measureTextWidth(h,t),a>=e?{str:s,width:l}:this._clipTextEnd(i,t,e,r,o)}return{str:s,width:l}}_clipTextStart(i,t,e,n,o){const r=Math.ceil((n+o)/2),s=i.substring(r-1,i.length),l=this.measureTextWidth(s,t);let a;if(l>e){if(s.length<=1)return{str:"",width:0};const h=i.substring(r,i.length);return a=this.measureTextWidth(h,t),a<=e?{str:h,width:a}:this._clipTextStart(i,t,e,r,i.length)}if(l<e){if(r<=0)return{str:i,width:this.measureTextWidth(i,t)};const h=i.substring(r-2,i.length);return a=this.measureTextWidth(h,t),a>=e?{str:s,width:l}:this._clipTextStart(i,t,e,n,r)}return{str:s,width:l}}_clipTextMiddle(i,t,e,n,o,r,s,l){const a=i.substring(0,l),h=this.measureTextWidth(a,t);if(h+s>e)return{left:n,right:o,width:r+s};const d=i.substring(i.length-l,i.length),u=this.measureTextWidth(d,t);return h+u>e?{left:a,right:o,width:h+s}:this._clipTextMiddle(i,t,e,a,d,h,u,l+1)}clipTextWithSuffixVertical(i,t,e,n,o,r){if(n==="")return this.clipTextVertical(i,t,e,o);if(i.length===0)return{verticalList:i,width:0};const s=this.clipTextVertical(i,t,e,o);if(s.verticalList.length===i.length&&s.verticalList[s.verticalList.length-1].width===i[i.length-1].width)return s;const l=this.measureTextWidth(n,t);if(l>e)return s;let a;if(e-=l,r==="start"){const h=this.revertVerticalList(i);a=this.clipTextVertical(h,t,e,o);const d=this.revertVerticalList(a.verticalList);d.unshift({text:n,direction:1,width:l}),a.verticalList=d}else if(r==="middle"){const h=this.clipTextVertical(i,t,e/2,o),d=this.revertVerticalList(i),u=this.clipTextVertical(d,t,e/2,o);h.verticalList.push({text:n,direction:1,width:l}),this.revertVerticalList(u.verticalList).forEach(c=>h.verticalList.push(c)),a={verticalList:h.verticalList,width:h.width+u.width}}else a=this.clipTextVertical(i,t,e,o),a.verticalList.push({text:n,direction:1,width:l});return a.width+=l,a}revertVerticalList(i){return i.reverse().map(t=>{const e=t.text.split("").reverse().join("");return Object.assign(Object.assign({},t),{text:e})})}clipTextWithSuffix(i,t,e,n,o,r,s=!1){if(n==="")return this.clipText(i,t,e,o);if(i.length===0)return{str:"",width:0};const l=this.measureTextWidth(i,t);if(!s&&l<=e)return{str:i,width:l};const a=this.measureTextWidth(n,t);if(a>e)return{str:"",width:0};if(s&&l+a<=e)return{str:i+n,width:l+a};e-=a;const h=this._clipText(i,t,e,0,i.length-1,r,n);if(o&&h.str!==i){const d=Zl(i,h.str.length);d!==h.str.length&&(h.result=i.substring(0,d),h.width=this.measureTextWidth(h.str,t))}else s&&h.str===i&&(h.result=i+n);return h.str=h.result,h.width+=a,h}};Pu=q1([st()],Pu);var Z1=function(i,t,e,n){var o,r=arguments.length,s=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var l=i.length-1;l>=0;l--)(o=i[l])&&(s=(r<3?o(s):r>3?o(t,e,s):o(t,e))||s);return r>3&&s&&Object.defineProperty(t,e,s),s};const yn=Symbol.for("TextMeasureContribution");let wr=class extends Pu{};wr=Z1([st()],wr);const bt=new Gy,aC=Symbol.for("CanvasFactory"),J1=Symbol.for("Context2dFactory");function Hu(i){return bt.getNamed(aC,G.global.env)(i)}class Q1{constructor(){this.pools=[],this.allocatedCanvas=[]}shareCanvas(){return this.allocatedCanvas.length?this.allocatedCanvas[0]:this.getCommonCanvas()}getCommonCanvas(){return this._commonCanvas||(this._commonCanvas=this.allocate({width:100,height:100,dpr:2})),this._commonCanvas}allocate(t){if(!this.pools.length){const n=Hu(Object.assign({nativeCanvas:G.global.createCanvas(t)},t));return this.allocatedCanvas.push(n),n}const e=this.pools.pop();return e.resize(t.width,t.height),e.dpr=t.dpr,e}allocateByObj(t){if(!this.pools.length){const n={width:t.width/t.dpr,height:t.height/t.dpr,dpr:t.dpr},o=Hu(Object.assign({nativeCanvas:G.global.createCanvas(n)},n));return this.allocatedCanvas.push(o),o}const e=this.pools.pop();return e.width=t.width,e.height=t.height,e}free(t){this.pools.push(t)}get length(){return this.pools.length}release(...t){this.pools=[]}}const yr=new Q1;var tS=function(i,t,e,n){var o,r=arguments.length,s=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var l=i.length-1;l>=0;l--)(o=i[l])&&(s=(r<3?o(s):r>3?o(t,e,s):o(t,e))||s);return r>3&&s&&Object.defineProperty(t,e,s),s},eS=function(i,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,t)};const Hs=Symbol.for("VWindow"),xg=Symbol.for("WindowHandlerContribution");let ku=class{get width(){if(this._handler){const i=this._handler.getWH();return this._width=i.width}return this._width}get height(){if(this._handler){const i=this._handler.getWH();return this._height=i.height}return this._height}get dpr(){return this._handler.getDpr()}constructor(){this.hooks={onChange:new Xe(["x","y","width","height"])},this.active=()=>{const i=this.global;!i.env||this.actived||(bt.getNamed(xg,i.env).configure(this,i),this.actived=!0)},this._uid=fe.GenAutoIncrementId(),this.global=G.global,this.postInit()}postInit(){this.global.hooks.onSetEnv.tap("window",this.active),this.active()}get style(){var i;return(i=this._handler.getStyle())!==null&&i!==void 0?i:{}}set style(i){this._handler.setStyle(i)}create(i){var t,e;this._handler.createWindow(i);const n=this._handler.getWH();this._width=n.width,this._height=n.height,i.viewBox?this.setViewBox(i.viewBox):i.canvasControled!==!1?this.setViewBox({x1:0,y1:0,x2:this._width,y2:this._height}):this.setViewBox({x1:0,y1:0,x2:(t=i.width)!==null&&t!==void 0?t:this._width,y2:(e=i.height)!==null&&e!==void 0?e:this._height}),this.title=this._handler.getTitle(),this.resizable=!0}setWindowHandler(i){this._handler=i}setDpr(i){return this._handler.setDpr(i)}resize(i,t){return this._handler.resizeWindow(i,t)}configure(){throw new Error("暂不支持")}release(){return this.global.hooks.onSetEnv.unTap("window",this.active),this._handler.releaseWindow()}getContext(){return this._handler.getContext()}getNativeHandler(){return this._handler.getNativeHandler()}getImageBuffer(i){return this._handler.getImageBuffer?this._handler.getImageBuffer(i):null}addEventListener(i,t,e){return this._handler.addEventListener(i,t,e)}removeEventListener(i,t,e){return this._handler.removeEventListener(i,t,e)}dispatchEvent(i){return this._handler.dispatchEvent(i)}getBoundingClientRect(){return this._handler.getBoundingClientRect()}getContainer(){return this._handler.container}clearViewBox(i){this._handler.clearViewBox(i)}setViewBox(i){this._handler.setViewBox(i)}setViewBoxTransform(i,t,e,n,o,r){this._handler.setViewBoxTransform(i,t,e,n,o,r)}getViewBox(){return this._handler.getViewBox()}getViewBoxTransform(){return this._handler.getViewBoxTransform()}pointTransform(i,t){const e=this._handler.getViewBox(),n={x:i,y:t};return this._handler.getViewBoxTransform().transformPoint({x:i,y:t},n),n.x-=e.x1,n.y-=e.y1,n}hasSubView(){const i=this._handler.getViewBox();return!(i.x1===0&&i.y1===0&&Cn(this.width,i.width())&&Cn(this.height,i.height()))}isVisible(i){return this._handler.isVisible(i)}onVisibleChange(i){return this._handler.onVisibleChange(i)}getTopLeft(i){return this._handler.getTopLeft(i)}};ku=tS([st(),eS("design:paramtypes",[])],ku);var hC=function(i,t,e,n){var o,r=arguments.length,s=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var l=i.length-1;l>=0;l--)(o=i[l])&&(s=(r<3?o(s):r>3?o(t,e,s):o(t,e))||s);return r>3&&s&&Object.defineProperty(t,e,s),s},dC=function(i,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,t)},Lf=function(i,t){return function(e,n){t(e,n,i)}};let Eu=class{get canvas(){return this.tryInitCanvas(),this._canvas}get context(){return this.tryInitCanvas(),this._context}constructor(i){this.contributions=i,this.configured=!1,this.global=G.global,this.global.hooks.onSetEnv.tap("graphic-util",(t,e,n)=>{this.configured=!1,this.configure(n,e)})}get textMeasure(){return this._textMeasure||this.configure(this.global,this.global.env),this._textMeasure}configure(i,t){this.configured||(this.contributions.getContributions().forEach(e=>{e.configure(this,t)}),this.configured=!0)}tryInitCanvas(){if(!this._canvas){const i=yr.shareCanvas();this._canvas=i,this._context=i.getContext("2d")}}bindTextMeasure(i){this._textMeasure=i}measureText(i,t,e="native"){var n;this.configure(this.global,this.global.env);const o=this.global.measureTextMethod;this.global.measureTextMethod=e;const r={width:this._textMeasure.measureTextWidth(i,t),height:(n=t.fontSize)!==null&&n!==void 0?n:qe.fontSize};return this.global.measureTextMethod=o,r}createTextMeasureInstance(i,t,e){return this.configure(this.global,this.global.env),new wn(Object.assign({defaultFontParams:{fontFamily:qe.fontFamily,fontSize:qe.fontSize},getCanvasForMeasure:e||(()=>this.canvas),getTextBounds:void 0,specialCharSet:`-/: .,@%'"~`+wn.ALPHABET_CHAR_SET+wn.ALPHABET_CHAR_SET.toUpperCase()},t??{}),i)}drawGraphicToCanvas(i,t,e){if(!t.defaultLayer)return null;const n=bt.get(Hs),o=i.AABBBounds,r=o.width(),s=o.height(),l=-o.x1,a=-o.y1;n.create({viewBox:{x1:l,y1:a,x2:o.x2,y2:o.y2},width:r,height:s,canvas:e,dpr:t.window.dpr,canvasControled:!0,offscreen:!0,title:""});const h=t.params.optimize.disableCheckGraphicWidthOutRange;t.params.optimize.disableCheckGraphicWidthOutRange=!0,t.defaultLayer.getNativeHandler().drawTo(n,[i],{transMatrix:n.getViewBoxTransform(),viewBox:n.getViewBox(),stage:t,layer:t.defaultLayer,renderService:t.renderService,background:"transparent",clear:!0,updateBounds:!1}),t.params.optimize.disableCheckGraphicWidthOutRange=h;const d=n.getNativeHandler();return d.nativeCanvas?d.nativeCanvas:null}};Eu=hC([st(),Lf(0,At(ge)),Lf(0,Re(yn)),dC("design:paramtypes",[Object])],Eu);var Wn;(function(i){i[i.transform=0]="transform",i[i.matrix=1]="matrix"})(Wn||(Wn={}));const ue=new Pe;let Lu=class{constructor(){this.matrix=new Pe}init(i){return this.mode=Wn.transform,this.originTransform=i,this.matrix.reset(),this}fromMatrix(i,t){return this.mode=Wn.matrix,this.outSourceMatrix=i,this.outTargetMatrix=t,this}scaleMatrix(i,t,e){const n=this.outSourceMatrix;if(ue.setValue(n.a,n.b,n.c,n.d,n.e,n.f),this.outTargetMatrix.reset(),e){const{x:o,y:r}=e;this.outTargetMatrix.translate(o,r),this.outTargetMatrix.scale(i,t),this.outTargetMatrix.translate(-o,-r)}else this.outTargetMatrix.scale(i,t);return this.outTargetMatrix.multiply(ue.a,ue.b,ue.c,ue.d,ue.e,ue.f),this}rotateMatrix(i,t){const e=this.outSourceMatrix;if(ue.setValue(e.a,e.b,e.c,e.d,e.e,e.f),this.outTargetMatrix.reset(),t){const{x:n,y:o}=t;this.outTargetMatrix.translate(n,o),this.outTargetMatrix.rotate(i),this.outTargetMatrix.translate(-n,-o)}else this.outTargetMatrix.rotate(i);return this.outTargetMatrix.multiply(ue.a,ue.b,ue.c,ue.d,ue.e,ue.f),this}scale(i,t,e){return this.mode===Wn.matrix?this.scaleMatrix(i,t,e):this}rotate(i,t){return this.mode===Wn.matrix?this.rotateMatrix(i,t):this}translateMatrix(i,t){const e=this.outSourceMatrix;return ue.setValue(e.a,e.b,e.c,e.d,e.e,e.f),this.outTargetMatrix.reset(),this.outTargetMatrix.translate(i,t),this.outTargetMatrix.multiply(ue.a,ue.b,ue.c,ue.d,ue.e,ue.f),this}translate(i,t){return this.mode===Wn.matrix?this.translateMatrix(i,t):this}simplify(i){return this.mode===Wn.matrix?this.simplifyMatrix(i):this}simplifyMatrix(i){return this}};Lu=hC([st(),dC("design:paramtypes",[])],Lu);const We={arc:P1,area:H1,circle:k1,line:F1,path:z1,symbol:D1,text:oC,rect:O1,polygon:I1,richtext:vn,richtextIcon:W1,image:Ps,group:E1,glyph:L1},Od=Object.keys(We);function iS(){return{arc:Object.assign({},We.arc),area:Object.assign({},We.area),circle:Object.assign({},We.circle),line:Object.assign({},We.line),path:Object.assign({},We.path),symbol:Object.assign({},We.symbol),text:Object.assign({},We.text),rect:Object.assign({},We.rect),polygon:Object.assign({},We.polygon),richtext:Object.assign({},We.richtext),richtextIcon:Object.assign({},We.richtextIcon),image:Object.assign({},We.image),group:Object.assign({},We.group),glyph:Object.assign({},We.glyph)}}function yl(i,t){Object.keys(t).forEach(e=>{i[e]=t[e]})}const Ff=iS();class ks{constructor(){this.initTheme(),this.dirty=!1}initTheme(){this._defaultTheme={},Od.forEach(t=>{this._defaultTheme[t]=Object.create(Ff[t])}),this.combinedTheme=this._defaultTheme}getTheme(t){if(!t)return this.combinedTheme;if(!this.dirty)return this.combinedTheme;let e={};const n=this.getParentWithTheme(t);return n&&(e=n.theme),this.applyTheme(t,e),this.combinedTheme}getParentWithTheme(t){for(;t.parent;)if((t=t.parent).theme)return t;return null}applyTheme(t,e,n=!1){if(this.dirty){const o=this.getParentWithTheme(t);if(o){const r=o.theme;(r.dirty||n)&&r.applyTheme(o,e,!0)}this.userTheme?this.doCombine(o&&o.theme.combinedTheme):(o?this.combinedTheme=o.theme.combinedTheme:(this.combinedTheme=this._defaultTheme,ze.getInstance().warn("未知错误，走到不应该走的区域里")),this.dirty=!1)}return this.combinedTheme}doCombine(t){const e=this.userTheme,n=this.combinedTheme;Od.forEach(o=>{const r=Object.create(Ff[o]);t&&t[o]&&yl(r,t[o]),n[o]&&yl(r,n[o]),e[o]&&yl(r,e[o]),this.combinedTheme[o]=r}),e.common&&Od.forEach(o=>{yl(this.combinedTheme[o],e.common)}),this.dirty=!1}setTheme(t,e){let n=this.userTheme;n?Object.keys(t).forEach(o=>{n[o]?Object.assign(n[o],t[o]):n[o]=Object.assign({},t[o])}):n=t,this.userTheme=n,this.dirty=!0,this.dirtyChildren(e)}resetTheme(t,e){this.userTheme=t,this.dirty=!0,this.dirtyChildren(e)}dirtyChildren(t){t.forEachChildren(e=>{e.isContainer&&(e.theme&&(e.theme.dirty=!0),this.dirtyChildren(e))})}}const uC=new ks;function yt(i,t){return i.glyphHost?yt(i.glyphHost):t?(i.isContainer,t):nS(i)||i.attachedThemeGraphic&&yt(i.attachedThemeGraphic)||uC.getTheme()}function nS(i){let t;if(t=i.isContainer?i:i.parent,t){for(;t&&!t.theme;)t=t.parent;return t?(t.theme||t.createTheme(),t.theme.getTheme(t)):uC.getTheme()}return null}var oS=function(i,t,e,n){return new(e||(e=Promise))(function(o,r){function s(h){try{a(n.next(h))}catch(d){r(d)}}function l(h){try{a(n.throw(h))}catch(d){r(d)}}function a(h){var d;h.done?o(h.value):(d=h.value,d instanceof e?d:new e(function(u){u(d)})).then(s,l)}a((n=n.apply(i,t||[])).next())})};class rS extends Lr{get previousSibling(){return this._prev}get nextSibling(){return this._next}get children(){return this.getChildren()}get firstChild(){return this._firstChild}get lastChild(){return this._lastChild}get count(){return this._count}get childrenCount(){return this._idMap?this._idMap.size:0}constructor(){super(),this._uid=fe.GenAutoIncrementId(),this._firstChild=null,this._lastChild=null,this.parent=null,this._count=1}forEachChildren(t,e=!1){if(e){let n=this._lastChild,o=0;for(;n;){if(t(n,o++))return;n=n._prev}}else{let n=this._firstChild,o=0;for(;n;){if(t(n,o++))return;n=n._next}}}forEachChildrenAsync(t,e=!1){return oS(this,void 0,void 0,function*(){if(e){let n=this._lastChild,o=0;for(;n;){let r=t(n,o++);if(r.then&&(r=yield r),r)return;n=n._prev}}else{let n=this._firstChild,o=0;for(;n;){let r=t(n,o++);if(r.then&&(r=yield r),r)return;n=n._next}}})}forEach(t){return this.forEachChildren(t)}appendChild(t,e=!0){if(this._uid===t._uid)return null;if(!e&&t.isAncestorsOf(this))throw new Error("【Node::appendChild】不能将父辈元素append为子元素");return t.parent&&t.parent.removeChild(t),t.parent=this,this._lastChild?(this._lastChild._next=t,t._prev=this._lastChild,this._lastChild=t):(this._firstChild=this._lastChild=t,t._prev=t._next=null),this._idMap||(this._idMap=new Map),this._idMap.set(t._uid,t),this.setCount(t.count),this._structEdit=!0,t}appendChildArrHighPerformance(t,e=!1){return console.error("暂不支持该函数"),t}insertBefore(t,e){if(!e)return this.appendChild(t);if(this===t||t===e)return null;if(t.isAncestorsOf(this))throw new Error("【Node::insertBefore】不能将父辈元素insert为子元素");return e.parent!==this?null:(t.parent&&t.parent.removeChild(t),t.parent=this,t._prev=e._prev,e._prev?e._prev._next=t:this._firstChild=t,e._prev=t,t._next=e,this._idMap||(this._idMap=new Map),this._idMap.set(t._uid,t),this._structEdit=!0,this.setCount(t.count),t)}insertAfter(t,e){if(!e)return this.appendChild(t);if(this===t||t===e)return null;if(t.isAncestorsOf(this))throw new Error("【Node::insertAfter】不能将父辈元素insert为子元素");return e.parent!==this?null:(t.parent&&t.parent.removeChild(t),t.parent=this,e._next?(e._next._prev=t,t._next=e._next):this._lastChild=t,e._next=t,t._prev=e,this._idMap||(this._idMap=new Map),this._idMap.set(t._uid,t),this._structEdit=!0,this.setCount(t.count),t)}insertInto(t,e){if(!this._ignoreWarn&&this._nodeList&&ze.getInstance().warn("insertIntoKeepIdx和insertInto混用可能会存在错误"),e>=this.childrenCount)return this.appendChild(t);if(this===t)return null;if(t.isAncestorsOf(this))throw new Error("【Node::insertBefore】不能将父辈元素insert为子元素");if(t.parent&&t.parent.removeChild(t),t.parent=this,e===0)t._next=this._firstChild,this._firstChild&&(this._firstChild._prev=t),t._prev=null,this._firstChild=t;else{let n=this._firstChild;for(let o=0;o<e;o++){if(!n)return null;o>0&&(n=n._next)}if(!n)return null;t._next=n._next,t._prev=n,n._next=t,t._next&&(t._next._prev=t)}return this._idMap||(this._idMap=new Map),this._idMap.set(t._uid,t),this._structEdit=!0,this.setCount(t.count),t}insertIntoKeepIdx(t,e){if(this._nodeList||(this._nodeList=this.children),this._nodeList[e]){const r=this._nodeList[e];return this._nodeList.splice(e,0,t),this.insertBefore(t,r)}let n;this._nodeList[e]=t;for(let r=e-1;r>=0&&(n=this._nodeList[r],!n);r--);if(n)return n._next?this.insertBefore(t,n._next):this.appendChild(t);this._ignoreWarn=!0;const o=this.insertInto(t,0);return this._ignoreWarn=!1,o}removeChild(t){if(!this._idMap||!this._idMap.has(t._uid))return null;if(this._idMap.delete(t._uid),this._nodeList){const e=this._nodeList.findIndex(n=>n===t);e>=0&&this._nodeList.splice(e,1)}return t._prev?t._prev._next=t._next:this._firstChild=t._next,t._next?t._next._prev=t._prev:this._lastChild=t._prev,t.parent=null,t._prev=null,t._next=null,this._structEdit=!0,this.setCount(-t.count),t}delete(){this.parent&&this.parent.removeChild(this)}removeAllChild(t){if(!this._idMap)return;this._nodeList&&(this._nodeList.length=0);let e=this._firstChild;for(;e;){const n=e._next;e.parent=null,e._prev=null,e._next=null,e=e._next,e=n}this._firstChild=null,this._lastChild=null,this._idMap.clear(),this._structEdit=!0,this.setCount(1-this._count)}replaceChild(t,e){throw new Error("暂不支持")}find(t,e=!1){let n=null;return this.forEachChildren((o,r)=>!(o===this||!t(o,r))&&(n=o,!0)),e&&this.forEachChildren(o=>{if(o.isContainer){const r=o.find(t,!0);if(r)return n=r,!0}return!1}),n}findAll(t,e=!1){let n=[];return this.forEachChildren((o,r)=>{o!==this&&t(o,r)&&n.push(o)}),e&&this.forEachChildren(o=>{if(o.isContainer){const r=o.findAll(t,!0);r.length&&(n=n.concat(r))}}),n}getElementById(t){return this.find(e=>e.id===t,!0)}findChildById(t){return this.getElementById(t)}findChildByUid(t){return this._idMap&&this._idMap.get(t)||null}getElementsByName(t){return this.findAll(e=>e.name===t,!0)}findChildrenByName(t){return this.getElementsByName(t)}getElementsByType(t){return this.findAll(e=>e.type===t,!0)}getChildByName(t,e=!1){return this.find(n=>n.name===t,e)}getChildAt(t){let e=this._firstChild;if(!e)return null;for(let n=0;n<t;n++){if(!e._next)return null;e=e._next}return e}at(t){return this.getChildAt(t)}containNode(t){if(!this._idMap)return!1;if(this._idMap.has(t._uid))return!0;let e=this._firstChild;for(;e;){if(e.containNode(t))return!0;e=e._next}return!1}getRootNode(){let t=this.parent;for(;t!=null&&t.parent;)t=t.parent;return t||this}hasChildNodes(){return this._firstChild!==null}addChild(t){return this.appendChild(t)}add(t){return this.appendChild(t)}getChildren(){const t=[];let e=this._firstChild;for(;e;)t.push(e),e=e._next;return t}isChildOf(t){return!!this.parent&&this.parent._uid===t._uid}isParentOf(t){return t.isChildOf(this)}isDescendantsOf(t){let e=this.parent;if(!e)return!1;do{if(e._uid===t._uid)return!0;e=e.parent}while(e!==null);return!1}isAncestorsOf(t){return t.isDescendantsOf(this)}getAncestor(t){throw new Error("暂不支持")}setAllDescendantsProps(t,e){let n=this._firstChild;for(;n;)n[t]=e,n.setAllDescendantsProps(t,e),n=n._next}setCount(t){this._count+=t;let e=this.parent;if(e)do e._count+=t,e=e.parent;while(e!==null)}clone(){throw new Error("暂不支持")}cloneTo(t){throw new Error("暂不支持")}getParent(){return this.parent}del(t){return this.removeChild(t)}addEventListener(t,e,n){const o=He(n,!0)&&n||kt(n)&&n.capture,r=kt(n)&&n.once,s=Mt(e)?void 0:e;return t=o?`${t}capture`:t,e=Mt(e)?e:e.handleEvent,r?super.once(t,e,s):super.on(t,e,s),this}on(t,e,n){return this.addEventListener(t,e,n)}removeEventListener(t,e,n){const o=He(n,!0)&&n||kt(n)&&n.capture,r=Mt(e)?void 0:e;t=o?`${t}capture`:t,e=Mt(e)?e:e.handleEvent;const s=kt(n)&&n.once;return super.off(t,e,r,s),this}off(t,e,n){return this.removeEventListener(t,e,n)}once(t,e,n){return kt(n)?(n.once=!0,this.addEventListener(t,e,n)):this.addEventListener(t,e,{once:!0})}removeAllEventListeners(){return super.removeAllListeners(),this}removeAllListeners(){return this.removeAllEventListeners()}dispatchEvent(t,...e){return super.emit(t.type,t,...e),!t.defaultPrevented}emit(t,e){return this.dispatchEvent(t,e)}release(){this.removeAllListeners()}}class el{get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get x(){return this.canvas.x}get y(){return this.canvas.y}get canvasX(){return this.canvas.x}get canvasY(){return this.canvas.y}get viewX(){return this.viewport.x}get viewY(){return this.viewport.y}constructor(t){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=el.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer={x:0,y:0},this.page={x:0,y:0},this.canvas={x:0,y:0},this.viewport={x:0,y:0},this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=t}composedPath(){return!this.manager||this.path&&this.path[this.path.length-1]===this.target||(this.path=this.target?this.manager.propagationPath(this.target):[]),this.composedDetailPath(),this.path}composedDetailPath(){return this.pickParams&&this.pickParams.graphic?(this.detailPath=this.path.slice(),this._composedDetailPath(this.pickParams)):this.detailPath=this.path.slice(),this.detailPath}_composedDetailPath(t){if(t&&t.graphic){const e=this.pickParams.graphic;if(e.stage){const n=e.stage.eventSystem.manager.propagationPath(e);this.detailPath.push(n),this._composedDetailPath(t.params)}}}preventDefault(){try{this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault()}catch{this.nativeEvent.preventDefault&&Mt(this.nativeEvent.preventDefault)&&this.nativeEvent.preventDefault()}this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){try{this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.stopPropagation()}catch{this.nativeEvent.stopPropagation&&Mt(this.nativeEvent.stopPropagation)&&this.nativeEvent.stopPropagation()}this.propagationStopped=!0}initEvent(){}initUIEvent(){}clone(){throw new Error("Method not implemented.")}}class ua extends el{constructor(){super(...arguments),this.client={x:0,y:0},this.movement={x:0,y:0},this.offset={x:0,y:0},this.global={x:0,y:0},this.screen={x:0,y:0}}get clientX(){return this.client.x}get clientY(){return this.client.y}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getModifierState(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t)}initMouseEvent(t,e,n,o,r,s,l,a,h,d,u,c,f,g,p){throw new Error("Method not implemented.")}}class oi extends ua{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]}getPredictedEvents(){throw new Error("getPredictedEvents is not supported!")}clone(){var t,e,n;const o=new oi(this.manager);o.eventPhase=o.NONE,o.currentTarget=null,o.path=[],o.detailPath=[],o.target=null,o.nativeEvent=this.nativeEvent,o.originalEvent=this.originalEvent,(t=this.manager)===null||t===void 0||t.copyPointerData(this,o),(e=this.manager)===null||e===void 0||e.copyMouseData(this,o),(n=this.manager)===null||n===void 0||n.copyData(this,o),o.target=this.target,o.path=this.composedPath().slice();const r=this.composedDetailPath();return o.detailPath=r&&r.slice(),o.type=this.type,o}}class qn extends ua{constructor(){super(...arguments),this.DOM_DELTA_PIXEL=0,this.DOM_DELTA_LINE=1,this.DOM_DELTA_PAGE=2}clone(){var t,e,n;const o=new qn(this.manager);o.eventPhase=o.NONE,o.currentTarget=null,o.path=[],o.detailPath=[],o.target=null,o.nativeEvent=this.nativeEvent,o.originalEvent=this.originalEvent,(t=this.manager)===null||t===void 0||t.copyWheelData(this,o),(e=this.manager)===null||e===void 0||e.copyMouseData(this,o),(n=this.manager)===null||n===void 0||n.copyData(this,o),o.target=this.target,o.path=this.composedPath().slice();const r=this.composedDetailPath();return o.detailPath=r&&r.slice(),o.type=this.type,o}}qn.DOM_DELTA_PIXEL=0,qn.DOM_DELTA_LINE=1,qn.DOM_DELTA_PAGE=2;class Rg extends el{constructor(t,e){super(),this.type=t,this.detail=e}}const cC="*",wo=typeof performance=="object"&&performance.now?performance:Date;function En(i){return i==="mouse"||i==="pen"}let sS=class{constructor(t,e){this.dispatch=new Lr,this.cursorTarget=null,this.pauseNotify=!1,this.mappingState={trackingData:{}},this.eventPool=new Map,this.onPointerDown=(n,o)=>{if(!(n instanceof oi))return void ze.getInstance().warn("EventManager cannot map a non-pointer event as a pointer event");const r=this.createPointerEvent(n,n.type,o);if(this.dispatchEvent(r,"pointerdown"),r.pointerType==="touch")this.dispatchEvent(r,"touchstart");else if(En(r.pointerType)){const s=r.button===2;this.dispatchEvent(r,s?"rightdown":"mousedown")}this.trackingData(n.pointerId).pressTargetsByButton[n.button]=r.composedPath(),this.freeEvent(r)},this.onPointerMove=(n,o)=>{var r,s;if(!(n instanceof oi))return void ze.getInstance().warn("EventManager cannot map a non-pointer event as a pointer event");const l=this.createPointerEvent(n,n.type,o),a=En(l.pointerType),h=this.trackingData(n.pointerId),d=this.findMountedTarget(h.overTargets);if(h.overTargets&&d&&d!==this.rootTarget&&d!==l.target){const u=n.type==="mousemove"?"mouseout":"pointerout",c=this.createPointerEvent(n,u,d||void 0);if(this.dispatchEvent(c,"pointerout"),a&&this.dispatchEvent(c,"mouseout"),!l.composedPath().includes(d)){const f=this.createPointerEvent(n,"pointerleave",d||void 0);for(f.eventPhase=f.AT_TARGET;f.target&&!l.composedPath().includes(f.target);)f.currentTarget=f.target,this.notifyTarget(f),a&&this.notifyTarget(f,"mouseleave"),f.target=f.target.parent;this.freeEvent(f)}this.freeEvent(c)}if(d!==l.target){const u=n.type==="mousemove"?"mouseover":"pointerover",c=this.clonePointerEvent(l,u);this.dispatchEvent(c,"pointerover"),a&&this.dispatchEvent(c,"mouseover");let f=d==null?void 0:d.parent;for(;f&&f!==this.rootTarget.parent&&f!==l.target;)f=f.parent;if(!f||f===this.rootTarget.parent){const g=this.clonePointerEvent(l,"pointerenter");g.eventPhase=g.AT_TARGET;let p=g.target;const v=new Set;let m=d;for(;m&&m!==this.rootTarget;)v.add(m),m=m.parent;for(;p&&p!==d&&p!==this.rootTarget.parent;)v.has(p)||(g.currentTarget=p,this.notifyTarget(g),a&&this.notifyTarget(g,"mouseenter")),p=p.parent;this.freeEvent(g)}this.freeEvent(c)}this.dispatchEvent(l,"pointermove"),l.pointerType==="touch"&&this.dispatchEvent(l,"touchmove"),a&&(this.dispatchEvent(l,"mousemove"),this.cursorTarget=l.target,this.cursor=((s=(r=l.target)===null||r===void 0?void 0:r.attribute)===null||s===void 0?void 0:s.cursor)||this.rootTarget.getCursor()),h.overTargets=l.composedPath(),this.freeEvent(l)},this.onPointerOver=(n,o)=>{var r,s;if(!(n instanceof oi))return void ze.getInstance().warn("EventManager cannot map a non-pointer event as a pointer event");const l=this.trackingData(n.pointerId),a=this.createPointerEvent(n,n.type,o),h=En(a.pointerType);this.dispatchEvent(a,"pointerover"),h&&this.dispatchEvent(a,"mouseover"),a.pointerType==="mouse"&&(this.cursorTarget=a.target,this.cursor=((s=(r=a.target)===null||r===void 0?void 0:r.attribute)===null||s===void 0?void 0:s.cursor)||this.rootTarget.getCursor());const d=this.clonePointerEvent(a,"pointerenter");for(d.eventPhase=d.AT_TARGET;d.target&&d.target!==this.rootTarget.parent;)d.currentTarget=d.target,this.notifyTarget(d),h&&this.notifyTarget(d,"mouseenter"),d.target=d.target.parent;l.overTargets=a.composedPath(),this.freeEvent(a),this.freeEvent(d)},this.onPointerOut=(n,o)=>{if(!(n instanceof oi))return void ze.getInstance().warn("EventManager cannot map a non-pointer event as a pointer event");const r=this.trackingData(n.pointerId);if(r.overTargets){const s=En(n.pointerType),l=this.findMountedTarget(r.overTargets),a=this.createPointerEvent(n,"pointerout",l||void 0);this.dispatchEvent(a),s&&this.dispatchEvent(a,"mouseout");const h=this.createPointerEvent(n,"pointerleave",l||void 0);for(h.eventPhase=h.AT_TARGET;h.target&&h.target!==this.rootTarget.parent;)h.currentTarget=h.target,this.notifyTarget(h),s&&this.notifyTarget(h,"mouseleave"),h.target=h.target.parent;r.overTargets=[],this.freeEvent(a),this.freeEvent(h)}this.cursorTarget=null,this.cursor=""},this.onPointerUp=(n,o)=>{var r;if(!(n instanceof oi))return void ze.getInstance().warn("EventManager cannot map a non-pointer event as a pointer event");const s=wo.now(),l=this.createPointerEvent(n,n.type,o);if(this.dispatchEvent(l,"pointerup"),l.pointerType==="touch")this.dispatchEvent(l,"touchend");else if(En(l.pointerType)){const u=l.button===2;this.dispatchEvent(l,u?"rightup":"mouseup")}const a=this.trackingData(n.pointerId),h=this.findMountedTarget(a.pressTargetsByButton[n.button]);let d=h;if(h&&!l.composedPath().includes(h)){let u=h;for(;u&&!l.composedPath().includes(u);){if(l.currentTarget=u,this.notifyTarget(l,"pointerupoutside"),l.pointerType==="touch")this.notifyTarget(l,"touchendoutside");else if(En(l.pointerType)){const c=l.button===2;this.notifyTarget(l,c?"rightupoutside":"mouseupoutside")}u=u.parent}delete a.pressTargetsByButton[n.button],d=u}if(d){const u=this.clonePointerEvent(l,"click");u.target=d,u.path=[],u.detailPath=[],a.clicksByButton[n.button]||(a.clicksByButton[n.button]={clickCount:0,target:u.target,timeStamp:s});const c=a.clicksByButton[n.button];c.target===u.target&&s-c.timeStamp<((r=this._config.clickInterval)!==null&&r!==void 0?r:200)?++c.clickCount:c.clickCount=1,c.target=u.target,c.timeStamp=s,u.detail=c.clickCount,En(u.pointerType)?(this.dispatchEvent(u,"click"),c.clickCount===2&&this.dispatchEvent(u,"dblclick")):u.pointerType==="touch"&&this._config.supportsTouchEvents&&(this.dispatchEvent(u,"tap"),c.clickCount===2&&this.dispatchEvent(u,"dbltap")),this.dispatchEvent(u,"pointertap"),this.freeEvent(u)}this.freeEvent(l)},this.onPointerUpOutside=(n,o)=>{if(!(n instanceof oi))return void ze.getInstance().warn("EventManager cannot map a non-pointer event as a pointer event");const r=this.trackingData(n.pointerId),s=this.findMountedTarget(r.pressTargetsByButton[n.button]),l=this.createPointerEvent(n,n.type,o);if(s){let a=s;for(;a;)l.currentTarget=a,this.notifyTarget(l,"pointerupoutside"),l.pointerType==="touch"?this.notifyTarget(l,"touchendoutside"):En(l.pointerType)&&this.notifyTarget(l,l.button===2?"rightupoutside":"mouseupoutside"),a=a.parent;delete r.pressTargetsByButton[n.button]}this.freeEvent(l)},this.onWheel=(n,o)=>{if(!(n instanceof qn))return void ze.getInstance().warn("EventManager cannot map a non-wheel event as a wheel event");const r=this.createWheelEvent(n,o);this.dispatchEvent(r),this.freeEvent(r)},this.rootTarget=t,this.mappingTable={},this._config=Object.assign({clickInterval:200},e),this.addEventMapping("pointerdown",this.onPointerDown),this.addEventMapping("pointermove",this.onPointerMove),this.addEventMapping("pointerout",this.onPointerOut),this.addEventMapping("pointerleave",this.onPointerOut),this.addEventMapping("pointerover",this.onPointerOver),this.addEventMapping("pointerup",this.onPointerUp),this.addEventMapping("pointerupoutside",this.onPointerUpOutside),this.addEventMapping("wheel",this.onWheel)}addEventMapping(t,e){this.mappingTable[t]||(this.mappingTable[t]=[]),this.mappingTable[t].push({fn:e,priority:0}),this.mappingTable[t].sort((n,o)=>n.priority-o.priority)}dispatchEvent(t,e){t.propagationStopped=!1,t.propagationImmediatelyStopped=!1,this.propagate(t,e),this.dispatch.emit(e||t.type,t)}mapEvent(t){var e,n,o,r,s,l,a;if(!this.rootTarget)return;const h=this.mappingTable[t.type];let d;const u=`${t.canvasX}-${t.canvasY}`;if(!((e=this._prePointTargetCache)===null||e===void 0)&&e[u]&&(!((o=(n=this._prePointTargetCache)===null||n===void 0?void 0:n[u])===null||o===void 0)&&o.stage)&&((s=(r=this._prePointTargetCache)===null||r===void 0?void 0:r[u])===null||s===void 0?void 0:s.stage.renderCount)===((l=this._prePointTargetCache)===null||l===void 0?void 0:l.stageRenderCount)?d=this._prePointTargetCache[u]:(d=this.pickTarget(t.viewX,t.viewY,t),t.pickParams||(this._prePointTargetCache={[u]:d,stageRenderCount:(a=d==null?void 0:d.stage.renderCount)!==null&&a!==void 0?a:-1})),h)for(let c=0,f=h.length;c<f;c++)h[c].fn(t,d);else ze.getInstance().warn(`[EventManager]: Event mapping not defined for ${t.type}`)}propagate(t,e){if(!t.target)return;const n=t.composedPath();t.eventPhase=t.CAPTURING_PHASE;for(let o=0,r=n.length-1;o<r;o++)if(t.currentTarget=n[o],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return;if(t.eventPhase=t.AT_TARGET,t.currentTarget=t.target,this.notifyTarget(t,e),!t.propagationStopped&&!t.propagationImmediatelyStopped){t.eventPhase=t.BUBBLING_PHASE;for(let o=n.length-2;o>=0;o--)if(t.currentTarget=n[o],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return}}propagationPath(t){const e=[t];for(let n=0;n<2048&&t!==this.rootTarget&&t.parent;n++){if(!t.parent)throw new Error("Cannot find propagation path to disconnected target");e.push(t.parent),t=t.parent}return e.reverse(),e}notifyTarget(t,e){if(this.pauseNotify)return;e=e??t.type;const n=t.eventPhase===t.CAPTURING_PHASE||t.eventPhase===t.AT_TARGET?`${e}capture`:e;this.notifyListeners(t,n),t.eventPhase===t.AT_TARGET&&this.notifyListeners(t,e)}findMountedTarget(t){if(!t)return null;let e=t[0];for(let n=1;n<t.length&&t[n].parent===e;n++)e=t[n];return e}createPointerEvent(t,e,n){var o,r;const s=this.allocateEvent(oi);return this.copyPointerData(t,s),this.copyMouseData(t,s),this.copyData(t,s),s.nativeEvent=t.nativeEvent,s.originalEvent=t,s.target=n||this.pickTarget((o=s.viewX)!==null&&o!==void 0?o:s.global.x,(r=s.viewY)!==null&&r!==void 0?r:s.global.y,s),typeof e=="string"&&(s.type=e),s}createWheelEvent(t,e){var n,o;const r=this.allocateEvent(qn);return this.copyWheelData(t,r),this.copyMouseData(t,r),this.copyData(t,r),r.nativeEvent=t.nativeEvent,r.originalEvent=t,r.target=e||this.pickTarget((n=r.viewX)!==null&&n!==void 0?n:r.global.x,(o=r.viewY)!==null&&o!==void 0?o:r.global.y,r),r}clonePointerEvent(t,e){const n=this.allocateEvent(oi);n.nativeEvent=t.nativeEvent,n.originalEvent=t.originalEvent,this.copyPointerData(t,n),this.copyMouseData(t,n),this.copyData(t,n),n.target=t.target,n.path=t.composedPath().slice();const o=t.composedDetailPath();return n.detailPath=o&&o.slice(),n.type=e??n.type,n}copyWheelData(t,e){e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ}copyPointerData(t,e){t instanceof oi&&e instanceof oi&&(e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist)}copyMouseData(t,e){t instanceof ua&&e instanceof ua&&(e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.ctrlKey=t.ctrlKey,e.shiftKey=t.shiftKey,e.metaKey=t.metaKey,["client","movement","canvas","screen","global","offset","viewport"].forEach(n=>{e[n].x=t[n].x,e[n].y=t[n].y}))}copyData(t,e){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=wo.now(),e.type=t.type,e.detail=t.detail,e.view=t.view,e.which=t.which,e.layer.x=t.layer.x,e.layer.y=t.layer.y,e.page.x=t.page.x,e.page.y=t.page.y,e.pickParams=t.pickParams}trackingData(t){return this.mappingState.trackingData[t]||(this.mappingState.trackingData[t]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[t]}allocateEvent(t){var e;this.eventPool.has(t)||this.eventPool.set(t,[]);const n=((e=this.eventPool.get(t))===null||e===void 0?void 0:e.pop())||new t(this);return n.eventPhase=n.NONE,n.currentTarget=null,n.path=[],n.detailPath=[],n.target=null,n}freeEvent(t){var e;if(t.manager!==this)throw new Error("It is illegal to free an event not managed by this EventManager!");const n=t.constructor;this.eventPool.has(n)||this.eventPool.set(n,[]),(e=this.eventPool.get(n))===null||e===void 0||e.push(t)}notifyListeners(t,e){const n=t.currentTarget._events[e];if(n)if("fn"in n)n.once&&t.currentTarget.removeEventListener(e,n.fn,{once:!0}),n.fn.call(n.context,t);else for(let o=0,r=n.length;o<r&&!t.propagationImmediatelyStopped;o++)n[o].once&&t.currentTarget.removeEventListener(e,n[o].fn,{once:!0}),n[o].fn.call(n[o].context,t);this.emitDelegation(t,e)}emitDelegation(t,e){const n=t.currentTarget._events[cC];if(n)if("fn"in n)n.fn.call(n.context,t,e);else for(let o=0,r=n.length;o<r&&!t.propagationImmediatelyStopped;o++)n[o].fn.call(n[o].context,t,e)}pickTarget(t,e,n){let o;const r=this.rootTarget.pick(t,e);return o=r&&r.graphic?r.graphic:r&&r.group?r.group:this.rootTarget.AABBBounds.contains(t,e)?this.rootTarget:null,n&&(n.pickParams=r.params),o}release(){this.dispatch.removeAllListeners(),this.eventPool.clear(),this.rootTarget=null,this.mappingTable=null,this.mappingState=null,this.cursorTarget=null}};const lS={dispatchEvent(i){var t;if(!(i instanceof el))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");return i.defaultPrevented=!1,i.path=[],i.detailPath&&(i.detailPath=[]),i.target=this,(t=i==null?void 0:i.manager)===null||t===void 0||t.dispatchEvent(i),!i.defaultPrevented},emit(i,t){return this.dispatchEvent(new Rg(i,t))}},aS={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"};class hS{constructor(t){this.resolution=1,this.onPointerDown=d=>{if(this.supportsTouchEvents&&d.pointerType==="touch")return;const u=this.normalizeToPointerData(d);this.autoPreventDefault&&u[0].isNormalized&&(d.cancelable||!("cancelable"in d))&&d.preventDefault();for(let c=0,f=u.length;c<f;c++){const g=u[c],p=this.bootstrapEvent(this.rootPointerEvent,g);this.manager.mapEvent(p)}this.setCursor(this.manager.cursor,this.manager.cursorTarget),this.rootPointerEvent.nativeEvent=null},this.onPointerMove=d=>{if(this.supportsTouchEvents&&d.pointerType==="touch"||this.isEventOutsideOfTargetElement(d))return;const u=this.normalizeToPointerData(d);for(let c=0,f=u.length;c<f;c++){const g=this.bootstrapEvent(this.rootPointerEvent,u[c]);this.manager.mapEvent(g)}this.setCursor(this.manager.cursor,this.manager.cursorTarget),this.rootPointerEvent.nativeEvent=null},this.onPointerUp=d=>{if(this.supportsTouchEvents&&d.pointerType==="touch")return;const u=this.isEventOutsideOfTargetViewPort(d)?"outside":"",c=this.normalizeToPointerData(d);for(let f=0,g=c.length;f<g;f++){const p=this.bootstrapEvent(this.rootPointerEvent,c[f]);p.type+=u,this.manager.mapEvent(p)}this.setCursor(this.manager.cursor,this.manager.cursorTarget),this.rootPointerEvent.nativeEvent=null},this.onPointerOverOut=d=>{if(this.supportsTouchEvents&&d.pointerType==="touch")return;const u=this.normalizeToPointerData(d);for(let c=0,f=u.length;c<f;c++){const g=this.bootstrapEvent(this.rootPointerEvent,u[c]);this.manager.mapEvent(g)}this.setCursor(this.manager.cursor,this.manager.cursorTarget),this.rootPointerEvent.nativeEvent=null},this.onWheel=d=>{const u=this.normalizeWheelEvent(d);this.manager.mapEvent(u)};const{targetElement:e,resolution:n,rootNode:o,global:r,autoPreventDefault:s=!1,clickInterval:l,supportsTouchEvents:a=r.supportsTouchEvents,supportsPointerEvents:h=r.supportsPointerEvents}=t;this.manager=new sS(o,{clickInterval:l,supportsTouchEvents:a}),this.globalObj=r,this.supportsPointerEvents=h,this.supportsTouchEvents=a,this.supportsMouseEvents=r.supportsMouseEvents,this.applyStyles=r.applyStyles,this.autoPreventDefault=s,this.eventsAdded=!1,this.rootPointerEvent=new oi,this.rootWheelEvent=new qn,this.cursorStyles={default:"inherit",pointer:"pointer"},this.resolution=n,this.setTargetElement(e)}release(){this.removeEvents(),this.manager&&this.manager.release(),this.domElement=null,this.manager=null,this.globalObj=null}setCursor(t,e){if(!e&&!this.manager.rootTarget.window._handler.canvas.controled)return;t||(t="default");const{applyStyles:n,domElement:o}=this;if(this.currentCursor===t)return;this.currentCursor=t;const r=this.cursorStyles[t];r?typeof r=="string"&&n?o.style.cursor=r:typeof r=="function"?r(t):typeof r=="object"&&n&&Object.assign(o.style,r):n&&jt(t)&&!kb(this.cursorStyles,t)&&(o.style.cursor=t)}setTargetElement(t){this.removeEvents(),this.domElement=t,this.addEvents()}addEvents(){if(this.eventsAdded||!this.domElement)return;const{globalObj:t,domElement:e}=this;this.supportsPointerEvents?(t.getDocument()?(t.getDocument().addEventListener("pointermove",this.onPointerMove,!0),t.getDocument().addEventListener("pointerup",this.onPointerUp,!0)):(e.addEventListener("pointermove",this.onPointerMove,!0),e.addEventListener("pointerup",this.onPointerUp,!0)),e.addEventListener("pointerdown",this.onPointerDown,!0),e.addEventListener("pointerleave",this.onPointerOverOut,!0),e.addEventListener("pointerover",this.onPointerOverOut,!0)):(t.getDocument()?(t.getDocument().addEventListener("mousemove",this.onPointerMove,!0),t.getDocument().addEventListener("mouseup",this.onPointerUp,!0)):(e.addEventListener("mousemove",this.onPointerMove,!0),e.addEventListener("mouseup",this.onPointerUp,!0)),e.addEventListener("mousedown",this.onPointerDown,!0),e.addEventListener("mouseout",this.onPointerOverOut,!0),e.addEventListener("mouseover",this.onPointerOverOut,!0)),this.supportsTouchEvents&&(e.addEventListener("touchstart",this.onPointerDown,!0),e.addEventListener("touchend",this.onPointerUp,!0),e.addEventListener("touchmove",this.onPointerMove,!0)),e.addEventListener("wheel",this.onWheel,{capture:!0}),this.eventsAdded=!0}removeEvents(){if(!this.eventsAdded||!this.domElement)return;const{globalObj:t,domElement:e}=this;this.supportsPointerEvents?(t.getDocument()?(t.getDocument().removeEventListener("pointermove",this.onPointerMove,!0),t.getDocument().removeEventListener("pointerup",this.onPointerUp,!0)):(e.removeEventListener("pointermove",this.onPointerMove,!0),e.removeEventListener("pointerup",this.onPointerUp,!0)),e.removeEventListener("pointerdown",this.onPointerDown,!0),e.removeEventListener("pointerleave",this.onPointerOverOut,!0),e.removeEventListener("pointerover",this.onPointerOverOut,!0)):(t.getDocument()?(t.getDocument().removeEventListener("mousemove",this.onPointerMove,!0),t.getDocument().removeEventListener("mouseup",this.onPointerUp,!0)):(e.removeEventListener("mousemove",this.onPointerMove,!0),e.removeEventListener("mouseup",this.onPointerUp,!0)),e.removeEventListener("mousedown",this.onPointerDown,!0),e.removeEventListener("mouseout",this.onPointerOverOut,!0),e.removeEventListener("mouseover",this.onPointerOverOut,!0)),this.supportsTouchEvents&&(e.removeEventListener("touchstart",this.onPointerDown,!0),e.removeEventListener("touchend",this.onPointerUp,!0),e.removeEventListener("touchmove",this.onPointerMove,!0)),e.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}mapToViewportPoint(t){return this.domElement.pointTransform?this.domElement.pointTransform(t.x,t.y):t}mapToCanvasPoint(t){var e,n;const o=(e=this.globalObj)===null||e===void 0?void 0:e.mapToCanvasPoint(t,this.domElement);if(o)return o;let r=0,s=0;if(t.changedTouches){const a=(n=t.changedTouches[0])!==null&&n!==void 0?n:{};r=a.clientX||0,s=a.clientY||0}else r=t.clientX||0,s=t.clientY||0;const l=this.domElement.getBoundingClientRect();return{x:r-l.left,y:s-l.top}}normalizeToPointerData(t){const e=[];if(this.supportsTouchEvents&&t.changedTouches&&t.changedTouches.length)for(let n=0,o=t.changedTouches.length;n<o;n++){const r=t.changedTouches[n];ee(r.button)&&(r.button=0),ee(r.buttons)&&(r.buttons=1),ee(r.isPrimary)&&(r.isPrimary=t.touches.length===1&&t.type==="touchstart"),ee(r.width)&&(r.width=r.radiusX||1),ee(r.height)&&(r.height=r.radiusY||1),ee(r.tiltX)&&(r.tiltX=0),ee(r.tiltY)&&(r.tiltY=0),ee(r.pointerType)&&(r.pointerType="touch"),ee(r.pointerId)&&(r.pointerId=r.identifier||0),ee(r.pressure)&&(r.pressure=r.force||.5),ee(r.twist)&&(r.twist=0),ee(r.tangentialPressure)&&(r.tangentialPressure=0),ee(r.layerX)&&(r.layerX=r.offsetX=r.clientX),ee(r.layerY)&&(r.layerY=r.offsetY=r.clientY),r.isNormalized=!0,r.type=t.type,e.push(r)}else if(this.globalObj.supportsMouseEvents&&(!(t instanceof MouseEvent)||this.supportsPointerEvents&&t instanceof PointerEvent))e.push(t);else{const n=t;ee(n.isPrimary)&&(n.isPrimary=!0),ee(n.width)&&(n.width=1),ee(n.height)&&(n.height=1),ee(n.tiltX)&&(n.tiltX=0),ee(n.tiltY)&&(n.tiltY=0),ee(n.pointerType)&&(n.pointerType="mouse"),ee(n.pointerId)&&(n.pointerId=1),ee(n.pressure)&&(n.pressure=.5),ee(n.twist)&&(n.twist=0),ee(n.tangentialPressure)&&(n.tangentialPressure=0),n.isNormalized=!0,e.push(n)}return e}normalizeWheelEvent(t){const e=this.rootWheelEvent;this.transferMouseData(e,t),e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ;const{x:n,y:o}=this.mapToCanvasPoint(t);e.canvas.x=n,e.canvas.y=o,e.global.x=n,e.global.y=o,e.offset.x=n,e.offset.y=o;const{x:r,y:s}=this.mapToViewportPoint(e);return e.viewport.x=r,e.viewport.y=s,e.nativeEvent=t,e.type=t.type,e}bootstrapEvent(t,e){t.originalEvent=null,t.nativeEvent=e,t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist,this.transferMouseData(t,e);const{x:n,y:o}=this.mapToCanvasPoint(e);t.canvas.x=n,t.canvas.y=o,t.global.x=n,t.global.y=o,t.offset.x=n,t.offset.y=o;const{x:r,y:s}=this.mapToViewportPoint(t);return t.viewport.x=r,t.viewport.y=s,t.isTrusted=e.isTrusted,t.type==="pointerleave"&&(t.type="pointerout"),t.type.startsWith("mouse")&&(t.type=t.type.replace("mouse","pointer")),t.type.startsWith("touch")&&(t.type=aS[t.type]||t.type),t}transferMouseData(t,e){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=wo.now(),t.type=e.type,t.altKey=e.altKey,t.button=e.button,t.buttons=e.buttons,t.client.x=e.clientX,t.client.y=e.clientY,t.ctrlKey=e.ctrlKey,t.shiftKey=e.shiftKey,t.metaKey=e.metaKey,t.movement.x=e.movementX,t.movement.y=e.movementY,t.page.x=e.pageX,t.page.y=e.pageY,t.relatedTarget=null}isEventOutsideOfTargetViewPort(t){if(this.isEventOutsideOfTargetElement(t))return!0;if(this.domElement.getViewBox){const e=this.mapToViewportPoint(this.mapToCanvasPoint(t)),n=this.domElement.getViewBox(),o=n.width(),r=n.height();return!(e.x<o&&e.y<r&&e.x>0&&e.y>0)}return!1}isEventOutsideOfTargetElement(t){let e=t.target;return t.composedPath&&t.composedPath().length>0&&(e=t.composedPath()[0]),e!==(this.domElement.getNativeHandler?this.domElement.getNativeHandler().nativeCanvas:this.domElement)}pauseTriggerEvent(){this.manager.pauseNotify=!0}resumeTriggerEvent(){this.manager.pauseNotify=!1}}var ni;(function(i){i[i.INITIAL=0]="INITIAL",i[i.RUNNING=1]="RUNNING",i[i.PAUSE=2]="PAUSE"})(ni||(ni={}));class ps{static Avaliable(){return!!G.global.getRequestAnimationFrame()}avaliable(){return ps.Avaliable()}tick(t,e){G.global.getRequestAnimationFrame()(()=>{this.released||e(this)})}release(){this.released=!0}getTime(){return Date.now()}}class ca{static Avaliable(){return!0}avaliable(){return ca.Avaliable()}tick(t,e){this.timerId=setTimeout(()=>{e(this)},t)}release(){this.timerId>0&&(clearTimeout(this.timerId),this.timerId=-1)}getTime(){return Date.now()}}class gC extends Lr{set mode(t){this._mode!==t&&(this._mode=t,this.setupTickHandler())}get mode(){return this._mode}constructor(t=[]){super(),this.handleTick=(e,n)=>{const{once:o=!1}=n??{};this.ifCanStop()?this.stop():(this._handlerTick(),o||e.tick(this.interval,this.handleTick))},this._handlerTick=()=>{const e=this.tickerHandler.getTime();let n=0;this.lastFrameTime>=0&&(n=e-this.lastFrameTime),this.lastFrameTime=e,this.status===ni.RUNNING&&(this.tickCounts++,this.timelines.forEach(o=>{o.tick(n)}),this.emit("afterTick"))},this.init(),this.lastFrameTime=-1,this.tickCounts=0,this.timelines=t,this.autoStop=!0}init(){this.interval=NaN,this.status=ni.INITIAL,G.global.hooks.onSetEnv.tap("default-ticker",()=>{this.initHandler()}),G.global.env&&this.initHandler()}addTimeline(t){this.timelines.push(t)}remTimeline(t){this.timelines=this.timelines.filter(e=>e!==t)}initHandler(){if(this._mode)return null;const t=[{mode:"raf",cons:ps},{mode:"timeout",cons:ca}];for(let e=0;e<t.length;e++)if(t[e].cons.Avaliable()){this.mode=t[e].mode;break}return null}setupTickHandler(){let t;switch(this._mode){case"raf":t=new ps;break;case"timeout":t=new ca;break;default:ze.getInstance().warn("非法的计时器模式"),t=new ps}return!!t.avaliable()&&(this.tickerHandler&&this.tickerHandler.release(),this.tickerHandler=t,!0)}setInterval(t){this.interval=t}getInterval(){return this.interval}setFPS(t){this.setInterval(1e3/t)}getFPS(){return 1e3/this.interval}tick(t){this.tickerHandler.tick(t,e=>{this.handleTick(e,{once:!0})})}tickTo(t){this.tickerHandler.tickTo&&this.tickerHandler.tickTo(t,e=>{this.handleTick(e,{once:!0})})}pause(){return this.status!==ni.INITIAL&&(this.status=ni.PAUSE,!0)}resume(){return this.status!==ni.INITIAL&&(this.status=ni.RUNNING,!0)}ifCanStop(){return!!(this.autoStop&&(!this.timelines.length||this.timelines.reduce((t,e)=>t+e.animateCount,0)===0))}start(t=!1){return this.status===ni.RUNNING||!this.tickerHandler||!t&&(this.status===ni.PAUSE||!this.timelines.length||this.timelines.reduce((e,n)=>e+n.animateCount,0)===0)?!1:(this.status=ni.RUNNING,this.tickerHandler.tick(0,this.handleTick),!0)}stop(){this.status=ni.INITIAL,this.setupTickHandler(),this.lastFrameTime=-1}trySyncTickStatus(){this.status===ni.RUNNING&&this._handlerTick()}}class Rt{constructor(){}static linear(t){return t}static none(){return this.linear}static get(t){return t<-1?t=-1:t>1&&(t=1),function(e){return t===0?e:t<0?e*(e*-t+1+t):e*((2-e)*t+(1-t))}}static getPowIn(t){return function(e){return Math.pow(e,t)}}static getPowOut(t){return function(e){return 1-Math.pow(1-e,t)}}static getPowInOut(t){return function(e){return(e*=2)<1?.5*Math.pow(e,t):1-.5*Math.abs(Math.pow(2-e,t))}}static getBackIn(t){return function(e){return e*e*((t+1)*e-t)}}static getBackOut(t){return function(e){return--e*e*((t+1)*e+t)+1}}static getBackInOut(t){return t*=1.525,function(e){return(e*=2)<1?e*e*((t+1)*e-t)*.5:.5*((e-=2)*e*((t+1)*e+t)+2)}}static sineIn(t){return 1-Math.cos(t*Math.PI/2)}static sineOut(t){return Math.sin(t*Math.PI/2)}static sineInOut(t){return-(Math.cos(Math.PI*t)-1)/2}static expoIn(t){return t===0?0:Math.pow(2,10*t-10)}static expoOut(t){return t===1?1:1-Math.pow(2,-10*t)}static expoInOut(t){return t===0?0:t===1?1:t<.5?Math.pow(2,20*t-10)/2:(2-Math.pow(2,-20*t+10))/2}static circIn(t){return-(Math.sqrt(1-t*t)-1)}static circOut(t){return Math.sqrt(1- --t*t)}static circInOut(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}static bounceOut(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}static bounceIn(t){return 1-Rt.bounceOut(1-t)}static bounceInOut(t){return t<.5?.5*Rt.bounceIn(2*t):.5*Rt.bounceOut(2*t-1)+.5}static getElasticIn(t,e){return function(n){if(n===0||n===1)return n;const o=e/Vt*Math.asin(1/t);return-t*Math.pow(2,10*(n-=1))*Math.sin((n-o)*Vt/e)}}static getElasticOut(t,e){return function(n){if(n===0||n===1)return n;const o=e/Vt*Math.asin(1/t);return t*Math.pow(2,-10*n)*Math.sin((n-o)*Vt/e)+1}}static getElasticInOut(t,e){return function(n){const o=e/Vt*Math.asin(1/t);return(n*=2)<1?t*Math.pow(2,10*(n-=1))*Math.sin((n-o)*Vt/e)*-.5:t*Math.pow(2,-10*(n-=1))*Math.sin((n-o)*Vt/e)*.5+1}}}Rt.quadIn=Rt.getPowIn(2),Rt.quadOut=Rt.getPowOut(2),Rt.quadInOut=Rt.getPowInOut(2),Rt.cubicIn=Rt.getPowIn(3),Rt.cubicOut=Rt.getPowOut(3),Rt.cubicInOut=Rt.getPowInOut(3),Rt.quartIn=Rt.getPowIn(4),Rt.quartOut=Rt.getPowOut(4),Rt.quartInOut=Rt.getPowInOut(4),Rt.quintIn=Rt.getPowIn(5),Rt.quintOut=Rt.getPowOut(5),Rt.quintInOut=Rt.getPowInOut(5),Rt.backIn=Rt.getBackIn(1.7),Rt.backOut=Rt.getBackOut(1.7),Rt.backInOut=Rt.getBackInOut(1.7),Rt.elasticIn=Rt.getElasticIn(1,.3),Rt.elasticOut=Rt.getElasticOut(1,.3),Rt.elasticInOut=Rt.getElasticInOut(1,.3*1.5);class Ag{constructor(){this.id=fe.GenAutoIncrementId(),this.animateHead=null,this.animateTail=null,this.animateCount=0,this.paused=!1}addAnimate(t){this.animateTail?(this.animateTail.nextAnimate=t,t.prevAnimate=this.animateTail,this.animateTail=t,t.nextAnimate=null):(this.animateHead=t,this.animateTail=t),this.animateCount++}pause(){this.paused=!0}resume(){this.paused=!1}tick(t){if(this.paused)return;let e=this.animateHead;for(this.animateCount=0;e;)e.status===Le.END?this.removeAnimate(e):e.status===Le.RUNNING||e.status===Le.INITIAL?(this.animateCount++,e.advance(t)):e.status===Le.PAUSED&&this.animateCount++,e=e.nextAnimate}clear(){let t=this.animateHead;for(;t;)t.release(),t=t.nextAnimate;this.animateHead=null,this.animateTail=null,this.animateCount=0}removeAnimate(t,e=!0){t._onRemove&&t._onRemove.forEach(n=>n()),t===this.animateHead?(this.animateHead=t.nextAnimate,t===this.animateTail?this.animateTail=null:this.animateHead.prevAnimate=null):t===this.animateTail?(this.animateTail=t.prevAnimate,this.animateTail.nextAnimate=null):(t.prevAnimate.nextAnimate=t.nextAnimate,t.nextAnimate.prevAnimate=t.prevAnimate),e&&t.release()}}const fC=new Ag;class pC{constructor(t,e,n,o,r){this.from=t,this.to=e,this.duration=n,this.easing=o,this.params=r,this.updateCount=0}bind(t,e){this.target=t,this.subAnimate=e,this.onBind()}onBind(){}onFirstRun(){}onStart(){}onEnd(){}getEndProps(){return this.to}getFromProps(){return this.from}getMergedEndProps(){var t;const e=this.getEndProps();return e?this._endProps===e?this._mergedEndProps:(this._endProps=e,void(this._mergedEndProps=Object.assign({},(t=this.step.prev.getLastProps())!==null&&t!==void 0?t:{},e))):this.step.prev?this.step.prev.getLastProps():e}update(t,e,n){if(this.updateCount===0){this.onFirstRun();const o=this.step.getLastProps();Object.keys(o).forEach(r=>{this.subAnimate.animate.validAttr(r)&&(n[r]=o[r])})}this.updateCount+=1,this.onUpdate(t,e,n),t&&this.onEnd()}}class dS extends pC{constructor(t){super(null,null,0,"linear"),this.cb=t}onUpdate(t,e,n){}onStart(){this.cb()}}class _n{constructor(t=fe.GenAutoIncrementId(),e=fC,n){this.id=t,this.timeline=e,this.status=Le.INITIAL,this.tailAnimate=new zf(this),this.subAnimates=[this.tailAnimate],this.timeScale=1,this.rawPosition=-1,this._startTime=0,this._duringTime=0,this.timeline.addAnimate(this),this.slience=n}setTimeline(t){t!==this.timeline&&(this.timeline.removeAnimate(this,!1),t.addAnimate(this))}getStartTime(){return this._startTime}getDuration(){return this.subAnimates.reduce((t,e)=>t+e.totalDuration,0)}after(t){const e=t.getDuration();return this._startTime=e,this}afterAll(t){let e=-1/0;return t.forEach(n=>{e=Jn(n.getDuration(),e)}),this._startTime=e,this}parallel(t){return this._startTime=t.getStartTime(),this}static AddInterpolate(t,e){_n.interpolateMap.set(t,e)}play(t){if(this.tailAnimate.play(t),this.target){const e=this.target.stage;e&&e.renderNextFrame()}return this.subAnimates.length===1&&this.tailAnimate.totalDuration===t.duration&&this.trySetAttribute(t.getFromProps(),t.mode),this}trySetAttribute(t,e=_n.mode){t&&e&la.SET_ATTR_IMMEDIATELY&&this.target.setAttributes&&this.target.setAttributes(t,!1,{type:Ye.ANIMATE_PLAY})}runCb(t){const e=new dS(()=>{t(this,e.step.prev)});return this.tailAnimate.play(e),this}customInterpolate(t,e,n,o,r,s){const l=_n.interpolateMap.get(t)||_n.interpolateMap.get("");return!!l&&l(t,e,n,o,r,s)}pause(){this.status===Le.RUNNING&&(this.status=Le.PAUSED)}resume(){this.status===Le.PAUSED&&(this.status=Le.RUNNING)}to(t,e,n,o){if(this.tailAnimate.to(t,e,n,o),this.target){const r=this.target.stage;r&&r.renderNextFrame()}return this}from(t,e,n,o){if(this.tailAnimate.from(t,e,n,o),this.target){const r=this.target.stage;r&&r.renderNextFrame()}return this}wait(t){if(this.tailAnimate.wait(t),this.target){const e=this.target.stage;e&&e.renderNextFrame()}return this}startAt(t){if(this.tailAnimate.startAt(t),this.target){const e=this.target.stage;e&&e.renderNextFrame()}return this}loop(t){if(this.tailAnimate.loop=t,this.target){const e=this.target.stage;e&&e.renderNextFrame()}return this}reversed(t){if(this.tailAnimate.reversed=t,this.target){const e=this.target.stage;e&&e.renderNextFrame()}return this}bounce(t){if(this.tailAnimate.bounce=t,this.target){const e=this.target.stage;e&&e.renderNextFrame()}return this}subAnimate(){const t=new zf(this,this.tailAnimate);return this.tailAnimate=t,this.subAnimates.push(t),t.bind(this.target),this}getStartProps(){return this.subAnimates[0].getStartProps()}getEndProps(){return this.tailAnimate.getEndProps()}depreventAttr(t){this._preventAttrs&&this._preventAttrs.delete(t)}preventAttr(t){this._preventAttrs||(this._preventAttrs=new Set),this._preventAttrs.add(t)}preventAttrs(t){t.forEach(e=>this.preventAttr(e))}validAttr(t){return!this._preventAttrs||!this._preventAttrs.has(t)}bind(t){return this.target=t,this.target.onAnimateBind&&!this.slience&&this.target.onAnimateBind(this),this.subAnimates.forEach(e=>{e.bind(t)}),this}advance(t){if(this._duringTime<this._startTime){if(this._duringTime+t*this.timeScale<this._startTime)return void(this._duringTime+=t*this.timeScale);t=this._duringTime+t*this.timeScale-this._startTime,this._duringTime=this._startTime}this.status===Le.INITIAL&&(this.status=Le.RUNNING,this._onStart&&this._onStart.forEach(e=>e())),this.setPosition(Math.max(this.rawPosition,0)+t*this.timeScale)&&this.status===Le.RUNNING&&(this.status=Le.END,this._onEnd&&this._onEnd.forEach(e=>e()))}setPosition(t){let e,n=0;const o=this.rawPosition,r=this.subAnimates.reduce((l,a)=>l+a.totalDuration,0);t<0&&(t=0);const s=t>=r;if(s&&(t=r),t===o)return s;for(let l=0;l<this.subAnimates.length&&(e=this.subAnimates[l],!(n+e.totalDuration>=t));l++)n+=e.totalDuration,e=void 0;return this.rawPosition=t,e.setPosition(t-n),s}onStart(t){this._onStart||(this._onStart=[]),this._onStart.push(t)}onEnd(t){this._onEnd||(this._onEnd=[]),this._onEnd.push(t)}onRemove(t){this._onRemove||(this._onRemove=[]),this._onRemove.push(t)}onFrame(t){this._onFrame||(this._onFrame=[]),this._onFrame.push(t)}release(){this.status=Le.END}stop(t){t||this.target.onStop(),t==="start"?this.target.onStop(this.getStartProps()):t==="end"?this.target.onStop(this.getEndProps()):this.target.onStop(t),this.release()}}_n.mode=la.NORMAL,_n.interpolateMap=new Map;class zf{get totalDuration(){return this.calcAttr(),this._totalDuration+this._startAt}constructor(t,e){this.rawPosition=-1,this.position=0,this.loop=0,this.duration=0,this.animate=t,this.stepHead=new If(0,0,e?Object.assign({},e.stepTail.props):{}),this.stepTail=this.stepHead,this.dirty=!0,this._startAt=0}calcAttr(){this.dirty&&(this._totalDuration=this.duration*(this.loop+1))}bind(t){return this.target=t,this}play(t){let e=t.duration;(e==null||e<0)&&(e=0);const n=t.easing,o=typeof n=="string"?Rt[n]:n,r=this._addStep(e,null,o);return r.type=er.customAnimate,this._appendProps(t.getEndProps(),r,!1),this._appendCustomAnimate(t,r),this}to(t,e,n,o){(e==null||e<0)&&(e=0);const r=typeof n=="string"?Rt[n]:n,s=this._addStep(e,null,r);return s.type=er.to,this._appendProps(t,s,!!o&&o.tempProps),s.propKeys||(s.propKeys=Object.keys(s.props)),o&&o.noPreventAttrs||this.target.animates.forEach(l=>{l.id!==this.animate.id&&l.preventAttrs(s.propKeys)}),this}from(t,e,n,o){this.to(t,0,n,o);const r={};this.stepTail.propKeys||(this.stepTail.propKeys=Object.keys(this.stepTail.props)),this.stepTail.propKeys.forEach(s=>{r[s]=this.getLastPropByName(s,this.stepTail)}),this.to(r,e,n,o),this.stepTail.type=er.from}startAt(t){return t<0&&(t=0),this._startAt=t,this}getStartProps(){var t;return(t=this.stepHead)===null||t===void 0?void 0:t.props}getEndProps(){return this.stepTail.props}getLastStep(){return this._lastStep}wait(t){if(t>0){const e=this._addStep(+t,null);e.type=er.wait,e.prev.customAnimate?e.props=e.prev.customAnimate.getEndProps():e.props=e.prev.props,this.target.onAddStep&&this.target.onAddStep(e)}return this}_addStep(t,e,n){const o=new If(this.duration,t,e,n);return this.duration+=t,this.stepTail.append(o),this.stepTail=o,o}_appendProps(t,e,n){e.props=n?t:Object.assign({},t);let o=e.prev;const r=e.props;for(e.propKeys||(e.propKeys=Object.keys(e.props)),e.propKeys.forEach(l=>{e.props[l]===void 0&&(e.props[l]=this.target.getDefaultAttribute(l))});o.prev;)o.props&&(o.propKeys||(o.propKeys=Object.keys(o.props)),o.propKeys.forEach(l=>{r[l]===void 0&&(r[l]=o.props[l])})),e.propKeys=Object.keys(e.props),o=o.prev;const s=this.stepHead.props;e.propKeys||(e.propKeys=Object.keys(r)),e.propKeys.forEach(l=>{if(s[l]===void 0){const a=this.animate.getStartProps();s[l]=a[l]=this.target.getComputedAttribute(l)}}),this.target.onAddStep&&this.target.onAddStep(e)}_appendCustomAnimate(t,e){e.customAnimate=t,t.step=e,t.bind(this.target,this)}setPosition(t){var e;const n=this.duration,o=this.loop,r=this.rawPosition;let s,l,a=!1;const h=(e=this._startAt)!==null&&e!==void 0?e:0;if(t<0&&(t=0),t<h)return this.rawPosition=t,!1;if(t-=h,n<=0&&(a=!0,n<0)||(s=Math.floor(t/n),l=t-s*n,a=t>=o*n+n,a&&(l=n,s=o,t=l*s+n),t===r))return a;const d=!this.reversed!=!(this.bounce&&s%2);return d&&(l=n-l),this._deltaPosition=l-this.position,this.position=l,this.rawPosition=t+h,this.updatePosition(a,d),a}updatePosition(t,e){if(!this.stepHead)return;let n=this.stepHead.next;const o=this.position,r=this.duration;if(this.target&&n){let s=n.next;for(;s&&s.position<=o;)n=s,s=n.next;let l=t?r===0?1:o/r:(o-n.position)/n.duration;n.easing&&(l=n.easing(l)),this.tryCallCustomAnimateLifeCycle(n,this._lastStep||(e?this.stepTail:this.stepHead),e),this.updateTarget(n,l,t),this._lastStep=n,this.animate._onFrame&&this.animate._onFrame.forEach(a=>a(n,l))}}tryCallCustomAnimateLifeCycle(t,e,n){if(t!==e)if(n){let o=e.prev;for(;o&&o!==t;)o.customAnimate&&(o.customAnimate.onStart&&o.customAnimate.onStart(),o.customAnimate.onEnd&&o.customAnimate.onEnd()),o=t.prev;e&&e.customAnimate&&e.customAnimate.onEnd&&e.customAnimate.onEnd(),t&&t.customAnimate&&t.customAnimate.onStart&&t.customAnimate.onStart()}else{let o=e.next;for(;o&&o!==t;)o.customAnimate&&(o.customAnimate.onStart&&o.customAnimate.onStart(),o.customAnimate.onEnd&&o.customAnimate.onEnd()),o=o.next;e&&e.customAnimate&&e.customAnimate.onEnd&&e.customAnimate.onEnd(),t&&t.customAnimate&&t.customAnimate.onStart&&t.customAnimate.onStart()}}getLastPropByName(t,e){let n=e.prev;for(;n;){if(n.props&&n.props[t]!==void 0)return n.props[t];if(n.customAnimate){const o=n.customAnimate.getEndProps()[t];if(o!==void 0)return o}n=n.prev}return ze.getInstance().warn("未知错误，step中找不到属性"),e.props[t]}updateTarget(t,e,n){t.props==null&&t.customAnimate==null||this.target.onStep(this,this.animate,t,e,n)}}class If{constructor(t,e,n,o){this.duration=e,this.position=t,this.props=n,this.easing=o}append(t){t.prev=this,t.next=this.next,this.next=t}getLastProps(){let t=this.prev;for(;t;){if(t.props)return t.props;if(t.customAnimate)return t.customAnimate.getMergedEndProps();t=t.prev}return null}}const Of={duration:200,easing:"cubicOut"};var Df;(function(i){i[i.Top=1]="Top",i[i.Right=2]="Right",i[i.Bottom=4]="Bottom",i[i.Left=8]="Left",i[i.ALL=15]="ALL"})(Df||(Df={}));const hn=[!1,!1,!1,!1],uS=i=>{var t;let e=!0;if(He(i,!0)){for(let n=0;n<4;n++)hn[n]=i,e&&(e=!((t=hn[n])!==null&&t!==void 0&&!t));e=i}else if(Array.isArray(i))for(let n=0;n<4;n++)hn[n]=!!i[n],e&&(e=!!hn[n]);else hn[0]=!1,hn[1]=!1,hn[2]=!1,hn[3]=!1;return{isFullStroke:e,stroke:hn}},Kr=[0,0,0,0],ga=i=>i?Q(i)?i.length===0?0:i.length===1?i[0]:i.length===2?(Kr[0]=i[0],Kr[2]=i[0],Kr[1]=i[1],Kr[3]=i[1],Kr):i:i:0,No=[{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0}],Sl=[1,2,3,0,1,2,3,0];function Fu(i,t,e,n){for(;i>=Vt;)i-=Vt;for(;i<0;)i+=Vt;for(;i>t;)t+=Vt;No[0].x=e,No[1].y=e,No[2].x=-e,No[3].y=-e;const o=Math.ceil(i/Vn)%4,r=Math.ceil(t/Vn)%4;if(n.add(ve(i)*e,ie(i)*e),n.add(ve(t)*e,ie(t)*e),o!==r||t-i>Xt){let s=!1;for(let l=0;l<Sl.length;l++)if(s||o!==Sl[l]){if(s&&r===Sl[l])break;if(s){const a=No[Sl[l]];n.add(a.x,a.y)}}else{s=!0;const a=No[o];n.add(a.x,a.y)}}}function Wf(i,t,e){const{x:n,y:o}=cf(i.x,i.y,t.x,t.y,e),{x:r,y:s}=cf(i.x1,i.y1,t.x1,t.y1,e),l=new ye(n,o,r,s);return l.defined=t.defined,l}function vC(i,t,e){if(!i||!t)return[];Array.isArray(i)||(i=[i]),Array.isArray(t)||(t=[t]);let n=[];if(i.length>t.length){n=t.map(o=>{const r=new ye(o.x,o.y,o.x1,o.y1);return r.defined=o.defined,r});for(let o=0;o<t.length;o++)n[o]=Wf(i[o],t[o],e)}else{n=t.map(o=>{const r=new ye(o.x,o.y,o.x1,o.y1);return r.defined=o.defined,r});for(let o=0;o<i.length;o++)n[o]=Wf(i[o],t[o],e)}return n}function xl(i,t){if(Q(i)){let e;for(let n=0;n<i.length&&e===void 0;n++)e=i[n][t];return e}return i[t]}class qh{constructor(t=qh.TimeOut){this.durations=[],this.timeout=t,this.lastDate=0,this.durationsListThreshold=30}call(t){return this.lastDate=Date.now(),setTimeout(()=>{this.appendDuration(Date.now()-this.lastDate),t(0)},this.timeout,!0)}clear(t){clearTimeout(t)}appendDuration(t){this.durations.push(t),this.durations.length>this.durationsListThreshold&&this.durations.shift(),this.timeout=Math.min(Math.max(this.durations.reduce((e,n)=>e+n,0)/this.durations.length,1e3/60),1e3/30)}}qh.TimeOut=1e3/60;const Nf=new qh,cS=(i,t)=>jt(i)&&i[i.length-1]==="%"?t*(Number.parseFloat(i.substring(0,i.length-1))/100):i,il=(i,t)=>{const e=cS(i,t);return isNaN(e)?e:Math.max(t,e)},gS=i=>{if(!i)return{x:0,y:0,width:0,height:0};let t=Pt(i.width)?i.x1-i.x:i.width,e=Pt(i.height)?i.y1-i.y:i.height,n=0,o=0;return t<0?(n=t,t=-t):Number.isNaN(t)&&(t=0),e<0?(o=e,e=-e):Number.isNaN(e)&&(e=0),{x:n,y:o,width:t,height:e}};var Sn;(function(i){i[i.Color255=0]="Color255",i[i.Color1=1]="Color1"})(Sn||(Sn={}));class Ce{static Get(t,e=Sn.Color1,n=[0,0,0,1]){if(e===Sn.Color1){const s=Ce.store1[t];if(s)return n[0]=s[0],n[1]=s[1],n[2]=s[2],n[3]=s[3],n;const l=gf.parseColorString(t);if(l){const a=[l.r/255,l.g/255,l.b/255,l.opacity];Ce.store1[t]=a,Ce.store255[t]=[l.r,l.g,l.b,l.opacity],n[0]=a[0],n[1]=a[1],n[2]=a[2],n[3]=a[3]}return n}const o=Ce.store255[t];if(o)return n[0]=o[0],n[1]=o[1],n[2]=o[2],n[3]=o[3],n;const r=gf.parseColorString(t);return r&&(Ce.store1[t]=[r.r/255,r.g/255,r.b/255,r.opacity],Ce.store255[t]=[r.r,r.g,r.b,r.opacity],n[0]=r.r,n[1]=r.g,n[2]=r.b,n[3]=r.opacity),n}static Set(t,e,n){if(e===Sn.Color1){if(Ce.store1[t])return;Ce.store1[t]=n,Ce.store255[t]=[Math.floor(255*n[0]),Math.floor(255*n[1]),Math.floor(255*n[2]),Math.floor(255*n[3])]}else{if(Ce.store255[t])return;Ce.store255[t]=n,Ce.store1[t]=[n[0]/255,n[1]/255,n[2]/255,n[3]]}}}Ce.store255={},Ce.store1={};function Rl(i,t=!1){return Array.isArray(i)&&Z(i[0])?t?`rgb(${Math.round(i[0])},${Math.round(i[1])},${Math.round(i[2])},${i[3].toFixed(2)})`:`rgb(${Math.round(i[0])},${Math.round(i[1])},${Math.round(i[2])})`:i}function dr(i,t,e,n,o){return Array.isArray(i)&&!Z(i[0])||Array.isArray(t)&&!Z(t[0])?new Array(4).fill(0).map((r,s)=>Vf(Q(i)?i[s]:i,Q(t)?t[s]:t,e,n)):Vf(i,t,e,n,o)}function Vf(i,t,e,n,o){if(!i||!t)return i&&Rl(i)||t&&Rl(t)||!1;let r,s,l=!1,a=!1;if(Array.isArray(i)?r=i:typeof i=="string"?r=Ce.Get(i,Sn.Color255):l=!0,Array.isArray(t)?s=t:typeof t=="string"?s=Ce.Get(t,Sn.Color255):a=!0,l!==a){const h=l?i:t,d=l?t:i,u=Object.assign(Object.assign({},h),{stops:h.stops.map(c=>Object.assign(Object.assign({},c),{color:Rl(d)}))});return l?dr(h,u,e,n,o):dr(u,h,e,n,o)}if(l){if(i.gradient===t.gradient){const h=i,d=t,u=h.stops,c=d.stops;if(u.length!==c.length)return!1;if(h.gradient==="linear")return fS(h,d,e);if(h.gradient==="radial")return pS(h,d,e);if(h.gradient==="conical")return vS(h,d,e)}return!1}return o&&o(r,s),Rl(mS(r,s,e),n)}function fS(i,t,e){const n=i.stops,o=t.stops;return{gradient:"linear",x0:i.x0+(t.x0-i.x0)*e,x1:i.x1+(t.x1-i.x1)*e,y0:i.y0+(t.y0-i.y0)*e,y1:i.y1+(t.y1-i.y1)*e,stops:new Array(n.length).fill(0).map((r,s)=>({color:Bg(n[s].color,o[s].color,e),offset:n[s].offset+(o[s].offset-n[s].offset)*e}))}}function pS(i,t,e){const n=i.stops,o=t.stops;return{gradient:"radial",x0:i.x0+(t.x0-i.x0)*e,x1:i.x1+(t.x1-i.x1)*e,y0:i.y0+(t.y0-i.y0)*e,y1:i.y1+(t.y1-i.y1)*e,r0:i.r0+(t.r0-i.r0)*e,r1:i.r1+(t.r1-i.r1)*e,stops:new Array(n.length).fill(0).map((r,s)=>({color:Bg(n[s].color,o[s].color,e),offset:n[s].offset+(o[s].offset-n[s].offset)*e}))}}function vS(i,t,e){const n=i.stops,o=t.stops;return{gradient:"conical",startAngle:i.startAngle+(t.startAngle-i.startAngle)*e,endAngle:i.endAngle+(t.endAngle-i.endAngle)*e,x:i.x+(t.x-i.x)*e,y:i.y+(t.y-i.y)*e,stops:new Array(n.length).fill(0).map((r,s)=>({color:Bg(n[s].color,o[s].color,e),offset:n[s].offset+(o[s].offset-n[s].offset)*e}))}}function mS(i,t,e){return[i[0]+(t[0]-i[0])*e,i[1]+(t[1]-i[1])*e,i[2]+(t[2]-i[2])*e,i[3]+(t[3]-i[3])*e]}const dn=[0,0,0,0],Yr=[0,0,0,0];function Bg(i,t,e){return Ce.Get(i,Sn.Color255,dn),Ce.Get(t,Sn.Color255,Yr),`rgba(${Math.round(dn[0]+(Yr[0]-dn[0])*e)},${Math.round(dn[1]+(Yr[1]-dn[1])*e)},${Math.round(dn[2]+(Yr[2]-dn[2])*e)},${dn[3]+(Yr[3]-dn[3])*e})`}class Wt{static GetImage(t,e){var n;const o=Wt.cache.get(t);o?o.loadState==="fail"?G.global.getRequestAnimationFrame()(()=>{e.imageLoadFail(t)}):o.loadState==="init"||o.loadState==="loading"?(n=o.waitingMark)===null||n===void 0||n.push(e):e&&e.imageLoadSuccess(t,o.data):Wt.loadImage(t,e)}static GetSvg(t,e){var n;let o=Wt.cache.get(t);o?o.loadState==="fail"?G.global.getRequestAnimationFrame()(()=>{e.imageLoadFail(t)}):o.loadState==="init"||o.loadState==="loading"?(n=o.waitingMark)===null||n===void 0||n.push(e):e&&e.imageLoadSuccess(t,o.data):(o={type:"image",loadState:"init"},Wt.cache.set(t,o),o.dataPromise=G.global.loadSvg(t),o.dataPromise?(o.waitingMark=[e],o.dataPromise.then(r=>{var s;o.loadState=r!=null&&r.data?"success":"fail",o.data=r==null?void 0:r.data,(s=o.waitingMark)===null||s===void 0||s.map((l,a)=>{r!=null&&r.data?(o.loadState="success",o.data=r.data,l.imageLoadSuccess(t,r.data)):(o.loadState="fail",l.imageLoadFail(t))}),o.waitingMark&&(o.waitingMark=[])})):(o.loadState="fail",e.imageLoadFail(t)))}static GetFile(t,e){let n=Wt.cache.get(t);return n?n.loadState==="fail"?Promise.reject():n.loadState==="init"||n.loadState==="loading"?n.dataPromise.then(o=>o.data):Promise.resolve(n.data):(n={type:e,loadState:"init"},Wt.cache.set(t,n),e==="arrayBuffer"?n.dataPromise=G.global.loadArrayBuffer(t):e==="blob"?n.dataPromise=G.global.loadBlob(t):e==="json"&&(n.dataPromise=G.global.loadJson(t)),n.dataPromise.then(o=>o.data))}static loading(){setTimeout(()=>{if(!Wt.isLoading&&Wt.toLoadAueue.length){Wt.isLoading=!0;const t=Wt.toLoadAueue.splice(0,10),e=[];t.forEach(n=>{const{url:o,marks:r}=n,s={type:"image",loadState:"init"};if(Wt.cache.set(o,s),s.dataPromise=G.global.loadImage(o),s.dataPromise){s.waitingMark=r;const l=s.dataPromise.then(a=>{var h;s.loadState=a!=null&&a.data?"success":"fail",s.data=a==null?void 0:a.data,(h=s.waitingMark)===null||h===void 0||h.map((d,u)=>{a!=null&&a.data?(s.loadState="success",s.data=a.data,d.imageLoadSuccess(o,a.data)):(s.loadState="fail",d.imageLoadFail(o))}),s.waitingMark&&(s.waitingMark=[])});e.push(l)}else s.loadState="fail",r.forEach(l=>l.imageLoadFail(o))}),Promise.all(e).then(()=>{Wt.isLoading=!1,this.onLoadSuccessCb.forEach(n=>n()),Wt.loading()}).catch(n=>{console.error(n),Wt.isLoading=!1,this.onLoadSuccessCb.forEach(o=>o()),Wt.loading()})}},0)}static loadImage(t,e){const n=Gf(t,Wt.toLoadAueue);if(n!==-1)return Wt.toLoadAueue[n].marks.push(e),void Wt.loading();Wt.toLoadAueue.push({url:t,marks:[e]}),Wt.loading()}static improveImageLoading(t){const e=Gf(t,Wt.toLoadAueue);if(e!==-1){const n=Wt.toLoadAueue.splice(e,1);Wt.toLoadAueue.unshift(n[0])}}static onLoadSuccess(t){this.onLoadSuccessCb.push(t)}}function Gf(i,t){for(let e=0;e<t.length;e++)if(t[e].url===i)return e;return-1}Wt.cache=new Map,Wt.isLoading=!1,Wt.toLoadAueue=[],Wt.onLoadSuccessCb=[];const bS=new Pe,jf=new Gt,Ti=["lineWidth","scaleX","scaleY","angle","anchor","visible"],Uf=["x","y"],$f=["scaleX","scaleY"],Kf=["angle"],Xr=new ye,Vi={strokeSeg:1,boundsPadding:2,pickMode:1,boundsMode:1,customPickShape:1,pickable:1,childrenPickable:1,visible:1,zIndex:1,layout:1,keepDirIn3d:1,globalZIndex:1,outerBorder:1,innerBorder:1,lineDash:1,lineCap:1,lineJoin:1,miterLimit:2,strokeBoundsBuffer:2,scaleCenter:1,anchor:1,anchor3d:1,postMatrix:1,backgroundMode:2,background:1,texture:1,cursor:1,html:1};class ti extends rS{static mixin(t){const e=Object.keys(t);for(let n=0;n<e.length;++n){const o=e[n];Object.defineProperty(ti.prototype,o,Object.getOwnPropertyDescriptor(t,o))}}get AABBBounds(){return this.tryUpdateAABBBounds(this.attribute.boundsMode==="imprecise")}get OBBBounds(){return this.tryUpdateOBBBounds()}get globalAABBBounds(){return this.tryUpdateGlobalAABBBounds()}get transMatrix(){return this.tryUpdateLocalTransMatrix(!0)}get globalTransMatrix(){return this.tryUpdateGlobalTransMatrix(!0)}constructor(t={}){var e;super(),this._AABBBounds=new Gt,this._updateTag=Nt.INIT,this.attribute=t,this.valid=this.isValid(),this.updateAABBBoundsStamp=0,t.background?this.loadImage((e=t.background.background)!==null&&e!==void 0?e:t.background,!0):t.shadowGraphic&&this.setShadowGraphic(t.shadowGraphic)}setMode(t){t==="3d"?this.set3dMode():this.set2dMode()}set3dMode(){this.in3dMode=!0}set2dMode(){this.in3dMode=!1}getOffsetXY(t,e=!1){var n,o;const{dx:r=t.dx,dy:s=t.dy}=this.attribute;if(e&&this.parent){const l=this.parent.attribute;Xr.x=r+((n=l.scrollX)!==null&&n!==void 0?n:0),Xr.y=s+((o=l.scrollY)!==null&&o!==void 0?o:0)}else Xr.x=r,Xr.y=s;return Xr}onAnimateBind(t){this._emitCustomEvent("animate-bind",t)}tryUpdateAABBBounds(t){if(!this.shouldUpdateAABBBounds())return this._AABBBounds;if(!this.valid)return this._AABBBounds.clear(),this._AABBBounds;G.graphicService.beforeUpdateAABBBounds(this,this.stage,!0,this._AABBBounds);const e=this.doUpdateAABBBounds(t);return G.graphicService.afterUpdateAABBBounds(this,this.stage,this._AABBBounds,this,!0),e}tryUpdateOBBBounds(){return this._OBBBounds||(this._OBBBounds=new py),this.tryUpdateAABBBounds(),this.updateOBBBoundsStamp===this.updateAABBBoundsStamp?this._OBBBounds:(this.updateOBBBoundsStamp=this.updateAABBBoundsStamp,this.valid?this.doUpdateOBBBounds():(this._OBBBounds.clear(),this._OBBBounds))}combindShadowAABBBounds(t){if(this.shadowRoot){const e=this.shadowRoot.AABBBounds.clone();t.union(e)}}doUpdateOBBBounds(){return this._OBBBounds}doUpdateAABBBounds(t){this.updateAABBBoundsStamp++;const e=this.getGraphicTheme();this._AABBBounds.clear();const n=this.attribute,o=this.updateAABBBounds(n,e,this._AABBBounds,t),{boundsPadding:r=e.boundsPadding}=n,s=ga(r);return s&&o.expand(s),this.clearUpdateBoundTag(),o}updatePathProxyAABBBounds(t){const e=typeof this.pathProxy=="function"?this.pathProxy(this.attribute):this.pathProxy;if(!e)return!1;const n=new wg(t);return Qn(e.commandList,n,0,0),!0}tryUpdateGlobalAABBBounds(){const t=this.AABBBounds;return this._globalAABBBounds?this._globalAABBBounds.setValue(t.x1,t.y1,t.x2,t.y2):this._globalAABBBounds=t.clone(),this._globalAABBBounds.empty()||this.parent&&this._globalAABBBounds.transformWithMatrix(this.parent.globalTransMatrix),this._globalAABBBounds}tryUpdateGlobalTransMatrix(t=!0){if(this._globalTransMatrix){if(this.parent){const e=this.parent.globalTransMatrix;this._globalTransMatrix.setValue(e.a,e.b,e.c,e.d,e.e,e.f)}}else this._globalTransMatrix=this.parent?this.parent.globalTransMatrix.clone():this.transMatrix.clone();return this.shouldUpdateGlobalMatrix()&&this.doUpdateGlobalMatrix(),this._globalTransMatrix}shouldUpdateGlobalMatrix(){return!0}tryUpdateLocalTransMatrix(t=!0){return this._transMatrix||(this._transMatrix=new Pe),this.shouldUpdateLocalMatrix()&&(this.doUpdateLocalMatrix(),t&&this.clearUpdateLocalPositionTag()),this._transMatrix}shouldUpdateAABBBounds(){return this.shadowRoot?(!!(this._updateTag&Nt.UPDATE_BOUNDS)||this.shadowRoot.shouldUpdateAABBBounds())&&G.graphicService.validCheck(this.attribute,this.getGraphicTheme(),this._AABBBounds,this):!!(this._updateTag&Nt.UPDATE_BOUNDS)&&G.graphicService.validCheck(this.attribute,this.getGraphicTheme(),this._AABBBounds,this)}shouldSelfChangeUpdateAABBBounds(){return this.shadowRoot?!!(this._updateTag&Nt.UPDATE_BOUNDS)||this.shadowRoot.shouldUpdateAABBBounds():!!(this._updateTag&Nt.UPDATE_BOUNDS)}shouldUpdateLocalMatrix(){return!!(this._updateTag&Nt.UPDATE_LOCAL_MATRIX)}isValid(){var t,e;const n=this.attribute;return Number.isFinite(((t=n.x)!==null&&t!==void 0?t:0)+((e=n.y)!==null&&e!==void 0?e:0))}_validNumber(t){return t==null||Number.isFinite(t)}shouldUpdateShape(){return!!(this._updateTag&Nt.UPDATE_SHAPE)}clearUpdateShapeTag(){this._updateTag&=Nt.CLEAR_SHAPE}containsPoint(t,e,n,o){if(!o)return!1;if(n===Ts.GLOBAL){const r=new ye(t,e);this.parent&&this.parent.globalTransMatrix.transformPoint(r,r),t=r.x,e=r.y}return o.containsPoint(this,{x:t,y:e})}setAttributes(t,e=!1,n){(t=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate(t,this.attribute,null,n)||t).background?this.loadImage(t.background,!0):t.shadowGraphic&&this.setShadowGraphic(t.shadowGraphic),this._setAttributes(t,e,n)}_setAttributes(t,e=!1,n){const o=Object.keys(t);for(let r=0;r<o.length;r++){const s=o[r];this.attribute[s]=t[s]}this.valid=this.isValid(),this.updateShapeAndBoundsTagSetted()||!e&&!this.needUpdateTags(o)?this.addUpdateBoundTag():this.addUpdateShapeAndBoundsTag(),this.addUpdatePositionTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(n)}setAttribute(t,e,n,o){var r;const s=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({[t]:e},this.attribute,t,o);s?this._setAttributes(s,n,o):Pt((r=this.normalAttrs)===null||r===void 0?void 0:r[t])?(this.attribute[t]=e,this.valid=this.isValid(),this.updateShapeAndBoundsTagSetted()||!n&&!this.needUpdateTag(t)?this.addUpdateBoundTag():this.addUpdateShapeAndBoundsTag(),this.addUpdatePositionTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(o)):this.normalAttrs[t]=e,t==="background"?this.loadImage(e,!0):t==="shadowGraphic"&&this.setShadowGraphic(e)}needUpdateTags(t,e=Ti){for(let n=0;n<e.length;n++){const o=e[n];if(t.indexOf(o)!==-1)return!0}return!1}needUpdateTag(t,e=Ti){for(let n=0;n<e.length;n++)if(t===e[n])return!0;return!1}initAttributes(t){const e={type:Ye.INIT};t=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate(t,this.attribute,null,e)||t,this.attribute=t,t.background?this.loadImage(t.background,!0):t.shadowGraphic&&this.setShadowGraphic(t.shadowGraphic),this._updateTag=Nt.INIT,this.valid=this.isValid(),this.onAttributeUpdate(e)}translate(t,e){var n,o;if(t===0&&e===0)return this;const r={type:Ye.TRANSLATE},s=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({x:t,y:e},this.attribute,Uf,r);s&&(t=s.x,e=s.y,delete s.x,delete s.y,this._setAttributes(s));const l=this.attribute,a=l.postMatrix;return a?G.transformUtil.fromMatrix(a,a).translate(t,e):(l.x=((n=l.x)!==null&&n!==void 0?n:_e.x)+t,l.y=((o=l.y)!==null&&o!==void 0?o:_e.y)+e),this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(r),this}translateTo(t,e){const n=this.attribute;if(n.x===t&&n.y===e)return this;const o={type:Ye.TRANSLATE_TO},r=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({x:t,y:e},this.attribute,Uf,o);return r?(this._setAttributes(r,!1,o),this):(n.x=t,n.y=e,this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(o),this)}scale(t,e,n){var o,r;if(t===1&&e===1)return this;const s={type:Ye.SCALE},l=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({scaleX:t,scaleY:e,scaleCenter:n},this.attribute,$f,s);l&&(t=l.scaleX,e=l.scaleY,delete l.scaleX,delete l.scaleY,this._setAttributes(l));const a=this.attribute;if(n){let{postMatrix:h}=this.attribute;h||(h=new Pe,a.postMatrix=h),G.transformUtil.fromMatrix(h,h).scale(t,e,n)}else a.scaleX=((o=a.scaleX)!==null&&o!==void 0?o:_e.scaleX)*t,a.scaleY=((r=a.scaleY)!==null&&r!==void 0?r:_e.scaleY)*e;return this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(s),this}scaleTo(t,e){const n=this.attribute;if(n.scaleX===t&&n.scaleY===e)return this;const o={type:Ye.SCALE_TO},r=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({scaleX:t,scaleY:e},this.attribute,$f,o);return r?(this._setAttributes(r,!1,o),this):(n.scaleX=t,n.scaleY=e,this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(o),this)}rotate(t,e){var n;if(t===0)return this;const o={type:Ye.ROTATE},r=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({angle:t,rotateCenter:e},this.attribute,Kf,o);r&&(delete r.angle,this._setAttributes(r,!1,o));const s=this.attribute;if(e){let{postMatrix:l}=this.attribute;l||(l=new Pe,s.postMatrix=l),G.transformUtil.fromMatrix(l,l).rotate(t,e)}else s.angle=((n=s.angle)!==null&&n!==void 0?n:_e.angle)+t;return this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(o),this}rotateTo(t){const e=this.attribute;if(e.angle===t)return this;const n={type:Ye.ROTATE_TO},o=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate(t,this.attribute,Kf,n);return o?(this._setAttributes(o,!1,n),this):(e.angle=t,this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(n),this)}skewTo(t,e){return this}animate(t){this.animates||(this.animates=new Map);const e=new _n(t==null?void 0:t.id,this.stage&&this.stage.getTimeline(),t==null?void 0:t.slience);if(e.bind(this),t){const{onStart:n,onFrame:o,onEnd:r,onRemove:s}=t;n!=null&&e.onStart(n),o!=null&&e.onFrame(o),r!=null&&e.onEnd(r),s!=null&&e.onRemove(s),e.interpolateFunc=t.interpolate}return this.animates.set(e.id,e),e.onRemove(()=>{this.animates.delete(e.id)}),e}onAttributeUpdate(t){t&&t.skipUpdateCallback||(G.graphicService.onAttributeUpdate(this),this._emitCustomEvent("afterAttributeUpdate",t))}update(t){t?(t.bounds&&this.tryUpdateAABBBounds(this.attribute.boundsMode==="imprecise"),t.trans&&this.tryUpdateLocalTransMatrix()):(this.tryUpdateAABBBounds(this.attribute.boundsMode==="imprecise"),this.tryUpdateLocalTransMatrix())}hasState(t){return!(!this.currentStates||!this.currentStates.length)&&(!!Pt(t)||this.currentStates.includes(t))}getState(t){var e;return(e=this.states)===null||e===void 0?void 0:e[t]}applyStateAttrs(t,e,n,o){var r,s,l,a;if(n){const h=Object.keys(t),d=this.getNoWorkAnimateAttr(),u={};let c;h.forEach(g=>{d[g]?(c||(c={}),c[g]=t[g]):u[g]=o&&t[g]===void 0?this.getDefaultAttribute(g):t[g]});const f=this.animate({slience:!0});f.stateNames=e,f.to(u,(s=(r=this.stateAnimateConfig)===null||r===void 0?void 0:r.duration)!==null&&s!==void 0?s:Of.duration,(a=(l=this.stateAnimateConfig)===null||l===void 0?void 0:l.easing)!==null&&a!==void 0?a:Of.easing),c&&this.setAttributes(c,!1,{type:Ye.STATE})}else this.stopStateAnimates(),this.setAttributes(t,!1,{type:Ye.STATE})}updateNormalAttrs(t){const e={};this.normalAttrs?(Object.keys(t).forEach(n=>{n in this.normalAttrs?(e[n]=this.normalAttrs[n],delete this.normalAttrs[n]):e[n]=this.getNormalAttribute(n)}),Object.keys(this.normalAttrs).forEach(n=>{t[n]=this.normalAttrs[n]})):Object.keys(t).forEach(n=>{e[n]=this.getNormalAttribute(n)}),this.normalAttrs=e}stopStateAnimates(t="end"){this.animates&&this.animates.forEach(e=>{e.stateNames&&(e.stop(t),this.animates.delete(e.id))})}getNormalAttribute(t){let e=this.attribute[t];return this.animates&&this.animates.forEach(n=>{if(n.stateNames){const o=n.getEndProps();kb(o,t)&&(e=o[t])}}),e}clearStates(t){this.hasState()&&this.normalAttrs?(this.currentStates=[],this.applyStateAttrs(this.normalAttrs,this.currentStates,t,!0)):this.currentStates=[],this.normalAttrs=null}removeState(t,e){if((this.currentStates?this.currentStates.indexOf(t):-1)>=0){const n=this.currentStates.filter(o=>o!==t);this.useStates(n,e)}}toggleState(t,e){if(this.hasState(t))this.removeState(t,e);else if((this.currentStates?this.currentStates.indexOf(t):-1)<0){const n=this.currentStates?this.currentStates.slice():[];n.push(t),this.useStates(n,e)}}addState(t,e,n){var o;if(this.currentStates&&this.currentStates.includes(t)&&(e||this.currentStates.length===1))return;const r=e&&(!((o=this.currentStates)===null||o===void 0)&&o.length)?this.currentStates.concat([t]):[t];this.useStates(r,n)}useStates(t,e){var n;if(!t.length)return void this.clearStates(e);if(!(((n=this.currentStates)===null||n===void 0?void 0:n.length)!==t.length||t.some((r,s)=>this.currentStates[s]!==r)))return;const o={};t.forEach(r=>{var s;const l=this.stateProxy?this.stateProxy(r,t):(s=this.states)===null||s===void 0?void 0:s[r];l&&Object.assign(o,l)}),this.updateNormalAttrs(o),this.currentStates=t,this.applyStateAttrs(o,t,e)}addUpdateBoundTag(){this._updateTag|=Nt.UPDATE_BOUNDS,this.parent&&this.parent.addChildUpdateBoundTag(),this.glyphHost&&this.glyphHost.addUpdateBoundTag()}addUpdateShapeTag(){this._updateTag|=Nt.UPDATE_SHAPE}addUpdateShapeAndBoundsTag(){this._updateTag|=Nt.UPDATE_SHAPE_AND_BOUNDS,this.parent&&this.parent.addChildUpdateBoundTag(),this.glyphHost&&this.glyphHost.addUpdateBoundTag()}updateShapeAndBoundsTagSetted(){return(this._updateTag&Nt.UPDATE_SHAPE_AND_BOUNDS)===Nt.UPDATE_SHAPE_AND_BOUNDS}clearUpdateBoundTag(){this._updateTag&=Nt.CLEAR_BOUNDS}addUpdatePositionTag(){this.shadowRoot&&this.shadowRoot.addUpdateGlobalPositionTag(),this._updateTag|=Nt.UPDATE_GLOBAL_LOCAL_MATRIX}addUpdateGlobalPositionTag(){this.shadowRoot&&this.shadowRoot.addUpdateGlobalPositionTag(),this._updateTag|=Nt.UPDATE_GLOBAL_MATRIX}clearUpdateLocalPositionTag(){this._updateTag&=Nt.CLEAR_LOCAL_MATRIX}clearUpdateGlobalPositionTag(){this._updateTag&=Nt.CLEAR_GLOBAL_MATRIX}addUpdateLayoutTag(){this._updateTag|=Nt.UPDATE_LAYOUT}clearUpdateLayoutTag(){this._updateTag&=Nt.CLEAR_LAYOUT}needUpdateLayout(){return!!(this._updateTag&Nt.UPDATE_LAYOUT)}getAnchor(t,e){const n=[0,0],o=()=>{if(e.b)return e.b;const{scaleX:r,scaleY:s,angle:l}=this.attribute;return jf.copy(this._AABBBounds),this.setAttributes({scaleX:1,scaleY:1,angle:0}),e.b=this.AABBBounds.clone(),this._AABBBounds.copy(jf),this.setAttributes({scaleX:r,scaleY:s,angle:l}),e.b};if(typeof t[0]=="string"){const r=parseFloat(t[0])/100,s=o();n[0]=s.x1+(s.x2-s.x1)*r}else n[0]=t[0];if(typeof t[1]=="string"){const r=parseFloat(t[1])/100,s=o();n[1]=s.y1+(s.y2-s.y1)*r}else n[1]=t[1];return n}doUpdateLocalMatrix(){const{x:t=_e.x,y:e=_e.y,scaleX:n=_e.scaleX,scaleY:o=_e.scaleY,angle:r=_e.angle,scaleCenter:s,anchor:l,postMatrix:a}=this.attribute;let h=[0,0];const d={};if(l&&(h=this.getAnchor(l,d)),!s||n===1&&o===1)vy(this._transMatrix,this._transMatrix.reset(),t,e,n,o,r,l&&h);else{const c=this._transMatrix;c.reset(),c.translate(h[0],h[1]),c.rotate(r),c.translate(-h[0],-h[1]),c.translate(t,e),h=this.getAnchor(s,d),G.transformUtil.fromMatrix(c,c).scale(n,o,{x:h[0],y:h[1]})}const u=this.getOffsetXY(_e);if(this._transMatrix.e+=u.x,this._transMatrix.f+=u.y,a){const c=bS.setValue(a.a,a.b,a.c,a.d,a.e,a.f),f=this._transMatrix;c.multiply(f.a,f.b,f.c,f.d,f.e,f.f),f.setValue(c.a,c.b,c.c,c.d,c.e,c.f)}}doUpdateGlobalMatrix(){if(this.parent){this._globalTransMatrix.multiply(this.transMatrix.a,this.transMatrix.b,this.transMatrix.c,this.transMatrix.d,this.transMatrix.e,this.transMatrix.f);const{scrollX:t=0,scrollY:e=0}=this.parent.attribute;this._globalTransMatrix.translate(t,e)}}setStage(t,e){if(this.stage!==t){if(this.stage=t,this.layer=e,this.setStageToShadowRoot(t,e),this.animates&&this.animates.size){const n=t.getTimeline();this.animates.forEach(o=>{o.setTimeline(n)})}this._onSetStage&&this._onSetStage(this,t,e),G.graphicService.onSetStage(this,t)}}setStageToShadowRoot(t,e){this.shadowRoot&&this.shadowRoot.setStage(t,e)}onAddStep(t){}onStop(t){t&&this.setAttributes(t,!1,{type:Ye.ANIMATE_END})}onStep(t,e,n,o,r){const s={};if(n.customAnimate)n.customAnimate.update(r,o,s);else{const l=n.props,a=n.parsedProps,h=n.propKeys;this.stepInterpolate(t,e,s,n,o,r,l,void 0,a,h)}this.setAttributes(s,!1,{type:Ye.ANIMATE_UPDATE,animationState:{ratio:o,end:r,step:n,isFirstFrameOfStep:t.getLastStep()!==n}}),this.stage&&this.stage.renderNextFrame()}stepInterpolate(t,e,n,o,r,s,l,a,h,d){d||(d=Object.keys(l),o.propKeys=d),s?o.propKeys.forEach(u=>{e.validAttr(u)&&(n[u]=l[u])}):d.forEach(u=>{var c;if(!e.validAttr(u))return;const f=l[u],g=(c=a&&a[u])!==null&&c!==void 0?c:t.getLastPropByName(u,o);if(f==null||g==null||f===g)return void(n[u]=f);let p;p=e.interpolateFunc&&e.interpolateFunc(u,r,g,f,n),p||(p=e.customInterpolate(u,r,g,f,this,n),p||this.defaultInterpolate(f,g,u,n,h,r)||this._interpolate(u,r,g,f,n))}),o.parsedProps=h}defaultInterpolate(t,e,n,o,r,s){if(Number.isFinite(t))return o[n]=e+(t-e)*s,!0;if(n==="fill"){r||(r={});const l=r.fillColorArray,a=dr(e,l??t,s,!1,(h,d)=>{r.fillColorArray=d});return a&&(o[n]=a),!0}if(n==="stroke"){r||(r={});const l=r.strokeColorArray,a=dr(e,l??t,s,!1,(h,d)=>{r.strokeColorArray=d});return a&&(o[n]=a),!0}if(n==="shadowColor"){r||(r={});const l=r.shadowColorArray,a=dr(e,l??t,s,!0,(h,d)=>{r.shadowColorArray=d});return a&&(o[n]=a),!0}return!1}_interpolate(t,e,n,o,r){}getDefaultAttribute(t){return this.getGraphicTheme()[t]}getComputedAttribute(t){var e;return(e=this.attribute[t])!==null&&e!==void 0?e:this.getDefaultAttribute(t)}onSetStage(t,e=!1){this._onSetStage=t,e&&this.stage&&t(this,this.stage)}attachShadow(t){return t&&(t.shadowHost=this),this.shadowRoot=t??G.graphicService.creator.shadowRoot(this),this.addUpdateBoundTag(),this.shadowRoot.setStage(this.stage,this.layer),this.shadowRoot}detachShadow(){this.shadowRoot&&(this.addUpdateBoundTag(),this.shadowRoot=null)}toJson(){return{attribute:this.attribute,_uid:this._uid,type:this.type,name:this.name,children:this.children.map(t=>t.toJson())}}createPathProxy(t){return jt(t,!0)?this.pathProxy=new Ae().fromString(t):this.pathProxy=new Ae,this.pathProxy}loadImage(t,e=!1){if(!t||e&&CS(t))return;const n=t;this.resources||(this.resources=new Map);const o={data:"init",state:null};this.resources.set(n,o),typeof t=="string"?(o.state="loading",t.startsWith("<svg")?(Wt.GetSvg(t,this),this.backgroundImg=this.backgroundImg||e):(my(t)||t.includes("/")||by(t))&&(Wt.GetImage(t,this),this.backgroundImg=this.backgroundImg||e)):kt(t)?(o.state="success",o.data=t,this.backgroundImg=this.backgroundImg||e):o.state="fail"}setShadowGraphic(t){t?this.attachShadow().add(t):this.detachShadow()}imageLoadSuccess(t,e,n){if(!this.resources)return;const o=this.resources.get(t);o&&(o.state="success",o.data=e,n&&n(),this.addUpdateBoundTag(),this.stage&&this.stage.renderNextFrame())}imageLoadFail(t,e){if(!this.resources)return;const n=this.resources.get(t);n&&(n.state="fail",e&&e())}_stopAnimates(t){t&&t.forEach(e=>{e.stop()})}stopAnimates(t=!1){this._stopAnimates(this.animates),this.shadowRoot&&this.shadowRoot.stopAnimates(!0),this.isContainer&&t&&this.forEachChildren(e=>{e.stopAnimates(t)})}release(){this.releaseStatus="released",G.graphicService.onRelease(this)}_emitCustomEvent(t,e){var n,o;if(this._events&&t in this._events){const r=new Rg(t,e);r.bubbles=!1,r.manager=(o=(n=this.stage)===null||n===void 0?void 0:n.eventSystem)===null||o===void 0?void 0:o.manager,this.dispatchEvent(r)}}}function CS(i){return!(!i.fill&&!i.stroke)}ti.mixin(lS);function _S(i,t){const e=[];let n=t.exec(i);for(;n;){const o=[];o.startIndex=t.lastIndex-n[0].length;const r=n.length;for(let s=0;s<r;s++)o.push(n[s]);e.push(o),n=t.exec(i)}return e}class Dd{constructor(t){this.tagname=t,this.child=[],this[":@"]={}}add(t,e){t==="__proto__"&&(t="#__proto__"),this.child.push({[t]:e})}addChild(t){t.tagname==="__proto__"&&(t.tagname="#__proto__"),t[":@"]&&Object.keys(t[":@"]).length>0?this.child.push({[t.tagname]:t.child,":@":t[":@"]}):this.child.push({[t.tagname]:t.child})}}function Yf(i,t,e,n){const o=i.indexOf(t,e);if(o===-1)throw new Error(n);return o+t.length-1}function wS(i,t,e=">"){let n,o="";for(let r=t;r<i.length;r++){let s=i[r];if(n)s===n&&(n="");else if(s==='"'||s==="'")n=s;else if(s===e[0]){if(!e[1])return{data:o,index:r};if(i[r+1]===e[1])return{data:o,index:r}}else s==="	"&&(s=" ");o+=s}}function Xf(i,t,e,n=">"){const o=wS(i,t+1,n);if(!o)return;let r=o.data;const s=o.index,l=r.search(/\s/);let a=r,h=!0;return l!==-1&&(a=r.substr(0,l).replace(/\s\s*$/,""),r=r.substr(l+1)),{tagName:a,tagExp:r,closeIndex:s,attrExpPresent:h,rawTagName:a}}const yS=new RegExp(`([^\\s=]+)\\s*(=\\s*(['"])([\\s\\S]*?)\\3)?`,"gm");class SS{constructor(t){this.currentNode=null,this.options=t,this.tagsNodeStack=[],this.docTypeEntities={}}addChild(t,e,n){const o=e.tagname;typeof o=="string"&&(e.tagname=o),t.addChild(e)}buildAttributesMap(t,e,n){const o={};if(!t)return;const r=_S(t,yS),s=r.length;for(let l=0;l<s;l++){const a=r[l][1],h=r[l][4],d=a;a&&(o[d]=h===void 0||(isNaN(h)?h:Number(h)))}return o}parseXml(t){t=t.replace(/\r\n?/g,`
`);const e=new Dd("!xml");let n=e,o="",r="";for(let s=0;s<t.length;s++)if(t[s]==="<")if(t[s+1]==="/"){const l=Yf(t,">",s,"Closing Tag is not closed."),a=r.lastIndexOf(".");r=r.substring(0,a),n=this.tagsNodeStack.pop(),n&&n.child&&o&&n.child[n.child.length-1][":@"]&&(n.child[n.child.length-1][":@"].text=o),o="",s=l}else if(t[s+1]==="?")s=Xf(t,s,!1,"?>").closeIndex+1;else if(t.substr(s+1,3)==="!--")s=Yf(t,"-->",s+4,"Comment is not closed.");else{const l=Xf(t,s);let a=l.tagName,h=l.tagExp;const d=l.attrExpPresent,u=l.closeIndex;if(a!==e.tagname&&(r+=r?"."+a:a),h.length>0&&h.lastIndexOf("/")===h.length-1){a[a.length-1]==="/"?(a=a.substr(0,a.length-1),r=r.substr(0,r.length-1),h=a):h=h.substr(0,h.length-1);const c=new Dd(a);a!==h&&d&&(c[":@"]=this.buildAttributesMap(h,r,a)),this.addChild(n,c,r),r=r.substr(0,r.lastIndexOf("."))}else{const c=new Dd(a);this.tagsNodeStack.push(n),a!==h&&d&&(c[":@"]=this.buildAttributesMap(h,r,a)),this.addChild(n,c,r),n=c}o="",s=u}else o+=t[s];return e.child}}function xS(i,t){return mC(i)}function mC(i,t){const e={};for(let n=0;n<i.length;n++){const o=i[n],r=RS(o);if(r!==void 0&&o[r]){const s=mC(o[r]);BS(s),o[":@"]&&AS(s,o[":@"]),e[r]!==void 0&&e.hasOwnProperty(r)?(Array.isArray(e[r])||(e[r]=[e[r]]),e[r].push(s)):e[r]=s}}return e}function RS(i){const t=Object.keys(i);for(let e=0;e<t.length;e++){const n=t[e];if(n!==":@")return n}}function AS(i,t,e){if(t){const n=Object.keys(t),o=n.length;for(let r=0;r<o;r++){const s=n[r];i[s]=t[s]}}}function BS(i){return Object.keys(i).length===0}class Zh{constructor(t){this.options=Object.assign({},Zh.defaultOptions,t)}valid(t){return t.startsWith("<")}parse(t){if(!this.valid)return!1;const e=new SS(this.options).parseXml(t);return xS(e,this.options)}}Zh.defaultOptions={};function MS(i){return i.startsWith("<svg")||i.startsWith("<?xml")}function fa(i,t,e,n=0){return i.expand(t+(n/2+(e?TS(e,t):0))),i}function TS(i,t){return i?t:0}let PS=0;function ke(){return PS++}var ur;(function(i){i[i.HORIZONTAL=0]="HORIZONTAL",i[i.VERTICAL=1]="VERTICAL"})(ur||(ur={}));function HS(i){const t=[];let e=0,n="";for(let o=0;o<i.length;o++)LS(i[o])?e?n+=i[o]:(e=1,n=i[o]):(e&&(t.push({text:n,direction:ur.VERTICAL}),n="",e=0),t.push({text:i[o],direction:ur.HORIZONTAL}));return n&&t.push({text:n,direction:ur.VERTICAL}),t}const kS=["…","（","）","—","【","】","「","」","《","》"],bC=new Map;kS.forEach(i=>bC.set(i,!0));const ES=[""],CC=new Map;function LS(i){if(bC.has(i))return!0;if(CC.has(i))return!1;let t=!1;return i.codePointAt(0)<256&&(t=!0),t}ES.forEach(i=>CC.set(i,!0));const Jh=ke(),FS=ke(),_C=ke(),Qh=ke();ke();const Mg=ke(),td=ke(),nl=ke(),ed=ke(),id=ke();ke();const Tg=ke();ke();const Pg=ke(),nd=ke(),od=ke(),wC=Symbol.for("GraphicService"),yC=Symbol.for("GraphicCreator"),SC={"stroke-linecap":"lineCap","stroke-linejoin":"lineJoin","stroke-dasharray":"lineDash","stroke-dashoffset":"lineDashOffset","stroke-width":"lineWidth","fill-opacity":"fillOpacity","stroke-opacity":"strokeOpacity",stroke:"stroke",fill:"fill"},zS=Object.keys(SC);var qf;(function(i){i[i.LESS_GROUP=0]="LESS_GROUP",i[i.MORE_GROUP=1]="MORE_GROUP"})(qf||(qf={}));let Gi=class zu extends ti{constructor(t){super(t),this.type="group",this.parent=null,this.isContainer=!0,this.numberType=Mg,this._childUpdateTag=Nt.UPDATE_BOUNDS}setMode(t){t==="3d"?this.set3dMode():this.set2dMode()}set3dMode(){this.in3dMode=!0}set2dMode(){this.in3dMode=!1}setTheme(t){return this.theme||(this.theme=new ks),this.theme.setTheme(t,this)}createTheme(){this.theme||(this.theme=new ks)}visibleAll(t){this.setAttribute("visible",t),this.forEachChildren(e=>{e.isContainer&&e.visibleAll?e.visibleAll(t):e.setAttribute("visible",t)})}hideAll(){this.visibleAll(!1)}showAll(){this.visibleAll(!0)}containsPoint(t,e,n){if(n===Ts.GLOBAL){const o=new ye(t,e);return this.parent&&this.parent.globalTransMatrix.transformPoint(o,o),this.AABBBounds.contains(o.x,o.y)}return this.AABBBounds.contains(t,e)}shouldUpdateAABBBounds(){return!!super.shouldUpdateAABBBounds()||!!(this._childUpdateTag&Nt.UPDATE_BOUNDS)}tryUpdateAABBBounds(){if(!this.shouldUpdateAABBBounds())return this._AABBBounds;G.graphicService.beforeUpdateAABBBounds(this,this.stage,!0,this._AABBBounds);const t=this.shouldSelfChangeUpdateAABBBounds(),e=this.doUpdateAABBBounds();return this.addUpdateLayoutTag(),G.graphicService.afterUpdateAABBBounds(this,this.stage,this._AABBBounds,this,t),e}doUpdateLocalMatrix(){const{x:t=_e.x,y:e=_e.y,dx:n=_e.dx,dy:o=_e.dy,scaleX:r=_e.scaleX,scaleY:s=_e.scaleY,angle:l=_e.angle,postMatrix:a}=this.attribute;if(t!==0||e!==0||n!==0||o!==0||r!==1||s!==1||l!==0||a)return super.doUpdateLocalMatrix();this._transMatrix.reset()}getGraphicTheme(){return yt(this).group}updateAABBBounds(t,e,n){const o=n;n=n.clone();const{width:r,height:s,path:l,clip:a=e.clip}=t;if(l&&l.length?l.forEach(h=>{n.union(h.AABBBounds)}):r!=null&&s!=null&&n.set(0,0,Math.max(0,r),Math.max(0,s)),!a){this.forEachChildren(u=>{n.union(u.AABBBounds)});const{scrollX:h=0,scrollY:d=0}=t;n.translate(h,d)}return G.graphicService.updateTempAABBBounds(n),G.graphicService.transformAABBBounds(t,n,e,!1,this),o.copy(n),o}doUpdateAABBBounds(){this.updateAABBBoundsStamp++;const t=super.doUpdateAABBBounds();return this.parent&&this.parent.addChildUpdateBoundTag(),this._emitCustomEvent("AAABBBoundsChange"),t}clearUpdateBoundTag(){this._updateTag&=Nt.CLEAR_BOUNDS,this._childUpdateTag&=Nt.CLEAR_BOUNDS}addUpdateBoundTag(){this._updateTag|=Nt.UPDATE_BOUNDS,this.parent&&this.parent.addChildUpdateBoundTag()}addChildUpdateBoundTag(){this._childUpdateTag&Nt.UPDATE_BOUNDS||(this._childUpdateTag|=Nt.UPDATE_BOUNDS,this.parent&&this.parent.addChildUpdateBoundTag())}getTheme(){return this.theme.getTheme(this)}incrementalAppendChild(t){const e=super.appendChild(t);return this.stage&&e&&(e.stage=this.stage,e.layer=this.layer),this.addUpdateBoundTag(),G.graphicService.onAddIncremental(t,this,this.stage),e}incrementalClearChild(){super.removeAllChild(),this.addUpdateBoundTag(),G.graphicService.onClearIncremental(this,this.stage)}_updateChildToStage(t){return this.stage&&t&&t.setStage(this.stage,this.layer),this.addUpdateBoundTag(),t}appendChild(t,e=!0){const n=super.appendChild(t);return e&&this.stage&&n&&n.setStage(this.stage,this.layer),this.addUpdateBoundTag(),n}insertBefore(t,e){return this._updateChildToStage(super.insertBefore(t,e))}insertAfter(t,e){return this._updateChildToStage(super.insertAfter(t,e))}insertInto(t,e){return this._updateChildToStage(super.insertInto(t,e))}removeChild(t){const e=super.removeChild(t);return t.stage=null,G.graphicService.onRemove(t),this.addUpdateBoundTag(),e}removeAllChild(t=!1){this.forEachChildren(e=>{G.graphicService.onRemove(e),t&&e.isContainer&&e.removeAllChild(t)}),super.removeAllChild(),this.addUpdateBoundTag()}setStage(t,e){this.stage!==t&&(this.stage=t,this.layer=e,this.setStageToShadowRoot(t,e),this._onSetStage&&this._onSetStage(this,t,e),G.graphicService.onSetStage(this,t),this.forEachChildren(n=>{n.setStage(t,this.layer)}))}addUpdatePositionTag(){super.addUpdatePositionTag(),this.forEachChildren(t=>{t.isContainer&&t.addUpdateGlobalPositionTag()})}addUpdateGlobalPositionTag(){super.addUpdateGlobalPositionTag(),this.forEachChildren(t=>{t.isContainer&&t.addUpdateGlobalPositionTag()})}tryUpdateGlobalTransMatrix(t=!0){if(this.shouldUpdateGlobalMatrix()){if(this._globalTransMatrix){if(this.parent){const e=this.parent.globalTransMatrix;this._globalTransMatrix.setValue(e.a,e.b,e.c,e.d,e.e,e.f)}}else this._globalTransMatrix=this.parent?this.parent.globalTransMatrix.clone():this.transMatrix.clone();this.doUpdateGlobalMatrix(),t&&this.clearUpdateGlobalPositionTag()}return this._globalTransMatrix}shouldUpdateGlobalMatrix(){return!!(this._updateTag&Nt.UPDATE_GLOBAL_MATRIX)}_getChildByName(t,e){return this.find(n=>n.name===t,e)}createOrUpdateChild(t,e,n){let o=this._getChildByName(t);return o?o.setAttributes(e):(o=G.graphicService.creator[n](e),o.name=t,this.add(o)),o}clone(){return new zu(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return zu.NOWORK_ANIMATE_ATTR}};Gi.NOWORK_ANIMATE_ATTR=Vi;function pa(i){return new Gi(i)}class IS extends Gi{get offscreen(){return this.layerHandler.offscreen}get layerMode(){return this.layerHandler.type}get width(){return this.stage?this.stage.width:0}get height(){return this.stage?this.stage.height:0}get viewWidth(){return this.stage?this.stage.viewWidth:0}get viewHeight(){return this.stage?this.stage.viewHeight:0}get dirtyBound(){throw new Error("暂不支持")}get dpr(){return this._dpr}constructor(t,e,n,o){var r;super({}),this.stage=t,this.global=e,this.window=n,this.main=o.main,this.layerHandler=o.layerHandler,this.layerHandler.init(this,n,{main:o.main,canvasId:o.canvasId,width:this.viewWidth,height:this.viewHeight,zIndex:(r=o.zIndex)!==null&&r!==void 0?r:0}),this.layer=this,this.subLayers=new Map,this.theme=new ks,this.background="rgba(0, 0, 0, 0)",this.afterDrawCbs=[]}combineSubLayer(t=!0){const e=Array.from(this.subLayers.values()).sort((n,o)=>n.zIndex-o.zIndex);this.layerHandler.merge(e.map(n=>(n.layer.subLayers.size&&n.layer.combineSubLayer(t),n.layer.getNativeHandler()))),t&&e.forEach(n=>{n.group&&(n.group.incremental=0)}),e.forEach(n=>{G.layerService.releaseLayer(this.stage,n.layer)}),this.subLayers.clear()}getNativeHandler(){return this.layerHandler}setStage(t,e){super.setStage(t,this)}pick(t,e){throw new Error("暂不支持")}tryRenderSecondaryLayer(t,e){this.layerHandler.secondaryHandlers&&this.layerHandler.secondaryHandlers.length&&this.layerHandler.secondaryHandlers.forEach(n=>{n.layer.renderCount=this.renderCount,n.layer.render(t,e)})}render(t,e){var n;this.layerHandler.render([this],{renderService:t.renderService,stage:this.stage,layer:this,viewBox:t.viewBox,transMatrix:t.transMatrix,background:(n=t.background)!==null&&n!==void 0?n:this.background,updateBounds:t.updateBounds},e),this.afterDrawCbs.forEach(o=>o(this)),this.tryRenderSecondaryLayer(t,e)}resize(t,e){this.layerHandler.resize(t,e)}resizeView(t,e){this.layerHandler.resizeView(t,e)}setDpr(t){this.layerHandler.setDpr(t)}afterDraw(t){this.afterDrawCbs.push(t)}startAnimate(t){throw new Error("暂不支持")}setToFrame(t){throw new Error("暂不支持")}prepare(t,e){}release(){super.release(),this.layerHandler.release(),this.subLayers&&this.subLayers.forEach(t=>{G.layerService.releaseLayer(this.stage,t.layer)})}drawTo(t,e){var n;this.layerHandler.drawTo(t,[this],Object.assign({background:(n=e.background)!==null&&n!==void 0?n:this.background,renderService:e.renderService,viewBox:e.viewBox,transMatrix:e.transMatrix,stage:this.stage,layer:this},e)),this.afterDrawCbs.forEach(o=>o(this))}}const xC=Symbol.for("TransformUtil"),RC=Symbol.for("GraphicUtil"),Hg=Symbol.for("LayerService"),AC=Symbol.for("StaticLayerHandlerContribution"),OS=Symbol.for("DynamicLayerHandlerContribution"),DS=Symbol.for("VirtualLayerHandlerContribution");var ss,WS=function(i,t,e,n){var o,r=arguments.length,s=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var l=i.length-1;l>=0;l--)(o=i[l])&&(s=(r<3?o(s):r>3?o(t,e,s):o(t,e))||s);return r>3&&s&&Object.defineProperty(t,e,s),s},NS=function(i,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,t)};let ls=ss=class{static GenerateLayerId(){return`${ss.idprefix}_${ss.prefix_count++}`}constructor(){this.layerMap=new Map,this.global=G.global}tryInit(){this.inited||(this.staticLayerCountInEnv=this.global.getStaticCanvasCount(),this.dynamicLayerCountInEnv=this.global.getDynamicCanvasCount(),this.inited=!0)}getStageLayer(i){return this.layerMap.get(i)}getRecommendedLayerType(i){return i||(this.staticLayerCountInEnv!==0?"static":this.dynamicLayerCountInEnv!==0?"dynamic":"virtual")}getLayerHandler(i){let t;return t=i==="static"?bt.get(AC):i==="dynamic"?bt.get(OS):bt.get(DS),t}createLayer(i,t={main:!1}){var e;this.tryInit();let n=this.getRecommendedLayerType(t.layerMode);n=t.main||t.canvasId?"static":n;const o=this.getLayerHandler(n),r=new IS(i,this.global,i.window,Object.assign(Object.assign({main:!1},t),{layerMode:n,canvasId:(e=t.canvasId)!==null&&e!==void 0?e:ss.GenerateLayerId(),layerHandler:o})),s=this.layerMap.get(i)||[];return s.push(r),this.layerMap.set(i,s),this.staticLayerCountInEnv--,r}prepareStageLayer(i){let t;i.forEachChildren(e=>{const n=e.getNativeHandler();n.type==="virtual"?(n.mainHandler=t,t.secondaryHandlers.push(n)):(t=n,t.secondaryHandlers=[])})}releaseLayer(i,t){t.release();const e=this.layerMap.get(i)||[];this.layerMap.set(i,e.filter(n=>n!==t))}layerCount(i){return(this.layerMap.get(i)||[]).length}restLayerCount(i){return this.global.env==="browser"?10:0}releaseStage(i){this.layerMap.delete(i)}};ls.idprefix="visactor_layer",ls.prefix_count=0,ls=ss=WS([st(),NS("design:paramtypes",[])],ls);const VS=new Ct(i=>{i(_g).to(Ru).inSingletonScope(),i(Hs).to(ku),i(RC).to(Eu).inSingletonScope(),i(xC).to(Lu).inSingletonScope(),i(Hg).to(ls).inSingletonScope()});function zr(i,t){return!(!i&&!t)}function ol(i,t){let e;return e=Q(i)?i.some(n=>n||n===void 0):!!i,e&&t>0}function Ho(i,t,e){return e&&i*t>0}function BC(i,t,e,n,o){return o&&i*t>0&&e!==0&&n!==0}function kg(i,t){return i*t>0}function MC(i,t,e,n){return i*t>0&&e!==0&&n!==0}function GS(i,t,e,n,o,r,s,l){if(!i.pathProxy)return!1;const a=yt(i,r==null?void 0:r.theme)[i.type.replace("3d","")],{fill:h=a.fill,stroke:d=a.stroke,opacity:u=a.opacity,fillOpacity:c=a.fillOpacity,lineWidth:f=a.lineWidth,strokeOpacity:g=a.strokeOpacity,visible:p=a.visible,x:v=a.x,y:m=a.y}=i.attribute,b=Ho(u,c,h),C=kg(u,g),_=zr(h),w=ol(d,f);if(!p||!_&&!w||!(b||C||s||l))return!0;t.beginPath();const y=typeof i.pathProxy=="function"?i.pathProxy(i.attribute):i.pathProxy;return Qn(y.commandList,t,e,n),t.setShadowBlendStyle&&t.setShadowBlendStyle(i,i.attribute,a),w&&C&&(t.setStrokeStyle(i,i.attribute,e-v,n-m,a),t.stroke()),_&&b&&(t.setCommonStyle(i,i.attribute,e-v,n-m,a),t.fill()),!0}function jS(i,t,e,n,o,r,s,l){const a=e-i,h=n-t,d=s-o,u=l-r;let c=u*a-d*h;return c*c<Kt?[]:(c=(d*(t-r)-u*(i-o))/c,[i+c*a,t+c*h])}function $n(i,t,e,n,o,r,s){const l=i-e,a=t-n,h=(s?r:-r)/Math.sqrt(l*l+a*a),d=h*a,u=-h*l,c=i+d,f=t+u,g=e+d,p=n+u,v=(c+g)/2,m=(f+p)/2,b=g-c,C=p-f,_=b*b+C*C,w=o-r,y=c*p-g*f,x=(C<0?-1:1)*Math.sqrt(Math.max(0,w*w*_-y*y));let S=(y*C-b*x)/_,R=(-y*b-C*x)/_;const B=(y*C+b*x)/_,A=(-y*b+C*x)/_,M=S-v,k=R-m,E=B-v,T=A-m;return M*M+k*k>E*E+T*T&&(S=B,R=A),{cx:S,cy:R,x01:-d,y01:-u,x11:S*(o/w-1),y11:R*(o/w-1)}}function TC(i,t,e,n,o){const r=Dt(e-t),s=i.getParsedCornerRadius(),l=Q(s),{outerDeltaAngle:a,innerDeltaAngle:h,outerStartAngle:d,outerEndAngle:u,innerEndAngle:c,innerStartAngle:f}=i.getParsePadAngle(t,e),g=l?s[0]:s,p=l?s[1]:s,v=l?s[2]:s,m=l?s[3]:s,b=Math.max(p,g),C=Math.max(v,m);let _=b,w=C;const y=o*ve(d),x=o*ie(d),S=n*ve(c),R=n*ie(c);let B,A,M,k;if((C>Kt||b>Kt)&&(B=o*ve(u),A=o*ie(u),M=n*ve(f),k=n*ie(f),r<Xt)){const E=jS(y,x,M,k,B,A,S,R);if(E){const T=y-E[0],P=x-E[1],H=B-E[0],L=A-E[1],F=1/ie(Cy((T*H+P*L)/(Xn(T*T+P*P)*Xn(H*H+L*L)))/2),z=Xn(E[0]*E[0]+E[1]*E[1]);w=Ie(C,(n-z)/(F-1)),_=Ie(b,(o-z)/(F+1))}}return{outerDeltaAngle:a,xors:y,yors:x,xirs:M,yirs:k,xore:B,yore:A,xire:S,yire:R,limitedOcr:_,limitedIcr:w,outerCornerRadiusStart:g,outerCornerRadiusEnd:p,maxOuterCornerRadius:b,maxInnerCornerRadius:C,outerStartAngle:d,outerEndAngle:u,innerDeltaAngle:h,innerEndAngle:c,innerStartAngle:f,innerCornerRadiusStart:m,innerCornerRadiusEnd:v}}function Iu(i,t,e,n,o,r,s){const{startAngle:l,endAngle:a}=i.getParsedAngle(),h=Dt(a-l),d=a>l;let u=!1;if(o<r){const c=o;o=r,r=c}if(o<=Kt)t.moveTo(e,n);else if(h>=Vt-Kt)t.moveTo(e+o*ve(l),n+o*ie(l)),t.arc(e,n,o,l,a,!d),r>Kt&&(t.moveTo(e+r*ve(a),n+r*ie(a)),t.arc(e,n,r,a,l,d));else{const{outerDeltaAngle:c,xors:f,yors:g,xirs:p,yirs:v,limitedOcr:m,outerCornerRadiusStart:b,outerCornerRadiusEnd:C,maxOuterCornerRadius:_,xore:w,yore:y,xire:x,yire:S,outerStartAngle:R,outerEndAngle:B,limitedIcr:A,innerDeltaAngle:M,innerEndAngle:k,innerStartAngle:E,innerCornerRadiusStart:T,innerCornerRadiusEnd:P,maxInnerCornerRadius:H}=TC(i,l,a,r,o);if(c<.001)s&&(s[3]||s[1])&&t.moveTo(e+f,n+g),u=!0;else if(m>Kt){const L=Ie(b,m),F=Ie(C,m),z=$n(p,v,f,g,o,L,Number(d)),I=$n(w,y,x,S,o,F,Number(d));m<_&&L===F?!s||s[0]?(t.moveTo(e+z.cx+z.x01,n+z.cy+z.y01),t.arc(e+z.cx,n+z.cy,m,Ft(z.y01,z.x01),Ft(I.y01,I.x01),!d)):t.moveTo(e+z.cx+m*ve(Ft(I.y01,I.x01)),n+z.cy+m*ie(Ft(I.y01,I.x01))):!s||s[0]?(t.moveTo(e+z.cx+z.x01,n+z.cy+z.y01),L>0&&t.arc(e+z.cx,n+z.cy,L,Ft(z.y01,z.x01),Ft(z.y11,z.x11),!d),t.arc(e,n,o,Ft(z.cy+z.y11,z.cx+z.x11),Ft(I.cy+I.y11,I.cx+I.x11),!d),F>0&&t.arc(e+I.cx,n+I.cy,F,Ft(I.y11,I.x11),Ft(I.y01,I.x01),!d)):F>0?t.moveTo(e+I.cx+F*ve(Ft(I.y01,I.x01)),n+I.cy+F*ie(Ft(I.y01,I.x01))):t.moveTo(e+w,n+o*ie(B))}else!s||s[0]?(t.moveTo(e+f,n+g),t.arc(e,n,o,R,B,!d)):t.moveTo(e+o*ve(B),n+o*ie(B));if(!(r>Kt)||M<.001)!s||s[1]?t.lineTo(e+x,n+S):t.moveTo(e+x,n+S),u=!0;else if(A>Kt){const L=Ie(T,A),F=Ie(P,A),z=$n(x,S,w,y,r,-F,Number(d)),I=$n(f,g,p,v,r,-L,Number(d));if(!s||s[1]?t.lineTo(e+z.cx+z.x01,n+z.cy+z.y01):t.moveTo(e+z.cx+z.x01,n+z.cy+z.y01),A<H&&L===F){const N=Ft(I.y01,I.x01);!s||s[2]?t.arc(e+z.cx,n+z.cy,A,Ft(z.y01,z.x01),N,!d):t.moveTo(e+z.cx+ve(N),n+z.cy+ie(N))}else!s||s[2]?(F>0&&t.arc(e+z.cx,n+z.cy,F,Ft(z.y01,z.x01),Ft(z.y11,z.x11),!d),t.arc(e,n,r,Ft(z.cy+z.y11,z.cx+z.x11),Ft(I.cy+I.y11,I.cx+I.x11),d),L>0&&t.arc(e+I.cx,n+I.cy,L,Ft(I.y11,I.x11),Ft(I.y01,I.x01),!d)):L>0?t.moveTo(e+I.cx+L*ve(Ft(I.y01,I.x01)),n+I.cy+L*ie(Ft(I.y01,I.x01))):t.moveTo(e+p,n+v)}else!s||s[1]?t.lineTo(e+x,n+S):t.moveTo(e+x,n+S),!s||s[2]?t.arc(e,n,r,k,E,d):t.moveTo(e+r*ve(E),n+r*ie(E))}return s?s[3]&&t.lineTo(e+o*ve(l),n+o*ie(l)):t.closePath(),u}class _i{static GetCanvas(){try{return _i.canvas||(_i.canvas=G.global.createCanvas({})),_i.canvas}catch{return null}}static GetCtx(){if(!_i.ctx){const t=_i.GetCanvas();_i.ctx=t.getContext("2d")}return _i.ctx}}class vo extends _y{static getInstance(){return vo._instance||(vo._instance=new vo),vo._instance}constructor(t=[],e=100){super(),this.cacheParams={CLEAN_THRESHOLD:100,L_TIME:1e3},this.dataMap=new Map;const n=_i.GetCanvas(),o=_i.GetCtx();if(n.width=e,n.height=1,!o)return;if(o.translate(0,0),!o)throw new Error("获取ctx发生错误");const r=o.createLinearGradient(0,0,e,0);t.forEach(s=>{r.addColorStop(s[0],s[1])}),o.fillStyle=r,o.fillRect(0,0,e,1),this.rgbaSet=o.getImageData(0,0,e,1).data}getColor(t){const e=this.rgbaSet.slice(4*t,4*t+4);return`rgba(${e[0]}, ${e[1]}, ${e[2]}, ${e[3]/255})`}GetOrCreate(t,e,n,o,r=[],s=100){let l=`${t}${e}${n}${o}`;r.forEach(h=>l+=h.join()),l+=s;let a=this.dataMap.get(l);return a||(a={data:new vo(r,s),timestamp:[]},this.addLimitedTimestamp(a,Date.now(),{}),this.dataMap.set(l,a)),this.clearCache(this.dataMap,this.cacheParams),a.data}}class Fe{static GetSize(t){for(let e=0;e<Fe.ImageSize.length;e++)if(Fe.ImageSize[e]>=t)return Fe.ImageSize[e];return t}static Get(t,e,n,o,r,s,l){const a=Fe.GenKey(t,e,n,o,r),h=Fe.cache[a];if(!h||h.length===0)return null;for(let d=0;d<h.length;d++)if(h[d].width>=s&&h[d].height>=l)return h[d].pattern;return null}static Set(t,e,n,o,r,s,l,a){const h=Fe.GenKey(t,e,n,o,r);Fe.cache[h]?Fe.cache[h].push({width:l,height:a,pattern:s}):Fe.cache[h]=[{width:l,height:a,pattern:s}]}static GenKey(t,e,n,o,r){return`${e},${n},${o},${r},${t.join()}`}}Fe.cache={},Fe.ImageSize=[20,40,80,160,320,640,1280,2560];function US(i,t,e,n){const{stops:o,startAngle:r,endAngle:s}=n;for(;e<0;)e+=Vt;for(;e>Vt;)e-=Vt;if(e<r||e>s)return o[0].color;let l,a,h=(e-r)/(s-r);for(let d=0;d<o.length;d++)if(o[d].offset>=h){l=o[d-1],a=o[d];break}return h=(h-l.offset)/(a.offset-l.offset),dr(l.color,a.color,h,!1)}function $S(i,t,e,n,o,r,s,l,a){const h=Math.floor(180*o/Math.PI),d=_i.GetCanvas(),u=_i.GetCtx();if(!u)return null;const c=Fe.GetSize(l),f=Fe.GetSize(a);let g=Fe.Get(t,e,n,r,s,c,f);if(g)return g;const p=Math.sqrt(Math.max(Math.max(Math.pow(e,2)+Math.pow(n,2),Math.pow(c-e,2)+Math.pow(n,2)),Math.max(Math.pow(c-e,2)+Math.pow(f-n,2),Math.pow(e,2)+Math.pow(f-n,2)))),v=h+1,m=o/Math.max(1,v-1),b=vo.getInstance().GetOrCreate(e,n,c,f,t,v),C=2*Math.PI*p/360;d.width=c,d.height=f,u.setTransform(1,0,0,1,0,0),u.clearRect(0,0,c,f),u.translate(e,n),u.rotate(r);for(let w=0,y=v-1;w<y&&!(r+w*m>s);w++){const x=b.getColor(w);u.beginPath(),u.rotate(m),u.moveTo(0,0),u.lineTo(p,-2*C),u.lineTo(p,0),u.fillStyle=x,u.closePath(),u.fill()}const _=u.getImageData(0,0,c,f);return d.width=_.width,d.height=_.height,u.putImageData(_,0,0),g=i.createPattern(d,"no-repeat"),g&&Fe.Set(t,e,n,r,s,g,c,f),g}const Ou=Symbol.for("ArcRenderContribution"),KS=Symbol.for("AreaRenderContribution"),Du=Symbol.for("CircleRenderContribution"),ki=Symbol.for("GroupRenderContribution"),yo=Symbol.for("ImageRenderContribution"),Wu=Symbol.for("PathRenderContribution"),Nu=Symbol.for("PolygonRenderContribution"),So=Symbol.for("RectRenderContribution"),Vu=Symbol.for("SymbolRenderContribution"),va=Symbol.for("TextRenderContribution"),Eg=Symbol.for("InteractiveSubRenderContribution");function Sr(i,t){return i==="end"||i==="right"?-t:i==="center"?-t/2:0}function Es(i,t,e,n=0){return i==="middle"?-t/2:i==="top"?0:i==="bottom"?n-t:i&&i!=="alphabetic"?0:(e||(e=t),-(t-e)/2-.79*e)}function PC(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}function YS(i,t,e){const n=Math.sin(e),o=Math.cos(e),r=t[4],s=t[5],l=t[6],a=t[7],h=t[8],d=t[9],u=t[10],c=t[11];return t!==i&&(i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15]),i[4]=r*o+h*n,i[5]=s*o+d*n,i[6]=l*o+u*n,i[7]=a*o+c*n,i[8]=h*o-r*n,i[9]=d*o-s*n,i[10]=u*o-l*n,i[11]=c*o-a*n,i}function XS(i,t,e){const n=Math.sin(e),o=Math.cos(e),r=t[0],s=t[1],l=t[2],a=t[3],h=t[8],d=t[9],u=t[10],c=t[11];return t!==i&&(i[4]=t[4],i[5]=t[5],i[6]=t[6],i[7]=t[7],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15]),i[0]=r*o-h*n,i[1]=s*o-d*n,i[2]=l*o-u*n,i[3]=a*o-c*n,i[8]=r*n+h*o,i[9]=s*n+d*o,i[10]=l*n+u*o,i[11]=a*n+c*o,i}function qS(i,t,e){const n=Math.sin(e),o=Math.cos(e),r=t[0],s=t[1],l=t[2],a=t[3],h=t[4],d=t[5],u=t[6],c=t[7];return t!==i&&(i[8]=t[8],i[9]=t[9],i[10]=t[10],i[11]=t[11],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15]),i[0]=r*o+h*n,i[1]=s*o+d*n,i[2]=l*o+u*n,i[3]=a*o+c*n,i[4]=h*o-r*n,i[5]=d*o-s*n,i[6]=u*o-l*n,i[7]=c*o-a*n,i}function qr(i,t,e){const n=e[0],o=e[1],r=e[2];let s,l,a,h,d,u,c,f,g,p,v,m;return t===i?(i[12]=t[0]*n+t[4]*o+t[8]*r+t[12],i[13]=t[1]*n+t[5]*o+t[9]*r+t[13],i[14]=t[2]*n+t[6]*o+t[10]*r+t[14],i[15]=t[3]*n+t[7]*o+t[11]*r+t[15]):(s=t[0],l=t[1],a=t[2],h=t[3],d=t[4],u=t[5],c=t[6],f=t[7],g=t[8],p=t[9],v=t[10],m=t[11],i[0]=s,i[1]=l,i[2]=a,i[3]=h,i[4]=d,i[5]=u,i[6]=c,i[7]=f,i[8]=g,i[9]=p,i[10]=v,i[11]=m,i[12]=s*n+d*o+g*r+t[12],i[13]=l*n+u*o+p*r+t[13],i[14]=a*n+c*o+v*r+t[14],i[15]=h*n+f*o+m*r+t[15]),i}function Gu(i,t){i[0]=t.a,i[1]=t.b,i[2]=0,i[3]=0,i[4]=t.c,i[5]=t.d,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=t.e,i[13]=t.f,i[14]=0,i[15]=1}function ZS(i,t,e){const n=e[0],o=e[1],r=e[2];return i[0]=t[0]*n,i[1]=t[1]*n,i[2]=t[2]*n,i[3]=t[3]*n,i[4]=t[4]*o,i[5]=t[5]*o,i[6]=t[6]*o,i[7]=t[7]*o,i[8]=t[8]*r,i[9]=t[9]*r,i[10]=t[10]*r,i[11]=t[11]*r,i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15],i}function rl(i,t,e){const n=t[0],o=t[1],r=t[2],s=t[3],l=t[4],a=t[5],h=t[6],d=t[7],u=t[8],c=t[9],f=t[10],g=t[11],p=t[12],v=t[13],m=t[14],b=t[15];let C=e[0],_=e[1],w=e[2],y=e[3];return i[0]=C*n+_*l+w*u+y*p,i[1]=C*o+_*a+w*c+y*v,i[2]=C*r+_*h+w*f+y*m,i[3]=C*s+_*d+w*g+y*b,C=e[4],_=e[5],w=e[6],y=e[7],i[4]=C*n+_*l+w*u+y*p,i[5]=C*o+_*a+w*c+y*v,i[6]=C*r+_*h+w*f+y*m,i[7]=C*s+_*d+w*g+y*b,C=e[8],_=e[9],w=e[10],y=e[11],i[8]=C*n+_*l+w*u+y*p,i[9]=C*o+_*a+w*c+y*v,i[10]=C*r+_*h+w*f+y*m,i[11]=C*s+_*d+w*g+y*b,C=e[12],_=e[13],w=e[14],y=e[15],i[12]=C*n+_*l+w*u+y*p,i[13]=C*o+_*a+w*c+y*v,i[14]=C*r+_*h+w*f+y*m,i[15]=C*s+_*d+w*g+y*b,i}function Pi(i,t,e){const n=t[0],o=t[1],r=t[2];let s=e[3]*n+e[7]*o+e[11]*r+e[15];return s=s||1,i[0]=(e[0]*n+e[4]*o+e[8]*r+e[12])/s,i[1]=(e[1]*n+e[5]*o+e[9]*r+e[13])/s,i[2]=(e[2]*n+e[6]*o+e[10]*r+e[14])/s,i}function Zf(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}class JS{constructor(){this.pools=[]}allocate(t,e,n,o,r,s){if(!this.pools.length)return new Pe(t,e,n,o,r,s);const l=this.pools.pop();return l.a=t,l.b=e,l.c=n,l.d=o,l.e=r,l.f=s,l}allocateByObj(t){if(!this.pools.length)return new Pe(t.a,t.b,t.c,t.d,t.e,t.f);const e=this.pools.pop();return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e.e=t.e,e.f=t.f,e}free(t){this.pools.push(t)}get length(){return this.pools.length}release(...t){this.pools=[]}}class Lg{constructor(){this.pools=[]}static identity(t){return PC(t)}allocate(){if(!this.pools.length)return Zf();const t=this.pools.pop();return Lg.identity(t),t}allocateByObj(t){let e;e=this.pools.length?this.pools.pop():Zf();for(let n=0;n<e.length;n++)e[n]=t[n];return e}free(t){t&&this.pools.push(t)}get length(){return this.pools.length}release(...t){this.pools=[]}}const Ze=new JS,ce=new Lg;var QS=function(i,t,e,n){var o,r=arguments.length,s=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var l=i.length-1;l>=0;l--)(o=i[l])&&(s=(r<3?o(s):r>3?o(t,e,s):o(t,e))||s);return r>3&&s&&Object.defineProperty(t,e,s),s},tx=function(i,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,t)},ex=function(i,t){return function(e,n){t(e,n,i)}};function HC(i,t,e){var n;const{x:o=e.x,y:r=e.y,z:s=e.z,dx:l=e.dx,dy:a=e.dy,dz:h=e.dz,scaleX:d=e.scaleX,scaleY:u=e.scaleY,scaleZ:c=e.scaleZ,alpha:f=e.alpha,beta:g=e.beta,angle:p=e.angle,anchor3d:v=t.attribute.anchor,anchor:m}=t.attribute,b=[0,0,0];if(v){if(typeof v[0]=="string"){const C=parseFloat(v[0])/100,_=t.AABBBounds;b[0]=_.x1+(_.x2-_.x1)*C}else b[0]=v[0];if(typeof v[1]=="string"){const C=parseFloat(v[1])/100,_=t.AABBBounds;b[1]=_.x1+(_.x2-_.x1)*C}else b[1]=v[1];b[2]=(n=v[2])!==null&&n!==void 0?n:0}if(PC(i),qr(i,i,[o+l,r+a,s+h]),qr(i,i,[b[0],b[1],b[2]]),YS(i,i,g),XS(i,i,f),qr(i,i,[-b[0],-b[1],b[2]]),ZS(i,i,[d,u,c]),p){const C=ce.allocate(),_=[0,0];if(m){if(typeof v[0]=="string"){const w=parseFloat(v[0])/100,y=t.AABBBounds;_[0]=y.x1+(y.x2-y.x1)*w}else _[0]=v[0];if(typeof v[1]=="string"){const w=parseFloat(v[1])/100,y=t.AABBBounds;_[1]=y.x1+(y.x2-y.x1)*w}else _[1]=v[1]}qr(C,C,[_[0],_[1],0]),qS(C,C,p),qr(C,C,[-_[0],-_[1],0]),rl(i,i,C)}}function ix(i){const{alpha:t,beta:e}=i.attribute;return t||e}let ju=class{constructor(i){this.creator=i,this.hooks={onAttributeUpdate:new Xe(["graphic"]),onSetStage:new Xe(["graphic","stage"]),onRemove:new Xe(["graphic"]),onRelease:new Xe(["graphic"]),onAddIncremental:new Xe(["graphic","group","stage"]),onClearIncremental:new Xe(["graphic","group","stage"]),beforeUpdateAABBBounds:new Xe(["graphic","stage","willUpdate","aabbBounds"]),afterUpdateAABBBounds:new Xe(["graphic","stage","aabbBounds","globalAABBBounds","selfChange"]),clearAABBBounds:new Xe(["graphic","stage","aabbBounds"])},this.tempAABBBounds1=new Gt,this.tempAABBBounds2=new Gt}onAttributeUpdate(i){this.hooks.onAttributeUpdate.taps.length&&this.hooks.onAttributeUpdate.call(i)}onSetStage(i,t){this.hooks.onSetStage.taps.length&&this.hooks.onSetStage.call(i,t)}onRemove(i){this.hooks.onRemove.taps.length&&this.hooks.onRemove.call(i)}onRelease(i){this.hooks.onRelease.taps.length&&this.hooks.onRelease.call(i)}onAddIncremental(i,t,e){this.hooks.onAddIncremental.taps.length&&this.hooks.onAddIncremental.call(i,t,e)}onClearIncremental(i,t){this.hooks.onClearIncremental.taps.length&&this.hooks.onClearIncremental.call(i,t)}beforeUpdateAABBBounds(i,t,e,n){this.hooks.beforeUpdateAABBBounds.taps.length&&this.hooks.beforeUpdateAABBBounds.call(i,t,e,n)}afterUpdateAABBBounds(i,t,e,n,o){this.hooks.afterUpdateAABBBounds.taps.length&&this.hooks.afterUpdateAABBBounds.call(i,t,e,n,o)}clearAABBBounds(i,t,e){this.hooks.clearAABBBounds.taps.length&&this.hooks.clearAABBBounds.call(i,t,e)}updatePathProxyAABBBounds(i,t){const e=typeof t.pathProxy=="function"?t.pathProxy(t.attribute):t.pathProxy;if(!e)return!1;const n=new wg(i);return Qn(e.commandList,n,0,0),!0}updateHTMLTextAABBBounds(i,t,e,n){const{textAlign:o,textBaseline:r}=i;if(i.forceBoundsHeight!=null){const s=Z(i.forceBoundsHeight)?i.forceBoundsHeight:i.forceBoundsHeight(),l=Es(r,s,s);e.set(e.x1,l,e.x2,l+s)}if(i.forceBoundsWidth!=null){const s=Z(i.forceBoundsWidth)?i.forceBoundsWidth:i.forceBoundsWidth(),l=Sr(o,s);e.set(l,e.y1,l+s,e.y2)}}combindShadowAABBBounds(i,t){if(t&&t.shadowRoot){const e=t.shadowRoot.AABBBounds;i.union(e)}}transformAABBBounds(i,t,e,n,o){if(!t.empty()){const{scaleX:l=e.scaleX,scaleY:a=e.scaleY,stroke:h=e.stroke,shadowBlur:d=e.shadowBlur,lineWidth:u=e.lineWidth,pickStrokeBuffer:c=e.pickStrokeBuffer,strokeBoundsBuffer:f=e.strokeBoundsBuffer}=i,g=this.tempAABBBounds1,p=this.tempAABBBounds2;if(h&&u){const v=(u+c)/Math.abs(l+a);fa(g,v,n,f),t.union(g),g.setValue(p.x1,p.y1,p.x2,p.y2)}if(d){const{shadowOffsetX:v=e.shadowOffsetX,shadowOffsetY:m=e.shadowOffsetY}=i,b=d/Math.abs(l+a)*2;fa(g,b,!1,f+1),g.translate(v,m),t.union(g)}}if(this.combindShadowAABBBounds(t,o),t.empty())return;let r=!0;const s=o.transMatrix;o&&o.isContainer&&(r=!(s.a===1&&s.b===0&&s.c===0&&s.d===1&&s.e===0&&s.f===0)),r&&Eb(t,t,s)}validCheck(i,t,e,n){if(!n||i.forceBoundsHeight!=null||i.forceBoundsWidth!=null||n.shadowRoot||n.isContainer)return!0;const{visible:o=t.visible}=i;return!(!n.valid||!o)||(e.empty()||(n.parent&&e.transformWithMatrix(n.parent.globalTransMatrix),G.graphicService.clearAABBBounds(n,n.stage,e),e.clear()),!1)}updateTempAABBBounds(i){const t=this.tempAABBBounds1,e=this.tempAABBBounds2;return t.setValue(i.x1,i.y1,i.x2,i.y2),e.setValue(i.x1,i.y1,i.x2,i.y2),{tb1:t,tb2:e}}};ju=QS([st(),ex(0,At(yC)),tx("design:paramtypes",[Object])],ju);const se={x:0,y:0,z:0,lastModelMatrix:null};class ei{init(t){t&&(this._renderContribitions=t.getContributions()),this._renderContribitions||(this._renderContribitions=[]),this.builtinContributions&&this.builtinContributions.forEach(e=>this._renderContribitions.push(e)),this._renderContribitions.length&&(this._renderContribitions.sort((e,n)=>n.order-e.order),this._beforeRenderContribitions=this._renderContribitions.filter(e=>e.time===Et.beforeFillStroke),this._afterRenderContribitions=this._renderContribitions.filter(e=>e.time===Et.afterFillStroke))}beforeRenderStep(t,e,n,o,r,s,l,a,h,d,u,c,f){this._beforeRenderContribitions&&this._beforeRenderContribitions.forEach(g=>{g.supportedAppName&&t.stage&&t.stage.params&&t.stage.params.context&&t.stage.params.context.appName&&!(Array.isArray(g.supportedAppName)?g.supportedAppName:[g.supportedAppName]).includes(t.stage.params.context.appName)||g.drawShape(t,e,n,o,r,s,l,a,h,d,u,c,f)})}afterRenderStep(t,e,n,o,r,s,l,a,h,d,u,c,f){this._afterRenderContribitions&&this._afterRenderContribitions.forEach(g=>{g.supportedAppName&&t.stage&&t.stage.params&&t.stage.params.context&&t.stage.params.context.appName&&!(Array.isArray(g.supportedAppName)?g.supportedAppName:[g.supportedAppName]).includes(t.stage.params.context.appName)||g.drawShape(t,e,n,o,r,s,l,a,h,d,u,c,f)})}valid(t,e,n,o){const{fill:r=e.fill,background:s,stroke:l=e.stroke,opacity:a=e.opacity,fillOpacity:h=e.fillOpacity,lineWidth:d=e.lineWidth,strokeOpacity:u=e.strokeOpacity,visible:c=e.visible}=t.attribute,f=Ho(a,h,r),g=kg(a,u),p=zr(r,s),v=ol(l,d);return!(!t.valid||!c)&&!(!p&&!v)&&!!(f||g||n||o||s)&&{fVisible:f,sVisible:g,doFill:p,doStroke:v}}transform(t,e,n,o=!1){const{x:r=e.x,y:s=e.y,z:l=e.z,scaleX:a=e.scaleX,scaleY:h=e.scaleY,angle:d=e.angle,postMatrix:u}=t.attribute,c=n.modelMatrix,f=n.camera;se.x=r,se.y=s,se.z=l,se.lastModelMatrix=c;const g=f&&(o||ix(t)),p=g?t.transMatrix.onlyTranslate()&&!u:a===1&&h===1&&d===0&&!u;if(g){const v=ce.allocate(),m=ce.allocate();HC(m,t,e),rl(v,c||v,m),se.x=0,se.y=0,se.z=0,n.modelMatrix=v,n.setTransform(1,0,0,1,0,0,!0),ce.free(m)}if(p&&!c){const v=t.getOffsetXY(e);se.x+=v.x,se.y+=v.y,se.z=l,n.setTransformForCurrent()}else if(g)se.x=0,se.y=0,se.z=0,n.setTransform(1,0,0,1,0,0,!0);else if(f&&n.project){const v=t.getOffsetXY(e);se.x+=v.x,se.y+=v.y,this.transformWithoutTranslate(n,se.x,se.y,se.z,a,h,d)}else n.transformFromMatrix(t.transMatrix,!0),se.x=0,se.y=0,se.z=0;return se}transformUseContext2d(t,e,n,o){const r=o.camera;if(this.camera=r,r){const s=t.AABBBounds,l=s.x2-s.x1,a=s.y2-s.y1,h=o.project(0,0,n),d=o.project(l,0,n),u=o.project(l,a,n),c={x:0,y:0},f={x:l,y:0},g={x:l,y:a};o.camera=null;const p=1/(c.x*(g.y-f.y)-f.x*g.y+g.x*f.y+(f.x-g.x)*c.y),v=-(c.y*(u.x-d.x)-f.y*u.x+g.y*d.x+(f.y-g.y)*h.x)*p,m=(f.y*u.y+c.y*(d.y-u.y)-g.y*d.y+(g.y-f.y)*h.y)*p,b=(c.x*(u.x-d.x)-f.x*u.x+g.x*d.x+(f.x-g.x)*h.x)*p,C=-(f.x*u.y+c.x*(d.y-u.y)-g.x*d.y+(g.x-f.x)*h.y)*p,_=(c.x*(g.y*d.x-f.y*u.x)+c.y*(f.x*u.x-g.x*d.x)+(g.x*f.y-f.x*g.y)*h.x)*p,w=(c.x*(g.y*d.y-f.y*u.y)+c.y*(f.x*u.y-g.x*d.y)+(g.x*f.y-f.x*g.y)*h.y)*p;o.setTransform(v,m,b,C,_,w,!0)}}restoreTransformUseContext2d(t,e,n,o){this.camera&&(o.camera=this.camera)}transformWithoutTranslate(t,e,n,o,r,s,l){const a=t.project(e,n,o);t.translate(a.x,a.y,!1),t.scale(r,s,!1),t.rotate(l,!1),t.translate(-a.x,-a.y,!1),t.setTransformForCurrent()}_draw(t,e,n,o,r){const{context:s}=o;if(!s)return;const{renderable:l}=t.attribute;if(l===!1)return;s.highPerformanceSave();const a=this.transform(t,e,s,n),{x:h,y:d,z:u,lastModelMatrix:c}=a;this.z=u,GS(t,s,h,d,o,r)||(this.drawShape(t,s,h,d,o,r),this.z=0,s.modelMatrix!==c&&ce.free(s.modelMatrix),s.modelMatrix=c),s.highPerformanceRestore()}}var nx=function(i,t,e,n){var o,r=arguments.length,s=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var l=i.length-1;l>=0;l--)(o=i[l])&&(s=(r<3?o(s):r>3?o(t,e,s):o(t,e))||s);return r>3&&s&&Object.defineProperty(t,e,s),s},ox=function(i,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,t)},Jf=function(i,t){return function(e,n){t(e,n,i)}};class rd{constructor(){this.time=Et.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,n,o,r,s,l,a,h,d,u,c,f){var g;const{background:p,backgroundOpacity:v=(g=t.attribute.fillOpacity)!==null&&g!==void 0?g:h.backgroundOpacity,opacity:m=h.opacity,backgroundMode:b=h.backgroundMode,backgroundFit:C=h.backgroundFit}=t.attribute;if(p)if(t.backgroundImg&&t.resources){const _=t.resources.get(p);if(_.state!=="success"||!_.data)return;if(e.save(),t.parent&&!t.transMatrix.onlyTranslate()){const y=yt(t.parent).group,{scrollX:x=y.scrollX,scrollY:S=y.scrollY}=t.parent.attribute;e.setTransformFromMatrix(t.parent.globalTransMatrix,!0),e.translate(x,S)}e.clip();const w=t.AABBBounds;e.setCommonStyle(t,t.attribute,n,o,h),e.globalAlpha=v*m,this.doDrawImage(e,_.data,w,b,C),e.restore(),t.transMatrix.onlyTranslate()||e.setTransformForCurrent()}else e.highPerformanceSave(),e.setCommonStyle(t,t.attribute,n,o,h),e.globalAlpha=v*m,e.fillStyle=p,e.fill(),e.highPerformanceRestore()}doDrawImage(t,e,n,o,r){if(o==="no-repeat")t.drawImage(e,n.x1,n.y1,n.width(),n.height());else{const s=n.width(),l=n.height();let a=s,h=l;if(r&&o!=="repeat"&&(e.width||e.height)){const c=e.width,f=e.height;o==="repeat-x"?(a=c*(l/f),h=l):o==="repeat-y"&&(h=f*(s/c),a=s);const g=t.dpr,p=yr.allocate({width:a,height:h,dpr:g}),v=p.getContext("2d");v&&(v.inuse=!0,v.clearMatrix(),v.setTransformForCurrent(!0),v.clearRect(0,0,a,h),v.drawImage(e,0,0,a,h),e=p.nativeCanvas),yr.free(p)}const d=t.dpr,u=t.createPattern(e,o);u.setTransform&&u.setTransform(new DOMMatrix([1/d,0,0,1/d,0,0])),t.fillStyle=u,t.translate(n.x1,n.y1),t.fillRect(0,0,s,l),t.translate(-n.x1,-n.y1)}}}const eo=new rd;let Oi=class{constructor(i){this.subRenderContribitions=i,this.time=Et.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(i,t,e,n,o,r,s,l,a,h,d,u,c){this._subRenderContribitions||(this._subRenderContribitions=this.subRenderContribitions.getContributions()),this._subRenderContribitions.forEach(f=>{f.render(i,t,e,n,o,r,s,l,a,h,d,u,c)})}};Oi=nx([st(),Jf(0,At(ge)),Jf(0,Re(Eg)),ox("design:paramtypes",[Object])],Oi);class Fg{constructor(){this.time=Et.afterFillStroke,this.useStyle=!0,this.order=10}createCommonPattern(t,e,n,o,r){const s=(t-2*e)/2,l=o.dpr,a=yr.allocate({width:t,height:t,dpr:l}),h=a.getContext("2d");if(!h)return null;h.inuse=!0,h.clearMatrix(),h.setTransformForCurrent(!0),h.clearRect(0,0,t,t),r(s,h);const d=o.createPattern(a.nativeCanvas,"repeat");return d.setTransform&&d.setTransform(new DOMMatrix([1/l,0,0,1/l,0,0])),yr.free(a),d}createCirclePattern(t,e,n,o){return this.createCommonPattern(t,e,n,o,(r,s)=>{s.fillStyle=n,s.arc(r,r,r,0,Vt),s.fill()})}createDiamondPattern(t,e,n,o){return this.createCommonPattern(t,e,n,o,(r,s)=>{const l=t/2,a=l;s.fillStyle=n,s.moveTo(l,a-r),s.lineTo(r+l,a),s.lineTo(l,a+r),s.lineTo(l-r,a),s.closePath(),s.fill()})}createRectPattern(t,e,n,o){return this.createCommonPattern(t,e,n,o,(r,s)=>{const l=e,a=l;s.fillStyle=n,s.fillRect(l,a,2*r,2*r)})}createVerticalLinePattern(t,e,n,o){return this.createCommonPattern(t,e,n,o,(r,s)=>{const l=e;s.fillStyle=n,s.fillRect(l,0,2*r,t)})}createHorizontalLinePattern(t,e,n,o){return this.createCommonPattern(t,e,n,o,(r,s)=>{const l=e;s.fillStyle=n,s.fillRect(0,l,t,2*r)})}createBiasLRLinePattern(t,e,n,o){return this.createCommonPattern(t,e,n,o,(r,s)=>{s.strokeStyle=n,s.lineWidth=r,s.moveTo(0,0),s.lineTo(t,t);const l=t/2,a=-l;s.moveTo(l,a),s.lineTo(l+t,a+t),s.moveTo(-l,-a),s.lineTo(-l+t,-a+t),s.stroke()})}createBiasRLLinePattern(t,e,n,o){return this.createCommonPattern(t,e,n,o,(r,s)=>{s.strokeStyle=n,s.lineWidth=r,s.moveTo(t,0),s.lineTo(0,t);const l=t/2,a=l;s.moveTo(t+l,a),s.lineTo(l,a+t),s.moveTo(t-l,-a),s.lineTo(-l,-a+t),s.stroke()})}createGridPattern(t,e,n,o){return this.createCommonPattern(t,e,n,o,(r,s)=>{const l=e,a=l;s.fillStyle=n,s.fillRect(l,a,r,r),s.fillRect(l+r,a+r,r,r)})}initTextureMap(t,e){this.textureMap=new Map}drawShape(t,e,n,o,r,s,l,a,h,d,u,c,f){this.textureMap||this.initTextureMap(e,t.stage);const{texture:g=h.texture,textureColor:p=h.textureColor,textureSize:v=h.textureSize,texturePadding:m=h.texturePadding}=t.attribute;g&&this.drawTexture(g,t,e,n,o,h,p,v,m)}drawTexture(t,e,n,o,r,s,l,a,h){let d=this.textureMap.get(t);if(!d)switch(t){case"circle":d=this.createCirclePattern(a,h,l,n);break;case"diamond":d=this.createDiamondPattern(a,h,l,n);break;case"rect":d=this.createRectPattern(a,h,l,n);break;case"vertical-line":d=this.createVerticalLinePattern(a,h,l,n);break;case"horizontal-line":d=this.createHorizontalLinePattern(a,h,l,n);break;case"bias-lr":d=this.createBiasLRLinePattern(a,h,l,n);break;case"bias-rl":d=this.createBiasRLLinePattern(a,h,l,n);break;case"grid":d=this.createGridPattern(a,h,l,n)}d&&(n.highPerformanceSave(),n.setCommonStyle(e,e.attribute,o,r,s),n.fillStyle=d,n.fill(),n.highPerformanceRestore())}}const Ir=new Fg;class rx{constructor(){this.time=Et.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,n,o,r,s,l,a,h,d,u,c){const{outerBorder:f,innerBorder:g}=t.attribute,p=f&&f.visible!==!1,v=g&&g.visible!==!1;if(!p&&!v)return;const{innerPadding:m=h.innerPadding,outerPadding:b=h.outerPadding,startAngle:C=h.startAngle,endAngle:_=h.endAngle,opacity:w=h.opacity,x:y=h.x,y:x=h.y,scaleX:S=h.scaleX,scaleY:R=h.scaleY,keepStrokeScale:B=h.keepStrokeScale}=t.attribute;let{innerRadius:A=h.innerRadius,outerRadius:M=h.outerRadius}=t.attribute;M+=b,A-=m;const k=(E,T)=>{const P=!(!E||!E.stroke),{distance:H=h[T].distance}=E,L=B?H:Bn(e,H,e.dpr),F=H/M,z=T==="outerBorder"?1:-1;if(t.setAttributes({outerRadius:M+z*L,innerRadius:A-z*L,startAngle:C-z*F,endAngle:_+z*F}),e.beginPath(),Iu(t,e,n,o,M+z*L,A-z*L),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,h),c)c(e,E,h[T]);else if(P){const I=h[T].opacity;h[T].opacity=w,e.setStrokeStyle(t,E,(y-n)/S,(x-o)/R,h[T]),h[T].opacity=I,e.stroke()}};p&&k(f,"outerBorder"),v&&k(g,"innerBorder"),t.setAttributes({outerRadius:M,innerRadius:A,startAngle:C,endAngle:_})}}const sx=new rx,lx=Ir,ax=eo;class hx{constructor(){this.time=Et.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,n,o,r,s,l,a,h,d,u,c){const{outerBorder:f,innerBorder:g}=t.attribute,p=f&&f.visible!==!1,v=g&&g.visible!==!1;if(!p&&!v)return;const{radius:m=h.radius,startAngle:b=h.startAngle,endAngle:C=h.endAngle,opacity:_=h.opacity,x:w=h.x,y=h.y,scaleX:x=h.scaleX,scaleY:S=h.scaleY,keepStrokeScale:R=h.keepStrokeScale}=t.attribute,B=(A,M)=>{const k=!(!A||!A.stroke),{distance:E=h[M].distance}=A,T=R?E:Bn(e,E,e.dpr),P=M==="outerBorder"?1:-1;if(e.beginPath(),e.arc(n,o,m+P*T,b,C),e.closePath(),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,h),c)c(e,A,h[M]);else if(k){const H=h[M].opacity;h[M].opacity=_,e.setStrokeStyle(t,A,(w-n)/x,(y-o)/S,h[M]),h[M].opacity=H,e.stroke()}};p&&B(f,"outerBorder"),v&&B(g,"innerBorder")}}const dx=new hx,ux=Ir,cx=eo;class gx extends rd{constructor(){super(...arguments),this.time=Et.beforeFillStroke}drawShape(t,e,n,o,r,s,l,a,h,d,u,c){const{background:f,backgroundMode:g=h.backgroundMode,backgroundFit:p=h.backgroundFit}=t.attribute;if(f)if(t.backgroundImg&&t.resources){const v=t.resources.get(f);if(v.state!=="success"||!v.data)return;e.highPerformanceSave(),e.setTransformFromMatrix(t.parent.globalTransMatrix,!0);const m=t.AABBBounds;this.doDrawImage(e,v.data,m,g,p),e.highPerformanceRestore(),e.setTransformForCurrent()}else e.highPerformanceSave(),e.fillStyle=f,e.fill(),e.highPerformanceRestore()}}const fx=new gx,Al=Xt/2;function en(i,t,e,n,o,r,s){let l;if(n<0&&(t+=n,n=-n),o<0&&(e+=o,o=-o),Z(r,!0))l=[r=Dt(r),r,r,r];else if(Array.isArray(r)){const y=r;let x,S;switch(y.length){case 0:l=[0,0,0,0];break;case 1:x=Dt(y[0]),l=[x,x,x,x];break;case 2:case 3:x=Dt(y[0]),S=Dt(y[1]),l=[x,S,x,S];break;default:l=y,l[0]=Dt(l[0]),l[1]=Dt(l[1]),l[2]=Dt(l[2]),l[3]=Dt(l[3])}}else l=[0,0,0,0];if(n<0||l[0]+l[1]+l[2]+l[3]<1e-12)return i.rect(t,e,n,o);const[a,h,d,u]=[[t,e],[t+n,e],[t+n,e+o],[t,e+o]],c=Math.min(n/2,o/2),f=[Math.min(c,l[0]),Math.min(c,l[1]),Math.min(c,l[2]),Math.min(c,l[3])],g=[a[0]+f[0],a[1]],p=[a[0],a[1]+f[0]],v=[h[0]-f[1],h[1]],m=[h[0],h[1]+f[1]],b=[d[0]-f[2],d[1]],C=[d[0],d[1]-f[2]],_=[u[0]+f[3],u[1]],w=[u[0],u[1]-f[3]];if(i.moveTo(g[0],g[1]),s&&s[0]?s[0](g[0],g[1],v[0],v[1]):i.lineTo(v[0],v[1]),!rs(v,m)){s&&s[0]&&i.moveTo(v[0],v[1]);const y=v[0],x=v[1]+f[1];i.arc(y,x,f[1],-Al,0,!1)}if(s&&s[1]?s[1](m[0],m[1],C[0],C[1]):i.lineTo(C[0],C[1]),!rs(b,C)){const y=C[0]-f[2],x=C[1];s&&s[1]&&i.moveTo(C[0],C[1]),i.arc(y,x,f[2],0,Al,!1)}if(s&&s[2]?s[2](b[0],b[1],_[0],_[1]):i.lineTo(_[0],_[1]),!rs(_,w)){const y=_[0],x=_[1]-f[3];s&&s[2]&&i.moveTo(_[0],_[1]),i.arc(y,x,f[3],Al,Xt,!1)}if(s&&s[3]?s[3](w[0],w[1],p[0],p[1]):i.lineTo(p[0],p[1]),!rs(g,p)){const y=g[0],x=g[1]+f[0];s&&s[3]&&i.moveTo(p[0],p[1]),i.arc(y,x,f[0],Xt,Xt+Al,!1)}return!s&&i.closePath(),i}var kC=function(i,t,e,n){var o,r=arguments.length,s=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var l=i.length-1;l>=0;l--)(o=i[l])&&(s=(r<3?o(s):r>3?o(t,e,s):o(t,e))||s);return r>3&&s&&Object.defineProperty(t,e,s),s};class EC{constructor(){this.time=Et.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,n,o,r,s,l,a,h,d,u,c){const{outerBorder:f,innerBorder:g}=t.attribute,p=f&&f.visible!==!1,v=g&&g.visible!==!1;if(!p&&!v)return;const{cornerRadius:m=h.cornerRadius,opacity:b=h.opacity,x:C=h.x,y:_=h.y,scaleX:w=h.scaleX,scaleY:y=h.scaleY,x1:x,y1:S,keepStrokeScale:R=h.keepStrokeScale}=t.attribute;let{width:B,height:A}=t.attribute;B=(B??x-n)||0,A=(A??S-o)||0;const M=(k,E)=>{const T=!(!k||!k.stroke),P=E==="outerBorder"?-1:1,{distance:H=h[E].distance}=k,L=R?H:Bn(e,H,e.dpr),F=n+P*L,z=o+P*L,I=2*L;if(m===0||Q(m)&&m.every(N=>N===0)?(e.beginPath(),e.rect(F,z,B-P*I,A-P*I)):(e.beginPath(),en(e,F,z,B-P*I,A-P*I,m)),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,h),c)c(e,k,h[E]);else if(T){const N=h[E].opacity;h[E].opacity=b,e.setStrokeStyle(t,k,(C-n)/w,(_-o)/y,h[E]),h[E].opacity=N,e.stroke()}};p&&M(f,"outerBorder"),v&&M(g,"innerBorder")}}let xr=class{constructor(){this.time=Et.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,n,o,r,s,l,a,h,d,u,c,f){const{stroke:g=h.stroke}=t.attribute;Array.isArray(g)&&g.some(p=>p===!1)&&(f.doStroke=!1)}};xr=kC([st()],xr);let Rr=class{constructor(){this.time=Et.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,n,o,r,s,l,a,h,d,u,c){const{x1:f,y1:g,x:p=h.x,y:v=h.y,stroke:m=h.stroke,cornerRadius:b=h.cornerRadius}=t.attribute;let{width:C,height:_}=t.attribute;if(C=(C??f-p)||0,_=(_??g-v)||0,Array.isArray(m)&&m.some(w=>w===!1)){if(e.setStrokeStyle(t,t.attribute,n,o,h),!(b===0||Q(b)&&b.every(w=>w===0))){let w,y=0;return en(e,n,o,C,_,b,new Array(4).fill(0).map((x,S)=>(R,B,A,M)=>{m[S]&&(y===S-1&&m[S]===w||(e.setStrokeStyle(t,Object.assign(Object.assign({},t.attribute),{stroke:m[S]}),n,o,h),e.beginPath(),e.moveTo(R,B),w=m[S]),y=S,e.lineTo(A,M),e.stroke(),S===3&&e.beginPath())})),void e.stroke()}if(e.beginPath(),e.moveTo(n,o),m[0]?e.lineTo(n+C,o):e.moveTo(n+C,o),m[1]?e.lineTo(n+C,o+_):e.moveTo(n+C,o+_),m[2]?e.lineTo(n,o+_):e.moveTo(n,o+_),m[3]){const w=m[0]?o-e.lineWidth/2:o;e.lineTo(n,w)}else e.moveTo(n,o);e.stroke()}}};Rr=kC([st()],Rr);const px=new EC,vx=Ir,mx=eo;class bx extends EC{constructor(){super(...arguments),this.time=Et.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,n,o,r,s,l,a,h,d,u,c){return super.drawShape(t,e,n,o,r,s,l,a,h,d,u,c)}}const Cx=new bx,_x=eo;class wx{constructor(){this.time=Et.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(t,e,n,o,r,s,l,a,h,d,u,c){const f=t.getParsedPath();if(!f)return;const{outerBorder:g,innerBorder:p}=t.attribute,v=g&&g.visible!==!1,m=p&&p.visible!==!1;if(!v&&!m)return;const{size:b=h.size,opacity:C=h.opacity,x:_=h.x,y:w=h.y,scaleX:y=h.scaleX,scaleY:x=h.scaleY,keepStrokeScale:S=h.keepStrokeScale}=t.attribute,R=(B,A)=>{const M=!(!B||!B.stroke),{distance:k=h[A].distance}=B,E=S?k:Bn(e,k,e.dpr),T=A==="outerBorder"?1:-1;if(e.beginPath(),f.drawOffset(e,b,n,o,T*E)===!1&&e.closePath(),e.setShadowBlendStyle&&e.setShadowBlendStyle(t,t.attribute,h),c)c(e,B,h[A]);else if(M){const P=h[A].opacity;h[A].opacity=C,e.setStrokeStyle(t,B,(_-n)/y,(w-o)/x,h[A]),h[A].opacity=P,e.stroke()}};v&&R(g,"outerBorder"),m&&R(p,"innerBorder")}}const yx=new wx,Sx=Ir,xx=eo;class Rx extends Fg{constructor(){super(...arguments),this.time=Et.afterFillStroke}drawShape(t,e,n,o,r,s,l,a,h,d,u,c,f){var g,p,v,m;this.textureMap||this.initTextureMap(e,t.stage);const{attribute:b=t.attribute}=f||{},{texture:C=(g=t.attribute.texture)!==null&&g!==void 0?g:xl(h,"texture"),textureColor:_=(p=t.attribute.textureColor)!==null&&p!==void 0?p:xl(h,"textureColor"),textureSize:w=(v=t.attribute.textureSize)!==null&&v!==void 0?v:xl(h,"textureSize"),texturePadding:y=(m=t.attribute.texturePadding)!==null&&m!==void 0?m:xl(h,"texturePadding")}=b;C&&this.drawTexture(C,t,e,n,o,h,_,w,y)}}var Ax=function(i,t,e,n){var o,r=arguments.length,s=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var l=i.length-1;l>=0;l--)(o=i[l])&&(s=(r<3?o(s):r>3?o(t,e,s):o(t,e))||s);return r>3&&s&&Object.defineProperty(t,e,s),s},Bx=function(i,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,t)},Qf=function(i,t){return function(e,n){t(e,n,i)}};let ma=class extends ei{constructor(i){super(),this.arcRenderContribitions=i,this.numberType=Jh,this.builtinContributions=[sx,ax,lx],this.init(i)}drawArcTailCapPath(i,t,e,n,o,r,s,l){const a=l-s,h=i.getParsedAngle(),d=h.startAngle;let u=h.endAngle;u=l;const c=u>d;let f=!1;if(o<r){const P=o;o=r,r=P}const{xors:g,yors:p,xirs:v,yirs:m,limitedOcr:b,outerCornerRadiusStart:C,outerCornerRadiusEnd:_,maxOuterCornerRadius:w,xore:y,yore:x,xire:S,yire:R,limitedIcr:B,innerDeltaAngle:A,innerStartAngle:M,innerCornerRadiusStart:k,innerCornerRadiusEnd:E,maxInnerCornerRadius:T}=TC(i,d,u,r,o);if(b>Kt){const P=Ie(C,b),H=Ie(_,b),L=$n(v,m,g,p,o,P,Number(c)),F=$n(y,x,S,R,o,H,Number(c));if(b<w&&P===H)t.moveTo(e+L.cx+L.x01,n+L.cy+L.y01),t.arc(e+L.cx,n+L.cy,b,Ft(L.y01,L.x01),Ft(F.y01,F.x01),!c);else{const z=u-a-.03,I=Ft(F.y11,F.x11);t.arc(e,n,o,z,I,!c),H>0&&t.arc(e+F.cx,n+F.cy,H,Ft(F.y11,F.x11),Ft(F.y01,F.x01),!c)}}else t.moveTo(e+g,n+p);if(!(r>Kt)||A<.001)t.lineTo(e+S,n+R),f=!0;else if(B>Kt){const P=Ie(k,B),H=Ie(E,B),L=$n(S,R,y,x,r,-H,Number(c)),F=$n(g,p,v,m,r,-P,Number(c));if(t.lineTo(e+L.cx+L.x01,n+L.cy+L.y01),B<T&&P===H){const z=Ft(F.y01,F.x01);t.arc(e+L.cx,n+L.cy,B,Ft(L.y01,L.x01),z,!c)}else{H>0&&t.arc(e+L.cx,n+L.cy,H,Ft(L.y01,L.x01),Ft(L.y11,L.x11),!c);const z=Ft(L.cy+L.y11,L.cx+L.x11),I=u-a-.03;t.arc(e,n,r,z,I,c)}}else t.lineTo(e+r*ve(M),n+r*ie(M));return f}drawShape(i,t,e,n,o,r,s,l){const a=yt(i,r==null?void 0:r.theme).arc,{fill:h=a.fill,stroke:d=a.stroke,x:u=a.x,y:c=a.y,fillStrokeOrder:f=a.fillStrokeOrder}=i.attribute,g=this.valid(i,a,s,l);if(!g)return;const{fVisible:p,sVisible:v,doFill:m,doStroke:b}=g,{outerPadding:C=a.outerPadding,innerPadding:_=a.innerPadding,cap:w=a.cap,forceShowCap:y=a.forceShowCap}=i.attribute;let{outerRadius:x=a.outerRadius,innerRadius:S=a.innerRadius}=i.attribute;x+=C,S-=_;let R=0;const B=(He(w)&&w||w[0])&&h.gradient==="conical";if(B){const{sc:E,startAngle:T,endAngle:P}=i.getParsedAngle();Dt(P-T)<Vt-Kt&&(R=E||0,h.startAngle-=R,h.endAngle-=R)}let A=!1;const{isFullStroke:M,stroke:k}=uS(d);if(m||M){t.beginPath(),Iu(i,t,e,n,x,S),A=!0,t.setShadowBlendStyle&&t.setShadowBlendStyle(i,i.attribute,a),this.beforeRenderStep(i,t,e,n,m,b,p,v,a,o,s,l);const E=()=>{m&&(s?s(t,i.attribute,a):p&&(t.setCommonStyle(i,i.attribute,u-e,c-n,a),t.fill()))},T=()=>{b&&M&&(l?l(t,i.attribute,a):v&&(t.setStrokeStyle(i,i.attribute,u-e,c-n,a),t.stroke()))};f?(T(),E()):(E(),T())}if(!M&&b&&(t.beginPath(),Iu(i,t,e,n,x,S,k),A||this.beforeRenderStep(i,t,e,n,m,b,p,v,a,o,s,l),l?l(t,i.attribute,a):v&&(t.setStrokeStyle(i,i.attribute,e,n,a),t.stroke())),(He(w)&&w||w[1])&&y){const{startAngle:E,endAngle:T}=i.getParsedAngle();if(Dt(T-E)>=Vt-Kt){t.beginPath();const P=Math.abs(x-S)/2/x,{endAngle:H=a.endAngle,fill:L=a.fill}=i.attribute,F=H;this.drawArcTailCapPath(i,t,e,n,x,S,F,F+P),A||this.beforeRenderStep(i,t,e,n,m,b,p,v,a,o,s,l);const z=()=>{if(m){const N=L;if(N.gradient==="conical"){const W=US(0,0,H,N);s||Ho&&(t.setCommonStyle(i,i.attribute,e,n,a),t.fillStyle=W,t.fill())}}},I=()=>{b&&(l||v&&(t.setStrokeStyle(i,i.attribute,e,n,a),t.stroke()))};z(),I()}}this.afterRenderStep(i,t,e,n,m,b,p,v,a,o,s,l),B&&(h.startAngle+=R,h.endAngle+=R)}draw(i,t,e,n){const o=yt(i,n==null?void 0:n.theme).arc;this._draw(i,o,!1,e,n)}};ma=Ax([st(),Qf(0,At(ge)),Qf(0,Re(Ou)),Bx("design:paramtypes",[Object])],ma);var Mx=function(i,t,e,n){var o,r=arguments.length,s=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var l=i.length-1;l>=0;l--)(o=i[l])&&(s=(r<3?o(s):r>3?o(t,e,s):o(t,e))||s);return r>3&&s&&Object.defineProperty(t,e,s),s},Tx=function(i,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,t)},tp=function(i,t){return function(e,n){t(e,n,i)}};let ba=class extends ei{constructor(i){super(),this.circleRenderContribitions=i,this.numberType=Qh,this.builtinContributions=[dx,cx,ux],this.init(i)}drawShape(i,t,e,n,o,r,s,l){const a=yt(i,r==null?void 0:r.theme).circle,{radius:h=a.radius,startAngle:d=a.startAngle,endAngle:u=a.endAngle,x:c=a.x,y:f=a.y,fillStrokeOrder:g=a.fillStrokeOrder}=i.attribute,p=this.valid(i,a,s,l);if(!p)return;const{fVisible:v,sVisible:m,doFill:b,doStroke:C}=p;t.beginPath(),t.arc(e,n,h,d,u),t.closePath(),t.setShadowBlendStyle&&t.setShadowBlendStyle(i,i.attribute,a),this.beforeRenderStep(i,t,e,n,b,C,v,m,a,o,s,l);const _=()=>{b&&(s?s(t,i.attribute,a):v&&(t.setCommonStyle(i,i.attribute,c-e,f-n,a),t.fill()))},w=()=>{C&&(l?l(t,i.attribute,a):m&&(t.setStrokeStyle(i,i.attribute,c-e,f-n,a),t.stroke()))};g?(w(),_()):(_(),w()),this.afterRenderStep(i,t,e,n,b,C,v,m,a,o,s,l)}draw(i,t,e,n){const o=yt(i,n==null?void 0:n.theme).circle;this._draw(i,o,!1,e,n)}};ba=Mx([st(),tp(0,At(ge)),tp(0,Re(Du)),Tx("design:paramtypes",[Object])],ba);function Ca(i,t,e,n){if(!t.p1)return;const{offsetX:o=0,offsetY:r=0,offsetZ:s=0}=n||{};if(e===1)t.p2&&t.p3?i.bezierCurveTo(o+t.p1.x,r+t.p1.y,o+t.p2.x,r+t.p2.y,o+t.p3.x,r+t.p3.y,s):i.lineTo(o+t.p1.x,r+t.p1.y,s);else if(t.p2&&t.p3){const[l]=Au(t,e);i.bezierCurveTo(o+l.p1.x,r+l.p1.y,o+l.p2.x,r+l.p2.y,o+l.p3.x,r+l.p3.y,s)}else{const l=t.getPointAt(e);i.lineTo(o+l.x,r+l.y,s)}}function ep(i,t,e,n,o,r,s){var l;let a=t.p0,h=n;if(e&&e.originP1===e.originP2&&(a=e.p0),t.defined)n||(i.lineTo(a.x+o,a.y+r,s),h=!n);else{const{originP1:d,originP2:u}=t;let c;if(d&&d.defined!==!1&&!e?c=a:d&&u.defined!==!1&&(c=(l=t.p3)!==null&&l!==void 0?l:t.p1),n){h=!n;const f=c?c.x:t.p0.x,g=c?c.y:t.p0.y;i.moveTo(f+o,g+r,s)}else c&&(h=!n,i.lineTo(c.x+o,c.y+r,s))}return h}function Uu(i,t,e,n,o){const{offsetX:r=0,offsetY:s=0,offsetZ:l=0,mode:a="none",drawConnect:h=!1}=o||{};if(h&&a==="none"||!t)return;let d=!0;const{curves:u}=t;if(e>=1){if(h){let m,b=!0;u.forEach((C,_)=>{C.originP1!==C.originP2&&(b=ep(i,C,m,b,r,s,l)),m=C})}else u.forEach(m=>{m.defined?(d&&i.moveTo(m.p0.x+r,m.p0.y+s,l),Ca(i,m,1,o),d=!1):d=!0});return}if(e<=0)return;let c;n==="x"?c=Ut.ROW:n==="y"?c=Ut.COLUMN:n==="auto"&&(c=t.direction);const f=e*t.tryUpdateLength(c);let g=0,p=!0,v=null;for(let m=0,b=u.length;m<b;m++){const C=u[m],_=C.getLength(c),w=(f-g)/_;if(g+=_,w<0)break;if(h){if(C.originP1===C.originP2){v=C;continue}p=ep(i,C,v,p,r,s,l),v=C}else{if(!C.defined){d=!0;continue}d&&i.moveTo(C.p0.x+r,C.p0.y+s,l),Ca(i,C,Ie(w,1),o),d=!1}}}function Px(i,t,e,n){const{offsetX:o=0,offsetY:r=0}=n||{},s=t?t.points[t.points.length-1]:e.points[0];i.moveTo(s.x+o,s.y+r),e.points.forEach(l=>{l.defined!==!1?i.lineTo(l.x+o,l.y+r):i.moveTo(l.x+o,l.y+r)})}function Hx(i,t,e,n){const{offsetX:o=0,offsetY:r=0}=n||{},{points:s}=e,l=[];for(let a=0;a<s.length;a++)s[a].defined;l.push(s),l.forEach((a,h)=>{var d,u,c,f;const g=t&&h===0?t.points[t.points.length-1]:a[0];i.moveTo(g.x+o,g.y+r),a.forEach(p=>{p.defined!==!1?i.lineTo(p.x+o,p.y+r):i.moveTo(p.x+o,p.y+r)});for(let p=a.length-1;p>=0;p--){const v=a[p];i.lineTo((d=v.x1)!==null&&d!==void 0?d:v.x,(u=v.y1)!==null&&u!==void 0?u:v.y)}i.lineTo((c=g.x1)!==null&&c!==void 0?c:g.x,(f=g.y1)!==null&&f!==void 0?f:g.y),i.closePath()})}var kx=function(i,t,e,n){var o,r=arguments.length,s=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var l=i.length-1;l>=0;l--)(o=i[l])&&(s=(r<3?o(s):r>3?o(t,e,s):o(t,e))||s);return r>3&&s&&Object.defineProperty(t,e,s),s};let Ls=class extends ei{constructor(){super(...arguments),this.numberType=nl}draw(i,t,e,n){const o=yt(i,n==null?void 0:n.theme).line;this._draw(i,o,!1,e,n)}drawSegmentItem(i,t,e,n,o,r,s,l,a,h,d,u,c,f,g){var p,v,m,b,C;if(!t)return;i.beginPath();const _=(p=this.z)!==null&&p!==void 0?p:0;Uu(i.camera?i:i.nativeContext,t,a,h,{offsetX:d,offsetY:u,offsetZ:_}),c.cache&&!Q(c.cache)&&c.cache.curves.every(A=>A.defined)&&c.attribute.curveType&&c.attribute.curveType.includes("Closed")&&i.closePath(),i.setShadowBlendStyle&&i.setShadowBlendStyle(c,s,l);const{x:w=0,x:y=0}=s;e!==!1&&(f?f(i,s,l):o&&(i.setCommonStyle(c,s,w-d,y-u,l),i.fill())),n!==!1&&(g?g(i,s,l):r&&(i.setStrokeStyle(c,s,w-d,y-u,l),i.stroke()));let{connectedType:x,connectedX:S,connectedY:R,connectedStyle:B}=s;if(Q(l)?(x=(v=x??l[0].connectedType)!==null&&v!==void 0?v:l[1].connectedType,S=(m=S??l[0].connectedX)!==null&&m!==void 0?m:l[1].connectedX,R=(b=R??l[0].connectedY)!==null&&b!==void 0?b:l[1].connectedY,B=(C=B??l[0].connectedStyle)!==null&&C!==void 0?C:l[1].connectedStyle):(x=x??l.connectedType,S=S??l.connectedX,R=R??l.connectedY,B=B??l.connectedStyle),x!=="connect"&&x!=="zero"&&(x="none"),x!=="none"){i.beginPath(),Uu(i.camera?i:i.nativeContext,t,a,h,{offsetX:d,offsetY:u,offsetZ:_,drawConnect:!0,mode:x});const A=[];Q(l)?l.forEach(M=>A.push(M)):A.push(l),A.push(s),e!==!1&&(f?f(i,s,l):o&&(i.setCommonStyle(c,B,w-d,y-u,A),i.fill())),n!==!1&&(g?g(i,s,l):r&&(i.setStrokeStyle(c,B,w-d,y-u,A),i.stroke()))}return!1}drawLinearLineHighPerformance(i,t,e,n,o,r,s,l,a,h,d,u,c){var f;t.beginPath();const g=(f=this.z)!==null&&f!==void 0?f:0,{points:p}=i.attribute,v=p[0];t.moveTo(v.x+s,v.y+l,g);for(let C=1;C<p.length;C++){const _=p[C];t.lineTo(_.x+s,_.y+l,g)}t.setShadowBlendStyle&&t.setShadowBlendStyle(i,i.attribute,a);const{x:m=0,x:b=0}=i.attribute;e!==!1&&(u?u(t,i.attribute,a):o&&(t.setCommonStyle(i,i.attribute,m-s,b-l,a),t.fill())),n!==!1&&(c?c(t,i.attribute,a):r&&(t.setStrokeStyle(i,i.attribute,m-s,b-l,a),t.stroke()))}drawShape(i,t,e,n,o,r,s,l){const a=yt(i,r==null?void 0:r.theme).line,{fill:h=a.fill,stroke:d=a.stroke,fillOpacity:u=a.fillOpacity,strokeOpacity:c=a.strokeOpacity,segments:f,points:g,closePath:p,curveTension:v=a.curveTension}=i.attribute;if(!this.valid(i,a,s,l))return;let{curveType:m=a.curveType}=i.attribute;p&&m==="linear"&&(m="linearClosed");const{clipRange:b=a.clipRange,clipRangeByDimension:C=a.clipRangeByDimension}=i.attribute;if(b===1&&!f&&!g.some(_=>_.defined===!1)&&m==="linear")return this.drawLinearLineHighPerformance(i,t,!!h,!!d,u,c,e,n,a,o,r,s,l);if(i.shouldUpdateShape()){const{points:_,segments:w}=i.attribute,y=_;if(w&&w.length){let x,S;if(i.cache=w.map((R,B)=>{if(R.points.length<=1&&B===0)return R.points[0]&&(S={endX:R.points[0].x,endY:R.points[0].y,curves:[{defined:R.points[0].defined!==!1}]}),null;B===1?x={x:S.endX,y:S.endY,defined:S.curves[S.curves.length-1].defined}:B>1&&(x.x=S.endX,x.y=S.endY,x.defined=S.curves[S.curves.length-1].defined);const A=_o(R.points,m,{startPoint:x,curveTension:v});return S=A,A}).filter(R=>!!R),m==="linearClosed"){let R;for(let B=0;B<i.cache.length;B++){const A=i.cache[B];for(let M=0;M<A.curves.length;M++)if(A.curves[M].defined){R=A.curves[M].p0;break}if(R)break}i.cache[i.cache.length-1]&&i.cache[i.cache.length-1].lineTo(R.x,R.y,!0)}}else{if(!_||!_.length)return i.cache=null,void i.clearUpdateShapeTag();i.cache=_o(y,m,{curveTension:v})}i.clearUpdateShapeTag()}if(Array.isArray(i.cache)){const _=i.attribute.segments.filter(w=>w.points.length);if(_[0].points.length===1&&_.shift(),b===1){let w=!1;i.cache.forEach((y,x)=>{w||(w=this.drawSegmentItem(t,y,!!h,!!d,u,c,_[x],[a,i.attribute],b,C,e,n,i,s,l))})}else{const w=i.cache.reduce((R,B)=>R+B.getLength(),0),y=b*w;let x=0,S=!1;i.cache.forEach((R,B)=>{if(S)return;const A=R.getLength(),M=(y-x)/A;x+=A,M>0&&(S=this.drawSegmentItem(t,R,!!h,!!d,u,c,_[B],[a,i.attribute],Ie(M,1),C,e,n,i,s,l))})}}else this.drawSegmentItem(t,i.cache,!!h,!!d,u,c,i.attribute,a,b,C,e,n,i,s,l)}};Ls=kx([st()],Ls);function Ex(i,t,e,n){var o;const{drawConnect:r=!1,mode:s="none"}=n||{};if(r&&s==="none")return;const{top:l,bottom:a}=t;if(l.curves.length!==a.curves.length)return;if(e>=1){const y=[],x=[];let S=!0;if(r){let R,B,A=!0;const M=l.curves.length;l.curves.forEach((k,E)=>{const T=a.curves[M-E-1];let P=k,H=T;if(k.originP1===k.originP2)return R=k,void(B=T);if(R&&R.originP1===R.originP2&&(P=R,H=B),k.defined)A||(y.push(P),x.push(H),Vo(i,y,x,n),y.length=0,x.length=0,A=!A);else{const{originP1:L,originP2:F}=k;let z,I;L&&L.defined!==!1?(z=P,I=H):L&&F.defined!==!1&&(z=k,I=T),A?(A=!A,y.push(z||k),x.push(I||T)):z&&(A=!A,y.push(z||k),x.push(I||T),Vo(i,y,x,n),y.length=0,x.length=0)}R=k}),Vo(i,y,x,n)}else{for(let R=0,B=l.curves.length;R<B;R++){const A=l.curves[R];S!==A.defined?(S?(Bl(i,y,x,n),y.length=0,x.length=0):(y.push(A),x.push(a.curves[B-R-1])),S=!S):S&&(y.push(A),x.push(a.curves[B-R-1]))}Bl(i,y,x,n)}return}if(e<=0)return;let{direction:h}=n||{};const{curves:d}=l,u=(o=d[d.length-1].p3)!==null&&o!==void 0?o:d[d.length-1].p1,c=Dt(u.x-d[0].p0.x),f=Dt(u.y-d[0].p0.y);h=h??(c>f?Ut.ROW:Ut.COLUMN),Number.isFinite(c)||(h=Ut.COLUMN),Number.isFinite(f)||(h=Ut.ROW);const g=e*(h===Ut.ROW?c:f);let p=0,v=!0;const m=[],b=[];let C,_,w=!0;for(let y=0,x=l.curves.length;y<x;y++){const S=l.curves[y],R=S.getLength(h),B=(g-p)/R;if(B<0)break;if(p+=R,r){const A=a.curves[x-y-1];let M=S,k=A;if(S.originP1===S.originP2){C=S,_=A;continue}if(C&&C.originP1===C.originP2&&(M=C,k=_),S.defined)w||(m.push(M),b.push(k),Vo(i,m,b,n),m.length=0,b.length=0,w=!w);else{const{originP1:E,originP2:T}=S;let P,H;E&&E.defined!==!1?(P=M,H=k):E&&T.defined!==!1&&(P=S,H=A),w?(w=!w,m.push(P||S),b.push(H||A)):P&&(w=!w,m.push(P||S),b.push(H||A),Vo(i,m,b,n),m.length=0,b.length=0)}C=S}else{let A=null,M=null;v!==S.defined?(v?(Bl(i,m,b,n),m.length=0,b.length=0):(A=S,M=a.curves[x-y-1]),v=!v):v&&(A=S,M=a.curves[x-y-1]),A&&M&&(B<1&&(A=A.p2&&A.p3?Au(A,B)[0]:Tf(A,B)[0],M=M.p2&&M.p3?Au(M,1-B)[1]:Tf(M,1-B)[1]),A.defined=v,M.defined=v,m.push(A),b.push(M)),A=null,M=null}}r?Vo(i,m,b,n):Bl(i,m,b,n)}function Vo(i,t,e,n){if(t.length<2)return;const{offsetX:o=0,offsetY:r=0,offsetZ:s=0}=n||{};let l=t[0];i.moveTo(l.p0.x+o,l.p0.y+r,s),l=t[t.length-1];let a=l.p3||l.p1;i.lineTo(a.x+o,a.y+r,s),l=e[e.length-1],i.lineTo(l.p0.x+o,l.p0.y+r,s),l=e[0],a=l.p3||l.p1,i.lineTo(a.x+o,a.y+r,s),i.closePath()}function Bl(i,t,e,n){const{offsetX:o=0,offsetY:r=0,offsetZ:s=0}=n||{};let l=!0;t.forEach(a=>{a.defined?(l&&i.moveTo(a.p0.x+o,a.p0.y+r,s),Ca(i,a,1,n),l=!1):l=!0}),l=!0;for(let a=e.length-1;a>=0;a--){const h=e[a];h.defined?(l&&i.lineTo(h.p0.x+o,h.p0.y+r,s),Ca(i,h,1,n),l=!1):l=!0}i.closePath()}const Lx=new Rx,Fx=eo;var zx=function(i,t,e,n){var o,r=arguments.length,s=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var l=i.length-1;l>=0;l--)(o=i[l])&&(s=(r<3?o(s):r>3?o(t,e,s):o(t,e))||s);return r>3&&s&&Object.defineProperty(t,e,s),s},Ix=function(i,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,t)},ip=function(i,t){return function(e,n){t(e,n,i)}};let $u=class extends ei{constructor(i){super(),this.areaRenderContribitions=i,this.numberType=_C,this.builtinContributions=[Lx,Fx],this.init(i)}drawLinearAreaHighPerformance(i,t,e,n,o,r,s,l,a,h,d,u,c){var f,g,p;const{points:v}=i.attribute;if(v.length<2)return;t.beginPath();const m=(f=this.z)!==null&&f!==void 0?f:0,b=v[0];t.moveTo(b.x+s,b.y+l,m);for(let w=1;w<v.length;w++){const y=v[w];t.lineTo(y.x+s,y.y+l,m)}for(let w=v.length-1;w>=0;w--){const y=v[w];t.lineTo(((g=y.x1)!==null&&g!==void 0?g:y.x)+s,((p=y.y1)!==null&&p!==void 0?p:y.y)+l,m)}t.closePath(),t.setShadowBlendStyle&&t.setShadowBlendStyle(i,i.attribute,a),this.beforeRenderStep(i,t,s,l,!!o,!1,e,!1,a,h,u,null,{attribute:i.attribute});const{x:C=0,x:_=0}=i.attribute;e!==!1&&(u?u(t,i.attribute,a):o&&(t.setCommonStyle(i,i.attribute,C-s,_-l,a),t.fill())),this.afterRenderStep(i,t,s,l,!!o,!1,e,!1,a,h,u,null,{attribute:i.attribute}),(()=>{var w,y;if(n){const{stroke:x=a&&a.stroke}=i.attribute;if(Q(x)&&(x[0]||x[2])&&x[1]===!1){if(t.beginPath(),x[0]){t.moveTo(b.x+s,b.y+l,m);for(let S=1;S<v.length;S++){const R=v[S];t.lineTo(R.x+s,R.y+l,m)}}else if(x[2]){const S=v[v.length-1];t.moveTo(S.x+s,S.y+l,m);for(let R=v.length-2;R>=0;R--){const B=v[R];t.lineTo(((w=B.x1)!==null&&w!==void 0?w:B.x)+s,((y=B.y1)!==null&&y!==void 0?y:B.y)+l,m)}}}c?c(t,i.attribute,a):(t.setStrokeStyle(i,i.attribute,C-s,_-l,a),t.stroke())}})()}drawShape(i,t,e,n,o,r,s,l){var a,h,d,u,c,f;const g=yt(i,r==null?void 0:r.theme).area,{fill:p=g.fill,stroke:v=g.stroke,fillOpacity:m=g.fillOpacity,z:b=g.z,strokeOpacity:C=g.strokeOpacity,curveTension:_=g.curveTension}=i.attribute,w=this.valid(i,g,s,l);if(!w)return;const{doFill:y}=w,x=w.doStroke&&w.sVisible,{clipRange:S=g.clipRange,closePath:R,points:B,segments:A}=i.attribute;let{curveType:M=g.curveType}=i.attribute;if(R&&M==="linear"&&(M="linearClosed"),S===1&&!A&&!B.some(k=>k.defined===!1)&&M==="linear")return this.drawLinearAreaHighPerformance(i,t,!!p,x,m,C,e,n,g,o,r,s,l);if(i.shouldUpdateShape()){if(A&&A.length){let k,E;const T=A.map((L,F)=>{if(L.points.length<=1&&F===0)return L.points[0]&&(E={endX:L.points[0].x,endY:L.points[0].y}),null;F===1?k={x:E.endX,y:E.endY}:F>1&&(k.x=E.endX,k.y=E.endY);const z=_o(L.points,M,{startPoint:k,curveTension:_});return E=z,z}).filter(L=>!!L);let P;const H=[];for(let L=A.length-1;L>=0;L--){const F=A[L].points,z=[];for(let I=F.length-1;I>=0;I--)z.push({x:(a=F[I].x1)!==null&&a!==void 0?a:F[I].x,y:(h=F[I].y1)!==null&&h!==void 0?h:F[I].y});if(L!==0){const I=A[L-1].points,N=I[I.length-1];N&&z.push({x:(d=N.x1)!==null&&d!==void 0?d:N.x,y:(u=N.y1)!==null&&u!==void 0?u:N.y})}z.length>1&&(P=_o(z,M==="stepBefore"?"stepAfter":M==="stepAfter"?"stepBefore":M,{curveTension:_}),H.unshift(P))}i.cacheArea=H.map((L,F)=>({top:T[F],bottom:L}))}else{if(!B||!B.length)return i.cacheArea=null,void i.clearUpdateShapeTag();{const k=B,E=[];for(let H=B.length-1;H>=0;H--)E.push({x:(c=B[H].x1)!==null&&c!==void 0?c:B[H].x,y:(f=B[H].y1)!==null&&f!==void 0?f:B[H].y});const T=_o(k,M,{curveTension:_}),P=_o(E,M==="stepBefore"?"stepAfter":M==="stepAfter"?"stepBefore":M,{curveTension:_});i.cacheArea={top:T,bottom:P}}}i.clearUpdateShapeTag()}if(Array.isArray(i.cacheArea)){const k=i.attribute.segments.filter(E=>E.points.length);if(k[0].points.length===1&&k.shift(),S===1){let E=!1;i.cacheArea.forEach((T,P)=>{E||(E=this.drawSegmentItem(t,T,y,m,x,C,k[P],[g,i.attribute],S,e,n,b,i,o,s,l))})}else{const E=i.cacheArea.reduce((L,F)=>L+F.top.getLength(),0),T=S*E;let P=0,H=!1;i.cacheArea.forEach((L,F)=>{if(H)return;const z=L.top.getLength(),I=(T-P)/z;P+=z,I>0&&(H=this.drawSegmentItem(t,L,y,m,x,C,k[F],[g,i.attribute],Ie(I,1),e,n,b,i,o,s,l))})}}else this.drawSegmentItem(t,i.cacheArea,y,m,x,C,i.attribute,g,S,e,n,b,i,o,s,l)}draw(i,t,e,n){const o=yt(i,n==null?void 0:n.theme).area;this._draw(i,o,!1,e,n)}drawSegmentItem(i,t,e,n,o,r,s,l,a,h,d,u,c,f,g,p){let v=!1;return v=v||this._drawSegmentItem(i,t,e,n,o,r,s,l,a,h,d,u,c,f,!1,g,p),v=v||this._drawSegmentItem(i,t,e,n,o,r,s,l,a,h,d,u,c,f,!0,g,p),v}_drawSegmentItem(i,t,e,n,o,r,s,l,a,h,d,u,c,f,g,p,v){var m,b,C,_;if(!(t&&t.top&&t.bottom&&t.top.curves&&t.top.curves.length&&t.bottom.curves&&t.bottom.curves.length))return;let{connectedType:w,connectedX:y,connectedY:x,connectedStyle:S}=s;const R=[];if(g&&(Q(l)?(w=(m=w??l[0].connectedType)!==null&&m!==void 0?m:l[1].connectedType,y=(b=y??l[0].connectedX)!==null&&b!==void 0?b:l[1].connectedX,x=(C=x??l[0].connectedY)!==null&&C!==void 0?C:l[1].connectedY,S=(_=S??l[0].connectedStyle)!==null&&_!==void 0?_:l[1].connectedStyle):(w=w??l.connectedType,y=y??l.connectedX,x=x??l.connectedY,S=S??l.connectedStyle),w!=="connect"&&w!=="zero"&&(w="none"),Q(l)?l.forEach(F=>R.push(F)):R.push(l),R.push(s)),g&&w==="none")return!1;i.beginPath();const{points:B,segments:A}=c.attribute;let M,k,E=Ut.ROW;if(A){const F=A[A.length-1];k=A[0].points[0],M=F.points[F.points.length-1]}else k=B[0],M=B[B.length-1];const T=Dt(M.x-k.x),P=Dt(M.y-k.y);E=M.x1==null?Ut.ROW:M.y1==null?Ut.COLUMN:Number.isFinite(T+P)?T>P?Ut.ROW:Ut.COLUMN:Ut.ROW,Ex(i.camera?i:i.nativeContext,t,a,{offsetX:h,offsetY:d,offsetZ:u,direction:E,drawConnect:g,mode:w}),this.beforeRenderStep(c,i,h,d,!!n,!1,e,!1,l,f,p,null,{attribute:s}),i.setShadowBlendStyle&&i.setShadowBlendStyle(c,s,l);const{x:H=0,x:L=0}=s;return e!==!1&&(p?p(i,s,l):n&&(i.setCommonStyle(c,g?S:s,H-h,L-d,g?R:l),i.fill())),this.afterRenderStep(c,i,h,d,!!n,!1,e,!1,l,f,p,null,{attribute:s}),(()=>{if(o!==!1)if(v)v(i,s,l);else{const{stroke:F=l&&l[1]&&l[1].stroke}=s;Q(F)&&(F[0]||F[2])&&F[1]===!1&&(i.beginPath(),Uu(i.camera?i:i.nativeContext,F[0]?t.top:t.bottom,a,E===Ut.ROW?"x":"y",{offsetX:h,offsetY:d,offsetZ:u,drawConnect:g,mode:w})),i.setStrokeStyle(c,g?S:s,H-h,L-d,g?R:l),i.stroke()}})(),!1}};$u=zx([st(),ip(0,At(ge)),ip(0,Re(KS)),Ix("design:paramtypes",[Object])],$u);const Ox=Ir,Dx=eo;var Wx=function(i,t,e,n){var o,r=arguments.length,s=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var l=i.length-1;l>=0;l--)(o=i[l])&&(s=(r<3?o(s):r>3?o(t,e,s):o(t,e))||s);return r>3&&s&&Object.defineProperty(t,e,s),s},Nx=function(i,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,t)},np=function(i,t){return function(e,n){t(e,n,i)}};let _a=class extends ei{constructor(i){super(),this.pathRenderContribitions=i,this.numberType=ed,this.builtinContributions=[Dx,Ox],this.init(i)}drawShape(i,t,e,n,o,r,s,l){var a,h,d;const u=(a=this.tempTheme)!==null&&a!==void 0?a:yt(i,r==null?void 0:r.theme).path,{x:c=u.x,y:f=u.y,fillStrokeOrder:g=u.fillStrokeOrder}=i.attribute,p=(h=this.z)!==null&&h!==void 0?h:0,v=this.valid(i,u,s,l);if(!v)return;const{fVisible:m,sVisible:b,doFill:C,doStroke:_}=v;if(t.beginPath(),i.pathShape)Qn(i.pathShape.commandList,t,e,n,1,1,p);else{const x=(d=i.attribute.path)!==null&&d!==void 0?d:u.path;Qn(x.commandList,t,e,n,1,1,p)}t.setShadowBlendStyle&&t.setShadowBlendStyle(i,i.attribute,u),this.beforeRenderStep(i,t,e,n,C,_,m,b,u,o,s,l);const w=()=>{_&&(l?l(t,i.attribute,u):b&&(t.setStrokeStyle(i,i.attribute,c-e,f-n,u),t.stroke()))},y=()=>{C&&(s?s(t,i.attribute,u):m&&(t.setCommonStyle(i,i.attribute,c-e,f-n,u),t.fill()))};g?(w(),y()):(y(),w()),this.afterRenderStep(i,t,e,n,C,_,m,b,u,o,s,l)}draw(i,t,e,n){const o=yt(i,n==null?void 0:n.theme).path;this.tempTheme=o,this._draw(i,o,!1,e,n),this.tempTheme=null}};_a=Wx([st(),np(0,At(ge)),np(0,Re(Wu)),Nx("design:paramtypes",[Object])],_a);var Vx=function(i,t,e,n){var o,r=arguments.length,s=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var l=i.length-1;l>=0;l--)(o=i[l])&&(s=(r<3?o(s):r>3?o(t,e,s):o(t,e))||s);return r>3&&s&&Object.defineProperty(t,e,s),s},Gx=function(i,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,t)},op=function(i,t){return function(e,n){t(e,n,i)}};let wa=class extends ei{constructor(i){super(),this.rectRenderContribitions=i,this.type="rect",this.numberType=Tg,this.builtinContributions=[px,mx,vx],this.init(i)}drawShape(i,t,e,n,o,r,s,l){var a;const h=(a=this.tempTheme)!==null&&a!==void 0?a:yt(i,r==null?void 0:r.theme).rect,{fill:d=h.fill,background:u,stroke:c=h.stroke,cornerRadius:f=h.cornerRadius,opacity:g=h.opacity,fillOpacity:p=h.fillOpacity,lineWidth:v=h.lineWidth,strokeOpacity:m=h.strokeOpacity,visible:b=h.visible,x1:C,y1:_,x:w=h.x,y=h.y,fillStrokeOrder:x=h.fillStrokeOrder}=i.attribute;let{width:S,height:R}=i.attribute;S=(S??C-w)||0,R=(R??_-y)||0;const B=BC(g,p,S,R,d),A=MC(g,m,S,R),M=zr(d,u),k=ol(c,v);if(!i.valid||!b||!M&&!k||!(B||A||s||l||u))return;f===0||Q(f)&&f.every(H=>H===0)?(t.beginPath(),t.rect(e,n,S,R)):(t.beginPath(),en(t,e,n,S,R,f));const E={doFill:M,doStroke:k};t.setShadowBlendStyle&&t.setShadowBlendStyle(i,i.attribute,h),this.beforeRenderStep(i,t,e,n,M,k,B,A,h,o,s,l,E);const T=()=>{E.doFill&&(s?s(t,i.attribute,h):B&&(t.setCommonStyle(i,i.attribute,w-e,y-n,h),t.fill()))},P=()=>{E.doStroke&&(l?l(t,i.attribute,h):A&&(t.setStrokeStyle(i,i.attribute,w-e,y-n,h),t.stroke()))};x?(P(),T()):(T(),P()),this.afterRenderStep(i,t,e,n,M,k,B,A,h,o,s,l)}draw(i,t,e,n){const o=yt(i,n==null?void 0:n.theme).rect;this.tempTheme=o,this._draw(i,o,!1,e,n),this.tempTheme=null}};wa=Vx([st(),op(0,At(ge)),op(0,Re(So)),Gx("design:paramtypes",[Object])],wa);var jx=function(i,t,e,n){var o,r=arguments.length,s=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var l=i.length-1;l>=0;l--)(o=i[l])&&(s=(r<3?o(s):r>3?o(t,e,s):o(t,e))||s);return r>3&&s&&Object.defineProperty(t,e,s),s},Ux=function(i,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,t)},rp=function(i,t){return function(e,n){t(e,n,i)}};let ya=class extends ei{constructor(i){super(),this.symbolRenderContribitions=i,this.numberType=nd,this.builtinContributions=[yx,xx,Sx],this.init(i)}drawShape(i,t,e,n,o,r,s,l){var a;const h=yt(i,r==null?void 0:r.theme).symbol,{size:d=h.size,x:u=h.x,y:c=h.y,scaleX:f=h.scaleX,scaleY:g=h.scaleY,fillStrokeOrder:p=h.fillStrokeOrder}=i.attribute,v=this.valid(i,h,s,l);if(!v)return;const{fVisible:m,sVisible:b,doFill:C,doStroke:_}=v,w=i.getParsedPath();if(!w)return;const{keepDirIn3d:y=h.keepDirIn3d}=i.attribute,x=(a=this.z)!==null&&a!==void 0?a:0;t.beginPath();const S=(A,M)=>{var k,E,T;if(i._parsedPath.svgCache){const L=Object.assign({},M);L.fill=(k=M.fill)!==null&&k!==void 0?k:i.attribute.fill,L.opacity=(E=M.opacity)!==null&&E!==void 0?E:i.attribute.opacity,L.fillOpacity=i.attribute.fillOpacity,L.stroke=(T=M.stroke)!==null&&T!==void 0?T:i.attribute.stroke,M=L}const P=()=>{M.fill&&(s?s(t,i.attribute,h):(t.setCommonStyle(i,M,u-e,c-n,h),t.fill()))},H=()=>{M.stroke&&(l?l(t,i.attribute,h):(t.setStrokeStyle(i,M,(u-e)/f,(c-n)/g,h),t.stroke()))};p?(H(),P()):(P(),H())};if(y&&t.camera&&t.project){const A=t.project(e,n,x),M=t.camera;t.camera=null,w.draw(t,Q(d)?[d[0]*f,d[1]*g]:d*f,A.x,A.y,void 0,S)===!1&&t.closePath(),t.camera=M}else w.draw(t,d,e,n,x,S)===!1&&t.closePath();t.setShadowBlendStyle&&t.setShadowBlendStyle(i,i.attribute,h),this.beforeRenderStep(i,t,e,n,C,_,m,b,h,o,s,l);const R=()=>{C&&!w.isSvg&&(s?s(t,i.attribute,h):m&&(t.setCommonStyle(i,i.attribute,u-e,c-n,h),t.fill()))},B=()=>{_&&!w.isSvg&&(l?l(t,i.attribute,h):b&&(t.setStrokeStyle(i,i.attribute,(u-e)/f,(c-n)/g,h),t.stroke()))};p?(B(),R()):(R(),B()),this.afterRenderStep(i,t,e,n,C,_,m,b,h,o,s,l)}draw(i,t,e,n){const o=yt(i,n==null?void 0:n.theme).symbol;this._draw(i,o,!1,e,n)}};ya=jx([st(),rp(0,At(ge)),rp(0,Re(Vu)),Ux("design:paramtypes",[Object])],ya);class $x{constructor(){this.pools=[];for(let t=0;t<10;t++)this.pools.push(new Gt)}allocate(t,e,n,o){if(!this.pools.length)return new Gt().setValue(t,e,n,o);const r=this.pools.pop();return r.x1=t,r.y1=e,r.x2=n,r.y2=o,r}allocateByObj(t){if(!this.pools.length)return new Gt(t);const e=this.pools.pop();return e.x1=t.x1,e.y1=t.y1,e.x2=t.x2,e.y2=t.y2,e}free(t){this.pools.push(t)}get length(){return this.pools.length}release(...t){this.pools=[]}}const Sa=new $x;class Kx{constructor(){this.store=new Map}RegisterGraphicCreator(t,e){this.store.set(t,e),this[t]=e}CreateGraphic(t,e){const n=this.store.get(t);return n?n(e):null}}const ft=new Kx;let Ml;function sd(i){return Ml||(Ml=ft.CreateGraphic("text",{})),Ml.initAttributes(i),Ml.AABBBounds}class Yx extends rd{constructor(){super(...arguments),this.time=Et.beforeFillStroke}drawShape(t,e,n,o,r,s,l,a,h,d,u,c){var f,g,p,v,m,b,C,_,w,y;const{backgroundMode:x=h.backgroundMode,backgroundFit:S=h.backgroundFit}=t.attribute;let R,{background:B}=t.attribute;if(!B)return;const A=()=>{t.type==="richtext"&&(e.restore(),e.save(),R&&e.setTransformFromMatrix(R,!0,1))};let M;t.type==="richtext"&&(R=e.currentMatrix.clone(),e.restore(),e.save(),e.setTransformForCurrent());const k=kt(B)&&B.background,E=t.transMatrix.onlyTranslate();if(k){const T=t.AABBBounds,P=((f=B.x)!==null&&f!==void 0?f:T.x1)+((g=B.dx)!==null&&g!==void 0?g:0),H=((p=B.y)!==null&&p!==void 0?p:T.y1)+((v=B.dy)!==null&&v!==void 0?v:0),L=(m=B.width)!==null&&m!==void 0?m:T.width(),F=(b=B.height)!==null&&b!==void 0?b:T.height();if(M=Sa.allocate(P,H,P+L,H+F),B=B.background,!E){const z=M.width(),I=M.height();M.set(((C=B.x)!==null&&C!==void 0?C:0)+((_=B.dx)!==null&&_!==void 0?_:0),((w=B.y)!==null&&w!==void 0?w:0)+((y=B.dy)!==null&&y!==void 0?y:0),z,I)}}else M=t.AABBBounds,E||(M=sd(Object.assign(Object.assign({},t.attribute),{angle:0,scaleX:1,scaleY:1,x:0,y:0,dx:0,dy:0})).clone());if(t.backgroundImg&&t.resources){const T=t.resources.get(B);if(T.state!=="success"||!T.data)return void A();e.highPerformanceSave(),E&&e.setTransformFromMatrix(t.parent.globalTransMatrix,!0),e.setCommonStyle(t,t.attribute,n,o,h),this.doDrawImage(e,T.data,M,x,S),e.highPerformanceRestore(),e.setTransformForCurrent()}else{const{backgroundCornerRadius:T}=t.attribute;e.highPerformanceSave(),e.setCommonStyle(t,t.attribute,n,o,h),e.fillStyle=B,T?(en(e,M.x1,M.y1,M.width(),M.height(),T),e.fill()):e.fillRect(M.x1,M.y1,M.width(),M.height()),e.highPerformanceRestore()}k&&Sa.free(M),A()}}const LC=new Yx;var Xx=function(i,t,e,n){var o,r=arguments.length,s=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var l=i.length-1;l>=0;l--)(o=i[l])&&(s=(r<3?o(s):r>3?o(t,e,s):o(t,e))||s);return r>3&&s&&Object.defineProperty(t,e,s),s},qx=function(i,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,t)},sp=function(i,t){return function(e,n){t(e,n,i)}};let Ku=class extends ei{constructor(i){super(),this.textRenderContribitions=i,this.numberType=od,this.builtinContributions=[LC],this.init(i)}drawShape(i,t,e,n,o,r,s,l){var a,h,d;const u=yt(i,r==null?void 0:r.theme).text,{text:c,underline:f=u.underline,lineThrough:g=u.lineThrough,keepDirIn3d:p=u.keepDirIn3d,direction:v=u.direction,fontSize:m=u.fontSize,verticalMode:b=u.verticalMode,x:C=u.x,y:_=u.y}=i.attribute,w=(a=il(i.attribute.lineHeight,m))!==null&&a!==void 0?a:m,y=this.valid(i,u,s,l);if(!y)return;const{fVisible:x,sVisible:S,doFill:R,doStroke:B}=y,A=!p,M=this.z||0;t.beginPath(),t.setShadowBlendStyle&&t.setShadowBlendStyle(i,i.attribute,u),this.beforeRenderStep(i,t,e,n,R,B,x,S,u,o,s,l),A&&this.transformUseContext2d(i,u,M,t);const k=(E,T,P,H)=>{let L=e+T;const F=n+P;if(H){t.highPerformanceSave(),L+=m;const z=Ze.allocate(1,0,0,1,0,0);z.rotateByCenter(Math.PI/2,L,F),t.transformFromMatrix(z,!0),Ze.free(z)}B&&(l?l(t,i.attribute,u):S&&(t.setStrokeStyle(i,i.attribute,C-e,_-n,u),t.strokeText(E,L,F,M))),R&&(s?s(t,i.attribute,u):x&&(t.setCommonStyle(i,i.attribute,C-e,_-n,u),t.fillText(E,L,F,M))),H&&(t.highPerformanceRestore(),t.setTransformForCurrent())};if(t.setTextStyleWithoutAlignBaseline(i.attribute,u,M),v==="horizontal"){const{multilineLayout:E}=i;if(!E)return void t.highPerformanceRestore();const{xOffset:T,yOffset:P}=E.bbox;B&&(l?l(t,i.attribute,u):S&&(t.setStrokeStyle(i,i.attribute,C-e,_-n,u),E.lines.forEach(H=>{t.strokeText(H.str,(H.leftOffset||0)+T+e,(H.topOffset||0)+P+n,M)}))),R&&(s?s(t,i.attribute,u):x&&(t.setCommonStyle(i,i.attribute,C-e,_-n,u),E.lines.forEach(H=>{t.fillText(H.str,(H.leftOffset||0)+T+e,(H.topOffset||0)+P+n,M),this.drawUnderLine(f,g,i,(H.leftOffset||0)+T+e,(H.topOffset||0)+P+n,H.descent,(H.descent-H.ascent)/2,M,u,t,{width:H.width})})))}else{let{textAlign:E=u.textAlign,textBaseline:T=u.textBaseline}=i.attribute;if(!b){const N=E;E=(h=i.getBaselineMapAlign()[T])!==null&&h!==void 0?h:"left",T=(d=i.getAlignMapBaseline()[N])!==null&&d!==void 0?d:"top"}i.tryUpdateAABBBounds();const P=i.cache,{verticalList:H}=P;t.textAlign="left",t.textBaseline="top";const L=w*H.length;let F=0;H.forEach(N=>{const W=N.reduce((D,j)=>D+(j.width||0),0);F=Jn(W,F)});let z=0,I=0;T==="bottom"?I=-L:T==="middle"&&(I=-L/2),E==="center"?z-=F/2:E==="right"&&(z-=F),H.forEach((N,W)=>{const D=N.reduce((X,K)=>X+(K.width||0),0),j=F-D;let V=z;E==="center"?V+=j/2:E==="right"&&(V+=j),N.forEach(X=>{const{text:K,width:J,direction:ot}=X;k(K,L-(W+1)*w+I,V,ot),V+=J})})}A&&this.restoreTransformUseContext2d(i,u,M,t),this.afterRenderStep(i,t,e,n,R,B,x,S,u,o,s,l)}draw(i,t,e,n){const o=yt(i,n==null?void 0:n.theme).text,{keepDirIn3d:r=o.keepDirIn3d}=i.attribute,s=!r;this._draw(i,o,s,e,n)}drawUnderLine(i,t,e,n,o,r,s,l,a,h,d){if(t+i<=0)return;const{textAlign:u=a.textAlign,fill:c=a.fill,opacity:f=a.opacity,underlineOffset:g=a.underlineOffset,underlineDash:p=a.underlineDash,fillOpacity:v=a.fillOpacity}=e.attribute,m=!Pt(d),b=m?d.width:e.clipedWidth,C=m?0:Sr(u,b),_={lineWidth:0,stroke:c,opacity:f,strokeOpacity:v};if(i){_.lineWidth=i,h.setStrokeStyle(e,_,n,o,a),p&&h.setLineDash(p),h.beginPath();const w=o+r+g;h.moveTo(n+C,w,l),h.lineTo(n+C+b,w,l),h.stroke()}if(t){_.lineWidth=t,h.setStrokeStyle(e,_,n,o,a),h.beginPath();const w=o+s;h.moveTo(n+C,w,l),h.lineTo(n+C+b,w,l),h.stroke()}}};Ku=Xx([st(),sp(0,At(ge)),sp(0,Re(va)),qx("design:paramtypes",[Object])],Ku);function FC(i,t,e,n){i.moveTo(t[0].x+e,t[0].y+n);for(let o=1;o<t.length;o++)i.lineTo(t[o].x+e,t[o].y+n)}function Zx(i,t,e,n,o,r=!0){var s;if(t.length<3)return void FC(i,t,e,n);let l=0,a=t.length-1;r||(l+=1,a-=1,i.moveTo(t[0].x+e,t[0].y+n));for(let h=l;h<=a;h++){const d=t[h===0?a:(h-1)%t.length],u=t[h%t.length],c=t[(h+1)%t.length],f=u.x-d.x,g=u.y-d.y,p=u.x-c.x,v=u.y-c.y,m=(Math.atan2(g,f)-Math.atan2(v,p))/2,b=Math.abs(Math.tan(m));let C=Array.isArray(o)?(s=o[h%t.length])!==null&&s!==void 0?s:0:o,_=C/b;const w=Tl(f,g),y=Tl(p,v),x=Math.min(w,y);_>x&&(_=x,C=x*b);const S=Wd(u,_,w,f,g),R=Wd(u,_,y,p,v),B=2*u.x-S.x-R.x,A=2*u.y-S.y-R.y,M=Tl(B,A),k=Wd(u,Tl(_,C),M,B,A);let E=Math.atan2(S.y-k.y,S.x-k.x);const T=Math.atan2(R.y-k.y,R.x-k.x);let P=T-E;P<0&&(E=T,P=-P),P>Math.PI&&(P-=Math.PI),h===0?i.moveTo(S.x+e,S.y+n):i.lineTo(S.x+e,S.y+n),P&&i.arcTo(u.x+e,u.y+n,R.x+e,R.y+n,C),i.lineTo(R.x+e,R.y+n)}r||i.lineTo(t[a+1].x+e,t[a+1].y+n)}function Tl(i,t){return Math.sqrt(i*i+t*t)}function Wd(i,t,e,n,o){const r=t/e;return{x:i.x-n*r,y:i.y-o*r}}const Jx=Ir,Qx=eo;var tR=function(i,t,e,n){var o,r=arguments.length,s=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var l=i.length-1;l>=0;l--)(o=i[l])&&(s=(r<3?o(s):r>3?o(t,e,s):o(t,e))||s);return r>3&&s&&Object.defineProperty(t,e,s),s},eR=function(i,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,t)},lp=function(i,t){return function(e,n){t(e,n,i)}};let Yu=class extends ei{constructor(i){super(),this.polygonRenderContribitions=i,this.numberType=id,this.builtinContributions=[Qx,Jx],this.init(i)}drawShape(i,t,e,n,o,r,s,l){const a=yt(i,r==null?void 0:r.theme).polygon,{points:h=a.points,cornerRadius:d=a.cornerRadius,x:u=a.x,y:c=a.y,closePath:f=a.closePath,fillStrokeOrder:g=a.fillStrokeOrder}=i.attribute,p=this.valid(i,a,s,l);if(!p)return;const{fVisible:v,sVisible:m,doFill:b,doStroke:C}=p;t.beginPath(),d<=0||Q(d)&&d.every(y=>y===0)?FC(t.camera?t:t.nativeContext,h,e,n):Zx(t.camera?t:t.nativeContext,h,e,n,d,f),f&&t.closePath(),t.setShadowBlendStyle&&t.setShadowBlendStyle(i,i.attribute,a),this.beforeRenderStep(i,t,e,n,b,C,v,m,a,o,s,l);const _=()=>{b&&(s?s(t,i.attribute,a):v&&(t.setCommonStyle(i,i.attribute,u-e,c-n,a),t.fill()))},w=()=>{C&&(l?l(t,i.attribute,a):m&&(t.setStrokeStyle(i,i.attribute,u-e,c-n,a),t.stroke()))};g?(w(),_()):(_(),w()),this.afterRenderStep(i,t,e,n,b,C,v,m,a,o,s,l)}draw(i,t,e,n){const o=yt(i,n==null?void 0:n.theme).polygon;this._draw(i,o,!1,e,n)}};Yu=tR([st(),lp(0,At(ge)),lp(0,Re(Nu)),eR("design:paramtypes",[Object])],Yu);var iR=function(i,t,e,n){var o,r=arguments.length,s=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var l=i.length-1;l>=0;l--)(o=i[l])&&(s=(r<3?o(s):r>3?o(t,e,s):o(t,e))||s);return r>3&&s&&Object.defineProperty(t,e,s),s},nR=function(i,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,t)},ap=function(i,t){return function(e,n){t(e,n,i)}};let Xu=class{constructor(i){this.groupRenderContribitions=i,this.numberType=Mg}drawShape(i,t,e,n,o,r,s,l){const a=yt(i,r==null?void 0:r.theme).group,{fill:h=a.fill,background:d,stroke:u=a.stroke,opacity:c=a.opacity,width:f=a.width,height:g=a.height,clip:p=a.clip,fillOpacity:v=a.fillOpacity,strokeOpacity:m=a.strokeOpacity,cornerRadius:b=a.cornerRadius,path:C=a.path,lineWidth:_=a.lineWidth,visible:w=a.visible,fillStrokeOrder:y=a.fillStrokeOrder,x=a.x,y:S=a.y}=i.attribute,R=BC(c,v,f,g,h),B=MC(c,m,f,g),A=zr(h,d),M=ol(u,_);if(!i.valid||!w||!p&&(!A&&!M||!(R||B||s||l||d)))return;if(C&&C.length&&o.drawContribution){const P=t.disableFill,H=t.disableStroke,L=t.disableBeginPath;t.disableFill=!0,t.disableStroke=!0,t.disableBeginPath=!0,C.forEach(F=>{o.drawContribution.getRenderContribution(F).draw(F,o.renderService,o,r)}),t.disableFill=P,t.disableStroke=H,t.disableBeginPath=L}else b===0||Q(b)&&b.every(P=>P===0)?(t.beginPath(),t.rect(e,n,f,g)):(t.beginPath(),en(t,e,n,f,g,b));this._groupRenderContribitions||(this._groupRenderContribitions=this.groupRenderContribitions.getContributions()||[],this._groupRenderContribitions.push(fx));const k={doFill:A,doStroke:M};this._groupRenderContribitions.forEach(P=>{P.time===Et.beforeFillStroke&&P.drawShape(i,t,e,n,A,M,R,B,a,o,s,l,k)}),p&&t.clip(),t.setShadowBlendStyle&&t.setShadowBlendStyle(i,i.attribute,a);const E=()=>{k.doFill&&(s?s(t,i.attribute,a):R&&(t.setCommonStyle(i,i.attribute,x-e,S-n,a),t.fill()))},T=()=>{k.doStroke&&(l?l(t,i.attribute,a):B&&(t.setStrokeStyle(i,i.attribute,x-e,S-n,a),t.stroke()))};y?(T(),E()):(E(),T()),this._groupRenderContribitions.forEach(P=>{P.time===Et.afterFillStroke&&P.drawShape(i,t,e,n,A,M,R,B,a,o,s,l)})}draw(i,t,e,n){const{context:o}=e;if(!o)return;const{clip:r,baseOpacity:s=1}=i.attribute;r?o.save():o.highPerformanceSave();const l=o.baseGlobalAlpha;o.baseGlobalAlpha*=s;const a=yt(i,n==null?void 0:n.theme).group,h=o.modelMatrix;if(o.camera){const f=ce.allocate(),g=ce.allocate();HC(g,i,a),rl(f,h||f,g),o.modelMatrix=f,ce.free(g),o.setTransform(1,0,0,1,0,0,!0)}else o.transformFromMatrix(i.transMatrix,!0);o.beginPath(),n.skipDraw?this.drawShape(i,o,0,0,e,n,()=>!1,()=>!1):this.drawShape(i,o,0,0,e);const{scrollX:d=a.scrollX,scrollY:u=a.scrollY}=i.attribute;let c;(d||u)&&o.translate(d,u),n&&n.drawingCb&&(c=n.drawingCb()),o.modelMatrix!==h&&ce.free(o.modelMatrix),o.modelMatrix=h,o.baseGlobalAlpha=l,c&&c.then?c.then(()=>{r?o.restore():o.highPerformanceRestore()}):r?o.restore():o.highPerformanceRestore()}};Xu=iR([st(),ap(0,At(ge)),ap(0,Re(ki)),nR("design:paramtypes",[Object])],Xu);var oR=function(i,t,e,n){var o,r=arguments.length,s=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var l=i.length-1;l>=0;l--)(o=i[l])&&(s=(r<3?o(s):r>3?o(t,e,s):o(t,e))||s);return r>3&&s&&Object.defineProperty(t,e,s),s},rR=function(i,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,t)},hp=function(i,t){return function(e,n){t(e,n,i)}};const sR=["","repeat-x","repeat-y","repeat"];let qu=class extends ei{constructor(i){super(),this.imageRenderContribitions=i,this.numberType=td,this.builtinContributions=[Cx,_x],this.init(i)}drawShape(i,t,e,n,o,r,s,l){const a=yt(i).image,{width:h=a.width,height:d=a.height,repeatX:u=a.repeatX,repeatY:c=a.repeatY,x:f=a.x,y:g=a.y,cornerRadius:p=a.cornerRadius,fillStrokeOrder:v=a.fillStrokeOrder,image:m}=i.attribute,b=this.valid(i,a,s);if(!b)return;const{fVisible:C,sVisible:_,doFill:w,doStroke:y}=b;if(!m||!i.resources)return;const x=i.resources.get(m);if(x.state!=="success")return;let S=!1;p===0||Q(p)&&p.every(A=>A===0)||(t.beginPath(),en(t,e,n,h,d,p),S=!0),t.setShadowBlendStyle&&t.setShadowBlendStyle(i,i.attribute,a);const R=()=>{if(w){if(s)s(t,i.attribute,a);else if(C){t.setCommonStyle(i,i.attribute,e,n,a);let A=0;if(u==="repeat"&&(A|=1),c==="repeat"&&(A|=2),A){const M=t.createPattern(x.data,sR[A]);t.fillStyle=M,t.translate(e,n,!0),t.fillRect(0,0,h,d),t.translate(-e,-n,!0)}else t.drawImage(x.data,e,n,h,d)}}},B=()=>{y&&(l?l(t,i.attribute,a):_&&(t.setStrokeStyle(i,i.attribute,f-e,g-n,a),t.stroke()))};v?(B(),S&&(t.save(),t.clip()),this.beforeRenderStep(i,t,e,n,w,!1,C,!1,a,o,s),R(),S&&t.restore()):(S&&(t.save(),t.clip()),this.beforeRenderStep(i,t,e,n,w,!1,C,!1,a,o,s),R(),S&&t.restore(),B()),this.afterRenderStep(i,t,e,n,w,!1,C,!1,a,o,s)}draw(i,t,e){const{image:n}=i.attribute;if(!n||!i.resources)return;const o=i.resources.get(n);if(o.state==="loading"&&jt(n))return void Wt.improveImageLoading(n);if(o.state!=="success")return;const{context:r}=t.drawParams;if(!r)return;const s=yt(i).image;this._draw(i,s,!1,e)}};qu=oR([st(),hp(0,At(ge)),hp(0,Re(yo)),rR("design:paramtypes",[Object])],qu);const zC=Symbol.for("IncrementalDrawContribution"),xa=Symbol.for("ArcRender"),Ra=Symbol.for("CircleRender"),$e=Symbol.for("GraphicRender"),dp=Symbol.for("GroupRender"),Aa=Symbol.for("LineRender"),Ba=Symbol.for("PathRender"),Ma=Symbol.for("PolygonRender"),Ta=Symbol.for("RectRender"),Pa=Symbol.for("SymbolRender"),Zu=Symbol.for("TextRender"),Ju=Symbol.for("RichTextRender"),up=Symbol.for("ImageRender"),zg=Symbol.for("DrawContribution"),IC=(i,t,e,n)=>{let o,r=!1,s=!1;if(t.forEachChildren(l=>(r=l.numberType===FS,!r)),t.forEachChildren(l=>(s=!!l.findFace,!s)),r){const l=t.getChildren(),a=[...l];a.sort((h,d)=>{var u,c,f,g;let p=((c=(u=h.attribute.startAngle)!==null&&u!==void 0?u:0+h.attribute.endAngle)!==null&&c!==void 0?c:0)/2,v=((g=(f=d.attribute.startAngle)!==null&&f!==void 0?f:0+d.attribute.endAngle)!==null&&g!==void 0?g:0)/2;for(;p<0;)p+=Vt;for(;v<0;)v+=Vt;return v-p}),a.forEach(h=>{h._next=null,h._prev=null}),t.removeAllChild(),t.update(),a.forEach(h=>{t.appendChild(h)}),n.hack_pieFace="outside",o=e(r,s),o&&o.graphic||(n.hack_pieFace="inside",o=e(r,s)),o&&o.graphic||(n.hack_pieFace="top",o=e(r,s)),t.removeAllChild(),l.forEach(h=>{h._next=null,h._prev=null}),l.forEach(h=>{t.appendChild(h)})}else if(s){const l=t.getChildren(),a=l.map(h=>({ave_z:h.findFace().vertices.map(d=>{var u;return i.view(d[0],d[1],(u=d[2]+h.attribute.z)!==null&&u!==void 0?u:0)[2]}).reduce((d,u)=>d+u,0),g:h}));a.sort((h,d)=>d.ave_z-h.ave_z),t.removeAllChild(),a.forEach(h=>{h.g._next=null,h.g._prev=null}),t.update(),a.forEach(h=>{t.add(h.g)}),o=e(r,s),t.removeAllChild(),l.forEach(h=>{h._next=null,h._prev=null}),t.update(),l.forEach(h=>{t.add(h)})}else o=e(r,s);return o};var lR=function(i,t,e,n){var o,r=arguments.length,s=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var l=i.length-1;l>=0;l--)(o=i[l])&&(s=(r<3?o(s):r>3?o(t,e,s):o(t,e))||s);return r>3&&s&&Object.defineProperty(t,e,s),s},aR=function(i,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,t)};const Fs=Symbol.for("DrawItemInterceptor"),cp=new Gt,gp=new Gt;class hR{constructor(){this.order=1}afterDrawItem(t,e,n,o,r){return t.attribute.shadowRootIdx==null&&t.shadowRoot&&t.shadowRoot.attribute.shadowRootIdx<0||(t.attribute.shadowRootIdx>0||!t.attribute.shadowRootIdx||t.shadowRoot&&t.shadowRoot.attribute.shadowRootIdx>0)&&this.drawItem(t,e,n,o,r),!1}beforeDrawItem(t,e,n,o,r){return t.attribute.shadowRootIdx==null&&t.shadowRoot&&t.shadowRoot.attribute.shadowRootIdx>0||(t.attribute.shadowRootIdx<0||t.shadowRoot&&t.shadowRoot.attribute.shadowRootIdx<0)&&this.drawItem(t,e,n,o,r),!1}drawItem(t,e,n,o,r){if(!t.shadowRoot)return!1;const{context:s}=n;if(s.highPerformanceSave(),s.transformFromMatrix(t.transMatrix,!0),o.dirtyBounds&&o.backupDirtyBounds){cp.copy(o.dirtyBounds),gp.copy(o.backupDirtyBounds);const l=t.globalTransMatrix.getInverse();o.dirtyBounds.copy(o.backupDirtyBounds).transformWithMatrix(l),o.backupDirtyBounds.copy(o.dirtyBounds)}return o.renderGroup(t.shadowRoot,n,Ze.allocate(1,0,0,1,0,0)),s.highPerformanceRestore(),o.dirtyBounds&&o.backupDirtyBounds&&(o.dirtyBounds.copy(cp),o.backupDirtyBounds.copy(gp)),!0}}class dR{constructor(){this.order=1}afterDrawItem(t,e,n,o,r){return t.attribute._debug_bounds&&this.drawItem(t,e,n,o,r),!1}drawItem(t,e,n,o,r){if(!t.attribute._debug_bounds)return!1;const{context:s}=n;s.highPerformanceSave(),t.parent&&s.setTransformFromMatrix(t.parent.globalTransMatrix,!0),t.glyphHost&&t.glyphHost.parent&&s.setTransformFromMatrix(t.glyphHost.parent.globalTransMatrix,!0);const l=t.AABBBounds;return t.attribute._debug_bounds!==!0&&t.attribute._debug_bounds(s,t),s.strokeRect(l.x1,l.y1,l.width(),l.height()),s.highPerformanceRestore(),!0}}let Ha=class{constructor(){this.order=1,this.interceptors=[new hR,new cR,new uR,new dR]}afterDrawItem(i,t,e,n,o){for(let r=0;r<this.interceptors.length;r++)if(this.interceptors[r].afterDrawItem&&this.interceptors[r].afterDrawItem(i,t,e,n,o))return!0;return!1}beforeDrawItem(i,t,e,n,o){if((!i.in3dMode||e.in3dInterceptor)&&!i.shadowRoot&&!(i.baseGraphic||i.attribute.globalZIndex||i.interactiveGraphic))return!1;for(let r=0;r<this.interceptors.length;r++)if(this.interceptors[r].beforeDrawItem&&this.interceptors[r].beforeDrawItem(i,t,e,n,o))return!0;return!1}};Ha=lR([st(),aR("design:paramtypes",[])],Ha);class uR{constructor(){this.order=1}beforeDrawItem(t,e,n,o,r){return!this.processing&&(t.baseGraphic?this.beforeDrawInteractive(t,e,n,o,r):this.beforeSetInteractive(t,e,n,o,r))}beforeSetInteractive(t,e,n,o,r){let s=t.interactiveGraphic;if(t.attribute.globalZIndex){s||(s=t.clone(),t.interactiveGraphic=s,s.baseGraphic=t),s.setAttributes({globalZIndex:0,zIndex:t.attribute.globalZIndex},!1,{skipUpdateCallback:!0}),n.stage.tryInitInteractiveLayer();const l=n.stage.getLayer("_builtin_interactive");return l&&this.getShadowRoot(l).add(s),!0}if(s){n.stage.tryInitInteractiveLayer();const l=n.stage.getLayer("_builtin_interactive");l&&this.getShadowRoot(l).removeChild(s),t.interactiveGraphic=null,s.baseGraphic=null}return!1}beforeDrawInteractive(t,e,n,o,r){const s=t.baseGraphic;let l=!!s.stage,a=s.parent;for(;l&&a&&a.stage!==a;)l=!!a.stage,a=a.parent;if(!l){const h=n.stage.getLayer("_builtin_interactive");return h&&this.getShadowRoot(h).removeChild(t),!0}if(s){this.processing=!0;const{context:h}=n;return h.highPerformanceSave(),h.setTransformFromMatrix(s.parent.globalTransMatrix,!0),s.isContainer?o.renderGroup(s,n,s.parent.globalTransMatrix):o.renderItem(s,n),h.highPerformanceRestore(),this.processing=!1,!0}return!1}getShadowRoot(t){var e;let n=t.getElementById("_interactive_group");return n||(n=ft.CreateGraphic("group",{}),n.id="_interactive_group",t.add(n)),(e=n.shadowRoot)!==null&&e!==void 0?e:n.attachShadow()}}class cR{constructor(){this.order=1}beforeDrawItem(t,e,n,o,r){if(!t.in3dMode||n.in3dInterceptor)return!1;n.in3dInterceptor=!0;const{context:s,stage:l}=e.drawParams;s.canvas,s.save(),this.initCanvasCtx(s),s.camera=l.camera;const a=s.currentMatrix;a.a/=s.dpr,a.b/=s.dpr,a.c/=s.dpr,a.d/=s.dpr,a.e/=s.dpr,a.f/=s.dpr;const h=ce.allocate();Gu(h,a);const d=s.modelMatrix;if(d){if(h){const u=ce.allocate();s.modelMatrix=rl(u,d,h)}}else s.modelMatrix=h;return s.setTransform(1,0,0,1,0,0,!0),t.isContainer?IC(s,t,(u,c)=>o.renderGroup(t,n,t.parent.globalTransMatrix,!u&&c),n):o.renderItem(t,n),s.camera=null,s.restore(),s.modelMatrix!==d&&ce.free(s.modelMatrix),s.modelMatrix=d,n.in3dInterceptor=!1,!0}initCanvasCtx(t){t.setTransformForCurrent()}}var gR=function(i,t,e,n){var o,r=arguments.length,s=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var l=i.length-1;l>=0;l--)(o=i[l])&&(s=(r<3?o(s):r>3?o(t,e,s):o(t,e))||s);return r>3&&s&&Object.defineProperty(t,e,s),s},fR=function(i,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,t)},pR=function(i,t){return function(e,n){t(e,n,i)}};const OC=Symbol.for("RenderService");let Qu=class{constructor(i){this.drawContribution=i}prepare(i){i&&this.renderTreeRoots.forEach(t=>{this._prepare(t,i)})}_prepare(i,t){i.forEachChildren(e=>{this._prepare(e,t)}),i.update({bounds:t,trans:!0})}prepareRenderList(){}beforeDraw(i){}draw(i){this.drawContribution.draw(this,Object.assign({},this.drawParams))}afterDraw(i){this.drawContribution.afterDraw&&this.drawContribution.afterDraw(this,Object.assign({},this.drawParams))}render(i,t){this.renderTreeRoots=i,this.drawParams=t;const e=t.updateBounds;this.prepare(e),this.prepareRenderList(),this.beforeDraw(t),this.draw(t),this.afterDraw(t),this.drawParams=null}};Qu=gR([st(),pR(0,At(zg)),fR("design:paramtypes",[Object])],Qu);const vR=new Ct(i=>{i(OC).to(Qu)}),cr=Symbol.for("PickerService"),fp=Symbol.for("GlobalPickerService"),sl=(i,t,e)=>{const{outerBorder:n,shadowBlur:o=t.shadowBlur}=i;if(n){const r=t.outerBorder,{distance:s=r.distance,lineWidth:l=r.lineWidth}=n;e.expand(s+(o+l)/2)}return e},pp=["radius","startAngle","endAngle",...Ti];class Ar extends ti{constructor(t={radius:1}){super(t),this.type="circle",this.numberType=Qh}isValid(){return super.isValid()&&this._isValid()}_isValid(){const{startAngle:t,endAngle:e,radius:n}=this.attribute;return this._validNumber(t)&&this._validNumber(e)&&this._validNumber(n)}getGraphicTheme(){return yt(this).circle}updateAABBBounds(t,e,n,o){this.updatePathProxyAABBBounds(n)||(o?this.updateCircleAABBBoundsImprecise(t,e,n):this.updateCircleAABBBoundsAccurate(t,e,n));const{tb1:r,tb2:s}=G.graphicService.updateTempAABBBounds(n);return sl(t,e,r),n.union(r),r.setValue(s.x1,s.y1,s.x2,s.y2),G.graphicService.transformAABBBounds(t,n,e,!1,this),n}updateCircleAABBBoundsImprecise(t,e,n){const{radius:o=e.radius}=t;return n.set(-o,-o,o,o),n}updateCircleAABBBoundsAccurate(t,e,n){const{startAngle:o=e.startAngle,endAngle:r=e.endAngle,radius:s=e.radius}=t;return r-o>Vt-Kt?n.set(-s,-s,s,s):Fu(o,r,s,n),n}needUpdateTags(t){return super.needUpdateTags(t,pp)}needUpdateTag(t){return super.needUpdateTag(t,pp)}toCustomPath(){var t,e,n;const o=this.attribute,r=(t=o.radius)!==null&&t!==void 0?t:this.getDefaultAttribute("radius"),s=(e=o.startAngle)!==null&&e!==void 0?e:this.getDefaultAttribute("startAngle"),l=(n=o.endAngle)!==null&&n!==void 0?n:this.getDefaultAttribute("endAngle"),a=new Ae;return a.arc(0,0,r,s,l),a}clone(){return new Ar(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return Ar.NOWORK_ANIMATE_ATTR}}Ar.NOWORK_ANIMATE_ATTR=Vi;function DC(i){return new Ar(i)}class tc{constructor(t,e,n){this.fontFamily=t,this.textOptions=e,this.textMeasure=n}LayoutBBox(t,e,n,o){if(t.xOffset=e==="left"||e==="start"?0:e==="center"?t.width/-2:e==="right"||e==="end"?-t.width:0,n==="top")t.yOffset=0;else if(n==="middle")t.yOffset=t.height/-2;else if(n==="alphabetic"){let r=.79;if(o.length===1){const s=o[0];r=s.ascent/(s.ascent+s.descent)}t.yOffset=t.height*-r}else t.yOffset=-t.height;return t}GetLayoutByLines(t,e,n,o,r="",s,l){const{lineWidth:a,suffixPosition:h="end",measureMode:d=xo.actualBounding,keepCenterInLine:u=!1}=l??{};t=t.map(p=>p.toString());const c=[],f=[0,0];if(typeof a=="number"&&a!==1/0){let p;for(let v=0,m=t.length;v<m;v++){const b=this.textMeasure.measureTextPixelADscentAndWidth(t[v],this.textOptions,d);let C=t[v].toString();if(b.width>a){const _=this.textMeasure.clipTextWithSuffix(t[v],this.textOptions,a,r,s,h);C=_.str,p=_.width}else p=b.width;c.push({str:C,width:p,ascent:b.ascent,descent:b.descent,keepCenterInLine:u})}f[0]=a}else{let p,v,m=0;for(let b=0,C=t.length;b<C;b++){v=t[b];const _=this.textMeasure.measureTextPixelADscentAndWidth(t[b],this.textOptions,d);p=_.width,m=Math.max(m,p),c.push({str:v,width:p,ascent:_.ascent,descent:_.descent,keepCenterInLine:u})}f[0]=m}f[1]=c.length*o,f[0]=c.reduce((p,v)=>Math.max(p,v.width),0);const g={xOffset:0,yOffset:0,width:f[0],height:f[1]};return this.LayoutBBox(g,e,n,c),this.layoutWithBBox(g,c,e,n,o)}layoutWithBBox(t,e,n,o,r){const s=[0,0],l=e.length*r;o==="top"||(o==="middle"?s[1]=(t.height-l)/2:o==="bottom"&&(s[1]=t.height-l));for(let a=0;a<e.length;a++)this.lineOffset(t,e[a],n,o,r,s);return{bbox:t,lines:e,fontFamily:this.fontFamily,fontSize:this.textOptions.fontSize,fontWeight:this.textOptions.fontWeight,lineHeight:r,textAlign:n,textBaseline:o}}lineOffset(t,e,n,o,r,s){if(n==="left"||n==="start"?e.leftOffset=0:n==="center"?e.leftOffset=(t.width-e.width)/2:n!=="right"&&n!=="end"||(e.leftOffset=t.width-e.width),e.topOffset=r/2+(e.ascent-e.descent)/2+s[1],!e.keepCenterInLine){const a=e.ascent+e.descent+0;if(a<r-0&&(o==="bottom"?e.topOffset+=(r-a)/2:o==="top"&&(e.topOffset-=(r-a)/2)),o==="alphabetic"){const h=r/(e.ascent+e.descent);e.topOffset=r/2+(e.ascent-e.descent)/2*h+s[1]}}return s[1]+=r,e}}const vp=["text","maxLineWidth","maxWidth","textAlign","textBaseline","heightLimit","lineClamp","fontSize","fontFamily","fontWeight","ellipsis","lineHeight","direction","wordBreak","heightLimit","lineClamp",...Ti];let xe=class Dn extends ti{get font(){const t=this.getGraphicTheme();return this._font||(this._font=yu(this.attribute,t)),this._font}get clipedText(){var t;const e=this.attribute,n=this.getGraphicTheme(),o=this.getMaxWidth(n);return Number.isFinite(o)?(this.tryUpdateAABBBounds(),this.cache.clipedText):((t=e.text)!==null&&t!==void 0?t:n.text).toString()}get clipedWidth(){return this.tryUpdateAABBBounds(),this.cache.clipedWidth}get cliped(){var t,e;const n=this.getGraphicTheme(),o=this.attribute,r=this.getMaxWidth(n);if(!Number.isFinite(r))return!1;const{text:s}=this.attribute;if(this.tryUpdateAABBBounds(),(e=(t=this.cache)===null||t===void 0?void 0:t.layoutData)===null||e===void 0?void 0:e.lines){let l="";return this.cache.layoutData.lines.forEach(a=>{l+=a.str}),(Array.isArray(s)?s.join(""):s)!==l}return o.direction==="vertical"&&this.cache.verticalList&&this.cache.verticalList[0]?this.cache.verticalList[0].map(l=>l.text).join("")!==o.text.toString():this.clipedText!=null&&this.clipedText!==o.text.toString()}get multilineLayout(){return this.tryUpdateAABBBounds(),this.cache.layoutData}get isMultiLine(){return Array.isArray(this.attribute.text)||this.attribute.whiteSpace==="normal"}constructor(t={text:"",fontSize:16}){super(t),this.type="text",this.numberType=od,this.cache={}}isValid(){return super.isValid()&&this._isValid()}_isValid(){const{text:t}=this.attribute;return Q(t)?!t.every(e=>e==null||e===""):t!=null&&t!==""}getGraphicTheme(){return yt(this).text}doUpdateOBBBounds(){const t=this.getGraphicTheme();this._OBBBounds.clear();const e=this.attribute,{angle:n=t.angle}=e;if(!n){const h=this.AABBBounds;return this._OBBBounds.setValue(h.x1,h.y1,h.x2,h.y2),this._OBBBounds}this.obbText||(this.obbText=new Dn({})),this.obbText.setAttributes(Object.assign(Object.assign({},e),{angle:0}));const o=this.obbText.AABBBounds,{x:r,y:s}=e,l={x:(o.x1+o.x2)/2,y:(o.y1+o.y2)/2},a=Lb(l,n,{x:r,y:s});return this._OBBBounds.copy(o),this._OBBBounds.translate(a.x-l.x,a.y-l.y),this._OBBBounds.angle=n,this._OBBBounds}updateAABBBounds(t,e,n){const{text:o=e.text}=this.attribute;Array.isArray(o)?this.updateMultilineAABBBounds(o):this.updateSingallineAABBBounds(o);const{tb1:r}=G.graphicService.updateTempAABBBounds(n),{scaleX:s=e.scaleX,scaleY:l=e.scaleY,shadowBlur:a=e.shadowBlur,strokeBoundsBuffer:h=e.strokeBoundsBuffer}=t;if(a){const d=a/Math.abs(s+l);fa(r,d,!0,h),n.union(r)}return G.graphicService.combindShadowAABBBounds(n,this),t.forceBoundsHeight==null&&t.forceBoundsWidth==null||G.graphicService.updateHTMLTextAABBBounds(t,e,n),Eb(n,n,this.transMatrix),n}updateSingallineAABBBounds(t){this.updateMultilineAABBBounds([t]);const e=this.cache.layoutData;if(e&&e.lines&&e.lines.length){const n=e.lines[0];this.cache.clipedText=n.str,this.cache.clipedWidth=n.width}return this._AABBBounds}updateMultilineAABBBounds(t){const e=this.getGraphicTheme(),{direction:n=e.direction,underlineOffset:o=e.underlineOffset}=this.attribute,r=n==="horizontal"?this.updateHorizontalMultilineAABBBounds(t):this.updateVerticalMultilineAABBBounds(t);return n==="horizontal"&&o&&this._AABBBounds.add(this._AABBBounds.x1,this._AABBBounds.y2+o),r}guessLineHeightBuf(t){return t?.1*t:0}updateHorizontalMultilineAABBBounds(t){var e;const n=this.getGraphicTheme(),o=this.attribute,{fontFamily:r=n.fontFamily,textAlign:s=n.textAlign,textBaseline:l=n.textBaseline,fontSize:a=n.fontSize,fontWeight:h=n.fontWeight,ellipsis:d=n.ellipsis,maxLineWidth:u,stroke:c=n.stroke,wrap:f=n.wrap,measureMode:g=n.measureMode,lineWidth:p=n.lineWidth,whiteSpace:v=n.whiteSpace,suffixPosition:m=n.suffixPosition,ignoreBuf:b=n.ignoreBuf,keepCenterInLine:C=n.keepCenterInLine}=o,_=b?0:this.guessLineHeightBuf(a),w=this.getLineHeight(o,n,_);if(v==="normal"||f)return this.updateWrapAABBBounds(t);if(!this.shouldUpdateShape()&&(!((e=this.cache)===null||e===void 0)&&e.layoutData)){const R=this.cache.layoutData.bbox;return this._AABBBounds.set(R.xOffset,R.yOffset,R.xOffset+R.width,R.yOffset+R.height),c&&this._AABBBounds.expand(p/2),this._AABBBounds}const y=G.graphicUtil.textMeasure,x=new tc(r,{fontSize:a,fontWeight:h,fontFamily:r,lineHeight:w},y).GetLayoutByLines(t,s,l,w,d===!0?n.ellipsis:d||void 0,!1,{lineWidth:u,suffixPosition:m,measureMode:g,keepCenterInLine:C}),{bbox:S}=x;return this.cache.layoutData=x,this.clearUpdateShapeTag(),this._AABBBounds.set(S.xOffset,S.yOffset,S.xOffset+S.width,S.yOffset+S.height),c&&this._AABBBounds.expand(p/2),this._AABBBounds}updateWrapAABBBounds(t){var e,n,o;const r=this.getGraphicTheme(),{fontFamily:s=r.fontFamily,textAlign:l=r.textAlign,textBaseline:a=r.textBaseline,fontSize:h=r.fontSize,ellipsis:d=r.ellipsis,maxLineWidth:u,stroke:c=r.stroke,lineWidth:f=r.lineWidth,wordBreak:g=r.wordBreak,fontWeight:p=r.fontWeight,ignoreBuf:v=r.ignoreBuf,measureMode:m=r.measureMode,suffixPosition:b=r.suffixPosition,heightLimit:C=0,lineClamp:_,keepCenterInLine:w=r.keepCenterInLine}=this.attribute,y=v?0:this.guessLineHeightBuf(h),x=this.getLineHeight(this.attribute,r,y);if(!this.shouldUpdateShape()&&(!((e=this.cache)===null||e===void 0)&&e.layoutData)){const H=this.cache.layoutData.bbox;return this._AABBBounds.set(H.xOffset,H.yOffset,H.xOffset+H.width,H.yOffset+H.height),c&&this._AABBBounds.expand(f/2),this._AABBBounds}const S=G.graphicUtil.textMeasure,R={fontSize:h,fontWeight:p,fontFamily:s,lineHeight:x},B=new tc(s,R,S),A=Q(t)?t.map(H=>H.toString()):[t.toString()],M=[],k=[0,0];let E=1/0;if(C>0&&(E=Math.max(Math.floor(C/x),1)),_&&(E=Math.min(E,_)),typeof u=="number"&&u!==1/0){if(u>0)for(let L=0;L<A.length;L++){const F=A[L];let z=!0;if(L===E-1){const D=S.clipTextWithSuffix(F,R,u,d,!1,b,L!==A.length-1),j=S.measureTextPixelADscentAndWidth(D.str,R,m);M.push({str:D.str,width:D.width,ascent:j.ascent,descent:j.descent,keepCenterInLine:w});break}const I=S.clipText(F,R,u,g!=="break-all",g==="keep-all");if(F!==""&&I.str===""||I.wordBreaked){if(d){const D=S.clipTextWithSuffix(F,R,u,d,!1,b);I.str=(n=D.str)!==null&&n!==void 0?n:"",I.width=(o=D.width)!==null&&o!==void 0?o:0}else I.str="",I.width=0;z=!1}const N=S.measureTextPixelADscentAndWidth(I.str,R,m);M.push({str:I.str,width:I.width,ascent:N.ascent,descent:N.descent,keepCenterInLine:w});let W=I.str.length;if(!I.wordBreaked||F!==""&&I.str===""||(z=!0,W=I.wordBreaked),I.str.length!==F.length){if(z){let D=F.substring(W);g==="keep-all"&&(D=D.replace(/^\s+/g,"")),A.splice(L+1,0,D)}}}let H=0;M.forEach(L=>{H=Math.max(H,L.width)}),k[0]=H}else{let H,L,F=0;for(let z=0,I=A.length;z<I;z++){if(z===E-1){const W=S.clipTextWithSuffix(A[z],R,u,d,!1,b),D=S.measureTextPixelADscentAndWidth(W.str,R,m);M.push({str:W.str,width:W.width,ascent:D.ascent,descent:D.descent,keepCenterInLine:w}),F=Math.max(F,W.width);break}L=A[z],H=S.measureTextWidth(L,R),F=Math.max(F,H);const N=S.measureTextPixelADscentAndWidth(L,R,m);M.push({str:L,width:H,ascent:N.ascent,descent:N.descent,keepCenterInLine:w})}k[0]=F}k[1]=M.length*x;const T={xOffset:0,yOffset:0,width:k[0],height:k[1]};B.LayoutBBox(T,l,a,M);const P=B.layoutWithBBox(T,M,l,a,x);return this.cache.layoutData=P,this.clearUpdateShapeTag(),this._AABBBounds.set(T.xOffset,T.yOffset,T.xOffset+T.width,T.yOffset+T.height),c&&this._AABBBounds.expand(f/2),this._AABBBounds}updateVerticalMultilineAABBBounds(t){var e,n;const o=this.getGraphicTheme(),r=G.graphicUtil.textMeasure;let s;const l=this.attribute,{maxLineWidth:a=o.maxLineWidth,ellipsis:h=o.ellipsis,fontFamily:d=o.fontFamily,fontSize:u=o.fontSize,fontWeight:c=o.fontWeight,stroke:f=o.stroke,lineWidth:g=o.lineWidth,verticalMode:p=o.verticalMode,suffixPosition:v=o.suffixPosition}=l,m=this.getLineHeight(l,o,0);let{textAlign:b=o.textAlign,textBaseline:C=o.textBaseline}=l;if(!p){const S=b;b=(e=Dn.baselineMapAlign[C])!==null&&e!==void 0?e:"left",C=(n=Dn.alignMapBaseline[S])!==null&&n!==void 0?n:"top"}if(s=0,!this.shouldUpdateShape()&&this.cache){this.cache.verticalList.forEach(A=>{const M=A.reduce((k,E)=>k+E.width,0);s=Jn(M,s)});const S=Sr(b,s),R=this.cache.verticalList.length*m,B=Es(C,R,u);return this._AABBBounds.set(B,S,B+R,S+s),f&&this._AABBBounds.expand(g/2),this._AABBBounds}const _=t.map(S=>HS(S.toString()));_.forEach((S,R)=>{if(Number.isFinite(a))if(h){const B=h===!0?o.ellipsis:h,A=r.clipTextWithSuffixVertical(S,{fontSize:u,fontWeight:c,fontFamily:d},a,B,!1,v);_[R]=A.verticalList,s=A.width}else{const B=r.clipTextVertical(S,{fontSize:u,fontWeight:c,fontFamily:d},a,!1);_[R]=B.verticalList,s=B.width}else s=0,S.forEach(B=>{const A=B.direction===ur.HORIZONTAL?u:r.measureTextWidth(B.text,{fontSize:u,fontWeight:c,fontFamily:d});s+=A,B.width=A})}),this.cache.verticalList=_,this.clearUpdateShapeTag(),this.cache.verticalList.forEach(S=>{const R=S.reduce((B,A)=>B+A.width,0);s=Jn(R,s)});const w=Sr(b,s),y=this.cache.verticalList.length*m,x=Es(C,y,u);return this._AABBBounds.set(x,w,x+y,w+s),f&&this._AABBBounds.expand(g/2),this._AABBBounds}getMaxWidth(t){var e,n;const o=this.attribute;return(n=(e=o.maxLineWidth)!==null&&e!==void 0?e:o.maxWidth)!==null&&n!==void 0?n:t.maxWidth}getLineHeight(t,e,n){var o;return(o=il(t.lineHeight,t.fontSize||e.fontSize))!==null&&o!==void 0?o:(t.fontSize||e.fontSize)+n}needUpdateTags(t,e=vp){return super.needUpdateTags(t,e)}needUpdateTag(t,e=vp){return super.needUpdateTag(t,e)}clone(){return new Dn(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return Dn.NOWORK_ANIMATE_ATTR}getBaselineMapAlign(){return Dn.baselineMapAlign}getAlignMapBaseline(){return Dn.alignMapBaseline}};xe.NOWORK_ANIMATE_ATTR=Object.assign({ellipsis:1,wordBreak:1,direction:1,textAlign:1,textBaseline:1,fontFamily:1,fontWeight:1},Vi),xe.baselineMapAlign={top:"left",bottom:"right",middle:"center"},xe.alignMapBaseline={left:"top",right:"bottom",center:"middle"};function ec(i){return new xe(i)}const Pl=["heightLimit","lineClamp"];class Ig extends xe{constructor(t){super(Object.assign(Object.assign({},t),{wrap:!0}))}_isValid(){const{text:t}=this.attribute;return Q(t)?!t.every(e=>e==null||e===""):t!=null&&t!==""}updateMultilineAABBBounds(t){var e,n,o,r;const s=this.getGraphicTheme(),{fontFamily:l=s.fontFamily,textAlign:a=s.textAlign,textBaseline:h=s.textBaseline,fontSize:d=s.fontSize,ellipsis:u=s.ellipsis,maxLineWidth:c,stroke:f=s.stroke,lineWidth:g=s.lineWidth,wordBreak:p=s.wordBreak,fontWeight:v=s.fontWeight,ignoreBuf:m=s.ignoreBuf,heightLimit:b=0,suffixPosition:C=s.suffixPosition,lineClamp:_}=this.attribute,w=(e=il(this.attribute.lineHeight,this.attribute.fontSize||s.fontSize))!==null&&e!==void 0?e:this.attribute.fontSize||s.fontSize,y=m?0:2;if(!this.shouldUpdateShape()&&(!((n=this.cache)===null||n===void 0)&&n.layoutData)){const T=this.cache.layoutData.bbox;return this._AABBBounds.set(T.xOffset,T.yOffset,T.xOffset+T.width,T.yOffset+T.height),f&&this._AABBBounds.expand(g/2),this._AABBBounds}const x=G.graphicUtil.textMeasure,S=new tc(l,{fontSize:d,fontWeight:v,fontFamily:l},x),R=t.map(T=>T.toString()),B=[],A=[0,0];let M=1/0;if(b>0&&(M=Math.max(Math.floor(b/w),1)),_&&(M=Math.min(M,_)),typeof c=="number"&&c!==1/0){if(c>0)for(let P=0;P<R.length;P++){const H=R[P];let L=!0;if(P===M-1){const z=S.textMeasure.clipTextWithSuffix(H,S.textOptions,c,u,!1,C);B.push({str:z.str,width:z.width,ascent:0,descent:0,keepCenterInLine:!1});break}const F=S.textMeasure.clipText(H,S.textOptions,c,p==="break-word");if(H!==""&&F.str===""){if(u){const z=S.textMeasure.clipTextWithSuffix(H,S.textOptions,c,u,!1,C);F.str=(o=z.str)!==null&&o!==void 0?o:"",F.width=(r=z.width)!==null&&r!==void 0?r:0}else F.str="",F.width=0;L=!1}if(B.push({str:F.str,width:F.width,ascent:0,descent:0,keepCenterInLine:!1}),F.str.length!==H.length){if(L){const z=H.substring(F.str.length);R.splice(P+1,0,z)}}}let T=0;B.forEach(P=>{T=Math.max(T,P.width)}),A[0]=T}else{let T,P,H=0;for(let L=0,F=R.length;L<F;L++){if(L===M-1){const z=S.textMeasure.clipTextWithSuffix(R[L],S.textOptions,c,u,!1,C);B.push({str:z.str,width:z.width,ascent:0,descent:0,keepCenterInLine:!1}),H=Math.max(H,z.width);break}P=R[L],T=S.textMeasure.measureTextWidth(P,S.textOptions,p==="break-word"),H=Math.max(H,T),B.push({str:P,width:T,ascent:0,descent:0,keepCenterInLine:!1})}A[0]=H}A[1]=B.length*(w+y);const k={xOffset:0,yOffset:0,width:A[0],height:A[1]};S.LayoutBBox(k,a,h);const E=S.layoutWithBBox(k,B,a,h,w);return this.cache.layoutData=E,this.clearUpdateShapeTag(),this._AABBBounds.set(k.xOffset,k.yOffset,k.xOffset+k.width,k.yOffset+k.height),f&&this._AABBBounds.expand(g/2),this._AABBBounds}needUpdateTags(t){for(let e=0;e<Pl.length;e++){const n=Pl[e];if(t.indexOf(n)!==-1)return!0}return super.needUpdateTags(t)}needUpdateTag(t){for(let e=0;e<Pl.length;e++)if(t===Pl[e])return!0;return super.needUpdateTag(t)}getNoWorkAnimateAttr(){return Ig.NOWORK_ANIMATE_ATTR}}function mR(i){return new Ig(i)}class he{bounds(t,e){if(Z(t)){const n=t/2;e.x1=-n,e.x2=n,e.y1=-n,e.y2=n}else e.x1=-t[0]/2,e.x2=t[0]/2,e.y1=-t[1]/2,e.y2=t[1]/2}parseSize(t){return Z(t)?t:Math.min(t[0],t[1])}}function mp(i,t,e,n,o){return o?i.arc(e,n,t,0,ai,!1,o):i.arc(e,n,t,0,ai),!1}class bR extends he{constructor(){super(...arguments),this.type="circle",this.pathStr="M0.5,0A0.5,0.5,0,1,1,-0.5,0A0.5,0.5,0,1,1,0.5,0"}draw(t,e,n,o,r){return mp(t,this.parseSize(e)/2,n,o,r)}drawOffset(t,e,n,o,r,s){return mp(t,this.parseSize(e)/2+r,n,o,s)}drawToSvgPath(t,e,n,o){const r=this.parseSize(t)/2;return`M ${e-r}, ${n} a ${r},${r} 0 1,0 ${2*r},0 a ${r},${r} 0 1,0 -${2*r},0`}}const CR=new bR;function _R(i,t,e,n,o){return i.moveTo(-3*t+e,-t+n,o),i.lineTo(-t+e,-t+n,o),i.lineTo(-t+e,-3*t+n,o),i.lineTo(t+e,-3*t+n,o),i.lineTo(t+e,-t+n,o),i.lineTo(3*t+e,-t+n,o),i.lineTo(3*t+e,t+n,o),i.lineTo(t+e,t+n,o),i.lineTo(t+e,3*t+n,o),i.lineTo(-t+e,3*t+n,o),i.lineTo(-t+e,t+n,o),i.lineTo(-3*t+e,t+n,o),i.closePath(),!0}function wR(i,t,e,n,o,r){return i.moveTo(-3*t+e-o,-t+n-o,r),i.lineTo(-t+e-o,-t+n-o,r),i.lineTo(-t+e-o,-3*t+n-o,r),i.lineTo(t+e+o,-3*t+n-o,r),i.lineTo(t+e+o,-t+n-o,r),i.lineTo(3*t+e+o,-t+n-o,r),i.lineTo(3*t+e+o,t+n+o,r),i.lineTo(t+e+o,t+n+o,r),i.lineTo(t+e+o,3*t+n+o,r),i.lineTo(-t+e-o,3*t+n+o,r),i.lineTo(-t+e-o,t+n+o,r),i.lineTo(-3*t+e-o,t+n+o,r),i.closePath(),!0}class yR extends he{constructor(){super(...arguments),this.type="cross",this.pathStr="M-0.5,-0.2L-0.5,0.2L-0.2,0.2L-0.2,0.5L0.2,0.5L0.2,0.2L0.5,0.2L0.5,-0.2L0.2,-0.2L0.2,-0.5L-0.2,-0.5L-0.2,-0.2Z"}draw(t,e,n,o,r){return _R(t,this.parseSize(e)/6,n,o,r)}drawOffset(t,e,n,o,r,s){return wR(t,this.parseSize(e)/6,n,o,r,s)}}const SR=new yR;function Nd(i,t,e,n,o){return i.moveTo(e,n-t,o),i.lineTo(t+e,n,o),i.lineTo(e,n+t,o),i.lineTo(e-t,n,o),i.closePath(),!0}class xR extends he{constructor(){super(...arguments),this.type="diamond",this.pathStr="M-0.5,0L0,-0.5L0.5,0L0,0.5Z"}draw(t,e,n,o,r){return Nd(t,this.parseSize(e)/2,n,o,r)}drawFitDir(t,e,n,o,r){return Nd(t,this.parseSize(e)/2,n,o,r)}drawOffset(t,e,n,o,r,s){return Nd(t,this.parseSize(e)/2+r,n,o,s)}}const RR=new xR;function bp(i,t,e,n){const o=2*t;return i.rect(e-t,n-t,o,o),!1}class AR extends he{constructor(){super(...arguments),this.type="square",this.pathStr="M-0.5,-0.5h1v1h-1Z"}draw(t,e,n,o){return bp(t,this.parseSize(e)/2,n,o)}drawOffset(t,e,n,o,r){return bp(t,this.parseSize(e)/2+r,n,o)}}const BR=new AR;function Cp(i,t,e,n,o=0){return i.moveTo(e+t+2*o,t+n+o),i.lineTo(e-t-2*o,t+n+o),i.lineTo(e,n-t-2*o),i.closePath(),!0}class WC extends he{constructor(){super(...arguments),this.type="triangleUp",this.pathStr="M0.5,0.5 L-0.5,0.5 L0,-0.5 Z"}draw(t,e,n,o){return Cp(t,this.parseSize(e)/2,n,o)}drawOffset(t,e,n,o,r){return Cp(t,this.parseSize(e)/2,n,o,r)}}const MR=new WC;class TR extends WC{constructor(){super(...arguments),this.type="triangle"}}const PR=new TR,NC=Math.sin(Math.PI/10)/Math.sin(7*Math.PI/10),HR=Math.sin(ai/10)*NC,kR=-Math.cos(ai/10)*NC;function _p(i,t,e,n){const o=HR*t,r=kR*t;i.moveTo(e,-t+n),i.lineTo(o+e,r+n);for(let s=1;s<5;++s){const l=ai*s/5,a=Math.cos(l),h=Math.sin(l);i.lineTo(h*t+e,-a*t+n),i.lineTo(a*o-h*r+e,h*o+a*r+n)}return i.closePath(),!0}class ER extends he{constructor(){super(...arguments),this.type="star",this.pathStr="M0 -1L0.22451398828979266 -0.3090169943749474L0.9510565162951535 -0.30901699437494745L0.3632712640026804 0.1180339887498948L0.5877852522924732 0.8090169943749473L8.326672684688674e-17 0.3819660112501051L-0.587785252292473 0.8090169943749476L-0.3632712640026804 0.11803398874989487L-0.9510565162951536 -0.30901699437494723L-0.22451398828979274 -0.30901699437494734Z"}draw(t,e,n,o){return _p(t,this.parseSize(e)/2,n,o)}drawOffset(t,e,n,o,r){return _p(t,this.parseSize(e)/2+r,n,o)}}const LR=new ER,FR=Xn(3);function wp(i,t,e,n){const o=t,r=o/FR,s=r/5,l=t;return i.moveTo(0+e,-o+n),i.lineTo(r/2+e,n),i.lineTo(s/2+e,n),i.lineTo(s/2+e,l+n),i.lineTo(-s/2+e,l+n),i.lineTo(-s/2+e,n),i.lineTo(-r/2+e,n),i.closePath(),!0}class zR extends he{constructor(){super(...arguments),this.type="arrow",this.pathStr="M-0.07142857142857142,0.5L0.07142857142857142,0.5L0.07142857142857142,-0.0625L0.2,-0.0625L0,-0.5L-0.2,-0.0625L-0.07142857142857142,-0.0625Z"}draw(t,e,n,o){return wp(t,this.parseSize(e)/2,n,o)}drawOffset(t,e,n,o,r){return wp(t,this.parseSize(e)/2+r,n,o)}}const IR=new zR;function yp(i,t,e,n){const o=2*t;return i.moveTo(e,-t+n),i.lineTo(o/3/2+e,t+n),i.lineTo(-o/3/2+e,t+n),i.closePath(),!0}class OR extends he{constructor(){super(...arguments),this.type="wedge",this.pathStr="M0,-0.5773502691896257L-0.125,0.28867513459481287L0.125,0.28867513459481287Z"}draw(t,e,n,o){return yp(t,this.parseSize(e)/2,n,o)}drawOffset(t,e,n,o,r){return yp(t,this.parseSize(e)/2+r,n,o)}}const DR=new OR;function Sp(i,t,e,n){return i.moveTo(-t+e,n),i.lineTo(e,t+n),!1}class WR extends he{constructor(){super(...arguments),this.type="stroke",this.pathStr=""}draw(t,e,n,o){return Sp(t,this.parseSize(e)/2,n,o)}drawOffset(t,e,n,o,r){return Sp(t,this.parseSize(e)/2+r,n,o)}}const NR=new WR,vi=-.5,mi=Xn(3)/2,xp=1/Xn(12);function Rp(i,t,e,n){const o=t/2,r=t*xp,s=o,l=t*xp+t,a=-s,h=l;return i.moveTo(o+e,r+n),i.lineTo(s+e,l+n),i.lineTo(a+e,h+n),i.lineTo(vi*o-mi*r+e,mi*o+vi*r+n),i.lineTo(vi*s-mi*l+e,mi*s+vi*l+n),i.lineTo(vi*a-mi*h+e,mi*a+vi*h+n),i.lineTo(vi*o+mi*r+e,vi*r-mi*o+n),i.lineTo(vi*s+mi*l+e,vi*l-mi*s+n),i.lineTo(vi*a+mi*h+e,vi*h-mi*a+n),i.closePath(),!1}class VR extends he{constructor(){super(...arguments),this.type="wye",this.pathStr="M0.25 0.14433756729740646L0.25 0.6443375672974064L-0.25 0.6443375672974064L-0.25 0.14433756729740643L-0.6830127018922193 -0.10566243270259357L-0.4330127018922193 -0.5386751345948129L0 -0.28867513459481287L0.4330127018922193 -0.5386751345948129L0.6830127018922193 -0.10566243270259357Z"}draw(t,e,n,o){return Rp(t,this.parseSize(e)/2,n,o)}drawOffset(t,e,n,o,r){return Rp(t,this.parseSize(e)/2+r,n,o)}}const GR=new VR;function Ap(i,t,e,n,o){return i.moveTo(-t+e-2*o,n),i.lineTo(t+e+o,t+n+2*o),i.lineTo(t+e+o,n-t-2*o),i.closePath(),!0}class jR extends he{constructor(){super(...arguments),this.type="triangleLeft",this.pathStr="M-0.5,0 L0.5,0.5 L0.5,-0.5 Z"}draw(t,e,n,o){return Ap(t,this.parseSize(e)/2,n,o,0)}drawOffset(t,e,n,o,r){return Ap(t,this.parseSize(e)/2,n,o,r)}}const UR=new jR;function Bp(i,t,e,n,o=0){return i.moveTo(e-t-o,t+n+2*o),i.lineTo(t+e+2*o,n),i.lineTo(e-t-o,n-t-2*o),i.closePath(),!0}class $R extends he{constructor(){super(...arguments),this.type="triangleRight",this.pathStr="M-0.5,0.5 L0.5,0 L-0.5,-0.5 Z"}draw(t,e,n,o){return Bp(t,this.parseSize(e)/2,n,o)}drawOffset(t,e,n,o,r){return Bp(t,this.parseSize(e)/2,n,o,r)}}const KR=new $R;function Mp(i,t,e,n,o=0){return i.moveTo(e-t-2*o,n-t-o),i.lineTo(e+t+2*o,n-t-o),i.lineTo(e,n+t+2*o),i.closePath(),!0}class YR extends he{constructor(){super(...arguments),this.type="triangleDown",this.pathStr="M-0.5,-0.5 L0.5,-0.5 L0,0.5 Z"}draw(t,e,n,o){return Mp(t,this.parseSize(e)/2,n,o)}drawOffset(t,e,n,o,r){return Mp(t,this.parseSize(e)/2,n,o,r)}}const XR=new YR,ic=Xn(3);function Tp(i,t,e,n){const o=t*ic;return i.moveTo(e,n+-o/3*2),i.lineTo(t+e,n+o),i.lineTo(e-t,n+o),i.closePath(),!0}class qR extends he{constructor(){super(...arguments),this.type="thinTriangle",this.pathStr="M0,-0.5773502691896257L-0.5,0.28867513459481287L0.5,0.28867513459481287Z"}draw(t,e,n,o){return Tp(t,this.parseSize(e)/2/ic,n,o)}drawOffset(t,e,n,o,r){return Tp(t,this.parseSize(e)/2/ic+r,n,o)}}const ZR=new qR;function Pp(i,t,e,n){const o=2*t;return i.moveTo(t+e,n-o),i.lineTo(e-t,n),i.lineTo(t+e,o+n),!0}class JR extends he{constructor(){super(...arguments),this.type="arrow2Left",this.pathStr="M 0.25 -0.5 L -0.25 0 l 0.25 0.5"}draw(t,e,n,o){return Pp(t,this.parseSize(e)/4,n,o)}drawOffset(t,e,n,o,r){return Pp(t,this.parseSize(e)/4+r,n,o)}}const QR=new JR;function Hp(i,t,e,n){const o=2*t;return i.moveTo(e-t,n-o),i.lineTo(e+t,n),i.lineTo(e-t,o+n),!0}class tA extends he{constructor(){super(...arguments),this.type="arrow2Right",this.pathStr="M -0.25 -0.5 l 0.25 0 l -0.25 0.5"}draw(t,e,n,o){return Hp(t,this.parseSize(e)/4,n,o)}drawOffset(t,e,n,o,r){return Hp(t,this.parseSize(e)/4+r,n,o)}}const eA=new tA;function kp(i,t,e,n){const o=2*t;return i.moveTo(e-o,n+t),i.lineTo(e,n-t),i.lineTo(e+o,n+t),!0}class iA extends he{constructor(){super(...arguments),this.type="arrow2Up",this.pathStr="M -0.5 0.25 L 0 -0.25 l 0.5 0.25"}draw(t,e,n,o){return kp(t,this.parseSize(e)/4,n,o)}drawOffset(t,e,n,o,r){return kp(t,this.parseSize(e)/4+r,n,o)}}const nA=new iA;function Ep(i,t,e,n){const o=2*t;return i.moveTo(e-o,n-t),i.lineTo(e,n+t),i.lineTo(e+o,n-t),!0}class oA extends he{constructor(){super(...arguments),this.type="arrow2Down",this.pathStr="M -0.5 -0.25 L 0 0.25 l 0.5 -0.25"}draw(t,e,n,o){return Ep(t,this.parseSize(e)/4,n,o)}drawOffset(t,e,n,o,r){return Ep(t,this.parseSize(e)/4+r,n,o)}}const rA=new oA;function Lp(i,t,e,n,o){return i.moveTo(e,n-t),i.lineTo(e,n+t),!0}class sA extends he{constructor(){super(...arguments),this.type="lineV",this.pathStr="M0,-0.5L0,0.5"}draw(t,e,n,o,r){return Lp(t,this.parseSize(e)/2,n,o)}drawOffset(t,e,n,o,r,s){return Lp(t,this.parseSize(e)/2+r,n,o)}drawToSvgPath(t,e,n,o){const r=this.parseSize(t)/2;return`M ${e}, ${n-r} L ${e},${n+r}`}}const lA=new sA;function Fp(i,t,e,n,o){return i.moveTo(e-t,n),i.lineTo(e+t,n),!0}class aA extends he{constructor(){super(...arguments),this.type="lineH",this.pathStr="M-0.5,0L0.5,0"}draw(t,e,n,o,r){return Fp(t,this.parseSize(e)/2,n,o)}drawOffset(t,e,n,o,r,s){return Fp(t,this.parseSize(e)/2+r,n,o)}drawToSvgPath(t,e,n,o){const r=this.parseSize(t)/2;return`M ${e-r}, ${n} L ${e+r},${n}`}}const hA=new aA;function zp(i,t,e,n,o){return i.moveTo(e-t,n-t),i.lineTo(e+t,n+t),i.moveTo(e+t,n-t),i.lineTo(e-t,n+t),!0}class dA extends he{constructor(){super(...arguments),this.type="close",this.pathStr="M-0.5,-0.5L0.5,0.5,M0.5,-0.5L-0.5,0.5"}draw(t,e,n,o,r){return zp(t,this.parseSize(e)/2,n,o)}drawOffset(t,e,n,o,r,s){return zp(t,this.parseSize(e)/2+r,n,o)}drawToSvgPath(t,e,n,o){const r=this.parseSize(t)/2;return`M ${e-r}, ${n-r} L ${e+r},${n+r} M ${e+r}, ${n-r} L ${e-r},${n+r}`}}const uA=new dA;function Ip(i,t,e,n){return i.rect(e-t[0]/2,n-t[1]/2,t[0],t[1]),!1}function Op(i,t,e,n){const o=t,r=t/2;return i.rect(e-o/2,n-r/2,o,r),!1}class cA extends he{constructor(){super(...arguments),this.type="rect",this.pathStr="M -0.5,0.25 L 0.5,0.25 L 0.5,-0.25,L -0.5,-0.25 Z"}draw(t,e,n,o){return Z(e)?Op(t,e,n,o):Ip(t,e,n,o)}drawOffset(t,e,n,o,r){return Z(e)?Op(t,e+2*r,n,o):Ip(t,[e[0]+2*r,e[1]+2*r],n,o)}}const gA=new cA,Zr=new Gt;class Dp{constructor(t,e,n=!1){this.pathStr="",this.type=t,Q(e)?this.svgCache=e:this.path=e,this.isSvg=n}drawOffset(t,e,n,o,r,s,l){return e=this.parseSize(e),this.isSvg?!!this.svgCache&&(this.svgCache.forEach(a=>{t.beginPath(),Qn(a.path.commandList,t,n,o,e,e),l&&l(a.path,a.attribute)}),!1):(Qn(this.path.commandList,t,n,o,e+r,e+r),!1)}draw(t,e,n,o,r,s){return e=this.parseSize(e),this.drawOffset(t,e,n,o,0,r,s)}parseSize(t){return Z(t)?t:Math.min(t[0],t[1])}bounds(t,e){if(t=this.parseSize(t),this.isSvg)return this.svgCache?(e.clear(),void this.svgCache.forEach(({path:n})=>{Zr.x1=n.bounds.x1*t,Zr.y1=n.bounds.y1*t,Zr.x2=n.bounds.x2*t,Zr.y2=n.bounds.y2*t,e.union(Zr)})):void 0;this.path.bounds&&(e.x1=this.path.bounds.x1*t,e.y1=this.path.bounds.y1*t,e.x2=this.path.bounds.x2*t,e.y2=this.path.bounds.y2*t)}}const fA=[CR,SR,RR,BR,ZR,PR,LR,IR,DR,NR,GR,UR,KR,MR,XR,QR,eA,nA,rA,gA,lA,hA,uA],VC={};fA.forEach(i=>{VC[i.type]=i});const pA={arrowLeft:"M 0.25 -0.5 L -0.25 0 l 0.5 0.5",arrowRight:"M -0.25 -0.5 l 0.5 0.5 l -0.5 0.5",rectRound:"M 0.3 -0.5 C 0.41 -0.5 0.5 -0.41 0.5 -0.3 C 0.5 -0.3 0.5 0.3 0.5 0.3 C 0.5 0.41 0.41 0.5 0.3 0.5 C 0.3 0.5 -0.3 0.5 -0.3 0.5 C -0.41 0.5 -0.5 0.41 -0.5 0.3 C -0.5 0.3 -0.5 -0.3 -0.5 -0.3 C -0.5 -0.41 -0.41 -0.5 -0.3 -0.5 C -0.3 -0.5 0.3 -0.5 0.3 -0.5 Z",roundLine:"M 1.2392 -0.258 L -1.3432 -0.258 C -1.4784 -0.258 -1.588 -0.1436 -1.588 -0.002 c 0 0.1416 0.1096 0.256 0.2448 0.256 l 2.5824 0 c 0.1352 0 0.2448 -0.1144 0.2448 -0.256 C 1.484 -0.1436 1.3744 -0.258 1.2392 -0.258 z"},vA=(i,t,e)=>{const{outerBorder:n,shadowBlur:o=t.shadowBlur,strokeBoundsBuffer:r=t.strokeBoundsBuffer}=i;if(n){const s=t.outerBorder,{distance:l=s.distance,lineWidth:a=s.lineWidth}=n;fa(e,l+(o+a)/2,!0,r)}return e},Hl=new Gt,Wp=["symbolType","size",...Ti];let nc=class Jo extends ti{constructor(t={symbolType:"circle"}){super(t),this.type="symbol",this.numberType=nd}getParsedPath(){return this.shouldUpdateShape()&&(this.doUpdateParsedPath(),this.clearUpdateShapeTag()),this._parsedPath}isValid(){return super.isValid()&&this._isValid()}_isValid(){const{size:t}=this.attribute;return Q(t)?t.length===2&&t.every(this._validNumber):this._validNumber(t)}doUpdateParsedPath(){const t=this.getGraphicTheme();let{symbolType:e=t.symbolType}=this.attribute,n=VC[e];if(n)return this._parsedPath=n,n;if(n=Jo.userSymbolMap[e],n)return this._parsedPath=n,n;if(e=pA[e]||e,MS(e)===!0){const a=new Zh,{svg:h}=a.parse(e);if(!h)return null;const d=Q(h.path)?h.path:[h.path];Hl.clear();const u=[];d.forEach(p=>{const v=new Ae().fromString(p.d),m={};zS.forEach(b=>{p[b]&&(m[SC[b]]=p[b])}),u.push({path:v,attribute:m}),Hl.union(v.bounds)});const c=Hl.width(),f=Hl.height(),g=1/Jn(c,f);return u.forEach(p=>p.path.transform(0,0,g,g)),this._parsedPath=new Dp(e,u,!0),Jo.userSymbolMap[e]=this._parsedPath,this._parsedPath}const o=new Ae().fromString(e),r=o.bounds.width(),s=o.bounds.height(),l=1/Jn(r,s);return o.transform(0,0,l,l),this._parsedPath=new Dp(e,o),Jo.userSymbolMap[e]=this._parsedPath,this._parsedPath}getGraphicTheme(){return yt(this).symbol}updateAABBBounds(t,e,n,o){this.updatePathProxyAABBBounds(n)||(o?this.updateSymbolAABBBoundsImprecise(t,e,n):this.updateSymbolAABBBoundsAccurate(t,e,n));const{tb1:r,tb2:s}=G.graphicService.updateTempAABBBounds(n);vA(t,e,r),n.union(r),r.setValue(s.x1,s.y1,s.x2,s.y2);const{lineJoin:l=e.lineJoin}=t;return G.graphicService.transformAABBBounds(t,n,e,l==="miter",this),n}updateSymbolAABBBoundsImprecise(t,e,n){const{size:o=e.size}=t;if(Q(o))n.set(-o[0]/2,-o[1]/2,o[0]/2,o[1]/2);else{const r=o/2;n.set(-r,-r,r,r)}return n}updateSymbolAABBBoundsAccurate(t,e,n){const{size:o=e.size}=t;return this.getParsedPath().bounds(o,n),n}needUpdateTags(t){return super.needUpdateTags(t,Wp)}needUpdateTag(t){return super.needUpdateTag(t,Wp)}toCustomPath(){const t=this.getParsedPath(),e=this.attribute.size,n=Q(e)?e:[e,e];return t.path?new Ae().fromCustomPath2D(t.path,0,0,n[0],n[1]):new Ae().fromString(t.pathStr,0,0,n[0],n[1])}clone(){return new Jo(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return Jo.NOWORK_ANIMATE_ATTR}};nc.userSymbolMap={},nc.NOWORK_ANIMATE_ATTR=Object.assign({symbolType:1},Vi);function zs(i){return new nc(i)}const Np=["segments","points","curveType","curveTension",...Ti];let GC=class oc extends ti{constructor(t={}){super(t),this.type="line",this.numberType=nl}isValid(){return super.isValid()&&this._isValid()}_isValid(){if(this.pathProxy)return!0;const{points:t,segments:e}=this.attribute;return e?e.length!==0:!!t&&!(t.length<=1)}_interpolate(t,e,n,o,r){t==="points"&&(r.points=vC(n,o,e))}getGraphicTheme(){return yt(this).line}updateAABBBounds(t,e,n){this.updatePathProxyAABBBounds(n)||(t.segments?this.updateLineAABBBoundsBySegments(t,e,n):this.updateLineAABBBoundsByPoints(t,e,n)),G.graphicService.updateTempAABBBounds(n);const{lineJoin:o=e.lineJoin}=t;return G.graphicService.transformAABBBounds(t,n,e,o==="miter",this),n}updateLineAABBBoundsByPoints(t,e,n,o){const{points:r=e.points,connectedType:s}=t,l=n;return r.forEach(a=>{a.defined===!1&&s!=="zero"&&s!=="connect"||l.add(a.x,a.y)}),l}updateLineAABBBoundsBySegments(t,e,n,o){const{segments:r=e.segments,connectedType:s}=t,l=n;return r.forEach(a=>{a.points.forEach(h=>{h.defined===!1&&s!=="zero"&&s!=="connect"||l.add(h.x,h.y)})}),l}needUpdateTags(t){return super.needUpdateTags(t,Np)}needUpdateTag(t){return super.needUpdateTag(t,Np)}toCustomPath(){const t=this.attribute,e=new Ae,n=t.segments,o=r=>{if(r&&r.length){let s=!0;r.forEach(l=>{l.defined!==!1&&(s?e.moveTo(l.x,l.y):e.lineTo(l.x,l.y),s=!1)})}};return n&&n.length?n.forEach(r=>{o(r.points)}):t.points&&o(t.points),e}clone(){return new oc(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return oc.NOWORK_ANIMATE_ATTR}};GC.NOWORK_ANIMATE_ATTR=Object.assign({segments:1,curveType:1},Vi);function hi(i){return new GC(i)}const Vp=["width","x1","y1","height","cornerRadius",...Ti];let ld=class rc extends ti{constructor(t){super(t),this.type="rect",this.numberType=Tg}isValid(){return super.isValid()&&this._isValid()}_isValid(){return!0}getGraphicTheme(){return yt(this).rect}updateAABBBounds(t,e,n){if(!this.updatePathProxyAABBBounds(n)){let{width:s,height:l}=t;const{x1:a,y1:h,x:d,y:u}=t;s=s??a-d,l=l??h-u,(isFinite(s)||isFinite(l)||isFinite(d)||isFinite(u))&&n.set(0,0,s||0,l||0)}const{tb1:o,tb2:r}=G.graphicService.updateTempAABBBounds(n);return sl(t,e,o),n.union(o),o.setValue(r.x1,r.y1,r.x2,r.y2),G.graphicService.transformAABBBounds(t,n,e,!1,this),n}needUpdateTags(t){return super.needUpdateTags(t,Vp)}needUpdateTag(t){return super.needUpdateTag(t,Vp)}toCustomPath(){const t=this.attribute,{x:e,y:n,width:o,height:r}=gS(t),s=new Ae;return s.moveTo(e,n),s.rect(e,n,o,r),s}clone(){return new rc(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return rc.NOWORK_ANIMATE_ATTR}};ld.NOWORK_ANIMATE_ATTR=Vi;function qt(i){return new ld(i)}class mA{constructor(t,e,n,o,r,s,l,a,h,d,u,c,f,g){this.left=t,this.top=e,this.width=n,this.height=o,this.actualHeight=0,this.bottom=e+o,this.right=t+n,this.ellipsis=r,this.wordBreak=s,this.verticalDirection=l,this.lines=[],this.globalAlign=a,this.globalBaseline=h,this.layoutDirection=d,this.directionKey=Sg[this.layoutDirection],this.isWidthMax=u,this.isHeightMax=c,this.singleLine=f,g?(g.clear(),this.icons=g):this.icons=new Map}draw(t,e){const{width:n,height:o}=this.getActualSize(),r=this.isWidthMax?Math.min(this.width,n):this.width||n||0;let s=this.isHeightMax?Math.min(this.height,o):this.height||o||0;s=Math.min(s,o);let l=0;switch(this.globalBaseline){case"top":l=0;break;case"middle":l=-s/2;break;case"bottom":l=-s}let a=0;this.globalAlign==="right"||this.globalAlign==="end"?a=-r:this.globalAlign==="center"&&(a=-r/2);let h=this[this.directionKey.height];this.singleLine&&(h=this.lines[0].height+1);let d=!1;if(this.verticalDirection==="middle")if(this.actualHeight>=h&&h!==0)for(let u=0;u<this.lines.length;u++){const{top:c,height:f}=this.lines[u];if(c+f<this[this.directionKey.top]||c+f>this[this.directionKey.top]+h)return d;let g=!1;this.ellipsis&&this.lines[u+1]&&this.lines[u+1].top+this.lines[u+1].height>this[this.directionKey.top]+h&&(g=!0,d=!0),this.lines[u].draw(t,g,this.lines[u][this.directionKey.left]+a,this.lines[u][this.directionKey.top]+l,this.ellipsis,e)}else{const u=Math.floor((h-this.actualHeight)/2);this.layoutDirection==="vertical"?a+=u:l+=u;for(let c=0;c<this.lines.length;c++)this.lines[c].draw(t,!1,this.lines[c][this.directionKey.left]+a,this.lines[c][this.directionKey.top]+l,this.ellipsis,e)}else if(this.verticalDirection==="bottom"&&this.layoutDirection!=="vertical")for(let u=0;u<this.lines.length;u++){const{top:c,height:f}=this.lines[u],g=h-this.lines[u].top-this.lines[u].height;if(h===0)this.lines[u].draw(t,!1,a,g+l,this.ellipsis,e);else{if(g+f>this[this.directionKey.top]+h||g<this[this.directionKey.top])return d;{let p=!1;this.ellipsis&&this.lines[u+1]&&g-this.lines[u+1].height<this[this.directionKey.top]&&(p=!0,d=!0),this.lines[u].draw(t,p,a,g+l,this.ellipsis,e)}}}else{this.verticalDirection==="bottom"&&this.layoutDirection==="vertical"&&this.singleLine&&this.isWidthMax&&(a+=this.lines[0].height+1);for(let u=0;u<this.lines.length;u++){this.verticalDirection==="bottom"&&this.layoutDirection==="vertical"&&(a-=this.lines[u].height+this.lines[u].top);const{top:c,height:f}=this.lines[u];if(h===0)this.lines[u].draw(t,!1,this.lines[u][this.directionKey.left]+a,this.lines[u][this.directionKey.top]+l,this.ellipsis,e);else{if(c+f<this[this.directionKey.top]||c+f>this[this.directionKey.top]+h)return d;{let g=!1;this.ellipsis&&this.lines[u+1]&&this.lines[u+1].top+this.lines[u+1].height>this[this.directionKey.top]+h&&(g=!0,d=!0),this.lines[u].draw(t,g,this.lines[u][this.directionKey.left]+a,this.lines[u][this.directionKey.top]+l,this.ellipsis,e)}}}}return d}getActualSize(){return this.ellipsis?this.getActualSizeWidthEllipsis():this.getRawActualSize()}getRawActualSize(){let t=0,e=0;for(let n=0;n<this.lines.length;n++){const o=this.lines[n];o.actualWidth>t&&(t=o.actualWidth),e+=o.height}return{width:this.layoutDirection==="vertical"?e:t,height:this.layoutDirection==="vertical"?t:e}}getActualSizeWidthEllipsis(){let t=0,e=0;const{width:n,height:o}=this.getRawActualSize();this.width,this.height;let r=this[this.directionKey.height];if(this.singleLine&&(r=this.lines[0].height+1),this.verticalDirection==="middle")if(this.actualHeight>=r&&r!==0)for(let s=0;s<this.lines.length;s++){const{top:l,height:a}=this.lines[s];if(!(l+a<this[this.directionKey.top]||l+a>this[this.directionKey.top]+r))if(this.ellipsis&&this.lines[s+1]&&this.lines[s+1].top+this.lines[s+1].height>this[this.directionKey.top]+r){const h=this.ellipsis===!0?"...":this.ellipsis||"",d=this.lines[s].getWidthWithEllips(h);d>t&&(t=d),e+=this.lines[s].height}else this.lines[s].actualWidth>t&&(t=this.lines[s].actualWidth),e+=this.lines[s].height}else{Math.floor((r-this.actualHeight)/2);for(let s=0;s<this.lines.length;s++)this.lines[s].actualWidth>t&&(t=this.lines[s].actualWidth),e+=this.lines[s].height}else if(this.verticalDirection==="bottom")for(let s=0;s<this.lines.length;s++){const{top:l,height:a}=this.lines[s],h=r-this.lines[s].top-this.lines[s].height;if(r===0)this.lines[s].actualWidth>t&&(t=this.lines[s].actualWidth),e+=this.lines[s].height;else if(!(h+a>this[this.directionKey.top]+r||h<this[this.directionKey.top]))if(this.ellipsis&&this.lines[s+1]&&h-this.lines[s+1].height<this[this.directionKey.top]){const d=this.ellipsis===!0?"...":this.ellipsis||"",u=this.lines[s].getWidthWithEllips(d);u>t&&(t=u),e+=this.lines[s].height}else this.lines[s].actualWidth>t&&(t=this.lines[s].actualWidth),e+=this.lines[s].height}else for(let s=0;s<this.lines.length;s++){const{top:l,height:a}=this.lines[s];if(r===0)this.lines[s].actualWidth>t&&(t=this.lines[s].actualWidth),e+=this.lines[s].height;else if(!(l+a<this[this.directionKey.top]||l+a>this[this.directionKey.top]+r))if(this.ellipsis&&this.lines[s+1]&&this.lines[s+1].top+this.lines[s+1].height>this[this.directionKey.top]+r){const h=this.ellipsis===!0?"...":this.ellipsis||"",d=this.lines[s].getWidthWithEllips(h);d>t&&(t=d),e+=this.lines[s].height}else this.lines[s].actualWidth>t&&(t=this.lines[s].actualWidth),e+=this.lines[s].height}return{width:this.layoutDirection==="vertical"?e:t,height:this.layoutDirection==="vertical"?t:e}}}class Is{constructor(t,e,n){this.fontSize=n.fontSize||16,this.textBaseline=n.textBaseline||"alphabetic";const o=il(n.lineHeight,this.fontSize);this.lineHeight=typeof o=="number"?o>this.fontSize?o:this.fontSize:Math.floor(1.2*this.fontSize),this.height=this.lineHeight;const{ascent:r,height:s,descent:l,width:a}=nr(t,n);let h=0,d=0,u=0;this.height>s&&(h=(this.height-s)/2,d=Math.ceil(h),u=Math.floor(h)),this.textBaseline==="top"?(this.ascent=h,this.descent=s-h):this.textBaseline==="bottom"?(this.ascent=s-h,this.descent=h):this.textBaseline==="middle"?(this.ascent=this.height/2,this.descent=this.height/2):(this.ascent=r+d,this.descent=l+u),this.length=t.length,this.width=a||0,this.text=t||"",this.newLine=e||!1,this.character=n,this.left=0,this.top=0,this.ellipsis="normal",this.ellipsisWidth=0,this.ellipsisOtherParagraphWidth=0,n.direction==="vertical"&&(this.direction=n.direction,this.widthOrigin=this.width,this.heightOrigin=this.height,this.width=this.heightOrigin,this.height=this.widthOrigin,this.lineHeight=this.height),this.ellipsisStr="..."}updateWidth(){const{width:t}=nr(this.text,this.character);this.width=t,this.direction==="vertical"&&(this.widthOrigin=this.width,this.width=this.heightOrigin,this.height=this.widthOrigin)}draw(t,e,n,o,r){let s=this.text,l=this.left+n;e+=this.top;let a=this.direction;if(this.verticalEllipsis)s=this.ellipsisStr,a="vertical",e-=this.ellipsisWidth/2;else{if(this.ellipsis==="hide")return;if(this.ellipsis==="add")s+=this.ellipsisStr,r!=="right"&&r!=="end"||(l-=this.ellipsisWidth);else if(this.ellipsis==="replace"){const d=Tu(s,(a==="vertical"?this.height:this.width)-this.ellipsisWidth+this.ellipsisOtherParagraphWidth,this.character,s.length-1);if(s=s.slice(0,d),s+=this.ellipsisStr,r==="right"||r==="end"){const{width:u}=nr(this.text.slice(d),this.character);a==="vertical"||(l-=this.ellipsisWidth-u)}}}switch(this.character.script){case"super":e-=this.ascent*(1/3);break;case"sub":e+=this.descent/2}a==="vertical"&&(t.save(),t.rotateAbout(Math.PI/2,l,e),t.translate(-this.heightOrigin||-this.lineHeight/2,-this.descent/2),t.translate(l,e),l=0,e=0);const{lineWidth:h=1}=this.character;this.character.stroke&&h&&t.strokeText(s,l,e),this.character.fill&&t.fillText(s,l,e),this.character.fill&&(typeof this.character.lineThrough=="boolean"||typeof this.character.underline=="boolean"?(this.character.underline&&t.fillRect(l,1+e,this.widthOrigin||this.width,this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1),this.character.lineThrough&&t.fillRect(l,1+e-this.ascent/2,this.widthOrigin||this.width,this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1)):this.character.textDecoration==="underline"?t.fillRect(l,1+e,this.widthOrigin||this.width,this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1):this.character.textDecoration==="line-through"&&t.fillRect(l,1+e-this.ascent/2,this.widthOrigin||this.width,this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1)),a==="vertical"&&t.restore()}getWidthWithEllips(t){let e=this.text;const n=t==="vertical"?this.height:this.width;if(this.ellipsis==="hide")return n;if(this.ellipsis==="add")return n+this.ellipsisWidth;if(this.ellipsis==="replace"){const o=Tu(e,n-this.ellipsisWidth+this.ellipsisOtherParagraphWidth,this.character,e.length-1);e=e.slice(0,o),e+=this.ellipsisStr;const{width:r}=nr(this.text.slice(o),this.character);return n+this.ellipsisWidth-r}return n}}function bA(i,t){const e=i.text.slice(0,t),n=i.text.slice(t);return[new Is(e,i.newLine,i.character),new Is(n,!0,i.character)]}const Gp=["width","height","image",...Ti];let ko=class sc extends ti{constructor(t){super(t),this.type="image",this.numberType=td,this.loadImage(this.attribute.image)}get width(){var t;return(t=this.attribute.width)!==null&&t!==void 0?t:0}set width(t){this.attribute.width===t&&(this.attribute.width=t,this.addUpdateShapeAndBoundsTag())}get height(){var t;return(t=this.attribute.height)!==null&&t!==void 0?t:0}set height(t){this.attribute.height===t&&(this.attribute.height=t,this.addUpdateShapeAndBoundsTag())}get repeatX(){var t;return(t=this.attribute.repeatX)!==null&&t!==void 0?t:"no-repeat"}set repeatX(t){this.attribute.repeatX===t&&(this.attribute.repeatX=t)}get repeatY(){var t;return(t=this.attribute.repeatY)!==null&&t!==void 0?t:"no-repeat"}set repeatY(t){this.attribute.repeatY===t&&(this.attribute.repeatY=t)}get image(){return this.attribute.image}set image(t){t!==this.attribute.image&&(this.attribute.image=t,this.loadImage(this.attribute.image))}imageLoadSuccess(t,e,n){super.imageLoadSuccess(t,e,()=>{this.successCallback&&this.successCallback()})}imageLoadFail(t,e){super.imageLoadFail(t,()=>{this.failCallback&&this.failCallback()})}setAttributes(t,e,n){return t.image&&this.loadImage(t.image),super.setAttributes(t,e,n)}setAttribute(t,e,n,o){return t==="image"&&this.loadImage(e),super.setAttribute(t,e,n,o)}getGraphicTheme(){return yt(this).image}updateAABBBounds(t,e,n){if(!this.updatePathProxyAABBBounds(n)){const{width:s=e.width,height:l=e.height}=t;n.set(0,0,s,l)}const{tb1:o,tb2:r}=G.graphicService.updateTempAABBBounds(n);return sl(t,e,o),n.union(o),o.setValue(r.x1,r.y1,r.x2,r.y2),G.graphicService.transformAABBBounds(t,n,e,!1,this),n}getDefaultAttribute(t){return Ps[t]}needUpdateTags(t){return super.needUpdateTags(t,Gp)}needUpdateTag(t){return super.needUpdateTag(t,Gp)}clone(){return new sc(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return sc.NOWORK_ANIMATE_ATTR}};ko.NOWORK_ANIMATE_ATTR=Object.assign({image:1,repeatX:1,repeatY:1},Vi);function ad(i){return new ko(i)}class mn extends ko{constructor(t){if(super(t),this._x=0,this._y=0,this._hovered=!1,this._marginArray=[0,0,0,0],t.backgroundShowMode==="always"&&(this._hovered=!0),t.margin){const e=ga(t.margin);this._marginArray=typeof e=="number"?[e,e,e,e]:e}this.onBeforeAttributeUpdate=(e,n,o)=>{if(Q(o)&&o.indexOf("margin")!==-1||o==="margin")if(n.margin){const r=ga(n.margin);this._marginArray=typeof r=="number"?[r,r,r,r]:r}else this._marginArray=[0,0,0,0]}}get width(){var t;return((t=this.attribute.width)!==null&&t!==void 0?t:0)+this._marginArray[1]+this._marginArray[3]}get height(){var t;return((t=this.attribute.height)!==null&&t!==void 0?t:0)+this._marginArray[0]+this._marginArray[2]}tryUpdateAABBBounds(){if(!this.shouldUpdateAABBBounds())return this._AABBBounds;this.doUpdateAABBBounds();const{width:t=Ps.width,height:e=Ps.height}=this.attribute,{backgroundWidth:n=t,backgroundHeight:o=e}=this.attribute,r=(n-t)/2,s=(o-e)/2;return this._AABBBounds.expand([0,2*r,2*s,0]),this._AABBBounds}setHoverState(t){this.attribute.backgroundShowMode==="hover"&&this._hovered!==t&&(this._hovered=t)}}class CA{constructor(t,e,n,o,r,s,l,a){this.left=t,this.width=e,this.baseline=n,this.ascent=o,this.descent=r,this.top=n-o,this.paragraphs=s.map(d=>d),this.textAlign=(this.paragraphs[0]instanceof mn?this.paragraphs[0].attribute.textAlign:this.paragraphs[0].character.textAlign)||"left",this.direction=l,this.directionKey=Sg[this.direction],this.actualWidth=0;let h=0;this.paragraphs.forEach((d,u)=>{if(u===0&&d instanceof Is){const c=$1.exec(d.text);(c==null?void 0:c.index)!==0&&(d.text=d.text.slice(c==null?void 0:c.index),d.updateWidth())}this.actualWidth+=d[this.directionKey.width],h=Math.max(d[this.directionKey.height],h)}),this.height=h,this.blankWidth=a?0:this.width-this.actualWidth,this.calcOffset(e,a)}calcOffset(t,e){const n=this.directionKey,o=this.height;let r=this.left,s=0;this.actualWidth<t&&!e&&(this.textAlign==="right"||this.textAlign==="end"?r=t-this.actualWidth:this.textAlign==="center"?r=(t-this.actualWidth)/2:this.textAlign==="justify"&&(this.paragraphs.length<2?r=(t-this.actualWidth)/2:s=(t-this.actualWidth)/(this.paragraphs.length-1))),this.paragraphs.map(function(l){l instanceof mn?(l["_"+n.x]=r,r+=l[n.width]+s,l["_"+n.y]=l.attribute.textBaseline==="top"?0:l.attribute.textBaseline==="bottom"?o-l.height:(o-l.height)/2):(l[n.left]=r,r+=l[n.width]+s)})}draw(t,e,n,o,r,s){if(r&&(e||this.paragraphs.some(l=>l.overflow))){let l=!0,a=!1;for(let d=this.paragraphs.length-1;d>=0;d--){const u=this.paragraphs[d];if(u.overflow)l=l&&u.text==="";else if(l){a=!0;break}}let h=0;if(!a)for(let d=this.paragraphs.length-1;d>=0;d--){const u=this.paragraphs[d];if(u.overflow){if(u.text==="")break;continue}if(u instanceof mn)break;if(this.direction==="vertical"&&u.direction!=="vertical"){u.verticalEllipsis=!0;break}const c=r===!0?"...":r||"";u.ellipsisStr=c;const{width:f}=nr(c,u.character),g=f||0;if(g<=this.blankWidth+h){e&&(u.ellipsis="add");break}if(g<=this.blankWidth+h+u.width){u.ellipsis="replace",u.ellipsisWidth=g,u.ellipsisOtherParagraphWidth=this.blankWidth+h;break}u.ellipsis="hide",h+=u.width}}this.paragraphs.forEach((l,a)=>{if(l instanceof mn)return l.setAttributes({x:n+l._x,y:o+l._y}),void s(l,t,n+l._x,o+l._y,this.ascent);const h={x1:this.left,y1:this.top,x2:this.left+this.actualWidth,y2:this.top+this.height};Y1(t,l.character),K1(t,l.character,h),l.draw(t,o+this.ascent,n,a===0,this.textAlign)})}getWidthWithEllips(t){let e=0;for(let o=this.paragraphs.length-1;o>=0;o--){const r=this.paragraphs[o];if(r instanceof mn)break;const{width:s}=nr(t,r.character),l=s||0;if(l<=this.blankWidth+e){r.ellipsis="add",r.ellipsisWidth=l;break}if(l<=this.blankWidth+e+r.width){r.ellipsis="replace",r.ellipsisWidth=l,r.ellipsisOtherParagraphWidth=this.blankWidth+e;break}r.ellipsis="hide",e+=r.width}let n=0;return this.paragraphs.forEach((o,r)=>{n+=o instanceof mn?o.width:o.getWidthWithEllips(this.direction)}),n}}class _A{constructor(t){this.frame=t,this.width=this.frame.width,this.height=this.frame.height,this.lineWidth=0,this.y=this.frame.top,this.maxAscent=0,this.maxDescent=0,this.maxAscentForBlank=0,this.maxDescentForBlank=0,this.lineBuffer=[],this.direction=t.layoutDirection,this.directionKey=Sg[this.direction]}store(t){if(t instanceof mn){this.frame.icons.set(t.richtextId,t),this.lineBuffer.push(t),this.lineWidth+=t[this.directionKey.width];let e=0,n=0;t.attribute.textBaseline==="top"?(e=0,n=t.height):t.attribute.textBaseline==="bottom"?(e=t.height,n=0):(e=t.height/2,n=t.height/2),this.maxAscent=Math.max(this.maxAscent,e),this.maxDescent=Math.max(this.maxDescent,n)}else this.lineBuffer.push(t),t.text.length!==0?(this.lineWidth+=t[this.directionKey.width],this.maxAscent=Math.max(this.maxAscent,t.ascent),this.maxDescent=Math.max(this.maxDescent,t.descent)):(this.maxAscentForBlank=Math.max(this.maxAscentForBlank,t.ascent),this.maxDescentForBlank=Math.max(this.maxDescentForBlank,t.descent))}send(){if(this.lineBuffer.length===0)return;const t=this.maxAscent===0?this.maxAscentForBlank:this.maxAscent,e=this.maxDescent===0?this.maxDescentForBlank:this.maxDescent,n=new CA(this.frame.left,this[this.directionKey.width],this.y+t,t,e,this.lineBuffer,this.direction,this.direction==="horizontal"?this.frame.isWidthMax:this.frame.isHeightMax);this.frame.lines.push(n),this.frame.actualHeight+=n.height,this.y+=n.height,this.lineBuffer.length=0,this.lineWidth=this.maxAscent=this.maxDescent=this.maxAscentForBlank=this.maxDescentForBlank=0}deal(t,e=!1){t instanceof mn?this.direction==="horizontal"&&this.width===0||this.direction==="vertical"&&this.height===0||this.lineWidth+t[this.directionKey.width]<=this[this.directionKey.width]?this.store(t):this.lineBuffer.length===0?(this.store(t),this.send()):(this.send(),this.deal(t)):typeof this.width!="number"||this.width<0||(t.newLine&&this.send(),t.text.length!==0&&(this.direction==="horizontal"&&this.width===0||this.direction==="vertical"&&this.height===0||this.lineWidth+t[this.directionKey.width]<=this[this.directionKey.width]?this.store(t):this.lineWidth===this[this.directionKey.width]?(this.send(),this.deal(t)):this.cut(t,e)))}cut(t,e){const n=this[this.directionKey.width]-this.lineWidth||0,o=Math.ceil(n/t[this.directionKey.width]*t.length)||0,r=Tu(t.text,n,t.character,o,this.frame.wordBreak==="break-word");if(r!==0){const[s,l]=bA(t,r);this.store(s),e?this.send():this.deal(l)}else this.lineBuffer.length!==0&&(this.send(),this.deal(t))}}const jp=["width","height","ellipsis","wordBreak","verticalDirection","maxHeight","maxWidth","textAlign","textBaseline","textConfig","layoutDirection","fill","stroke","fontSize","fontFamily","fontStyle","fontWeight","lineWidth","opacity","fillOpacity","strokeOpacity",...Ti];class Di extends ti{constructor(t){super(t),this.type="richtext",this._currentHoverIcon=null,this.numberType=Pg,this.onBeforeAttributeUpdate=(e,n,o)=>{for(const r in e)if(r==="hoverIconId"){if(e[r]===n[r])continue;const s=this._frameCache.icons.get(e[r]);this.updateHoverIconState(s)}}}get width(){var t;return(t=this.attribute.width)!==null&&t!==void 0?t:vn.width}set width(t){this.attribute.width!==t&&(this.attribute.width=t,this.addUpdateShapeAndBoundsTag())}get height(){var t;return(t=this.attribute.height)!==null&&t!==void 0?t:vn.height}set height(t){this.attribute.height!==t&&(this.attribute.height=t,this.addUpdateShapeAndBoundsTag())}get maxWidth(){return this.attribute.maxWidth}set maxWidth(t){this.attribute.maxWidth!==t&&(this.attribute.maxWidth=t,this.addUpdateShapeAndBoundsTag())}get maxHeight(){return this.attribute.maxHeight}set maxHeight(t){this.attribute.maxHeight!==t&&(this.attribute.maxHeight=t,this.addUpdateShapeAndBoundsTag())}get ellipsis(){var t;return(t=this.attribute.ellipsis)!==null&&t!==void 0?t:vn.ellipsis}set ellipsis(t){this.attribute.ellipsis!==t&&(this.attribute.ellipsis=t,this.addUpdateShapeAndBoundsTag())}get wordBreak(){var t;return(t=this.attribute.wordBreak)!==null&&t!==void 0?t:vn.wordBreak}set wordBreak(t){this.attribute.wordBreak!==t&&(this.attribute.wordBreak=t,this.addUpdateShapeAndBoundsTag())}get verticalDirection(){var t;return(t=this.attribute.verticalDirection)!==null&&t!==void 0?t:vn.verticalDirection}set verticalDirection(t){this.attribute.verticalDirection!==t&&(this.attribute.verticalDirection=t,this.addUpdateShapeAndBoundsTag())}get textAlign(){var t;return(t=this.attribute.textAlign)!==null&&t!==void 0?t:vn.textAlign}set textAlign(t){this.attribute.textAlign!==t&&(this.attribute.textAlign=t,this.addUpdateShapeAndBoundsTag())}get textBaseline(){var t;return(t=this.attribute.textBaseline)!==null&&t!==void 0?t:vn.textBaseline}set textBaseline(t){this.attribute.textBaseline!==t&&(this.attribute.textBaseline=t,this.addUpdateShapeAndBoundsTag())}get textConfig(){var t;return(t=this.attribute.textConfig)!==null&&t!==void 0?t:vn.textConfig}set textConfig(t){this.attribute.textConfig=t,this.addUpdateShapeAndBoundsTag()}getGraphicTheme(){return yt(this).richtext}updateAABBBounds(t,e,n){const{width:o=e.width,height:r=e.height,maxWidth:s=e.maxWidth,maxHeight:l=e.maxHeight,textAlign:a=e.textAlign,textBaseline:h=e.textBaseline}=t;if(o>0&&r>0)n.set(0,0,o,r);else{const c=this.getFrameCache(),{width:f,height:g}=c.getActualSize();let p=o||f||0,v=r||g||0;v=typeof l=="number"&&v>l?l:v||0,p=typeof s=="number"&&p>s?s:p||0,n.set(0,0,p,v)}let d=0;switch(h){case"top":d=0;break;case"middle":d=-n.height()/2;break;case"bottom":d=-n.height()}let u=0;switch(a){case"left":u=0;break;case"center":u=-n.width()/2;break;case"right":u=-n.width()}return n.translate(u,d),G.graphicService.updateTempAABBBounds(n),t.forceBoundsHeight==null&&t.forceBoundsWidth==null||G.graphicService.updateHTMLTextAABBBounds(t,e,n),G.graphicService.transformAABBBounds(t,n,e,!1,this),n}needUpdateTags(t){return super.needUpdateTags(t,jp)}needUpdateTag(t){return super.needUpdateTag(t,jp)}getFrameCache(){return this.shouldUpdateShape()&&(this.doUpdateFrameCache(),this.clearUpdateShapeTag()),this._frameCache}get cliped(){const t=this.getFrameCache();if(t.actualHeight>t.height)return!0;const{disableAutoWrapLine:e}=this.attribute;if(e)for(let n=0;n<t.lines.length;n++){const o=t.lines[n];for(let r=0;r<o.paragraphs.length;r++){const s=o.paragraphs[r];if(s.overflow&&s.text!=="")return!0}}return!1}combinedStyleToCharacter(t){const{fill:e,stroke:n,fontSize:o,fontFamily:r,fontStyle:s,fontWeight:l,lineWidth:a,opacity:h,fillOpacity:d,strokeOpacity:u}=this.attribute;return Object.assign({fill:e,stroke:n,fontSize:o,fontFamily:r,fontStyle:s,fontWeight:l,lineWidth:a,opacity:h,fillOpacity:d,strokeOpacity:u},t)}doUpdateFrameCache(t){var e;const{textConfig:n=[],maxWidth:o,maxHeight:r,width:s,height:l,ellipsis:a,wordBreak:h,verticalDirection:d,textAlign:u,textBaseline:c,layoutDirection:f,singleLine:g,disableAutoWrapLine:p}=this.attribute,v=[],m=t??n;for(let S=0;S<m.length;S++)if("image"in m[S]){const R=this.combinedStyleToCharacter(m[S]);R.lineWidth=void 0;const B=R.id&&this._frameCache&&this._frameCache.icons&&this._frameCache.icons.get(R.id);if(B)v.push(B);else{const A=new mn(R);A.successCallback=()=>{var M;this.addUpdateBoundTag(),(M=this.stage)===null||M===void 0||M.renderNextFrame()},A.richtextId=R.id,v.push(A)}}else{const R=this.combinedStyleToCharacter(m[S]);if(Z(R.text)&&(R.text=`${R.text}`),R.text&&R.text.includes(`
`)){const B=R.text.split(`
`);for(let A=0;A<B.length;A++)v.push(new Is(B[A],A!==0,R))}else R.text&&v.push(new Is(R.text,!1,R))}const b=typeof o=="number"&&Number.isFinite(o)&&o>0,C=typeof r=="number"&&Number.isFinite(r)&&r>0,_=typeof s=="number"&&Number.isFinite(s)&&s>0&&(!b||s<=o),w=typeof l=="number"&&Number.isFinite(l)&&l>0&&(!C||l<=r),y=new mA(0,0,(_?s:b?o:0)||0,(w?l:C?r:0)||0,a,h,d,u,c,f||"horizontal",!_&&b,!w&&C,g||!1,(e=this._frameCache)===null||e===void 0?void 0:e.icons),x=new _A(y);if(p){let S=0,R=!1;for(let B=0;B<v.length;B++){const A=v[B];R?(A.overflow=!0,A.left=1/0,A.top=1/0,!A.newLine&&y.lines[y.lines.length-1].paragraphs.push(A)):x.deal(A,!0),y.lines.length!==S&&(S=y.lines.length,x.lineBuffer.length=0,A.overflow=!0,A.left=1e3,A.top=1e3,y.lines[y.lines.length-1].paragraphs.push(A),R=!0),A.newLine&&(R=!1,x.lineWidth=0),x.send()}}else for(let S=0;S<v.length;S++)x.deal(v[S]);if(x.send(),!(y.layoutDirection==="horizontal"?_:w)){const S=y.getActualSizeWidthEllipsis();let R=y.layoutDirection==="horizontal"?S.width:S.height;(y.layoutDirection==="horizontal"?b:C)&&(R=Math.min(R,y.layoutDirection==="horizontal"?o:r)),y.lines.forEach(function(B){B.calcOffset(R,!1)})}this._frameCache=y}clone(){return new Di(Object.assign({},this.attribute))}setStage(t,e){super.setStage(t,e),this.getFrameCache().icons.forEach(n=>{n.setStage(t,e)})}bindIconEvent(){this.addEventListener("pointermove",t=>{const e=this.pickIcon(t.global);e&&e===this._currentHoverIcon||(e?this.setAttribute("hoverIconId",e.richtextId):!e&&this._currentHoverIcon&&this.setAttribute("hoverIconId",void 0))}),this.addEventListener("pointerleave",t=>{this._currentHoverIcon&&this.setAttribute("hoverIconId",void 0)})}updateHoverIconState(t){var e,n,o,r,s;t?((e=this._currentHoverIcon)===null||e===void 0||e.setHoverState(!1),this._currentHoverIcon=t,this._currentHoverIcon.setHoverState(!0),(n=this.stage)===null||n===void 0||n.setCursor(t.attribute.cursor),(o=this.stage)===null||o===void 0||o.renderNextFrame()):(this._currentHoverIcon.setHoverState(!1),this._currentHoverIcon=null,(r=this.stage)===null||r===void 0||r.setCursor(),(s=this.stage)===null||s===void 0||s.renderNextFrame())}pickIcon(t){const e=this.getFrameCache(),{e:n,f:o}=this.globalTransMatrix;let r;return e.icons.forEach((s,l)=>{var a,h;const d=s.AABBBounds.clone();d.translate(s._marginArray[3],s._marginArray[0]),d.containsPoint({x:t.x-n,y:t.y-o})&&(r=s,r.globalX=((a=r.attribute.x)!==null&&a!==void 0?a:0)+n+s._marginArray[3],r.globalY=((h=r.attribute.y)!==null&&h!==void 0?h:0)+o+s._marginArray[0])}),r}getNoWorkAnimateAttr(){return Di.NOWORK_ANIMATE_ATTR}}Di.NOWORK_ANIMATE_ATTR=Object.assign({ellipsis:1,wordBreak:1,verticalDirection:1,textAlign:1,textBaseline:1,textConfig:1,layoutDirection:1},Vi);function wA(i){return new Di(i)}const Up=["path","customPath",...Ti];class Os extends ti{constructor(t){super(t),this.type="path",this.numberType=ed}get pathShape(){return this.tryUpdateAABBBounds(),this.getParsedPathShape()}isValid(){return super.isValid()&&this._isValid()}_isValid(){const{path:t}=this.attribute;return t!=null&&t!==""}getParsedPathShape(){const t=this.getGraphicTheme();if(!this.valid)return t.path;const e=this.attribute;return e.path instanceof Ae?e.path:(Pt(this.cache)&&this.doUpdatePathShape(),this.cache instanceof Ae?this.cache:t.path)}getGraphicTheme(){return yt(this).path}updateAABBBounds(t,e,n){if(!this.updatePathProxyAABBBounds(n)){const l=this.getParsedPathShape();n.union(l.getBounds())}const{tb1:o,tb2:r}=G.graphicService.updateTempAABBBounds(n);sl(t,e,o),n.union(o),o.setValue(r.x1,r.y1,r.x2,r.y2);const{lineJoin:s=e.lineJoin}=t;return G.graphicService.transformAABBBounds(t,n,e,s==="miter",this),n}doUpdateAABBBounds(t){return this.doUpdatePathShape(),super.doUpdateAABBBounds(t)}doUpdatePathShape(){const t=this.attribute;jt(t.path,!0)?this.cache=new Ae().fromString(t.path):t.customPath&&(this.cache=new Ae,t.customPath(this.cache,this))}needUpdateTags(t){return super.needUpdateTags(t,Up)}needUpdateTag(t){return super.needUpdateTag(t,Up)}toCustomPath(){return new Ae().fromCustomPath2D(this.getParsedPathShape(),0,0)}clone(){return new Os(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return Os.NOWORK_ANIMATE_ATTR}}Os.NOWORK_ANIMATE_ATTR=Object.assign({path:1,customPath:1},Vi);function yA(i){return new Os(i)}const $p=["innerRadius","outerRadius","startAngle","endAngle","cornerRadius","padAngle","padRadius","cap",...Ti];class Br extends ti{constructor(t){super(t),this.type="arc",this.numberType=Jh}isValid(){return super.isValid()&&this._isValid()}_isValid(){const{startAngle:t,endAngle:e,outerRadius:n,innerRadius:o}=this.attribute;return this._validNumber(t)&&this._validNumber(e)&&this._validNumber(n)&&this._validNumber(o)}getParsedCornerRadius(){const t=this.getGraphicTheme(),{cornerRadius:e=t.cornerRadius,innerPadding:n=t.innerPadding,outerPadding:o=t.outerPadding}=this.attribute;let{outerRadius:r=t.outerRadius,innerRadius:s=t.innerRadius}=this.attribute;if(r+=o,s-=n,e===0||e==="0%")return 0;const l=Math.abs(r-s),a=h=>Math.min(Z(h,!0)?h:l*parseFloat(h)/100,l/2);if(Q(e)){const h=e.map(d=>a(d)||0);return h.length===0?[h[0],h[0],h[0],h[0]]:h.length===2?[h[0],h[1],h[0],h[1]]:(h.length===3&&h.push(0),h)}return a(e)}getParsedAngle(){const t=this.getGraphicTheme();let{startAngle:e=t.startAngle,endAngle:n=t.endAngle}=this.attribute;const{cap:o=t.cap}=this.attribute,r=n-e>=0?1:-1,s=n-e;if(e=wy(e),n=e+s,o&&Dt(s)<Vt-Kt){let l=1,a=1;o.length&&(l=Number(o[0]),a=Number(o[1]));let{outerRadius:h=t.outerRadius,innerRadius:d=t.innerRadius}=this.attribute;const{outerPadding:u=t.outerPadding,innerPadding:c=t.innerPadding}=this.attribute;h+=u,d-=c;const f=Math.abs(h-d)/2,g=f/h;if(f>Kt&&h>Kt)return{startAngle:e-r*g*l,endAngle:n+r*g*a,sc:r*g*l,ec:r*g*a}}return{startAngle:e,endAngle:n}}getParsePadAngle(t,e){const n=this.getGraphicTheme(),{innerPadding:o=n.innerPadding,outerPadding:r=n.outerPadding,padAngle:s=n.padAngle}=this.attribute;let{outerRadius:l=n.outerRadius,innerRadius:a=n.innerRadius}=this.attribute;l+=r,a-=o;const{padRadius:h=Xn(l*l+a*a)}=this.attribute,d=Dt(e-t);let u=t,c=e,f=t,g=e;const p=s/2;let v=d,m=d;if(p>Kt&&h>Kt){const b=e>t?1:-1;let C=ff(Number(h)/a*ie(p)),_=ff(Number(h)/l*ie(p));return(v-=2*C)>Kt?(C*=b,f+=C,g-=C):(v=0,f=g=(t+e)/2),(m-=2*_)>Kt?(_*=b,u+=_,c-=_):(m=0,u=c=(t+e)/2),{outerStartAngle:u,outerEndAngle:c,innerStartAngle:f,innerEndAngle:g,innerDeltaAngle:v,outerDeltaAngle:m}}return{outerStartAngle:u,outerEndAngle:c,innerStartAngle:f,innerEndAngle:g,innerDeltaAngle:v,outerDeltaAngle:m}}getGraphicTheme(){return yt(this).arc}updateAABBBounds(t,e,n,o){this.updatePathProxyAABBBounds(n)||(o?this.updateArcAABBBoundsImprecise(t,e,n):this.updateArcAABBBoundsAccurate(t,e,n));const{tb1:r,tb2:s}=G.graphicService.updateTempAABBBounds(n);sl(t,e,r),n.union(r),r.setValue(s.x1,s.y1,s.x2,s.y2);const{lineJoin:l=e.lineJoin}=t;return G.graphicService.transformAABBBounds(t,n,e,l==="miter",this),n}updateArcAABBBoundsImprecise(t,e,n){let{outerRadius:o=e.outerRadius,innerRadius:r=e.innerRadius}=t;const{outerPadding:s=e.outerPadding,innerPadding:l=e.innerPadding}=t;return o+=s,r-=l,o<r&&(o=r),n.set(-o,-o,o,o),n}updateArcAABBBoundsAccurate(t,e,n){let{outerRadius:o=e.outerRadius,innerRadius:r=e.innerRadius}=t;const{outerPadding:s=e.outerPadding,innerPadding:l=e.innerPadding}=t;if(o+=s,r-=l,o<r){const d=o;o=r,r=d}let{endAngle:a=e.endAngle,startAngle:h=e.startAngle}=t;if(h>a){const d=h;h=a,a=d}return o<=Kt?n.set(0,0,0,0):Math.abs(a-h)>Vt-Kt?n.set(-o,-o,o,o):(Fu(h,a,o,n),Fu(h,a,r,n)),n}needUpdateTags(t){return super.needUpdateTags(t,$p)}needUpdateTag(t){return super.needUpdateTag(t,$p)}toCustomPath(){var t,e,n,o;const r=this.attribute,{startAngle:s,endAngle:l}=this.getParsedAngle();let a=((t=r.innerRadius)!==null&&t!==void 0?t:0)-((e=r.innerPadding)!==null&&e!==void 0?e:0),h=((n=r.outerRadius)!==null&&n!==void 0?n:0)-((o=r.outerPadding)!==null&&o!==void 0?o:0);const d=Dt(l-s),u=l>s;if(h<a){const f=h;h=a,a=f}const c=new Ae;if(h<=Kt)c.moveTo(0,0);else if(d>=Vt-Kt)c.moveTo(0+h*ve(s),0+h*ie(s)),c.arc(0,0,h,s,l,!u),a>Kt&&(c.moveTo(0+a*ve(l),0+a*ie(l)),c.arc(0,0,a,l,s,u));else{const f=h*ve(s),g=h*ie(s),p=a*ve(l),v=a*ie(l);c.moveTo(0+f,0+g),c.arc(0,0,h,s,l,!u),c.lineTo(0+p,0+v),c.arc(0,0,a,l,s,u),c.closePath()}return c}clone(){return new Br(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return Br.NOWORK_ANIMATE_ATTR}}Br.NOWORK_ANIMATE_ATTR=Object.assign({cap:1},Vi);function Og(i){return new Br(i)}const Kp=["points","cornerRadius",...Ti];class Ds extends ti{constructor(t){super(t),this.type="polygon",this.numberType=id}isValid(){return super.isValid()&&this._isValid()}_isValid(){const{points:t}=this.attribute;return t&&t.length>=2}getGraphicTheme(){return yt(this).polygon}updateAABBBounds(t,e,n){this.updatePathProxyAABBBounds(n)||this.updatePolygonAABBBoundsImprecise(t,e,n),G.graphicService.updateTempAABBBounds(n);const{lineJoin:o=e.lineJoin}=t;return G.graphicService.transformAABBBounds(t,n,e,o==="miter",this),n}updatePolygonAABBBoundsImprecise(t,e,n){const{points:o=e.points}=t;return o.forEach(r=>{n.add(r.x,r.y)}),n}_interpolate(t,e,n,o,r){t==="points"&&(r.points=vC(n,o,e))}needUpdateTags(t){return super.needUpdateTags(t,Kp)}needUpdateTag(t){return super.needUpdateTag(t,Kp)}toCustomPath(){const t=this.attribute.points,e=new Ae;return t.forEach((n,o)=>{o===0?e.moveTo(n.x,n.y):e.lineTo(n.x,n.y)}),e.closePath(),e}clone(){return new Ds(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return Ds.NOWORK_ANIMATE_ATTR}}Ds.NOWORK_ANIMATE_ATTR=Vi;function SA(i){return new Ds(i)}class xA extends Gi{constructor(t){super({x:0,y:0}),this.type="shadowroot",this.shadowHost=t}clearUpdateBoundTag(){super.clearUpdateBoundTag(),this.shadowHost&&this.shadowHost.clearUpdateBoundTag()}addUpdateBoundTag(){super.addUpdateBoundTag(),this.shadowHost&&this.shadowHost.addUpdateBoundTag()}addUpdateShapeAndBoundsTag(){super.addUpdateShapeAndBoundsTag(),this.shadowHost&&this.shadowHost.addUpdateBoundTag()}tryUpdateGlobalTransMatrix(t=!0){if(this.shouldUpdateGlobalMatrix()){const e=this.transMatrix;this._globalTransMatrix?this._globalTransMatrix.setValue(e.a,e.b,e.c,e.d,e.e,e.f):this._globalTransMatrix=e.clone(),this.doUpdateGlobalMatrix(),t&&this.clearUpdateGlobalPositionTag()}return this._globalTransMatrix}doUpdateGlobalMatrix(){if(this.shadowHost){const t=this.shadowHost.globalTransMatrix;this._globalTransMatrix.multiply(t.a,t.b,t.c,t.d,t.e,t.f)}}tryUpdateGlobalAABBBounds(){return this._globalAABBBounds?this._globalAABBBounds.setValue(this._AABBBounds.x1,this._AABBBounds.y1,this._AABBBounds.x2,this._AABBBounds.y2):this._globalAABBBounds=this._AABBBounds.clone(),this.shadowHost&&this._globalAABBBounds.transformWithMatrix(this.shadowHost.globalTransMatrix),this._globalAABBBounds}}function RA(i){return new xA(i)}var Dg=function(i,t,e,n){var o,r=arguments.length,s=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var l=i.length-1;l>=0;l--)(o=i[l])&&(s=(r<3?o(s):r>3?o(t,e,s):o(t,e))||s);return r>3&&s&&Object.defineProperty(t,e,s),s};const or=Symbol.for("PickItemInterceptor");let ka=class{constructor(){this.order=1}afterPickItem(i,t,e,n,o){return i.attribute.shadowRootIdx>0||!i.attribute.shadowRootIdx?this._pickItem(i,t,e,n,o):null}beforePickItem(i,t,e,n,o){return i.attribute.shadowRootIdx<0?this._pickItem(i,t,e,n,o):null}_pickItem(i,t,e,n,o){var r;if(!i.shadowRoot)return null;const{parentMatrix:s}=o||{};if(!s)return null;const l=t.pickContext;l.highPerformanceSave();const a=(r=yt(i))===null||r===void 0?void 0:r[i.type],{shadowPickMode:h=a==null?void 0:a.shadowPickMode}=i.attribute,d=i.shadowRoot,u=Ze.allocateByObj(s),c=new ye(u.a*e.x+u.c*e.y+u.e,u.b*e.x+u.d*e.y+u.f),f=t.pickGroup(d,c,u,n);return l.highPerformanceRestore(),!f.graphic&&f.group&&h==="full"&&(f.graphic=f.group),f}};ka=Dg([st()],ka);let Ea=class{constructor(){this.order=1}beforePickItem(i,t,e,n,o){const r=i.baseGraphic;if(r&&r.parent){const s=new ye(e.x,e.y),l=t.pickContext;l.highPerformanceSave();const a=r.parent.globalTransMatrix;a.transformPoint(s,s);const h=r.isContainer?t.pickGroup(r,s.clone(),a,n):t.pickItem(r,s.clone(),a,n);return l.highPerformanceRestore(),h}return null}};Ea=Dg([st()],Ea);let La=class{constructor(){this.order=1}beforePickItem(i,t,e,n,o){if(!i.in3dMode||n.in3dInterceptor)return null;const r=t.pickContext,s=i.stage;if(!r||!s)return null;if(n.in3dInterceptor=!0,r.save(),this.initCanvasCtx(r),r.camera=s.camera,i.isContainer){const l=IC(r,i,()=>t.pickGroup(i,e,o.parentMatrix,n),n);return r.camera=null,n.in3dInterceptor=!1,r.restore(),l}return r.restore(),null}initCanvasCtx(i){i.setTransformForCurrent()}};La=Dg([st()],La);const AA=new Ct((i,t,e)=>{e(cr)||(i(fp).toSelf(),i(cr).toService(fp)),i(La).toSelf().inSingletonScope(),i(or).toService(La),i(ka).toSelf().inSingletonScope(),i(or).toService(ka),i(Ea).toSelf().inSingletonScope(),i(or).toService(Ea),Oe(i,or)}),BA=new Ct(i=>{i(wC).to(ju).inSingletonScope(),i(yC).toConstantValue(ft)}),Ws=Symbol.for("AutoEnablePlugins"),jC=Symbol.for("PluginService");var MA=function(i,t,e,n){var o,r=arguments.length,s=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var l=i.length-1;l>=0;l--)(o=i[l])&&(s=(r<3?o(s):r>3?o(t,e,s):o(t,e))||s);return r>3&&s&&Object.defineProperty(t,e,s),s},TA=function(i,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,t)},Yp=function(i,t){return function(e,n){t(e,n,i)}};let lc=class{constructor(i){this.autoEnablePlugins=i,this.onStartupFinishedPlugin=[],this.onRegisterPlugin=[],this.actived=!1}active(i,t){this.stage=i,this.actived=!0;const{pluginList:e}=t;e&&bt.isBound(Ws)&&this.autoEnablePlugins.getContributions().forEach(n=>{e.includes(n.name)&&this.register(n)})}findPluginsByName(i){const t=[];return this.onStartupFinishedPlugin.forEach(e=>{e.name===i&&t.push(e)}),this.onRegisterPlugin.forEach(e=>{e.name===i&&t.push(e)}),t}register(i){i.activeEvent==="onStartupFinished"?this.onStartupFinishedPlugin.push(i):i.activeEvent==="onRegister"&&(this.onRegisterPlugin.push(i),i.activate(this))}unRegister(i){i.activeEvent==="onStartupFinished"?this.onStartupFinishedPlugin.splice(this.onStartupFinishedPlugin.indexOf(i),1):i.activeEvent==="onRegister"&&this.onRegisterPlugin.splice(this.onStartupFinishedPlugin.indexOf(i),1),i.deactivate(this)}release(...i){this.onStartupFinishedPlugin.forEach(t=>{t.deactivate(this)}),this.onStartupFinishedPlugin=[],this.onRegisterPlugin.forEach(t=>{t.deactivate(this)}),this.onRegisterPlugin=[]}};lc=MA([st(),Yp(0,At(ge)),Yp(0,Re(Ws)),TA("design:paramtypes",[Object])],lc);const PA=new Ct(i=>{i(jC).to(lc),jy(i,Ws)}),HA=new Ct(i=>{Oe(i,Xh)}),kA=new Ct(i=>{i(yn).to(wr).inSingletonScope(),Oe(i,yn)});var EA=function(i,t,e,n){var o,r=arguments.length,s=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var l=i.length-1;l>=0;l--)(o=i[l])&&(s=(r<3?o(s):r>3?o(t,e,s):o(t,e))||s);return r>3&&s&&Object.defineProperty(t,e,s),s},LA=function(i,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,t)};let Fa=class{constructor(){this.type="static",this.offscreen=!1,this.global=G.global}setDpr(i){this.canvas.dpr=i}init(i,t,e){if(this.layer=i,this.window=t,e.main)this.main=!0,this.context=t.getContext(),this.canvas=this.context.getCanvas();else{let n;this.main=!1,e.canvasId&&(n=this.global.getElementById(e.canvasId)),n||(n=this.global.createCanvas({width:t.width,height:t.height})),n.style&&(n.style["pointer-events"]="none");const o=t.getContext().getCanvas().nativeCanvas,r=Hu({nativeCanvas:n,width:t.width,height:t.height,dpr:t.dpr,id:e.canvasId,canvasControled:!0,container:t.getContainer(),x:o.offsetLeft,y:o.offsetTop});r.applyPosition(),this.canvas=r,this.context=r.getContext()}}resize(i,t){this.canvas.resize(i,t)}resizeView(i,t){}render(i,t,e){var n;if(!this.main){const o=this.window.getContext().getCanvas().nativeCanvas;!o||this.canvas.x===o.offsetLeft&&this.canvas.y===o.offsetTop||(this.canvas.x=o.offsetLeft,this.canvas.y=o.offsetTop,this.canvas.applyPosition())}t.renderService.render(i,Object.assign(Object.assign({context:this.context,clear:(n=t.background)!==null&&n!==void 0?n:"#ffffff"},t),e))}merge(i){i.forEach(t=>{const e=t.getContext().canvas.nativeCanvas;this.context.drawImage(e,0,0)})}prepare(i,t){}drawTo(i,t,e){var n;const o=i.getContext();e.renderService.render(t,Object.assign(Object.assign({context:o},e),{clear:e.clear?(n=e.background)!==null&&n!==void 0?n:"#fff":void 0}))}getContext(){return this.context}release(){this.canvas.release()}};Fa=EA([st(),LA("design:paramtypes",[])],Fa);const FA=new Ct(i=>{i(Fa).toSelf(),i(AC).toService(Fa)});function zA(i){i.load(HA),i.load(kA),i.load(FA)}var IA=function(i,t,e,n){return new(e||(e=Promise))(function(o,r){function s(h){try{a(n.next(h))}catch(d){r(d)}}function l(h){try{a(n.throw(h))}catch(d){r(d)}}function a(h){var d;h.done?o(h.value):(d=h.value,d instanceof e?d:new e(function(u){u(d)})).then(s,l)}a((n=n.apply(i,t||[])).next())})};function UC(i,t,e){const n={},o=[];return i.forEachChildren(r=>{const{zIndex:s=t}=r.attribute;n[s]?n[s].push(r):(n[s]=[r],o.push(s))},e),o.sort((r,s)=>e?s-r:r-s),{childMap:n,zIdxArray:o}}function $C(i,t,e,n=!1,o=!1){let r=!1;if(o)r=!0;else{let s;i.forEachChildren((l,a)=>{const{zIndex:h=t}=l.attribute;if(a===0)s=h;else if(s!==h)return r=!0,!0;return!1},n)}if(r){const{childMap:s,zIdxArray:l}=UC(i,t,n);let a=!1;for(let h=0;h<l.length&&!a;h++){const d=s[l[h]];o&&d.sort((u,c)=>{var f,g;return(n?-1:1)*(((f=c.attribute.z)!==null&&f!==void 0?f:0)-((g=u.attribute.z)!==null&&g!==void 0?g:0))});for(let u=0;u<d.length;u++)if(e(d[u],u)){a=!0;break}}}else i.forEachChildren(e,n)}function Xp(i,t,e,n=!1){return IA(this,void 0,void 0,function*(){yield i.forEachChildrenAsync(e,n)})}function OA(i,t,e,n=!1){let o=!1;i.forEachChildren((l,a)=>{const{zIndex:h=e}=l.attribute;if(a!==0){if(h!==void 0)return o=!0,!0}return!1},n);let r=null,s=!1;if(o){const{childMap:l,zIdxArray:a}=UC(i,e,n);let h=!1;for(let d=0;d<a.length&&!h;d++){const u=l[a[d]];for(let c=0;c<u.length;c++){if(s){h=!0,r=u[c];break}u[c]._uid!==t||(s=!0)}}}else i.forEachChildren(l=>s?(r=l,!0):(l._uid===t&&(s=!0),!1),n);return r}var DA=function(i,t,e,n){var o,r=arguments.length,s=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var l=i.length-1;l>=0;l--)(o=i[l])&&(s=(r<3?o(s):r>3?o(t,e,s):o(t,e))||s);return r>3&&s&&Object.defineProperty(t,e,s),s},WA=function(i,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,t)},Vd=function(i,t){return function(e,n){t(e,n,i)}};let za=class{constructor(i,t){this.contributions=i,this.drawItemInterceptorContributions=t,this.currentRenderMap=new Map,this.defaultRenderMap=new Map,this.styleRenderMap=new Map,this.dirtyBounds=new Rn,this.backupDirtyBounds=new Rn,this.global=G.global,this.layerService=G.layerService,this.init()}init(){this.contributions.forEach(i=>{if(i.style){const t=this.styleRenderMap.get(i.style)||new Map;t.set(i.numberType,i),this.styleRenderMap.set(i.style,t)}else this.defaultRenderMap.set(i.numberType,i)}),this.InterceptorContributions=this.drawItemInterceptorContributions.getContributions().sort((i,t)=>i.order-t.order)}prepareForDraw(i,t){t.updateBounds?this.useDirtyBounds=!0:this.useDirtyBounds=!t.stage.params.optimize.disableCheckGraphicWidthOutRange}draw(i,t){this.prepareForDraw(i,t),t.drawContribution=this,this.currentRenderMap=this.styleRenderMap.get(t.renderStyle)||this.defaultRenderMap,this.currentRenderService=i;const{context:e,stage:n,viewBox:o,transMatrix:r}=t;if(!e)return;const s=this.dirtyBounds.setValue(0,0,o.width(),o.height());if(n.dirtyBounds&&!n.dirtyBounds.empty()){const a=Fb(s,n.dirtyBounds,!1);s.x1=Math.floor(a.x1),s.y1=Math.floor(a.y1),s.x2=Math.ceil(a.x2),s.y2=Math.ceil(a.y2)}const l=e.dpr%1;(l||l!==.5)&&(s.x1=Math.floor(s.x1*e.dpr)/e.dpr,s.y1=Math.floor(s.y1*e.dpr)/e.dpr,s.x2=Math.ceil(s.x2*e.dpr)/e.dpr,s.y2=Math.ceil(s.y2*e.dpr)/e.dpr),this.backupDirtyBounds.copy(s),e.inuse=!0,e.setClearMatrix(r.a,r.b,r.c,r.d,r.e,r.f),e.clearMatrix(),e.setTransformForCurrent(!0),e.translate(o.x1,o.y1,!0),e.beginPath(),e.rect(s.x1,s.y1,s.width(),s.height()),e.clip(),n.camera&&(this.dirtyBounds.setValue(-1/0,-1/0,1/0,1/0),this.backupDirtyBounds.setValue(-1/0,-1/0,1/0,1/0)),this.clearScreen(i,e,t),e.save(),i.renderTreeRoots.sort((a,h)=>{var d,u;return((d=a.attribute.zIndex)!==null&&d!==void 0?d:re.zIndex)-((u=h.attribute.zIndex)!==null&&u!==void 0?u:re.zIndex)}).forEach(a=>{a.isContainer?this.renderGroup(a,t,Ze.allocate(1,0,0,1,0,0)):this.renderItem(a,t)}),e.restore(),e.setClearMatrix(1,0,0,1,0,0),e.inuse=!1,e.draw()}doRegister(){throw new Error("暂不支持")}_findNextGraphic(i){let t=i.parent,e=i._uid;for(;t;){const n=OA(t,e,re.zIndex);if(n)return n;e=t._uid,t=t.parent}return null}renderGroup(i,t,e,n){if(t.break||i.attribute.visibleAll===!1)return;if(i.incremental&&(t.startAtId==null||t.startAtId===i._uid))return t.break=!0,void this._increaseRender(i,t);if(this.useDirtyBounds&&!Su(i.AABBBounds,this.dirtyBounds,!1))return;let o,r=e;if(this.useDirtyBounds){o=Sa.allocateByObj(this.dirtyBounds);const s=i.transMatrix;r=Ze.allocateByObj(e).multiply(s.a,s.b,s.c,s.d,s.e,s.f),this.dirtyBounds.copy(this.backupDirtyBounds).transformWithMatrix(r.getInverse())}this.renderItem(i,t,{drawingCb:()=>{var s;n?i.forEachChildren(l=>{t.break||(l.isContainer?this.renderGroup(l,t,r):this.renderItem(l,t))}):$C(i,re.zIndex,l=>{t.break||(l.isContainer?this.renderGroup(l,t,r):this.renderItem(l,t))},!1,!!(!((s=t.context)===null||s===void 0)&&s.camera))}}),this.useDirtyBounds&&(this.dirtyBounds.copy(o),Sa.free(o),Ze.free(r))}_increaseRender(i,t){const{layer:e,stage:n}=t,{subLayers:o}=e;let r=o.get(i._uid);r||(r={layer:this.layerService.createLayer(n),zIndex:o.size,group:i},o.set(i._uid,r));const s=r.layer.getNativeHandler().getContext(),l=r.drawContribution||bt.get(zC);l.dirtyBounds.setValue(-1/0,-1/0,1/0,1/0),l.backupDirtyBounds.setValue(-1/0,-1/0,1/0,1/0),l.draw(this.currentRenderService,Object.assign(Object.assign({},t),{drawContribution:l,clear:"transparent",layer:r.layer,context:s,startAtId:i._uid,break:!1})),r.drawContribution=l;const a=this._findNextGraphic(i);if(a)if(a.isContainer&&a.incremental)this._increaseRender(a,t);else{let h=o.get(a._uid);h||(h={layer:this.layerService.createLayer(n),zIndex:o.size},o.set(a._uid,h));const d=h.layer.getNativeHandler().getContext();this.draw(this.currentRenderService,Object.assign(Object.assign({},t),{drawContribution:l,clear:"transparent",layer:h.layer,context:d,startAtId:a._uid,break:!1}))}}getRenderContribution(i){let t;return t||(t=this.selectRenderByNumberType(i.numberType,i)),t||(t=this.selectRenderByType(i.type)),t}renderItem(i,t,e){if(this.InterceptorContributions.length)for(let l=0;l<this.InterceptorContributions.length;l++){const a=this.InterceptorContributions[l];if(a.beforeDrawItem&&a.beforeDrawItem(i,this.currentRenderService,t,this,e))return}const n=this.getRenderContribution(i);if(!n)return;let o,r=this.scrollMatrix&&(this.scrollMatrix.e!==0||this.scrollMatrix.f!==0);if(i.parent){const{scrollX:l=0,scrollY:a=0}=i.parent.attribute;(l||a)&&(r=!0,this.scrollMatrix||(this.scrollMatrix=Ze.allocate(1,0,0,1,0,0)),this.scrollMatrix.translate(-l,-a))}if(r&&(o=this.dirtyBounds.clone().transformWithMatrix(this.scrollMatrix)),this.useDirtyBounds&&!i.isContainer&&!Su(i.AABBBounds,o??this.dirtyBounds,!1)){if(r&&i.parent){const{scrollX:l=0,scrollY:a=0}=i.parent.attribute;this.scrollMatrix&&this.scrollMatrix.translate(l,a)}return}const s=t.startAtId!=null&&i._uid!==t.startAtId;if(i._uid===t.startAtId&&(t.startAtId=null),e&&(e.skipDraw=s),s?i.isContainer&&n.draw(i,this.currentRenderService,t,e):n.draw(i,this.currentRenderService,t,e),r&&i.parent){const{scrollX:l=0,scrollY:a=0}=i.parent.attribute;this.scrollMatrix&&this.scrollMatrix.translate(l,a)}if(this.InterceptorContributions.length)for(let l=0;l<this.InterceptorContributions.length;l++){const a=this.InterceptorContributions[l];if(a.afterDrawItem&&a.afterDrawItem(i,this.currentRenderService,t,this))return}}selectRenderByType(i){return ze.getInstance().warn("未知错误，不应该走到这里"),null}selectRenderByNumberType(i,t){let e;if(t.attribute.renderStyle){const n=this.styleRenderMap.get(t.attribute.renderStyle);e=n&&n.get(i)}return e||this.currentRenderMap.get(i)||this.defaultRenderMap.get(i)}clearScreen(i,t,e){var n,o;const{clear:r,viewBox:s}=e,l=s.width(),a=s.height();if(r){t.clearRect(0,0,l,a);const h=(n=i.drawParams)===null||n===void 0?void 0:n.stage;if(h&&(t.globalAlpha=(o=h.attribute.opacity)!==null&&o!==void 0?o:1),h&&h.backgroundImg&&h.resources){const d=h.resources.get(r);d&&d.state==="success"&&d.data&&t.drawImage(d.data,0,0,l,a)}else t.fillStyle=ha(t,r,{AABBBounds:{x1:0,y1:0,x2:0+l,y2:0+a}},0,0),t.fillRect(0,0,l,a)}}afterDraw(i,t){}};za=DA([st(),Vd(0,Kb($e)),Vd(1,At(ge)),Vd(1,Re(Fs)),WA("design:paramtypes",[Array,Object])],za);var NA=function(i,t,e,n){var o,r=arguments.length,s=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var l=i.length-1;l>=0;l--)(o=i[l])&&(s=(r<3?o(s):r>3?o(t,e,s):o(t,e))||s);return r>3&&s&&Object.defineProperty(t,e,s),s};let Ia=class extends Ls{constructor(){super(...arguments),this.numberType=nl}drawShape(i,t,e,n,o,r,s,l){if(i.incremental&&o.multiGraphicOptions){const{startAtIdx:a,length:h}=o.multiGraphicOptions,{segments:d=[]}=i.attribute;if(a>d.length)return;const u=yt(i).line,{fill:c=u.fill,stroke:f=u.stroke,opacity:g=u.opacity,fillOpacity:p=u.fillOpacity,strokeOpacity:v=u.strokeOpacity,lineWidth:m=u.lineWidth,visible:b=u.visible}=i.attribute,C=Ho(g,p,c),_=kg(g,v),w=zr(c),y=ol(f,m);if(!i.valid||!b||!w&&!y||!(C||_||s||l))return;const{context:x}=o;for(let S=a;S<a+h;S++)this.drawIncreaseSegment(i,x,d[S-1],d[S],i.attribute.segments[S],[u,i.attribute],e,n)}else super.drawShape(i,t,e,n,o,r,s,l)}drawIncreaseSegment(i,t,e,n,o,r,s,l){n&&(t.beginPath(),Px(t.nativeContext,e,n,{offsetX:s,offsetY:l}),t.setShadowBlendStyle&&t.setShadowBlendStyle(i,o,r),t.setStrokeStyle(i,o,s,l,r),t.stroke())}};Ia=NA([st()],Ia);var VA=function(i,t,e,n){var o,r=arguments.length,s=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var l=i.length-1;l>=0;l--)(o=i[l])&&(s=(r<3?o(s):r>3?o(t,e,s):o(t,e))||s);return r>3&&s&&Object.defineProperty(t,e,s),s};let ac=class extends $u{constructor(){super(...arguments),this.numberType=_C}drawShape(i,t,e,n,o,r,s){if(i.incremental&&o.multiGraphicOptions){const{startAtIdx:l,length:a}=o.multiGraphicOptions,{segments:h=[]}=i.attribute;if(l>h.length)return;const d=yt(i).area,{fill:u=d.fill,fillOpacity:c=d.fillOpacity,opacity:f=d.opacity,visible:g=d.visible}=i.attribute,p=Ho(f,c,u),v=zr(u);if(!i.valid||!g||!v||!p&&!s)return;for(let m=l;m<l+a;m++)this.drawIncreaseSegment(i,t,h[m-1],h[m],i.attribute.segments[m],[d,i.attribute],e,n)}else super.drawShape(i,t,e,n,o,r,s)}drawIncreaseSegment(i,t,e,n,o,r,s,l){n&&(t.beginPath(),Hx(t.camera?t:t.nativeContext,e,n,{offsetX:s,offsetY:l}),t.setShadowBlendStyle&&t.setShadowBlendStyle(i,o,r),t.setCommonStyle(i,o,s,l,r),t.fill())}};ac=VA([st()],ac);var rr,GA=function(i,t,e,n){var o,r=arguments.length,s=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var l=i.length-1;l>=0;l--)(o=i[l])&&(s=(r<3?o(s):r>3?o(t,e,s):o(t,e))||s);return r>3&&s&&Object.defineProperty(t,e,s),s},jA=function(i,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,t)},Jr=function(i,t){return function(e,n){t(e,n,i)}},$i=function(i,t,e,n){return new(e||(e=Promise))(function(o,r){function s(h){try{a(n.next(h))}catch(d){r(d)}}function l(h){try{a(n.throw(h))}catch(d){r(d)}}function a(h){var d;h.done?o(h.value):(d=h.value,d instanceof e?d:new e(function(u){u(d)})).then(s,l)}a((n=n.apply(i,t||[])).next())})};(function(i){i[i.NORMAL=0]="NORMAL",i[i.STOP=1]="STOP"})(rr||(rr={}));let hc=class extends za{constructor(i,t,e,n){super(i,n),this.contributions=i,this.lineRender=t,this.areaRender=e,this.drawItemInterceptorContributions=n,this.rendering=!1,this.currFrameStartAt=0,this.currentIdx=0,this.status=rr.NORMAL,this.checkingForDrawPromise=null,this.hooks={completeDraw:new Xe([])},this.defaultRenderMap.set(this.lineRender.numberType,this.lineRender),this.defaultRenderMap.set(this.areaRender.numberType,this.areaRender)}draw(i,t){return $i(this,void 0,void 0,function*(){if(this.checkingForDrawPromise)return;this.lastRenderService=i,this.lastDrawContext=t,this.checkingForDrawPromise=this.checkForDraw(t);const e=yield this.checkingForDrawPromise;if(this.checkingForDrawPromise=null,e)return;this.currentRenderService=i;const{context:n,viewBox:o}=t;n&&(n.inuse=!0,n.clearMatrix(),n.setTransformForCurrent(!0),n.save(),t.restartIncremental&&this.clearScreen(this.currentRenderService,n,t),n.translate(o.x1,o.y1,!0),n.save(),i.renderTreeRoots.sort((r,s)=>{var l,a;return((l=r.attribute.zIndex)!==null&&l!==void 0?l:re.zIndex)-((a=s.attribute.zIndex)!==null&&a!==void 0?a:re.zIndex)}).forEach(r=>{this.renderGroup(r,t)}),this.hooks.completeDraw.tap("top-draw",()=>{n.restore(),n.restore(),n.draw(),n.inuse=!1,this.rendering=!1}))})}_increaseRender(i,t){return $i(this,void 0,void 0,function*(){this.rendering=!0,yield this._renderIncrementalGroup(i,t)})}_renderIncrementalGroup(i,t){return $i(this,void 0,void 0,function*(){this.count=i.count,yield new Promise(e=>{this.renderItem(i,t,{drawingCb:()=>$i(this,void 0,void 0,function*(){if(i.count!==2)yield Xp(i,re.zIndex,(n,o)=>{if(this.status===rr.STOP)return!0;if(n.isContainer||o<this.currentIdx)return!1;const r=this.currFrameStartAt+i.incremental;return o<r&&(this.currentIdx=o+1,this.renderItem(n,t)),o===r-1&&(this.currFrameStartAt=this.currentIdx,this.waitToNextFrame())}),e(!1);else{const n=i.getChildAt(0);if(n.incremental&&n.attribute.segments)for(n.incrementalAt||(n.incrementalAt=0);n.incrementalAt<n.attribute.segments.length;)t.multiGraphicOptions={startAtIdx:n.incrementalAt,length:n.incremental},this.renderItem(n,t),n.incrementalAt+=n.incremental,yield this.waitToNextFrame();else this.renderItem(n,t);e(!1)}})})}),this.hooks.completeDraw.call()})}waitToNextFrame(){return $i(this,void 0,void 0,function*(){return new Promise(i=>{this.global.getRequestAnimationFrame()(()=>{i(!1)})})})}checkForDraw(i){return $i(this,void 0,void 0,function*(){let t=this.rendering;return i.restartIncremental&&(t=!1,yield this.forceStop(),this.resetToInit()),t})}forceStop(){return $i(this,void 0,void 0,function*(){this.rendering&&(this.status=rr.STOP,yield new Promise(i=>{this.hooks.completeDraw.tap("stopCb",()=>{this.status=rr.NORMAL,this.hooks.completeDraw.taps=this.hooks.completeDraw.taps.filter(t=>t.name!=="stopCb"),i(!1)})}))})}resetToInit(){this.currFrameStartAt=0,this.currentIdx=0}renderGroup(i,t){return $i(this,void 0,void 0,function*(){if(!t.break&&i.attribute.visibleAll!==!1)return i.incremental&&t.startAtId===i._uid?(yield this._increaseRender(i,t),void(t.break=!0)):void(yield new Promise(e=>{this.renderItem(i,t,{drawingCb:()=>$i(this,void 0,void 0,function*(){yield Xp(i,re.zIndex,n=>$i(this,void 0,void 0,function*(){t.break||n.isContainer&&(yield this.renderGroup(n,t))})),e(!1)})})}))})}};hc=GA([st(),Jr(0,Kb($e)),Jr(1,At(Ia)),Jr(2,At(ac)),Jr(3,At(ge)),Jr(3,Re(Fs)),jA("design:paramtypes",[Array,Object,Object,Object])],hc);const UA=new Ct(i=>{i(rd).toSelf().inSingletonScope(),i(Fg).toSelf().inSingletonScope(),i(zg).to(za),i(zC).to(hc),i(dp).to(Xu).inSingletonScope(),i($e).toService(dp),Oe(i,ki),i(Oi).toSelf().inSingletonScope(),Oe(i,Eg),Oe(i,$e),i(Ha).toSelf().inSingletonScope(),i(Fs).toService(Ha),Oe(i,Fs)});function $A(i){i.load(UA)}function Ns(){Ns.__loaded||(Ns.__loaded=!0,bt.load(VS),bt.load(BA),bt.load(vR),bt.load(AA),bt.load(PA),zA(bt),$A(bt))}Ns.__loaded=!1,Ns();const Qt=bt.get(_g);G.global=Qt;const KA=bt.get(RC);G.graphicUtil=KA;const YA=bt.get(xC);G.transformUtil=YA;const XA=bt.get(wC);G.graphicService=XA;const qA=bt.get(Hg);G.layerService=qA;class ZA{constructor(){this.name="AutoRenderPlugin",this.activeEvent="onRegister",this._uid=fe.GenAutoIncrementId(),this.key=this.name+this._uid,this.handleChange=t=>{t.glyphHost&&(t=t.glyphHost),t.stage===this.pluginService.stage&&t.stage!=null&&t.stage.renderNextFrame()}}activate(t){this.pluginService=t,G.graphicService.hooks.onAttributeUpdate.tap(this.key,this.handleChange),G.graphicService.hooks.onSetStage.tap(this.key,this.handleChange),G.graphicService.hooks.onRemove.tap(this.key,this.handleChange)}deactivate(t){const e=n=>n.filter(o=>o.name!==this.key);G.graphicService.hooks.onAttributeUpdate.taps=e(G.graphicService.hooks.onAttributeUpdate.taps),G.graphicService.hooks.onSetStage.taps=e(G.graphicService.hooks.onSetStage.taps),G.graphicService.hooks.onRemove.taps=e(G.graphicService.hooks.onRemove.taps)}}class JA{constructor(){this.name="AutoRefreshPlugin",this.activeEvent="onRegister",this._uid=fe.GenAutoIncrementId(),this.key=this.name+this._uid,this.handleChange=t=>{t.glyphHost&&(t=t.glyphHost),t.stage===this.pluginService.stage&&t.stage!=null&&t.stage.renderNextFrame()}}activate(t){this.pluginService=t,this.dpr=G.global.devicePixelRatio,this.refresh()}refresh(){this._refreshByMediaQuery()||this._refreshByRaf()}_refreshByRaf(){const t=G.global.getRequestAnimationFrame();this.rafId=t(()=>{G.global.devicePixelRatio!==this.dpr&&(this.dpr=G.global.devicePixelRatio,this.pluginService.stage.setDpr(this.dpr,!0)),this.refresh()})}_refreshByMediaQuery(){try{const t=`(resolution: ${window.devicePixelRatio}dppx)`,e=()=>{window.devicePixelRatio!==this.dpr&&(this.dpr=window.devicePixelRatio,this.pluginService.stage.setDpr(this.dpr,!0))};matchMedia(t).addEventListener("change",e)}catch{return!1}return!0}deactivate(t){const e=G.global.getCancelAnimationFrame();e&&this.rafId&&e(this.rafId)}}class QA{constructor(){this.name="IncrementalAutoRenderPlugin",this.activeEvent="onRegister",this.nextFrameRenderGroupSet=new Set,this.willNextFrameRender=!1,this.nextUserParams={},this._uid=fe.GenAutoIncrementId(),this.key=this.name+this._uid}activate(t){this.pluginService=t,G.graphicService.hooks.onAddIncremental.tap(this.key,(e,n,o)=>{e.glyphHost&&(e=e.glyphHost),e.stage===t.stage&&e.stage!=null&&(this.nextUserParams.startAtId=n._uid,this.renderNextFrame(n))}),G.graphicService.hooks.onClearIncremental.tap(this.key,(e,n)=>{e.stage===t.stage&&e.stage!=null&&(this.nextUserParams.startAtId=e._uid,this.nextUserParams.restartIncremental=!0,this.renderNextFrame(e))})}deactivate(t){G.graphicService.hooks.onAddIncremental.taps=G.graphicService.hooks.onAddIncremental.taps.filter(e=>e.name!==this.key),G.graphicService.hooks.onClearIncremental.taps=G.graphicService.hooks.onClearIncremental.taps.filter(e=>e.name!==this.key)}renderNextFrame(t){this.nextFrameRenderGroupSet.add(t),this.willNextFrameRender||(this.willNextFrameRender=!0,G.global.getRequestAnimationFrame()(()=>{this._doRenderInThisFrame(),this.willNextFrameRender=!1}))}_doRenderInThisFrame(){const t=this.pluginService.stage;this.nextFrameRenderGroupSet.size&&(this.nextFrameRenderGroupSet.forEach(e=>{const n=e.layer;if(!n||!e.layer.subLayers)return;const o=e.layer.subLayers.get(e._uid);o&&o.drawContribution&&o.drawContribution.draw(t.renderService,Object.assign({stage:t,layer:n,viewBox:t.window.getViewBox(),transMatrix:t.window.getViewBoxTransform(),clear:"transparent",renderService:t.renderService,updateBounds:!1,startAtId:e._uid,context:o.layer.getNativeHandler().getContext()},this.nextUserParams))}),this.nextUserParams={},this.nextFrameRenderGroupSet.clear())}}const qp=new Gt;class tB{constructor(){this.name="DirtyBoundsPlugin",this.activeEvent="onRegister",this._uid=fe.GenAutoIncrementId(),this.key=this.name+this._uid}activate(t){this.pluginService=t,t.stage.hooks.afterRender.tap(this.key,e=>{e&&e===this.pluginService.stage&&e.dirtyBounds.clear()}),G.graphicService.hooks.beforeUpdateAABBBounds.tap(this.key,(e,n,o,r)=>{e.glyphHost&&(e=e.glyphHost),n&&n===this.pluginService.stage&&n.renderCount&&(e.isContainer&&!e.shouldSelfChangeUpdateAABBBounds()||o&&(qp.setValue(r.x1,r.y1,r.x2,r.y2),n.dirty(qp,e.parent&&e.parent.globalTransMatrix)))}),G.graphicService.hooks.afterUpdateAABBBounds.tap(this.key,(e,n,o,r,s)=>{n&&n===this.pluginService.stage&&n.renderCount&&(e.isContainer&&!s||n.dirty(r.globalAABBBounds))}),G.graphicService.hooks.clearAABBBounds.tap(this.key,(e,n,o)=>{n&&n===this.pluginService.stage&&n.renderCount&&n&&n.dirty(o)}),G.graphicService.hooks.onRemove.tap(this.key,e=>{const n=e.stage;n&&n===this.pluginService.stage&&n.renderCount&&n&&n.dirty(e.globalAABBBounds)})}deactivate(t){G.graphicService.hooks.beforeUpdateAABBBounds.taps=G.graphicService.hooks.beforeUpdateAABBBounds.taps.filter(e=>e.name!==this.key),G.graphicService.hooks.afterUpdateAABBBounds.taps=G.graphicService.hooks.afterUpdateAABBBounds.taps.filter(e=>e.name!==this.key),G.graphicService.hooks.clearAABBBounds.taps=G.graphicService.hooks.clearAABBBounds.taps.filter(e=>e.name!==this.key),t.stage.hooks.afterRender.taps=t.stage.hooks.afterRender.taps.filter(e=>e.name!==this.key),G.graphicService.hooks.onRemove.taps=G.graphicService.hooks.onRemove.taps.filter(e=>e.name!==this.key)}}const Wg=new gC;Wg.addTimeline(fC);Wg.setFPS(60);let mo;function KC(){if(mo==null)try{const i=document.createElement("canvas"),t=i.getContext("2d");mo=!!(window&&i.getBoundingClientRect&&requestAnimationFrame&&window.devicePixelRatio&&t&&t.isPointInPath&&t.isPointInStroke),mo&&(mo=!!document.createElement)}catch{mo=!1}}function Ng(){KC();const i=G.global&&G.global.env;return i?i==="browser":mo}function eB(){KC();const i=G.global&&G.global.env;return i?i==="node":!mo}let Nn=class dc{static registerPlugin(t,e){dc._pluginClasses[t]=e}static getPlugin(t){return dc._pluginClasses[t]}};Nn._pluginClasses={};const Zp={BACKGROUND:"white"};class iB extends Gi{set viewBox(t){this.window.setViewBox(t)}get viewBox(){return this.window.getViewBox()}get x(){return this.window.getViewBox().x1}set x(t){const e=this.window.getViewBox();e.translate(t-e.x1,0),this.window.setViewBox(e)}get y(){return this.window.getViewBox().y1}set y(t){const e=this.window.getViewBox();e.translate(0,t-e.y1),this.window.setViewBox(e)}get width(){return this.window.width}set width(t){this.resize(t,this.height)}get viewWidth(){return this.window.getViewBox().width()}set viewWidth(t){this.resizeView(t,this.viewHeight)}get viewHeight(){return this.window.getViewBox().height()}set viewHeight(t){this.resizeView(this.viewWidth,t)}get height(){return this.window.height}set height(t){this.resize(this.width,t)}get dpr(){return this.window.dpr}set dpr(t){this.setDpr(t)}get background(){var t;return(t=this._background)!==null&&t!==void 0?t:Zp.BACKGROUND}set background(t){this._background=t}get defaultLayer(){return this.at(0)}get eventSystem(){return this._eventSystem}constructor(t={}){var e;super({}),this.tickedBeforeRender=!0,this._onVisibleChange=n=>{if(!(this._skipRender<0))if(n){if(this.dirtyBounds){const o=this.window.getViewBox();this.dirtyBounds.setValue(o.x1,o.y1,o.width(),o.height())}this._skipRender>1&&this.renderNextFrame(),this._skipRender=0}else this._skipRender=1},this.beforeRender=n=>{this._beforeRender&&this._beforeRender(n)},this.afterRender=n=>{this.renderCount++,this._afterRender&&this._afterRender(n),this._afterNextRenderCbs&&this._afterNextRenderCbs.forEach(o=>o(n)),this._afterNextRenderCbs=null,this.tickedBeforeRender=!1},this.afterTickCb=()=>{var n;this.tickedBeforeRender=!0,((n=this.params.optimize)===null||n===void 0?void 0:n.tickRenderMode)==="performance"||this.state!=="rendering"&&this.render()},this.params=t,this.theme=new ks,this.hooks={beforeRender:new Xe(["stage"]),afterRender:new Xe(["stage"])},this.global=G.global,!this.global.env&&Ng()&&this.global.setEnv("browser"),this.window=bt.get(Hs),this.renderService=bt.get(OC),this.pluginService=bt.get(jC),this.layerService=bt.get(Hg),this.pluginService.active(this,t),this.window.create({width:t.width,height:t.height,viewBox:t.viewBox,container:t.container,dpr:t.dpr||this.global.devicePixelRatio,canvasControled:t.canvasControled!==!1,title:t.title||"",canvas:t.canvas}),this.state="normal",this.renderCount=0,this.tryInitEventSystem(),this._background=(e=t.background)!==null&&e!==void 0?e:Zp.BACKGROUND,this.appendChild(this.layerService.createLayer(this,{main:!0})),this.nextFrameRenderLayerSet=new Set,this.willNextFrameRender=!1,this.stage=this,this.renderStyle=t.renderStyle,t.autoRender&&this.enableAutoRender(),t.autoRefresh&&this.enableAutoRefresh(),t.disableDirtyBounds===!1&&this.enableDirtyBounds(),t.enableHtmlAttribute&&this.enableHtmlAttribute(t.enableHtmlAttribute),t.ReactDOM&&this.enableReactAttribute(t.ReactDOM),t.enableLayout&&this.enableLayout(),this.hooks.beforeRender.tap("constructor",this.beforeRender),this.hooks.afterRender.tap("constructor",this.afterRender),this._beforeRender=t.beforeRender,this._afterRender=t.afterRender,this.ticker=t.ticker||Wg,this.supportInteractiveLayer=t.interactiveLayer!==!1,this.timeline=new Ag,this.ticker.addTimeline(this.timeline),this.timeline.pause(),t.optimize||(t.optimize={}),this.optmize(t.optimize),t.background&&jt(this._background)&&this._background.includes("/")&&this.setAttributes({background:this._background}),this.ticker.on("afterTick",this.afterTickCb)}pauseRender(t=-1){this._skipRender=t}resumeRender(){this._skipRender=0}tryInitEventSystem(){this.global.supportEvent&&!this._eventSystem&&(this._eventSystem=new hS(Object.assign({targetElement:this.window,resolution:this.window.dpr||this.global.devicePixelRatio,rootNode:this,global:this.global,supportsPointerEvents:this.params.supportsPointerEvents,supportsTouchEvents:this.params.supportsTouchEvents},this.params.event)))}preventRender(t){t?this._skipRender=-1/0:this.params.optimize.skipRenderWithOutRange!==!1?this._skipRender=this.window.isVisible()?0:1:this._skipRender=0}optmize(t){this.optmizeRender(t.skipRenderWithOutRange),this.params.optimize=t}optmizeRender(t=!1){t&&(this._skipRender=this._skipRender<0?this._skipRender:this.window.isVisible()?0:1,this.window.onVisibleChange(this._onVisibleChange))}getTimeline(){return this.timeline}get3dOptions(t){const{center:e={x:this.width/2,y:this.height/2,z:0,dx:0,dy:0,dz:0},light:n={},alpha:o=0,beta:r=0,camera:s,fieldRatio:l=1,fieldDepth:a}=t;return Object.assign(Object.assign({},t),{center:e,light:n,alpha:o,beta:r,camera:s,fieldRatio:l,fieldDepth:a})}set3dOptions(t){var e,n,o,r,s,l;this.option3d=t;const a=this.get3dOptions(t),{light:h,center:d,camera:u,alpha:c,beta:f,fieldRatio:g,fieldDepth:p}=a,{dir:v=[1,1,-1],color:m="white",ambient:b}=h,C=((e=d.x)!==null&&e!==void 0?e:this.width/2)+((n=d.dx)!==null&&n!==void 0?n:0),_=((o=d.y)!==null&&o!==void 0?o:this.height/2)+((r=d.dy)!==null&&r!==void 0?r:0),w=[C,_,((s=d.z)!==null&&s!==void 0?s:0)+((l=d.dz)!==null&&l!==void 0?l:0)];let y=0,x=0,S=0;u||(y=Math.sin(c)+C,x=Math.sin(f)+_,S=Math.cos(c)*Math.cos(f)*1);const R=Nn.getPlugin("DirectionalLight");R&&(this.light=new R(v,m,b));const B={left:0,right:this.width,top:0,bottom:this.height,fieldRatio:g,fieldDepth:p,viewParams:{pos:[y,x,S],center:w,up:[0,1,0]}};if(this.camera)this.camera.params=B;else{const A=Nn.getPlugin("OrthoCamera");A&&(this.camera=new A(B))}t.enableView3dTransform&&this.enableView3dTransform()}setBeforeRender(t){this._beforeRender=t}setAfterRender(t){this._afterRender=t}afterNextRender(t){this._afterNextRenderCbs||(this._afterNextRenderCbs=[]),this._afterNextRenderCbs.push(t)}enableView3dTransform(){if(this.view3dTranform)return;this.view3dTranform=!0;const t=Nn.getPlugin("ViewTransform3dPlugin");t&&this.pluginService.register(new t)}disableView3dTranform(){this.view3dTranform&&(this.view3dTranform=!1,this.pluginService.findPluginsByName("ViewTransform3dPlugin").forEach(t=>{this.pluginService.unRegister(t)}))}enableAutoRender(){this.autoRender||(this.autoRender=!0,this.pluginService.register(new ZA))}disableAutoRender(){this.autoRender&&(this.autoRender=!1,this.pluginService.findPluginsByName("AutoRenderPlugin").forEach(t=>{this.pluginService.unRegister(t)}))}enableAutoRefresh(){this.autoRefresh||(this.autoRefresh=!0,this.pluginService.register(new JA))}disableAutoRefresh(){this.autoRefresh&&(this.autoRefresh=!1,this.pluginService.findPluginsByName("AutoRefreshPlugin").forEach(t=>{this.pluginService.unRegister(t)}))}enableIncrementalAutoRender(){this.increaseAutoRender||(this.increaseAutoRender=!0,this.pluginService.register(new QA))}disableIncrementalAutoRender(){this.increaseAutoRender&&(this.increaseAutoRender=!1,this.pluginService.findPluginsByName("IncrementalAutoRenderPlugin").forEach(t=>{this.pluginService.unRegister(t)}))}enableDirtyBounds(){if(this.dirtyBounds)return;this.dirtyBounds=new Rn;let t=this.pluginService.findPluginsByName("DirtyBoundsPlugin")[0];t?t.activate(this.pluginService):(t=new tB,this.pluginService.register(t))}disableDirtyBounds(){this.dirtyBounds&&(this.dirtyBounds=null,this.pluginService.findPluginsByName("DirtyBoundsPlugin").forEach(t=>{this.pluginService.unRegister(t)}))}enableLayout(){if(this._enableLayout)return;this._enableLayout=!0;const t=Nn.getPlugin("FlexLayoutPlugin");t&&this.pluginService.register(new t)}disableLayout(){this._enableLayout&&(this._enableLayout=!1,this.pluginService.findPluginsByName("FlexLayoutPlugin").forEach(t=>{this.pluginService.unRegister(t)}))}enableHtmlAttribute(t){if(this.htmlAttribute)return;const e=Nn.getPlugin("HtmlAttributePlugin");e&&(this.htmlAttribute=t,this.pluginService.register(new e))}disableHtmlAttribute(){this.htmlAttribute&&(this.htmlAttribute=!1,this.pluginService.findPluginsByName("HtmlAttributePlugin").forEach(t=>{this.pluginService.unRegister(t)}))}enableReactAttribute(t){if(this.reactAttribute)return;const e=Nn.getPlugin("ReactAttributePlugin");e&&(this.reactAttribute=t,this.pluginService.register(new e))}disableReactAttribute(){this.reactAttribute&&(this.reactAttribute=!1,this.pluginService.findPluginsByName("ReactAttributePlugin").forEach(t=>{this.pluginService.unRegister(t)}))}getPluginsByName(t){return this.pluginService.findPluginsByName(t)}tryUpdateAABBBounds(){const t=this.window.getViewBox();return this._AABBBounds.setValue(t.x1,t.y1,t.x2,t.y2),this._AABBBounds}combineLayer(t,e){throw new Error("暂不支持")}createLayer(t,e){if(this.releaseStatus==="released")return;const n=this.layerService.createLayer(this,{main:!1,layerMode:e,canvasId:t});return this.appendChild(n),n}sortLayer(t){const e=this.children;e.sort(t),this.removeAllChild(),e.forEach(n=>{this.appendChild(n)})}removeLayer(t){return this.removeChild(this.findChildByUid(t))}tryInitInteractiveLayer(){this.releaseStatus!=="released"&&this.supportInteractiveLayer&&!this.interactiveLayer&&(this.interactiveLayer=this.createLayer(),this.interactiveLayer.name="_builtin_interactive",this.interactiveLayer.attribute.pickable=!1,this.nextFrameRenderLayerSet.add(this.interactiveLayer))}clearViewBox(t){this.window.clearViewBox(t)}render(t,e){if(this.releaseStatus==="released")return;this.ticker.start(),this.timeline.resume();const n=this.state;this.state="rendering",this.tickedBeforeRender||this.ticker.trySyncTickStatus(),this.layerService.prepareStageLayer(this),this._skipRender||(this.lastRenderparams=e,this.hooks.beforeRender.call(this),this._skipRender||(this.renderLayerList(this.children),this.combineLayersToWindow(),this.nextFrameRenderLayerSet.clear()),this.hooks.afterRender.call(this)),this.state=n,this._skipRender&&this._skipRender++}combineLayersToWindow(){if(this.global.env==="harmony"){const t=this.window.getContext().nativeContext;this.forEachChildren((e,n)=>{if(n>0){const o=e.getNativeHandler().getContext().canvas.nativeCanvas.nativeCanvas._c.transferToImageBitmap();t.transferFromImageBitmap(o)}})}}renderNextFrame(t,e){this.nextFrameRenderLayerSet.size!==this.childrenCount&&(t||this).forEach(n=>{this.nextFrameRenderLayerSet.add(n)}),this.willNextFrameRender||(this.willNextFrameRender=!0,this.global.getRequestAnimationFrame()(()=>{this._doRenderInThisFrame(),this.willNextFrameRender=!1}))}_doRenderInThisFrame(){if(this.releaseStatus==="released")return;this.timeline.resume(),this.ticker.start();const t=this.state;this.state="rendering",this.layerService.prepareStageLayer(this),this.nextFrameRenderLayerSet.size&&!this._skipRender&&(this.hooks.beforeRender.call(this),this._skipRender||(this.renderLayerList(Array.from(this.nextFrameRenderLayerSet.values()),this.lastRenderparams||{}),this.combineLayersToWindow(),this.nextFrameRenderLayerSet.clear()),this.hooks.afterRender.call(this)),this.state=t,this._skipRender&&this._skipRender++}renderLayerList(t,e){const n=[];for(let o=0;o<t.length;o++){let r=t[o];r.layerMode==="virtual"&&(r=r.getNativeHandler().mainHandler.layer),n.includes(r)||n.push(r)}n.forEach(o=>{o.renderCount>this.renderCount||(o.renderCount=this.renderCount+1,o===this.interactiveLayer&&this.dirtyBounds&&this.dirtyBounds.clear(),o.render({renderService:this.renderService,background:o===this.defaultLayer?this.background:void 0,updateBounds:!(!this.dirtyBounds||this.dirtyBounds.empty()),viewBox:this.window.getViewBox(),transMatrix:this.window.getViewBoxTransform()},Object.assign({renderStyle:this.renderStyle},e)))}),this.interactiveLayer&&!t.includes(this.interactiveLayer)&&(this.dirtyBounds&&this.dirtyBounds.clear(),this.interactiveLayer.render({renderService:this.renderService,updateBounds:!(!this.dirtyBounds||this.dirtyBounds.empty()),viewBox:this.window.getViewBox(),transMatrix:this.window.getViewBoxTransform()},Object.assign({renderStyle:this.renderStyle},e)))}resizeWindow(t,e,n=!0){this.window.resize(t,e),n&&this.render()}resize(t,e,n=!0){this.releaseStatus!=="released"&&(this.window.hasSubView()||this.viewBox.setValue(this.viewBox.x1,this.viewBox.y1,this.viewBox.x1+t,this.viewBox.y1+e),this.window.resize(t,e),this.forEachChildren(o=>{o.resize(t,e)}),this.camera&&this.option3d&&this.set3dOptions(this.option3d),n&&this.render())}resizeView(t,e,n=!0){this.releaseStatus!=="released"&&(this.viewBox.setValue(this.viewBox.x1,this.viewBox.y1,this.viewBox.x1+t,this.viewBox.y1+e),this.forEachChildren(o=>{o.resizeView(t,e)}),this.camera&&(this.camera.params=Object.assign(Object.assign({},this.camera.params),{right:this.width,bottom:this.height})),n&&this.render())}setViewBox(t,e,n,o,r){let s=!0;typeof t=="object"?(this.viewBox.setValue(t.x1,t.y1,t.x2,t.y2),e===!1&&(s=!1)):(this.viewBox.setValue(t,e,t+n,e+o),r===!1&&(s=!1)),this.forEachChildren(l=>{l.resizeView(this.viewBox.width(),this.viewBox.height())}),s&&this.render()}setDpr(t,e=!0){this.forEachChildren(n=>{n.setDpr(t)}),e&&this.render()}setOrigin(t,e){throw new Error("暂不支持")}export(t){throw new Error("暂不支持")}pick(t,e){if(this.releaseStatus==="released")return;const n=this.getPickerService().pick(this.children,new ye(t,e),{bounds:this.AABBBounds});return!(!(n!=null&&n.graphic)&&!(n!=null&&n.group))&&n}startAnimate(t){throw new Error("暂不支持")}setToFrame(t){throw new Error("暂不支持")}release(){super.release(),this.hooks.beforeRender.unTap("constructor",this.beforeRender),this.hooks.afterRender.unTap("constructor",this.afterRender),this.eventSystem&&this.eventSystem.release(),this.layerService.releaseStage(this),this.pluginService.release(),this.forEach(t=>{t.release()}),this.interactiveLayer&&(this.interactiveLayer.forEachChildren(t=>{t.setStage&&t.setStage(null,null),this.interactiveLayer.removeChild(t)}),this.interactiveLayer.release()),this.window.release(),this.ticker.remTimeline(this.timeline),this.ticker.removeListener("afterTick",this.afterTickCb),this.renderService.renderTreeRoots=[]}setStage(t){}dirty(t,e){this.releaseStatus!=="released"&&(e&&t.transformWithMatrix(e),this.dirtyBounds.empty()&&this.dirtyBounds.setValue(t.x1,t.y1,t.x2,t.y2),this.dirtyBounds.union(t))}getLayer(t){return this.children.filter(e=>e.name===t)[0]}renderTo(t){this.releaseStatus!=="released"&&this.forEachChildren((e,n)=>{e.drawTo(t,{renderService:this.renderService,viewBox:t.getViewBox(),transMatrix:t.getViewBoxTransform(),background:e===this.defaultLayer?this.background:void 0,clear:n===0,updateBounds:!(!this.dirtyBounds||this.dirtyBounds.empty())})})}renderToNewWindow(t=!0,e){if(this.releaseStatus==="released")return;const n=bt.get(Hs),o=e?-e.x1:0,r=e?-e.y1:0,s=e?e.x2:this.viewWidth,l=e?e.y2:this.viewHeight,a=e?e.width():this.viewWidth,h=e?e.height():this.viewHeight;return n.create({viewBox:{x1:o,y1:r,x2:s,y2:l},width:a,height:h,dpr:this.window.dpr,canvasControled:!0,offscreen:!0,title:""}),this.renderTo(n),n}toCanvas(t=!0,e){if(this.releaseStatus==="released")return;const n=this.renderToNewWindow(t,e).getNativeHandler();return n.nativeCanvas?n.nativeCanvas:null}setCursor(t){this._cursor=t,this.eventSystem.setCursor(t,"ignore")}getCursor(){return this._cursor}eventPointTransform(t){const e=this.global.mapToCanvasPoint(t,this.window.getContext().canvas.nativeCanvas);return this.stage.window.pointTransform(e.x,e.y)}pauseTriggerEvent(){this._eventSystem&&this._eventSystem.pauseTriggerEvent()}resumeTriggerEvent(){this._eventSystem&&this._eventSystem.resumeTriggerEvent()}getPickerService(){return this.pickerService||(this.pickerService=bt.get(cr)),this.pickerService}}function nB(i){return new iB(i)}const Gd={WIDTH:500,HEIGHT:500,DPR:1};class Vg{get displayWidth(){return this._pixelWidth/this._dpr}get displayHeight(){return this._pixelHeight/this._dpr}get id(){return this._id}get x(){return this._x}set x(t){this._x=t}get y(){return this._y}set y(t){this._y=t}get nativeCanvas(){return this._nativeCanvas}get width(){return this._pixelWidth}set width(t){this._pixelWidth=t,this._displayWidth=t/(this._dpr||1)}get height(){return this._pixelHeight}set height(t){this._pixelHeight=t,this._displayHeight=t/(this._dpr||1)}getContext(t){return this._context}get visiable(){return this._visiable}set visiable(t){this._visiable=t,t?this.show():this.hide()}get dpr(){return this._dpr}set dpr(t){this._dpr=t,this.resize(this._displayWidth,this._displayHeight)}constructor(t){var e;const{nativeCanvas:n,width:o=Gd.WIDTH,height:r=Gd.HEIGHT,dpr:s=Gd.DPR,x:l,y:a,id:h,canvasControled:d=!0}=t;this._x=l??0,this._y=a??0,this._pixelWidth=o*s,this._pixelHeight=r*s,this._visiable=t.visiable!==!1,this.controled=d,this._displayWidth=o,this._displayHeight=r,this._dpr=s,this._nativeCanvas=n,this._id=(e=n.id)!==null&&e!==void 0?e:h,h&&(n.id=h),this.init(t)}getNativeCanvas(){return this._nativeCanvas}hide(){}show(){}applyPosition(){}resetStyle(t){}resize(t,e){}toDataURL(t,e){return""}readPixels(t,e,n,o){return this._context.getImageData(t,e,n,o)}convertToBlob(t){throw new Error("暂未实现")}transferToImageBitmap(){throw new Error("暂未实现")}release(...t){this.controled&&this._nativeCanvas.parentElement&&this._nativeCanvas.parentElement.removeChild(this._nativeCanvas)}}Vg.env="browser";var oB=function(i,t,e,n){var o,r=arguments.length,s=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var l=i.length-1;l>=0;l--)(o=i[l])&&(s=(r<3?o(s):r>3?o(t,e,s):o(t,e))||s);return r>3&&s&&Object.defineProperty(t,e,s),s},rB=function(i,t,e,n){return new(e||(e=Promise))(function(o,r){function s(h){try{a(n.next(h))}catch(d){r(d)}}function l(h){try{a(n.throw(h))}catch(d){r(d)}}function a(h){var d;h.done?o(h.value):(d=h.value,d instanceof e?d:new e(function(u){u(d)})).then(s,l)}a((n=n.apply(i,t||[])).next())})};let Oa=class{configure(i,...t){i.env===this.type&&i.setActiveEnvContribution(this)}getNativeAABBBounds(i){return new Gt}removeDom(i){return!1}createDom(i){return null}updateDom(i,t){return!1}getDynamicCanvasCount(){return 999}getStaticCanvasCount(){return 999}getElementById(i){return document.getElementById(i)}getRootElement(){return document.body}loadJson(i){const t=fetch(i).then(e=>e.json());return t.then(e=>({data:e,state:"success"})).catch(()=>({data:null,state:"fail"})),t}loadArrayBuffer(i){return fetch(i).then(t=>t.arrayBuffer()).then(t=>({data:t,loadState:"success"})).catch(()=>({data:null,loadState:"fail"}))}loadBlob(i){return fetch(i).then(t=>t.blob()).then(t=>({data:t,loadState:"success"})).catch(()=>({data:null,loadState:"fail"}))}getElementTop(i,t){return 0}getElementLeft(i,t){return 0}getElementTopLeft(i,t){return{top:0,left:0}}loadFont(i,t,e){return rB(this,void 0,void 0,function*(){return{loadState:"fail"}})}};Oa=oB([st()],Oa);var sB=function(i,t,e,n){var o,r=arguments.length,s=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var l=i.length-1;l>=0;l--)(o=i[l])&&(s=(r<3?o(s):r>3?o(t,e,s):o(t,e))||s);return r>3&&s&&Object.defineProperty(t,e,s),s},lB=function(i,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,t)};let Da=class{constructor(){this._uid=fe.GenAutoIncrementId(),this.viewBox=new Gt,this.modelMatrix=new Pe(1,0,0,1,0,0)}onChange(i){this._onChangeCb=i}configure(i,t){t.env===this.type&&i.setWindowHandler(this)}release(...i){this.releaseWindow()}isVisible(i){return!0}onVisibleChange(i){}getTopLeft(i){return{top:0,left:0}}setViewBox(i){this.viewBox.setValue(i.x1,i.y1,i.x2,i.y2)}getViewBox(){return this.viewBox}setViewBoxTransform(i,t,e,n,o,r){this.modelMatrix.setValue(i,t,e,n,o,r)}getViewBoxTransform(){return this.modelMatrix}};Da=sB([st(),lB("design:paramtypes",[])],Da);var aB=function(i,t,e,n){var o,r=arguments.length,s=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var l=i.length-1;l>=0;l--)(o=i[l])&&(s=(r<3?o(s):r>3?o(t,e,s):o(t,e))||s);return r>3&&s&&Object.defineProperty(t,e,s),s},hB=function(i,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,t)},Jp=function(i,t){return function(e,n){t(e,n,i)}};let uc=class{constructor(i){this.pickItemInterceptorContributions=i,this.type="default",this.global=G.global}_init(){this.InterceptorContributions=this.pickItemInterceptorContributions.getContributions().sort((i,t)=>i.order-t.order)}pick(i,t,e){let n={graphic:null,group:null};e.pickerService=this;const o=e.bounds.width(),r=e.bounds.height();if(!new Gt().setValue(0,0,o,r).containsPoint(t))return n;this.pickContext&&(this.pickContext.inuse=!0),e.pickContext=this.pickContext,this.pickContext&&this.pickContext.clearMatrix(!0,1);const s=new Pe(1,0,0,1,0,0);let l;for(let a=i.length-1;a>=0&&(n=i[a].isContainer?this.pickGroup(i[a],t,s,e):this.pickItem(i[a],t,s,e),!n.graphic);a--)l||(l=n.group);if(n.graphic||(n.group=l),this.pickContext&&(this.pickContext.inuse=!1),n.graphic){let a=n.graphic;for(;a.parent;)a=a.parent;a.shadowHost&&(n.params={shadowTarget:n.graphic},n.graphic=a.shadowHost)}return n}containsPoint(i,t,e){var n;return!!(!((n=this.pickItem(i,t,null,e??{pickContext:this.pickContext,pickerService:this}))===null||n===void 0)&&n.graphic)}pickGroup(i,t,e,n){let o={group:null,graphic:null};if(i.attribute.visibleAll===!1)return o;const r=n.pickContext,s=r.modelMatrix;if(r.camera){const f=i.transMatrix,g=ce.allocate();if(Gu(g,f),s){if(g){const p=ce.allocate();r.modelMatrix=rl(p,s,g),ce.free(g)}}else Gu(g,i.globalTransMatrix),r.modelMatrix=g}if(this.InterceptorContributions.length)for(let f=0;f<this.InterceptorContributions.length;f++){const g=this.InterceptorContributions[f];if(g.beforePickItem){const p=g.beforePickItem(i,this,t,n,{parentMatrix:e});if(p)return r.modelMatrix!==s&&ce.free(r.modelMatrix),r.modelMatrix=s,p}}const l=i.transMatrix,a=Ze.allocateByObj(e),h=new ye(t.x,t.y);a.transformPoint(h,h);const d=i.AABBBounds.containsPoint(h);if(!d&&!i.stage.camera)return o;const u=this.pickItem(i,h.clone(),e,n);u&&u.graphic&&(o.graphic=u.graphic,o.params=u.params);const c=i.attribute.pickable!==!1&&d;return a.multiply(l.a,l.b,l.c,l.d,l.e,l.f),i.attribute.childrenPickable===!1||u&&u.graphic||$C(i,re.zIndex,f=>{if(f.isContainer){const g=new ye(t.x,t.y),p=yt(i).group,{scrollX:v=p.scrollX,scrollY:m=p.scrollY}=i.attribute;g.x-=v,g.y-=m,o=this.pickGroup(f,g,a,n)}else{const g=new ye(t.x,t.y);a.transformPoint(g,g);const p=yt(i).group,{scrollX:v=p.scrollX,scrollY:m=p.scrollY}=i.attribute;g.x-=v,g.y-=m;const b=this.pickItem(f,g,e,n);b&&b.graphic&&(o.graphic=b.graphic,o.params=b.params)}return!!o.graphic||!!o.group},!0,!!r.camera),r.modelMatrix!==s&&ce.free(r.modelMatrix),r.modelMatrix=s,o.graphic||o.group||!c||i.stage.camera||(o.group=i),Ze.free(a),o}selectPicker(i){return this.pickerMap.get(i.numberType)||null}};uc=aB([st(),Jp(0,At(ge)),Jp(0,Re(or)),hB("design:paramtypes",[Object])],uc);let Qp=!1;const dB=new Ct(i=>{Qp||(Qp=!0,i(ma).toSelf().inSingletonScope(),i(xa).to(ma).inSingletonScope(),i($e).toService(xa),i(Ou).toService(Oi),Oe(i,Ou))});let t0=!1;const uB=new Ct(i=>{t0||(t0=!0,i(wa).toSelf().inSingletonScope(),i(Ta).to(wa).inSingletonScope(),i($e).toService(Ta),i(Rr).toSelf(),i(xr).toSelf(),i(So).toService(Rr),i(So).toService(xr),i(So).toService(Oi),Oe(i,So))});let e0=!1;const cB=new Ct(i=>{e0||(e0=!0,i(Ls).toSelf().inSingletonScope(),i(Ia).toSelf().inSingletonScope(),i(Aa).to(Ls).inSingletonScope(),i($e).toService(Aa))});let i0=!1;const gB=new Ct(i=>{i0||(i0=!0,i(ya).toSelf().inSingletonScope(),i(Pa).to(ya).inSingletonScope(),i($e).toService(Pa),i(Vu).toService(Oi),Oe(i,Vu))});let n0=!1;const fB=new Ct(i=>{n0||(n0=!0,i(ba).toSelf().inSingletonScope(),i(Ra).to(ba).inSingletonScope(),i($e).toService(Ra),i(Du).toService(Oi),Oe(i,Du))});let o0=!1;const pB=new Ct(i=>{o0||(o0=!0,i(Zu).to(Ku).inSingletonScope(),i($e).toService(Zu),i(va).toService(Oi),Oe(i,va))});let r0=!1;const vB=new Ct(i=>{r0||(r0=!0,i(_a).toSelf().inSingletonScope(),i(Ba).to(_a).inSingletonScope(),i($e).toService(Ba),i(Wu).toService(Oi),Oe(i,Wu))});let s0=!1;const mB=new Ct(i=>{s0||(s0=!0,i(Ma).to(Yu).inSingletonScope(),i($e).toService(Ma),i(Nu).toService(Oi),Oe(i,Nu))});var bB=function(i,t,e,n){var o,r=arguments.length,s=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var l=i.length-1;l>=0;l--)(o=i[l])&&(s=(r<3?o(s):r>3?o(t,e,s):o(t,e))||s);return r>3&&s&&Object.defineProperty(t,e,s),s},CB=function(i,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,t)};let cc=class extends ei{constructor(){super(),this.numberType=Pg,this.builtinContributions=[LC],this.init()}drawShape(i,t,e,n,o){const r=yt(i).richtext,{strokeOpacity:s=r.strokeOpacity,opacity:l=r.opacity,fillOpacity:a=r.fillOpacity,visible:h=r.visible}=i.attribute;if(!i.valid||!h)return;const d=Ho(l,a,!0),u=Ho(l,s,!0);d&&(t.setShadowBlendStyle&&t.setShadowBlendStyle(i,i.attribute,r),t.translate(e,n),this.beforeRenderStep(i,t,e,n,d,u,d,u,r,o),i.getFrameCache().draw(t,this.drawIcon),this.afterRenderStep(i,t,e,n,d,u,d,u,r,o))}drawIcon(i,t,e,n,o){var r;const s=yt(i).richtextIcon,{width:l=s.width,height:a=s.height,opacity:h=s.opacity,image:d,backgroundFill:u=s.backgroundFill,backgroundFillOpacity:c=s.backgroundFillOpacity,backgroundStroke:f=s.backgroundStroke,backgroundStrokeOpacity:g=s.backgroundStrokeOpacity,backgroundRadius:p=s.backgroundRadius,margin:v}=i.attribute,{backgroundWidth:m=l,backgroundHeight:b=a}=i.attribute;if(v&&(e+=i._marginArray[3],n+=i._marginArray[0]),i._hovered){const _=(m-l)/2,w=(b-a)/2;p===0?(t.beginPath(),t.rect(e-_,n-w,m,b)):(t.beginPath(),en(t,e-_,n-w,m,b,p)),u&&(t.globalAlpha=c,t.fillStyle=u,t.fill()),f&&(t.globalAlpha=g,t.strokeStyle=f,t.stroke())}const C=d&&((r=i==null?void 0:i.resources)===null||r===void 0?void 0:r.get(d));C&&C.state==="success"&&(t.globalAlpha=h,t.drawImage(C.data,e,n,l,a))}draw(i,t,e){const n=yt(i).richtext;this._draw(i,n,!1,e)}};cc=bB([st(),CB("design:paramtypes",[])],cc);let l0=!1;const _B=new Ct(i=>{l0||(l0=!0,i(Ju).to(cc).inSingletonScope(),i($e).toService(Ju))});let a0=!1;const wB=new Ct(i=>{a0||(a0=!0,i(up).to(qu).inSingletonScope(),i($e).toService(up),i(yo).toService(Oi),Oe(i,yo))});function yB(){ft.RegisterGraphicCreator("arc",Og)}function SB(){ft.RegisterGraphicCreator("circle",DC)}function xB(){ft.RegisterGraphicCreator("group",pa)}function RB(){ft.RegisterGraphicCreator("image",ad)}function AB(){ft.RegisterGraphicCreator("line",hi)}function BB(){ft.RegisterGraphicCreator("path",yA)}function MB(){ft.RegisterGraphicCreator("polygon",SA)}function TB(){ft.RegisterGraphicCreator("rect",qt)}function PB(){ft.RegisterGraphicCreator("richtext",wA)}function HB(){ft.RegisterGraphicCreator("symbol",zs)}function kB(){ft.RegisterGraphicCreator("text",ec)}function EB(){ft.RegisterGraphicCreator("shadowRoot",RA)}function LB(){ft.RegisterGraphicCreator("wrapText",mR)}const h0=new Gt;class FB{constructor(){this.name="FlexLayoutPlugin",this.activeEvent="onRegister",this.id=fe.GenAutoIncrementId(),this.key=this.name+this.id,this.tempBounds=new Gt}pauseLayout(t){this.pause=t}tryLayoutChildren(t){t.firstChild&&this.tryLayout(t.firstChild)}tryLayout(t,e=!0){if(this.pause)return;const n=t.parent;if(!(e||n&&t.needUpdateLayout()))return;const o=yt(n).group,{display:r=o.display}=n.attribute;if(r!=="flex")return;const{flexDirection:s=o.flexDirection,flexWrap:l=o.flexWrap,alignItems:a=o.alignItems,clip:h=o.clip}=n.attribute,{alignContent:d=a??o.alignContent}=n.attribute;let{width:u,height:c,justifyContent:f=o.justifyContent}=n.attribute;const g=n.getChildren();if(u==null||c==null){let S=0,R=0,B=0;if(g.forEach(A=>{const M=this.getAABBBounds(A);M.empty()||(s==="column"||s==="column-reverse"?(R+=M.height(),S=Math.max(S,M.width())):(S+=M.width(),R=Math.max(R,M.height())),B+=M.x1,B+=M.y1,B+=M.x2,B+=M.y2)}),!isFinite(B))return;u=S,c=R}n.attribute.width==null?n.attribute.width=u:u=n.attribute.width,n.attribute.height==null?n.attribute.height=c:c=n.attribute.height,this.tempBounds.copy(n._AABBBounds);const p={main:{len:u,field:"x"},cross:{len:c,field:"y"}},v=p.main,m=p.cross;s!=="column"&&s!=="column-reverse"||(v.len=c,m.len=u,v.field="y",m.field="x"),s!=="row-reverse"&&s!=="column-reverse"||(f==="flex-start"?f="flex-end":f==="flex-end"?f="flex-start":g.reverse());let b=0,C=0;const _=[];g.forEach(S=>{const R=this.getAABBBounds(S);if(R.empty())return;const B=v.field==="x"?R.width():R.height(),A=m.field==="x"?R.width():R.height();_.push({mainLen:B,crossLen:A}),b+=B,C=Math.max(C,A)});const w=[];if(b>v.len&&l==="wrap"){let S=0,R=0;_.forEach(({mainLen:B,crossLen:A},M)=>{S+B>v.len?S===0?(w.push({idx:M,mainLen:S+B,crossLen:A}),S=0,R=0):(w.push({idx:M-1,mainLen:S,crossLen:R}),S=B,R=A):(S+=B,R=Math.max(R,A))}),w.push({idx:_.length-1,mainLen:S,crossLen:R})}else w.push({idx:_.length-1,mainLen:b,crossLen:C});let y=0;if(w.forEach(S=>{this.layoutMain(n,g,f,v,_,y,S),y=S.idx+1}),C=w.reduce((S,R)=>S+R.crossLen,0),w.length===1){const S={"flex-start":0,"flex-end":m.len,center:m.len/2};this.layoutCross(g,a,m,S,_,w[0],0)}else if(d==="flex-start"){y=0;let S=0;w.forEach((R,B)=>{const A={"flex-start":S,"flex-end":S+R.crossLen,center:S+R.crossLen/2};this.layoutCross(g,"flex-start",m,A,_,w[B],y),y=R.idx+1,S+=R.crossLen})}else if(d==="center"){y=0;let S=Math.max(0,(m.len-C)/2);w.forEach((R,B)=>{const A={"flex-start":S,"flex-end":S+R.crossLen,center:S+R.crossLen/2};this.layoutCross(g,"center",m,A,_,w[B],y),y=R.idx+1,S+=R.crossLen})}else if(d==="space-around"){y=0;const S=Math.max(0,(m.len-C)/w.length/2);let R=S;w.forEach((B,A)=>{const M={"flex-start":R,"flex-end":R+B.crossLen,center:R+B.crossLen/2};this.layoutCross(g,"flex-start",m,M,_,w[A],y),y=B.idx+1,R+=B.crossLen+2*S})}else if(d==="space-between"){y=0;const S=Math.max(0,(m.len-C)/(2*w.length-2));let R=0;w.forEach((B,A)=>{const M={"flex-start":R,"flex-end":R+B.crossLen,center:R+B.crossLen/2};this.layoutCross(g,"flex-start",m,M,_,w[A],y),y=B.idx+1,R+=B.crossLen+2*S})}g.forEach((S,R)=>{S.addUpdateBoundTag(),S.addUpdatePositionTag(),S.clearUpdateLayoutTag()}),n.addUpdateLayoutTag();const x=this.getAABBBounds(n);h||this.tempBounds.equals(x)||this.tryLayout(n,!1)}getAABBBounds(t){this.skipBoundsTrigger=!0;const e=t.AABBBounds;return this.skipBoundsTrigger=!1,e}updateChildPos(t,e,n){return t+(e??0)-n}layoutMain(t,e,n,o,r,s,l){if(n==="flex-start"){let a=0;for(let h=s;h<=l.idx;h++){const d=a+Ki(e[h],o.field),u=this.getAABBBounds(e[h]);!u.empty()&&(e[h].attribute[o.field]=this.updateChildPos(d,e[h].attribute[o.field],u[`${o.field}1`])),a+=r[h].mainLen}}else if(n==="flex-end"){let a=o.len;for(let h=l.idx;h>=s;h--){a-=r[h].mainLen;const d=a+Ki(e[h],o.field),u=this.getAABBBounds(e[h]);!u.empty()&&(e[h].attribute[o.field]=this.updateChildPos(d,e[h].attribute[o.field],u[`${o.field}1`]))}}else if(n==="space-around")if(l.mainLen>=o.len){let a=0;for(let h=s;h<=l.idx;h++){const d=a+Ki(e[h],o.field),u=this.getAABBBounds(e[h]);!u.empty()&&(e[h].attribute[o.field]=this.updateChildPos(d,e[h].attribute[o.field],u[`${o.field}1`])),a+=r[h].mainLen}}else{const a=l.idx-s+1,h=(o.len-l.mainLen)/a/2;let d=h;for(let u=s;u<=l.idx;u++){const c=d+Ki(e[u],o.field),f=this.getAABBBounds(e[u]);!f.empty()&&(e[u].attribute[o.field]=this.updateChildPos(c,e[u].attribute[o.field],f[`${o.field}1`])),d+=r[u].mainLen+2*h}}else if(n==="space-between")if(l.mainLen>=o.len){let a=0;for(let h=s;h<=l.idx;h++){const d=a+Ki(e[h],o.field),u=this.getAABBBounds(e[h]);!u.empty()&&(e[h].attribute[o.field]=this.updateChildPos(d,e[h].attribute[o.field],u[`${o.field}1`])),a+=r[h].mainLen}}else{const a=l.idx-s+1,h=(o.len-l.mainLen)/(2*a-2);let d=0;for(let u=s;u<=l.idx;u++){const c=d+Ki(e[u],o.field),f=this.getAABBBounds(e[u]);!f.empty()&&(e[u].attribute[o.field]=this.updateChildPos(c,e[u].attribute[o.field],f[`${o.field}1`])),d+=r[u].mainLen+2*h}}else if(n==="center"){let a=(o.len-l.mainLen)/2;for(let h=s;h<=l.idx;h++){const d=a+Ki(e[h],o.field),u=this.getAABBBounds(e[h]);!u.empty()&&(e[h].attribute[o.field]=this.updateChildPos(d,e[h].attribute[o.field],u[`${o.field}1`])),a+=r[h].mainLen}}}layoutCross(t,e,n,o,r,s,l){var a;for(let h=l;h<=s.idx;h++){const d=t[h];let{alignSelf:u}=d.attribute;u&&u!=="auto"||(u=e);const c=this.getAABBBounds(d),f=(a=o[u])!==null&&a!==void 0?a:o["flex-start"];u==="flex-end"?!c.empty()&&(d.attribute[n.field]=this.updateChildPos(f-r[h].crossLen+Ki(d,n.field),d.attribute[n.field],c[`${n.field}1`])):u==="center"?!c.empty()&&(d.attribute[n.field]=this.updateChildPos(f-r[h].crossLen/2+Ki(d,n.field),d.attribute[n.field],c[`${n.field}1`])):!c.empty()&&(d.attribute[n.field]=this.updateChildPos(f+Ki(d,n.field),d.attribute[n.field],c[`${n.field}1`]))}}activate(t){this.pluginService=t,G.graphicService.hooks.onAttributeUpdate.tap(this.key,e=>{e.glyphHost&&(e=e.glyphHost),e.stage&&e.stage===this.pluginService.stage&&this.tryLayout(e,!1)}),G.graphicService.hooks.beforeUpdateAABBBounds.tap(this.key,(e,n,o,r)=>{e.glyphHost&&(e=e.glyphHost),n&&n===this.pluginService.stage&&e.isContainer&&!this.skipBoundsTrigger&&h0.copy(r)}),G.graphicService.hooks.afterUpdateAABBBounds.tap(this.key,(e,n,o,r,s)=>{n&&n===this.pluginService.stage&&e.isContainer&&!this.skipBoundsTrigger&&(h0.equals(o)||this.tryLayout(e,!1))}),G.graphicService.hooks.onSetStage.tap(this.key,e=>{e.glyphHost&&(e=e.glyphHost),this.tryLayout(e,!1)})}deactivate(t){G.graphicService.hooks.onAttributeUpdate.taps=G.graphicService.hooks.onAttributeUpdate.taps.filter(e=>e.name!==this.key),G.graphicService.hooks.beforeUpdateAABBBounds.taps=G.graphicService.hooks.beforeUpdateAABBBounds.taps.filter(e=>e.name!==this.key),G.graphicService.hooks.afterUpdateAABBBounds.taps=G.graphicService.hooks.afterUpdateAABBBounds.taps.filter(e=>e.name!==this.key),G.graphicService.hooks.onSetStage.taps=G.graphicService.hooks.onSetStage.taps.filter(e=>e.name!==this.key)}}function Ki(i,t){return 0}const d0=()=>{Nn.registerPlugin("FlexLayoutPlugin",FB)},u0=["x","y","dx","dy","scaleX","scaleY","angle","anchor","postMatrix","visible","clip","pickable","childrenPickable","zIndex","cursor"];class gi extends Gi{constructor(t,e){super(t),e!=null&&e.mode&&(this.mode=e.mode,this.setMode(e.mode)),e!=null&&e.skipDefault&&(this.skipDefault=!0),this.setTheme({common:{strokeBoundsBuffer:0}}),this.attribute=t,this.onSetStage(()=>{this.render(),this.bindEvents()})}setAttribute(t,e,n,o){const r=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({[t]:e},this.attribute,t,o);if(r)return this._setAttributes(r,n);Hd(this.attribute[t])&&Hd(e)&&!Mt(this.attribute[t])&&!Mt(e)?rt(this.attribute[t],e):this.attribute[t]=e,u0.includes(t)||this.render(),this.valid=this.isValid(),this.updateShapeAndBoundsTagSetted()||!n&&!this.needUpdateTag(t)?this.addUpdateBoundTag():this.addUpdateShapeAndBoundsTag(),this.addUpdatePositionTag(),this.onAttributeUpdate()}setAttributes(t,e,n){return t=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate(t,this.attribute,null,n)||t,this._setAttributes(t,e)}_setAttributes(t,e){const n=Object.keys(t);this._mergeAttributes(t,n),n.every(o=>u0.includes(o))||this.render(),this.valid=this.isValid(),this.updateShapeAndBoundsTagSetted()||!e&&!this.needUpdateTags(n)?this.addUpdateBoundTag():this.addUpdateShapeAndBoundsTag(),this.addUpdatePositionTag(),this.onAttributeUpdate()}_mergeAttributes(t,e){Pt(e)&&(e=Object.keys(t));for(let n=0;n<e.length;n++){const o=e[n];!Hd(this.attribute[o])||Mt(this.attribute[o])||Mt(t[o])?this.attribute[o]=t[o]:rt(this.attribute[o],t[o])}}bindEvents(){}_getNodeId(t){var e;return`${(e=this.id)!==null&&e!==void 0?e:this._uid}-${this.name}-${t}`}_dispatchEvent(t,e){var n;const o=new Rg(t,e);o.manager=(n=this.stage)===null||n===void 0?void 0:n.eventSystem.manager,this.dispatchEvent(o)}}const io=Symbol.for("MathPickerContribution"),c0=Symbol.for("MathArcPicker"),g0=Symbol.for("MathCirclePicker"),Wa=Symbol.for("MathImagePicker"),f0=Symbol.for("MathLinePicker"),p0=Symbol.for("MathPathPicker"),v0=Symbol.for("MathRectPicker"),m0=Symbol.for("MathSymbolPicker"),b0=Symbol.for("MathTextPicker"),C0=Symbol.for("MathPolygonPicker"),_0=Symbol.for("CanvasArcPicker"),w0=Symbol.for("CanvasCirclePicker"),y0=Symbol.for("CanvasImagePicker"),S0=Symbol.for("CanvasLinePicker"),x0=Symbol.for("CanvasPathPicker"),R0=Symbol.for("CanvasRectPicker"),A0=Symbol.for("CanvasSymbolPicker"),B0=Symbol.for("CanvasTextPicker"),M0=Symbol.for("CanvasPolygonPicker"),T0=Symbol.for("CanvasRichTextPicker"),P0=Symbol.for("CanvasGroupPicker"),ci=Symbol.for("CanvasPickerContribution"),zB={onPointerDown:"pointerdown",onPointerUp:"pointerup",onPointerUpOutside:"pointerupoutside",onPointerTap:"pointertap",onPointerOver:"pointerover",onPointerMove:"pointermove",onPointerEnter:"pointerenter",onPointerLeave:"pointerleave",onPointerOut:"pointerout",onMouseDown:"mousedown",onMouseUp:"mouseup",onMouseUpOutside:"mouseupoutside",onMouseMove:"mousemove",onMouseOver:"mouseover",onMouseOut:"mouseout",onMouseEnter:"mouseenter",onMouseLeave:"mouseleave",onPinch:"pinch",onPinchStart:"pinchstart",onPinchEnd:"pinchend",onPan:"pan",onPanStart:"panstart",onPanEnd:"panend",onDrag:"drag",onDragStart:"dragstart",onDragEnter:"dragenter",onDragLeave:"dragleave",onDragOver:"dragover",onDragEnd:"dragend",onRightDown:"rightdown",onRightUp:"rightup",onRightUpOutside:"rightupoutside",onTouchStart:"touchstart",onTouchEnd:"touchend",onTouchEndOutside:"touchendoutside",onTouchMove:"touchmove",onTouchCancel:"touchcancel",onPress:"press",onPressUp:"pressup",onPressEnd:"pressend",onSwipe:"swipe",onDrop:"drop",onWeel:"wheel",onClick:"click",onDblClick:"dblclick"},H0=(i,t)=>{const e=t.x-i.x,n=t.y-i.y;return Math.abs(e)>Math.abs(n)?e>0?"right":"left":n>0?"down":"up"},kl=(i,t)=>{const e=Math.abs(t.x-i.x),n=Math.abs(t.y-i.y);return Math.sqrt(e*e+n*n)},IB=i=>{const t=i.length;if(t===1)return{x:Math.round(i[0].x),y:Math.round(i[0].y)};let e=0,n=0,o=0;for(;o<t;)e+=i[o].x,n+=i[o].y,o++;return{x:Math.round(e/t),y:Math.round(n/t)}};class OB extends Lr{constructor(t,e={}){var n,o,r,s,l,a,h,d,u,c;super(),this.cachedEvents=[],this.startPoints=[],this.processEvent={},this.throttleTimer=0,this.emitThrottles=[],this.lastTapTarget=null,this.onStart=f=>{this.cachedEvents=[],this.startPoints=[],this.reset(),this.startTime=wo.now();const{cachedEvents:g,startPoints:p}=this;f&&g.push(f.clone()),p.length=g.length;for(let v=0;v<g.length;v++){const{x:m,y:b}=g[v],C={x:m,y:b};p[v]=C}if(p.length!==1)this.startDistance=kl(p[0],p[1]),this.center=IB([p[0],p[1]]);else{const v=g[0];this.pressTimeout=setTimeout(()=>{v.direction="none",v.deltaX=0,v.deltaY=0,v.points=p,this.triggerStartEvent("press",v),this.triggerEvent("press",v),this.eventType="press",this.direction="none",this.pressTimeout=null},this.config.press.time)}},this.onMove=f=>{this.clearPressTimeout();const{startPoints:g,cachedEvents:p}=this;if(!g.length)return;const v=f.clone(),{x:m,y:b,pointerId:C}=v;for(let R=0,B=p.length;R<B;R++)if(C===p[R].pointerId){p[R]=v;break}const _={x:m,y:b},w=p.map(R=>({x:R.x,y:R.y})),y=wo.now();if(this.prevMoveTime=this.lastMoveTime,this.prevMovePoint=this.lastMovePoint,this.lastMoveTime=y,this.lastMovePoint=_,g.length===1){const R=g[0],B=m-R.x,A=b-R.y,M=this.direction||H0(R,_);this.direction=M;const k=this.getEventType(_);return v.direction=M,v.deltaX=B,v.deltaY=A,v.points=w,this.triggerStartEvent(k,v),void this.triggerEvent(k,v)}const{startDistance:x}=this,S=kl(w[0],w[1]);v.scale=S/x,v.center=this.center,v.points=w,this.triggerStartEvent("pinch",v),this.triggerEvent("pinch",v)},this.onEnd=f=>{const g=f.clone(),{cachedEvents:p,startPoints:v}=this,m=p.map(b=>({x:b.x,y:b.y}));if(g.points=m,this.triggerEndEvent(g),p.length===1){const b=wo.now(),C=this.lastMoveTime;if(b-C<100){const _=C-(this.prevMoveTime||this.startTime);if(_>0){const w=this.prevMovePoint||v[0],y=this.lastMovePoint||v[0],x=kl(w,y),S=x/_;if(S>this.config.swipe.velocity&&x>this.config.swipe.threshold)return g.velocity=S,g.direction=H0(w,y),this.triggerEvent("swipe",g),this.cachedEvents=[],this.startPoints=[],void this.reset()}}b-this.startTime<this.config.press.time&&(b-this.lastTapTime<this.config.tap.interval&&f.target===this.lastTapTarget?this.tapCount++:this.tapCount=1,this.lastTapTime=b,this.lastTapTarget=f.target,this.tapCount===1?this.triggerEvent("tap",g):this.tapCount===2&&(this.triggerEvent("doubletap",g),this.tapCount=0))}for(let b=0,C=p.length;b<C;b++)if(p[b].pointerId===g.pointerId){p.splice(b,1),v.splice(b,1);break}this.reset(),p.length>0&&this.onStart()},this.element=t,this.tapCount=0,this.lastTapTime=0,this.config={press:{time:(o=(n=e==null?void 0:e.press)===null||n===void 0?void 0:n.time)!==null&&o!==void 0?o:251,threshold:(s=(r=e==null?void 0:e.press)===null||r===void 0?void 0:r.threshold)!==null&&s!==void 0?s:9},swipe:{threshold:(a=(l=e==null?void 0:e.swipe)===null||l===void 0?void 0:l.threshold)!==null&&a!==void 0?a:10,velocity:(d=(h=e==null?void 0:e.swipe)===null||h===void 0?void 0:h.velocity)!==null&&d!==void 0?d:.3},tap:{interval:(c=(u=e==null?void 0:e.tap)===null||u===void 0?void 0:u.interval)!==null&&c!==void 0?c:300}},this.initEvents()}initEvents(){const{element:t}=this;t&&(t.addEventListener("pointerdown",this.onStart),t.addEventListener("pointermove",this.onMove),t.addEventListener("pointerup",this.onEnd),t.addEventListener("pointerupoutside",this.onEnd))}removeEvents(){const{element:t}=this;t&&(t.removeEventListener("pointerdown",this.onStart),t.removeEventListener("pointermove",this.onMove),t.removeEventListener("pointerup",this.onEnd),t.removeEventListener("pointerupoutside",this.onEnd))}release(){this.removeEvents(),this.element=null}getEventType(t){const{eventType:e,startTime:n,startPoints:o}=this;if(e==="press")return e;let r;return r=wo.now()-n>this.config.press.time&&kl(o[0],t)<this.config.press.threshold?"press":"pan",this.eventType=r,r}enable(t){this.processEvent[t]=!0}isProcess(t){return this.processEvent[t]}pushEvent(t,e){const{emitThrottles:n}=this,o={type:t,ev:e};for(let r=0,s=n.length;r<s;r++)if(n[r].type===t)return void n.splice(r,1,o);n.push(o)}clearPressTimeout(){this.pressTimeout&&(clearTimeout(this.pressTimeout),this.pressTimeout=null)}reset(){this.clearPressTimeout(),this.startTime=0,this.startDistance=0,this.direction=null,this.eventType=null,this.prevMoveTime=0,this.prevMovePoint=null,this.lastMoveTime=0,this.lastMovePoint=null}triggerEvent(t,e){this.pushEvent(t,e);const{throttleTimer:n,emitThrottles:o}=this;n||(this.throttleTimer=G.global.getRequestAnimationFrame()(()=>{G.global.getCancelAnimationFrame()(this.throttleTimer),this.throttleTimer=null;for(let r=0,s=o.length;r<s;r++){const{type:l,ev:a}=o[r];this.emitEvent(l,a)}this.emitThrottles.length=0}))}triggerStartEvent(t,e){this.isProcess(t)||(this.enable(t),this.triggerEvent(`${t}start`,e))}triggerEndEvent(t){const e=this.processEvent;Object.keys(e).forEach(n=>{this.triggerEvent(`${n}end`,t),n==="press"&&this.triggerEvent(`${n}up`,t),delete e[n]})}emitEvent(t,e){if(!this.element)return;const n=this.element._events[cC];if(n)if("fn"in n)n.fn.call(n.context,e,t);else for(let o=0,r=n.length;o<r&&!e.propagationImmediatelyStopped;o++)n[o].fn.call(n[o].context,e,t);this.emit(t,e)}}var DB=function(i,t,e,n){var o,r=arguments.length,s=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var l=i.length-1;l>=0;l--)(o=i[l])&&(s=(r<3?o(s):r>3?o(t,e,s):o(t,e))||s);return r>3&&s&&Object.defineProperty(t,e,s),s},WB=function(i,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,t)};const St=[0,0,0],NB=(i,t,e,n,o,r,s,l)=>{if(l)for(;e>t;)e-=Vt;else for(;e<t;)e+=Vt;const a=Xt/3*(e>t?1:-1);let h=t,d=h;for(;d!==e;){d=a>0?Math.min(d+a,e):Math.max(d+a,e);const u=Math.abs(d-h),c=4*Math.tan(u/4)/3,f=d<h?-1:1,g=Math.cos(h),p=Math.sin(h),v=Math.cos(d),m=Math.sin(d),b=g*r+n,C=p*s+o,_=v*r+n,w=m*s+o,y=r*c*f,x=s*c*f;i.push([b-y*p,C+x*g,_+y*m,w-x*v,_,w]),h=d}};let gr=class{set fillStyle(i){this.nativeContext.fillStyle=i}get fillStyle(){return this.nativeContext.fillStyle}set font(i){this.nativeContext.font=i}get font(){return this.nativeContext.font}set globalAlpha(i){this.nativeContext.globalAlpha=i*this.baseGlobalAlpha}get globalAlpha(){return this.nativeContext.globalAlpha}set lineCap(i){this.nativeContext.lineCap=i}get lineCap(){return this.nativeContext.lineCap}set lineDashOffset(i){this.nativeContext.lineDashOffset=i}get lineDashOffset(){return this.nativeContext.lineDashOffset}set lineJoin(i){this.nativeContext.lineJoin=i}get lineJoin(){return this.nativeContext.lineJoin}set lineWidth(i){this.nativeContext.lineWidth=i}get lineWidth(){return this.nativeContext.lineWidth}set miterLimit(i){this.nativeContext.miterLimit=i}get miterLimit(){return this.nativeContext.miterLimit}set shadowBlur(i){this.nativeContext.shadowBlur=i}get shadowBlur(){return this.nativeContext.shadowBlur}set shadowColor(i){this.nativeContext.shadowColor=i}get shadowColor(){return this.nativeContext.shadowColor}set shadowOffsetX(i){this.nativeContext.shadowOffsetX=i}get shadowOffsetX(){return this.nativeContext.shadowOffsetX}set shadowOffsetY(i){this.nativeContext.shadowOffsetY=i}get shadowOffsetY(){return this.nativeContext.shadowOffsetY}set strokeStyle(i){this.nativeContext.strokeStyle=i}get strokeStyle(){return this.nativeContext.strokeStyle}set textAlign(i){this.nativeContext.textAlign=i}get textAlign(){return this.nativeContext.textAlign}set textBaseline(i){this.nativeContext.textBaseline=i}get textBaseline(){return this.nativeContext.textBaseline}get inuse(){return!!this._inuse}set inuse(i){i!==!!this._inuse&&(this._inuse=i,i?(this.nativeContext.save(),this.reset()):this.nativeContext.restore())}constructor(i,t){this.fillAttributes=Object.assign(Object.assign({},eC),{opacity:1}),this.strokeAttributes=Object.assign(Object.assign({},iC),{opacity:1}),this.textAttributes=Object.assign(Object.assign({},qe),{opacity:1}),this._clearShadowStyle=!1,this._clearFilterStyle=!1,this._clearGlobalCompositeOperationStyle=!1;const e=i.nativeCanvas.getContext("2d");if(!e)throw new Error("发生错误，获取2d上下文失败");this.nativeContext=e,this.canvas=i,this.matrix=new Pe(1,0,0,1,0,0),this.stack=[],this.dpr=t,this.applyedMatrix=new Pe(1,0,0,1,0,0),this._clearMatrix=new Pe(1,0,0,1,0,0),this.baseGlobalAlpha=1}reset(){this.stack.length&&ze.getInstance().warn("可能存在bug，matrix没有清空"),this.matrix.setValue(1,0,0,1,0,0),this.applyedMatrix=new Pe(1,0,0,1,0,0),this.stack.length=0,this.nativeContext.setTransform(1,0,0,1,0,0)}getCanvas(){return this.canvas}getContext(){return this.nativeContext}setTransformForCurrent(i=!1){!i&&this.applyedMatrix.equalToMatrix(this.matrix)||(this.applyedMatrix.setValue(this.matrix.a,this.matrix.b,this.matrix.c,this.matrix.d,this.matrix.e,this.matrix.f),this.nativeContext.setTransform(this.matrix.a,this.matrix.b,this.matrix.c,this.matrix.d,this.matrix.e,this.matrix.f))}get currentMatrix(){return this.matrix}cloneMatrix(i){return Ze.allocateByObj(i)}clear(){this.save(),this.resetTransform(),this.nativeContext.clearRect(0,0,this.canvas.width,this.canvas.height),this.restore()}restore(){this.nativeContext.restore(),this.stack.length>0&&(Ze.free(this.matrix),this.matrix=this.stack.pop(),this.setTransformForCurrent(!0))}highPerformanceRestore(){this.stack.length>0&&(Ze.free(this.matrix),this.matrix=this.stack.pop())}rotate(i,t=!0){this.matrix.rotate(i),t&&this.setTransformForCurrent()}save(){const i=this.cloneMatrix(this.matrix);this.stack.push(i),this.nativeContext.save()}highPerformanceSave(){const i=this.cloneMatrix(this.matrix);this.stack.push(i)}scale(i,t,e=!0){this.matrix.scale(i,t),e&&this.setTransformForCurrent()}setScale(i,t,e=!0){this.matrix.setScale(i,t),e&&this.setTransformForCurrent()}scalePoint(i,t,e,n,o=!0){this.translate(e,n,!1),this.scale(i,t,!1),this.translate(-e,-n,!1),o&&this.setTransformForCurrent()}setTransform(i,t,e,n,o,r,s=!0,l=this.dpr){this.matrix.setValue(l*i,l*t,l*e,l*n,l*o,l*r),s&&this.setTransformForCurrent()}setTransformFromMatrix(i,t=!0,e=this.dpr){this.matrix.setValue(i.a*e,i.b*e,i.c*e,i.d*e,i.e*e,i.f*e),t&&this.setTransformForCurrent()}resetTransform(i=!0,t=this.dpr){this.setTransform(t,0,0,t,0,0),i&&this.setTransformForCurrent()}transform(i,t,e,n,o,r,s=!0){this.matrix.multiply(i,t,e,n,o,r),s&&this.setTransformForCurrent()}transformFromMatrix(i,t){this.matrix.multiply(i.a,i.b,i.c,i.d,i.e,i.f),t&&this.setTransformForCurrent()}translate(i,t,e=!0){this.matrix.translate(i,t),e&&this.setTransformForCurrent()}rotateDegrees(i,t=!0){const e=i*Math.PI/180;this.rotate(e,t)}rotateAbout(i,t,e,n=!0){this.translate(t,e,!1),this.rotate(i,!1),this.translate(-t,-e,!1),n&&this.setTransformForCurrent()}rotateDegreesAbout(i,t,e,n=!0){this.translate(t,e,!1),this.rotateDegrees(i,!1),this.translate(-t,-e,!1),n&&this.setTransformForCurrent()}beginPath(){this.disableBeginPath||this.nativeContext.beginPath()}clip(i,t){i?typeof i=="string"?this.nativeContext.clip(i):this.nativeContext.clip(i,t):this.nativeContext.clip()}arc(i,t,e,n,o,r,s){if(s=s||0,this.camera){const l=[];NB(l,n,o,i,t,e,e,r);for(let a=0;a<l.length;++a){const h=l[a];this.bezierCurveTo(h[0],h[1],h[2],h[3],h[4],h[5],s)}}else this.nativeContext.arc(i,t,Math.max(0,e),n,o,r)}arcTo(i,t,e,n,o){this.nativeContext.arcTo(i,t,e,n,o)}bezierCurveTo(i,t,e,n,o,r,s){if(s=s||0,this.camera){let l=s,a=s;this.modelMatrix&&(Pi(St,[i,t,s],this.modelMatrix),i=St[0],t=St[1],l=St[2],Pi(St,[e,n,s],this.modelMatrix),e=St[0],n=St[1],a=St[2],Pi(St,[o,r,s],this.modelMatrix),o=St[0],r=St[1],s=St[2]);let h=this.camera.vp(o,r,s);o=h.x,r=h.y,h=this.camera.vp(i,t,l),i=h.x,t=h.y,h=this.camera.vp(e,n,a),e=h.x,n=h.y}this.nativeContext.bezierCurveTo(i,t,e,n,o,r)}closePath(){this.nativeContext.closePath()}ellipse(i,t,e,n,o,r,s,l){l==null?this.nativeContext.ellipse(i,t,e,n,o,r,s):this.nativeContext.ellipse(i,t,e,n,o,r,s,l)}lineTo(i,t,e){if(e=e||0,this.camera){this.modelMatrix&&(Pi(St,[i,t,e],this.modelMatrix),i=St[0],t=St[1],e=St[2]);const n=this.camera.vp(i,t,e);i=n.x,t=n.y}this.nativeContext.lineTo(i,t)}moveTo(i,t,e){if(e=e||0,this.camera){this.modelMatrix&&(Pi(St,[i,t,e],this.modelMatrix),i=St[0],t=St[1],e=St[2]);const n=this.camera.vp(i,t,e);i=n.x,t=n.y}this.nativeContext.moveTo(i,t)}quadraticCurveTo(i,t,e,n,o){if(o=o||0,this.camera){let r=o;this.modelMatrix&&(Pi(St,[i,t,o],this.modelMatrix),i=St[0],t=St[1],r=St[2],Pi(St,[e,n,o],this.modelMatrix),e=St[0],n=St[1],o=St[2]);let s=this.camera.vp(e,n,o);e=s.x,n=s.y,s=this.camera.vp(i,t,r),i=s.x,t=s.y}this.nativeContext.quadraticCurveTo(i,t,e,n)}rect(i,t,e,n,o){o=o||0,this.camera?(this.moveTo(i,t,o),this.lineTo(i+e,t,o),this.lineTo(i+e,t+n,o),this.lineTo(i,t+n,o),this.closePath()):this.nativeContext.rect(i,t,e,n)}createImageData(){const i=arguments;return i.length===2?this.nativeContext.createImageData(i[0],i[1]):i.length===1?this.nativeContext.createImageData(i[0]):null}createLinearGradient(i,t,e,n){return isFinite(i+t+e+n)||(i=0,t=0,e=0,n=0),this.nativeContext.createLinearGradient(i,t,e,n)}createPattern(i,t){return i.width===0||i.height===0?null:this.nativeContext.createPattern(i,t)}createRadialGradient(i,t,e,n,o,r){return this.nativeContext.createRadialGradient(i,t,e,n,o,r)}createConicGradient(i,t,e,n){let o,r=!1;const s=this;return{stops:[],addColorStop(l,a){this.stops.push([l,a]),r=!0},GetPattern(l,a,h){return r&&(h||(h=n-e),o=$S(s,this.stops,i,t,h,e,n,l,a),r=!1),o}}}fill(i,t){this.disableFill||(i?this.nativeContext.fill(i):this.nativeContext.fill())}fillRect(i,t,e,n){this.nativeContext.fillRect(i,t,e,n)}clearRect(i,t,e,n){this.nativeContext.clearRect(i,t,e,n)}project(i,t,e){if(e=e||0,this.camera){this.modelMatrix&&(Pi(St,[i,t,e],this.modelMatrix),i=St[0],t=St[1],e=St[2]);const n=this.camera.vp(i,t,e);i=n.x,t=n.y}return{x:i,y:t}}view(i,t,e){return e=e||0,this.camera?(this.modelMatrix&&(Pi(St,[i,t,e],this.modelMatrix),i=St[0],t=St[1],e=St[2]),this.camera.view(i,t,e)):[i,t,e]}fillText(i,t,e,n){if(n=n||0,this.camera){this.modelMatrix&&(Pi(St,[t,e,n],this.modelMatrix),t=St[0],e=St[1],n=St[2]);const o=this.camera.vp(t,e,n);t=o.x,e=o.y}this.nativeContext.fillText(i,t,e)}getImageData(i,t,e,n){return this.nativeContext.getImageData(i,t,e,n)}getLineDash(){return this.nativeContext.getLineDash()}isPointInPath(i,t){return this.nativeContext.isPointInPath(i,t)}isPointInStroke(i,t){return this.nativeContext.isPointInStroke(i,t)}measureText(i,t=G.global.measureTextMethod){var e,n;if(!t||t==="native")return this.nativeContext.measureText(i);this.mathTextMeasure||(this.mathTextMeasure=G.graphicUtil.createTextMeasureInstance({},{},()=>this.canvas.nativeCanvas));const o=(e=this.fontFamily)!==null&&e!==void 0?e:qe.fontFamily,r=(n=this.fontSize)!==null&&n!==void 0?n:qe.fontSize;return this.mathTextMeasure.textSpec.fontFamily===o&&this.mathTextMeasure.textSpec.fontSize===r||(this.mathTextMeasure.textSpec.fontFamily=o,this.mathTextMeasure.textSpec.fontSize=r,this.mathTextMeasure._numberCharSize=null,this.mathTextMeasure._fullCharSize=null,this.mathTextMeasure._letterCharSize=null,this.mathTextMeasure._specialCharSizeMap={}),this.mathTextMeasure.measure(i,t)}putImageData(i,t,e){this.nativeContext.putImageData(i,t,e)}setLineDash(i){const t=arguments,e=this.nativeContext;this.nativeContext.setLineDash?t[0]&&e.setLineDash(t[0]):"mozDash"in e?e.mozDash=t[0]:"webkitLineDash"in e&&(e.webkitLineDash=t[0])}stroke(i){this.disableStroke||(i?this.nativeContext.stroke(i):this.nativeContext.stroke())}strokeRect(i,t,e,n){this.nativeContext.strokeRect(i,t,e,n)}strokeText(i,t,e,n){if(n=n||0,this.camera){this.modelMatrix&&(Pi(St,[t,e,n],this.modelMatrix),t=St[0],e=St[1],n=St[2]);const o=this.camera.vp(t,e,n);t=o.x,e=o.y}this.nativeContext.strokeText(i,t,e)}drawImage(){const i=this.nativeContext,t=arguments;t.length===3?i.drawImage(t[0],t[1],t[2]):t.length===5?i.drawImage(t[0],t[1],t[2],t[3],t[4]):t.length===9&&i.drawImage(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])}setCommonStyle(i,t,e,n,o){if(Array.isArray(o)){if(o.length<=1)return this._setCommonStyle(i,t,e,n,o[0]);const r=Object.create(o[0]);return o.forEach((s,l)=>{l!==0&&Object.assign(r,s)}),this._setCommonStyle(i,t,e,n,r)}return this._setCommonStyle(i,t,e,n,o)}_setCommonStyle(i,t,e,n,o){const r=this.nativeContext;o||(o=this.fillAttributes);const{fillOpacity:s=o.fillOpacity,opacity:l=o.opacity,fill:a=o.fill}=t;r.globalAlpha=s*l*this.baseGlobalAlpha,s>1e-12&&l>1e-12&&(r.fillStyle=ha(this,a,i,e,n))}setShadowBlendStyle(i,t,e){if(Array.isArray(e)){if(e.length<=1)return this._setShadowBlendStyle(i,e[0]);const n=Object.create(e[0]);return e.forEach((o,r)=>{r!==0&&Object.assign(n,o)}),this._setShadowBlendStyle(i,t,n)}return this._setShadowBlendStyle(i,t,e)}_setShadowBlendStyle(i,t,e){const n=this.nativeContext;e||(e=this.fillAttributes);const{opacity:o=e.opacity,shadowBlur:r=e.shadowBlur,shadowColor:s=e.shadowColor,shadowOffsetX:l=e.shadowOffsetX,shadowOffsetY:a=e.shadowOffsetY,blur:h=e.blur,globalCompositeOperation:d=e.globalCompositeOperation}=t;o<=1e-12||(r||l||a?(n.shadowBlur=r*this.dpr,n.shadowColor=s,n.shadowOffsetX=l*this.dpr,n.shadowOffsetY=a*this.dpr,this._clearShadowStyle=!0):this._clearShadowStyle&&(n.shadowBlur=0,n.shadowOffsetX=0,n.shadowOffsetY=0),h?(n.filter=`blur(${h}px)`,this._clearFilterStyle=!0):this._clearFilterStyle&&(n.filter="blur(0px)",this._clearFilterStyle=!1),d?(n.globalCompositeOperation=d,this._clearGlobalCompositeOperationStyle=!0):this._clearGlobalCompositeOperationStyle&&(n.globalCompositeOperation="source-over",this._clearGlobalCompositeOperationStyle=!1))}setStrokeStyle(i,t,e,n,o){if(Array.isArray(o)){if(o.length<=1)return this._setStrokeStyle(i,t,e,n,o[0]);const r=Object.create(o[0]);return o.forEach((s,l)=>{l!==0&&Object.assign(r,s)}),this._setStrokeStyle(i,t,e,n,r)}return this._setStrokeStyle(i,t,e,n,o)}_setStrokeStyle(i,t,e,n,o){const r=this.nativeContext;o||(o=this.strokeAttributes);const{strokeOpacity:s=o.strokeOpacity,opacity:l=o.opacity}=t;if(r.globalAlpha=s*l*this.baseGlobalAlpha,s>1e-12&&l>1e-12){const{lineWidth:a=o.lineWidth,stroke:h=o.stroke,lineJoin:d=o.lineJoin,lineDash:u=o.lineDash,lineCap:c=o.lineCap,miterLimit:f=o.miterLimit,keepStrokeScale:g=o.keepStrokeScale}=t;r.lineWidth=g?a:Bn(this,a,this.dpr),r.strokeStyle=ha(this,h,i,e,n),r.lineJoin=d,u&&r.setLineDash(u),r.lineCap=c,r.miterLimit=f}}setTextStyleWithoutAlignBaseline(i,t,e){const n=this.nativeContext;t||(t=this.textAttributes);const{scaleIn3d:o=t.scaleIn3d}=i;i.font?n.font=i.font:n.font=yu(i,t,o&&this.camera&&this.camera.getProjectionScale(e));const{fontFamily:r=t.fontFamily,fontSize:s=t.fontSize}=i;this.fontFamily=r,this.fontSize=s,n.textAlign="left",n.textBaseline="alphabetic"}setTextStyle(i,t,e){var n,o;const r=this.nativeContext;t||(t=this.textAttributes),i.font?r.font=i.font:r.font=yu(i,t,this.camera&&this.camera.getProjectionScale(e));const{fontFamily:s=t.fontFamily,fontSize:l=t.fontSize}=i;this.fontFamily=s,this.fontSize=l,r.textAlign=(n=i.textAlign)!==null&&n!==void 0?n:t.textAlign,r.textBaseline=(o=i.textBaseline)!==null&&o!==void 0?o:t.textBaseline}draw(){}clearMatrix(i=!0,t=this.dpr){this.setTransformFromMatrix(this._clearMatrix,i,t)}setClearMatrix(i,t,e,n,o,r){this._clearMatrix.setValue(i,t,e,n,o,r)}onlyTranslate(i=this.dpr){return this.matrix.a===i&&this.matrix.b===0&&this.matrix.c===0&&this.matrix.d===i}release(...i){this.stack.forEach(t=>Ze.free(t)),this.stack.length=0}};gr.env="browser",gr=DB([st(),WB("design:paramtypes",[Object,Number])],gr);var VB=function(i,t,e,n){var o,r=arguments.length,s=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var l=i.length-1;l>=0;l--)(o=i[l])&&(s=(r<3?o(s):r>3?o(t,e,s):o(t,e))||s);return r>3&&s&&Object.defineProperty(t,e,s),s},GB=function(i,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,t)};let fr=class extends Vg{constructor(i){super(i)}init(i){const{container:t}=i;if(typeof t=="string"){const e=G.global.getElementById(t);e&&(this._container=e)}else this._container=t;this._context=new gr(this,this._dpr),this.initStyle()}initStyle(){if(!this.controled)return;const{nativeCanvas:i}=this;i.width=this._pixelWidth,i.height=this._pixelHeight,!i.style||this.setCanvasStyle(i,this._x,this._y,this._displayWidth,this._displayHeight),this._container&&this._container.appendChild(i),this.visiable||this.hide()}hide(){this._nativeCanvas&&(this._nativeCanvas.style.display="none")}show(){this._nativeCanvas&&(this._nativeCanvas.style.display="block")}applyPosition(){const i=this._nativeCanvas;i.style.position="absolute",i.style.top=`${this._y}px`,i.style.left=`${this._x}px`}resetStyle(i){if(!this.controled)return;const{width:t=this._displayWidth,height:e=this._displayHeight,dpr:n=this._dpr,x:o=this._x,y:r=this._y}=i,{nativeCanvas:s}=this;s.width=t*n,s.height=e*n,!s.style||this.setCanvasStyle(s,o,r,t,e),i.id&&(s.id=i.id),this.visiable||this.hide()}setCanvasStyle(i,t,e,n,o){this.controled&&(i.style.width=`${n}px`,i.style.height=`${o}px`)}toDataURL(i,t){return i==="image/jpeg"?this._nativeCanvas.toDataURL(i,t):i==="image/png"?this._nativeCanvas.toDataURL(i):this._nativeCanvas.toDataURL(i,t)}resize(i,t){this.controled&&(this._pixelWidth=i*this._dpr,this._pixelHeight=t*this._dpr,this._displayWidth=i,this._displayHeight=t,this._nativeCanvas.style&&(this._nativeCanvas.style.width=`${i}px`,this._nativeCanvas.style.height=`${t}px`),this._nativeCanvas.width=this._pixelWidth,this._nativeCanvas.height=this._pixelHeight,this._context.dpr=this._dpr)}};fr.env="browser",fr=VB([st(),GB("design:paramtypes",[Object])],fr);function YC(i,t){return new Ct(e=>{e(aC).toDynamicValue(()=>n=>new i(n)).whenTargetNamed(i.env),e(J1).toDynamicValue(()=>(n,o)=>new t(n,o)).whenTargetNamed(t.env)})}const jB=YC(fr,gr);var UB=function(i,t,e,n){var o,r=arguments.length,s=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var l=i.length-1;l>=0;l--)(o=i[l])&&(s=(r<3?o(s):r>3?o(t,e,s):o(t,e))||s);return r>3&&s&&Object.defineProperty(t,e,s),s},$B=function(i,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,t)},Qr=function(i,t){return function(e,n){t(e,n,i)}};let sr=class extends uc{constructor(i,t,e){super(e),this.contributions=i,this.drawContribution=t,this.pickItemInterceptorContributions=e,this.global.hooks.onSetEnv.tap("canvas-picker-service",(n,o,r)=>{this.configure(r,o)}),this.configure(this.global,this.global.env),this.pickerMap=new Map,this.init()}init(){this.contributions.getContributions().forEach(i=>{this.pickerMap.set(i.numberType,i)}),super._init()}configure(i,t){this.pickCanvas=yr.shareCanvas(),this.pickContext=this.pickCanvas.getContext("2d")}pickItem(i,t,e,n){if(i.attribute.pickable===!1)return null;if(this.InterceptorContributions.length)for(let a=0;a<this.InterceptorContributions.length;a++){const h=this.InterceptorContributions[a];if(h.beforePickItem){const d=h.beforePickItem(i,this,t,n,{parentMatrix:e});if(d)return d}}const o=this.pickerMap.get(i.numberType);if(!o)return null;const r=o.contains(i,t,n),s=r?i:null,l={graphic:s,params:r};if(s)return l;if(this.InterceptorContributions.length)for(let a=0;a<this.InterceptorContributions.length;a++){const h=this.InterceptorContributions[a];if(h.afterPickItem){const d=h.afterPickItem(i,this,t,n,{parentMatrix:e});if(d)return d}}return l}};sr=UB([st(),Qr(0,At(ge)),Qr(0,Re(ci)),Qr(1,At(zg)),Qr(2,At(ge)),Qr(2,Re(or)),$B("design:paramtypes",[Object,Object,Object])],sr);var KB=function(i,t,e,n){var o,r=arguments.length,s=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var l=i.length-1;l>=0;l--)(o=i[l])&&(s=(r<3?o(s):r>3?o(t,e,s):o(t,e))||s);return r>3&&s&&Object.defineProperty(t,e,s),s};let gc=class{constructor(){this.type="group",this.numberType=Mg}contains(i,t,e){return!1}};gc=KB([st()],gc);const Na=new Ct((i,t,e,n)=>{Na.__vloaded||(Na.__vloaded=!0,i(P0).to(gc).inSingletonScope(),i(ci).toService(P0),Oe(i,ci))});Na.__vloaded=!1;const YB=new Ct((i,t,e,n)=>{e(sr)||i(sr).toSelf().inSingletonScope(),e(cr)?n(cr).toService(sr):i(cr).toService(sr)});function XB(i){i.load(Na),i.load(YB)}var as,qB=function(i,t,e,n){var o,r=arguments.length,s=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var l=i.length-1;l>=0;l--)(o=i[l])&&(s=(r<3?o(s):r>3?o(t,e,s):o(t,e))||s);return r>3&&s&&Object.defineProperty(t,e,s),s},ZB=function(i,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,t)};let Gn=as=class extends Da{get container(){return this.canvas.nativeCanvas.parentElement}static GenerateCanvasId(){return`${as.idprefix}_${as.prefix_count++}`}constructor(){super(),this.type="browser",this._canvasIsIntersecting=!0,this.global=G.global,this.viewBox=new Gt,this.modelMatrix=new Pe(1,0,0,1,0,0)}getTitle(){return this.canvas.id&&this.canvas.id.toString()}getWH(){return{width:this.canvas.width/(this.canvas.dpr||1),height:this.canvas.height/(this.canvas.dpr||1)}}getXY(){return this.canvas.nativeCanvas.getBoundingClientRect()}createWindow(i){i.canvas?this.createWindowByCanvas(i):this.createWindowByConfig(i),this.postInit()}postInit(){if(this.global.optimizeVisible)try{this.observerCanvas()}catch{console.error("发生错误，该环境不存在IntersectionObserver")}}isElementVisible(i){const t=i.getBoundingClientRect(),e=window.innerWidth||document.documentElement.clientWidth,n=window.innerHeight||document.documentElement.clientHeight;return!(t.right<0||t.bottom<0||t.left>e||t.top>n)}observerCanvas(){this._canvasIsIntersecting=this.isElementVisible(this.canvas.nativeCanvas);const i=new IntersectionObserver((t,e)=>{t.forEach(n=>{this._canvasIsIntersecting!==n.isIntersecting?(this._canvasIsIntersecting=n.isIntersecting,this._onVisibleChangeCb&&this._onVisibleChangeCb(n.isIntersecting)):this._canvasIsIntersecting=n.isIntersecting})});i&&i.observe(this.canvas.nativeCanvas)}createWindowByConfig(i){const t=this.global.createCanvas({width:i.width,height:i.height});let e;if(e=typeof i.container=="string"?this.global.getElementById(i.container):i.container?i.container:this.global.getRootElement(),!e)throw new Error("发生错误，containerId可能传入有误");i.offscreen?e=null:e.appendChild(t);const n={width:i.width,height:i.height,dpr:i.dpr,nativeCanvas:t,container:e,id:as.GenerateCanvasId(),canvasControled:!0};this.canvas=new fr(n)}createWindowByCanvas(i){var t;let e;if(typeof i.canvas=="string"){if(e=this.global.getElementById(i.canvas),!e)throw new Error("canvasId 参数不正确，请确认canvas存在并插入dom")}else e=i.canvas;if(!e)throw new Error("发生错误，传入的canvas不正确");let n=i.width,o=i.height;if(n==null||o==null||!i.canvasControled){const s=e.getBoundingClientRect();n=s.width,o=s.height}let r=i.dpr;r==null&&(r=(t=e.getContext("2d").pixelRatio)!==null&&t!==void 0?t:e.width/n),this.canvas=new fr({width:n,height:o,dpr:r,nativeCanvas:e,canvasControled:i.canvasControled})}releaseWindow(){this.canvas.release()}resizeWindow(i,t){this.canvas.resize(i,t)}setDpr(i){this.canvas.dpr=i}getContext(){return this.canvas.getContext()}getNativeHandler(){return this.canvas}getDpr(){return this.canvas.dpr}addEventListener(i,t,e){return this.canvas.nativeCanvas.addEventListener(i,t,e)}removeEventListener(i,t,e){return this.canvas.nativeCanvas.removeEventListener(i,t,e)}dispatchEvent(i){return this.canvas.nativeCanvas.dispatchEvent(i)}getStyle(){var i;return(i=this.canvas.nativeCanvas.style)!==null&&i!==void 0?i:{}}setStyle(i){this.canvas.nativeCanvas.style=i}getBoundingClientRect(){const i=this.canvas.nativeCanvas,t=this.getWH();return i.parentElement?this.canvas.nativeCanvas.getBoundingClientRect():{x:0,y:0,width:t.width,height:t.height,left:0,top:0,right:0,bottom:0}}clearViewBox(i){const t=this.viewBox,e=this.getContext(),n=this.getDpr();e.nativeContext.save(),e.nativeContext.setTransform(n,0,0,n,0,0),e.clearRect(t.x1,t.y1,t.x2-t.x1,t.y2-t.y1),i&&(e.fillStyle=i,e.fillRect(t.x1,t.y1,t.x2-t.x1,t.y2-t.y1)),e.nativeContext.restore()}isVisible(i){return this._canvasIsIntersecting}onVisibleChange(i){this._onVisibleChangeCb=i}getTopLeft(i){return this.global.getElementTopLeft(this.canvas.nativeCanvas,i)}};Gn.env="browser",Gn.idprefix="visactor_window",Gn.prefix_count=0,Gn=as=qB([st(),ZB("design:paramtypes",[])],Gn);const JB=new Ct(i=>{i(Gn).toSelf(),i(xg).toDynamicValue(t=>t.container.get(Gn)).whenTargetNamed(Gn.env)});var QB=function(i,t,e,n){var o,r=arguments.length,s=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var l=i.length-1;l>=0;l--)(o=i[l])&&(s=(r<3?o(s):r>3?o(t,e,s):o(t,e))||s);return r>3&&s&&Object.defineProperty(t,e,s),s},tM=function(i,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,t)},eM=function(i,t,e,n){return new(e||(e=Promise))(function(o,r){function s(h){try{a(n.next(h))}catch(d){r(d)}}function l(h){try{a(n.throw(h))}catch(d){r(d)}}function a(h){var d;h.done?o(h.value):(d=h.value,d instanceof e?d:new e(function(u){u(d)})).then(s,l)}a((n=n.apply(i,t||[])).next())})};class iM{get x1(){return this.dom.getBoundingClientRect().left}get x2(){return this.dom.getBoundingClientRect().right}get y1(){return this.dom.getBoundingClientRect().top}get y2(){return this.dom.getBoundingClientRect().bottom}get width(){return this.dom.getBoundingClientRect().width}get height(){return this.dom.getBoundingClientRect().height}constructor(t){this.dom=t}}function k0(i,t=!1){const e=document.createElement("img");if(G.global.isImageAnonymous&&(e.crossOrigin="anonymous"),t){const n=new Blob([i],{type:"image/svg+xml"});i=window.URL.createObjectURL(n)}return e.src=i,e.complete?Promise.resolve(e):new Promise((n,o)=>{e.onload=()=>{n(e)},e.onerror=()=>{o(new Error("加载失败"))}})}let Va=class extends Oa{constructor(){super(),this.type="browser",this.supportEvent=!0;try{this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.supportsMouseEvents=!!globalThis.MouseEvent}catch{this.supportsTouchEvents=!1,this.supportsPointerEvents=!1,this.supportsPointerEvents=!1}this.applyStyles=!0}mapToCanvasPoint(i,t){var e,n;let o=0,r=0,s=0,l=0;if(i.changedTouches){const a=(e=i.changedTouches[0])!==null&&e!==void 0?e:{};o=a.clientX||0,r=a.clientY||0,s=o,l=r}else o=i.clientX||0,r=i.clientY||0,s=i.offsetX||0,l=i.offsetY||0;if(t){const a=o,h=r,d=t.getBoundingClientRect(),u=(n=t.getNativeHandler)===null||n===void 0?void 0:n.call(t).nativeCanvas;let c,f;return u&&(c=d.width/u.offsetWidth,f=d.height/u.offsetHeight),{x:(a-d.left)/(Yt(c)?c:1),y:(h-d.top)/(Yt(f)?f:1)}}return{x:s,y:l}}getNativeAABBBounds(i){let t=i;if(typeof i=="string"&&(t=new DOMParser().parseFromString(i,"text/html").firstChild,t.lastChild&&(t=t.lastChild.firstChild)),t.getBoundingClientRect){const e=t.getBoundingClientRect();return new iM(e)}return new Gt}removeDom(i){return i.parentElement.removeChild(i),!0}updateDom(i,t){const{width:e,height:n,style:o}=t;return o&&(jt(o)?i.setAttribute("style",o):Object.keys(o).forEach(r=>{i.style[r]=o[r]})),e!=null&&(i.style.width=`${e}px`),n!=null&&(i.style.height=`${n}px`),!0}createDom(i){const{tagName:t="div",parent:e}=i,n=document.createElement(t);if(this.updateDom(n,i),e){const o=jt(e)?this.getElementById(e):e;o&&o.appendChild&&o.appendChild(n)}return n}loadImage(i){return k0(i,!1).then(t=>({data:t,loadState:"success"})).catch(()=>({data:null,loadState:"fail"}))}loadSvg(i){return k0(i,!0).then(t=>({data:t,loadState:"success"})).catch(()=>({data:null,loadState:"fail"}))}createCanvas(i){var t,e;const n=document.createElement("canvas");i.id&&(n.id=(t=i.id)!==null&&t!==void 0?t:fe.GenAutoIncrementId().toString());const o=(e=i.dpr)!==null&&e!==void 0?e:window.devicePixelRatio;return i.width&&i.height&&(n.style.width=`${i.width}px`,n.style.height=`${i.height}px`,n.width=i.width*o,n.height=i.height*o),n}createOffscreenCanvas(i){var t;const e=(t=i.dpr)!==null&&t!==void 0?t:window.devicePixelRatio;return new OffscreenCanvas(i.width*e,i.height*e)}releaseCanvas(i){let t;t=typeof i=="string"?document.getElementById(i):i,t&&t.parentElement&&t.parentElement.removeChild(t)}getDevicePixelRatio(){return window.devicePixelRatio}getRequestAnimationFrame(){return window.requestAnimationFrame}getCancelAnimationFrame(){return window.cancelAnimationFrame}addEventListener(i,t,e){return document.addEventListener(i,t,e)}removeEventListener(i,t,e){return document.removeEventListener(i,t,e)}dispatchEvent(i){return document.dispatchEvent(i)}getElementById(i){return document.getElementById(i)}getRootElement(){return document.body}getDocument(){return document}release(...i){}getElementTop(i,t){let e=i.offsetTop,n=i.offsetParent;for(;n!==null;)e+=n.offsetTop,n=n.offsetParent;return e}getElementLeft(i,t){let e=i.offsetLeft,n=i.offsetParent;for(;n!==null;)e+=n.offsetLeft,n=n.offsetParent;return e}getElementTopLeft(i,t){let e=i.offsetTop,n=i.offsetLeft,o=i.offsetParent;for(;o!==null;)e+=o.offsetTop,n+=o.offsetLeft,o=o.offsetParent;return{top:e,left:n}}loadFont(i,t,e){return eM(this,void 0,void 0,function*(){return new FontFace(i,jt(t)?`url(${t})`:t,e).load().then(function(n){return document.fonts.add(n),{loadState:"success"}}).catch(function(n){return console.error("Failed to load font:",n),{loadState:"fail"}})})}};Va=QB([st(),tM("design:paramtypes",[])],Va);const Ga=new Ct(i=>{Ga.isBrowserBound||(Ga.isBrowserBound=!0,i(Va).toSelf().inSingletonScope(),i(Xh).toService(Va))});Ga.isBrowserBound=!1;function ja(i,t=!0){ja.__loaded||(ja.__loaded=!0,i.load(Ga),i.load(jB),i.load(JB),t&&XB(i))}ja.__loaded=!1;class Mn{contains(t,e,n){if(!t.AABBBounds.containsPoint(e))return!1;if(t.attribute.pickMode==="imprecise")return!0;const{pickContext:o}=n??{};if(!o)return!1;const r=t.getGraphicTheme();o.highPerformanceSave();let{x:s=r.x,y:l=r.y}=t.attribute;if(t.transMatrix.onlyTranslate()){const h=t.getOffsetXY(r);s+=h.x,l+=h.y,o.setTransformForCurrent()}else s=0,l=0,o.transformFromMatrix(t.transMatrix,!0);let a=!1;return this.canvasRenderer.drawShape(t,o,s,l,{},null,(h,d,u)=>!!a||(a=h.isPointInPath(e.x,e.y),a),(h,d,u)=>{if(a)return!0;const c=d.lineWidth||u.lineWidth,f=d.pickStrokeBuffer||u.pickStrokeBuffer,g=d.keepStrokeScale||u.keepStrokeScale;return o.lineWidth=g?c+f:Bn(o,c+f,o.dpr),a=h.isPointInStroke(e.x,e.y),a}),o.highPerformanceRestore(),a}}var nM=function(i,t,e,n){var o,r=arguments.length,s=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var l=i.length-1;l>=0;l--)(o=i[l])&&(s=(r<3?o(s):r>3?o(t,e,s):o(t,e))||s);return r>3&&s&&Object.defineProperty(t,e,s),s},oM=function(i,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,t)},rM=function(i,t){return function(e,n){t(e,n,i)}};let fc=class extends Mn{constructor(i){super(),this.canvasRenderer=i,this.type="arc",this.numberType=Jh}};fc=nM([st(),rM(0,At(xa)),oM("design:paramtypes",[Object])],fc);let E0=!1;const sM=new Ct((i,t,e,n)=>{E0||(E0=!0,i(c0).to(fc).inSingletonScope(),i(io).toService(c0))});var lM=function(i,t,e,n){var o,r=arguments.length,s=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var l=i.length-1;l>=0;l--)(o=i[l])&&(s=(r<3?o(s):r>3?o(t,e,s):o(t,e))||s);return r>3&&s&&Object.defineProperty(t,e,s),s},aM=function(i,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,t)},hM=function(i,t){return function(e,n){t(e,n,i)}};let pc=class extends Mn{constructor(i){super(),this.canvasRenderer=i,this.type="circle",this.numberType=Qh}};pc=lM([st(),hM(0,At(Ra)),aM("design:paramtypes",[Object])],pc);let L0=!1;const dM=new Ct((i,t,e,n)=>{L0||(L0=!0,i(g0).to(pc).inSingletonScope(),i(io).toService(g0))});var uM=function(i,t,e,n){var o,r=arguments.length,s=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var l=i.length-1;l>=0;l--)(o=i[l])&&(s=(r<3?o(s):r>3?o(t,e,s):o(t,e))||s);return r>3&&s&&Object.defineProperty(t,e,s),s};let Mr=class{constructor(){this.type="image",this.numberType=td}contains(i,t,e){const{pickContext:n}=e??{};return!!n&&!!i.AABBBounds.containsPoint(t)}};Mr=uM([st()],Mr);let F0=!1;const cM=new Ct((i,t,e,n)=>{F0||(F0=!0,i(Wa).to(Mr).inSingletonScope(),i(Mr).toService(Wa))});var gM=function(i,t,e,n){var o,r=arguments.length,s=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var l=i.length-1;l>=0;l--)(o=i[l])&&(s=(r<3?o(s):r>3?o(t,e,s):o(t,e))||s);return r>3&&s&&Object.defineProperty(t,e,s),s},fM=function(i,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,t)},pM=function(i,t){return function(e,n){t(e,n,i)}};let vc=class extends Mn{constructor(i){super(),this.canvasRenderer=i,this.type="line",this.numberType=nl}};vc=gM([st(),pM(0,At(Aa)),fM("design:paramtypes",[Object])],vc);let z0=!1;const vM=new Ct((i,t,e,n)=>{z0||(z0=!0,i(f0).to(vc).inSingletonScope(),i(io).toService(f0))});var mM=function(i,t,e,n){var o,r=arguments.length,s=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var l=i.length-1;l>=0;l--)(o=i[l])&&(s=(r<3?o(s):r>3?o(t,e,s):o(t,e))||s);return r>3&&s&&Object.defineProperty(t,e,s),s},bM=function(i,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,t)},CM=function(i,t){return function(e,n){t(e,n,i)}};let mc=class extends Mn{constructor(i){super(),this.canvasRenderer=i,this.type="polygon",this.numberType=id}};mc=mM([st(),CM(0,At(Ma)),bM("design:paramtypes",[Object])],mc);let I0=!1;const _M=new Ct((i,t,e,n)=>{I0||(I0=!0,i(C0).to(mc).inSingletonScope(),i(io).toService(C0))});var wM=function(i,t,e,n){var o,r=arguments.length,s=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var l=i.length-1;l>=0;l--)(o=i[l])&&(s=(r<3?o(s):r>3?o(t,e,s):o(t,e))||s);return r>3&&s&&Object.defineProperty(t,e,s),s},yM=function(i,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,t)},SM=function(i,t){return function(e,n){t(e,n,i)}};let bc=class extends Mn{constructor(i){super(),this.canvasRenderer=i,this.type="path",this.numberType=ed}};bc=wM([st(),SM(0,At(Ba)),yM("design:paramtypes",[Object])],bc);let O0=!1;const xM=new Ct((i,t,e,n)=>{O0||(O0=!0,i(p0).to(bc).inSingletonScope(),i(io).toService(p0))}),jd=new Gt;class XC{constructor(){this.type="rect",this.numberType=Tg}contains(t,e,n){if(!t.AABBBounds.containsPoint(e))return!1;if(t.attribute.pickMode==="imprecise")return!0;const{pickContext:o}=n??{};if(!o)return!1;const r=t.getGraphicTheme(),{cornerRadius:s=r.cornerRadius}=t.attribute;let{x:l=r.x,y:a=r.y}=t.attribute;o.highPerformanceSave();let h=!0;if(t.transMatrix.onlyTranslate()){const u=t.getOffsetXY(r);l+=u.x,a+=u.y,o.setTransformForCurrent()}else l=0,a=0,h=!1,o.transformFromMatrix(t.transMatrix,!0);let d=!0;if(!h||t.shadowRoot||Z(s,!0)&&s!==0||Q(s)&&s.some(u=>u!==0))d=!1,this.canvasRenderer.drawShape(t,o,l,a,{},null,(u,c,f)=>!!d||(d=u.isPointInPath(e.x,e.y),d),(u,c,f)=>{if(d)return!0;const g=c.lineWidth||f.lineWidth,p=c.pickStrokeBuffer||f.pickStrokeBuffer,v=c.keepStrokeScale||f.keepStrokeScale;return o.lineWidth=v?g+p:Bn(o,g+p,o.dpr),d=u.isPointInStroke(e.x,e.y),d});else{const{fill:u=r.fill,stroke:c=r.stroke,lineWidth:f=r.lineWidth}=t.attribute;if(u)d=!0;else if(c){const g=t.AABBBounds;jd.setValue(g.x1,g.y1,g.x2,g.y2),jd.expand(-f/2),d=!jd.containsPoint(e)}}return o.highPerformanceRestore(),d}}var RM=function(i,t,e,n){var o,r=arguments.length,s=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var l=i.length-1;l>=0;l--)(o=i[l])&&(s=(r<3?o(s):r>3?o(t,e,s):o(t,e))||s);return r>3&&s&&Object.defineProperty(t,e,s),s},AM=function(i,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,t)},BM=function(i,t){return function(e,n){t(e,n,i)}};let Cc=class extends XC{constructor(i){super(),this.canvasRenderer=i}};Cc=RM([st(),BM(0,At(Ta)),AM("design:paramtypes",[Object])],Cc);let D0=!1;const MM=new Ct((i,t,e,n)=>{D0||(D0=!0,i(v0).to(Cc).inSingletonScope(),i(io).toService(v0))});let W0=!1;const TM=new Ct((i,t,e,n)=>{W0||(W0=!0,i(Wa).to(Mr).inSingletonScope(),i(Mr).toService(Wa))});var PM=function(i,t,e,n){var o,r=arguments.length,s=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var l=i.length-1;l>=0;l--)(o=i[l])&&(s=(r<3?o(s):r>3?o(t,e,s):o(t,e))||s);return r>3&&s&&Object.defineProperty(t,e,s),s},HM=function(i,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,t)},kM=function(i,t){return function(e,n){t(e,n,i)}};let _c=class extends Mn{constructor(i){super(),this.canvasRenderer=i,this.type="symbol",this.numberType=nd}};_c=PM([st(),kM(0,At(Pa)),HM("design:paramtypes",[Object])],_c);let N0=!1;const EM=new Ct((i,t,e,n)=>{N0||(N0=!0,i(m0).to(_c).inSingletonScope(),i(io).toService(m0))});var LM=function(i,t,e,n){var o,r=arguments.length,s=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var l=i.length-1;l>=0;l--)(o=i[l])&&(s=(r<3?o(s):r>3?o(t,e,s):o(t,e))||s);return r>3&&s&&Object.defineProperty(t,e,s),s};let wc=class{constructor(){this.type="text",this.numberType=od}contains(i,t,e){return!!i.AABBBounds.containsPoint(t)}};wc=LM([st()],wc);let V0=!1;const FM=new Ct((i,t,e,n)=>{V0||(V0=!0,i(b0).to(wc).inSingletonScope(),i(io).toService(b0))});var zM=function(i,t,e,n){var o,r=arguments.length,s=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var l=i.length-1;l>=0;l--)(o=i[l])&&(s=(r<3?o(s):r>3?o(t,e,s):o(t,e))||s);return r>3&&s&&Object.defineProperty(t,e,s),s},IM=function(i,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,t)};let vs=class extends gr{constructor(i,t){super(i,t);const e=i.nativeCanvas.getContext("2d");if(!e)throw new Error("发生错误，获取2d上下文失败");this.nativeContext=e,this.canvas=i,this.matrix=new Pe(1,0,0,1,0,0),this.stack=[],this.dpr=t??1}release(...i){}};vs.env="node",vs=zM([st(),IM("design:paramtypes",[Object,Number])],vs);var OM=function(i,t,e,n){var o,r=arguments.length,s=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var l=i.length-1;l>=0;l--)(o=i[l])&&(s=(r<3?o(s):r>3?o(t,e,s):o(t,e))||s);return r>3&&s&&Object.defineProperty(t,e,s),s},DM=function(i,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,t)};let pr=class extends Vg{constructor(i){super(i)}init(){this._context=new vs(this,this._dpr),this.nativeCanvas.width=this._pixelWidth,this.nativeCanvas.height=this._pixelHeight}release(...i){this._nativeCanvas.release&&Mt(this._nativeCanvas.release)&&this._nativeCanvas.release()}};pr.env="node",pr=OM([st(),DM("design:paramtypes",[Object])],pr);const WM=YC(pr,vs);var NM=function(i,t,e,n){var o,r=arguments.length,s=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var l=i.length-1;l>=0;l--)(o=i[l])&&(s=(r<3?o(s):r>3?o(t,e,s):o(t,e))||s);return r>3&&s&&Object.defineProperty(t,e,s),s},VM=function(i,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,t)},GM=function(i,t){return function(e,n){t(e,n,i)}};let vr=class extends Da{get container(){return null}constructor(i){super(),this.global=i,this.type="node"}getTitle(){return""}getWH(){return{width:this.canvas.displayWidth,height:this.canvas.displayHeight}}getXY(){return{x:0,y:0}}createWindow(i){i.canvas?this.createWindowByCanvas(i):this.createWindowByConfig(i)}createWindowByConfig(i){const t=this.global.createCanvas({width:i.width,height:i.height}),e={width:i.width,height:i.height,dpr:i.dpr,nativeCanvas:t,id:fe.GenAutoIncrementId().toString(),canvasControled:!0};this.canvas=new pr(e)}createWindowByCanvas(i){const t=i.canvas;let e=i.width,n=i.height;e!=null&&n!=null&&i.canvasControled||(e=t.width,n=t.height),this.canvas=new pr({width:e,height:n,dpr:1,nativeCanvas:t,canvasControled:i.canvasControled})}releaseWindow(){this.canvas.release()}resizeWindow(i,t){this.canvas.resize(i,t)}setDpr(i){this.canvas.dpr=i}getContext(){return this.canvas.getContext()}getNativeHandler(){return this.canvas}getDpr(){return this.canvas.dpr}getImageBuffer(i="image/png"){return this.canvas.nativeCanvas.toBuffer(i)}addEventListener(i,t,e){}dispatchEvent(i){return!0}removeEventListener(i,t,e){}getStyle(){}setStyle(i){}getBoundingClientRect(){return null}clearViewBox(i){}};vr.env="node",vr=NM([st(),GM(0,At(_g)),VM("design:paramtypes",[Object])],vr);const jM=new Ct(i=>{i(vr).toSelf(),i(xg).toDynamicValue(t=>t.container.get(vr)).whenTargetNamed(vr.env)});var UM=function(i,t,e,n){var o,r=arguments.length,s=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var l=i.length-1;l>=0;l--)(o=i[l])&&(s=(r<3?o(s):r>3?o(t,e,s):o(t,e))||s);return r>3&&s&&Object.defineProperty(t,e,s),s};let Ua=class extends Oa{constructor(){super(...arguments),this.type="node",this._lastTime=0,this.supportEvent=!1}configure(i,t){i.env===this.type&&(i.setActiveEnvContribution(this),this.pkg=t)}getDynamicCanvasCount(){return 0}getStaticCanvasCount(){return 999}loadJson(i){const t=fetch(i).then(e=>e.json());return t.then(e=>({data:e,state:"success"})).catch(()=>({data:null,state:"fail"})),t}loadArrayBuffer(i){return fetch(i).then(t=>t.arrayBuffer()).then(t=>({data:t,loadState:"success"})).catch(()=>({data:null,loadState:"fail"}))}loadImage(i){const{loadImage:t}=this.pkg;return t?t(i).then(e=>({loadState:e?"success":"fail",data:e})).catch(()=>({loadState:"fail",data:null})):Promise.reject(new Error("node-canvas loadImage could not be found!"))}loadSvg(i){const t=this.pkg.Resvg;if(!t)return Promise.reject(new Error("@resvg/resvg-js svgParser could not be found!"));const e=new t(i).render().asPng();return this.loadImage(e)}createCanvas(i){return this.pkg.createCanvas(i.width,i.height)}releaseCanvas(i){}getDevicePixelRatio(){return 1}getRequestAnimationFrame(){return function(i){return Nf.call(i)}}getCancelAnimationFrame(){return i=>{Nf.clear(i)}}addEventListener(i,t,e){}removeEventListener(i,t,e){}getElementById(i){return null}getRootElement(){return null}dispatchEvent(i){}release(...i){}createOffscreenCanvas(i){}};Ua=UM([st()],Ua);const $a=new Ct(i=>{$a.isNodeBound||($a.isNodeBound=!0,i(Ua).toSelf().inSingletonScope(),i(Xh).toService(Ua))});$a.isNodeBound=!1;function Ka(i,t=!0){Ka.__loaded||(Ka.__loaded=!0,i.load($a),i.load(WM),i.load(jM))}Ka.__loaded=!1;var $M=function(i,t,e,n){var o,r=arguments.length,s=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var l=i.length-1;l>=0;l--)(o=i[l])&&(s=(r<3?o(s):r>3?o(t,e,s):o(t,e))||s);return r>3&&s&&Object.defineProperty(t,e,s),s},KM=function(i,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,t)},YM=function(i,t){return function(e,n){t(e,n,i)}};let yc=class extends Mn{constructor(i){super(),this.canvasRenderer=i,this.type="arc",this.numberType=Jh}};yc=$M([st(),YM(0,At(xa)),KM("design:paramtypes",[Object])],yc);let G0=!1;const XM=new Ct((i,t,e,n)=>{G0||(G0=!0,i(_0).to(yc).inSingletonScope(),i(ci).toService(_0))});var qM=function(i,t,e,n){var o,r=arguments.length,s=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var l=i.length-1;l>=0;l--)(o=i[l])&&(s=(r<3?o(s):r>3?o(t,e,s):o(t,e))||s);return r>3&&s&&Object.defineProperty(t,e,s),s},ZM=function(i,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,t)},JM=function(i,t){return function(e,n){t(e,n,i)}};let Sc=class extends XC{constructor(i){super(),this.canvasRenderer=i}};Sc=qM([st(),JM(0,At(Ta)),ZM("design:paramtypes",[Object])],Sc);let j0=!1;const QM=new Ct((i,t,e,n)=>{j0||(j0=!0,i(R0).to(Sc).inSingletonScope(),i(ci).toService(R0))});class qC extends ei{contains(t,e,n){if(!t.AABBBounds.containsPoint(e))return!1;if(t.attribute.pickMode==="imprecise")return!0;const{pickContext:o}=n??{};if(!o)return!1;o.highPerformanceSave();const r=t.getGraphicTheme(),s=this.transform(t,r,o),{x:l,y:a,z:h,lastModelMatrix:d}=s;let u=e;if(o.camera){u=e.clone();const f=t.parent.globalTransMatrix;u.x=f.a*e.x+f.c*e.y+f.e,u.y=f.b*e.x+f.d*e.y+f.f}this.canvasRenderer.z=h;let c=!1;return this.canvasRenderer.drawShape(t,o,l,a,{},null,f=>!!c||(c=f.isPointInPath(u.x,u.y),c),(f,g,p)=>{if(c)return!0;const v=g.lineWidth||p.lineWidth,m=g.pickStrokeBuffer||p.pickStrokeBuffer,b=g.keepStrokeScale||p.keepStrokeScale;return o.lineWidth=b?v+m:Bn(o,v+m,o.dpr),c=f.isPointInStroke(u.x,u.y),c}),this.canvasRenderer.z=0,o.modelMatrix!==d&&ce.free(o.modelMatrix),o.modelMatrix=d,o.highPerformanceRestore(),c}}var tT=function(i,t,e,n){var o,r=arguments.length,s=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var l=i.length-1;l>=0;l--)(o=i[l])&&(s=(r<3?o(s):r>3?o(t,e,s):o(t,e))||s);return r>3&&s&&Object.defineProperty(t,e,s),s},eT=function(i,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,t)},iT=function(i,t){return function(e,n){t(e,n,i)}};let xc=class extends qC{constructor(i){super(),this.canvasRenderer=i,this.type="line",this.numberType=nl}};xc=tT([st(),iT(0,At(Aa)),eT("design:paramtypes",[Object])],xc);let U0=!1;const nT=new Ct((i,t,e,n)=>{U0||(U0=!0,i(S0).to(xc).inSingletonScope(),i(ci).toService(S0))});class ZC extends ei{contains(t,e,n){const{pickContext:o}=n??{};if(!o)return!1;const r=t.getGraphicTheme();o.highPerformanceSave();const s=this.transform(t,r,o),{x:l,y:a,z:h,lastModelMatrix:d}=s;let u=e;if(o.camera){u=e.clone();const f=t.parent.globalTransMatrix;u.x=f.a*e.x+f.c*e.y+f.e,u.y=f.b*e.x+f.d*e.y+f.f}this.canvasRenderer.z=h;let c=!1;return this.canvasRenderer.drawShape(t,o,l,a,n,null,(f,g,p)=>!!c||(c=f.isPointInPath(u.x,u.y),c)),this.canvasRenderer.z=0,o.modelMatrix!==d&&ce.free(o.modelMatrix),o.modelMatrix=d,o.highPerformanceRestore(),c}}var oT=function(i,t,e,n){var o,r=arguments.length,s=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var l=i.length-1;l>=0;l--)(o=i[l])&&(s=(r<3?o(s):r>3?o(t,e,s):o(t,e))||s);return r>3&&s&&Object.defineProperty(t,e,s),s},rT=function(i,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,t)},sT=function(i,t){return function(e,n){t(e,n,i)}};let Rc=class extends ZC{constructor(i){super(),this.canvasRenderer=i,this.type="symbol",this.numberType=nd}contains(i,t,e){const{pickContext:n}=e??{};if(!n)return!1;const o=i.getParsedPath();if(!n.camera){if(!i.AABBBounds.containsPoint(t))return!1;if(o.isSvg||i.attribute.pickMode==="imprecise")return!0}n.highPerformanceSave();const r=i.getGraphicTheme(),s=this.transform(i,r,n),{x:l,y:a,z:h,lastModelMatrix:d}=s;let u=t;if(n.camera){u=t.clone();const f=i.parent.globalTransMatrix;u.x=f.a*t.x+f.c*t.y+f.e,u.y=f.b*t.x+f.d*t.y+f.f}this.canvasRenderer.z=h;let c=!1;return this.canvasRenderer.drawShape(i,n,l,a,{},null,(f,g,p)=>!!c||(c=f.isPointInPath(u.x,u.y),c),(f,g,p)=>{if(c)return!0;const v=g.lineWidth||p.lineWidth,m=g.pickStrokeBuffer||p.pickStrokeBuffer,b=g.keepStrokeScale||p.keepStrokeScale;return n.lineWidth=b?v+m:Bn(n,v+m,n.dpr),c=f.isPointInStroke(u.x,u.y),c}),this.canvasRenderer.z=0,n.modelMatrix!==d&&ce.free(n.modelMatrix),n.modelMatrix=d,n.highPerformanceRestore(),c}};Rc=oT([st(),sT(0,At(Pa)),rT("design:paramtypes",[Object])],Rc);let $0=!1;const lT=new Ct((i,t,e,n)=>{$0||($0=!0,i(A0).to(Rc).inSingletonScope(),i(ci).toService(A0))});var aT=function(i,t,e,n){var o,r=arguments.length,s=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var l=i.length-1;l>=0;l--)(o=i[l])&&(s=(r<3?o(s):r>3?o(t,e,s):o(t,e))||s);return r>3&&s&&Object.defineProperty(t,e,s),s},hT=function(i,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,t)},dT=function(i,t){return function(e,n){t(e,n,i)}};let Ac=class extends Mn{constructor(i){super(),this.canvasRenderer=i,this.type="circle",this.numberType=Qh}};Ac=aT([st(),dT(0,At(Ra)),hT("design:paramtypes",[Object])],Ac);let K0=!1;const uT=new Ct((i,t,e,n)=>{K0||(K0=!0,i(w0).to(Ac).inSingletonScope(),i(ci).toService(w0))});var cT=function(i,t,e,n){var o,r=arguments.length,s=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var l=i.length-1;l>=0;l--)(o=i[l])&&(s=(r<3?o(s):r>3?o(t,e,s):o(t,e))||s);return r>3&&s&&Object.defineProperty(t,e,s),s},gT=function(i,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,t)},fT=function(i,t){return function(e,n){t(e,n,i)}};let Bc=class extends ZC{constructor(i){super(),this.canvasRenderer=i,this.type="text",this.numberType=od}contains(i,t,e){const{pickContext:n}=e??{};if(!n)return!1;const o=i.AABBBounds;if(!n.camera)return!!o.containsPoint(t);n.highPerformanceSave();const r=i.getGraphicTheme(),{keepDirIn3d:s=r.keepDirIn3d}=i.attribute,l=!s,a=this.transform(i,r,n,l),{x:h,y:d,z:u,lastModelMatrix:c}=a;this.canvasRenderer.z=u;let f=t;if(n.camera){f=t.clone();const p=i.parent.globalTransMatrix;f.x=p.a*t.x+p.c*t.y+p.e,f.y=p.b*t.x+p.d*t.y+p.f}let g=!1;return this.canvasRenderer.drawShape(i,n,h,d,{},null,(p,v,m)=>{if(g)return!0;const{fontSize:b=r.fontSize,textBaseline:C=r.textBaseline,textAlign:_=r.textAlign}=i.attribute,w=i.AABBBounds,y=w.height(),x=w.width(),S=Es(C,y,b),R=Sr(_,x);return p.rect(R+h,S+d,x,y,u),g=p.isPointInPath(f.x,f.y),g},(p,v,m)=>g),this.canvasRenderer.z=0,n.modelMatrix!==c&&ce.free(n.modelMatrix),n.modelMatrix=c,n.highPerformanceRestore(),g}};Bc=cT([st(),fT(0,At(Zu)),gT("design:paramtypes",[Object])],Bc);let Y0=!1;const pT=new Ct((i,t,e,n)=>{Y0||(Y0=!0,i(B0).to(Bc).inSingletonScope(),i(ci).toService(B0))});var vT=function(i,t,e,n){var o,r=arguments.length,s=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var l=i.length-1;l>=0;l--)(o=i[l])&&(s=(r<3?o(s):r>3?o(t,e,s):o(t,e))||s);return r>3&&s&&Object.defineProperty(t,e,s),s},mT=function(i,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,t)},bT=function(i,t){return function(e,n){t(e,n,i)}};let Mc=class extends qC{constructor(i){super(),this.canvasRenderer=i,this.type="path",this.numberType=ed}};Mc=vT([st(),bT(0,At(Ba)),mT("design:paramtypes",[Object])],Mc);let X0=!1;const CT=new Ct((i,t,e,n)=>{X0||(X0=!0,i(x0).to(Mc).inSingletonScope(),i(ci).toService(x0))});var _T=function(i,t,e,n){var o,r=arguments.length,s=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var l=i.length-1;l>=0;l--)(o=i[l])&&(s=(r<3?o(s):r>3?o(t,e,s):o(t,e))||s);return r>3&&s&&Object.defineProperty(t,e,s),s},wT=function(i,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,t)},yT=function(i,t){return function(e,n){t(e,n,i)}};let Tc=class extends Mn{constructor(i){super(),this.canvasRenderer=i,this.type="polygon",this.numberType=id}};Tc=_T([st(),yT(0,At(Ma)),wT("design:paramtypes",[Object])],Tc);let q0=!1;const ST=new Ct((i,t,e,n)=>{q0||(q0=!0,i(M0).to(Tc).inSingletonScope(),i(ci).toService(M0))});var xT=function(i,t,e,n){var o,r=arguments.length,s=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var l=i.length-1;l>=0;l--)(o=i[l])&&(s=(r<3?o(s):r>3?o(t,e,s):o(t,e))||s);return r>3&&s&&Object.defineProperty(t,e,s),s},RT=function(i,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,t)},AT=function(i,t){return function(e,n){t(e,n,i)}};let Pc=class{constructor(i){this.canvasRenderer=i,this.type="richtext",this.numberType=Pg}contains(i,t,e){return!!i.AABBBounds.containsPoint(t)}};Pc=xT([st(),AT(0,At(Ju)),RT("design:paramtypes",[Object])],Pc);let Z0=!1;const BT=new Ct((i,t,e,n)=>{Z0||(Z0=!0,i(T0).to(Pc).inSingletonScope(),i(ci).toService(T0))});var MT=function(i,t,e,n){var o,r=arguments.length,s=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var l=i.length-1;l>=0;l--)(o=i[l])&&(s=(r<3?o(s):r>3?o(t,e,s):o(t,e))||s);return r>3&&s&&Object.defineProperty(t,e,s),s};let Hc=class{constructor(){this.type="image",this.numberType=td}contains(i,t,e){const{pickContext:n}=e??{};return!!n&&!!i.AABBBounds.containsPoint(t)}};Hc=MT([st()],Hc);let J0=!1;const TT=new Ct((i,t,e,n)=>{J0||(J0=!0,i(y0).to(Hc).inSingletonScope(),i(ci).toService(y0))}),nn=Ng();function Ya(){Ya.__loaded||(Ya.__loaded=!0,yB(),bt.load(dB),bt.load(nn?XM:sM))}Ya.__loaded=!1;const PT=Ya;function Xa(){Xa.__loaded||(Xa.__loaded=!0,SB(),bt.load(fB),bt.load(nn?uT:dM))}Xa.__loaded=!1;const JC=Xa;function qa(){qa.__loaded||(qa.__loaded=!0,xB())}qa.__loaded=!1;const ii=qa;function Za(){Za.__loaded||(Za.__loaded=!0,RB(),bt.load(wB),bt.load(nn?TT:cM))}Za.__loaded=!1;const hd=Za;function Ja(){Ja.__loaded||(Ja.__loaded=!0,AB(),bt.load(cB),bt.load(nn?nT:vM))}Ja.__loaded=!1;const Gg=Ja;function Qa(){Qa.__loaded||(Qa.__loaded=!0,BB(),bt.load(vB),bt.load(nn?CT:xM))}Qa.__loaded=!1;const HT=Qa;function th(){th.__loaded||(th.__loaded=!0,MB(),bt.load(mB),bt.load(nn?ST:_M))}th.__loaded=!1;const kT=th;function eh(){eh.__loaded||(eh.__loaded=!0,TB(),bt.load(uB),bt.load(nn?QM:MM))}eh.__loaded=!1;const Tn=eh;function ih(){ih.__loaded||(ih.__loaded=!0,PB(),bt.load(_B),bt.load(nn?BT:TM))}ih.__loaded=!1;const dd=ih;function nh(){nh.__loaded||(nh.__loaded=!0,EB())}nh.__loaded=!1;const ET=nh;function oh(){oh.__loaded||(oh.__loaded=!0,HB(),bt.load(gB),bt.load(nn?lT:EM))}oh.__loaded=!1;const Or=oh;function rh(){rh.__loaded||(rh.__loaded=!0,kB(),bt.load(pB),bt.load(nn?pT:FM))}rh.__loaded=!1;const on=rh;function sh(){sh.__loaded||(sh.__loaded=!0,LB())}sh.__loaded=!1;const LT=sh;function QC(){ii(),Tn()}const t_="PingFang SC,Helvetica Neue,Microsoft Yahei,system-ui,-apple-system,segoe ui,Roboto,Helvetica,Arial,sans-serif,apple color emoji,segoe ui emoji,segoe ui symbol",FT=14;var je;(function(i){i.selected="selected",i.selectedReverse="selected_reverse",i.hover="hover",i.hoverReverse="hover_reverse"})(je||(je={}));const Go={[je.selectedReverse]:{},[je.selected]:{},[je.hover]:{},[je.hoverReverse]:{}},Q0={container:"",width:30,height:30,style:{}},zT="scrollDrag",tv={debounce:yy,throttle:zb};QC();class Eo extends gi{constructor(t,e){super(e!=null&&e.skipDefault?t:rt({},Eo.defaultAttributes,t)),this.name="scrollbar",this._onRailPointerDown=n=>{const{viewX:o,viewY:r}=n,{direction:s,width:l,height:a,range:h}=this.attribute,d=this._sliderSize,[u,c]=this._getScrollRange();let f;if(s==="vertical"){const g=r-this._viewPosition.y,p=Li(g-d/2,u,c);f=g/a,this._slider.setAttribute("y",p,!0)}else{const g=o-this._viewPosition.x,p=Li(g-d/2,u,c);f=g/l,this._slider.setAttribute("x",p,!0)}this.setScrollRange([f-(h[1]-h[0])/2,f+(h[1]-h[0])/2],!1),this.stage&&!this.stage.autoRender&&this.stage.renderNextFrame()},this._onSliderPointerDown=n=>{const{stopSliderDownPropagation:o=!0}=this.attribute;o&&n.stopPropagation();const{direction:r}=this.attribute,{x:s,y:l}=this.stage.eventPointTransform(n);this._prePos=r==="horizontal"?s:l,this._dispatchEvent("scrollDown",{pos:this._prePos,event:n}),Qt.env==="browser"?(Qt.addEventListener("pointermove",this._onSliderPointerMoveWithDelay,{capture:!0}),Qt.addEventListener("pointerup",this._onSliderPointerUp)):(this.stage.addEventListener("pointermove",this._onSliderPointerMoveWithDelay,{capture:!0}),this.stage.addEventListener("pointerup",this._onSliderPointerUp),this.stage.addEventListener("pointerupoutside",this._onSliderPointerUp))},this._computeScrollValue=n=>{const{direction:o}=this.attribute,{x:r,y:s}=this.stage.eventPointTransform(n);let l,a,h=0;const{width:d,height:u}=this.getSliderRenderBounds();return o==="vertical"?(a=s,h=a-this._prePos,l=h/u):(a=r,h=a-this._prePos,l=h/d),[a,l]},this._onSliderPointerMove=n=>{const{stopSliderMovePropagation:o=!0}=this.attribute;o&&n.stopPropagation();const r=this.getScrollRange(),[s,l]=this._computeScrollValue(n);this.setScrollRange([r[0]+l,r[1]+l],!0),this._prePos=s},this._onSliderPointerMoveWithDelay=this.attribute.delayTime===0?this._onSliderPointerMove:tv[this.attribute.delayType](this._onSliderPointerMove,this.attribute.delayTime),this._onSliderPointerUp=n=>{n.preventDefault();const{realTime:o=!0,range:r,limitRange:s=[0,1]}=this.attribute,l=this.getScrollRange(),[a,h]=this._computeScrollValue(n),d=[l[0]+h,l[1]+h];this._dispatchEvent("scrollUp",{pre:r,value:lo(d,s[0],s[1])}),Qt.env==="browser"?(Qt.removeEventListener("pointermove",this._onSliderPointerMoveWithDelay,{capture:!0}),Qt.removeEventListener("pointerup",this._onSliderPointerUp)):(this.stage.removeEventListener("pointermove",this._onSliderPointerMoveWithDelay,{capture:!0}),this.stage.removeEventListener("pointerup",this._onSliderPointerUp),this.stage.removeEventListener("pointerupoutside",this._onSliderPointerUp))}}setScrollRange(t,e=!0){const{direction:n="horizontal",limitRange:o=[0,1],range:r,realTime:s=!0}=this.attribute,l=lo(t,o[0],o[1]);if(e){const a=this._getSliderPos(l);if(this._slider){const h=a[1]-a[0];this._sliderSize=h,n==="horizontal"?this._slider.setAttributes({x:a[0],width:h},!0):this._slider.setAttributes({y:a[0],height:h},!0),this.stage&&!this.stage.autoRender&&this.stage.renderNextFrame()}}this.attribute.range=l,s&&this._dispatchEvent(zT,{pre:r,value:l})}getScrollRange(){return this.attribute.range}bindEvents(){if(this.attribute.disableTriggerEvent)return;const{delayType:t="throttle",delayTime:e=0}=this.attribute;this._rail&&this._rail.addEventListener("pointerdown",tv[t](this._onRailPointerDown,e)),this._slider&&this._slider.addEventListener("pointerdown",this._onSliderPointerDown)}render(){this._reset();const{direction:t="horizontal",width:e,height:n,range:o,limitRange:r=[0,1],railStyle:s,sliderStyle:l,padding:a=2}=this.attribute,h=this.createOrUpdateChild("scrollbar-container",{},"group"),d=h.createOrUpdateChild("scrollbar-rail",Object.assign({x:0,y:0,width:e,height:n},s),"rect");this._rail=d;const u=this.getSliderRenderBounds(),c=this._getSliderPos(lo(o,r[0],r[1])),f=c[1]-c[0];let g;this._sliderSize=f,g=t==="horizontal"?{x:c[0],y:u.y1,width:f,height:u.height}:{x:u.x1,y:c[0],width:u.width,height:f};const p=h.createOrUpdateChild("slider",Object.assign(Object.assign(Object.assign(Object.assign({},g),{cornerRadius:this._getDefaultSliderCornerRadius()}),l),{boundsPadding:Qi(a),pickMode:"imprecise"}),"rect");this._slider=p,this._container=h;const v=this._container.AABBBounds;this._viewPosition={x:v.x1,y:v.y1}}getSliderRenderBounds(){if(this._sliderRenderBounds)return this._sliderRenderBounds;const{width:t,height:e,padding:n=2}=this.attribute,[o,r,s,l]=Qi(n),a={x1:l,y1:o,x2:t-r,y2:e-s,width:Math.max(0,t-(l+r)),height:Math.max(0,e-(o+s))};return this._sliderRenderBounds=a,a}_getDefaultSliderCornerRadius(){const{direction:t,round:e}=this.attribute;if(e){const{width:n,height:o}=this.getSliderRenderBounds();return t==="horizontal"?o:n}return 0}_getSliderPos(t){const{direction:e}=this.attribute,{width:n,height:o,x1:r,y1:s}=this.getSliderRenderBounds();return e==="horizontal"?[n*t[0]+r,n*t[1]+r]:[o*t[0]+s,o*t[1]+s]}_getScrollRange(){if(this._sliderLimitRange)return this._sliderLimitRange;const{limitRange:t=[0,1],direction:e}=this.attribute,[n,o]=lo(t,0,1),{width:r,height:s,x1:l,y1:a}=this.getSliderRenderBounds(),h=this._sliderSize;return e==="horizontal"?lo([l+n*r,l+o*r],l,r-h):lo([a+n*s,a+o*s],a,s-h)}_reset(){this._sliderRenderBounds=null,this._sliderLimitRange=null}}Eo.defaultAttributes={direction:"horizontal",round:!0,sliderSize:20,sliderStyle:{fill:"rgba(0, 0, 0, .5)"},railStyle:{fill:"rgba(0, 0, 0, .0)"},padding:2,scrollRange:[0,1],delayType:"throttle",delayTime:0,realTime:!0};function Tr(i,t){i.forEachChildren(e=>{const n=t(e);e.isContainer&&!n&&Tr(e,t)})}function e_(i,t){return[i[0]*t,i[1]*t]}function i_(i){const[t,e]=i;return Math.sqrt(t*t+e*e)}function IT(i){let t=i_(i);return t>0&&(t=1/t),[i[0]*t,i[1]*t]}function OT(i,t){const[e,n]=i,[o,r]=t,s=Math.sqrt((e*e+n*n)*(o*o+r*r)),l=s&&(e*o+n*r)/s;return Math.acos(Math.min(Math.max(l,-1),1))}function DT(i,t,e){const n=OT(i,t),o=Sy(i,t)>=0;return e?o?2*Math.PI-n:n:o?n:2*Math.PI-n}const n_=(i,t,e,n)=>new wn(Object.assign({defaultFontParams:Object.assign({fontFamily:t_,fontSize:FT},n),getTextBounds:sd,specialCharSet:`-/: .,@%'"~`+wn.ALPHABET_CHAR_SET+wn.ALPHABET_CHAR_SET.toUpperCase()},{}),i);function ud(i,t,e={}){if(!i)return{width:0,height:0};const n=sd({text:i,fontFamily:t.fontFamily||e.fontFamily||t_,fontSize:t.fontSize||e.fontSize||12,fontWeight:t.fontWeight||e.fontWeight,textAlign:t.textAlign||"center",textBaseline:t.textBaseline,ellipsis:!!t.ellipsis,maxLineWidth:t.maxLineWidth||1/0,lineHeight:t.fontSize||e.fontSize||12});return{width:n.width(),height:n.height()}}function WT(i,t="type"){return o_(i,t)==="rich"}function o_(i,t="type"){var e,n;return kt(i.text)&&"type"in i.text?(e=i.text.type)!==null&&e!==void 0?e:"text":t in i&&(n=i[t])!==null&&n!==void 0?n:"text"}function r_(i){var t,e;return O(i.maxLineWidth)&&(i.maxWidth=i.maxLineWidth,delete i.maxLineWidth),i.width=(t=i.width)!==null&&t!==void 0?t:0,i.height=(e=i.height)!==null&&e!==void 0?e:0,i.textConfig=i.text.text||i.text,i}function NT(i){const{text:t,_originText:e}=i,{text:n}=t;return i.html=n,i.text=e,i.renderable=!1,i}function VT(i){const{text:t,_originText:e}=i,{text:n}=t;return i.react=n,i.text=e,i.renderable=!1,i}function kc(i,t="type"){const e=o_(i,t);return e==="rich"?ft.richtext(r_(i)):(e==="html"?i=NT(i):e==="react"&&(i=VT(i)),ft.text(i))}function s_(){ii(),Tn(),Or(),dd(),on()}var ev=function(i,t){var e={};for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&t.indexOf(n)<0&&(e[n]=i[n]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function"){var o=0;for(n=Object.getOwnPropertySymbols(i);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(i,n[o])&&(e[n[o]]=i[n[o]])}return e};s_();let ll=class Ec extends gi{getBgRect(){return this._bgRect}getTextShape(){return this._textShape}constructor(t,e){super(e!=null&&e.skipDefault?t:rt({},Ec.defaultAttributes,t)),this.name="tag",this._tagStates=[],this._rectStates=[],this._symbolStates=[],this._textStates=[]}render(){var t,e,n;this.cacheStates();const{text:o="",textStyle:r={},shape:s={},panel:l={},space:a=4,minWidth:h,maxWidth:d,padding:u=4,visible:c,state:f,type:g,textAlwaysCenter:p,containerTextAlign:v}=this.attribute,m=Qi(u),b=this.createOrUpdateChild("tag-content",{x:0,y:0,zIndex:1},"group");let C,_=-m[3],w=-m[0],y=m[1]+m[3],x=m[0]+m[2],S=0,R=0;const{visible:B}=s,A=ev(s,["visible"]);if(He(B)){const T=(A==null?void 0:A.size)||10,P=Z(T)?T:Math.max(T[0],T[1]);C=b.createOrUpdateChild("tag-shape",Object.assign(Object.assign({symbolType:"circle",size:T,strokeBoundsBuffer:0},A),{visible:B,x:P/2,y:P/2}),"symbol"),wt(f==null?void 0:f.shape)||(C.states=f.shape),B&&(R=P+a)}let M;if(y+=R,S+=R,WT({text:o})||g==="rich"){const T=Object.assign(Object.assign(Object.assign({},r_(Object.assign({type:g,text:o},r))),r),{visible:O(o)&&c!==!1,x:S,y:0});M=b.createOrUpdateChild("tag-text",T,"richtext"),y+=M.AABBBounds.width(),x+=M.AABBBounds.height(),_+=M.AABBBounds.x1,w+=M.AABBBounds.y1}else{const T=Object.assign(Object.assign({text:kt(o)&&"type"in o&&o.type==="text"?o.text:o,visible:O(o)&&c!==!1,lineHeight:r==null?void 0:r.fontSize},r),{x:S,y:0});Pt(T.lineHeight)&&(T.lineHeight=r.fontSize),M=b.createOrUpdateChild("tag-text",T,"text"),wt(f==null?void 0:f.text)||(M.states=f.text);const P=ud(T.text,r,(e=(t=this.stage)===null||t===void 0?void 0:t.getTheme())===null||e===void 0?void 0:e.text),H=P.width,L=P.height;y+=H;const F=(n=s.size)!==null&&n!==void 0?n:10,z=Z(F)?F:Math.max(F[0],F[1]);x+=Math.max(L,s.visible?z:0);const{textAlign:I,textBaseline:N}=r;(O(h)||O(d))&&(O(h)&&y<h&&(y=h),O(d)&&y>d&&(y=d,M.setAttribute("maxLineWidth",d-m[1]-m[2]))),_=0,w=0;let W=0;I==="left"||I==="start"?W=1:I==="right"||I==="end"?W=-1:I==="center"&&(W=0),W?W<0?(_-=y,C&&C.setAttribute("x",(C.attribute.x||0)-H),b.setAttribute("x",-m[1]-R)):W>0&&b.setAttribute("x",m[3]):(_-=y/2,C&&C.setAttribute("x",(C.attribute.x||0)-H/2),b.setAttribute("x",-R/2));const D=v==="right"||v==="end",j=v==="left"||v==="start";if((v?v==="center":p)&&W){const V=y-m[1]-m[3],X=H+R,K=W===1?(V-X)/2+R+H/2:m[0]+R-(y/2+X/2-R)+H/2;if(M.setAttributes({x:K,textAlign:"center"}),C){const J=K-H/2-R+z/2;C.setAttributes({x:J})}}if(j&&W!==1){const V=y-m[1]-m[3],X=W===0?-V/2+R/2:-y+m[3]+m[1]+R,K=X+R;if(M.setAttributes({x:K,textAlign:"left"}),C){const J=X+z/2;C.setAttributes({x:J})}}if(D&&W!==-1){const V=y-m[1]-m[3],X=W===0?V/2+R/2:V;if(M.setAttributes({x:X,textAlign:"right"}),C){const K=X-H-R+z/2;C.setAttributes({x:K})}}N==="middle"?(w-=x/2,C&&C.setAttribute("y",0)):N==="bottom"?(w-=x,C&&C.setAttribute("y",-L/2),b.setAttribute("y",-m[2])):N==="top"&&(b.setAttribute("y",m[0]),C&&C.setAttribute("y",L/2))}const{visible:k}=l,E=ev(l,["visible"]);if(c&&He(k)){const T=this.createOrUpdateChild("tag-panel",Object.assign(Object.assign({},E),{visible:k&&!!o,width:y,height:x,x:_,y:w}),"rect");if(wt(f==null?void 0:f.panel)||(T.states=f.panel),E.customShape){const P=E.customShape;T.pathProxy=H=>P(this,H,new Ae)}this._bgRect=T}this._textShape=M,this._symbol=C,this.resetStates()}initAttributes(t,e){t=e!=null&&e.skipDefault?t:rt({},Ec.defaultAttributes,t),super.initAttributes(t),this.render()}addState(t,e,n){super.addState(t,e,n),this._textShape&&this._textShape.addState(t,e,n),this._bgRect&&this._bgRect.addState(t,e,n),this._symbol&&this._symbol.addState(t,e,n)}removeState(t,e){super.removeState(t,e),this._textShape&&this._textShape.removeState(t,e),this._bgRect&&this._bgRect.removeState(t,e),this._symbol&&this._symbol.removeState(t,e)}cacheStates(){var t,e,n,o,r,s,l,a,h,d,u,c,f,g;this._tagStates=(e=(t=this.currentStates)===null||t===void 0?void 0:t.slice())!==null&&e!==void 0?e:[],this._rectStates=(r=(o=(n=this._bgRect)===null||n===void 0?void 0:n.currentStates)===null||o===void 0?void 0:o.slice())!==null&&r!==void 0?r:[],this._symbolStates=(a=(l=(s=this._symbol)===null||s===void 0?void 0:s.currentStates)===null||l===void 0?void 0:l.slice())!==null&&a!==void 0?a:[],this._textStates=(u=(d=(h=this._textShape)===null||h===void 0?void 0:h.currentStates)===null||d===void 0?void 0:d.slice())!==null&&u!==void 0?u:[],this.clearStates(),(c=this._bgRect)===null||c===void 0||c.clearStates(),(f=this._symbol)===null||f===void 0||f.clearStates(),(g=this._textShape)===null||g===void 0||g.clearStates()}resetStates(){var t,e,n;this._tagStates.length&&this.useStates(this._tagStates),this._rectStates.length&&((t=this._bgRect)===null||t===void 0||t.useStates(this._rectStates)),this._symbolStates.length&&((e=this._symbol)===null||e===void 0||e.useStates(this._symbolStates)),this._textStates.length&&((n=this._textShape)===null||n===void 0||n.useStates(this._textStates))}};ll.defaultAttributes={visible:!0,textStyle:{fontSize:12,fill:"#000",textAlign:"left",textBaseline:"top"},space:4,padding:4,shape:{fill:"#000"}};const l_={visible:!0,position:"auto",titleStyle:{fontSize:16,fill:"#08979c"},contentStyle:{fontSize:12,fill:"green"},panel:{visible:!0,fill:"#e6fffb",size:12,space:0,stroke:"#87e8de",lineWidth:1,cornerRadius:4}},a_={poptip:rt({},l_)};function GT(){ii(),on(),Or(),Tn()}function jT(i){rt(a_.poptip,l_,i)}var UT=function(i,t){var e={};for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&t.indexOf(n)<0&&(e[n]=i[n]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function"){var o=0;for(n=Object.getOwnPropertySymbols(i);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(i,n[o])&&(e[n[o]]=i[n[o]])}return e};const iv=new Gt;GT();class Vs extends gi{constructor(t,e){super(e!=null&&e.skipDefault?t:rt({},Vs.defaultAttributes,t)),this.name="poptip",this.positionList=["top","tl","tr","bottom","bl","br","left","lt","lb","right","rt","rb"]}render(){var t,e,n,o,r,s,l,a;const{titleStyle:h={},position:d,contentStyle:u={},panel:c={},space:f=4,minWidth:g=0,maxWidth:p=1/0,padding:v=4,maxWidthPercent:m,visible:b,state:C,dx:_=0,dy:w=0}=this.attribute;let{title:y="",content:x=""}=this.attribute;y=this.attribute.titleFormatMethod?this.attribute.titleFormatMethod(y):y,x=this.attribute.contentFormatMethod?this.attribute.contentFormatMethod(x):x;const S=Qi(v),R=this.createOrUpdateChild("poptip-content",{x:0,y:0,zIndex:1},"group"),B=p-S[1]-S[3],A=O(y)&&b!==!1,M=Object.assign(Object.assign({text:Q(y)?y:[y],visible:A,wrap:!0},h),{x:S[3],y:S[0],maxLineWidth:B,textAlign:"left",textBaseline:"top"}),k=R.createOrUpdateChild("poptip-title",M,"text");wt(C==null?void 0:C.title)||(k.states=C.title);const E=k.AABBBounds,T=E.height(),P=E.width();let H=T+f;A||(H=0);const L=O(x)&&b!==!1,F=Object.assign(Object.assign({text:Q(x)?x:[x],visible:L,wrap:!0},u),{x:S[3],y:S[0]+H,maxLineWidth:B,textAlign:"left",textBaseline:"top"}),z=R.createOrUpdateChild("poptip-content",F,"text");wt(C==null?void 0:C.content)||(z.states=C.content);const I=z.AABBBounds,N=I.height(),W=I.width();L&&(H+=N);let D=Jn(P+S[1]+S[3],W+S[1]+S[3]);D>p?D=p:D<g&&(D=g);let j=S[0]+S[2]+H;const{visible:V}=c,X=UT(c,["visible"]),K=(t=X.size)!==null&&t!==void 0?t:12,J=Q(K)?[K[0]+((e=X.space)!==null&&e!==void 0?e:0),K[1]+((n=X.space)!==null&&n!==void 0?n:0)]:K+((o=X.space)!==null&&o!==void 0?o:0),ot=(r=X.lineWidth)!==null&&r!==void 0?r:1,lt=this.stage?[(s=this.stage.viewWidth)!==null&&s!==void 0?s:this.stage.width,(l=this.stage.viewHeight)!==null&&l!==void 0?l:this.stage.height]:void 0;if(lt){const ht=this.AABBBounds,$=(a=this.attribute.x)!==null&&a!==void 0?a:ht.x1,Y=lt[0]-ht.x1;let _t=Math.max($,Y);const et=(Q(K)?K[0]:12)+3;if(_t=Math.min(_t-et,_t*m),_t<D){D=_t;const tt=S[1]+S[3];k.setAttribute("maxLineWidth",_t-tt),z.setAttribute("maxLineWidth",_t-tt),j=S[0]+S[2],A&&(j+=k.AABBBounds.height()+f),j+=z.AABBBounds.height()}}const ct=d==="auto";let it,nt=-1/0;for(let ht=0;ht<this.positionList.length+1;ht++){const $=ct?this.positionList[ht===this.positionList.length?it:ht]:d,{angle:Y,offset:_t,rectOffset:et}=this.getAngleAndOffset($,D,j,Q(J)?J:[J,J-ot]);if(He(V)){const tt=(Q(K)?K[0]:K)/4,at=R.createOrUpdateChild("poptip-symbol-panel",Object.assign(Object.assign({},X),{visible:V&&(L||A),x:tt,y:0,strokeBoundsBuffer:-1,boundsPadding:-2,anchor:[0,0],symbolType:"arrow2Left",angle:Y,dx:_t[0],dy:_t[1],size:K,zIndex:-9}),"symbol");wt(C==null?void 0:C.panel)||(at.states=C.panel);const dt=R.createOrUpdateChild("poptip-rect-panel",Object.assign(Object.assign({},X),{visible:V&&(L||A),x:0,y:0,width:D,height:j,zIndex:-8}),"rect");wt(C==null?void 0:C.panel)||(dt.states=C.panel)}if(R.setAttributes({x:-_t[0]+_,y:-_t[1]+w}),!ct||!lt)break;{iv.setValue(0,0,D,j).transformWithMatrix(R.globalTransMatrix);const tt=iv,at=new Rn().setValue(0,0,lt[0],lt[1]);if(xy(tt,at,!1))break;{const dt=Fb(tt,at,!1),ne=(dt.x2-dt.x1)*(dt.y2-dt.y1);ne>nt&&(nt=ne,it=ht)}}}}getAngleAndOffset(t,e,n,o){const r=o[1]/2;switch(t){case"tl":return{angle:Xt/2*3,offset:[e/4,n+r],rectOffset:[-e/4,-n-o[1]]};case"top":return{angle:Xt/2*3,offset:[e/2,n+r],rectOffset:[0,-n-o[1]]};case"tr":return{angle:Xt/2*3,offset:[e/4*3,n+r],rectOffset:[e/4*3,-n-o[1]]};case"rt":return{angle:0,offset:[-r,n/5],rectOffset:[e/4*3,-n-o[1]]};case"right":return{angle:0,offset:[-r,n/2],rectOffset:[e/4*3,-n-o[1]]};case"rb":return{angle:0,offset:[-r,n/5*4],rectOffset:[e/4*3,-n-o[1]]};case"bl":return{angle:Xt/2,offset:[e/4,-r],rectOffset:[-e/4,-n-o[1]]};case"bottom":return{angle:Xt/2,offset:[e/2,-r],rectOffset:[0,-n-o[1]]};case"br":return{angle:Xt/2,offset:[e/4*3,-r],rectOffset:[e/4*3,-n-o[1]]};case"lt":return{angle:Xt,offset:[e+r,n/5],rectOffset:[-e/4,-n-o[1]]};case"left":return{angle:Xt,offset:[e+r,n/2],rectOffset:[0,-n-o[1]]};case"lb":return{angle:Xt,offset:[e+r,n/5*4],rectOffset:[e/4*3,-n-o[1]]}}}}Vs.defaultAttributes={position:"rt",visible:!0,title:null,content:null,titleStyle:{fontSize:12,fill:"#000",textAlign:"left",textBaseline:"top"},contentStyle:{fontSize:12,fill:"#000",textAlign:"left",textBaseline:"top"},maxWidthPercent:.8,space:8,padding:10};var $T=function(i,t,e,n){var o,r=arguments.length,s=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var l=i.length-1;l>=0;l--)(o=i[l])&&(s=(r<3?o(s):r>3?o(t,e,s):o(t,e))||s);return r>3&&s&&Object.defineProperty(t,e,s),s};function KT(i,t){return rt(i,a_.poptip,t),i}let ms=class{render(i,t,e,n,o,r,s,l,a,h,d,u,c){var f,g;if(i._showPoptip===1){const{visible:p,visibleCb:v}=i.attribute.poptip||{};if(p===!1||v&&v(i)===!1)return;const m={};rt(m,Vs.defaultAttributes,i.attribute.poptip?i.attribute.poptip:{}),this.poptipComponent?this.poptipComponent.initAttributes(m):this.poptipComponent=new Vs(m);let b=i.attribute.poptip||{};if(i.type==="text"&&b.title==null&&b.content==null){const w={};KT(w,b),b=w,b.content=(f=b.content)!==null&&f!==void 0?f:i.attribute.text}const C=i.globalTransMatrix;this.poptipComponent.setAttributes(Object.assign(Object.assign({visibleAll:!0,pickable:!1,childrenPickable:!1},b),{x:C.e,y:C.f})),h.stage.tryInitInteractiveLayer();const _=h.stage.getLayer("_builtin_interactive");_&&_.add(this.poptipComponent)}else i._showPoptip===2&&(i._showPoptip=0,this.poptipComponent&&(this.poptipComponent.setAttributes({visibleAll:!1}),(g=this.poptipComponent.parent)===null||g===void 0||g.removeChild(this.poptipComponent),this.poptipComponent=null))}};ms=$T([st()],ms);var h_=function(i,t,e,n){var o,r=arguments.length,s=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var l=i.length-1;l>=0;l--)(o=i[l])&&(s=(r<3?o(s):r>3?o(t,e,s):o(t,e))||s);return r>3&&s&&Object.defineProperty(t,e,s),s};class d_{constructor(){this.activeEvent="onRegister",this._uid=fe.GenAutoIncrementId(),this.poptip=t=>{const e=t.target;this.needHide(e)?this.unpoptip(t):e!==this.activeGraphic&&(this.needShow(e)&&(e.setAttributes({}),e._showPoptip=1),this.activeGraphic&&(this.activeGraphic.setAttributes({}),this.activeGraphic._showPoptip=2),this.setActiveGraphic(e,!0))},this.unpoptip=t=>{this.activeGraphic&&(this.activeGraphic.setAttributes({}),this.activeGraphic._showPoptip=2,this.setActiveGraphic(null,!0))}}activate(t){this.pluginService=t;const{stage:e}=this.pluginService;e.addEventListener("pointerover",this.poptip)}needHide(t){return t.isContainer||!t.attribute}needShow(t){return!!t.attribute.poptip}setActiveGraphic(t,e){this.activeGraphic=t,this.pluginService.stage.renderNextFrame()}deactivate(t){const{stage:e}=this.pluginService;e.removeEventListener("pointerover",this.poptip)}}let bs=class extends d_{constructor(){super(...arguments),this.name="poptip",this.key=this.name+this._uid}};bs=h_([st()],bs);let Cs=class extends d_{constructor(){super(...arguments),this.name="poptipForText",this.key=this.name+this._uid,this.pointerlave=i=>{const{stage:t}=this.pluginService;i.target===t&&this.unpoptip(i)}}activate(i){super.activate(i);const{stage:t}=this.pluginService;t.addEventListener("pointerleave",this.pointerlave)}needHide(i){return i.type!=="text"||!i.cliped||i.isContainer||!i.attribute||i.attribute.disableAutoClipedPoptip}needShow(i){return!0}deactivate(i){const{stage:t}=this.pluginService;super.deactivate(i),t.removeEventListener("pointerleave",this.pointerlave)}};Cs=h_([st()],Cs);const YT=new Ct((i,t,e,n)=>{e(ms)||(i(ms).toSelf().inSingletonScope(),i(Eg).toService(ms)),e(bs)||(i(bs).toSelf(),i(Ws).toService(bs)),e(Cs)||(i(Cs).toSelf(),i(Ws).toService(Cs))});function XT(){bt.load(YT)}function qT(){ii(),Gg(),kT(),Or()}qT();class cd extends gi{getStartAngle(){return pf(this._startAngle)}getEndAngle(){return pf(this._endAngle)}getMainSegmentPoints(){return this._mainSegmentPoints}constructor(t,e){super(e!=null&&e.skipDefault?t:rt({},cd.defaultAttributes,t)),this.name="segment",this.key="segment",this.lines=[]}render(){this.removeAllChild(!0),this._reset();const{startSymbol:t,endSymbol:e,lineStyle:n,state:o,visible:r=!0,multiSegment:s,mainSegmentIndex:l}=this.attribute;if(!r)return;this._computeLineAngle();const a=this._getMainSegmentPoints(),h=this._renderSymbol(t,a,"start"),d=this._renderSymbol(e,a,"end");if(this.startSymbol=h,this.endSymbol=d,s){const u=[...this.attribute.points];if(Yt(l))u[l]=this._clipPoints(u[l]);else{const c=this._clipPoints(vf(u));u[0][0]=c[0],u[u.length-1][u[u.length-1].length-1]=c[c.length-1]}u.forEach((c,f)=>{var g,p;const v=ft.line(Object.assign(Object.assign({points:c},Q(n)?(g=n[f])!==null&&g!==void 0?g:n[n.length-1]:n),{fill:!1}));v.name=`${this.name}-line`,v.id=this._getNodeId("line"+f),wt(o==null?void 0:o.line)||(v.states=Q(o.line)?(p=o.line[f])!==null&&p!==void 0?p:o.line[o.line.length-1]:o.line),this.add(v),this.lines.push(v)})}else{let u=ft.line;xu(n)[0].cornerRadius&&(u=ft.polygon);const c=u(Object.assign(Object.assign({points:this._clipPoints(this.attribute.points)},xu(n)[0]),{fill:!1,closePath:!1}));c.name=`${this.name}-line`,c.id=this._getNodeId("line"),wt(o==null?void 0:o.line)||(c.states=[].concat(o.line)[0]),this.add(c),this.lines.push(c)}}_computeStartRotate(t){return t+Math.PI/2}_computeEndRotate(t){return t+Math.PI/2}_renderSymbol(t,e,n){if(!e.length)return;const{autoRotate:o=!0}=t;let r;if(t&&t.visible){const s=this.getStartAngle(),l=this.getEndAngle(),{state:a}=this.attribute,h=e[0],d=e[e.length-1],{refX:u=0,refY:c=0,refAngle:f=0,style:g,symbolType:p,size:v=12}=t;let m,b;n==="start"?(m={x:h.x+(Yt(s)?u*Math.cos(s)+c*Math.cos(s-Math.PI/2):0),y:h.y+(Yt(s)?u*Math.sin(s)+c*Math.sin(s-Math.PI/2):0)},b=this._computeStartRotate(this._startAngle)):(m={x:d.x+(Yt(l)?u*Math.cos(l)+c*Math.cos(l-Math.PI/2):0),y:d.y+(Yt(l)?u*Math.sin(l)+c*Math.sin(l-Math.PI/2):0)},b=this._computeEndRotate(this._endAngle)),r=ft.symbol(Object.assign(Object.assign(Object.assign({},m),{symbolType:p,size:v,angle:o?b+f:0,strokeBoundsBuffer:0}),g)),r.name=`${this.name}-${n}-symbol`,r.id=this._getNodeId(`${n}-symbol`),wt(a==null?void 0:a.symbol)||(r.states=a.symbol),n==="start"?wt(a==null?void 0:a.startSymbol)||(r.states=a.startSymbol):wt(a==null?void 0:a.endSymbol)||(r.states=a.endSymbol),this.add(r)}return r}_getMainSegmentPoints(){if(this._mainSegmentPoints)return this._mainSegmentPoints;const{points:t,multiSegment:e,mainSegmentIndex:n}=this.attribute;let o;return o=e?Yt(n)?t[n]:vf(t):t,this._mainSegmentPoints=o,o}_clipPoints(t){const{startSymbol:e={},endSymbol:n={}}=this.attribute;let o=t;if(e.visible){const r=e.clip?e.size||10:0;o=[{x:t[0].x-r/2*(Math.cos(this._startAngle)||0),y:t[0].y-r/2*(Math.sin(this._startAngle)||0)},...o.slice(1)]}if(n.visible){const r=n.clip?n.size||10:0,s={x:t[t.length-1].x-r/2*(Math.cos(this._endAngle)||0),y:t[t.length-1].y-r/2*(Math.sin(this._endAngle)||0)};o=[...o.slice(0,o.length-1),s]}return o}_computeLineAngle(){const t=this._getMainSegmentPoints();if(t.length<=1)return;const e=t[0],n=t[1],o=t[t.length-2],r=t[t.length-1],s=[e.x-n.x,e.y-n.y],l=Math.atan2(s[1],s[0]),a=[r.x-o.x,r.y-o.y],h=Math.atan2(a[1],a[0]);this._startAngle=l,this._endAngle=h}_reset(){this.startSymbol=null,this.endSymbol=null,this._startAngle=null,this._endAngle=null,this._mainSegmentPoints=null}}cd.defaultAttributes={visible:!0,lineStyle:{lineWidth:1,stroke:"#000"},startSymbol:{visible:!1,autoRotate:!0,symbolType:"triangle",size:12,refX:0,refY:0,refAngle:0,style:{fill:"#000",zIndex:1}},endSymbol:{visible:!1,autoRotate:!0,symbolType:"triangle",size:12,refX:0,refY:0,refAngle:0,style:{fill:"#000",zIndex:1}}};var Te;(function(i){i.innerView="inner-view",i.axisContainer="axis-container",i.labelContainer="axis-label-container",i.tickContainer="axis-tick-container",i.tick="axis-tick",i.subTick="axis-sub-tick",i.label="axis-label",i.title="axis-title",i.gridContainer="axis-grid-container",i.grid="axis-grid",i.gridRegion="axis-grid-region",i.line="axis-line",i.background="axis-background",i.axisLabelBackground="axis-label-background",i.axisBreak="axis-break",i.axisBreakSymbol="axis-break-symbol"})(Te||(Te={}));var lr;(function(i){i.selected="selected",i.selectedReverse="selected_reverse",i.hover="hover",i.hoverReverse="hover_reverse"})(lr||(lr={}));const jo={[lr.selectedReverse]:{},[lr.selected]:{},[lr.hover]:{},[lr.hoverReverse]:{}},ZT=999,Lc={title:{space:4,padding:0,textStyle:{fontSize:12,fill:"#333333",fontWeight:"normal",fillOpacity:1}},label:{visible:!0,inside:!1,space:4,padding:0,style:{fontSize:12,fill:"#333",fontWeight:"normal",fillOpacity:1}},tick:{visible:!0,inside:!1,alignWithLabel:!0,length:4,style:{lineWidth:1,stroke:"#000",strokeOpacity:1}},subTick:{visible:!1,inside:!1,count:4,length:2,style:{lineWidth:1,stroke:"#999",strokeOpacity:1}},line:{visible:!0,style:{lineWidth:1,stroke:"#000",strokeOpacity:1}}},nv={size:8,stroke:"#000",lineWidth:1,zIndex:1};function JT(i){const t=i.AABBBounds;return{x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2,centerX:i.attribute.x,centerY:i.attribute.y,angle:i.attribute.angle}}function QT(i){i.forEach(t=>{if(t.rotatedBounds||!t.attribute.angle)return;const e=JT(t),n=Lb({x:t.attribute.x,y:t.attribute.y},e.angle,{x:e.centerX,y:e.centerY}),o=n.x-e.centerX,r=n.y-e.centerY;e.x1+=o,e.x2+=o,e.y1+=r,e.y2+=r,e.centerX+=o,e.centerY+=r,t.rotatedBounds=e})}function tP(i,t){var e,n;return!((e=i.OBBBounds)===null||e===void 0)&&e.empty()||!((n=t.OBBBounds)===null||n===void 0)&&n.empty()?Su(i.AABBBounds,t.AABBBounds,!1)&&(!i.rotatedBounds||!t.rotatedBounds||Ry(i.rotatedBounds,t.rotatedBounds,!0)):i.OBBBounds.intersects(t.OBBBounds)}const u_=Math.sin(Math.PI/10);function c_(i,t=u_){const e=!Pt(i)&&i!==0,n=e?Math.cos(i):1;return e&&Math.abs(n)<=t}function jg(i,t=u_){const e=!Pt(i)&&i!==0,n=e?Math.sin(i):0;return!e||Math.abs(n)<=t}function eP(i,t){return{x:i.x+t[0],y:i.y+t[1]}}function iP(i={}){var t,e;const{style:n={},angle:o=.5*Math.PI}=i,r=rt({},nv,n),s=(t=r.size)!==null&&t!==void 0?t:nv.size;return Object.assign(Object.assign({},r),{symbolType:(e=r.symbolType)!==null&&e!==void 0?e:`M ${-s/2} ${s*Math.sin(o)} L ${s/2} ${-s*Math.sin(o)}`,symbolSize:s})}function nP(i){const t={};return Tr(i,e=>{e.type!=="group"&&e.id&&(t[e.id]=e)}),t}function g_(i,t){return{x:i.x+t[0],y:i.y+t[1]}}function ov(i,t,e,n=!1,o=!1){const r=[t.x-e.x,t.y-e.y];return e_(r,(n?-1:1)*(o?-1:1)*i/i_(r))}function oP(i,t,e,n,o){const r=Ay({x:0,y:0},e,i),s=g_(r,ov(n,r,t,o));return eP(s,ov(n||1,s,t,o))}function Ii(i,t,e){var n;let o,r;const s=(n=i.attribute)===null||n===void 0?void 0:n.angle,l=(a,h,d)=>(o=a.AABBBounds,r=h.AABBBounds,d>Math.max(r.x1-o.x2,o.x1-r.x2,r.y1-o.y2,o.y1-r.y2));return jg(s,Number.EPSILON)?l(i,t,e):(o=i.OBBBounds,r=t.OBBBounds,!o||!r||o.empty()||r.empty()?l(i,t,e):o.intersects(r))}function Fc(i,t){for(let e,n=1,o=i.length,r=i[0];n<o;r=e,++n)if(e=i[n],Ii(r,e,t))return!0;return!1}const rP=(i,t,e)=>{const n=i.target;return n!==e&&n.name&&!wt(n.states)?(n.addState(je.hover,!0),Tr(t,o=>{o!==n&&o.name&&!wt(o.states)&&o.addState(je.hoverReverse,!0)}),n):e},sP=(i,t,e)=>e&&(Tr(t,n=>{n.name&&!wt(n.states)&&(n.removeState(je.hoverReverse),n.removeState(je.hover))}),null),lP=(i,t,e)=>{const n=i.target;return e===n&&n.hasState(je.selected)?(Tr(t,o=>{o.name&&!wt(o.states)&&(o.removeState(je.selectedReverse),o.removeState(je.selected))}),null):n.name&&!wt(n.states)?(n.addState(je.selected,!0),Tr(t,o=>{o!==n&&o.name&&!wt(o.states)&&o.addState(je.selectedReverse,!0)}),n):e};class aP extends gi{constructor(){super(...arguments),this.name="axis",this.data=[],this.tickLineItems=[],this.subTickLineItems=[],this.axisLabelLayerSize={},this.axisLabelsContainer=null,this._onHover=t=>{this._lastHover=rP(t,this.axisContainer,this._lastHover)},this._onUnHover=t=>{this._lastHover=sP(t,this.axisContainer,this._lastHover)},this._onClick=t=>{this._lastSelect=lP(t,this.axisContainer,this._lastSelect)}}getInnerView(){return this._innerView}getPrevInnerView(){return this._prevInnerView}getBoundsWithoutRender(t){const e=Do(this.attribute);rt(this.attribute,t);const n=ft.group({x:this.attribute.x,y:this.attribute.y});return this.add(n),this._renderInner(n),this.removeChild(n),this.attribute=e,n.AABBBounds}render(){this._prevInnerView=this._innerView&&nP(this._innerView),this.removeAllChild(!0),this._innerView=ft.group({x:0,y:0,pickable:!1}),this.add(this._innerView),this._renderInner(this._innerView),this._bindEvent()}_bindEvent(){if(this.attribute.disableTriggerEvent)return;const{hover:t,select:e}=this.attribute;t&&(this._innerView.addEventListener("pointermove",this._onHover),this._innerView.addEventListener("pointerout",this._onUnHover)),e&&this._innerView.addEventListener("pointerdown",this._onClick)}_renderInner(t){const{title:e,label:n,tick:o,line:r,items:s}=this.attribute,l=ft.group({x:0,y:0,zIndex:1,pickable:!1});if(l.name=Te.axisContainer,l.id=this._getNodeId("container"),l.setMode(this.mode),this.axisContainer=l,t.add(l),r&&r.visible&&this.renderLine(l),s&&s.length&&(this.data=this._transformItems(s[0]),o&&o.visible&&this.renderTicks(l),n&&n.visible)){const a=ft.group({x:0,y:0,pickable:!1});a.name=Te.labelContainer,a.id=this._getNodeId("label-container"),this.axisLabelsContainer=a,l.add(a),s.forEach((h,d)=>{const u=this.renderLabels(a,h,d),c=u.getChildren();this.beforeLabelsOverlap(c,h,u,d,s.length),this.handleLabelsOverlap(c,h,u,d,s.length),this.afterLabelsOverlap(c,h,u,d,s.length);let f=0,g=0,p="center",v="middle",m=0;c.forEach((b,C)=>{var _;const w=b.attribute,y=(_=w.angle)!==null&&_!==void 0?_:0,x=b.AABBBounds;let S=x.width(),R=x.height();y&&(S=Math.abs(S*Math.cos(y)),R=Math.abs(R*Math.sin(y))),f=Math.max(f,S),g=Math.max(g,R),p=w.textAlign,v=w.textBaseline,C===0&&(m=w.x)}),this.axisLabelLayerSize[d]={width:f,height:g,labelPos:m,textAlign:p,textBaseline:v}})}e&&e.visible&&this.renderTitle(l)}renderTicks(t){const e=this.getTickLineItems(),n=ft.group({x:0,y:0,pickable:!1});n.name=Te.tickContainer,n.id=this._getNodeId("tick-container"),t.add(n),e.forEach((r,s)=>{var l;const a=ft.line(Object.assign({},this._getTickLineAttribute("tick",r,s,e)));if(a.name=Te.tick,a.id=this._getNodeId(r.id),wt((l=this.attribute.tick)===null||l===void 0?void 0:l.state))a.states=Go;else{const h=this.data[s],d=rt({},Go,this.attribute.tick.state);Object.keys(d).forEach(u=>{Mt(d[u])&&(d[u]=d[u](h.rawValue,s,h,this.data))}),a.states=d}n.add(a)}),this.tickLineItems=e;const{subTick:o}=this.attribute;if(o&&o.visible){const r=this.getSubTickLineItems();r.length&&r.forEach((s,l)=>{const a=ft.line(Object.assign({},this._getTickLineAttribute("subTick",s,l,e)));if(a.name=Te.subTick,a.id=this._getNodeId(`${l}`),wt(o.state))a.states=Go;else{const h=rt({},Go,o.state);Object.keys(h).forEach(d=>{Mt(h[d])&&(h[d]=h[d](s.value,l,s,e))}),a.states=h}n.add(a)}),this.subTickLineItems=r}}renderLabels(t,e,n){const{dataFilter:o}=this.attribute.label;o&&Mt(o)&&(e=o(e,n));const r=this._transformItems(e),s=ft.group({x:0,y:0,pickable:!1});return s.name=`${Te.labelContainer}-layer-${n}`,s.id=this._getNodeId(`label-container-layer-${n}`),t.add(s),r.forEach((l,a)=>{var h;const d=this._getLabelAttribute(l,a,r,n),u=kc(d);if(u.name=Te.label,u.id=this._getNodeId(`layer${n}-label-${l.id}`),wt((h=this.attribute.label)===null||h===void 0?void 0:h.state))u.states=Go;else{const c=rt({},Go,this.attribute.label.state);Object.keys(c).forEach(f=>{Mt(c[f])&&(c[f]=c[f](l,a,r,n))}),u.states=c}u.data=Object.assign(Object.assign({},l),{index:a,layer:n}),s.add(u)}),s}renderTitle(t){const e=this.getTitleAttribute(),n=new ll(Object.assign({},e));n.name=Te.title,n.id=this._getNodeId("title"),t.add(n)}getVerticalCoord(t,e,n){return g_(t,this.getVerticalVector(e,n,t))}getTickLineItems(){const{tick:t}=this.attribute,e=this.data,n=[],{alignWithLabel:o,inside:r=!1,length:s,dataFilter:l}=t;let a=1;return e.length>=2&&(a=e[1].value-e[0].value),(l&&Mt(l)?l(e):e).forEach(h=>{let d=h.point,u=h.value;if(!o){const f=h.value-a/2;if(this.isInValidValue(f))return;d=this.getTickCoord(f),u=f}const c=this.getVerticalCoord(d,s,r);if(this.mode==="3d"){const f=this.getVerticalVector(s,r,d);let g=0,p=0;Dt(f[0])>Dt(f[1])?g=Xt/2*(c.x>d.x?1:-1):p=Xt/2*(c.y>d.y?-1:1),n.push({start:d,end:c,value:u,id:`tick-${h.id}`,anchor:[d.x,d.y],alpha:g,beta:p})}else n.push({start:d,end:c,value:u,id:`tick-${h.id}`})}),n}getSubTickLineItems(){const{subTick:t}=this.attribute,e=[],{count:n=4,inside:o=!1,length:r=2}=t,s=this.tickLineItems,l=s.length;if(l>=2)for(let a=0;a<l-1;a++){const h=s[a],d=s[a+1];for(let u=0;u<n;u++){const c=(u+1)/(n+1),f=(1-c)*h.value+c*d.value,g=this.getTickCoord(f),p=this.getVerticalCoord(g,r,o);e.push({start:g,end:p,value:f,id:`sub-tick-${f}`})}}return e}_getTickLineAttribute(t,e,n,o){let r=we(this.attribute,`${t}.style`);const s=this.data[n];r=Mt(r)?rt({},we(Lc,`${t}.style`),t==="tick"?r(s.rawValue,n,s,this.data):r(e.value,n,e,o)):r;const{start:l,end:a,anchor:h,alpha:d,beta:u}=e;return Object.assign({points:[l,a],anchor:h,alpha:d,beta:u},r)}_getLabelAttribute(t,e,n,o){var r,s;const{space:l=4,inside:a=!1,formatMethod:h,type:d="text",text:u}=this.attribute.label;let c=l,f=0;!((r=this.attribute.tick)===null||r===void 0)&&r.visible&&this.attribute.tick.inside===a&&(f=this.attribute.tick.length||4),!((s=this.attribute.subTick)===null||s===void 0)&&s.visible&&this.attribute.subTick.inside===a&&(f=Math.max(f,this.attribute.subTick.length||2)),c+=f;const g=this.getRelativeVector(t.point);o>0&&(g[1]===0?c+=(this.axisLabelLayerSize[o-1].height+we(this.attribute,"label.space",4))*o:c+=(this.axisLabelLayerSize[o-1].width+we(this.attribute,"label.space",4))*o);const p=this.getVerticalCoord(t.point,c,a),v=this.getVerticalVector(c||1,a,p),m=h?h(`${t.label}`,t,e,n,o):t.label;let{style:b}=this.attribute.label;b=Mt(b)?rt({},Lc.label.style,b(t,e,n,o)):b;const C=this.getLabelAlign(v,a,b.angle);return b=rt(C,b),Mt(b.text)&&(b.text=b.text({label:t.label,value:t.rawValue,index:t.index,layer:o})),Object.assign(Object.assign(Object.assign({},this.getLabelPosition(p,v,m,b)),{text:u??m,_originText:t.label,lineHeight:b==null?void 0:b.fontSize,type:d}),b)}getLabelPosition(t,e,n,o){return t}_transformItems(t){const e=[];return t.forEach(n=>{var o;e.push(Object.assign(Object.assign({},n),{point:this.getTickCoord(n.value),id:(o=n.id)!==null&&o!==void 0?o:n.label}))}),e}release(){super.release(),this._prevInnerView=null,this._innerView=null}}const rv={parity:function(i){return i.filter((t,e)=>e%2?t.setAttribute("opacity",0):1)},greedy:function(i,t){let e;return i.filter((n,o)=>o&&Ii(e,n,t)?n.setAttribute("opacity",0):(e=n,1))}};function hP(i){let t;return t=i.OBBBounds.empty()?i.AABBBounds:i.OBBBounds,t.width()>1&&t.height()>1}function dP(i){return i.forEach(t=>t.setAttribute("opacity",1)),i}function sv(i,t,e,n,o=!1){if(e&&!i.attribute.opacity){const r=t.length;if(r>1){i.setAttribute("opacity",1);for(let s=0;s<r;s++){const l=o?t[r-1-s]:t[s];if(!n(l))break;l.setAttribute("opacity",0)}}}}function uP(i,t){if(wt(i))return;const e=i.filter(hP);if(wt(e))return;let n;n=dP(e);const{method:o="parity",separation:r=0}=t,s=Mt(o)?o:rv[o]||rv.parity;if(n.length>=3&&Fc(n,r)){do n=s(n,r);while(n.length>=3&&Fc(n,r));const l=(c,f,g=!0)=>g&&c<3||f,a=l(n.length,t.firstVisible,!1);let h=l(n.length,t.lastVisible);const d=e[0],u=Co(e);Ii(d,u,r)&&a&&h&&(u.setAttribute("opacity",0),h=!1),sv(d,n,a,c=>Ii(c,d,r)),sv(u,n,h,c=>Ii(c,u,r)||!(!a||c===d)&&Ii(c,d,r),!0)}e.forEach(l=>{l.setAttribute("visible",!!l.attribute.opacity)})}function cP(i,t){if(wt(i))return;const{orient:e,labelRotateAngle:n=[0,45,90]}=t;if(n.length===0||i.some(s=>!!s.attribute.angle))return;let o=0,r=0;for(n&&n.length>0&&(r=n.length);o<r;){const s=n[o++];if(i.forEach(l=>{l.attribute.angle=To(s)}),fP(e,i),!gP(i))break}}function gP(i){for(let t=1;t<i.length;t++)if(tP(i[t-1],i[t]))return!0;return!1}function fP(i,t){i!=="bottom"&&i!=="top"||vP(i,t),i!=="left"&&i!=="right"||pP(i,t),QT(t)}function gd(i=0){if(i<0)for(;i<0;)i+=2*Math.PI;if(i>0)for(;i>=2*Math.PI;)i-=2*Math.PI;return i}function pP(i,t){t.forEach((e,n)=>{e.attribute.angle&&e.setAttributes(Object.assign(Object.assign({},p_(i,e.attribute.angle)),{angle:gd(e.attribute.angle)}))})}function vP(i,t){t.forEach(e=>{e.attribute.angle&&e.setAttributes(Object.assign(Object.assign({},f_(i,e.attribute.angle)),{angle:gd(e.attribute.angle)}))})}function f_(i,t=0){let e=["center","left","left","left","center","right","right","right","left"],n=["top","top","middle","bottom","bottom","bottom","middle","top","top"];i==="top"&&(e=["center","right","right","right","center","left","left","left","right"],n=["bottom","bottom","middle","top","top","top","middle","bottom","bottom"]);const o=(t=gd(t))/(.5*Math.PI);let r;return r=o===Math.floor(o)?2*Math.floor(o):2*Math.floor(o)+1,{textAlign:e[r],textBaseline:n[r]}}function p_(i,t=0){let e=["right","right","center","left","left","left","center","right","right"],n=["middle","middle","top","top","middle","middle","bottom","bottom","middle"];i==="right"&&(e=["left","left","center","right","right","right","center","left","left"],n=["middle","middle","bottom","bottom","middle","middle","top","middle","middle"]);const o=(t=gd(t))/(.5*Math.PI);let r;return r=o===Math.floor(o)?2*Math.floor(o):2*Math.floor(o)+1,{textAlign:e[r],textBaseline:n[r]}}function mP(i){return Yt(i)?{left:i,right:i}:kt(i)?{left:i.left||0,right:i.right||0}:{left:0,right:0}}function bP(i,t){const{limitLength:e,verticalLimitLength:n,ellipsis:o="...",orient:r,axisLength:s}=t;if(wt(i)||!Yt(e))return;const l=mP(t.overflowLimitLength),a=i[0],h=a.attribute.angle,d=!Pt(h),u=d?Math.cos(h):1,c=d?Math.sin(h):0,f=jg(h),g=c_(h),p=r==="top"||r==="bottom",v=a.attribute.direction,m=!f&&!g&&p&&(i.length<2||i.some(b=>Math.abs(b.AABBBounds.width()-a.AABBBounds.width())>=2))&&a.AABBBounds.width()>Math.abs(e/c);i.forEach(b=>{var C;if(p&&(g&&Math.floor(b.AABBBounds.height())<=e||f&&Math.floor(b.AABBBounds.width())<=n)||!p&&(v==="vertical"&&Math.floor(b.AABBBounds.height())<=n||v!=="vertical"&&(f&&Math.floor(b.AABBBounds.width())<=e||g&&Math.floor(b.AABBBounds.height())<=n)))return;let _=null;if(f||g)_=p?f?n:e:v==="vertical"||g?n:e;else if(p){const{x1:w,x2:y}=b.AABBBounds,x=c/u,S=Math.abs(e/c);if(m&&x>0&&w<=s+l.right&&e/x+w>s+l.right){const R=(s-w+l.right)/Math.abs(u);_=Math.min(R,S)}else if(m&&x<0&&y>=-l.left&&e/x+y<-l.left){const R=(y+l.left)/Math.abs(u);_=Math.min(R,S)}else _=S}else _=Math.abs(e/u);Yt(b.attribute.maxLineWidth)&&(_=Yt(_)?Math.min(b.attribute.maxLineWidth,_):b.attribute.maxLineWidth),b.setAttributes({maxLineWidth:_,ellipsis:(C=b.attribute.ellipsis)!==null&&C!==void 0?C:o})})}function CP(i,t){const{limitLength:e,axisLength:n,ellipsis:o="...",orient:r}=t;if(wt(i)||!Yt(e))return;const s=i[0].attribute.angle,l=jg(s),a=c_(s),h=r==="top"||r==="bottom";let d=n/i.length;i.forEach((u,c)=>{var f,g,p,v,m;if(h){if(a&&Math.floor(u.AABBBounds.height())<=e)return;if(l){const _=lv(u.attribute.x,(f=i[c+1])===null||f===void 0?void 0:f.attribute.x,(g=i[c-1])===null||g===void 0?void 0:g.attribute.x);Yt(_)&&(d=Ie(d,_))}}else{if(a){const _=lv(u.attribute.y,(p=i[c+1])===null||p===void 0?void 0:p.attribute.y,(v=i[c-1])===null||v===void 0?void 0:v.attribute.y);Yt(_)&&(d=Ie(d,_))}if(l&&Math.floor(u.AABBBounds.width())<=e)return}let b=null,C=null;h?a?(b=e,C=d):(b=d,C=e):a?(b=d,C=e):(b=e,C=d),u.setAttributes({maxLineWidth:b,ellipsis:(m=u.attribute.ellipsis)!==null&&m!==void 0?m:o,whiteSpace:"normal",heightLimit:C})})}function lv(i,t,e){let n;return Yt(t)&&(n=Math.abs(t-i)),Yt(e)&&(n=Yt(n)?Math.min(Math.abs(i-e),n):Math.abs(i-e)),n}function _P(i,t,e,n,o){n==="left"||n==="right"?o==="left"?i.forEach(r=>{var s;r.setAttributes({dx:((s=r.attribute.dx)!==null&&s!==void 0?s:0)+t-r.AABBBounds.x1})}):o==="right"?i.forEach(r=>{var s;r.setAttributes({dx:((s=r.attribute.dx)!==null&&s!==void 0?s:0)+t+e-r.AABBBounds.x2})}):o==="center"&&i.forEach(r=>{var s;r.setAttributes({dx:((s=r.attribute.dx)!==null&&s!==void 0?s:0)+t+e/2-(r.AABBBounds.x1+r.AABBBounds.x2)/2})}):n!=="bottom"&&n!=="top"||(o==="top"?i.forEach(r=>{var s;r.setAttributes({dy:((s=r.attribute.dy)!==null&&s!==void 0?s:0)+t-r.AABBBounds.y1})}):o==="bottom"?i.forEach(r=>{var s;r.setAttributes({dy:((s=r.attribute.dy)!==null&&s!==void 0?s:0)+t+e-r.AABBBounds.y2})}):o==="middle"&&i.forEach(r=>{var s;r.setAttributes({dy:((s=r.attribute.dy)!==null&&s!==void 0?s:0)+t+e/2-(r.AABBBounds.y1+r.AABBBounds.y2)/2})}))}class wP{isInValidValue(t){return t<0||t>1}getTickCoord(t){const{start:e}=this.attribute,n=this.getRelativeVector();return{x:e.x+n[0]*t,y:e.y+n[1]*t}}getRelativeVector(t){const{start:e,end:n}=this.attribute;return[n.x-e.x,n.y-e.y]}getVerticalVector(t,e=!1,n){const{verticalFactor:o=1}=this.attribute,r=this.getRelativeVector(),s=IT(r),l=[s[1],-1*s[0]];return e_(l,t*(e?1:-1)*o)}}function yP(){ii(),Gg(),dd(),on()}function SP(){yP(),Tn()}var av=function(i,t){var e={};for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&t.indexOf(n)<0&&(e[n]=i[n]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function"){var o=0;for(n=Object.getOwnPropertySymbols(i);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(i,n[o])&&(e[n[o]]=i[n[o]])}return e};SP();class Gs extends aP{constructor(t,e){super(e!=null&&e.skipDefault?t:rt({},Gs.defaultAttributes,t),e)}_renderInner(t){var e;if(this._breaks=null,this.attribute.breaks&&this.attribute.breaks.length){const o=[];for(let r=0;r<this.attribute.breaks.length;r++){const s=this.attribute.breaks[r],{range:l,breakSymbol:a,rawRange:h}=s;o.push({startPoint:this.getTickCoord(l[0]),endPoint:this.getTickCoord(l[1]),range:l,breakSymbol:a,rawRange:h})}this._breaks=o}super._renderInner(t),this._breaks&&this._breaks.length&&this._breaks.forEach((o,r)=>{const{startPoint:s,endPoint:l,breakSymbol:a,rawRange:h}=o;if((a==null?void 0:a.visible)!==!1){const d=ft.group({zIndex:ZT});d.name=Te.axisBreak,d.id=this._getNodeId(`${Te.axisBreak}-${r}`),d.data=h;const u=iP(a),c=ft.symbol(Object.assign({x:s.x,y:s.y},u));c.name=Te.axisBreakSymbol;const f=ft.symbol(Object.assign({x:l.x,y:l.y},u));f.name=Te.axisBreakSymbol,d.add(c),d.add(f),t.add(d)}});const{panel:n}=this.attribute;if(n&&n.visible){const o=this.axisContainer,r=o.AABBBounds,s=ft.rect(Object.assign({x:r.x1,y:r.y1,width:r.width(),height:r.height()},n.style));s.name=Te.background,s.id=this._getNodeId("background"),s.states=rt({},jo,(e=n.state)!==null&&e!==void 0?e:{}),o.insertBefore(s,o.firstChild)}}renderLine(t){const{start:e,end:n,line:o}=this.attribute,r=o,{startSymbol:s,endSymbol:l,style:a,state:h}=r,d=av(r,["startSymbol","endSymbol","style","state"]),u=Object.assign({startSymbol:s,endSymbol:l,lineStyle:a},d);if(this._breaks&&this._breaks.length){const f=[];let g=e;this._breaks.forEach(p=>{const{startPoint:v,endPoint:m}=p;f.push([g,v]),g=m}),f.push([g,n]),u.points=f,u.multiSegment=!0}else u.points=[e,n];wt(h)||(u.state={line:rt({},jo,h),symbol:rt({},jo,h)});const c=new cd(u);c.name=Te.line,c.id=this._getNodeId("line"),t.add(c)}getTextAlign(t){let e="center";return Cn(t[0],0)?Cn(t[1],0)?Object.is(t[1],-0)?e="start":Object.is(t[0],-0)&&(e="end"):e="center":t[0]>0?e="start":t[0]<0&&(e="end"),e}getTitleAttribute(){var t,e,n;const o=this.attribute.title,{position:r="middle",space:s=4,textStyle:l={},autoRotate:a=!0,shape:h,background:d,state:u={},maxWidth:c}=o,f=av(o,["position","space","textStyle","autoRotate","shape","background","state","maxWidth"]);let g=.5;r==="start"?g=0:r==="end"&&(g=1);const{verticalFactor:p=1}=this.attribute,v=-1*p,m=this.getTickCoord(g),b=this.getRelativeVector();let C=0;if(!((t=this.attribute.label)===null||t===void 0)&&t.visible&&this.attribute.label.inside===!1){const k=+we(this.attribute,"label.space",4);C+=k;const E=Object.keys(this.axisLabelLayerSize).length;if(b[1]===0){const T=this.axisLabelsContainer?this.axisLabelsContainer.AABBBounds.height():0;isFinite(T)?C+=T+(E-1)*k:C=0}else if(b[0]===0)if(this.axisLabelsContainer&&this.axisLabelsContainer.AABBBounds&&!this.axisLabelsContainer.AABBBounds.empty()){const T=this.axisLabelLayerSize[0].labelPos,P=this.axisLabelsContainer.AABBBounds;C+=(v===1?P.x2>T?Math.min(P.x2-T,P.width()):0:P.x1<T?Math.min(T-P.x1,P.width()):0)+(E-1)*k}else C=0;else Object.keys(this.axisLabelLayerSize).forEach((T,P)=>{C+=this.axisLabelLayerSize[T].width+(P>0?k:0)})}let _=0;!((e=this.attribute.tick)===null||e===void 0)&&e.visible&&this.attribute.tick.inside===!1&&(_=this.attribute.tick.length||4),!((n=this.attribute.subTick)===null||n===void 0)&&n.visible&&this.attribute.subTick.inside===!1&&(_=Math.max(_,this.attribute.subTick.length||2));const w=_+C+s,y=this.getVerticalCoord(m,w,!1),x=this.getVerticalVector(w,!1,{x:0,y:0});let S,R,{angle:B}=f;if(S=r==="start"?"start":r==="end"?"end":"center",Pt(B)&&a){B=DT(b,[1,0],!0);const{verticalFactor:k=1}=this.attribute;R=-1*k===1?"bottom":"top"}else S=this.getTextAlign(x),R=this.getTextBaseline(x,!1);let A=c;if(Pt(A)){const{verticalLimitSize:k,verticalMinSize:E,orient:T}=this.attribute,P=Math.min(k||1/0,E||1/0);if(Yt(P))if(T==="bottom"||T==="top")if(B!==Math.PI/2){const H=Math.abs(Math.cos(B??0));A=H<1e-6?1/0:this.attribute.end.x/H}else A=P-w;else if(B&&B!==0){const H=Math.abs(Math.sin(B));A=H<1e-6?1/0:this.attribute.end.y/H}else A=P-w}const M=Object.assign(Object.assign(Object.assign({},y),f),{maxWidth:A,textStyle:Object.assign({textAlign:S,textBaseline:R},l),state:{text:rt({},jo,u.text),shape:rt({},jo,u.shape),panel:rt({},jo,u.background)}});return M.angle=B,h&&h.visible&&(M.shape=Object.assign({visible:!0},h.style),h.space&&(M.space=h.space)),d&&d.visible&&(M.panel=Object.assign({visible:!0},d.style)),M}getTextBaseline(t,e){let n="middle";const{verticalFactor:o=1}=this.attribute,r=(e?1:-1)*o;return Cn(t[1],0)?n=!Cn(t[0],0)||Object.is(t[0],-0)||Object.is(t[1],-0)?"middle":r===1?"bottom":"top":t[1]>0?n="top":t[1]<0&&(n="bottom"),n}getLabelAlign(t,e,n){const o=this.attribute.orient;if(["top","bottom","right","left"].includes(o)||t[0]===0&&t[1]===0){if(o==="top"||o==="bottom")return f_(e?o==="bottom"?"top":"bottom":o,n);if(o==="left"||o==="right")return p_(e?o==="left"?"right":"left":o,n)}return{textAlign:this.getTextAlign(t),textBaseline:this.getTextBaseline(t,e)}}beforeLabelsOverlap(t,e,n,o,r){var s,l,a,h;const{flush:d=!1}=this.attribute.label||{};if(d&&t.length){const{orient:u,start:c,end:f}=this.attribute,g=u==="bottom"||u==="top",p=t[0],v=Co(t),m=g?p.attribute.x>v.attribute.x:p.attribute.y<v.attribute.y;if(g){const b=m?v:p,C=m?p:v,_=c.x,w=f.x,y=b.AABBBounds.x1,x=C.AABBBounds.x2;y<_&&(b.attribute.angle?b.setAttributes({dx:((s=b.attribute.dx)!==null&&s!==void 0?s:0)+_-y}):b.setAttributes({x:_,textAlign:"left"})),x>w&&(C.attribute.angle?C.setAttributes({dx:((l=C.attribute.dx)!==null&&l!==void 0?l:0)+w-x}):C.setAttributes({x:w,textAlign:"right"}))}else{const b=m?v:p,C=m?p:v,_=b.AABBBounds.y2,w=C.AABBBounds.y1,y=c.y,x=f.y;w<y&&(C.attribute.angle?C.setAttributes({dy:((a=C.attribute.dy)!==null&&a!==void 0?a:0)+y-w}):C.setAttributes({y,textBaseline:"top"})),_>x&&(b.attribute.angle?b.setAttributes({dy:((h=b.attribute.dy)!==null&&h!==void 0?h:0)+x-_}):b.setAttributes({y:x,textBaseline:"bottom"}))}}}handleLabelsOverlap(t,e,n,o,r){if(wt(t))return;const{verticalLimitSize:s,label:l,orient:a}=this.attribute,h=this._getAxisLabelLimitLength(s,r),{layoutFunc:d,autoRotate:u,autoRotateAngle:c,autoLimit:f,limitEllipsis:g,autoHide:p,autoHideMethod:v,autoHideSeparation:m,lastVisible:b,firstVisible:C,autoWrap:_,overflowLimitLength:w}=l;if(Mt(d))d(t,e,o,this);else{if(u)cP(t,{labelRotateAngle:c,orient:a});else if(_){const y=Math.abs(a==="left"||a==="right"?this.attribute.start.y-this.attribute.end.y:this.attribute.start.x-this.attribute.end.x);CP(t,{orient:a,limitLength:h,axisLength:y,ellipsis:g})}if(!_&&f&&Yt(h)&&h>0){const y=a==="left"||a==="right",x=Math.abs(y?this.attribute.start.y-this.attribute.end.y:this.attribute.start.x-this.attribute.end.x),S=y?x/t.length:p||u?1/0:x/t.length;bP(t,{limitLength:h,verticalLimitLength:S,ellipsis:g,orient:a,axisLength:x,overflowLimitLength:w})}p&&uP(t,{method:v,separation:m,lastVisible:b,firstVisible:C})}}afterLabelsOverlap(t,e,n,o,r){const{verticalLimitSize:s,orient:l}=this.attribute,a=l==="bottom"||l==="top",h=n.AABBBounds;let d=a?h.height():h.width();const{verticalMinSize:u}=this.attribute;if(Yt(u)&&(!Yt(s)||u<=s)){const c=this._getAxisLabelLimitLength(u,r);let f,g;d=Math.max(d,c),l==="left"?(f=h.x2-d,g=h.y1):l==="right"?(f=h.x1,g=h.y1):l==="top"?(f=h.x1,g=h.y2-d):l==="bottom"&&(f=h.x1,g=h.y1);const p=ft.rect({x:f,y:g,width:a?h.width():d,height:a?d:h.height(),pickable:!1});p.name=Te.axisLabelBackground,p.id=this._getNodeId("axis-label-background"),n.insertBefore(p,n.firstChild)}if(O(this.attribute.label.containerAlign)){let c;l==="left"?c=h.x2-d:l==="right"?c=h.x1:l==="top"?c=h.y2-d:l==="bottom"&&(c=h.y1),_P(t,c,d,l,this.attribute.label.containerAlign)}}_getAxisLabelLimitLength(t,e){var n,o,r,s,l;const{label:a,title:h,line:d,tick:u}=this.attribute,c=(n=a.space)!==null&&n!==void 0?n:4;let f=t,g=0,p=0;const v=d&&d.visible?(o=d.style.lineWidth)!==null&&o!==void 0?o:1:0,m=u&&u.visible?(r=u.length)!==null&&r!==void 0?r:4:0;if(h&&h.visible&&typeof h.text=="string"){g=ud(h.text,h.textStyle,(l=(s=this.stage)===null||s===void 0?void 0:s.getTheme())===null||l===void 0?void 0:l.text).height;const b=Qi(h.padding);p=h.space+b[0]+b[2]}return f&&(f=(f-c-p-g-v-m)/e),f}release(){super.release(),this._breaks=null}}Gs.defaultAttributes=Lc,By(Gs,wP);const xn=i=>i.map((t,e)=>({index:e,value:t})),hv=(i,t,e=0)=>{const n=new Gt(i).expand(e/2),o=new Gt(t).expand(e/2);return n.intersects(o)},dv=12,El=(i,t,e,n)=>e<i?Math.max(i-t/2,e):e>i?Math.min(i-t/2,e-t):e<n?e:e-t,zc=(i,t,e)=>{var n;const{labelStyle:o,axisOrientType:r,labelFlush:s,labelFormatter:l,startAngle:a=0}=e;let h=(n=o.angle)!==null&&n!==void 0?n:0;o.direction==="vertical"&&(h+=To(90));const d=["bottom","top"].includes(r),u=["left","right"].includes(r);let c=1,f=0;d||(u?(c=0,f=1):a&&(c=Math.cos(a),f=-Math.sin(a)));const g=n_(o),p=i.range();return t.map((m,b)=>{var C,_;const w=l?l(m):`${m}`,{width:y,height:x}=g.quickMeasure(w),S=Math.max(y,12),R=Math.max(x,12),B=i.scale(m),A=c*B,M=f*B;let k,E,T=A,P=M;s&&d&&b===0?T=El(A,S,p[0],p[p.length-1]):s&&d&&b===t.length-1?T=El(A,S,p[p.length-1],p[0]):k=(C=o.textAlign)!==null&&C!==void 0?C:"center",k==="right"?T-=S:k==="center"&&(T-=S/2),s&&u&&b===0?P=El(M,R,p[0],p[p.length-1]):s&&u&&b===t.length-1?P=El(M,R,p[p.length-1],p[0]):E=(_=o.textBaseline)!==null&&_!==void 0?_:"middle",E==="bottom"?P-=R:E==="middle"&&(P-=R/2);const H=new Gt().set(T,P,T+S,P+R);return h&&H.rotate(h,A,M),H})},xP=i=>["bottom","top","z"].includes(i);function Ud(i,t,e,n){let o;const{breakData:r}=i;if(r&&r()){const{breakDomains:s}=r(),l=t.domain();o=[];for(let a=0;a<l.length-1;a++)n(e,[l[a],l[a+1]]).forEach(h=>{s.some(d=>h>=d[0]&&h<=d[1])||o.push(h)});t.domain(l)}else o=n(e);return o}function uv(i,t,e,n,o=!1){if(e&&!t.includes(i)){let r=t.length;if(r>1){o?t.push(i):t.unshift(i);for(let s=0;s<r;s++){const l=o?r-1-s:s;if(!n(t[l]))break;t.splice(l,1),s--,r--}}}}const RP=(i,t)=>{var e,n;if(!Ib(i.type))return xn(i.domain());const o=i.range(),r=Math.abs(o[o.length-1]-o[0]);if(r<2)return xn([i.domain()[0]]);const{tickCount:s,forceTickCount:l,tickStep:a,noDecimals:h=!1,labelStyle:d,breakData:u}=t;let c;if(O(a))f=i.stepTicks(a),g=u&&u()?u().breakDomains:null,c=g&&g.length?f.filter(v=>g.every(m=>v<m[0]||v>m[1])):f;else if(O(l))c=Ud(t,i,l,(v,m)=>m&&m.length?i.domain(m,!0).forceTicks(v):i.forceTicks(v));else if(t.tickMode==="d3"){const v=(e=Mt(s)?s({axisLength:r,labelStyle:d}):s)!==null&&e!==void 0?e:5;c=Ud(t,i,v,(m,b)=>b&&b.length?i.domain(b,!0).d3Ticks(m,{noDecimals:h}):i.d3Ticks(m,{noDecimals:h}))}else{const v=(n=Mt(s)?s({axisLength:r,labelStyle:d}):s)!==null&&n!==void 0?n:5,m=Mt(t.tickMode)?t.tickMode:void 0;c=Ud(t,i,v,(b,C)=>C&&C.length?i.domain(C,!0).ticks(b,{noDecimals:h,customTicks:m}):i.ticks(b,{noDecimals:h,customTicks:m}))}var f,g;const p=i.domain();if(t.labelFirstVisible&&p[0]!==c[0]&&!c.includes(p[0])&&c.unshift(p[0]),t.labelLastVisible&&p[p.length-1]!==c[c.length-1]&&!c.includes(p[p.length-1])&&c.push(p[p.length-1]),t.sampling&&c.length>1&&(t.coordinateType==="cartesian"||t.coordinateType==="polar"&&t.axisOrientType==="radius")){const{labelGap:v=4,labelFlush:m}=t,b=6;let C;if(c.length*b>r){const B=[],A=Math.floor(c.length*b/r);c.forEach((M,k)=>{k%A!=0&&k!==c.length-1||B.push(M)}),C=zc(i,B,t).map((M,k)=>({AABBBounds:M,value:B[k]}))}else C=zc(i,c,t).map((B,A)=>({AABBBounds:B,value:c[A]}));const _=C[0],w=Co(C),y=u&&u()?cv.greedy:cv.parity;for(;C.length>=3&&Fc(C,v);)C=y(C,v);const x=t.labelFirstVisible;let S=t.labelLastVisible;Ii(_,w,v)&&C.includes(w)&&C.length>1&&x&&S&&(C.splice(C.indexOf(w),1),S=!1),uv(_,C,x,B=>Ii(B,_,v)),uv(w,C,S,B=>Ii(B,w,v)||!(!x||B===_)&&Ii(B,_,v),!0);const R=C.map(B=>B.value);R.length<3&&m&&(R.length>1&&R.pop(),Co(R)!==Co(c)&&R.push(Co(c))),c=R}return xn(c)},cv={parity:function(i){return i.filter((t,e)=>e%2==0)},greedy:function(i,t){let e;return i.filter((n,o)=>(!o||!Ii(e,n,t))&&(e=n,!0))}},gv=(i,t,e,n)=>zc(i,t,e).map(o=>n?[o.x1,o.x2,o.width()]:[o.y1,o.y2,o.height()]),fv=(i,t,e=0)=>Math.max(i[0],t[0])-e/2<=Math.min(i[1],t[1])+e/2,pv=(i,t)=>i[1]<t[0]?t[0]-i[1]:t[1]<i[0]?i[0]-t[1]:0,AP=(i,t)=>{var e;const n=i.domain();if(!n.length)return[];const{tickCount:o,forceTickCount:r,tickStep:s,labelGap:l=4,axisOrientType:a,labelStyle:h}=t,d=xP(a),u=i.range(),c=i.calculateWholeRangeSize();if(c<2)return t.labelLastVisible?xn([n[n.length-1]]):xn([n[0]]);let f;if(O(s))f=i.stepTicks(s);else if(O(r))f=i.forceTicks(r);else if(O(o)){const g=Mt(o)?o({axisLength:c,labelStyle:h}):o;f=i.ticks(g)}else if(t.sampling){const g=((e=t.labelStyle.fontSize)!==null&&e!==void 0?e:12)+2,p=Kh(u),v=vg(u);if(n.length<=c/g){const m=(v-p)/n.length,b=gv(i,n,t,d),C=Math.min(...b.map(w=>w[2])),_=BP(n,b,l,t.labelLastVisible,Math.floor(C/m));f=i.stepTicks(_.step),t.labelLastVisible&&(_.delCount&&(f=f.slice(0,f.length-_.delCount)),f.push(n[n.length-1]))}else{const m=[n[0],n[Math.floor(n.length/2)],n[n.length-1]],b=gv(i,m,t,d);let C=null;b.forEach(w=>{C?C[2]<w[2]&&(C=w):C=w});const _=v-p-l>0?Math.ceil(n.length*(l+C[2])/(v-p-l)):n.length-1;f=i.stepTicks(_),!t.labelLastVisible||f.length&&f[f.length-1]===n[n.length-1]||(f.length&&Math.abs(i.scale(f[f.length-1])-i.scale(n[n.length-1]))<C[2]&&(f=f.slice(0,-1)),f.push(n[n.length-1]))}}else f=i.domain();return xn(f)},BP=(i,t,e,n,o,r)=>{let s=0,l=0,a=-1,h=Number.MAX_VALUE;const d=f=>{let g=!0,p=0;do p+f<i.length&&fv(t[p],t[p+f],e)&&(g=!1),p+=f;while(g&&p<i.length);return g},u=My(o,i.length,f=>d(f)?1:-1);let c=u;do if(c>u&&!d(c))c++;else{if(!n){l=c;break}{const f=i.length-1;let g,p=0;g=i.length%c>0?i.length-i.length%c+c:i.length;do{if(g-=c,g!==f&&!fv(t[g],t[f],e))break;p++}while(g>0);if(g===f){l=c,s=p;break}{const v=Math.floor(i.length/c)-p+1;if(v<a)break;{a=v;const m=pv(t[g],t[f]),b=g-c>=0?pv(t[g-c],t[g]):m,C=Math.abs(m-b);if(C<h&&(h=C,l=c,s=p),m<=b)break}}}c++}while(c<=i.length);return{step:l,delCount:s}},MP=(i,t,e)=>{var n;const{labelStyle:o,getRadius:r,labelOffset:s,labelFormatter:l,inside:a}=e,h=r==null?void 0:r(),d=(n=o.angle)!==null&&n!==void 0?n:0,u=n_(o);return t.map(c=>{const f=l?l(c):`${c}`,{width:g,height:p}=u.quickMeasure(f),v=Math.max(g,dv),m=Math.max(p,dv),b=i.scale(c),C={x:0,y:0};let _=0,w=0;const y={align:o.textAlign,baseline:o.textBaseline},{x,y:S}=oP(b,C,h,s,a);return y.align||(Cn(x,C.x)?y.baseline||(y.baseline=S>C.y?"top":"bottom"):x>C.x?y.align="left":x<C.x&&(y.align="right")),_=x+(y.align==="right"?-v:y.align==="left"?0:-v/2),w=S+(y.baseline==="bottom"?-m:y.baseline==="top"?0:-m/2),new Gt().set(_,w,_+v,w+m).rotate(d,_+v/2,w+m/2)})},TP=(i,t)=>{const{tickCount:e,forceTickCount:n,tickStep:o,getRadius:r,labelOffset:s,labelGap:l=0,labelStyle:a}=t,h=r==null?void 0:r();if(!h)return xn(i.domain());let d;if(O(o))d=i.stepTicks(o);else if(O(n))d=i.forceTicks(n);else if(O(e)){const u=i.range(),c=Math.abs(u[u.length-1]-u[0]),f=Mt(e)?e({axisLength:c,labelStyle:a}):e;d=i.ticks(f)}else if(t.sampling){const u=i.domain(),c=i.range(),f=MP(i,u,t),g=Kh(c),p=vg(c),v=Math.abs(p-g)*(h+s)/u.length,{step:m,delCount:b}=PP(u,f,l,Math.floor(f.reduce((C,_)=>Math.min(C,_.width(),_.height()),Number.MAX_VALUE)/v));d=i.stepTicks(m),d=d.slice(0,d.length-b)}else d=i.domain();return xn(d)},PP=(i,t,e,n)=>{let o=n;do{let s=!0;o++;let l=0;do l+o<i.length&&hv(t[l],t[l+o],e)&&(s=!1),l+=o;while(s&&l<i.length);if(s)break}while(o<=i.length);let r=0;if(i.length>2){let s=i.length-i.length%o;for(s>=i.length&&(s-=o);s>0&&hv(t[0],t[s]);)r++,s-=o}return{step:o,delCount:r}},HP=(i,t)=>{if(Ib(i.type))return RP(i,t);if(Ty(i.type)){if(t.coordinateType==="cartesian")return AP(i,t);if(t.coordinateType==="polar"&&t.axisOrientType==="angle")return TP(i,t)}return xn(i.domain())};function v_(){ii(),Or(),on()}const m_={space:8,style:{fill:"rgb(47, 69, 84)",cursor:"pointer",size:15},state:{disable:{fill:"rgb(170, 170, 170)",cursor:"not-allowed"},hover:{}}};v_();class js extends gi{getCurrent(){return this._current}constructor(t,e){super(e!=null&&e.skipDefault?t:rt({},js.defaultAttributes,t)),this.name="pager",this._current=1,this._onHover=n=>{const o=n.target;o.hasState("disable")||o.addState("hover")},this._onUnHover=n=>{n.target.removeState("hover")},this._onClick=n=>{const o=n.target;if(o.name==="preHandler"){if(this._current===1)return;this._current-=1,this._current===1?o.addState("disable"):o.removeState("disable"),this._dispatchEvent("toPrev",{current:this._current,total:this._total,direction:"pre",event:n})}if(o.name==="nextHandler"){if(this._current===this._total)return;this._current+=1,this._current===this._total?o.addState("disable"):o.removeState("disable"),this._dispatchEvent("toNext",{current:this._current,total:this._total,direction:"next",event:n})}this._current>1&&this.preHandler.removeState("disable"),this._current<this._total&&this.nextHandler.removeState("disable"),this.text.setAttribute("text",this._getPageText(this._current))}}render(){var t,e,n;this._reset();const{layout:o="horizontal",handler:r=m_,total:s,defaultCurrent:l=1,textStyle:a,padding:h=0}=this.attribute;this._current=l;const d=Qi(h),u=o==="horizontal",c=ft.group({x:0,y:0}),f=r.style||{},g=f.size||15,p=(t=r.space)!==null&&t!==void 0?t:8,v=r.state||{};let{preShape:m,nextShape:b}=r;m||(m=u?"triangleLeft":"triangleUp"),b||(b=u?"triangleRight":"triangleDown");const C=ft.symbol(Object.assign(Object.assign({strokeBoundsBuffer:0,pickMode:"imprecise"},f),{x:0,y:0,symbolType:m,size:g}));C.states=v,C.name="preHandler",this.preHandler=C,c.add(C);const{width:_,height:w}=ud(this._getPageText(s),Object.assign({textAlign:"center",textBaseline:"middle"},a),(n=(e=this.stage)===null||e===void 0?void 0:e.getTheme())===null||n===void 0?void 0:n.text),y=Z(g)?g:g[0],x=Z(g)?g:g[1],S=ft.text(Object.assign({x:u?y/2+p+_/2:0,y:u?0:x/2+p+w/2,text:this._getPageText(l),textAlign:"center",textBaseline:"middle",lineHeight:a==null?void 0:a.fontSize},a));this.text=S,c.add(S);const R=ft.symbol(Object.assign(Object.assign({strokeBoundsBuffer:0,pickMode:"imprecise"},f),{x:u?y+2*p+_:0,y:u?0:x+2*p+w,symbolType:b,size:g}));R.name="nextHandler",R.states=v,this.nextHandler=R,c.add(R),this._total===1?(C.addState("disable"),R.addState("disable")):this._current===1?C.addState("disable"):this._current===s&&R.addState("disable");const B=c.AABBBounds,A=B.width(),M=B.height();c.translateTo(0-B.x1+d[3],0-B.y1+d[0]),this.add(c),this.attribute.width=A+d[1]+d[3],this.attribute.height=M+d[0]+d[2],this._bindEvents()}_bindEvents(){this.attribute.disableTriggerEvent||(this.preHandler&&(this.preHandler.addEventListener("pointerenter",this._onHover),this.preHandler.addEventListener("pointerleave",this._onUnHover),this.preHandler.addEventListener("pointerdown",this._onClick)),this.nextHandler&&(this.nextHandler.addEventListener("pointerenter",this._onHover),this.nextHandler.addEventListener("pointerleave",this._onUnHover),this.nextHandler.addEventListener("pointerdown",this._onClick)))}_reset(){this.removeAllChild(!0),this._current=1,this._total=this.attribute.total,this.preHandler=this.nextHandler=this.text=null}_getPageText(t){const{pageFormatter:e}=this.attribute;return e?Mt(e)?e(t,this._total):`${e}`.replace("{current}",`${t}`).replace("{total}",`${this._total}`):`${t}/${this._total}`}setTotal(t){t!==this.attribute.total&&(this._total=t,this._current!==1&&this._current<=t?this.setAttributes({total:t,defaultCurrent:this._current}):this.setAttribute("total",t))}}js.defaultAttributes={handler:m_,textStyle:{fill:"rgb(51, 51, 51)",fontSize:12}};const lh=10,b_=8,C_=8,kP=8,Jl=16,Ql=8,al=12,Ic=12;var pt;(function(i){i.selected="selected",i.unSelected="unSelected",i.selectedHover="selectedHover",i.unSelectedHover="unSelectedHover",i.focus="focus"})(pt||(pt={}));var wi;(function(i){i.legendItemHover="legendItemHover",i.legendItemUnHover="legendItemUnHover",i.legendItemClick="legendItemClick",i.legendItemAttributeUpdate="legendItemAttributeUpdate"})(wi||(wi={}));var Me;(function(i){i.innerView="innerView",i.title="legendTitle",i.item="legendItem",i.itemShape="legendItemShape",i.itemLabel="legendItemLabel",i.itemValue="legendItemValue",i.focus="legendItemFocus"})(Me||(Me={}));class Ug extends gi{constructor(){super(...arguments),this.name="legend",this._title=null}render(){this.removeAllChild(!0);const{interactive:t=!0,title:e,padding:n=0}=this.attribute;this._parsedPadding=Qi(n);const o=ft.group({x:this._parsedPadding[3],y:this._parsedPadding[0],pickable:t,childrenPickable:t});o.name=Me.innerView,this.add(o),this._innerView=o,e!=null&&e.visible&&this._renderTitle(e),this._renderContent(),this._adjustLayout(),t&&this._bindEvents();const r=this._innerView.AABBBounds;this.attribute.width=r.width()+this._parsedPadding[1]+this._parsedPadding[3],this.attribute.height=r.height()+this._parsedPadding[0]+this._parsedPadding[2]}_renderTitle(t){const{text:e="",textStyle:n,padding:o=0,background:r,minWidth:s,maxWidth:l,shape:a}=t,h={x:0,y:0,text:e,textStyle:n,padding:Qi(o),minWidth:s,maxWidth:l};a&&a.visible&&(h.shape=Object.assign({visible:!0},a.style),O(a.space)&&(h.space=a.space)),r&&r.visible&&(h.panel=Object.assign({visible:!0},r.style));const d=new ll(h);d.name=Me.title,this._title=d,this._innerView.add(d)}_adjustLayout(){var t;if(this._title){const e=this._innerView.AABBBounds.width(),n=this._title.AABBBounds.width(),o=(t=this.attribute.title)===null||t===void 0?void 0:t.align;o==="center"?this._title.setAttribute("x",(e-n)/2):o==="end"&&this._title.setAttribute("x",e-n)}}}function $g(){ii(),on(),Tn(),Or()}function Kg(){ii(),s_()}function EP(){Kg(),v_(),QC()}function LP(){Kg(),$g()}function FP(){Kg(),$g(),HT()}var vv=function(i,t){var e={};for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&t.indexOf(n)<0&&(e[n]=i[n]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function"){var o=0;for(n=Object.getOwnPropertySymbols(i);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(i,n[o])&&(e[n[o]]=i[n[o]])}return e};const zP={[pt.focus]:{},[pt.selected]:{},[pt.selectedHover]:{},[pt.unSelected]:{},[pt.unSelectedHover]:{}};EP();class fd extends Ug{constructor(t,e){super(e!=null&&e.skipDefault?t:rt({},fd.defaultAttributes,t)),this.name="discreteLegend",this._itemsContainer=null,this._itemHeightByUser=void 0,this._itemHeight=0,this._itemMaxWidth=0,this._contentMaxHeight=0,this._onHover=n=>{const o=n.target;if(o&&o.name&&o.name.startsWith(Me.item)){const r=o.delegate;if(this._lastActiveItem){if(this._lastActiveItem.id===r.id)return;this._unHover(this._lastActiveItem,n)}this._hover(r,n)}else this._lastActiveItem&&(this._unHover(this._lastActiveItem,n),this._lastActiveItem=null)},this._onUnHover=n=>{this._lastActiveItem&&(this._unHover(this._lastActiveItem,n),this._lastActiveItem=null)},this._onClick=n=>{var o,r,s,l;const a=n.target;if(a&&a.name&&a.name.startsWith(Me.item)){const h=a.delegate,{selectMode:d="multiple"}=this.attribute;if(a.name===Me.focus||d==="focus"){const u=h.hasState(pt.focus);h.toggleState(pt.focus),u?(o=this._itemsContainer)===null||o===void 0||o.getChildren().forEach(c=>{this._removeLegendItemState(c,[pt.unSelected,pt.unSelectedHover,pt.focus],n),this._setLegendItemState(c,pt.selected,n)}):(this._setLegendItemState(h,pt.selected,n),this._removeLegendItemState(h,[pt.unSelected,pt.unSelectedHover],n),(r=this._itemsContainer)===null||r===void 0||r.getChildren().forEach(c=>{h!==c&&(this._removeLegendItemState(c,[pt.selected,pt.selectedHover,pt.focus],n),this._setLegendItemState(c,pt.unSelected,n))}))}else{(s=this._itemsContainer)===null||s===void 0||s.getChildren().forEach(g=>{g.removeState(pt.focus)});const{allowAllCanceled:u=!0}=this.attribute,c=h.hasState(pt.selected),f=this._getSelectedLegends();if(d==="multiple"){if(u===!1&&c&&f.length===1)return void this._dispatchLegendEvent(wi.legendItemClick,h,n);c?(this._removeLegendItemState(h,[pt.selected,pt.selectedHover],n),this._setLegendItemState(h,pt.unSelected,n)):(this._setLegendItemState(h,pt.selected,n),this._removeLegendItemState(h,[pt.unSelected,pt.unSelectedHover],n))}else this._setLegendItemState(h,pt.selected,n),this._removeLegendItemState(h,[pt.unSelected,pt.unSelectedHover],n),(l=this._itemsContainer)===null||l===void 0||l.getChildren().forEach(g=>{h!==g&&(this._removeLegendItemState(g,[pt.selected,pt.selectedHover],n),this._setLegendItemState(g,pt.unSelected,n))})}this._dispatchLegendEvent(wi.legendItemClick,h,n)}}}render(){super.render(),this._lastActiveItem=null}setSelected(t){var e;((e=this._itemsContainer)===null||e===void 0?void 0:e.getChildren()).forEach(n=>{const o=n.data;t.includes(o.label)?(this._setLegendItemState(n,pt.selected),this._removeLegendItemState(n,[pt.unSelected,pt.unSelectedHover])):(this._removeLegendItemState(n,[pt.selected,pt.selectedHover]),this._setLegendItemState(n,pt.unSelected))})}_renderItems(){const{item:t={},maxCol:e=1,maxRow:n=2,maxWidth:o,defaultSelected:r,lazyload:s,autoPage:l}=this.attribute,{spaceCol:a=Jl,spaceRow:h=Ql,verticalAlign:d="middle"}=t,u=this._itemsContainer,{items:c,isHorizontal:f,startIndex:g,isScrollbar:p}=this._itemContext,v=p?1:f?n:e,m=this._contentMaxHeight;let b,{doWrap:C,maxWidthInCol:_,startX:w,startY:y,pages:x}=this._itemContext,S=0,R=0;const B=[];for(let A=g,M=c.length;A<M&&!(s&&x>this._itemContext.currentPage*v);A++){s&&(this._itemContext.startIndex=A+1),b=c[A],b.id||(b.id=b.label),b.index=A;let k=!0;Q(r)&&(k=r.includes(b.label));const E=this._renderEachItem(b,k,A,c),T=E.attribute.width,P=E.attribute.height;this._itemHeight=Math.max(this._itemHeight,P),_=Math.max(T,_),this._itemMaxWidth=Math.max(T,this._itemMaxWidth),f?(O(o)&&(p&&l?(x=Math.ceil((w+T)/o),C=x>1):w+T>o&&(C=!0,w>0&&(d!=="middle"&&d!=="bottom"||B.forEach(H=>{H.setAttributes({y:H.attribute.y+(R-H.attribute.height)/(d==="middle"?2:1)})}),x+=1,w=0,y+=R+h,R=0,B.length=0))),w===0&&y===0||E.setAttributes({x:w,y}),w+=a+T,R=Math.max(R,P),B.push(E)):(O(m)&&(p&&l?(x=Math.ceil((y+P)/m),C=x>1):m<=P?(x+=1,C=!0,y=0,A>0&&(w+=S+a)):m<y+P&&(x+=1,C=!0,y=0,w+=_+a,_=0)),w===0&&y===0||E.setAttributes({x:w,y}),y+=h+P),u.add(E),S=T}return!f||d!=="middle"&&d!=="bottom"||B.forEach(A=>{A.setAttributes({y:A.attribute.y+(R-A.attribute.height)/(d==="middle"?2:1)})}),this._itemContext.doWrap=C,this._itemContext.startX=w,this._itemContext.startY=y,this._itemContext.maxWidthInCol=_,this._itemContext.pages=x,this._itemContext.maxPages=v,p&&(this._itemContext.totalPage=x),s||(this._itemContext.startIndex=c.length),this._itemContext}_renderContent(){const{item:t={},items:e,reversed:n,maxWidth:o,maxHeight:r}=this.attribute;if(t.visible===!1||wt(e))return;let s=e;n&&(s=e==null?void 0:e.reverse()),this._contentMaxHeight=Math.max(0,r-this._parsedPadding[0]-this._parsedPadding[2]);const l=ft.group({x:0,y:0});this._itemsContainer=l;const{layout:a,autoPage:h}=this.attribute,d=a==="horizontal",{maxWidth:u,width:c,height:f}=t,g=[];O(u)&&g.push(u),O(c)&&g.push(c),g.length&&(O(o)&&g.push(o),this._itemWidthByUser=Kh(g)),O(f)&&(this._itemHeightByUser=f);const p=this.attribute.pager;this._itemContext={currentPage:p&&p.defaultCurrent||1,doWrap:!1,maxWidthInCol:0,maxPages:1,pages:1,startX:0,startY:0,startIndex:0,items:s,isHorizontal:d,totalPage:1/0,isScrollbar:p&&p.type==="scrollbar",clipContainer:void 0},this._itemContext=this._renderItems();let v=!1;this._itemContext.doWrap&&h&&this._itemContext.pages>this._itemContext.maxPages&&(v=this._renderPagerComponent()),v||(l.setAttribute("y",this._title?this._title.AABBBounds.height()+we(this.attribute,"title.space",8):0),this._innerView.add(l))}_bindEvents(){if(this.attribute.disableTriggerEvent||!this._itemsContainer)return;const{hover:t=!0,select:e=!0}=this.attribute;if(t){let n="pointermove",o="pointerleave";kt(t)&&(t.trigger&&(n=t.trigger),t.triggerOff&&(o=t.triggerOff)),this._itemsContainer.addEventListener(n,this._onHover),this._itemsContainer.addEventListener(o,this._onUnHover)}if(e){let n="pointerdown";kt(e)&&e.trigger&&(n=e.trigger),this._itemsContainer.addEventListener(n,this._onClick)}}_autoEllipsis(t,e,n,o){var r,s;const{label:l,value:a}=this.attribute.item,h=o.AABBBounds,d=n.AABBBounds,u=h.width(),c=d.width();let f=!1;t==="labelFirst"?c>e?f=!0:o.setAttribute("maxLineWidth",e-c):t==="valueFirst"?u>e?f=!0:n.setAttribute("maxLineWidth",e-u):u+c>e&&(f=!0),f&&(o.setAttribute("maxLineWidth",Math.max(e*((r=l.widthRatio)!==null&&r!==void 0?r:.5),e-c)),n.setAttribute("maxLineWidth",Math.max(e*((s=a.widthRatio)!==null&&s!==void 0?s:.5),e-u)))}_renderEachItem(t,e,n,o){var r,s;const{id:l,label:a,value:h,shape:d}=t,{padding:u=0,focus:c,focusIconStyle:f,align:g,autoEllipsisStrategy:p}=this.attribute.item,{shape:v,label:m,value:b,background:C}=this.attribute.item,_=this._handleStyle(v,t,e,n,o),w=this._handleStyle(m,t,e,n,o),y=this._handleStyle(b,t,e,n,o),x=this._handleStyle(C,t,e,n,o),S=Qi(u);let R;C.visible===!1?(R=ft.group({x:0,y:0,cursor:(r=x.style)===null||r===void 0?void 0:r.cursor}),this._appendDataToShape(R,Me.item,t,R)):(R=ft.group(Object.assign({x:0,y:0},x.style)),this._appendDataToShape(R,Me.item,t,R,x.state)),R.id=`${l??a}-${n}`,R.addState(e?pt.selected:pt.unSelected);const B=ft.group({x:0,y:0,pickable:!1});R.add(B);let A,M=0,k=0,E=0;if(v&&v.visible!==!1){const j=we(_,"style.size",lh);k=Q(j)?j[0]||0:j,E=we(v,"space",b_);const V=ft.symbol(Object.assign(Object.assign({x:0,y:0,symbolType:"circle",strokeBoundsBuffer:0},d),_.style));Object.keys(_.state||{}).forEach(X=>{const K=_.state[X].fill||_.state[X].stroke;d.fill&&Pt(_.state[X].fill)&&K&&(_.state[X].fill=K),d.stroke&&Pt(_.state[X].stroke)&&K&&(_.state[X].stroke=K)}),this._appendDataToShape(V,Me.itemShape,t,R,_.state),V.addState(e?pt.selected:pt.unSelected),B.add(V)}let T=0;if(c){const j=we(f,"size",lh);A=ft.symbol(Object.assign(Object.assign({x:0,y:-j/2-1,strokeBoundsBuffer:0,boundsPadding:S},f),{visible:!0,pickMode:"imprecise"})),this._appendDataToShape(A,Me.focus,t,R),T=j}const P=m.formatMethod?m.formatMethod(a,t,n):a,H=Object.assign(Object.assign({x:k/2+E,y:0,textAlign:"start",textBaseline:"middle",lineHeight:(s=w.style)===null||s===void 0?void 0:s.fontSize},w.style),{text:P,_originText:m.formatMethod?a:void 0}),L=kc(H);this._appendDataToShape(L,Me.itemLabel,t,R,w.state),L.addState(e?pt.selected:pt.unSelected),B.add(L);const F=we(m,"space",C_);if(O(h)){const j=we(b,"space",c?kP:0),V=b.formatMethod?b.formatMethod(h,t,n):h,X=Object.assign(Object.assign({x:0,y:0,textAlign:"start",textBaseline:"middle",lineHeight:y.style.fontSize},y.style),{text:V,_originText:b.formatMethod?h:void 0}),K=kc(X);if(this._appendDataToShape(K,Me.itemValue,t,R,y.state),K.addState(e?pt.selected:pt.unSelected),this._itemWidthByUser){const J=this._itemWidthByUser-S[1]-S[3]-k-E-F-T-j;this._autoEllipsis(p,J,L,K),b.alignRight?K.setAttributes({textAlign:"right",x:this._itemWidthByUser-k/2-S[1]-S[3]-T-j}):K.setAttribute("x",F+(L.AABBBounds.empty()?0:L.AABBBounds.x2))}else K.setAttribute("x",F+(L.AABBBounds.empty()?0:L.AABBBounds.x2));M=j+(K.AABBBounds.empty()?0:K.AABBBounds.x2),B.add(K)}else this._itemWidthByUser&&L.setAttribute("maxLineWidth",this._itemWidthByUser-S[1]-S[3]-k-E-T),M=F+(L.AABBBounds.empty()?0:L.AABBBounds.x2);A&&(A.setAttribute("x",M),B.add(A));const z=B.AABBBounds,I=z.width();if(g==="right"){const j=z.x2,V=z.x1;B.forEachChildren((X,K)=>{X.type!=="symbol"&&X.attribute.textAlign!=="right"||X===A?X.setAttribute("x",V+j-X.attribute.x-X.AABBBounds.width()):X.type!=="symbol"?X.setAttributes({x:V+j-X.attribute.x,textAlign:"left"}):X.setAttribute("x",V+j-X.attribute.x)})}const N=z.height(),W=O(this.attribute.item.width)?this.attribute.item.width:I+S[1]+S[3],D=this._itemHeightByUser||N+S[0]+S[2];return R.attribute.width=W,R.attribute.height=D,A&&A.setAttribute("visible",!1),B.translateTo(-z.x1+S[3],-z.y1+S[0]),R}_createPager(t){var e,n;const{disableTriggerEvent:o,maxRow:r}=this.attribute,s=l=>l<=99?99:l<=999?999:9999;return this._itemContext.isHorizontal?new js(Object.assign(Object.assign({layout:r===1?"horizontal":"vertical",total:s(this._itemContext.pages)},rt({handler:{preShape:"triangleUp",nextShape:"triangleDown"}},t)),{defaultCurrent:(e=this.attribute.pager)===null||e===void 0?void 0:e.defaultCurrent,disableTriggerEvent:o})):new js(Object.assign({layout:"horizontal",total:s(this._itemContext.pages),disableTriggerEvent:o,defaultCurrent:(n=this.attribute.pager)===null||n===void 0?void 0:n.defaultCurrent},t))}_createScrollbar(t,e){const{disableTriggerEvent:n}=this.attribute;return this._itemContext.isHorizontal?new Eo(Object.assign(Object.assign({direction:"horizontal",disableTriggerEvent:n,range:[0,.5],height:t.visible===!1?0:12},t),{width:e})):new Eo(Object.assign(Object.assign({direction:"vertical",width:t.visible===!1?0:12,range:[0,.5]},t),{height:e,disableTriggerEvent:n}))}_updatePositionOfPager(t,e,n){const{pager:o}=this.attribute,{totalPage:r,isHorizontal:s}=this._itemContext,l=o&&o.position||"middle";if(this._pagerComponent.setTotal(r),s){let a;a=l==="start"?t:l==="end"?t+n-this._pagerComponent.AABBBounds.height()/2:t+n/2-this._pagerComponent.AABBBounds.height()/2,this._pagerComponent.setAttributes({x:e-this._pagerComponent.AABBBounds.width(),y:a})}else{let a;a=l==="start"?0:l==="end"?e-this._pagerComponent.AABBBounds.width():(e-this._pagerComponent.AABBBounds.width())/2,this._pagerComponent.setAttributes({x:a,y:n-this._pagerComponent.AABBBounds.height()})}}_computeScrollbarDelta(){const{isHorizontal:t,clipContainer:e}=this._itemContext,n=this._itemsContainer.AABBBounds,o=e.AABBBounds;let r,s;return t?(s=o.width(),r=s/n.width()):(s=o.height(),r=s/n.height()),r}_updatePositionOfScrollbar(t,e,n){const{isHorizontal:o,currentPage:r,totalPage:s}=this._itemContext,l=(r-1)/s;this._pagerComponent.setScrollRange([l,l+this._computeScrollbarDelta()]),o?this._pagerComponent.setAttributes({x:0,y:n+e}):this._pagerComponent.setAttributes({x:t,y:n})}_bindEventsOfPager(t,e){const n=this.attribute.pager||{},{animation:o=!0,animationDuration:r=450,animationEasing:s="quadIn"}=n,l=this._itemContext.isScrollbar?d=>{const{value:u}=d.detail;let c;return c=u[0]===0?1:u[1]===1?this._itemContext.totalPage:u[0]*this._itemContext.totalPage+1,c}:d=>d.detail.current,a=d=>{const u=this._pagerComponent,c=u.getScrollRange(),{direction:f}=u.attribute,{width:g,height:p}=u.getSliderRenderBounds(),v=f==="vertical"?d.deltaY/p:d.deltaX/g;u.setScrollRange([c[0]+v,c[1]+v],!0),this.updateScrollMask()},h=d=>{const u=l(d);if(u!==this._itemContext.currentPage){if(this._itemContext.currentPage=u,this._itemContext&&this._itemContext.startIndex<this._itemContext.items.length){this._renderItems();const c=Math.ceil(this._itemContext.pages/this._itemContext.maxPages);if(this._itemContext.totalPage=c,this._itemContext.isScrollbar&&this._pagerComponent){const f=this._computeScrollbarDelta(),[g]=this._pagerComponent.getScrollRange();this._pagerComponent.setScrollRange([g,g+f])}}if(this._itemContext.isScrollbar){const[c]=this._pagerComponent.getScrollRange();let f;f=this._itemContext.isHorizontal?this._itemsContainer.AABBBounds.width():this._itemsContainer.AABBBounds.height();const g=f*c;this.updateScrollMask(),o?this._itemsContainer.animate().to({[e]:-g},r,s):this._itemsContainer.setAttribute(e,-g)}else o?this._itemsContainer.animate().to({[e]:-(u-1)*t},r,s):this._itemsContainer.setAttribute(e,-(u-1)*t)}};this._itemContext.isScrollbar?(this._pagerComponent.addEventListener("scrollDrag",h),this._pagerComponent.addEventListener("scrollUp",h),this.attribute.pager.roamScroll&&(this.addEventListener("wheel",u=>u.nativeEvent.preventDefault()),this.addEventListener("wheel",zb(a,50)))):(this._pagerComponent.addEventListener("toPrev",h),this._pagerComponent.addEventListener("toNext",h))}_renderPager(){const t=this._title?this._title.AABBBounds.height()+we(this.attribute,"title.space",8):0,{maxWidth:e,maxCol:n=1,maxRow:o=2,item:r={},pager:s={}}=this.attribute,{spaceCol:l=Jl,spaceRow:a=Ql}=r,h=this._itemsContainer,{space:d=Ic,defaultCurrent:u=1}=s,c=vv(s,["space","defaultCurrent"]),{isHorizontal:f}=this._itemContext,g=this._contentMaxHeight;let p,v=0,m=0,b=0,C=0,_=0,w=0,y=1;if(f){if(m=(o-1)*a+this._itemHeight*o,v=e,p=this._createPager(c),this._pagerComponent=p,this._innerView.add(p),b=e-p.AABBBounds.width()-d,b<=0)return this._innerView.removeChild(p),!1;h.getChildren().forEach((R,B)=>{const{width:A,height:M}=R.attribute;b<_+A&&(_=0,w+=M+a,y+=1),B>0&&R.setAttributes({x:_,y:w}),_+=l+A}),this._itemContext.startX=_,this._itemContext.startY=w,this._itemContext.pages=y;const S=Math.ceil(y/o);this._itemContext.totalPage=S,this._updatePositionOfPager(t,v,m)}else{if(v=this._itemMaxWidth*n+(n-1)*l,m=g,b=v,p=this._createPager(c),this._pagerComponent=p,this._innerView.add(p),C=g-p.AABBBounds.height()-d-t,C<=0)return this._innerView.removeChild(p),!1;h.getChildren().forEach((R,B)=>{const{height:A}=R.attribute;C<w+A&&(w=0,_+=this._itemMaxWidth+l,y+=1),B>0&&R.setAttributes({x:_,y:w}),w+=a+A});const S=Math.ceil(y/n);this._itemContext.totalPage=S,this._updatePositionOfPager(t,v,m)}u>1&&(f?h.setAttribute("y",-(u-1)*(m+a)):h.setAttribute("x",-(u-1)*(v+l)));const x=ft.group({x:0,y:t,width:f?b:v,height:f?m:C,clip:!0,pickable:!1});return x.add(h),this._innerView.add(x),this._itemContext.clipContainer=x,this._bindEventsOfPager(f?m+a:v+l,f?"y":"x"),!0}_renderScrollbar(){var t;const e=this._title?this._title.AABBBounds.height()+we(this.attribute,"title.space",8):0,{maxWidth:n,item:o={},pager:r={}}=this.attribute,{spaceCol:s=Jl,spaceRow:l=Ql}=o,a=this._itemsContainer,{space:h=Ic,defaultCurrent:d=1}=r,u=vv(r,["space","defaultCurrent"]),{isHorizontal:c}=this._itemContext,f=this._contentMaxHeight;let g,p=0,v=0,m=0,b=1;if(c)p=n,v=this._itemHeight,g=this._createScrollbar(u,p),this._pagerComponent=g,this._innerView.add(g);else{if(v=f-e,p=this._itemMaxWidth,g=this._createScrollbar(u,v),this._pagerComponent=g,this._innerView.add(g),v<=0)return this._innerView.removeChild(g),!1;const _=a.getChildren(),w=_.map(y=>y.attribute.height);if(w.length===1||w.every(y=>y===w[0])){const y=w[0],x=v,S=Math.floor(x/(l+y));v=S*(l+y),b=Math.ceil(_.length/S)}else _.forEach((y,x)=>{const{height:S}=y.attribute,R=b,B=m;b=Math.floor((m+S)/v)+1,m+=l+S,R!==b&&x===a.getChildren().length-1&&m-v>=1/3*S&&(v=B+S,b-=1)});this._itemContext.totalPage=b,this._itemContext.pages=b}if(d>1)if(c){const _=this._itemsContainer.AABBBounds.width()-p;a.setAttribute("x",-Math.min((d-1)*(p+s),_))}else{const _=this._itemsContainer.AABBBounds.height()-v;a.setAttribute("y",-Math.min((d-1)*(v+l),_))}const C=ft.group({x:0,y:e,width:p,height:v,clip:!0,pickable:!1});return C.add(a),this._innerView.add(C),this._itemContext.clipContainer=C,this._updatePositionOfScrollbar(p,v,e),!((t=r.scrollMask)===null||t===void 0)&&t.visible&&this.renderScrollMask(C),this._bindEventsOfPager(c?p:v,c?"x":"y"),!0}renderScrollMask(t){const{scrollMask:e={}}=this.attribute.pager,{visible:n=!0,gradientLength:o=16,gradientStops:r}=e;if(!n||!r)return;const s=t.AABBBounds.width(),l=t.AABBBounds.height(),a=this._itemContext.isHorizontal?s:l,h=r.map(c=>({offset:o*c.offset/a,color:c.color})),d=r.map(c=>({offset:(a-o*c.offset)/a,color:c.color})),u=ft.rect({x:0,y:0,width:s,height:l});this._scrollMask=u,this._scrollMaskContext={startStops:h,endStops:d},this.updateScrollMask(),t.add(u)}updateScrollMask(){if(!this._scrollMask||!this._pagerComponent||!this._itemContext.isScrollbar)return;const[t,e]=this._pagerComponent.getScrollRange(),n=[];Cn(Li(e,0,1),1)||n.push(...this._scrollMaskContext.endStops),Cn(Li(t,0,1),0)||n.push(...this._scrollMaskContext.startStops),n.length&&(this._itemContext.isHorizontal?this._scrollMask.setAttributes({fill:{gradient:"linear",x0:0,y0:0,x1:1,y1:0,stops:n}}):this._scrollMask.setAttributes({fill:{gradient:"linear",x0:0,y0:0,x1:0,y1:1,stops:n}}))}_renderPagerComponent(){return this._itemContext.isScrollbar?this._renderScrollbar():this._renderPager(),!0}_hover(t,e){this._lastActiveItem=t,t.hasState(pt.selected)?this._setLegendItemState(t,pt.selectedHover,e):this._setLegendItemState(t,pt.unSelectedHover,e);const n=t.getChildren()[0].find(o=>o.name===Me.focus,!1);n&&n.setAttribute("visible",!0),this._dispatchLegendEvent(wi.legendItemHover,t,e)}_unHover(t,e){let n=!1;(t.hasState(pt.unSelectedHover)||t.hasState(pt.selectedHover))&&(n=!0),t.removeState(pt.unSelectedHover),t.removeState(pt.selectedHover),t.getChildren()[0].getChildren().forEach(r=>{n||!r.hasState(pt.unSelectedHover)&&!r.hasState(pt.selectedHover)||(n=!0),r.removeState(pt.unSelectedHover),r.removeState(pt.selectedHover)});const o=t.getChildren()[0].find(r=>r.name===Me.focus,!1);o&&o.setAttribute("visible",!1),n&&this._dispatchLegendEvent(wi.legendItemAttributeUpdate,t,e),this._dispatchLegendEvent(wi.legendItemUnHover,t,e)}_setLegendItemState(t,e,n){let o=!1;t.hasState(e)||(o=!0),t.addState(e,!0),t.getChildren()[0].getChildren().forEach(r=>{r.name!==Me.focus&&(o||r.hasState(e)||(o=!0),r.addState(e,!0))}),o&&this._dispatchLegendEvent(wi.legendItemAttributeUpdate,t,n)}_removeLegendItemState(t,e,n){let o=!1;e.forEach(r=>{!o&&t.hasState(r)&&(o=!0),t.removeState(r)}),t.getChildren()[0].getChildren().forEach(r=>{r.name!==Me.focus&&e.forEach(s=>{!o&&r.hasState(s)&&(o=!0),r.removeState(s)})}),o&&this._dispatchLegendEvent(wi.legendItemAttributeUpdate,t,n)}_getSelectedLegends(){var t;const e=[];return(t=this._itemsContainer)===null||t===void 0||t.getChildren().forEach(n=>{n.hasState(pt.selected)&&e.push(n.data)}),e}_appendDataToShape(t,e,n,o,r={}){t.name=e,t.data=n,t.delegate=o,t.states=rt({},zP,r)}_dispatchLegendEvent(t,e,n){const o=this._getSelectedLegends();o.sort((s,l)=>s.index-l.index);const r=o.map(s=>s.label);this._dispatchEvent(t,{item:e,data:e.data,selected:e.hasState(pt.selected),currentSelectedItems:o,currentSelected:r,event:n})}_handleStyle(t,e,n,o,r){const s={};return t.style&&(Mt(t.style)?s.style=t.style(e,n,o,r):s.style=t.style),t.state&&(s.state={},Object.keys(t.state).forEach(l=>{t.state[l]&&(Mt(t.state[l])?s.state[l]=t.state[l](e,n,o,r):s.state[l]=t.state[l])})),s}release(){super.release(),this.removeAllEventListeners()}}fd.defaultAttributes={layout:"horizontal",title:{align:"start",space:al,textStyle:{fontSize:12,fontWeight:"bold",fill:"#2C3542"}},item:{spaceCol:Jl,spaceRow:Ql,shape:{space:b_,style:{size:lh,cursor:"pointer"},state:{selectedHover:{opacity:.85},unSelected:{opacity:.5}}},label:{space:C_,style:{fontSize:12,fill:"#2C3542",cursor:"pointer"},state:{selectedHover:{opacity:.85},unSelected:{fill:"#D8D8D8"}}},value:{alignRight:!1,style:{fontSize:12,fill:"#ccc",cursor:"pointer"},state:{selectedHover:{opacity:.85},unSelected:{fill:"#D8D8D8"}}},background:{style:{cursor:"pointer"}},focus:!1,focusIconStyle:{size:lh,symbolType:"M8 1C11.866 1 15 4.13401 15 8C15 11.866 11.866 15 8 15C4.13401 15 1 11.866 1 8C1 4.13401 4.13401 1 8 1ZM8.75044 2.55077L8.75 3.75H7.25L7.25006 2.5507C4.81247 2.88304 2.88304 4.81247 2.5507 7.25006L3.75 7.25V8.75L2.55077 8.75044C2.8833 11.1878 4.81264 13.117 7.25006 13.4493L7.25 12.25H8.75L8.75044 13.4492C11.1876 13.1167 13.1167 11.1876 13.4492 8.75044L12.25 8.75V7.25L13.4493 7.25006C13.117 4.81264 11.1878 2.8833 8.75044 2.55077ZM8 5.5C9.38071 5.5 10.5 6.61929 10.5 8C10.5 9.38071 9.38071 10.5 8 10.5C6.61929 10.5 5.5 9.38071 5.5 8C5.5 6.61929 6.61929 5.5 8 5.5ZM8 7C7.44772 7 7 7.44772 7 8C7 8.55228 7.44772 9 8 9C8.55228 9 9 8.55228 9 8C9 7.44772 8.55228 7 8 7Z",fill:"#333",cursor:"pointer"}},autoPage:!0,pager:{space:Ic,handler:{style:{size:10},space:4}},hover:!0,select:!0,selectMode:"multiple",allowAllCanceled:!0};var Be;(function(i){i.innerView="innerView",i.railContainer="sliderRailContainer",i.rail="sliderRail",i.startText="sliderStartText",i.endText="sliderEndText",i.startHandler="sliderStartHandler",i.startHandlerText="startHandlerText",i.endHandler="sliderEndHandler",i.endHandlerText="sliderEndHandlerText",i.track="sliderTrack",i.trackContainer="sliderTrackContainer"})(Be||(Be={}));function $d(i){return Q(i)?i:[i,i]}function Ll(i){return i?"ew-resize":"ns-resize"}$g();class hl extends gi{get track(){return this._track}get currentValue(){return this._currentValue}get startHandler(){return this._startHandler}get endHandler(){return this._endHandler}get tooltipShape(){return this._tooltipShape}constructor(t,e){super(e!=null&&e.skipDefault?t:rt({},hl.defaultAttributes,t)),this.name="slider",this._isHorizontal=!0,this._startHandler=null,this._endHandler=null,this._startHandlerText=null,this._endHandlerText=null,this._currentHandler=null,this._currentValue={},this._onTooltipShow=n=>{this._isChanging||this._tooltipState&&this._tooltipState.isActive||(this._tooltipState?this._tooltipState.isActive=!0:this._tooltipState={isActive:!0},this._onTooltipUpdate(n),this._dispatchTooltipEvent("sliderTooltipShow"))},this._onTooltipUpdate=n=>{if(this._isChanging||!this._tooltipState||!this._tooltipState.isActive)return;const o=this._isHorizontal?this._rail.globalAABBBounds.width():this._rail.globalAABBBounds.height(),r=Li(this._isHorizontal?(n.viewX-this._rail.globalAABBBounds.x1)/o:(n.viewY-this._rail.globalAABBBounds.y1)/o,0,1);r!==this._tooltipState.pos&&(this._tooltipState.pos=r,this._tooltipState.value=this.calculateValueByPos(r*o),this._updateTooltip(),this._dispatchTooltipEvent("sliderTooltipUpdate"))},this._onTooltipHide=()=>{const{tooltip:n}=this.attribute;n&&n.alwaysShow||(this._tooltipState=null,this._tooltipShape&&this._tooltipShape.setAttribute("visible",!1),this._tooltipText&&this._tooltipText.setAttribute("visible",!1),this._dispatchTooltipEvent("sliderTooltipHide"))},this._onHandlerPointerdown=n=>{n.stopPropagation(),this._isChanging=!0;const{x:o,y:r}=this.stage.eventPointTransform(n);this._currentHandler=n.target,this._prePos=this._isHorizontal?o:r,Qt.env==="browser"?(Qt.addEventListener("pointermove",this._onHandlerPointerMove,{capture:!0}),Qt.addEventListener("pointerup",this._onHandlerPointerUp)):(this.stage.addEventListener("pointermove",this._onHandlerPointerMove,{capture:!0}),this.stage.addEventListener("pointerup",this._onHandlerPointerUp),this.stage.addEventListener("pointerupoutside",this._onHandlerPointerUp))},this._onHandlerPointerMove=n=>{var o,r;n.stopPropagation(),this._isChanging=!0;const{railWidth:s,railHeight:l,min:a,max:h}=this.attribute;if(h===a)return;const{x:d,y:u}=this.stage.eventPointTransform(n);let c,f,g,p=0;this._isHorizontal?(c=d,p=c-this._prePos,f=(r=this._currentHandler)===null||r===void 0?void 0:r.attribute.x,g=s):(c=u,p=c-this._prePos,f=(o=this._currentHandler)===null||o===void 0?void 0:o.attribute.y,g=l);const v=Li(f+p,0,g),m=this.calculateValueByPos(v);this._currentHandler.type==="text"?this._updateHandlerText(this._currentHandler,v,m):this._updateHandler(this._currentHandler,v,m),this._updateTrack(),this._prePos=c,this._dispatchChangeEvent()},this._onHandlerPointerUp=n=>{n.preventDefault(),this._isChanging=!1,this._currentHandler=null,Qt.env==="browser"?(Qt.removeEventListener("pointermove",this._onHandlerPointerMove,{capture:!0}),Qt.removeEventListener("pointerup",this._onHandlerPointerUp)):(this.stage.removeEventListener("pointermove",this._onHandlerPointerMove,{capture:!0}),this.stage.removeEventListener("pointerup",this._onHandlerPointerUp),this.stage.removeEventListener("pointerupoutside",this._onHandlerPointerUp))},this._onTrackPointerdown=n=>{n.stopPropagation(),this._isChanging=!0;const{x:o,y:r}=this.stage.eventPointTransform(n);this._prePos=this._isHorizontal?o:r,Qt.env==="browser"?(Qt.addEventListener("pointermove",this._onTrackPointerMove,{capture:!0}),Qt.addEventListener("pointerup",this._onTrackPointerUp)):(this.stage.addEventListener("pointermove",this._onTrackPointerMove,{capture:!0}),this.stage.addEventListener("pointerup",this._onTrackPointerUp),this.stage.addEventListener("pointerupoutside",this._onTrackPointerUp))},this._onTrackPointerMove=n=>{n.stopPropagation(),this._isChanging=!0;const{railWidth:o,railHeight:r,min:s,max:l,inverse:a}=this.attribute;if(l===s)return;const{startHandler:h,endHandler:d}=this._getHandlers();let u,c,f;const{x:g,y:p}=this.stage.eventPointTransform(n);this._isHorizontal?(u=g,c=this._track.attribute.width,f=o):(u=p,c=this._track.attribute.height,f=r);const v=u-this._prePos;if(h){const m=this._isHorizontal?h.attribute.x:h.attribute.y,b=a?Li(m+v,c,f):Li(m+v,0,f-c),C=this.calculateValueByPos(b);this._updateHandler(h,b,C)}if(d){const m=this._isHorizontal?d.attribute.x:d.attribute.y,b=a?Li(m+v,0,f-c):Li(m+v,c,f),C=this.calculateValueByPos(b),_=h==null?void 0:h.attribute;this._updateHandler(d,b,C),this._track.setAttributes(this._isHorizontal?{x:Math.min(_.x,d.attribute.x),width:Math.abs(_.x-d.attribute.x)}:{y:Math.min(_.y,d.attribute.y),height:Math.abs(_.y-d.attribute.y)})}this._prePos=u,this._dispatchChangeEvent()},this._onTrackPointerUp=n=>{n.preventDefault(),this._isChanging=!1,Qt.env==="browser"?(Qt.removeEventListener("pointermove",this._onTrackPointerMove,{capture:!0}),Qt.removeEventListener("pointerup",this._onTrackPointerUp)):(this.stage.removeEventListener("pointermove",this._onTrackPointerMove,{capture:!0}),this.stage.removeEventListener("pointerup",this._onTrackPointerUp),this.stage.removeEventListener("pointerupoutside",this._onTrackPointerUp))},this._onRailPointerDown=n=>{n.stopPropagation(),this._isChanging=!0;const{railWidth:o,railHeight:r,min:s,max:l}=this.attribute;if(l===s)return;const a=this._startHandler,h=this._endHandler;let d,u,c;this._isHorizontal?(d=n.viewX-this._rail.globalAABBBounds.x1,u=a==null?void 0:a.attribute.x,c=h==null?void 0:h.attribute.x):(d=n.viewY-this._rail.globalAABBBounds.y1,u=a==null?void 0:a.attribute.y,c=h==null?void 0:h.attribute.y);const f=this.calculateValueByPos(d);if(O(c)){const g=Math.abs(d-u)>Math.abs(d-c)?h:a;this._updateHandler(g,d,f)}else this._updateHandler(a,d,f);this._updateTrack(),this._dispatchChangeEvent()}}calculatePosByValue(t,e){const{layout:n,railWidth:o,railHeight:r,min:s,max:l,inverse:a}=this.attribute;let h=0;return h=s===l?e==="start"?0:e==="end"?1:0:(t-s)/(l-s),(a?1-h:h)*(n==="vertical"?r:o)}calculateValueByPos(t){const{layout:e,railWidth:n,railHeight:o,min:r,max:s,inverse:l}=this.attribute,a=e==="vertical"?o:n;return r+(s-r)*(l?1-t/a:t/a)}setValue(t){const{min:e,max:n}=this.attribute;if(n===e)return;const[o,r]=xu(t),{startHandler:s,endHandler:l}=this._getHandlers();s&&this._updateHandler(s,this.calculatePosByValue(o),o),l&&this._updateHandler(l,this.calculatePosByValue(r),r),this._updateTrack()}render(){var t,e;this.removeAllChild(!0);const{layout:n="horizontal",railWidth:o,railHeight:r,startText:s,endText:l,min:a,max:h,showHandler:d=!0,showTooltip:u}=this.attribute;let{value:c}=this.attribute;Pt(c)&&(c=[a,h]),this._currentValue={startValue:$d(c)[0],endValue:$d(c)[1]};const f=n==="horizontal";this._isHorizontal=f;const g=ft.group({x:0,y:0});g.name=Be.innerView,this.add(g),this._innerView=g;let p,v=0;if(s&&s.visible){p=ft.text(Object.assign({x:f?0:o/2,y:f?r/2:0,textAlign:f?"start":"center",textBaseline:f?"middle":"top",text:s.text,lineHeight:(t=s.style)===null||t===void 0?void 0:t.fontSize},s.style)),p.name=Be.startText,g.add(p);const _=O(s.space)?s.space:0;v+=(f?p.AABBBounds.width():p.AABBBounds.height())+_}const m=ft.group({x:f?v:0,y:f?0:v});g.add(m);const b=ft.group({x:0,y:0});let C;if(b.name=Be.railContainer,this._railContainer=b,m.add(b),this._mainContainer=m,this._renderRail(b),v+=f?o:r,l&&l.visible){const _=O(l.space)?l.space:0;C=ft.text(Object.assign({x:f?v+_:o/2,y:f?r/2:v+_,textAlign:f?"start":"center",textBaseline:f?"middle":"top",text:l.text,lineHeight:(e=l.style)===null||e===void 0?void 0:e.fontSize},l.style)),C.name=Be.endText,g.add(C)}this._renderTrack(b),d&&(this._renderHandlers(m),this._bindEvents()),u&&(this._renderTooltip(),this._bindTooltipEvents())}_renderRail(t){const{railWidth:e,railHeight:n,railStyle:o,slidable:r}=this.attribute;let s="default";r!==!1&&(s="pointer");const l=ft.rect(Object.assign({x:0,y:0,width:e,height:n,cursor:s},o));return l.name=Be.rail,t.add(l),this._rail=l,l}_renderHandlers(t){const{range:e,min:n,max:o,handlerSize:r=14,handlerStyle:s,handlerText:l,railHeight:a,railWidth:h,slidable:d}=this.attribute;let{value:u}=this.attribute;Pt(u)&&(u=[n,o]);const c=l&&l.visible,f=this._isHorizontal,[g,p]=$d(u),v=this.calculatePosByValue(g,e?"start":"end"),m=this._renderHandler(Object.assign({x:f?v:h/2,y:f?a/2:v,size:r,strokeBoundsBuffer:0,cursor:d===!1?"default":Ll(f)},s));if(m.name=Be.startHandler,this._startHandler=m,t.add(m),this._currentValue.startPos=v,c){const b=this._renderHandlerText(g,e?"start":"end");b.name=Be.startHandlerText,t.add(b),this._startHandlerText=b}if(e){const b=this.calculatePosByValue(p,"end"),C=this._renderHandler(Object.assign({x:f?b:h/2,y:f?a/2:b,size:r,strokeBoundsBuffer:0,cursor:d===!1?"default":Ll(f)},s));if(C.name=Be.endHandler,this._endHandler=C,t.add(C),this._currentValue.endPos=b,c){const _=this._renderHandlerText(p,"end");_.name=Be.endHandlerText,t.add(_),this._endHandlerText=_}}}_renderTrack(t){const{range:e,min:n,max:o,railHeight:r,railWidth:s,trackStyle:l,railStyle:a,slidable:h,value:d}=this.attribute;let u,c;if(Pt(d))e?(u=n,c=o):u=c=n;else if(e){const _=lo(d,n,o);u=_[0],c=_[1]}else u=n,c=Li(d,n,o);const f=this._isHorizontal;e||(u=n);const g=ft.group({x:0,y:0,width:s,height:r,cornerRadius:a==null?void 0:a.cornerRadius,clip:!0,pickable:!1});g.name=Be.trackContainer;const p=kt(e)&&e.draggableTrack===!0;let v;v=h===!1?"default":e===!1||p===!1?"pointer":Ll(f);const m=this.calculatePosByValue(u,"start"),b=this.calculatePosByValue(c,e?"end":"start"),C=ft.rect(Object.assign({x:f?Math.min(m,b):0,y:f?0:Math.min(m,b),width:f?Math.abs(b-m):s,height:f?r:Math.abs(b-m),cursor:v},l));C.name=Be.track,this._track=C,g.add(C),t.add(g)}_renderHandler(t){return ft.symbol(t)}_renderHandlerText(t,e){var n,o,r;const{align:s,handlerSize:l=14,handlerText:a={},railHeight:h,railWidth:d,slidable:u}=this.attribute,c=this._isHorizontal,f=this.calculatePosByValue(t,e),g=(n=a.space)!==null&&n!==void 0?n:4,p={text:a.formatter?a.formatter(t):t.toFixed((o=a.precision)!==null&&o!==void 0?o:0),lineHeight:(r=a.style)===null||r===void 0?void 0:r.lineHeight,cursor:u===!1?"default":Ll(c)};return c?s==="top"?(p.textBaseline="bottom",p.textAlign="center",p.x=f,p.y=(h-l)/2-g):(p.textBaseline="top",p.textAlign="center",p.x=f,p.y=(h+l)/2+g):s==="left"?(p.textBaseline="middle",p.textAlign="end",p.x=(d-l)/2-g,p.y=f):(p.textBaseline="middle",p.textAlign="start",p.x=(d+l)/2+g,p.y=f),ft.text(Object.assign(Object.assign({},p),a.style))}_renderTooltip(){var t;const{tooltip:e,railHeight:n,railWidth:o,align:r}=this.attribute;e&&e.alwaysShow?this._tooltipState={value:this._currentValue.startValue,pos:this._currentValue.startPos}:this._tooltipState=null;const s=this._isHorizontal?0:o/2,l=this._isHorizontal?n/2:0;if(e&&e.shape){const c=ft.symbol(Object.assign({pickable:!1,visible:!!this._tooltipState,x:s,y:l,symbolType:"circle"},e.shapeStyle));this._tooltipShape=c,this._mainContainer.add(c)}const a=e&&e.text||{},h=(t=a.space)!==null&&t!==void 0?t:6,d={pickable:!1,visible:!!this._tooltipState,text:""};this._isHorizontal?(d.x=s,d.y=r==="top"?l-n/2-h:l+n/2+h,d.textAlign="center",d.textBaseline=r==="top"?"bottom":"top"):(d.y=l,d.x=r==="left"?s-o/2-h:l+o/2+h,d.textAlign=r==="left"?"end":"start",d.textBaseline="middle");const u=ft.text(Object.assign(Object.assign({},d),a.style));this._mainContainer.add(u),this._tooltipText=u,this._tooltipState&&this._updateTooltip()}_updateTooltip(){var t,e;if(!this._tooltipShape&&!this._tooltipText||!this._tooltipState)return;const{railWidth:n,railHeight:o}=this.attribute,r=this._isHorizontal?n:o,s=this._tooltipState.pos*r,l=this._isHorizontal?"x":"y";this._tooltipShape&&this._tooltipShape.setAttributes({visible:!0,[l]:s});const{align:a}=this.attribute;if(this._tooltipText){const h=this.attribute.tooltip&&this.attribute.tooltip.text||{};this._tooltipText.setAttributes({visible:!0,[l]:s,text:h.formatter?h.formatter(this._tooltipState.value):this._isHorizontal||a!=="left"?`≈ ${this._tooltipState.value.toFixed((e=h.precision)!==null&&e!==void 0?e:0)}`:`${this._tooltipState.value.toFixed((t=h.precision)!==null&&t!==void 0?t:0)} ≈`})}}_bindEvents(){if(this.attribute.disableTriggerEvent)return;const{slidable:t,range:e}=this.attribute;t&&(this._startHandler&&this._startHandler.addEventListener("pointerdown",this._onHandlerPointerdown),this._startHandlerText&&this._startHandlerText.addEventListener("pointerdown",this._onHandlerPointerdown),this._endHandler&&this._endHandler.addEventListener("pointerdown",this._onHandlerPointerdown),this._endHandlerText&&this._endHandlerText.addEventListener("pointerdown",this._onHandlerPointerdown),kt(e)&&e.draggableTrack&&this._track.addEventListener("pointerdown",this._onTrackPointerdown),this._railContainer.addEventListener("pointerdown",this._onRailPointerDown))}_bindTooltipEvents(){this.attribute.disableTriggerEvent||(this._mainContainer.addEventListener("pointerenter",this._onTooltipShow),this._mainContainer.addEventListener("pointermove",this._onTooltipUpdate),this._mainContainer.addEventListener("pointerleave",this._onTooltipHide))}_updateTrack(){const{inverse:t,railWidth:e,railHeight:n}=this.attribute,o=this._startHandler,r=this._endHandler;if(this._isHorizontal){const s=o==null?void 0:o.attribute.x;if(r){const l=r==null?void 0:r.attribute.x;this._track.setAttributes({x:Math.min(s,l),width:Math.abs(s-l)})}else t?this._track.setAttributes({x:s,width:e-s}):this._track.setAttributes({width:s})}else{const s=o==null?void 0:o.attribute.y;if(r){const l=r==null?void 0:r.attribute.y;this._track.setAttributes({y:Math.min(s,l),height:Math.abs(s-l)})}else t?this._track.setAttributes({y:s,height:n-s}):this._track.setAttributes({height:s})}}_updateHandler(t,e,n){var o;const r=this._isHorizontal;t.setAttribute(r?"x":"y",e);const s=t.name===Be.startHandler?this._startHandlerText:this._endHandlerText;if(s){const{handlerText:l={}}=this.attribute;s.setAttributes({text:l.formatter?l.formatter(n):n.toFixed((o=l.precision)!==null&&o!==void 0?o:0),[r?"x":"y"]:e})}t.name===Be.startHandler?(this._currentValue.startValue=n,this._currentValue.startPos=e):(this._currentValue.endValue=n,this._currentValue.endPos=e)}_updateHandlerText(t,e,n){var o;const r=this._isHorizontal,{handlerText:s={}}=this.attribute;t.setAttributes({[r?"x":"y"]:e,text:s.formatter?s.formatter(n):n.toFixed((o=s.precision)!==null&&o!==void 0?o:0)});const l=t.name===Be.startHandlerText?this._startHandler:this._endHandler;l&&l.setAttributes({[r?"x":"y"]:e}),t.name===Be.startHandlerText?(this._currentValue.startValue=n,this._currentValue.startPos=e):(this._currentValue.endValue=n,this._currentValue.endPos=e)}_dispatchChangeEvent(){const t=!!this.attribute.range,e=this._currentValue;this._dispatchEvent("change",{value:t?[Math.min(e.endValue,e.startValue),Math.max(e.endValue,e.startValue)]:e.startValue,position:t?[Math.min(e.endPos,e.startPos),Math.max(e.endPos,e.startPos)]:e.startPos})}_dispatchTooltipEvent(t){this._dispatchEvent("sliderTooltip",{type:t,position:this._tooltipState&&this._tooltipState.pos,value:this._tooltipState&&this._tooltipState.value})}_getHandlers(){const{inverse:t}=this.attribute;let e=this._startHandler,n=this._endHandler;return n?(this._isHorizontal?(!t&&n.attribute.x<(e==null?void 0:e.attribute.x)||t&&n.attribute.x>(e==null?void 0:e.attribute.x))&&([e,n]=[n,e]):(!t&&n.attribute.y<(e==null?void 0:e.attribute.y)||t&&n.attribute.y>(e==null?void 0:e.attribute.y))&&([e,n]=[n,e]),{startHandler:e,endHandler:n}):{startHandler:e,endHandler:n}}}hl.defaultAttributes={slidable:!0,layout:"horizontal",align:"bottom",height:8,showHandler:!0,handlerSize:14,handlerStyle:{symbolType:"circle",fill:"#fff",stroke:"#91caff",lineWidth:2},tooltip:{shapeStyle:{symbolType:"circle",fill:"#fff",stroke:"#91caff",lineWidth:2},text:{style:{fill:"#2C3542",fontSize:12}}},railStyle:{fill:"rgba(0,0,0,.04)"},trackStyle:{fill:"#91caff"},showValue:!0,valueStyle:{fill:"#2C3542",fontSize:12},startText:{style:{fill:"#2C3542",fontSize:12}},endText:{style:{fill:"#2C3542",fontSize:12}},handlerText:{visible:!0,space:4,precision:0,style:{fill:"#2C3542",fontSize:12}}};LP();class pd extends Ug{constructor(t,e){super(e!=null&&e.skipDefault?t:rt({},pd.defaultAttributes,t)),this.name="colorLegend",this._onSliderToolipChange=n=>{const o=this._slider.tooltipShape;if(o&&n.detail&&!Pt(n.detail.value)){const r=this._colorScale.scale(n.detail.value);o.setAttribute("fill",r)}this.dispatchEvent(n)},this._onSliderChange=n=>{this._updateColor(),this.dispatchEvent(n)}}setSelected(t){this._slider&&(this._slider.setValue(t),this._updateColor())}_renderContent(){const{colors:t,slidable:e,layout:n,align:o,min:r,max:s,value:l,railWidth:a,railHeight:h,showHandler:d=!0,handlerSize:u,handlerStyle:c,railStyle:f,trackStyle:g,startText:p,endText:v,handlerText:m,showTooltip:b,tooltip:C,inverse:_,disableTriggerEvent:w}=this.attribute,y=[],x=(s-r)/(t.length-1);for(let R=0;R<t.length;R++)y.push(r+x*R);this._colorScale=new Py().domain(y,!0).range(t),this._color=this._getTrackColor();const S=new hl({x:0,y:0,range:{draggableTrack:!0},slidable:e,layout:n,align:o,min:r,max:s,value:l,railWidth:a,railHeight:h,showHandler:d,handlerSize:u,handlerStyle:c,railStyle:f,trackStyle:Object.assign({fill:this._color},g),startText:p,endText:v,handlerText:m,showTooltip:b,tooltip:C,disableTriggerEvent:w,inverse:_});this._innerView.add(S),this._slider=S,S.translateTo(0-S.AABBBounds.x1,(this._title?this._title.AABBBounds.height()+we(this.attribute,"title.space",al):0)-S.AABBBounds.y1),this._updateColor()}_bindEvents(){this.attribute.disableTriggerEvent||this._slider&&(this._slider.addEventListener("change",this._onSliderChange),this._slider.addEventListener("sliderTooltip",this._onSliderToolipChange))}_getTrackColor(){const{colors:t,layout:e,inverse:n}=this.attribute;if(wt(t))return;const o=t.length;if(o===1)return t[0];const r=[];for(let a=0;a<o;a++){const h=a/(o-1);r.push({offset:h,color:t[a]})}const s=e==="horizontal",l={gradient:"linear",stops:r,x0:0,y0:0,x1:s?1:0,y1:s?0:1};return n&&(s?(l.x0=1,l.x1=0):(l.y0=1,l.y1=0)),l}_updateColor(){var t;const{layout:e="horizontal",colors:n,railWidth:o,railHeight:r}=this.attribute,{startHandler:s,endHandler:l,track:a,attribute:h}=this._slider,{startValue:d,endValue:u,startPos:c,endPos:f}=this._slider.currentValue,g=(t=h.handlerStyle)===null||t===void 0?void 0:t.fill;if(s&&!g){const v=this._colorScale.scale(d);s.setAttribute("fill",v)}if(l&&!g){const v=this._colorScale.scale(u);l.setAttribute("fill",v)}const p=e==="horizontal"?o:r;if(Math.abs(c-f)!==p&&n&&n.length>1){const v=this._color.stops,m=Math.min(c,f),b=Math.max(c,f),C=m/p,_=b/p,w=_-C,y=v.filter(M=>M.offset>C&&M.offset<_),x=Math.min(d,u),S=Math.max(d,u),R=this._colorScale.scale(x),B=this._colorScale.scale(S),A=[{offset:0,color:R}];y.forEach(M=>{A.push({offset:(M.offset-C)/w,color:M.color})}),A.push({offset:1,color:B}),a.setAttribute("fill",Object.assign(Object.assign({},this._color),{stops:A}))}}}pd.defaultAttributes={layout:"horizontal",title:{align:"start",space:al,textStyle:{fontSize:12,fontWeight:"bold",fill:"rgba(46, 47, 50, 1)"}},handlerSize:10,handlerStyle:{fill:null,lineWidth:4,stroke:"#fff",outerBorder:{distance:2,lineWidth:1,stroke:"#ccc"}},tooltip:{shapeStyle:{lineWidth:4,stroke:"#fff"}}};function IP(i="bottom"){let t=0;return i==="top"?`
    M${t},-6L${t-3.5},-2.5
    v5
    h7
    v-5
    Z
`:i==="left"?(t=1,`
    M${t-6},0L${t-6+2.5},-3.5
    h5
    v7
    h-5
    Z
`):i==="right"?(t=-1,`
    M${t+6},0L${t+6-2.5},-3.5
    h-5
    v7
    h5
    Z
  `):`
    M${t},6L${t-3.5},2.5
    v-5
    h7
    v5
    Z
`}FP();class vd extends Ug{constructor(t,e){super(e!=null&&e.skipDefault?t:rt({},vd.defaultAttributes,t)),this.name="sizeLegend",this._onSliderChange=n=>{this.dispatchEvent(n)},this._onSliderToolipChange=n=>{this.dispatchEvent(n)}}setSelected(t){this._slider&&this._slider.setValue(t)}_renderContent(){const{slidable:t,layout:e,align:n,min:o,max:r,value:s,railWidth:l,railHeight:a,showHandler:h=!0,handlerSize:d,handlerStyle:u,railStyle:c,trackStyle:f,startText:g,endText:p,handlerText:v,showTooltip:m,tooltip:b,sizeBackground:C,disableTriggerEvent:_,inverse:w}=this.attribute,y=ft.group({x:0,y:0});this._innerView.add(y);const x=new hl({x:0,y:0,zIndex:1,range:{draggableTrack:!0},slidable:t,layout:e,align:n,min:o,max:r,value:s,railWidth:l,railHeight:a,showHandler:h,handlerSize:d,handlerStyle:Object.assign({symbolType:IP(n)},u),railStyle:c,trackStyle:f,startText:g,endText:p,handlerText:v,showTooltip:m,tooltip:b,disableTriggerEvent:_,inverse:w});y.add(x);let S,R=0;e==="horizontal"?n==="top"?(S=`M0,0L${l},0L${w?0:l},12Z`,R=a):(S=`M0,12L${l},12L${w?0:l},0Z`,x.setAttribute("y",12)):n==="left"?S=`M${l},0L${l+12},${w?0:a}L${l},${a}Z`:(S=`M0,${w?0:a}L12,${a}L12,0Z`,x.setAttribute("x",12));const B=ft.path(Object.assign(Object.assign({x:0,y:R,path:S},C),{zIndex:0}));y.add(B);const A=this._title?this._title.AABBBounds.height()+we(this.attribute,"title.space",al):0;y.translate(0-y.AABBBounds.x1,A-y.AABBBounds.y1),this._slider=x}_bindEvents(){this.attribute.disableTriggerEvent||this._slider&&(this._slider.addEventListener("change",this._onSliderChange),this._slider.addEventListener("sliderTooltip",this._onSliderToolipChange))}}vd.defaultAttributes={layout:"horizontal",title:{align:"start",space:al,textStyle:{fontSize:12,fontWeight:"bold",fill:"rgba(46, 47, 50, 1)"}},handlerSize:10,handlerStyle:{lineWidth:1,stroke:"#ccc",fill:"#fff"},sizeBackground:{fill:"rgba(20,20,20,0.1)"}};function OP(){ii(),on(),dd()}OP();let __=class w_ extends gi{constructor(t,e){super(e!=null&&e.skipDefault?t:rt({},w_.defaultAttributes,t)),this.name="title"}render(){var t,e,n,o,r,s,l,a,h,d,u,c,f,g,p,v,m,b,C;const{textType:_,text:w,subtextType:y,textStyle:x={},subtext:S,subtextStyle:R={},width:B,height:A,minWidth:M,maxWidth:k,minHeight:E,maxHeight:T,align:P,verticalAlign:H,padding:L=0}=this.attribute,F=Qi(L),z=this.createOrUpdateChild("title-container",{x:F[3],y:F[0],zIndex:1},"group"),I=(t=x.height)!==null&&t!==void 0?t:A;if(this.attribute.visible!==!1&&x.visible!==!1){const{width:K,maxHeight:J,maxWidth:ot,x:lt=0,y:ct=0,ellipsis:it=!0,wordBreak:nt="break-word",maxWidth:ht,lineClamp:$}=x;if(_==="rich"||O(x.character)){const Y=Object.assign({x:lt,y:ct,width:(e=K??B)!==null&&e!==void 0?e:0,height:I??0,ellipsis:it==null||it,wordBreak:nt??"break-word",maxHeight:J??T,maxWidth:ot??ht,textConfig:(n=x.character)!==null&&n!==void 0?n:w},x);this._mainTitle=z.createOrUpdateChild("mainTitle",Y,"richtext")}else if(_==="html"){const Y=Object.assign({html:Object.assign(Object.assign({dom:w},Q0),x),x:lt,y:ct,width:(o=K??B)!==null&&o!==void 0?o:0,height:I??0,ellipsis:it,wordBreak:nt,maxHeight:J??T,maxWidth:ot??ht,textConfig:[]},x);this._mainTitle=z.createOrUpdateChild("mainTitle",Y,"richtext")}else O(w)&&(this._mainTitle=z.createOrUpdateChild("mainTitle",Object.assign(Object.assign({text:Q(w)?w:[w],whiteSpace:"normal"},x),{maxLineWidth:(s=(r=x.maxLineWidth)!==null&&r!==void 0?r:K)!==null&&s!==void 0?s:B,heightLimit:(l=x.height)!==null&&l!==void 0?l:T,lineClamp:$,ellipsis:it,x:lt,y:ct}),"text"))}const N=this._mainTitle?this._mainTitle.AABBBounds.height():0,W=this._mainTitle?this._mainTitle.AABBBounds.width():0;if(this.attribute.visible!==!1&&R.visible!==!1){const{width:K,height:J,maxWidth:ot,maxHeight:lt,x:ct=0,y:it=0,ellipsis:nt=!0,wordBreak:ht="break-word",lineClamp:$}=R,Y=Math.max(Number.MIN_VALUE,T-N);if(y==="rich"||O(R.character)){const _t=Object.assign({x:ct,y:it,width:(a=K??B)!==null&&a!==void 0?a:0,height:(h=J??A)!==null&&h!==void 0?h:0,ellipsis:nt,wordBreak:ht,maxHeight:lt??Y,maxWidth:ot??k,textConfig:(d=R.character)!==null&&d!==void 0?d:S},R);this._subTitle=z.createOrUpdateChild("subTitle",_t,"richtext")}else if(y==="html"){const _t=Object.assign({html:Object.assign(Object.assign({dom:S},Q0),R),x:ct,y:it,width:(u=K??B)!==null&&u!==void 0?u:0,height:(c=J??A)!==null&&c!==void 0?c:0,ellipsis:nt,wordBreak:ht,maxHeight:lt??Y,maxWidth:ot??k,textConfig:[]},R);this._subTitle=z.createOrUpdateChild("subTitle",_t,"richtext")}else O(S)&&(this._subTitle=z.createOrUpdateChild("subTitle",Object.assign(Object.assign({text:Q(S)?S:[S],whiteSpace:"normal"},R),{maxLineWidth:(f=R.maxLineWidth)!==null&&f!==void 0?f:B,heightLimit:(g=R.heightLimit)!==null&&g!==void 0?g:Y,lineClamp:$,ellipsis:nt,x:0,y:N}),"text"))}const D=this._subTitle?this._subTitle.AABBBounds.height():0,j=this._subTitle?this._subTitle.AABBBounds.width():0;let V=Math.max(W,j),X=N+((p=R.height)!==null&&p!==void 0?p:D);if(O(B)&&(V=B),O(A)&&(X=A),O(M)&&V<M&&(V=M),O(k)&&V>k&&(V=k),O(E)&&X<E&&(X=E),O(T)&&X>T&&(X=T),z.attribute.width=V,z.attribute.height=X,z.attribute.boundsPadding=F,this._mainTitle){if(O(P)||O(x.align)){const K=x.align?x.align:P,J=(v=x.width)!==null&&v!==void 0?v:V;K==="center"?(this._mainTitle.setAttribute("x",J/2),this._mainTitle.setAttribute("textAlign","center")):K==="right"?(this._mainTitle.setAttribute("x",J),this._mainTitle.setAttribute("textAlign","right")):(this._mainTitle.setAttribute("x",0),this._mainTitle.setAttribute("textAlign","left"))}if(O(H)||O(x.verticalAlign)){const K=x.verticalAlign?x.verticalAlign:H;K==="middle"&&O(I)?(this._mainTitle.setAttribute("y",I/2),this._mainTitle.setAttribute("textBaseline","middle")):K==="bottom"&&O(I)?(this._mainTitle.setAttribute("y",I),this._mainTitle.setAttribute("textBaseline","bottom")):(this._mainTitle.setAttribute("y",0),this._mainTitle.setAttribute("textBaseline","top"))}}if(this._subTitle){if(O(P)||O(R.align)){const K=R.align?R.align:P,J=(b=(m=R.width)!==null&&m!==void 0?m:x.width)!==null&&b!==void 0?b:V;K==="center"?(this._subTitle.setAttribute("x",J/2),this._subTitle.setAttribute("textAlign","center")):K==="right"?(this._subTitle.setAttribute("x",J),this._subTitle.setAttribute("textAlign","right")):(this._subTitle.setAttribute("x",0),this._subTitle.setAttribute("textAlign","left"))}if(O(H)||O(x.verticalAlign)){const K=R.verticalAlign?R.verticalAlign:H,J=this._mainTitle?O(I)?this._mainTitle.AABBBounds.y1+Math.max(this._mainTitle.AABBBounds.height(),I):this._mainTitle.AABBBounds.y2:0,ot=(C=R.height)!==null&&C!==void 0?C:A;K==="middle"&&O(ot)?(this._subTitle.setAttribute("y",J+ot/2),this._subTitle.setAttribute("textBaseline","middle")):K==="bottom"&&O(ot)?(this._subTitle.setAttribute("y",J+ot),this._subTitle.setAttribute("textBaseline","bottom")):(this._subTitle.setAttribute("y",J),this._subTitle.setAttribute("textBaseline","top"))}}}};__.defaultAttributes={textStyle:{ellipsis:"...",fill:"#333",fontSize:20,fontWeight:"bold",textAlign:"left",textBaseline:"top"},subtextStyle:{ellipsis:"...",fill:"#6F6F6F",fontSize:16,fontWeight:"normal",textAlign:"left",textBaseline:"top"}};function DP(){ii(),Tn(),on(),hd()}const WP='<svg width="200" height="200" viewBox="0 0 1024 1024" fill="#fff" xmlns="http://www.w3.org/2000/svg"><path d="M877.44815445 206.10060629a64.72691371 64.72691371 0 0 0-95.14856334 4.01306852L380.73381888 685.46812814 235.22771741 533.48933518a64.72691371 64.72691371 0 0 0-92.43003222-1.03563036l-45.82665557 45.82665443a64.72691371 64.72691371 0 0 0-0.90617629 90.61767965l239.61903446 250.10479331a64.72691371 64.72691371 0 0 0 71.19960405 15.14609778 64.33855261 64.33855261 0 0 0 35.08198741-21.23042702l36.24707186-42.71976334 40.5190474-40.77795556-3.36579926-3.49525333 411.40426297-486.74638962a64.72691371 64.72691371 0 0 0-3.88361443-87.64024149l-45.3088404-45.43829334z"></path></svg>',NP='<svg width="200" height="200" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="none"><path stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width="5" d="M5 12h14"/></svg>';DP();class Pr extends gi{constructor(t,e){super(e!=null&&e.skipDefault?t:rt({},Pr.defaultAttributes,t)),this._handlePointerUp=()=>{this.attribute.disabled||(this.attribute.checked?(this.setAttribute("checked",!1),this.setAttribute("indeterminate",!1)):(this.setAttribute("checked",!0),this.setAttribute("indeterminate",!1)),this._dispatchEvent("checkbox_state_change",{eventType:"checkbox_state_change",checked:this.attribute.checked}),this.stage.renderNextFrame())},this.renderGroup(),this.onBeforeAttributeUpdate=(n,o,r)=>{"interactive"in n&&this.setAttribute("pickable",n.interactive),"disabled"in n&&this.setAttribute("cursor",n.disable?this.attribute.disableCursor:this.attribute.cursor)},this.addEventListener("pointerup",this._handlePointerUp)}render(){this.removeAllChild(!0),this.renderBox(),this.renderIcon(),this.renderText(),this.layout()}renderBox(){this._box=new ld(rt({},this.attribute.box));const t=this.attribute.checked||this.attribute.indeterminate;t&&this.attribute.disabled?this._box.setAttributes({fill:this.attribute.box.disableCheckedFill,stroke:this.attribute.box.disableCheckedStroke}):t?this._box.setAttributes({fill:this.attribute.box.checkedFill,stroke:this.attribute.box.checkedStroke}):this.attribute.disabled&&this._box.setAttributes({fill:this.attribute.box.disableFill}),this.appendChild(this._box)}renderIcon(){this._checkIcon=new ko(rt({image:this.attribute.icon.checkIconImage},this.attribute.icon)),this.appendChild(this._checkIcon),this._indeterminateIcon=new ko(rt({image:this.attribute.icon.indeterminateIconImage},this.attribute.icon)),this.appendChild(this._indeterminateIcon),this.attribute.checked?(this._checkIcon.setAttribute("visible",!0),this._indeterminateIcon.setAttribute("visible",!1)):this.attribute.indeterminate?(this._checkIcon.setAttribute("visible",!1),this._indeterminateIcon.setAttribute("visible",!0)):(this._checkIcon.setAttribute("visible",!1),this._indeterminateIcon.setAttribute("visible",!1))}renderText(){this._text=new xe(rt({wrap:!0},this.attribute.text)),this.attribute.disabled&&this._text.setAttribute("fill",this.attribute.text.disableFill),this.appendChild(this._text)}renderGroup(){this.attribute.interactive||this.setAttribute("pickable",!1),this.attribute.disabled&&this.setAttribute("cursor",this.attribute.disableCursor)}layout(){const t=this.attribute.box.height,e=this.attribute.icon.height,n=this._text.AABBBounds.height(),o=Math.max(t,e,n),r=o/2-t/2,s=o/2-e/2,l=o/2-n/2,a=this.attribute.box.width,h=this.attribute.icon.width,d=Math.max(a,h),u=d/2-a/2,c=d/2-h/2,f=d+this.attribute.spaceBetweenTextAndIcon;this._box.setAttributes({x:u,y:r}),this._checkIcon.setAttributes({x:c,y:s}),this._indeterminateIcon.setAttributes({x:c,y:s}),this._text.setAttributes({x:f,y:l})}initAttributes(t,e){t=e!=null&&e.skipDefault?t:rt({},Pr.defaultAttributes,t),super.initAttributes(t),this.renderGroup(),this.render()}}Pr.defaultAttributes={interactive:!0,disabled:!1,checked:!1,indeterminate:!1,cursor:"pointer",disableCursor:"not-allowed",spaceBetweenTextAndIcon:8,text:{text:"text",fontSize:14,fill:"#000",disableFill:"rgb(201,205,212)",textBaseline:"top",pickable:!1},icon:{checkIconImage:WP,indeterminateIconImage:NP,width:10,height:10,pickable:!1},box:{width:14,height:14,cornerRadius:2,fill:"#fff",stroke:"rgb(229,230,235)",disableFill:"rgb(242,243,245)",checkedFill:"rgb(22, 93, 255)",checkedStroke:"rgb(22, 93, 255)",disableCheckedFill:"rgb(148, 191, 255)",disableCheckedStroke:"rgb(148, 191, 255)",pickable:!1}};function VP(){ii(),Tn(),LT(),hd()}VP();class Hr extends gi{constructor(t,e){super(e!=null&&e.skipDefault?t:rt({},Hr.defaultAttributes,t)),this._handlePointerUp=()=>{this.attribute.disabled||this.attribute.checked||(this.setAttribute("checked",!0),this._dispatchEvent("radio_checked",{eventType:"radio_checked",target:this}),this.stage.renderNextFrame())},this.renderGroup(),this.onBeforeAttributeUpdate=(n,o,r)=>{"interactive"in n&&this.setAttribute("pickable",n.interactive),"disabled"in n&&this.setAttribute("cursor",n.disable?this.attribute.disableCursor:this.attribute.cursor)},this.addEventListener("pointerup",this._handlePointerUp)}render(){this.removeAllChild(!0),this.renderCircle(),this.renderText(),this.layout()}renderCircle(){this._circle=new Br(rt({},this.attribute.circle));const t=this.attribute.checked;t&&this.attribute.disabled?this._circle.setAttributes({fill:this.attribute.circle.disableCheckedFill,stroke:this.attribute.circle.disableCheckedStroke}):t?this._circle.setAttributes({fill:this.attribute.circle.checkedFill,stroke:this.attribute.circle.checkedStroke}):this.attribute.disabled&&this._circle.setAttributes({fill:this.attribute.circle.disableFill}),this.appendChild(this._circle)}renderText(){this._text=new xe(rt({},this.attribute.text)),this.attribute.disabled&&this._text.setAttribute("fill",this.attribute.text.disableFill),this.appendChild(this._text)}renderGroup(){this.attribute.interactive||this.setAttribute("pickable",!1),this.attribute.disabled&&this.setAttribute("cursor",this.attribute.disableCursor)}layout(){const t=2*(this.attribute.circle.outerRadius+this.attribute.circle.lineWidth),e=this._text.AABBBounds.height(),n=Math.max(t,e),o=n/2-t/2+this.attribute.circle.outerRadius+this.attribute.circle.lineWidth,r=n/2-e/2,s=2*(this.attribute.circle.outerRadius+this.attribute.circle.lineWidth),l=this.attribute.circle.outerRadius+this.attribute.circle.lineWidth,a=s+this.attribute.spaceBetweenTextAndIcon;this._circle.setAttributes({x:l,y:o}),this._text.setAttributes({x:a,y:r})}initAttributes(t,e){t=e!=null&&e.skipDefault?t:rt({},Hr.defaultAttributes,t),super.initAttributes(t),this.renderGroup(),this.render()}}Hr.defaultAttributes={interactive:!0,disabled:!1,checked:!1,cursor:"pointer",disableCursor:"not-allowed",spaceBetweenTextAndIcon:8,text:{text:"text",fontSize:14,fill:"#000",disableFill:"rgb(201,205,212)",textBaseline:"top",pickable:!1},circle:{outerRadius:7,innerRadius:3,startAngle:0,endAngle:2*Math.PI,lineWidth:1,fill:"#fff",stroke:"rgb(229,230,235)",disableFill:"rgb(242,243,245)",checkedFill:"rgb(22, 93, 255)",checkedStroke:"rgb(22, 93, 255)",disableCheckedFill:"rgb(148, 191, 255)",disableCheckedStroke:"rgb(148, 191, 255)",pickable:!1}};function GP(){ii(),on(),hd()}const jP='<svg t="1716726614852" class="icon" viewBox="0 0 1194 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2621" width="200" height="200"><path d="M1038.694079 367.237067c13.265507 23.342857-16.633865-40.004445-63.05621-40.004446H219.018794c-26.558738 0-46.46393 13.334815-63.05621 40.004446S0.006238 607.277601 0.006238 650.608819V940.647979a82.351494 82.351494 0 0 0 82.961402 83.349526H1111.702885a82.337632 82.337632 0 0 0 82.975264-83.349526V650.608819c0-43.331218-155.970208-283.371753-155.970208-283.371752zM730.066575 667.284269a136.328386 136.328386 0 0 1-132.738243 133.33429 133.417459 133.417459 0 0 1-132.738243-133.33429v-6.681269a40.6698 40.6698 0 0 0-36.497473-26.66963H73.015044l119.458874-220.02445s23.231965-40.004445 53.103614-40.004446h713.481918c26.544876 0 29.871649 10.008042 46.436207 40.004446L1128.33675 633.947231H769.904682c-26.184476 0-39.838107 7.623855-39.838107 33.337038zM338.505391 210.559919l-89.601086-86.69016a22.178487 22.178487 0 0 1 0-33.26773 21.984425 21.984425 0 0 1 33.170699 0l89.601087 86.676299a22.317102 22.317102 0 0 1 0 33.26773 24.950798 24.950798 0 0 1-33.1707 0z m252.197118-40.059891a25.532983 25.532983 0 0 1-6.639685-16.633865l-3.326773-126.694606A28.263709 28.263709 0 0 1 603.995739 0.515788c13.251646-3.326773 23.204242 10.021904 26.544877 23.342858V153.866163a28.249847 28.249847 0 0 1-23.259688 26.66963c-6.611961-3.312911-13.279369-3.312911-16.578419-10.035765z m235.646421 33.337038a22.372548 22.372548 0 0 1 0-33.337038l86.288175-90.030795a22.039871 22.039871 0 0 1 33.170699 0 22.289379 22.289379 0 0 1 0 33.364761l-82.961401 90.003072a25.962691 25.962691 0 0 1-36.483611 0z" fill="#8a8a8a" p-id="2622"></path></svg>';GP();let y_=class S_ extends gi{constructor(t,e){super(e!=null&&e.skipDefault?t:rt({},S_.defaultAttributes,t))}render(){this.removeAllChild(!0),this.renderIcon(),this.renderText(),this.layout()}renderIcon(){this._emptyTipIcon=new ko(rt({image:this.attribute.icon.image},this.attribute.icon)),this.appendChild(this._emptyTipIcon)}renderText(){this._text=new xe(rt({wrap:!0},this.attribute.text)),this.appendChild(this._text)}layout(){const t=this.attribute.icon.height,e=this._text.AABBBounds.height(),n=this.attribute.icon.width,{width:o,height:r,spaceBetweenTextAndIcon:s}=this.attribute;this._emptyTipIcon.setAttribute("x",o/2-n/2),this._emptyTipIcon.setAttribute("y",r/2-t/2-e/2-s/2),this._text.setAttribute("x",o/2),this._text.setAttribute("textAlign","center"),this._text.setAttribute("y",r/2+t/2+s/2),this._text.setAttribute("textBaseline","middle")}};y_.defaultAttributes={spaceBetweenTextAndIcon:20,text:{text:"no data",fontSize:14,fill:"#000",disableFill:"rgb(201,205,212)",pickable:!1},icon:{image:jP,width:100,height:100,pickable:!1}};function UP(){ii(),Tn(),on(),JC()}UP();class Us extends gi{constructor(t,e){super(e!=null&&e.skipDefault?t:rt({},Us.defaultAttributes,t)),this._handlePointerUp=()=>{this.attribute.disabled||(this.attribute.checked?this.setAttribute("checked",!1):this.setAttribute("checked",!0),this._dispatchEvent("switch_state_change",{eventType:"switch_state_change",checked:this.attribute.checked}),this.stage.renderNextFrame())},this.renderGroup(),this.onBeforeAttributeUpdate=(n,o,r)=>{"interactive"in n&&this.setAttribute("pickable",n.interactive),"disabled"in n&&this.setAttribute("cursor",n.disable?this.attribute.disableCursor:this.attribute.cursor)},this.addEventListener("pointerup",this._handlePointerUp)}render(){this.removeAllChild(!0),this.renderBox(),this.renderCircle(),this.renderText(),this.layout()}renderBox(){this._box=new ld(rt({},this.attribute.box)),this.attribute.disabled&&this.attribute.checked?this._box.setAttributes({fill:this.attribute.box.disableCheckedFill}):this.attribute.disabled&&!this.attribute.checked?this._box.setAttributes({fill:this.attribute.box.disableUncheckedFill}):this.attribute.checked?this._box.setAttributes({fill:this.attribute.box.checkedFill}):this._box.setAttributes({fill:this.attribute.box.uncheckedFill}),this.appendChild(this._box)}renderCircle(){this._circle=new Ar(rt({},this.attribute.circle)),this.appendChild(this._circle)}renderText(){var t,e,n;this._text=new xe(rt({},(t=this.attribute.text)!==null&&t!==void 0?t:{})),this.attribute.checked&&(!((e=this.attribute.text)===null||e===void 0)&&e.checkedText)?this._text.setAttributes({text:this.attribute.text.checkedText}):!((n=this.attribute.text)===null||n===void 0)&&n.uncheckedText&&this._text.setAttributes({text:this.attribute.text.uncheckedText}),this.appendChild(this._text)}renderGroup(){this.attribute.interactive||this.setAttribute("pickable",!1),this.attribute.disabled&&this.setAttribute("cursor",this.attribute.disableCursor)}layout(){var t,e,n,o,r,s,l,a,h,d;const u=this.attribute.spaceBetweenTextAndCircle,c=this.attribute.circle.radius,f=this.attribute.box.height,g=2*c,p=this._text.AABBBounds.height(),v=Math.max(f,g,p),m=v/2-g/2+c,b=v/2-p/2,C=this.attribute.box.width,_=2*c,w=ud(((n=(e=(t=this.attribute.text)===null||t===void 0?void 0:t.checkedText)===null||e===void 0?void 0:e.length)!==null&&n!==void 0?n:0)>((s=(r=(o=this.attribute.text)===null||o===void 0?void 0:o.uncheckedText)===null||r===void 0?void 0:r.length)!==null&&s!==void 0?s:0)?(a=(l=this.attribute.text)===null||l===void 0?void 0:l.checkedText)!==null&&a!==void 0?a:"":(d=(h=this.attribute.text)===null||h===void 0?void 0:h.uncheckedText)!==null&&d!==void 0?d:"",this._text.attribute).width,y=Math.max(C,_+w+3*u),x=f/2-_/2+c,S=x+c+u;this._box.setAttributes({width:y,height:v}),this._circle.setAttributes({y:m,x:this.attribute.checked?x:y-x}),this._text.setAttributes({x:this.attribute.checked?S:y-S-w,y:b})}initAttributes(t,e){t=e!=null&&e.skipDefault?t:rt({},Us.defaultAttributes,t),super.initAttributes(t),this.renderGroup(),this.render()}}Us.defaultAttributes={interactive:!0,disabled:!1,checked:!1,cursor:"pointer",disableCursor:"not-allowed",circle:{radius:8,fill:"#FFF",pickable:!1},box:{width:40,height:24,cornerRadius:12,uncheckedFill:"rgb(201,205,212)",checkedFill:"#165DFF",disableUncheckedFill:"rgb(242,243,245)",disableCheckedFill:"rgb(148,191,255)",pickable:!1},text:{textAlign:"left",textBaseline:"top",pickable:!1},spaceBetweenTextAndCircle:6};let mv=!1;function x_(){mv||(mv=!0,Ns(),Ng()?ja(bt):eB()&&Ka(bt),PT(),JC(),ii(),hd(),Gg(),Tn(),dd(),ET(),Or(),on(),d0(),XT(),d0())}var vt;(function(i){i.default="default",i.grabing="grabing",i.scrolling="scrolling"})(vt||(vt={}));var Ht;(function(i){i.single="single",i.column="column",i.row="row",i.cross="cross",i.none="none"})(Ht||(Ht={}));const $P=["bgColor","color","strokeColor","borderColor","linkColor"];var Zt;(function(i){i.RECORD="RECORD",i.NONE="NONE",i.SUM="SUM",i.MIN="MIN",i.MAX="MAX",i.AVG="AVG",i.COUNT="COUNT",i.CUSTOM="CUSTOM",i.RECALCULATE="RECALCULATE"})(Zt||(Zt={}));var Je;(function(i){i.ASC="ASC",i.DESC="DESC",i.NORMAL="NORMAL",i.desc="desc",i.asc="asc",i.normal="normal"})(Je||(Je={}));var ri;(function(i){i.top="top",i.bottom="bottom",i.left="left",i.right="right"})(ri||(ri={}));var mt;(function(i){i.expand="expand",i.collapse="collapse",i.none="none",i.loading="loading"})(mt||(mt={}));var It;(function(i){i.inlineFront="inlineFront",i.inlineEnd="inlineEnd",i.left="left",i.right="right",i.absoluteRight="absoluteRight",i.contentLeft="contentLeft",i.contentRight="contentRight",i.absolute="absolute"})(It||(It={}));var Ot;(function(i){i.frozen="frozen",i.sort="sort",i.dropDown="dropDown",i.dropDownState="dropDownState",i.play="play",i.damagePic="damagePic",i.expand="expand",i.collapse="collapse",i.drillDown="drillDown",i.drillUp="drillUp",i.dragReorder="dragReorder"})(Ot||(Ot={}));var Ve;(function(i){i.upwardIconName="sort_upward",i.downwardIconName="sort_downward",i.normalIconName="sort_normal",i.freezeIconName="freeze",i.frozenIconName="frozen",i.frozenCurrentIconName="frozenCurrent",i.dropdownIconName="dropdownIcon",i.expandIconName="expand",i.collapseIconName="collapse",i.dragReorderIconName="dragReorder",i.loadingIconName="loading"})(Ve||(Ve={}));const gO={};class Pn{constructor(t){var e;this.isAggregator=!0,this.isRecord=!0,this.records=[],this.key=t.key,this.field=t.field,this.formatFun=t.formatFun,this.isRecord=(e=t.isRecord)!==null&&e!==void 0?e:this.isRecord}clearCacheValue(){this._formatedValue=void 0}formatValue(t,e,n){return this._formatedValue||(this.formatFun?this._formatedValue=this.formatFun(this.value(),t,e,n):this._formatedValue=this.value()),this._formatedValue}reset(){this.records=[],this.clearCacheValue()}}class KP extends Pn{constructor(){super(...arguments),this.type=Zt.RECORD,this.isRecord=!0}push(t){t&&this.isRecord&&this.records&&(t.isAggregator?this.records.push(...t.records):this.records.push(t)),this.clearCacheValue()}deleteRecord(t){t&&this.isRecord&&this.records&&(this.records=this.records.filter(e=>e!==t)),this.clearCacheValue()}updateRecord(t,e){t&&e&&(this.isRecord&&this.records&&(this.records=this.records.map(n=>n===t?e:n)),this.clearCacheValue())}value(){return this.records}reset(){this.records=[]}recalculate(){}}class YP extends Pn{constructor(){super(...arguments),this.type=Zt.NONE,this.isRecord=!0}push(t){t&&(this.isRecord&&(this.records=[t]),this.field&&(this.fieldValue=t[this.field])),this.clearCacheValue()}deleteRecord(t){t&&(this.isRecord&&this.records&&(this.records=this.records.filter(e=>e!==t)),this.field&&this.records.length&&(this.fieldValue=this.records[this.records.length-1][this.field])),this.clearCacheValue()}updateRecord(t,e){t&&e&&(this.isRecord&&this.records&&(this.records=this.records.map(n=>n===t?e:n)),this.field&&this.records.length&&(this.fieldValue=this.records[this.records.length-1][this.field]),this.clearCacheValue())}value(){return this.fieldValue}reset(){this.records=[],this.fieldValue=void 0}recalculate(){}}class XP extends Pn{constructor(t){super(t),this.type=Zt.CUSTOM,this.isRecord=!0,this.values=[],this.aggregationFun=t.aggregationFun}push(t){t&&(this.isRecord&&this.records&&(t.isAggregator?this.records.push(...t.records):this.records.push(t)),this.field&&this.values.push(t[this.field])),this.clearCacheValue()}updateRecord(t,e){t&&e&&(this.isRecord&&this.records&&(this.records=this.records.map(n=>n===t?e:n)),this.field&&this.records.length&&(this.values=this.records.map(n=>n[this.field])),this.clearCacheValue())}deleteRecord(t){t&&(this.isRecord&&this.records&&(this.records=this.records.filter(e=>e!==t)),this.field&&this.records.length&&(this.values=this.records.map(e=>e[this.field]))),this.clearCacheValue()}value(){var t;return this.fieldValue||(this.fieldValue=(t=this.aggregationFun)===null||t===void 0?void 0:t.call(this,this.values,this.records,this.field)),this.fieldValue}reset(){this.records=[],this.fieldValue=void 0}recalculate(){this.fieldValue=void 0,this._formatedValue=void 0}}class fO extends Pn{constructor(t){super(t),this.type=Zt.RECALCULATE,this.isRecord=!0,this.calculateFun=t.calculateFun,this.dependAggregators=t.dependAggregators,this.dependIndicatorKeys=t.dependIndicatorKeys}push(t){t&&this.isRecord&&this.records&&(t.isAggregator?this.records.push(...t.records):this.records.push(t)),this.clearCacheValue()}deleteRecord(t){t&&this.isRecord&&this.records&&(this.records=this.records.filter(e=>e!==t)),this.clearCacheValue()}updateRecord(t,e){t&&e&&(this.isRecord&&this.records&&(this.records=this.records.map(n=>n===t?e:n)),this.clearCacheValue())}value(){var t;if(!this.fieldValue){const e=i2(this.dependAggregators,this.dependIndicatorKeys);this.fieldValue=(t=this.calculateFun)===null||t===void 0?void 0:t.call(this,e,this.records,this.field)}return this.fieldValue}reset(){this.records=[],this.fieldValue=void 0}recalculate(){}}class qP extends Pn{constructor(t){var e;super(t),this.type=Zt.SUM,this.sum=0,this.positiveSum=0,this.nagetiveSum=0,this.needSplitPositiveAndNegativeForSum=!1,this.needSplitPositiveAndNegativeForSum=(e=t.needSplitPositiveAndNegative)!==null&&e!==void 0&&e}push(t){if(t){if(this.isRecord&&this.records&&(t.isAggregator?this.records.push(...t.records):this.records.push(t)),t.isAggregator){const e=t.value();this.sum+=e??0,this.needSplitPositiveAndNegativeForSum&&(e>0?this.positiveSum+=e:e<0&&(this.nagetiveSum+=e))}else if(this.field&&!isNaN(parseFloat(t[this.field]))){const e=parseFloat(t[this.field]);this.sum+=e,this.needSplitPositiveAndNegativeForSum&&(e>0?this.positiveSum+=e:e<0&&(this.nagetiveSum+=e))}}this.clearCacheValue()}deleteRecord(t){if(t){if(this.isRecord&&this.records&&(this.records=this.records.filter(e=>e!==t)),t.isAggregator){const e=t.value();this.sum-=e??0,this.needSplitPositiveAndNegativeForSum&&(e>0?this.positiveSum-=e:e<0&&(this.nagetiveSum-=e))}else if(this.field&&!isNaN(parseFloat(t[this.field]))){const e=parseFloat(t[this.field]);this.sum-=e,this.needSplitPositiveAndNegativeForSum&&(e>0?this.positiveSum-=e:e<0&&(this.nagetiveSum-=e))}}this.clearCacheValue()}updateRecord(t,e){if(t&&e){if(this.isRecord&&this.records&&(this.records=this.records.map(n=>n===t?e:n)),t.isAggregator){const n=t.value(),o=e.value();this.sum+=o-n,this.needSplitPositiveAndNegativeForSum&&(n>0?this.positiveSum-=n:n<0&&(this.nagetiveSum-=n),o>0?this.positiveSum+=o:o<0&&(this.nagetiveSum+=o))}else if(this.field&&!isNaN(parseFloat(t[this.field]))){const n=parseFloat(t[this.field]),o=parseFloat(e[this.field]);this.sum+=o-n,this.needSplitPositiveAndNegativeForSum&&(n>0?this.positiveSum-=n:n<0&&(this.nagetiveSum-=n),o>0?this.positiveSum+=o:o<0&&(this.nagetiveSum+=o))}this.clearCacheValue()}}value(){var t;return((t=this.records)===null||t===void 0?void 0:t.length)>=1?this.sum:void 0}positiveValue(){return this.positiveSum}negativeValue(){return this.nagetiveSum}reset(){super.reset(),this.records=[],this.sum=0}recalculate(){if(this.sum=0,this._formatedValue=void 0,this.records)for(let t=0;t<this.records.length;t++){const e=this.records[t];if(e.isAggregator){const n=e.value();this.sum+=n??0,this.needSplitPositiveAndNegativeForSum&&(n>0?this.positiveSum+=n:n<0&&(this.nagetiveSum+=n))}else if(this.field&&!isNaN(parseFloat(e[this.field]))){const n=parseFloat(e[this.field]);this.sum+=n,this.needSplitPositiveAndNegativeForSum&&(n>0?this.positiveSum+=n:n<0&&(this.nagetiveSum+=n))}}}}class ZP extends Pn{constructor(){super(...arguments),this.type=Zt.COUNT,this.count=0}push(t){t&&(this.isRecord&&this.records&&(t.isAggregator?this.records.push(...t.records):this.records.push(t)),t.isAggregator?this.count+=t.value():this.count++),this.clearCacheValue()}deleteRecord(t){t&&(this.isRecord&&this.records&&(this.records=this.records.filter(e=>e!==t)),t.isAggregator?this.count-=t.value():this.count--),this.clearCacheValue()}updateRecord(t,e){t&&e&&(this.isRecord&&this.records&&(this.records=this.records.map(n=>n===t?e:n)),t.isAggregator&&(this.count+=e.value()-t.value()))}value(){return this.count}reset(){this.records=[],this.count=0}recalculate(){if(this.count=0,this._formatedValue=void 0,this.records)for(let t=0;t<this.records.length;t++){const e=this.records[t];e.isAggregator?this.count+=e.value():this.count++}}}class JP extends Pn{constructor(){super(...arguments),this.type=Zt.AVG,this.sum=0,this.count=0}push(t){t&&(this.isRecord&&this.records&&(t.isAggregator?this.records.push(...t.records):this.records.push(t)),t.isAggregator&&t.type===Zt.AVG?(this.sum+=t.sum,this.count+=t.count):this.field&&!isNaN(parseFloat(t[this.field]))&&(this.sum+=parseFloat(t[this.field]),this.count++)),this.clearCacheValue()}deleteRecord(t){t&&(this.isRecord&&this.records&&(this.records=this.records.filter(e=>e!==t)),t.isAggregator&&t.type===Zt.AVG?(this.sum-=t.sum,this.count-=t.count):this.field&&!isNaN(parseFloat(t[this.field]))&&(this.sum-=parseFloat(t[this.field]),this.count--)),this.clearCacheValue()}updateRecord(t,e){t&&e&&(this.isRecord&&this.records&&(this.records=this.records.map(n=>n===t?e:n)),t.isAggregator&&t.type===Zt.AVG?(this.sum+=e.sum-t.sum,this.count+=e.count-t.count):this.field&&!isNaN(parseFloat(t[this.field]))&&(this.sum+=parseFloat(e[this.field])-parseFloat(t[this.field])),this.clearCacheValue())}value(){var t;return((t=this.records)===null||t===void 0?void 0:t.length)>=1?this.sum/this.count:void 0}reset(){this.records=[],this.sum=0,this.count=0}recalculate(){if(this.sum=0,this.count=0,this._formatedValue=void 0,this.records)for(let t=0;t<this.records.length;t++){const e=this.records[t];e.isAggregator&&e.type===Zt.AVG?(this.sum+=e.sum,this.count+=e.count):this.field&&!isNaN(parseFloat(e[this.field]))&&(this.sum+=parseFloat(e[this.field]),this.count++)}}}class QP extends Pn{constructor(){super(...arguments),this.type=Zt.MAX,this.max=Number.MIN_SAFE_INTEGER}push(t){t&&(this.isRecord&&this.records&&(t.isAggregator?this.records.push(...t.records):this.records.push(t)),t.isAggregator?this.max=t.max>this.max?t.max:this.max:typeof t=="number"?this.max=t>this.max?t:this.max:this.field&&typeof t[this.field]=="number"?this.max=t[this.field]>this.max?t[this.field]:this.max:this.field&&!isNaN(t[this.field])&&(this.max=parseFloat(t[this.field])>this.max?parseFloat(t[this.field]):this.max)),this.clearCacheValue()}deleteRecord(t){t&&(this.isRecord&&this.records&&(this.records=this.records.filter(e=>e!==t)),this.recalculate())}updateRecord(t,e){t&&e&&(this.isRecord&&this.records&&(this.records=this.records.map(n=>n===t?e:n)),this.recalculate())}value(){var t;return((t=this.records)===null||t===void 0?void 0:t.length)>=1?this.max:void 0}reset(){this.records=[],this.max=Number.MIN_SAFE_INTEGER}recalculate(){if(this.max=Number.MIN_SAFE_INTEGER,this._formatedValue=void 0,this.records)for(let t=0;t<this.records.length;t++){const e=this.records[t];e.isAggregator?this.max=e.max>this.max?e.max:this.max:typeof e=="number"?this.max=e>this.max?e:this.max:this.field&&typeof e[this.field]=="number"?this.max=e[this.field]>this.max?e[this.field]:this.max:this.field&&!isNaN(e[this.field])&&(this.max=parseFloat(e[this.field])>this.max?parseFloat(e[this.field]):this.max)}}}class t2 extends Pn{constructor(){super(...arguments),this.type=Zt.MIN,this.min=Number.MAX_SAFE_INTEGER}push(t){t&&(this.isRecord&&this.records&&(t.isAggregator?this.records.push(...t.records):this.records.push(t)),t.isAggregator?this.min=t.min<this.min?t.min:this.min:typeof t=="number"?this.min=t<this.min?t:this.min:this.field&&typeof t[this.field]=="number"?this.min=t[this.field]<this.min?t[this.field]:this.min:this.field&&!isNaN(t[this.field])&&(this.min=parseFloat(t[this.field])<this.min?parseFloat(t[this.field]):this.min)),this.clearCacheValue()}deleteRecord(t){t&&(this.isRecord&&this.records&&(this.records=this.records.filter(e=>e!==t)),this.recalculate())}updateRecord(t,e){t&&e&&(this.isRecord&&this.records&&(this.records=this.records.map(n=>n===t?e:n)),this.recalculate())}value(){var t;return((t=this.records)===null||t===void 0?void 0:t.length)>=1?this.min:void 0}reset(){this.records=[],this.min=Number.MAX_SAFE_INTEGER}recalculate(){if(this.min=Number.MAX_SAFE_INTEGER,this._formatedValue=void 0,this.records)for(let t=0;t<this.records.length;t++){const e=this.records[t];e.isAggregator?this.min=e.min<this.min?e.min:this.min:typeof e=="number"?this.min=e<this.min?e:this.min:this.field&&typeof e[this.field]=="number"?this.min=e[this.field]<this.min?e[this.field]:this.min:this.field&&!isNaN(e[this.field])&&(this.min=parseFloat(e[this.field])<this.min?parseFloat(e[this.field]):this.min)}}}function pO(i,t,e){if(e===Je.NORMAL||e===Je.normal)return 0;const n=e===Je.DESC||e===Je.desc?-1:1;return i&&t?i.toString().localeCompare(t.toString(),"zh")*n:i?1*n:-1*n}function e2(i,t,e){if(e===Je.NORMAL||e===Je.normal)return 0;const n=/(\d+)|(\D+)/g,o=/\d/,r=/^0/;let s,l,a,h,d=0,u=0;const c=e===Je.DESC||e===Je.desc?-1:1;if(t!==null&&i===null)return-1*c;if(i!==null&&t===null)return 1*c;if(typeof i=="number"&&isNaN(i))return-1*c;if(typeof t=="number"&&isNaN(t))return 1*c;if(d=+i,u=+t,d<u)return-1*c;if(d>u)return 1*c;if(typeof i=="number"&&typeof t!="number")return-1*c;if(typeof t=="number"&&typeof i!="number")return 1*c;if(typeof i=="number"&&typeof t=="number")return 0;if(isNaN(u)&&!isNaN(d))return-1*c;if(isNaN(d)&&!isNaN(u))return 1*c;if(s=String(i),a=String(t),s===a)return 0;if(!o.test(s)||!o.test(a))return(s>a?1:-1)*c;for(s=s.match(n),a=a.match(n);s.length&&a.length;)if(l=s.shift(),h=a.shift(),l!==h)return o.test(l)&&o.test(h)?(l.replace(r,".0")-h.replace(r,".0"))*c:(l>h?1:-1)*c;return(s.length-a.length)*c}function vO(i){let t;const e={},n={};for(let o=0;o<i.length;o++)t=i[o],e[t]=o,typeof t=="string"&&(n[t.toLowerCase()]=o);return function(o,r,s){if(s===Je.NORMAL||s===Je.normal)return 0;const l=s===Je.DESC||s===Je.desc?-1:1;let a;return e[o]!==null&&e[o]!==void 0&&e[r]!==null&&e[r]!==void 0?a=e[o]-e[r]:e[o]!==null&&e[o]!==void 0?a=-1:e[r]!==null&&e[r]!==void 0?a=1:n[o]!==null&&e[o]!==void 0&&n[r]!==null&&e[r]!==void 0?a=n[o]-n[r]:n[o]===null||e[o]===void 0||n[r]===null||e[r]===void 0?a=0:n[o]!==null&&e[o]!==void 0?a=-1:n[r]!==null&&e[r]!==void 0&&(a=1),O(a)?a*l:e2(o,r,s)}}function i2(i,t){const e={};for(let n=0;n<(t==null?void 0:t.length);n++){const o=i.find(r=>(r==null?void 0:r.key)===t[n]);o&&(e[o.key]=o==null?void 0:o.value())}return e}let n2=1,md=class{constructor(){this.listenersData={listeners:{},listenerData:{}}}on(t,e){const n=this.listenersData.listeners[t]||(this.listenersData.listeners[t]=[]);n.push(e);const o=n2++;return this.listenersData.listenerData[o]={type:t,listener:e,remove:()=>{delete this.listenersData.listenerData[o];const r=n.indexOf(e);n.splice(r,1),this.listenersData.listeners[t].length||delete this.listenersData.listeners[t]}},o}off(t,e){var n;if(e){const o=t;this.removeEventListener(o,e)}else{const o=t;if(!this.listenersData)return;(n=this.listenersData.listenerData[o])===null||n===void 0||n.remove()}}addEventListener(t,e,n){this.on(t,e)}removeEventListener(t,e){if(this.listenersData)for(const n in this.listenersData.listenerData){const o=this.listenersData.listenerData[n];o.type===t&&o.listener===e&&this.off(n)}}hasListeners(t){return!!this.listenersData&&!!this.listenersData.listeners[t]}fireListeners(t,e){if(!this.listenersData)return[];const n=this.listenersData.listeners[t];return n?n.map(o=>o.call(this,e)).filter(o=>O(o)):[]}release(){delete this.listenersData}},bv;const o2={CHANGE_STYLE:"change_style"};let Wi=class Oc extends md{static get EVENT_TYPE(){return o2}static get DEFAULT(){return bv||(bv=new Oc)}constructor(t={},e={}){var n,o,r,s,l,a,h,d,u,c,f,g,p,v,m,b,C,_,w,y,x,S,R,B,A,M,k,E,T,P,H;super(),this._defaultPadding=[10,16,10,16],this._textAlign=(n=t==null?void 0:t.textAlign)!==null&&n!==void 0?n:e==null?void 0:e.textAlign,this._textBaseline=(o=t==null?void 0:t.textBaseline)!==null&&o!==void 0?o:e==null?void 0:e.textBaseline,this._color=(r=t==null?void 0:t.color)!==null&&r!==void 0?r:e==null?void 0:e.color,this._strokeColor=(s=t==null?void 0:t.strokeColor)!==null&&s!==void 0?s:e==null?void 0:e.strokeColor,this._fontSize=(l=t.fontSize)!==null&&l!==void 0?l:e==null?void 0:e.fontSize,this._fontFamily=(a=t.fontFamily)!==null&&a!==void 0?a:e==null?void 0:e.fontFamily,this._fontWeight=(h=t.fontWeight)!==null&&h!==void 0?h:e==null?void 0:e.fontWeight,this._fontVariant=(d=t.fontVariant)!==null&&d!==void 0?d:e==null?void 0:e.fontVariant,this._fontStyle=(u=t.fontStyle)!==null&&u!==void 0?u:e==null?void 0:e.fontStyle,this._padding=(f=(c=t==null?void 0:t.padding)!==null&&c!==void 0?c:e==null?void 0:e.padding)!==null&&f!==void 0?f:this._defaultPadding,this._borderColor=(g=t==null?void 0:t.borderColor)!==null&&g!==void 0?g:e==null?void 0:e.borderColor,this._textOverflow=(p=t==null?void 0:t.textOverflow)!==null&&p!==void 0?p:e==null?void 0:e.textOverflow,this._textStick=(m=(v=t.textStick)!==null&&v!==void 0?v:e==null?void 0:e.textStick)!==null&&m!==void 0&&m,this._textStickBaseOnAlign=(C=(b=t.textStickBaseOnAlign)!==null&&b!==void 0?b:e==null?void 0:e.textStickBaseOnAlign)!==null&&C!==void 0&&C,this._bgColor=(_=t==null?void 0:t.bgColor)!==null&&_!==void 0?_:e==null?void 0:e.bgColor,this._lineHeight=(w=t==null?void 0:t.lineHeight)!==null&&w!==void 0?w:e==null?void 0:e.lineHeight,this._underline=(y=t==null?void 0:t.underline)!==null&&y!==void 0?y:e==null?void 0:e.underline,this._underlineColor=(x=t==null?void 0:t.underlineColor)!==null&&x!==void 0?x:e==null?void 0:e.underlineColor,this._underlineDash=(S=t==null?void 0:t.underlineDash)!==null&&S!==void 0?S:e==null?void 0:e.underlineDash,this._underlineOffset=(R=t==null?void 0:t.underlineOffset)!==null&&R!==void 0?R:e==null?void 0:e.underlineOffset,this._lineThrough=(B=t==null?void 0:t.lineThrough)!==null&&B!==void 0?B:e==null?void 0:e.lineThrough,this._lineThroughColor=(A=t==null?void 0:t.lineThroughColor)!==null&&A!==void 0?A:e==null?void 0:e.lineThroughColor,this._lineThroughDash=(M=t==null?void 0:t.lineThroughDash)!==null&&M!==void 0?M:e==null?void 0:e.lineThroughDash,this._linkColor=(k=t==null?void 0:t.linkColor)!==null&&k!==void 0?k:e==null?void 0:e.linkColor,this._cursor=(E=t.cursor)!==null&&E!==void 0?E:e==null?void 0:e.cursor,this._borderLineWidth=(T=t.borderLineWidth)!==null&&T!==void 0?T:e==null?void 0:e.borderLineWidth,this._borderLineDash=(P=t.borderLineDash)!==null&&P!==void 0?P:e==null?void 0:e.borderLineDash,this._marked=(H=t.marked)!==null&&H!==void 0?H:e==null?void 0:e.marked}get color(){return this._color}set color(t){this._color=t}get strokeColor(){return this._strokeColor}set strokeColor(t){this._strokeColor=t}get fontSize(){return this._fontSize}set fontSize(t){this._fontSize=t}get fontFamily(){return this._fontFamily}set fontFamily(t){this._fontFamily=t}get fontWeight(){return this._fontWeight}set fontWeight(t){this._fontWeight=t}get fontVariant(){return this._fontVariant}set fontVariant(t){this._fontVariant=t}get fontStyle(){return this._fontStyle}set fontStyle(t){this._fontStyle=t}get padding(){return this._padding}set padding(t){this._padding=t}get textOverflow(){return this._textOverflow}set textOverflow(t){this._textOverflow=t}get bgColor(){return this._bgColor}set bgColor(t){this._bgColor=t}get borderColor(){return this._borderColor}set borderColor(t){this._borderColor=t}get textStick(){return this._textStick}set textStick(t){this._textStick=t}get textStickBaseOnAlign(){return this._textStickBaseOnAlign}set textStickBaseOnAlign(t){this._textStickBaseOnAlign=t}get textAlign(){return this._textAlign}set textAlign(t){this._textAlign=t}get textBaseline(){return this._textBaseline}set textBaseline(t){this._textBaseline=t}get lineHeight(){return this._lineHeight}set lineHeight(t){this._lineHeight=t}get underline(){return this._underline}set underline(t){this._underline=t}get underlineColor(){return this._underlineColor}set underlineColor(t){this._underlineColor=t}get underlineDash(){return this._underlineDash}set underlineDash(t){this._underlineDash=t}get underlineOffset(){return this._underlineOffset}set underlineOffset(t){this._underlineOffset=t}get lineThrough(){return this._lineThrough}set lineThrough(t){this._lineThrough=t}get lineThroughColor(){return this._lineThroughColor}set lineThroughColor(t){this._lineThroughColor=t}get lineThroughDash(){return this._lineThroughDash}set lineThroughDash(t){this._lineThroughDash=t}get linkColor(){return this._linkColor}set linkColor(t){this._linkColor=t}get cursor(){return this._cursor}set cursor(t){this._cursor=t}get borderLineWidth(){return this._borderLineWidth}set borderLineWidth(t){this._borderLineWidth=t}get borderLineDash(){return this._borderLineDash}set borderLineDash(t){this._borderLineDash=t}get marked(){return this._marked}set marked(t){this._marked=t}clone(){return new Oc(this,null)}},Cv,r2=class Dc extends Wi{static get DEFAULT(){return Cv||(Cv=new Dc)}constructor(t={},e={}){super(t,e)}clone(){return new Dc(this,null)}},_v;class $s extends Wi{static get DEFAULT(){return _v||(_v=new $s)}constructor(t={},e={}){var n,o;super(t,e),this._autoWrapText=(n=t==null?void 0:t.autoWrapText)!==null&&n!==void 0?n:e==null?void 0:e.autoWrapText,this._lineClamp=(o=t==null?void 0:t.lineClamp)!==null&&o!==void 0?o:e==null?void 0:e.lineClamp}clone(){return new $s(this,null)}get lineClamp(){return this._lineClamp}set lineClamp(t){this._lineClamp=t}get autoWrapText(){return this._autoWrapText}set autoWrapText(t){this._autoWrapText=t}}let wv,Wc=class ta extends Wi{static get DEFAULT(){return wv||(wv=new ta)}constructor(t={},e={},n={}){var o,r,s,l,a,h,d,u,c,f,g,p,v,m,b,C,_,w,y,x,S,R;super(t,e),this._size=((r=(o=t==null?void 0:t.size)!==null&&o!==void 0?o:e==null?void 0:e.size)!==null&&r!==void 0?r:n==null?void 0:n.size)||14,this._spaceBetweenTextAndIcon=((l=(s=t==null?void 0:t.spaceBetweenTextAndIcon)!==null&&s!==void 0?s:e==null?void 0:e.spaceBetweenTextAndIcon)!==null&&l!==void 0?l:n==null?void 0:n.spaceBetweenTextAndIcon)||8,this._defaultFill=(h=(a=t==null?void 0:t.checkboxStyle)===null||a===void 0?void 0:a.defaultFill)!==null&&h!==void 0?h:n==null?void 0:n.defaultFill,this._defaultStroke=(u=(d=t==null?void 0:t.checkboxStyle)===null||d===void 0?void 0:d.defaultStroke)!==null&&u!==void 0?u:n==null?void 0:n.defaultStroke,this._disableFill=(f=(c=t==null?void 0:t.checkboxStyle)===null||c===void 0?void 0:c.disableFill)!==null&&f!==void 0?f:n==null?void 0:n.disableFill,this._checkedFill=(p=(g=t==null?void 0:t.checkboxStyle)===null||g===void 0?void 0:g.checkedFill)!==null&&p!==void 0?p:n==null?void 0:n.checkedFill,this._checkedStroke=(m=(v=t==null?void 0:t.checkboxStyle)===null||v===void 0?void 0:v.checkedStroke)!==null&&m!==void 0?m:n==null?void 0:n.checkedStroke,this._disableCheckedFill=(C=(b=t==null?void 0:t.checkboxStyle)===null||b===void 0?void 0:b.disableCheckedFill)!==null&&C!==void 0?C:n==null?void 0:n.disableCheckedFill,this._disableCheckedStroke=(w=(_=t==null?void 0:t.checkboxStyle)===null||_===void 0?void 0:_.disableCheckedStroke)!==null&&w!==void 0?w:n==null?void 0:n.disableCheckedStroke,this._checkIconImage=(x=(y=t==null?void 0:t.checkboxStyle)===null||y===void 0?void 0:y.checkIconImage)!==null&&x!==void 0?x:n==null?void 0:n.checkIconImage,this._indeterminateIconImage=(R=(S=t==null?void 0:t.checkboxStyle)===null||S===void 0?void 0:S.indeterminateIconImage)!==null&&R!==void 0?R:n==null?void 0:n.indeterminateIconImage}get size(){return this._size}set size(t){this._size=t}get spaceBetweenTextAndIcon(){return this._spaceBetweenTextAndIcon}set spaceBetweenTextAndIcon(t){this._spaceBetweenTextAndIcon=t}get defaultFill(){return this._defaultFill}set defaultFill(t){this._defaultFill=t}get defaultStroke(){return this._defaultStroke}set defaultStroke(t){this._defaultStroke=t}get disableFill(){return this._disableFill}set disableFill(t){this._disableFill=t}get checkedFill(){return this._checkedFill}set checkedFill(t){this._checkedFill=t}get checkedStroke(){return this._checkedStroke}set checkedStroke(t){this._checkedStroke=t}get disableCheckedFill(){return this._disableCheckedFill}set disableCheckedFill(t){this._disableCheckedFill=t}get disableCheckedStroke(){return this._disableCheckedStroke}set disableCheckedStroke(t){this._disableCheckedStroke=t}get checkIconImage(){return this._checkIconImage}set checkIconImage(t){this._checkIconImage=t}get indeterminateIconImage(){return this._indeterminateIconImage}set indeterminateIconImage(t){this._indeterminateIconImage=t}getStyle(t){return new ta(t,this)}clone(){return new ta(this)}},yv;class Ro extends Wi{static get DEFAULT(){return yv||(yv=new Ro)}constructor(t={},e={},n={}){var o,r,s,l,a,h,d,u,c,f,g,p,v,m,b,C,_,w,y,x,S,R,B,A;super(t,e),this._size=((r=(o=t==null?void 0:t.size)!==null&&o!==void 0?o:e==null?void 0:e.size)!==null&&r!==void 0?r:n==null?void 0:n.size)||14,this._spaceBetweenTextAndIcon=((l=(s=t==null?void 0:t.spaceBetweenTextAndIcon)!==null&&s!==void 0?s:e==null?void 0:e.spaceBetweenTextAndIcon)!==null&&l!==void 0?l:n==null?void 0:n.spaceBetweenTextAndIcon)||8,this._spaceBetweenRadio=((h=(a=t==null?void 0:t.spaceBetweenRadio)!==null&&a!==void 0?a:e==null?void 0:e.spaceBetweenRadio)!==null&&h!==void 0?h:n==null?void 0:n.spaceBetweenRadio)||2,this._innerRadius=(u=(d=t==null?void 0:t.radioStyle)===null||d===void 0?void 0:d.innerRadius)!==null&&u!==void 0?u:n==null?void 0:n.innerRadius,this._outerRadius=(f=(c=t==null?void 0:t.radioStyle)===null||c===void 0?void 0:c.outerRadius)!==null&&f!==void 0?f:n==null?void 0:n.outerRadius,this._defaultFill=(p=(g=t==null?void 0:t.radioStyle)===null||g===void 0?void 0:g.defaultFill)!==null&&p!==void 0?p:n==null?void 0:n.defaultFill,this._defaultStroke=(m=(v=t==null?void 0:t.radioStyle)===null||v===void 0?void 0:v.defaultStroke)!==null&&m!==void 0?m:n==null?void 0:n.defaultStroke,this._disableFill=(C=(b=t==null?void 0:t.radioStyle)===null||b===void 0?void 0:b.disableFill)!==null&&C!==void 0?C:n==null?void 0:n.disableFill,this._checkedFill=(w=(_=t==null?void 0:t.radioStyle)===null||_===void 0?void 0:_.checkedFill)!==null&&w!==void 0?w:n==null?void 0:n.checkedFill,this._checkedStroke=(x=(y=t==null?void 0:t.radioStyle)===null||y===void 0?void 0:y.checkedStroke)!==null&&x!==void 0?x:n==null?void 0:n.checkedStroke,this._disableCheckedFill=(R=(S=t==null?void 0:t.radioStyle)===null||S===void 0?void 0:S.disableCheckedFill)!==null&&R!==void 0?R:n==null?void 0:n.disableCheckedFill,this._disableCheckedStroke=(A=(B=t==null?void 0:t.radioStyle)===null||B===void 0?void 0:B.disableCheckedStroke)!==null&&A!==void 0?A:n==null?void 0:n.disableCheckedStroke}get size(){return this._size}set size(t){this._size=t}get spaceBetweenTextAndIcon(){return this._spaceBetweenTextAndIcon}set spaceBetweenTextAndIcon(t){this._spaceBetweenTextAndIcon=t}get spaceBetweenRadio(){return this._spaceBetweenRadio}set spaceBetweenRadio(t){this._spaceBetweenRadio=t}get innerRadius(){return this._innerRadius}set innerRadius(t){this._innerRadius=t}get outerRadius(){return this._outerRadius}set outerRadius(t){this._outerRadius=t}get defaultFill(){return this._defaultFill}set defaultFill(t){this._defaultFill=t}get defaultStroke(){return this._defaultStroke}set defaultStroke(t){this._defaultStroke=t}get disableFill(){return this._disableFill}set disableFill(t){this._disableFill=t}get checkedFill(){return this._checkedFill}set checkedFill(t){this._checkedFill=t}get checkedStroke(){return this._checkedStroke}set checkedStroke(t){this._checkedStroke=t}get disableCheckedFill(){return this._disableCheckedFill}set disableCheckedFill(t){this._disableCheckedFill=t}get disableCheckedStroke(){return this._disableCheckedStroke}set disableCheckedStroke(t){this._disableCheckedStroke=t}getStyle(t){return new Ro(t,this)}clone(){return new Ro(this)}}let Sv;class Ao extends Wi{static get DEFAULT(){return Sv||(Sv=new Ao)}constructor(t={},e={},n={}){var o,r,s,l,a,h,d,u,c,f,g,p,v,m,b,C,_,w;super(t,e),this._spaceBetweenTextAndCircle=((r=(o=t==null?void 0:t.spaceBetweenTextAndCircle)!==null&&o!==void 0?o:e==null?void 0:e.spaceBetweenTextAndCircle)!==null&&r!==void 0?r:n==null?void 0:n.spaceBetweenTextAndCircle)||6,this._circleRadius=((l=(s=t==null?void 0:t.switchStyle)===null||s===void 0?void 0:s.circleRadius)!==null&&l!==void 0?l:n==null?void 0:n.circleRadius)||8,this._boxWidth=((h=(a=t==null?void 0:t.switchStyle)===null||a===void 0?void 0:a.boxWidth)!==null&&h!==void 0?h:n==null?void 0:n.boxWidth)||40,this._boxHeight=((u=(d=t==null?void 0:t.switchStyle)===null||d===void 0?void 0:d.boxHeight)!==null&&u!==void 0?u:n==null?void 0:n.boxHeight)||24,this._checkedFill=((f=(c=t==null?void 0:t.switchStyle)===null||c===void 0?void 0:c.checkedFill)!==null&&f!==void 0?f:n==null?void 0:n.checkedFill)||"#165DFF",this._uncheckedFill=((p=(g=t==null?void 0:t.switchStyle)===null||g===void 0?void 0:g.uncheckedFill)!==null&&p!==void 0?p:n==null?void 0:n.uncheckedFill)||"#c9cdd4",this._disableCheckedFill=((m=(v=t==null?void 0:t.switchStyle)===null||v===void 0?void 0:v.disableCheckedFill)!==null&&m!==void 0?m:n==null?void 0:n.disableCheckedFill)||"#94bfff",this._disableUncheckedFill=((C=(b=t==null?void 0:t.switchStyle)===null||b===void 0?void 0:b.disableUncheckedFill)!==null&&C!==void 0?C:n==null?void 0:n.disableUncheckedFill)||"#f2f3f5",this._circleFill=((w=(_=t==null?void 0:t.switchStyle)===null||_===void 0?void 0:_.circleFill)!==null&&w!==void 0?w:n==null?void 0:n.circleFill)||"#FFF"}get spaceBetweenTextAndCircle(){return this._spaceBetweenTextAndCircle}set spaceBetweenTextAndCircle(t){this._spaceBetweenTextAndCircle=t}get circleRadius(){return this._circleRadius}set circleRadius(t){this._circleRadius=t}get boxWidth(){return this._boxWidth}set boxWidth(t){this._boxWidth=t}get boxHeight(){return this._boxHeight}set boxHeight(t){this._boxHeight=t}get checkedFill(){return this._checkedFill}set checkedFill(t){this._checkedFill=t}get uncheckedFill(){return this._uncheckedFill}set uncheckedFill(t){this._uncheckedFill=t}get disableCheckedFill(){return this._disableCheckedFill}set disableCheckedFill(t){this._disableCheckedFill=t}get disableUncheckedFill(){return this._disableUncheckedFill}set disableUncheckedFill(t){this._disableUncheckedFill=t}get circleFill(){return this._circleFill}set circleFill(t){this._circleFill=t}getStyle(t){return new Ao(t,this)}clone(){return new Ao(this)}}let xv;class Bo extends Wi{static get DEFAULT(){return xv||(xv=new Bo)}constructor(t={},e={},n={}){var o,r,s,l,a,h,d,u,c,f,g,p,v,m,b,C,_,w,y,x,S,R;super(t,e),this._buttonColor=((r=(o=t==null?void 0:t.buttonStyle)===null||o===void 0?void 0:o.buttonColor)!==null&&r!==void 0?r:n==null?void 0:n.buttonColor)||"#165DFF",this._buttonBorderColor=((l=(s=t==null?void 0:t.buttonStyle)===null||s===void 0?void 0:s.buttonBorderColor)!==null&&l!==void 0?l:n==null?void 0:n.buttonBorderColor)||"#165DFF",this._buttonLineWidth=((h=(a=t==null?void 0:t.buttonStyle)===null||a===void 0?void 0:a.buttonLineWidth)!==null&&h!==void 0?h:n==null?void 0:n.buttonLineWidth)||1,this._buttonBorderRadius=((u=(d=t==null?void 0:t.buttonStyle)===null||d===void 0?void 0:d.buttonBorderRadius)!==null&&u!==void 0?u:n==null?void 0:n.buttonBorderRadius)||2,this._buttonHoverColor=((f=(c=t==null?void 0:t.buttonStyle)===null||c===void 0?void 0:c.buttonHoverColor)!==null&&f!==void 0?f:n==null?void 0:n.buttonHoverColor)||"#4080FF",this._buttonHoverBorderColor=((p=(g=t==null?void 0:t.buttonStyle)===null||g===void 0?void 0:g.buttonHoverBorderColor)!==null&&p!==void 0?p:n==null?void 0:n.buttonHoverBorderColor)||"#4080FF",this._buttonTextHoverColor=(m=(v=t==null?void 0:t.buttonStyle)===null||v===void 0?void 0:v.buttonTextHoverColor)!==null&&m!==void 0?m:n==null?void 0:n.buttonTextHoverColor,this._buttonDisableColor=((C=(b=t==null?void 0:t.buttonStyle)===null||b===void 0?void 0:b.buttonDisableColor)!==null&&C!==void 0?C:n==null?void 0:n.buttonDisableColor)||"#94bfff",this._buttonDisableBorderColor=((w=(_=t==null?void 0:t.buttonStyle)===null||_===void 0?void 0:_.buttonDisableBorderColor)!==null&&w!==void 0?w:n==null?void 0:n.buttonDisableBorderColor)||"#94bfff",this._buttonTextDisableColor=(x=(y=t==null?void 0:t.buttonStyle)===null||y===void 0?void 0:y.buttonTextDisableColor)!==null&&x!==void 0?x:n==null?void 0:n.buttonTextDisableColor,this._buttonPadding=((R=(S=t==null?void 0:t.buttonStyle)===null||S===void 0?void 0:S.buttonPadding)!==null&&R!==void 0?R:n==null?void 0:n.buttonPadding)||10}get buttonColor(){return this._buttonColor}set buttonColor(t){this._buttonColor=t}get buttonBorderColor(){return this._buttonBorderColor}set buttonBorderColor(t){this._buttonBorderColor=t}get buttonLineWidth(){return this._buttonLineWidth}set buttonLineWidth(t){this._buttonLineWidth=t}get buttonBorderRadius(){return this._buttonBorderRadius}set buttonBorderRadius(t){this._buttonBorderRadius=t}get buttonHoverColor(){return this._buttonHoverColor}set buttonHoverColor(t){this._buttonHoverColor=t}get buttonHoverBorderColor(){return this._buttonHoverBorderColor}set buttonHoverBorderColor(t){this._buttonHoverBorderColor=t}get buttonTextHoverColor(){return this._buttonTextHoverColor}set buttonTextHoverColor(t){this._buttonTextHoverColor=t}get buttonDisableColor(){return this._buttonDisableColor}set buttonDisableColor(t){this._buttonDisableColor=t}get buttonDisableBorderColor(){return this._buttonDisableBorderColor}set buttonDisableBorderColor(t){this._buttonDisableBorderColor=t}get buttonTextDisableColor(){return this._buttonTextDisableColor}set buttonTextDisableColor(t){this._buttonTextDisableColor=t}get buttonTextHoverBorderColor(){return this._buttonTextHoverBorderColor}set buttonTextHoverBorderColor(t){this._buttonTextHoverBorderColor=t}get buttonPadding(){return this._buttonPadding}set buttonPadding(t){this._buttonPadding=t}getStyle(t){return new Bo(t,this)}clone(){return new Bo(this)}}const{EVENT_TYPE:bO}=Wi;function Yg(i,t,e,n=Wi,o,r){var s,l,a,h;return i||t?i instanceof Wi?i:typeof i=="function"?Yg(i(e),t,e,n,o,r):(i||(i={}),o&&!O(i.autoWrapText)&&(i.autoWrapText=!0),n===Wc?new Wc(i??{},t??{},(s=r.checkboxStyle)!==null&&s!==void 0?s:{}):n===Ro?new Ro(i??{},t??{},(l=r.radioStyle)!==null&&l!==void 0?l:{}):n===Ao?new Ao(i??{},t??{},(a=r.switchStyle)!==null&&a!==void 0?a:{}):n===Bo?new Bo(i??{},t??{},(h=r.buttonStyle)!==null&&h!==void 0?h:{}):new n(i??{},t??{})):n.DEFAULT}class Bt{static get mode(){return Bt._mode||(Bt._mode=s2()),Bt._mode}static set mode(t){Bt._mode=t}static RegisterCreateCanvas(t){Bt.CreateCanvas=t}static RegisterLoadImage(t){Bt.LoadImage=t}static GetCreateCanvasFunc(){return Bt.CreateCanvas?Bt.CreateCanvas:Bt.mode==="worker"?(t=200,e=200)=>new OffscreenCanvas(t,e):void 0}static RegisterRequestAnimationFrame(t){Bt.RequestAnimationFrame=t()}static GetRequestAnimationFrame(){if(Bt.RequestAnimationFrame)return Bt.RequestAnimationFrame}static RegisterCancelAnimationFrame(t){Bt.CancelAnimationFrame=t()}static GetCancelAnimationFrame(){if(Bt.CancelAnimationFrame)return Bt.CancelAnimationFrame}}function s2(){let i="browser";try{window.type==="node"?i="node":typeof window>"u"||window.performance?typeof window>"u"&&(i="node"):i="miniApp"}catch{i="node"}return i}Bt.dpr=0;function l2(){if(Bt.mode==="node")return;const i=document.createElement("style");i.id="vtable-style-styleSheet",i.textContent=`
.vtable .input-container {
	position: absolute;
	top:0px;
}
.vtable .table-scrollable {
	position: absolute;
	overflow: scroll;
}
.vtable .table-scrollable::-webkit-scrollbar-button{
	background-color: transparent;
}
.vtable .table-scrollable::-webkit-scrollbar-track-piece{
	background-color: transparent;
}
.vtable .table-scrollable::-webkit-scrollbar-corner {
	background-color: transparent;
}
.vtable .table-scrollable::-webkit-scrollbar-thumb {
	border-radius      : 4px;
	background-color   : rgba(100, 100, 100, .5);
}

.vtable .table-scroll-end-point {
	opacity: 0;
	position: relative;
}
.vtable {
	/* 设置overflow: auto 应该是为了滚动条的某个问题 但设置了auto之后 dom的下拉菜单只能显示在vtable节点中 超出会截断;现在去掉auto 暂时滚动条的问题没有发现 */
	/* overflow: auto; */
	position: relative;
	width: 100%;
	height: 100%;
	text-align: left;
  -webkit-font-smoothing:auto;

  overflow: hidden; // for react-vtable dom custom element
}

.vtable-gantt {
	/* 设置overflow: auto 应该是为了滚动条的某个问题 但设置了auto之后 dom的下拉菜单只能显示在vtable节点中 超出会截断;现在去掉auto 暂时滚动条的问题没有发现 */
	/* overflow: auto; */
	position: absolute;
	width: 100%;
	height: 100%;
	text-align: left;
  -webkit-font-smoothing:auto;

  overflow: hidden; // for react-vtable dom custom element
}
.vtable .table-component-container {
  pointer-events: none;
  overflow: hidden;
  position: absolute;
  top: 0px;
  left: 0px;
}
.vtable > canvas {
	position: absolute;
	width: 0;
	height: 0;
}
.vtable .table-focus-control {
	position: relative !important;
	width: 1px;
	height: 1px;
	opacity: 0;
	padding: 0;
	margin: 0;
	box-sizing: border-box;
	pointer-events: none;
	max-width: 500px;
	max-height: 500px;
	float: none !important;
}
.vtable input.table-focus-control::-ms-clear {
	visibility: hidden;
}
.vtable input.table-focus-control.composition {
	opacity: 1;
	max-width: none;
	max-height: none;
}
`,document.head.appendChild(i)}function a2(i){var t;return i!=null&&i.hoverOn||i!=null&&i.horizontalVisible&&(i==null?void 0:i.horizontalVisible)==="none"||!(i!=null&&i.horizontalVisible)&&(i==null?void 0:i.visible)==="none"?0:(t=i==null?void 0:i.width)!==null&&t!==void 0?t:7}function h2(i){var t;return i!=null&&i.hoverOn||i!=null&&i.verticalVisible&&(i==null?void 0:i.verticalVisible)==="none"||!(i!=null&&i.verticalVisible)&&(i==null?void 0:i.visible)==="none"?0:(t=i==null?void 0:i.width)!==null&&t!==void 0?t:7}function d2(i){return!!O(i)&&(!Q(i)||i.some(t=>O(t)))}function u2(i){return i===0||Q(i)&&i.every(t=>t===0)}const c2=i=>{switch(Object.prototype.toString.call(i)){case"[object Object]":return"object";case"[object Function]":return"function";case"[object Array]":return"array";case"[object String]":return"string";case"[object Number]":return"number";case"[object RegExp]":return"regExp";case"[object Boolean]":return"boolean";case"[object Symbol]":return"symbol";case"[object Date]":return"date";case"[object Undefined]":return"undefined";case"[object Null]":return"null";case"[object Error]":return"error";case"[object HTMLDocument]":return"document";case"[object global]":return"global";default:return null}},bd=(i,t)=>c2(i)===t,Fl=i=>bd(i,"object"),g2=i=>bd(i,"string"),f2=i=>bd(i,"number"),p2=i=>bd(i,"boolean");function $t(i,...t){if(!t.length)return i||{};const e=t.shift();if(Fl(i)&&Fl(e))for(const n in e)Fl(e[n])?(i[n]||Object.assign(i,{[n]:{}}),Fl(i[n])||Object.assign(i,{[n]:e[n]}),$t(i[n],e[n])):e[n]!==null&&e[n]!==void 0&&Object.assign(i,{[n]:e[n]});return $t(i,...t)}function Rv(i){return typeof i=="function"&&(i=i()),O(i)?`${i}`:""}function CO(i){if((i==null?void 0:i.length)<=0)return i;const t=i.length,e=i[0].length,n=new Array(e);for(let o=0;o<t;o++)for(let r=0;r<e;r++)n[r]||(n[r]=new Array(t)),n[r][o]=i[o][r];return n}function Av(i,t){let e=null;return function(...n){e||(i.apply(this,n),e=setTimeout(()=>{e=null},t))}}function v2(i,t){let e=null;return function(...n){e||(e=setTimeout(()=>{i.apply(this,n),e=null},t))}}function Kd(i,t){for(i=`${i}`;i.length<t;)i="0"+i;return i}function Ln(i,t,e){i=(i=i.replace(/^\s*|\s*$/,"")).replace(/^#?([a-f0-9])([a-f0-9])([a-f0-9])$/i,"#$1$1$2$2$3$3");const n=Math.round(256*t)*1,o=i.match(new RegExp("^rgba?\\(\\s*(\\d|[1-9]\\d|1\\d{2}|2[0-4][0-9]|25[0-5])\\s*,\\s*(\\d|[1-9]\\d|1\\d{2}|2[0-4][0-9]|25[0-5])\\s*,\\s*(\\d|[1-9]\\d|1\\d{2}|2[0-4][0-9]|25[0-5])(?:\\s*,\\s*(0|1|0?\\.\\d+))?\\s*\\)$","i")),r=o&&O(o[4])?o[4]:null,s=o?[o[1],o[2],o[3]]:i.replace(/^#?([a-f0-9][a-f0-9])([a-f0-9][a-f0-9])([a-f0-9][a-f0-9])/i,function(){return`${parseInt(arguments[1],16)},${parseInt(arguments[2],16)},${parseInt(arguments[3],16)}`}).split(/,/);return o?`rgb${r!==null?"a":""}(${Math.min(parseInt(s[0],10)+n,255)}, ${Math.min(parseInt(s[1],10)+n,255)}, ${Math.min(parseInt(s[2],10)+n,255)}${r!==null?`, ${r}`:""})`:["#",Kd(Math.min(parseInt(s[0],10)+n,255).toString(16),2),Kd(Math.min(parseInt(s[1],10)+n,255).toString(16),2),Kd(Math.min(parseInt(s[2],10)+n,255).toString(16),2)].join("")}function Cd(i){return g2(i)||f2(i)||p2(i)?i.toString():""}function Nc(){return navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i)}function ah(i,t,e){return e!=="desc"?i===t?0:i>t?1:-1:i===t?0:i<t?1:-1}function m2(i,t){let e,n=i;for(;(e=t.shift())&&(n=n[e],n););return n}function b2(i){return/^-?\d+(\.\d+)?$/.test(i)}function _s(i){const t=[];for(let e=0;e<i.length;e++)t.indexOf(i[e])===-1&&t.push(i[e]);return t}function C2(i){const t=window.getSelection();if(t.rangeCount){const e=t.getRangeAt(0);return e.endOffset>e.startOffset&&i.contains(e.commonAncestorContainer)}return!1}function Xg(i,t,e){e(i),i!=null&&i[t]&&Array.isArray(i==null?void 0:i[t])&&i[t].forEach(n=>Xg(n,t,e))}const R_=typeof window>"u"||window.window===void 0;let Yd,Xd;const A_={get find(){return Yd||(Yd=Array.prototype.find?(i,t)=>Array.prototype.find.call(i,t):(i,t)=>{const e=A_.findIndex(i,t);return e>=0?i[e]:void 0},Yd)},get findIndex(){return Xd||(Xd=Array.prototype.findIndex?(i,t)=>Array.prototype.findIndex.call(i,t):(i,t)=>{const{length:e}=i;for(let n=0;n<e;n++)if(t(i[n],n,i))return n;return-1},Xd)}};function _2(){if(R_)return{IE:!1,Edge:!1,Chrome:!1,Firefox:!1,Safari:!1};const i=window.navigator.userAgent.toLowerCase();return{IE:!!/(msie|trident)/.exec(i),Edge:i.indexOf("edge")>-1,Chrome:i.indexOf("chrome")>-1&&i.indexOf("edge")===-1,Firefox:i.indexOf("firefox")>-1,Safari:i.indexOf("safari")>-1&&i.indexOf("edge")===-1}}const{IE:w2,Chrome:_O,Firefox:wO,Edge:yO,Safari:SO}=_2();function y2(i){return i===Object(i)}function dl(...i){const t={};return i.forEach(e=>{for(const n in e)Object.defineProperty(t,n,{get:()=>e[n],set(o){e[n]=o},configurable:!0,enumerable:!0})}),t}function B_(i,t,...e){let n=i;for(let o=0;o<e.length&&n!=null;o++)n=t(n,e[o]);return n}function zl(i,...t){return B_(i,(e,n)=>e[n],...t)}function zt(i,...t){return typeof i=="function"?i(...t):i}function S2(i,t,e){const n=Cd(i);(typeof e!="number"||!isFinite(e)||Math.floor(e)!==e||e>n.length)&&(e=n.length),e-=t.length;const o=n.lastIndexOf(t,e);return o!==-1&&o===e}function ji(i){return!!(i&&typeof i.then=="function")}function Il(i,t){ji(i)?i.then(e=>{t(e)}).catch(e=>{}):t(i)}function x2(i){return!!i.changedTouches}function R2(i,t){if(i[t])return i[t];const e=t.toLowerCase();if(i[e])return i[e];const n=t.toLowerCase();if(i[n])return i[n];for(const o in i)if(o.toLowerCase()===e)return i[o]}function M_(i){return Array.isArray(i)?i.length===3?[i[0],i[1],i[2],i[1]]:i.length===2?[i[0],i[1],i[0],i[1]]:i.length===1?[i[0],i[0],i[0],i[0]]:[i[0],i[1],i[2],i[3]]:[i,i,i,i]}function Bi(i,t,e){return i.start.col<=t&&t<=i.end.col&&i.start.row<=e&&e<=i.end.row||i.end.col<=t&&t<=i.start.col&&i.end.row<=e&&e<=i.start.row||i.end.col<=t&&t<=i.start.col&&i.start.row<=e&&e<=i.end.row||i.start.col<=t&&t<=i.end.col&&i.end.row<=e&&e<=i.start.row}function A2(i,t,e){for(let n=0;n<i.length;n++){const o=i[n],r=Math.min(o.start.col,o.end.col),s=Math.max(o.start.col,o.end.col),l=Math.min(o.start.row,o.end.row),a=Math.max(o.start.row,o.end.row);if(r<=t&&t<=s&&l<=e&&e<=a||s<=t&&t<=r&&a<=e&&e<=l)return!0}return!1}function Bv(i){return{start:{col:Math.min(i.start.col,i.end.col),row:Math.min(i.start.row,i.end.row)},end:{col:Math.max(i.start.col,i.end.col),row:Math.max(i.start.row,i.end.row)}}}function B2(i,t){const e=Bv(i),n=Bv(t);return Math.max(e.start.col,n.start.col)<=Math.min(e.end.col,n.end.col)&&Math.max(e.start.row,n.start.row)<=Math.min(e.end.row,n.end.row)}const M2={IE:w2},T_={isObject:y2},Ol={endsWith:S2},T2={isTouchEvent:x2},P2={toBoxArray:M_},H2=Function.prototype,U={CLICK_CELL:"click_cell",DBLCLICK_CELL:"dblclick_cell",MOUSEDOWN_CELL:"mousedown_cell",MOUSEUP_CELL:"mouseup_cell",SELECTED_CELL:"selected_cell",SELECTED_CLEAR:"selected_clear",KEYDOWN:"keydown",MOUSEENTER_TABLE:"mouseenter_table",MOUSELEAVE_TABLE:"mouseleave_table",MOUSEDOWN_TABLE:"mousedown_table",MOUSEMOVE_TABLE:"mousemove_table",MOUSEMOVE_CELL:"mousemove_cell",MOUSEENTER_CELL:"mouseenter_cell",MOUSELEAVE_CELL:"mouseleave_cell",CONTEXTMENU_CELL:"contextmenu_cell",RESIZE_COLUMN:"resize_column",RESIZE_COLUMN_END:"resize_column_end",RESIZE_ROW:"resize_row",RESIZE_ROW_END:"resize_row_end",CHANGE_HEADER_POSITION_START:"change_header_position_start",CHANGE_HEADER_POSITION:"change_header_position",CHANGING_HEADER_POSITION:"changing_header_position",CHANGE_HEADER_POSITION_FAIL:"change_header_position_fail",SORT_CLICK:"sort_click",AFTER_SORT:"after_sort",FREEZE_CLICK:"freeze_click",SCROLL:"scroll",SCROLL_HORIZONTAL_END:"scroll_horizontal_end",SCROLL_VERTICAL_END:"scroll_vertical_end",DROPDOWN_MENU_CLICK:"dropdown_menu_click",MOUSEOVER_CHART_SYMBOL:"mouseover_chart_symbol",DRAG_SELECT_END:"drag_select_end",COPY_DATA:"copy_data",DROPDOWN_ICON_CLICK:"dropdown_icon_click",DROPDOWN_MENU_CLEAR:"dropdown_menu_clear",TREE_HIERARCHY_STATE_CHANGE:"tree_hierarchy_state_change",SHOW_MENU:"show_menu",HIDE_MENU:"hide_menu",ICON_CLICK:"icon_click",LEGEND_ITEM_CLICK:"legend_item_click",LEGEND_ITEM_HOVER:"legend_item_hover",LEGEND_ITEM_UNHOVER:"legend_item_unHover",LEGEND_CHANGE:"legend_change",MOUSEENTER_AXIS:"mouseenter_axis",MOUSELEAVE_AXIS:"mouseleave_axis",CHECKBOX_STATE_CHANGE:"checkbox_state_change",RADIO_STATE_CHANGE:"radio_state_change",SWITCH_STATE_CHANGE:"switch_state_change",AFTER_RENDER:"after_render",INITIALIZED:"initialized",CHANGE_CELL_VALUE:"change_cell_value",DRAG_FILL_HANDLE_END:"drag_fill_handle_end",MOUSEDOWN_FILL_HANDLE:"mousedown_fill_handle",DBLCLICK_FILL_HANDLE:"dblclick_fill_handle",EMPTY_TIP_CLICK:"empty_tip_click",EMPTY_TIP_DBLCLICK:"empty_tip_dblclick",BUTTON_CLICK:"button_click"},k2=i=>{switch(Object.prototype.toString.call(i)){case"[object Object]":return"object";case"[object Function]":return"function";case"[object Array]":return"array";case"[object String]":return"string";case"[object Number]":return"number";case"[object RegExp]":return"regExp";case"[object Boolean]":return"boolean";case"[object Symbol]":return"symbol";case"[object Date]":return"date";case"[object Undefined]":return"undefined";case"[object Null]":return"null";case"[object Error]":return"error";case"[object HTMLDocument]":return"document";case"[object global]":return"global";default:return null}},E2=(i,t)=>k2(i)===t,L2=i=>E2(i,"object");function P_(i,t,e){let n,o,r,s,l,a,h=0,d=!1,u=!1,c=!0;const f=!t&&t!==0&&typeof requestAnimationFrame=="function";if(typeof i!="function")throw new TypeError("Expected a function");function g(b){const C=n,_=o;return o=void 0,n=void 0,h=b,s=i.apply(_,C),s}function p(b,C){return f?requestAnimationFrame(b):setTimeout(b,C)}function v(b){const C=b-a;return a===void 0||C>=t||C<0||d&&b-h>=r}function m(){const b=Date.now();if(v(b))return function(C){return l=void 0,c&&n?g(C):(o=void 0,n=void 0,s)}(b);l=p(m,function(C){const _=C-h,w=t&&-(C-a);return d?Math.min(w,r-_):w}(b))}return t=+t||0,L2(e)&&(u=!!e.leading,d="maxWait"in e,d&&(r=Math.max(+e.maxWait||0,t)),c="trailing"in e?!!e.trailing:c),function(...b){const C=Date.now(),_=v(C);if(n=b,o=this,a=C,_){if(l===void 0)return function(w){return h=w,l=p(m,t),u?g(w):s}(a);if(d)return l=p(m,t),g(a)}return l===void 0&&(l=p(m,t)),s}}let F2=1;class z2{constructor(t,e,n){var o;if(this.resizeTime=100,this.lastSize={width:0,height:0},this.mutationResize=()=>{this.onResize()},this.callBack=()=>{const r=this.getSize();let s=!1;r.width===this.lastSize.width&&r.height===this.lastSize.height&&(s=!0),this.lastSize=r,this.cb&&this.cb(Object.assign(Object.assign({},this.lastSize),{windowSizeNotChange:s}))},this.onResize=()=>{this.callBackDebounce()},this.element=t,this.cb=e,this.lastSize=this.getSize(),n&&(this.resizeTime=Math.max(n,16)),this.callBackDebounce=P_(this.callBack,this.resizeTime),window==null||window.addEventListener("resize",this.onResize),"ResizeObserver"in window){const r=window.ResizeObserver;this.observer=new r(this.mutationResize),(o=this.observer)===null||o===void 0||o.observe(this.element)}else"MutationObserver"in window&&(this.observer=new MutationObserver(this.mutationResize),this.observer.observe(this.element,{attributes:!0,attributeFilter:["style"]}))}disConnect(){window.removeEventListener("resize",this.onResize),this.observer&&(this.observer.disconnect(),this.observer=void 0)}setSize(t){this.lastSize=t}checkSize(){const t=this.getSize();return t.width!==this.lastSize.width||t.height!==this.lastSize.height}getSize(){return this.element?{width:Math.floor(this.element.clientWidth),height:Math.floor(this.element.clientHeight)}:Object.assign({},this.lastSize)}}class _d{constructor(){this.listeners={},this.reseizeListeners={}}on(t,e,n,...o){if(Bt.mode==="node")return-1;const r=F2++;if(t!=null&&t.addEventListener)if(e!=="resize"||t===window)t==null||t.addEventListener(e,n,...o);else{const l=new z2(t,n,this.resizeTime);this.reseizeListeners[r]=l}const s={target:t,type:e,listener:n,options:o};return this.listeners[r]=s,r}once(t,e,n,...o){if(Bt.mode==="node")return-1;const r=this.on(t,e,(...s)=>{this.off(r),n(...s)},...o);return r}off(t){var e;if(Bt.mode==="node"||t===null)return;const n=(e=this.listeners)===null||e===void 0?void 0:e[t];n&&(delete this.listeners[t],n.target.removeEventListener&&n.target.removeEventListener(n.type,n.listener,...n.options))}fire(t,e,...n){if(Bt.mode!=="node")for(const o in this.listeners){const r=this.listeners[o];r.target===t&&r.type===e&&r.listener.call(r.target,...n)}}hasListener(t,e){if(Bt.mode==="node")return!1;let n=!1;for(const o in this.listeners){const r=this.listeners[o];r.target===t&&r.type===e&&(n=!0)}return n}clear(){if(Bt.mode!=="node"){for(const t in this.listeners){const e=this.listeners[t];e.target.removeEventListener&&e.target.removeEventListener(e.type,e.listener,...e.options)}for(const t in this.reseizeListeners){const e=this.reseizeListeners[t];e==null||e.disConnect()}this.listeners={}}}release(){Bt.mode!=="node"&&(this.clear(),this.listeners={})}}const ro=(i,t)=>{let e=0,n=i.length-1;for(;e<=n;){const o=Math.floor((e+n)/2);if(i[o]===t)return o;i[o]>t?n=o-1:e=o+1}return n<0?0:n};class Kn{constructor(){this._keys=[],this._vals={},this._sorted=!1}count(){return this._keys.length}values(){return this._vals}valueArr(){return Object.values(this._vals)}adjustOrder(t,e,n){const{_keys:o}=this;if(this._sorted||(o.sort((s,l)=>s<l?-1:s>l?1:0),this._sorted=!0),t>e){const s=[];for(let l=ro(o,t+n-1);l>=0;l--){const a=o[l];if(a>=t)s.push(this.get(a));else if(e<=a&&a<t)this.put(a+n,this.get(a));else if(a<e)break}for(let l=0;l<n;l++)this.put(e+l,s[n-1-l])}const{length:r}=o;if(t<e){const s=[];for(let l=ro(o,t);l<r;l++){const a=o[l];if(a>=t&&a<t+n)s.push(this.get(a));else if(t+n<=a&&a<=e)this.put(a-n,this.get(a));else if(a>e)break}for(let l=0;l<n;l++)this.put(e+l,s[l])}}exchangeOrder(t,e,n,o,r){const{_keys:s}=this;if(this._sorted||(s.sort((l,a)=>l<a?-1:l>a?1:0),this._sorted=!0),t>n){const l=[],a=[];for(let h=ro(s,n);h<ro(s,t)+e;h++){const d=s[h];d>=t&&d<t+e?a.push(this.get(d)):l.push(this.get(d))}for(let h=0;h<e;h++)this.put(r+h,a[h]);for(let h=0;h<l.length;h++)this.put(r+e+h,l[h])}else{const l=[],a=[];for(let h=ro(s,t);h<ro(s,n)+o;h++){const d=s[h];d>=t&&d<t+e?a.push(this.get(d)):l.push(this.get(d))}for(let h=0;h<e;h++)this.put(r+h,a[h]);for(let h=0;h<l.length;h++)this.put(t+h,l[h])}}del(t){delete this._vals[t];const e=this._keys.indexOf(t);e!==-1&&this._keys.splice(e,1)}put(t,e){t in this._vals||(this._keys.push(t),this._sorted=!1),this._vals[t]=e}get(t){return this._vals[t]}has(t){return O(this._vals[t])}contain(t){return Object.values(this._vals).indexOf(t)>=0}each(t,e,n){const{_keys:o}=this,{length:r}=o;this._sorted||(o.sort((s,l)=>s<l?-1:s>l?1:0),this._sorted=!0);for(let s=ro(o,t);s<r;s++){const l=o[s];if(t<=l&&l<=e){if(n(this.get(l),l)===!1)break}else if(e<l)return}}clear(){this._keys.length=0,this._vals={},this._sorted=!1}getLastIndex(){return this._keys[this._keys.length-1]}delLast(){const t=this.getLastIndex();this.del(t)}delAndReorder(t){if(!this.has(t))return;const e=this.getLastIndex();this.adjustOrder(t+1,t,e-t),this.delLast()}addAndReorder(t,e){if(O(e)){const n=this.getLastIndex();this.adjustOrder(t,t+1,n-t),this.put(t,e)}}}class qi{constructor(t,e,n,o){this.bounds=new Rn,this.bounds.set(t,e,t+n,e+o)}static bounds(t,e,n,o){return new qi(t,e,Math.round(n-t),Math.round(o-e))}get left(){return this.bounds.x1}set left(t){this.bounds.x1=t}get top(){return this.bounds.y1}set top(t){this.bounds.y1=t}get right(){return this.bounds.x2}set right(t){this.bounds.x2=t}get bottom(){return this.bounds.y2}set bottom(t){this.bounds.y2=t}get width(){return this.bounds.width()}set width(t){this.bounds.x2=this.bounds.x1+t}get height(){return this.bounds.height()}set height(t){this.bounds.y2=this.bounds.y1+t}offsetLeft(t){this.bounds.translate(t,0)}offsetTop(t){this.bounds.translate(0,t)}copy(){return new qi(this.left,this.top,this.width,this.height)}contains(t){return this.bounds.encloses(t.bounds)}inPoint(t,e){return this.bounds.contains(t,e)}}function I2(i){const{row:t,table:e}=i;return 1&t-e.frozenRowCount?"#282a2e":"#2d3137"}const Mv={name:"DARK",underlayBackgroundColor:"transparent",defaultStyle:{color:"#D3D5DA",bgColor:"#373b45",fontSize:12,fontFamily:"PingFang SC",fontWeight:500,lineHeight:12,borderColor:"#444A54",padding:[8,12,8,12],hover:{cellBgColor:"#2F4774"}},headerStyle:{color:"#D3D5DA",bgColor:"#373b45",fontSize:12,fontFamily:"PingFang SC",fontWeight:500,lineHeight:12,borderColor:"#444A54",padding:[8,12,8,12],hover:{cellBgColor:"#2F4774"}},rowHeaderStyle:{},cornerHeaderStyle:{},bodyStyle:{color:"#e5e7ea",bgColor:I2,fontSize:12,fontFamily:"PingFang SC",fontWeight:500,lineHeight:12,borderColor:"#444A54",padding:[8,12,8,12],hover:{cellBgColor:"#29364D"}},frameStyle:{borderColor:"#d1d5da",borderLineWidth:1,borderLineDash:[],cornerRadius:10,shadowBlur:6,shadowOffsetX:0,shadowOffsetY:0,shadowColor:"rgba(00, 24, 47, 0.06)"},columnResize:{lineWidth:1,lineColor:"#416EFF",bgColor:"#D9E2FF",width:3},frozenColumnLine:{shadow:{width:4,startColor:"rgba(00, 24, 47, 0.05)",endColor:"rgba(00, 24, 47, 0)"}},selectionStyle:{cellBgColor:"rgba(255, 255, 255, 0.1)",cellBorderColor:"#4284FF",cellBorderLineWidth:2},tooltipStyle:{bgColor:"#FFF",color:"#000",fontSize:12,fontFamily:"Arial,sans-serif"},functionalIconsStyle:{sort_color:"#FFFFFF",sort_color_opacity:"0.75",sort_color_2:"#416EFF",sort_color_opacity_2:"1",frozen_color:"#FFFFFF",frozen_color_opacity:"0.75",collapse_color:"#FFF",collapse_color_opacity:"0.75",expand_color:"#FFF",expand_color_opacity:"0.75",dragReorder_color:"#FFF",dragReorder_color_opacity:"0.75"}};function O2(i){const{row:t,table:e}=i;return 1&t-e.frozenRowCount?"#FFF":"#F4F8FF"}const Tv={name:"BRIGHT",underlayBackgroundColor:"#FFF",defaultStyle:{color:"#FFF",bgColor:"#5389FF",borderColor:"#5286FA",hover:{cellBgColor:"#2E67E3"}},headerStyle:{color:"#FFF",bgColor:"#5389FF",borderColor:"#A1C1FF",hover:{cellBgColor:"#2E67E3"}},bodyStyle:{color:"#000",bgColor:O2,borderColor:"#E0EAFE",hover:{cellBgColor:"#E9EFFD"}},frameStyle:{borderColor:"#E1E4E8",borderLineWidth:1,borderLineDash:[],cornerRadius:0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,shadowColor:"black"},columnResize:{lineWidth:1,lineColor:"#416EFF",bgColor:"#D9E2FF",width:3},frozenColumnLine:{shadow:{width:3,startColor:"#CBDCFE",endColor:"#CBDCFE"}},selectionStyle:{cellBgColor:"rgba(0, 0, 255,0.1)"},tooltipStyle:{bgColor:"#FFF",color:"#000",fontSize:12,fontFamily:"Arial,sans-serif"}};function D2(i){const{row:t,table:e}=i;return 1&t-e.frozenRowCount?"#fbfbfc":"#FFF"}const Pv={name:"ARCO",underlayBackgroundColor:"#FFF",defaultStyle:{color:"#1B1F23",bgColor:"#EEF1F5",fontSize:14,fontFamily:"Arial,sans-serif",fontWeight:600,lineHeight:14,borderColor:"#e1e4e8",padding:[8,12,8,12]},headerStyle:{color:"#1B1F23",bgColor:"#EEF1F5",fontSize:14,fontFamily:"Arial,sans-serif",fontWeight:600,lineHeight:14,borderColor:"#e1e4e8",padding:[8,12,8,12],hover:{cellBgColor:"#c8daf6"}},rowHeaderStyle:{color:"#1B1F23",bgColor:"#EEF1F5",fontSize:12,fontFamily:"PingFang SC",fontWeight:500,lineHeight:12,borderColor:"#e1e4e8",padding:[8,12,8,12],hover:{cellBgColor:"#c8daf6"}},cornerHeaderStyle:{color:"#1B1F23",bgColor:"#EEF1F5",fontSize:12,fontFamily:"PingFang SC",fontWeight:500,lineHeight:12,borderColor:"#e1e4e8",padding:[8,12,8,12],hover:{cellBgColor:"#c8daf6"}},bodyStyle:{padding:[8,12,8,12],color:"#141414",fontSize:14,fontFamily:"Arial,sans-serif",fontWeight:400,textAlign:"left",bgColor:D2,borderColor:"#e1e4e8",lineHeight:14,hover:{cellBgColor:"#F7F8FA",inlineRowBgColor:"#F3F8FF",inlineColumnBgColor:"#F3F8FF"}},frameStyle:{borderColor:"#d1d5da",borderLineWidth:1,borderLineDash:[],cornerRadius:4,shadowBlur:6,shadowOffsetX:0,shadowOffsetY:0,shadowColor:"rgba(00, 24, 47, 0.06)"},columnResize:{lineWidth:1,lineColor:"#416EFF",bgColor:"#D9E2FF",width:3},frozenColumnLine:{shadow:{width:4,startColor:"rgba(00, 24, 47, 0.05)",endColor:"rgba(00, 24, 47, 0)"}},selectionStyle:{cellBgColor:"rgba(0, 0, 255,0.1)",cellBorderLineWidth:2,cellBorderColor:"#3073f2"},tooltipStyle:{bgColor:"#FFF",color:"#000",fontSize:12,fontFamily:"Arial,sans-serif"}};function W2(i){const{row:t,table:e}=i;return 1&t-e.frozenRowCount?"#FDFDFD":"#FAF9FB"}const Hv={name:"DEFAULT",underlayBackgroundColor:"#FFF",defaultStyle:{borderColor:"#E1E4E8",color:"#000",bgColor:"#ECF1F5"},headerStyle:{fontSize:16,fontWeight:"bold",bgColor:"#ECF1F5",hover:{cellBgColor:"#CCE0FF",inlineRowBgColor:"#F3F8FF",inlineColumnBgColor:"#F3F8FF"}},rowHeaderStyle:{fontSize:16,fontWeight:"bold",bgColor:"#ECF1F5",hover:{cellBgColor:"#CCE0FF",inlineRowBgColor:"#F3F8FF",inlineColumnBgColor:"#F3F8FF"}},cornerHeaderStyle:{fontSize:16,fontWeight:"bold"},bodyStyle:{fontSize:14,bgColor:W2,hover:{cellBgColor:"#CCE0FF",inlineRowBgColor:"#F3F8FF",inlineColumnBgColor:"#F3F8FF"}},frameStyle:{borderColor:"#E1E4E8",borderLineWidth:1,borderLineDash:[],cornerRadius:0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,shadowColor:"black"},columnResize:{lineWidth:1,lineColor:"#416EFF",bgColor:"#D9E2FF",width:3},frozenColumnLine:{shadow:{width:3,startColor:"rgba(225, 228, 232, 0.6)",endColor:"rgba(225, 228, 232, 0.6)"}},selectionStyle:{cellBgColor:"rgba(0, 0, 255,0.1)",cellBorderLineWidth:2,cellBorderColor:"#0000ff"},tooltipStyle:{bgColor:"#FFF",color:"#000",fontSize:12,fontFamily:"Arial,sans-serif"}};function N2(i){const{row:t,table:{frozenRowCount:e}}=i;return e-1===t?["#f2f2f2","#f2f2f2","#ccc7c7","#f2f2f2"]:["#f2f2f2"]}function V2(i){const{col:t,table:e}=i,{colCount:n,frozenColCount:o}=e,r="#ccc7c7";return o-1===t||n-1===t?[r,"#f2f2f2","#ccc7c7",null]:[r,null,"#ccc7c7",null]}const kv={name:"SIMPLIFY",underlayBackgroundColor:"#FFF",defaultStyle:{borderColor:V2,hover:{cellBorderColor:"#0000FF",cellBgColor:"#D0E0E3"},bgColor:"#FFF"},headerStyle:{color:"rgba(0, 0, 0, 0.87)",borderColor:N2},bodyStyle:{color:"rgba(0, 0, 0, 0.87)"},frameStyle:{borderColor:"#f2f2f2",borderLineWidth:1},columnResize:{lineWidth:1,lineColor:"#416EFF",bgColor:"#D9E2FF"},selectionStyle:{cellBorderColor:"#FD5",cellBgColor:"rgba(111, 168, 220, 0.1)"},tooltipStyle:{bgColor:"#FFF",color:"#000",fontSize:12,fontFamily:"Arial,sans-serif"}},G2={},Ev=16,Lv="Arial,sans-serif",j2="#FFF",U2="#000",$2=1,K2=[],Y2="#000",qg=/^(https?|ftp|file):\/\/[-A-Za-z0-9+&@#/%?=~_|!:,.;]+[-A-Za-z0-9+&@#/%=~_|]/,Dl="$$indicator$$",X2='<svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><rect x="0" y="0" width="1024" height="1024" rx="20%" ry="20%" fill="#ffffff" /><path  d="M810.666667 85.333333c70.688 0 128 57.312 128 128v597.333334c0 70.688-57.312 128-128 128H213.333333c-70.688 0-128-57.312-128-128V213.333333c0-70.688 57.312-128 128-128h597.333334z m0 85.333334H213.333333a42.666667 42.666667 0 0 0-42.613333 40.533333L170.666667 213.333333v597.333334a42.666667 42.666667 0 0 0 40.533333 42.613333L213.333333 853.333333h597.333334a42.666667 42.666667 0 0 0 42.613333-40.533333L853.333333 810.666667V213.333333a42.666667 42.666667 0 0 0-40.533333-42.613333L810.666667 170.666667zM549.333333 288a5.333333 5.333333 0 0 1 5.333334 5.333333V469.333333h176a5.333333 5.333333 0 0 1 5.333333 5.333334v74.666666a5.333333 5.333333 0 0 1-5.333333 5.333334H554.666667v176a5.333333 5.333333 0 0 1-5.333334 5.333333h-74.666666a5.333333 5.333333 0 0 1-5.333334-5.333333V554.666667H293.333333a5.333333 5.333333 0 0 1-5.333333-5.333334v-74.666666a5.333333 5.333333 0 0 1 5.333333-5.333334H469.333333V293.333333a5.333333 5.333333 0 0 1 5.333334-5.333333h74.666666z"></path></svg>',q2='<svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><rect x="0" y="0" width="1024" height="1024" rx="20%" ry="20%" fill="#ffffff" /><path d="M810.666667 85.333333c70.688 0 128 57.312 128 128v597.333334c0 70.688-57.312 128-128 128H213.333333c-70.688 0-128-57.312-128-128V213.333333c0-70.688 57.312-128 128-128h597.333334z m0 85.333334H213.333333a42.666667 42.666667 0 0 0-42.613333 40.533333L170.666667 213.333333v597.333334a42.666667 42.666667 0 0 0 40.533333 42.613333L213.333333 853.333333h597.333334a42.666667 42.666667 0 0 0 42.613333-40.533333L853.333333 810.666667V213.333333a42.666667 42.666667 0 0 0-40.533333-42.613333L810.666667 170.666667zM693.333333 469.333333a42.666667 42.666667 0 1 1 0 85.333334H330.666667a42.666667 42.666667 0 1 1 0-85.333334h362.666666z"></path></svg>',Z2={type:"line"};function J2(i){return{defaultAxisStyle:ts(i.defaultAxisStyle),leftAxisStyle:ts(i.leftAxisStyle),rightAxisStyle:ts(i.rightAxisStyle),topAxisStyle:ts(i.topAxisStyle),bottomAxisStyle:ts(i.bottomAxisStyle)}}function ts(i){return i||{}}const Q2={visible:!0,position:"auto",padding:8,titleStyle:{fontSize:12,fontWeight:"bold",fill:"#4E5969"},contentStyle:{fontSize:12,fill:"#4E5969"},panel:{visible:!0,fill:"#fff",stroke:"#ffffff",lineWidth:0,cornerRadius:3,shadowBlur:12,shadowOffsetX:0,shadowOffsetY:4,shadowColor:"rgba(0, 0, 0, 0.1)",size:0,space:12}};function Uo(i,t,e,n){var o,r,s;return(s=(r=(o=zl(i,...e))!==null&&o!==void 0?o:zl(t,...e))!==null&&r!==void 0?r:n&&zl(i,...n))!==null&&s!==void 0?s:n&&zl(t,...n)}class di{constructor(t,e){this._defaultStyle=null,this._header=null,this._cornerHeader=null,this._cornerRightTopCell=null,this._cornerLeftBottomCell=null,this._cornerRightBottomCell=null,this._rightFrozen=null,this._bottomFrozen=null,this._rowHeader=null,this._body=null,this._groupTitle=null,this._scroll=null,this._tooltip=null,this._frameStyle=null,this._columnResize=null,this._dragHeaderSplitLine=null,this._frozenColumnLine=null,this._selectionStyle=null,this._axisStyle=null,this._checkboxStyle=null,this._radioStyle=null,this._switchStyle=null,this._buttonStyle=null,this._textPopTipStyle=null,this._internalIconsStyle=null,this.isPivot=!1,this.name="",this.internalTheme={obj:t,superTheme:e},this.name=Uo(t,e,["name"])}getExtendTheme(){return this.internalTheme.obj}clearBodyStyleCache(){this._body=null}get font(){const{obj:t,superTheme:e}=this.internalTheme;return Uo(t,e,["font"],["bodyStyle","font"])}get underlayBackgroundColor(){const{obj:t,superTheme:e}=this.internalTheme;return Uo(t,e,["underlayBackgroundColor"])}get cellInnerBorder(){var t;const{obj:e,superTheme:n}=this.internalTheme;return(t=Uo(e,n,["cellInnerBorder"]))===null||t===void 0||t}get cellBorderClipDirection(){var t;const{obj:e,superTheme:n}=this.internalTheme;return(t=Uo(e,n,["cellBorderClipDirection"]))!==null&&t!==void 0?t:"top-left"}get _contentOffset(){var t;const{obj:e,superTheme:n}=this.internalTheme;return(t=Uo(e,n,["_contentOffset"]))!==null&&t!==void 0?t:0}get defaultStyle(){const t=this;if(!this._defaultStyle){const{obj:e,superTheme:n}=this.internalTheme,o=$t({},n.defaultStyle,e.defaultStyle);this._defaultStyle={get fontSize(){var r;return(r=o.fontSize)!==null&&r!==void 0?r:Ev},get fontFamily(){var r;return(r=o.fontFamily)!==null&&r!==void 0?r:Lv},get fontWeight(){return o.fontWeight},get fontVariant(){return o.fontVariant},get fontStyle(){return o.fontStyle},get bgColor(){var r;return(r=o.bgColor)!==null&&r!==void 0?r:j2},get color(){var r;return(r=o.color)!==null&&r!==void 0?r:Y2},get borderColor(){var r;return(r=o.borderColor)!==null&&r!==void 0?r:U2},get borderLineWidth(){var r;return(r=o.borderLineWidth)!==null&&r!==void 0?r:$2},get borderLineDash(){var r;return(r=o.borderLineDash)!==null&&r!==void 0?r:K2},get hover(){if(o.hover)return{get cellBgColor(){var r,s;return(s=(r=o.hover)===null||r===void 0?void 0:r.cellBgColor)!==null&&s!==void 0?s:void 0},get inlineColumnBgColor(){var r,s,l,a,h,d;return(d=(s=(r=o.hover)===null||r===void 0?void 0:r.inlineColumnBgColor)!==null&&s!==void 0?s:!((l=o.hover)===null||l===void 0)&&l.cellBgColor&&typeof((a=o.hover)===null||a===void 0?void 0:a.cellBgColor)=="string"?Ln((h=o.hover)===null||h===void 0?void 0:h.cellBgColor,.1):void 0)!==null&&d!==void 0?d:void 0},get inlineRowBgColor(){var r,s,l,a,h,d;return(d=(s=(r=o.hover)===null||r===void 0?void 0:r.inlineRowBgColor)!==null&&s!==void 0?s:!((l=o.hover)===null||l===void 0)&&l.cellBgColor&&typeof((a=o.hover)===null||a===void 0?void 0:a.cellBgColor)=="string"?Ln((h=o.hover)===null||h===void 0?void 0:h.cellBgColor,.1):void 0)!==null&&d!==void 0?d:void 0}}},get select(){if(o.select)return{get inlineColumnBgColor(){var r,s,l,a,h,d;return(d=(a=(s=(r=o.select)===null||r===void 0?void 0:r.inlineColumnBgColor)!==null&&s!==void 0?s:(l=t.selectionStyle)===null||l===void 0?void 0:l.inlineColumnBgColor)!==null&&a!==void 0?a:!((h=t.selectionStyle)===null||h===void 0)&&h.cellBgColor&&typeof t.selectionStyle.cellBgColor=="string"?Ln(t.selectionStyle.cellBgColor,.1):void 0)!==null&&d!==void 0?d:void 0},get inlineRowBgColor(){var r,s,l,a,h;return(h=(l=(s=(r=o.select)===null||r===void 0?void 0:r.inlineRowBgColor)!==null&&s!==void 0?s:t.selectionStyle.inlineRowBgColor)!==null&&l!==void 0?l:!((a=t.selectionStyle)===null||a===void 0)&&a.cellBgColor&&typeof t.selectionStyle.cellBgColor=="string"?Ln(t.selectionStyle.cellBgColor,.1):void 0)!==null&&h!==void 0?h:void 0}}},get padding(){var r;return(r=o.padding)!==null&&r!==void 0?r:[10,16,10,16]},get textAlign(){var r;return(r=o.textAlign)!==null&&r!==void 0?r:"left"},get textBaseline(){var r;return(r=o.textBaseline)!==null&&r!==void 0?r:"middle"},get textOverflow(){var r;return(r=o.textOverflow)!==null&&r!==void 0?r:"ellipsis"},get lineHeight(){return o.lineHeight},get autoWrapText(){var r;return(r=o.autoWrapText)!==null&&r!==void 0&&r},get lineClamp(){var r;return(r=o.lineClamp)!==null&&r!==void 0?r:"auto"},get linkColor(){var r;return(r=o.linkColor)!==null&&r!==void 0?r:"#3772ff"},get cursor(){var r;return(r=o.cursor)!==null&&r!==void 0?r:"auto"},get marked(){var r;return(r=o.marked)!==null&&r!==void 0&&r},get underline(){var r;return(r=o.underline)!==null&&r!==void 0&&r},get underlineColor(){return o.underlineColor},get underlineDash(){return o.underlineDash},get underlineOffset(){return o.underlineOffset},get lineThrough(){var r;return(r=o.lineThrough)!==null&&r!==void 0&&r},get lineThroughColor(){return o.lineThroughColor},get lineThroughDash(){return o.lineThroughDash}}}return this._defaultStyle}get cornerHeaderStyle(){if(!this._cornerHeader){const{obj:t,superTheme:e}=this.internalTheme,n=$t({},this.defaultStyle,e.cornerHeaderStyle,t.cornerHeaderStyle);this._cornerHeader=this.getStyle(n)}return this._cornerHeader}get cornerRightTopCellStyle(){if(!this._cornerRightTopCell){const{obj:t,superTheme:e}=this.internalTheme;if(!e.cornerRightTopCellStyle&&!t.cornerRightTopCellStyle)return this._cornerRightTopCell;const n=$t({},this.defaultStyle,e.cornerRightTopCellStyle,t.cornerRightTopCellStyle);this._cornerRightTopCell=this.getStyle(n)}return this._cornerRightTopCell}get cornerLeftBottomCellStyle(){if(!this._cornerLeftBottomCell){const{obj:t,superTheme:e}=this.internalTheme;if(!e.cornerLeftBottomCellStyle&&!t.cornerLeftBottomCellStyle)return this._cornerLeftBottomCell;const n=$t({},this.defaultStyle,e.cornerLeftBottomCellStyle,t.cornerLeftBottomCellStyle);this._cornerLeftBottomCell=this.getStyle(n)}return this._cornerLeftBottomCell}get cornerRightBottomCellStyle(){if(!this._cornerRightBottomCell){const{obj:t,superTheme:e}=this.internalTheme;if(!e.cornerRightBottomCellStyle&&!t.cornerRightBottomCellStyle)return this._cornerRightBottomCell;const n=$t({},this.defaultStyle,e.cornerRightBottomCellStyle,t.cornerRightBottomCellStyle);this._cornerRightBottomCell=this.getStyle(n)}return this._cornerRightBottomCell}get rightFrozenStyle(){if(!this._rightFrozen){const{obj:t,superTheme:e}=this.internalTheme;if(!e.rightFrozenStyle&&!t.rightFrozenStyle)return this._rightFrozen;const n=$t({},this.defaultStyle,this.rowHeaderStyle,e.rightFrozenStyle,t.rightFrozenStyle);this._rightFrozen=this.getStyle(n)}return this._rightFrozen}get bottomFrozenStyle(){if(!this._bottomFrozen){const{obj:t,superTheme:e}=this.internalTheme;if(!e.bottomFrozenStyle&&!t.bottomFrozenStyle)return this._bottomFrozen;const n=$t({},this.defaultStyle,this.headerStyle,e.bottomFrozenStyle,t.bottomFrozenStyle);this._bottomFrozen=this.getStyle(n)}return this._bottomFrozen}get rowHeaderStyle(){var t;if(!this._rowHeader){const{obj:e,superTheme:n}=this.internalTheme,o=$t({},this.defaultStyle,n.rowHeaderStyle,(t=e.rowHeaderStyle)!==null&&t!==void 0?t:this.isPivot?null:e.headerStyle);this._rowHeader=this.getStyle(o)}return this._rowHeader}get headerStyle(){if(!this._header){const{obj:t,superTheme:e}=this.internalTheme,n=$t({},this.defaultStyle,e.headerStyle,t.headerStyle);this._header=this.getStyle(n)}return this._header}get bodyStyle(){if(!this._body){const{obj:t,superTheme:e}=this.internalTheme,n=$t({},this.defaultStyle,e.bodyStyle,t.bodyStyle);this._body=this.getStyle(n)}return this._body}get groupTitleStyle(){if(!this._groupTitle){const{obj:t,superTheme:e}=this.internalTheme;if(!e.groupTitleStyle&&!t.groupTitleStyle)return this._groupTitle;const n=$t({},this.defaultStyle,e.groupTitleStyle,t.groupTitleStyle);this._groupTitle=this.getStyle(n)}return this._groupTitle}get frameStyle(){if(!this._frameStyle){const{obj:t,superTheme:e}=this.internalTheme,n=$t({},e.frameStyle,t.frameStyle);this._frameStyle={get borderColor(){return n.borderColor},get borderLineWidth(){return n.borderLineWidth},get borderLineDash(){return n.borderLineDash},get innerBorder(){return n.innerBorder},get shadowBlur(){return n.shadowBlur},get shadowColor(){return n.shadowColor},get shadowOffsetX(){return n.shadowOffsetX},get shadowOffsetY(){return n.shadowOffsetY},get cornerRadius(){return n.cornerRadius}}}return this._frameStyle}get scrollStyle(){if(!this._scroll){const{obj:t,superTheme:e}=this.internalTheme,n=$t({},e.scrollStyle,t.scrollStyle);this._scroll={get scrollSliderColor(){var o;return(o=n.scrollSliderColor)!==null&&o!==void 0?o:"#C0C0C0"},get scrollSliderCornerRadius(){return n.scrollSliderCornerRadius},get scrollRailColor(){return n.scrollRailColor},get visible(){var o;return(o=n.visible)!==null&&o!==void 0?o:"scrolling"},get verticalVisible(){return n.verticalVisible},get horizontalVisible(){return n.horizontalVisible},get width(){var o;return(o=n.width)!==null&&o!==void 0?o:7},get hoverOn(){var o;return(o=n.hoverOn)===null||o===void 0||o},get barToSide(){var o;return(o=n.barToSide)!==null&&o!==void 0&&o},get horizontalPadding(){var o;return(o=n.horizontalPadding)!==null&&o!==void 0?o:0},get verticalPadding(){var o;return(o=n.verticalPadding)!==null&&o!==void 0?o:0}}}return this._scroll}get tooltipStyle(){if(!this._tooltip){const{obj:t,superTheme:e}=this.internalTheme,n=$t({},e.tooltipStyle,t.tooltipStyle);this._tooltip={get fontFamily(){var o;return(o=n.fontFamily)!==null&&o!==void 0?o:Lv},get fontSize(){var o;return(o=n.fontSize)!==null&&o!==void 0?o:Ev},get bgColor(){var o;return(o=n.bgColor)!==null&&o!==void 0?o:"#000"},get padding(){var o;return(o=n.padding)!==null&&o!==void 0?o:[6,8]},get color(){var o;return(o=n.color)!==null&&o!==void 0?o:"#FFF"},get maxWidth(){return n.maxWidth},get maxHeight(){return n.maxHeight}}}return this._tooltip}get columnResize(){if(!this._columnResize){const{obj:t,superTheme:e}=this.internalTheme,n=$t({},e.columnResize,t.columnResize);this._columnResize={get lineColor(){var o;return(o=n.lineColor)!==null&&o!==void 0?o:"#416EFF"},get bgColor(){var o;return(o=n.bgColor)!==null&&o!==void 0?o:"#D9E2FF"},get lineWidth(){var o;return(o=n.lineWidth)!==null&&o!==void 0?o:1},get width(){var o;return(o=n.width)!==null&&o!==void 0?o:n.lineWidth+2},get resizeHotSpotSize(){var o;return(o=n.resizeHotSpotSize)!==null&&o!==void 0?o:16},get labelColor(){var o;return(o=n.labelColor)!==null&&o!==void 0?o:"#FFF"},get labelFontSize(){var o;return(o=n.labelFontSize)!==null&&o!==void 0?o:10},get labelFontFamily(){var o;return(o=n.labelFontFamily)!==null&&o!==void 0?o:"sans-serif"},get labelBackgroundFill(){var o;return(o=n.labelBackgroundFill)!==null&&o!==void 0?o:"#3073F2"},get labelBackgroundCornerRadius(){var o;return(o=n.labelBackgroundCornerRadius)!==null&&o!==void 0?o:5},get labelVisible(){var o;return(o=n.labelVisible)===null||o===void 0||o},get visibleOnHover(){var o;return(o=n.visibleOnHover)!==null&&o!==void 0&&o}}}return this._columnResize}get dragHeaderSplitLine(){if(!this._dragHeaderSplitLine){const{obj:t,superTheme:e}=this.internalTheme,n=$t({},e.dragHeaderSplitLine,t.dragHeaderSplitLine);this._dragHeaderSplitLine={get lineColor(){var o;return(o=n.lineColor)!==null&&o!==void 0?o:"blue"},get lineWidth(){var o;return(o=n.lineWidth)!==null&&o!==void 0?o:2},get shadowBlockColor(){var o;return(o=n.shadowBlockColor)!==null&&o!==void 0?o:"rgba(204,204,204,0.3)"}}}return this._dragHeaderSplitLine}get frozenColumnLine(){if(!this._frozenColumnLine){const{obj:t,superTheme:e}=this.internalTheme,n=$t({},e.frozenColumnLine,t.frozenColumnLine);this._frozenColumnLine={get shadow(){if(n.shadow)return{get width(){var o,r;return(r=(o=n.shadow)===null||o===void 0?void 0:o.width)!==null&&r!==void 0?r:24},get startColor(){var o,r;return(r=(o=n.shadow)===null||o===void 0?void 0:o.startColor)!==null&&r!==void 0?r:"rgba(00, 24, 47, 0.06)"},get endColor(){var o,r;return(r=(o=n.shadow)===null||o===void 0?void 0:o.endColor)!==null&&r!==void 0?r:"rgba(00, 24, 47, 0)"}}},get border(){if(n.border)return{get lineColor(){var o,r;return(r=(o=n.border)===null||o===void 0?void 0:o.lineColor)!==null&&r!==void 0?r:"rgba(00, 24, 47, 0.06)"},get bgColor(){var o,r,s,l;return(l=(r=(o=n.border)===null||o===void 0?void 0:o.bgColor)!==null&&r!==void 0?r:(s=n.border)===null||s===void 0?void 0:s.lineColor)!==null&&l!==void 0?l:"rgba(00, 24, 47, 0.06)"},get lineWidth(){var o,r;return(r=(o=n.border)===null||o===void 0?void 0:o.lineWidth)!==null&&r!==void 0?r:4},get width(){var o,r,s,l;return(l=(r=(o=n.border)===null||o===void 0?void 0:o.width)!==null&&r!==void 0?r:(s=n.border)===null||s===void 0?void 0:s.lineWidth)!==null&&l!==void 0?l:4}}}}}return this._frozenColumnLine}get selectionStyle(){if(!this._selectionStyle){const{obj:t,superTheme:e}=this.internalTheme,n=$t({},e.selectionStyle,t.selectionStyle);this._selectionStyle={get cellBgColor(){var o;return(o=n==null?void 0:n.cellBgColor)!==null&&o!==void 0?o:"rgba(0, 0, 255,0.1)"},get cellBorderColor(){var o;return(o=n==null?void 0:n.cellBorderColor)!==null&&o!==void 0?o:"#3073f2"},get cellBorderLineWidth(){var o;return(o=n==null?void 0:n.cellBorderLineWidth)!==null&&o!==void 0?o:2},get inlineColumnBgColor(){return n==null?void 0:n.inlineColumnBgColor},get inlineRowBgColor(){return n==null?void 0:n.inlineRowBgColor},get selectionFillMode(){var o;return(o=n==null?void 0:n.selectionFillMode)!==null&&o!==void 0?o:"overlay"}}}return this._selectionStyle}get axisStyle(){if(!this._axisStyle){const{obj:t,superTheme:e}=this.internalTheme,n=$t({},e.axisStyle,t.axisStyle);this._axisStyle=J2(n)}return this._axisStyle}get checkboxStyle(){if(!this._checkboxStyle){const{obj:t,superTheme:e}=this.internalTheme,n=$t({},e.checkboxStyle,t.checkboxStyle);this._checkboxStyle=n}return this._checkboxStyle}get radioStyle(){if(!this._radioStyle){const{obj:t,superTheme:e}=this.internalTheme,n=$t({},e.radioStyle,t.radioStyle);this._radioStyle=n}return this._radioStyle}get switchStyle(){if(!this._switchStyle){const{obj:t,superTheme:e}=this.internalTheme,n=$t({},e.switchStyle,t.switchStyle);this._switchStyle=n}return this._switchStyle}get buttonStyle(){if(!this._buttonStyle){const{obj:t,superTheme:e}=this.internalTheme,n=$t({},e.buttonStyle,t.buttonStyle);this._buttonStyle=n}return this._buttonStyle}get textPopTipStyle(){if(!this._textPopTipStyle){const{obj:t,superTheme:e}=this.internalTheme,n=$t({},Q2,e.textPopTipStyle,t.textPopTipStyle);this._textPopTipStyle=n}return this._textPopTipStyle}get functionalIconsStyle(){if(!this._internalIconsStyle){const{obj:t,superTheme:e}=this.internalTheme,n=$t({},e.functionalIconsStyle,t.functionalIconsStyle);this._internalIconsStyle=n}return this._internalIconsStyle}hasProperty(t){const{obj:e,superTheme:n}=this.internalTheme;return Fv(e,t)||Fv(n,t)}extends(t){return new di($t({},t),$t(this.internalTheme.superTheme,this.internalTheme.obj))}getStyle(t){const e=this;return{get fontSize(){return t.fontSize},get fontFamily(){return t.fontFamily},get fontWeight(){return t.fontWeight},get fontVariant(){return t.fontVariant},get fontStyle(){return t.fontStyle},get bgColor(){return t.bgColor},get color(){return t.color},get strokeColor(){return t.strokeColor},get borderColor(){return t.borderColor},get borderLineWidth(){return t.borderLineWidth},get borderLineDash(){return t.borderLineDash},get hover(){if(t.hover)return{get cellBgColor(){var n,o;return(o=(n=t.hover)===null||n===void 0?void 0:n.cellBgColor)!==null&&o!==void 0?o:void 0},get inlineColumnBgColor(){var n,o,r,s,l,a;return(a=(o=(n=t.hover)===null||n===void 0?void 0:n.inlineColumnBgColor)!==null&&o!==void 0?o:!((r=t.hover)===null||r===void 0)&&r.cellBgColor&&typeof((s=t.hover)===null||s===void 0?void 0:s.cellBgColor)=="string"?Ln((l=t.hover)===null||l===void 0?void 0:l.cellBgColor,.1):void 0)!==null&&a!==void 0?a:void 0},get inlineRowBgColor(){var n,o,r,s,l,a;return(a=(o=(n=t.hover)===null||n===void 0?void 0:n.inlineRowBgColor)!==null&&o!==void 0?o:!((r=t.hover)===null||r===void 0)&&r.cellBgColor&&typeof((s=t.hover)===null||s===void 0?void 0:s.cellBgColor)=="string"?Ln((l=t.hover)===null||l===void 0?void 0:l.cellBgColor,.1):void 0)!==null&&a!==void 0?a:void 0}}},get select(){return{get inlineColumnBgColor(){var n,o,r,s,l,a;return(a=(s=(o=(n=t.select)===null||n===void 0?void 0:n.inlineColumnBgColor)!==null&&o!==void 0?o:(r=e.selectionStyle)===null||r===void 0?void 0:r.inlineColumnBgColor)!==null&&s!==void 0?s:!((l=e.selectionStyle)===null||l===void 0)&&l.cellBgColor&&typeof e.selectionStyle.cellBgColor=="string"?Ln(e.selectionStyle.cellBgColor,.1):void 0)!==null&&a!==void 0?a:void 0},get inlineRowBgColor(){var n,o,r,s,l;return(l=(r=(o=(n=t.select)===null||n===void 0?void 0:n.inlineRowBgColor)!==null&&o!==void 0?o:e.selectionStyle.inlineRowBgColor)!==null&&r!==void 0?r:!((s=e.selectionStyle)===null||s===void 0)&&s.cellBgColor&&typeof e.selectionStyle.cellBgColor=="string"?Ln(e.selectionStyle.cellBgColor,.1):void 0)!==null&&l!==void 0?l:void 0},get cellBgColor(){var n,o,r;if(e.selectionStyle.selectionFillMode==="replace")return(r=(o=(n=t.select)===null||n===void 0?void 0:n.cellBgColor)!==null&&o!==void 0?o:e.selectionStyle.cellBgColor)!==null&&r!==void 0?r:void 0}}},get frameStyle(){if(t.frameStyle)return{get borderColor(){var n,o;return(o=(n=t.frameStyle)===null||n===void 0?void 0:n.borderColor)!==null&&o!==void 0?o:void 0},get borderLineWidth(){var n,o;return(o=(n=t.frameStyle)===null||n===void 0?void 0:n.borderLineWidth)!==null&&o!==void 0?o:void 0},get borderLineDash(){var n,o;return(o=(n=t.frameStyle)===null||n===void 0?void 0:n.borderLineDash)!==null&&o!==void 0?o:void 0}}},get padding(){return t.padding},get textAlign(){return t.textAlign},get textBaseline(){return t.textBaseline},get textOverflow(){return t.textOverflow},get lineHeight(){return t.lineHeight},get autoWrapText(){return t.autoWrapText},get lineClamp(){return t.lineClamp},get linkColor(){return t.linkColor},get cursor(){return t.cursor},get textStick(){return t.textStick},get marked(){return t.marked},get underline(){var n;return(n=t.underline)!==null&&n!==void 0&&n},get underlineColor(){return t.underlineColor},get underlineDash(){return t.underlineDash},get underlineOffset(){return t.underlineOffset},get lineThrough(){var n;return(n=t.lineThrough)!==null&&n!==void 0&&n},get lineThroughColor(){return t.lineThroughColor},get lineThroughDash(){return t.lineThroughDash}}}}function Fv(i,t){if(i instanceof di)return i.hasProperty(t);let e=i;if(!e)return!1;for(let n=0;n<t.length;n++)if(e=e[t[n]],!e)return!1;return!!e}const H_=new di(Mv,Mv),k_=new di(Tv,Tv),E_=new di(Pv,Pv),L_=new di(Hv,Hv),F_=new di(kv,kv),tH={DEFAULT:L_,SIMPLIFY:F_,ARCO:E_,DARK:H_,BRIGHT:k_},eH={TableTheme:di};function iH(i){if(!i)return null;if(typeof i=="string"){const t=R2(z_(),i);return t?t instanceof di?t:new di(t,t):null}return i instanceof di?i:new di(i,i)}function z_(){return dl(tH,G2)}const Fn={DARK:H_,BRIGHT:k_,ARCO:E_,DEFAULT:L_,SIMPLIFY:F_,theme:eH,of:iH,get:z_};function ae(i,t,e){var n;if(i.internalProps.customMergeCell){const r=i.getCustomMerge(t,e);if(r)return r.range}if(!i.internalProps.enableTreeNodeMerge&&!i.isHeader(t,e)&&!(!((n=i.getBodyColumnDefine(t,e))===null||n===void 0)&&n.mergeCell))return!1;const o=i.getCellRange(t,e);return!(o.start.col===o.end.col&&o.start.row===o.end.row)&&o}class ut{static registerComponent(t,e){ut._components[t]=e}static getComponent(t){return ut._components[t]}static registerFunction(t,e){ut._functions[t]=e}static getFunction(t){return ut._functions[t]}static registerCellType(t,e){ut._cellTypes[t]=e}static getCellType(t){return ut._cellTypes[t]}}ut._components={},ut._functions={},ut._cellTypes={};function nH(i,t){const e=new Array(t);for(let n=0;n<t;n++)e[n]=i(n);return e}function oH(i,t,e,n,o,r){const s=nH(i,e);s.sort((l,a)=>n(r(l),r(a),o));for(let l=0;l<e;l++)t(l,s[l])}function rH(i){if(T_.isObject(i)){const t=i;if(O(t.get)&&O(t.set))return!0}return!1}const Wl={SOURCE_LENGTH_UPDATE:"source_length_update",CHANGE_ORDER:"change_order"};function jn(i,t){const e=zt(i);if(ji(e)){const n=e.then(o=>(t(o),o));return t(n),n}return e}function hh(i,t,e,n,o,r){if(i==null)return;if(ji(i))return i.then(a=>hh(a,t,e,n,o,r));const s=rH(t)?t.get:t;if(kt(i)&&s in i)return jn(i[s],r);if(typeof s=="function")return jn(s(i,e,n,o),r);if(Array.isArray(s))return jn(m2(i,[...s]),r);const l=`${s}`.split(".");return l.length<=1?jn(i[s],r):jn(B_(i,(a,h)=>hh(a,h,e,n,o,H2),...l),r)}function $o(i,t){if(!i)return t;const e=i[t];return O(e)?e:t}class Lo extends md{static get EVENT_TYPE(){return Wl}constructor(t,e,n,o,r,s){var l;super(),this.currentIndexedData=[],this.hierarchyExpandLevel=0,this.hasHierarchyStateExpand=!1,this.beforeChangedRecordsMap=new Map,this.registedAggregators={},this.rowHierarchyType="grid",this.fieldAggregators=[],this.registerAggregators(),this.dataSourceObj=t,this.dataConfig=e,this._get=t==null?void 0:t.get,this.columns=o,this._source=t!=null&&t.records?this.processRecords(t==null?void 0:t.records):t,this._sourceLength=((l=this._source)===null||l===void 0?void 0:l.length)||0,this.sortedIndexMap=new Map,this._currentPagerIndexedData=[],this.userPagination=n,this.pagination=n||{totalCount:this._sourceLength,perPageCount:this._sourceLength,currentPage:0},s>=1&&(this.hierarchyExpandLevel=s),this.currentIndexedData=Array.from({length:this._sourceLength},(a,h)=>h),r==="tree"&&this.initTreeHierarchyState(),this.rowHierarchyType=r,this.updatePagerData()}initTreeHierarchyState(){var t;this.currentIndexedData=Array.from({length:this._sourceLength},(n,o)=>o);let e=this._sourceLength;for(let n=0;n<e;n++){const o=this.currentIndexedData[n],r=this.getOriginalRecord(o),s=(t=r.filteredChildren)!==null&&t!==void 0?t:r.children;if((s==null?void 0:s.length)>0){if(this.hierarchyExpandLevel>1?!r.hierarchyState&&(r.hierarchyState=mt.expand):!r.hierarchyState&&(r.hierarchyState=mt.collapse),this.hasHierarchyStateExpand=!0,r.hierarchyState===mt.collapse)continue;const l=this.initChildrenNodeHierarchy(o,this.hierarchyExpandLevel,2,r);n+=l,e+=l}else r.children===!0&&!r.hierarchyState&&(r.hierarchyState=mt.collapse)}}supplementConfig(t,e,n,o){var r;this.columns=e,this._sourceLength=((r=this._source)===null||r===void 0?void 0:r.length)||0,this.sortedIndexMap=new Map,this._currentPagerIndexedData=[],this.userPagination=t,this.pagination=t||{totalCount:this._sourceLength,perPageCount:this._sourceLength,currentPage:0},o>=1&&(this.hierarchyExpandLevel=o),this.currentIndexedData=Array.from({length:this._sourceLength},(s,l)=>l),n==="tree"&&this.initTreeHierarchyState(),this.rowHierarchyType=n,this.updatePagerData()}registerAggregator(t,e){this.registedAggregators[t]=e}registerAggregators(){this.registerAggregator(Zt.RECORD,KP),this.registerAggregator(Zt.SUM,qP),this.registerAggregator(Zt.COUNT,ZP),this.registerAggregator(Zt.MAX,QP),this.registerAggregator(Zt.MIN,t2),this.registerAggregator(Zt.AVG,JP),this.registerAggregator(Zt.NONE,YP),this.registerAggregator(Zt.CUSTOM,XP)}updateColumns(t){this.columns=t}_generateFieldAggragations(){const t=this.columns;this.fieldAggregators=[];const e=o=>{delete o.vtable_aggregator;const r=o.field,s=o.aggregation;if(s)if(Array.isArray(s))for(const l of s){const a=new this.registedAggregators[l.aggregationType]({field:r,formatFun:l.formatFun,isRecord:!0,aggregationFun:l.aggregationFun});this.fieldAggregators.push(a),o.vtable_aggregator||(o.vtable_aggregator=[]),o.vtable_aggregator.push(a)}else{const l=new this.registedAggregators[s.aggregationType]({field:r,formatFun:s.formatFun,isRecord:!0,aggregationFun:s.aggregationFun});this.fieldAggregators.push(l),o.vtable_aggregator=l}},n=o=>{if(o&&o.length!==0)for(const r of o)e(r),r.columns&&n(r.columns)};n(t)}processRecords(t){var e,n,o,r,s,l,a,h;this._generateFieldAggragations();const d=[],u=this.fieldAggregators.length>=1;if(((n=(e=this.dataConfig)===null||e===void 0?void 0:e.filterRules)===null||n===void 0?void 0:n.length)>=1||((o=this.lastFilterRules)===null||o===void 0?void 0:o.length)>=1||u){for(let c=0,f=t.length;c<f;c++){const g=t[c];((s=(r=this.dataConfig)===null||r===void 0?void 0:r.filterRules)===null||s===void 0?void 0:s.length)>=1?this.filterRecord(g)&&(d.push(g),this.rowHierarchyType==="tree"&&g.children&&(g.filteredChildren=this.filteredChildren(g.children)),u&&this.processRecord(g)):((l=this.lastFilterRules)===null||l===void 0?void 0:l.length)>=1?(this.clearFilteredChildren(g),u&&this.processRecord(g)):u&&this.processRecord(g)}if(((h=(a=this.dataConfig)===null||a===void 0?void 0:a.filterRules)===null||h===void 0?void 0:h.length)>=1)return d}return t}filteredChildren(t){const e=[];for(let n=0,o=t.length;n<o;n++){const r=t[n];this.filterRecord(r)&&(e.push(r),r.children&&(r.filteredChildren=this.filteredChildren(r.children)))}return e}processRecord(t){for(let e=0;e<this.fieldAggregators.length;e++)this.fieldAggregators[e].push(t)}initChildrenNodeHierarchy(t,e,n,o){var r,s,l;let a=0;const h=o.filteredChildren?o.filteredChildren.length:(s=(r=o.children)===null||r===void 0?void 0:r.length)!==null&&s!==void 0?s:0;for(let d=0;d<h;d++){(n<=e||o.hierarchyState===mt.expand)&&(a+=1);const u=o.filteredChildren?o.filteredChildren[d]:o.children[d],c=Array.isArray(t)?t.concat(d):[t,d];(n<=e||o.hierarchyState===mt.expand)&&this.currentIndexedData.splice(this.currentIndexedData.indexOf(t)+a,0,c),(u.filteredChildren?u.filteredChildren.length>0:((l=u.children)===null||l===void 0?void 0:l.length)>0)&&(n<e||u.hierarchyState===mt.expand?(!u.hierarchyState&&(u.hierarchyState=mt.expand),this.hasHierarchyStateExpand=!0):!u.hierarchyState&&(u.hierarchyState=mt.collapse)),u.hierarchyState===mt.expand&&(a+=this.initChildrenNodeHierarchy(c,e,n+1,u)),u.children===!0&&!u.hierarchyState&&(u.hierarchyState=mt.collapse)}return a}updatePagination(t){this.pagination=t||{totalCount:this._sourceLength,perPageCount:this._sourceLength,currentPage:0},this.updatePagerData()}updatePagerData(){const{currentIndexedData:t}=this,{perPageCount:e,currentPage:n}=this.pagination,o=e*(n||0),r=o+e;if(this._currentPagerIndexedData.length=0,t&&t.length>0){let s=-1;for(let l=0;l<t.length;l++)if((Array.isArray(t[l])&&t[l].length===1||!Array.isArray(t[l]))&&s++,s>=o&&s<r)this._currentPagerIndexedData.push(t[l]);else if(s>=r)break}else if(this._sourceLength>0)throw new Error("currentIndexedData should has values!")}getRecordIndexPaths(t){return this._currentPagerIndexedData[t]}get records(){return Array.isArray(this._source)?this._source:[]}get source(){return this._source}get(t){return this.getOriginalRecord($o(this.currentPagerIndexedData,t))}getRaw(t){return this.getRawRecord($o(this.currentPagerIndexedData,t))}getIndexKey(t){return $o(this.currentPagerIndexedData,t)}getTableIndex(t){return Array.isArray(t)?this.rowHierarchyType==="tree"?this.currentPagerIndexedData.findIndex(e=>rs(e,t)):this.currentPagerIndexedData.findIndex(e=>e===t[0]):this.currentPagerIndexedData.findIndex(e=>e===t)}getField(t,e,n,o,r){return this.getOriginalField($o(this.currentPagerIndexedData,t),e,n,o,r)}getRawField(t,e,n,o,r){return this.getRawFieldData($o(this.currentPagerIndexedData,t),e,n,o,r)}hasField(t,e){return this.hasOriginalField($o(this.currentPagerIndexedData,t),e)}getHierarchyState(t){var e;const n=this.getOriginalRecord(this.currentPagerIndexedData[t]);if(n!=null&&n.hierarchyState){const o=n.hierarchyState;if(((e=n.children)===null||e===void 0?void 0:e.length)>0||n.children===!0)return o}return null}toggleHierarchyState(t,e,n){const o=this.currentIndexedData.slice(0),r=this.getIndexKey(t),s=this.getHierarchyState(t),l=this.getOriginalRecord(r);if(this.clearSortedIndexMap(),s===mt.collapse)l.hierarchyState=mt.expand,this.pushChildrenNode(r,mt.expand,l),this.hasHierarchyStateExpand=!0;else if(s===mt.expand){let d=0;const u=(c,f,g)=>{if(!f||f===mt.collapse||f===mt.none)return;const p=g.filteredChildren?g.filteredChildren:g.children;if(p)for(let v=0;v<p.length;v++){d+=1;const m=Array.isArray(c)?c.concat([v]):[c,v];u(m,p[v].hierarchyState,p[v])}};u(r,s,l),this.currentIndexedData.splice(this.currentIndexedData.indexOf(r)+1,d),l.hierarchyState=mt.collapse}this.updatePagerData();const a=[],h=[];if(s===mt.collapse){const d=this.currentIndexedData.length-o.length;for(let u=0;u<d;u++)a.push(t+u+1)}else if(s===mt.expand){const d=o.length-this.currentIndexedData.length;for(let u=0;u<d;u++)h.push(t+u+1)}return{add:a,remove:h}}pushChildrenNode(t,e,n){var o,r;if(!e||e===mt.collapse||e===mt.none)return 0;let s=0;const l=n.filteredChildren?n.filteredChildren:n.children;if(l){const a=Array.from({length:l.length},(h,d)=>d);(o=this.lastSortStates)===null||o===void 0||o.forEach(h=>{h.order!=="normal"&&oH(d=>O(a[d])?a[d]:a[d]=d,(d,u)=>{a[d]=u},l.length,h.orderFn,h.order,d=>this.getOriginalField(Array.isArray(t)?t.concat([d]):[t,d],h.field))});for(let h=0;h<a.length;h++){s+=1;const d=Array.isArray(t)?t.concat([a[h]]):[t,a[h]];this.currentIndexedData.splice(this.currentIndexedData.indexOf(t)+s,0,d);const u=this.getOriginalRecord(d);!u.hierarchyState&&((r=u.filteredChildren)!==null&&r!==void 0?r:u.children)&&(u.hierarchyState=mt.collapse),s+=this.pushChildrenNode(d,u.hierarchyState,l[a[h]])}}return s}changeFieldValue(t,e,n,o,r,s){var l;if(n!==null&&e>=0){const a=this.getIndexKey(e);if(this.cacheBeforeChangedRecord(a,s),typeof n=="string"||typeof n=="number"){const h=(l=this.beforeChangedRecordsMap.get(a.toString()))===null||l===void 0?void 0:l[n],d=this.getOriginalRecord(a);let u=t;typeof h=="number"&&b2(t)&&(u=parseFloat(t)),ji(d)?d.then(c=>{c[n]=u}).catch(c=>{}):d?d[n]=u:(this.records[a]={},this.records[a][n]=u)}}}cacheBeforeChangedRecord(t,e){var n;if(!this.beforeChangedRecordsMap.has(t.toString())){const o=this.getOriginalRecord(t);this.beforeChangedRecordsMap.set(t.toString(),(n=Do(o,void 0,["vtable_gantt_linkedFrom","vtable_gantt_linkedTo"]))!==null&&n!==void 0?n:{})}}setRecord(t,e){var n,o;let r=!0;if(((o=(n=this.dataConfig)===null||n===void 0?void 0:n.filterRules)===null||o===void 0?void 0:o.length)>=1&&(this.filterRecord(t)?this.rowHierarchyType==="tree"&&t.children&&(t.filteredChildren=this.filteredChildren(t.children)):r=!1),r&&Array.isArray(this.records)){const s=this.getIndexKey(e);Array.isArray(s)||this.records.splice(s,1,t)}}addRecord(t,e){var n;if(Array.isArray(this.records)){this.records.splice(e,0,t),this.adjustBeforeChangedRecordsMap(e,1),this.currentIndexedData.push(this.currentIndexedData.length),this._sourceLength+=1;for(let o=0;o<this.fieldAggregators.length;o++)this.fieldAggregators[o].push(t);if(this.rowHierarchyType==="tree"&&this.initTreeHierarchyState(),this.userPagination){this.pagination.totalCount=this._sourceLength;const{perPageCount:o,currentPage:r}=this.pagination;e<o*(r||0)+o&&this.updatePagerData()}else this.pagination.perPageCount=this._sourceLength,this.pagination.totalCount=this._sourceLength,this.updatePagerData();!((n=this.dataSourceObj)===null||n===void 0)&&n.added&&this.dataSourceObj.added(e,1)}}addRecords(t,e){var n;if(Array.isArray(this.records)){if(Array.isArray(t)){this.records.splice(e,0,...t),this.adjustBeforeChangedRecordsMap(e,t.length);for(let o=0;o<t.length;o++)this.currentIndexedData.push(this.currentIndexedData.length);this._sourceLength+=t.length;for(let o=0;o<this.fieldAggregators.length;o++)for(let r=0;r<t.length;r++)this.fieldAggregators[o].push(t[r])}if(this.userPagination){this.pagination.totalCount=this._sourceLength;const{perPageCount:o,currentPage:r}=this.pagination;e<o*(r||0)+o&&this.updatePagerData()}else this.pagination.perPageCount=this._sourceLength,this.pagination.totalCount=this._sourceLength,this.updatePagerData();!((n=this.dataSourceObj)===null||n===void 0)&&n.added&&this.dataSourceObj.added(e,t.length)}}addRecordForSorted(t){Array.isArray(this.records)&&(this.beforeChangedRecordsMap.clear(),this.records.push(t),this.currentIndexedData.push(this.currentIndexedData.length),this._sourceLength+=1,this.sortedIndexMap.clear(),this.userPagination||(this.pagination.perPageCount=this._sourceLength,this.pagination.totalCount=this._sourceLength))}addRecordsForSorted(t){if(Array.isArray(this.records)){if(this.beforeChangedRecordsMap.clear(),Array.isArray(t)){this.records.push(...t);for(let e=0;e<t.length;e++)this.currentIndexedData.push(this.currentIndexedData.length);this._sourceLength+=t.length,this.sortedIndexMap.clear()}this.userPagination||(this.pagination.perPageCount=this._sourceLength,this.pagination.totalCount=this._sourceLength)}}adjustBeforeChangedRecordsMap(t,e,n="add"){for(let o=this.beforeChangedRecordsMap.size-1;o>=t;o--){const r=this.beforeChangedRecordsMap.get(o.toString());this.beforeChangedRecordsMap.delete(o.toString()),this.beforeChangedRecordsMap.set((o+(n==="add"?e:-e)).toString(),r)}}deleteRecords(t){var e;if(Array.isArray(this.records)){const n=[],o=t.sort((r,s)=>s-r);for(let r=0;r<o.length;r++){const s=o[r];if(s>=this._sourceLength||s<0)continue;this.adjustBeforeChangedRecordsMap(s,1,"delete"),n.push(s);const l=this.records[s];for(let a=0;a<this.fieldAggregators.length;a++)this.fieldAggregators[a].deleteRecord(l);this.records.splice(s,1),this.currentIndexedData.pop(),this._sourceLength-=1}return this.userPagination||(this.pagination.perPageCount=this._sourceLength,this.pagination.totalCount=this._sourceLength),this.updatePagerData(),!((e=this.dataSourceObj)===null||e===void 0)&&e.deleted&&this.dataSourceObj.deleted(n),n}return[]}deleteRecordsForSorted(t){if(Array.isArray(this.records)){const e=t.sort((n,o)=>o-n);for(let n=0;n<e.length;n++){const o=e[n];if(o>=this._sourceLength||o<0)continue;const r=this.currentIndexedData[o];this.records.splice(r,1),this._sourceLength-=1}this.sortedIndexMap.clear(),this.userPagination||(this.pagination.perPageCount=this._sourceLength,this.pagination.totalCount=this._sourceLength),this.beforeChangedRecordsMap.clear()}}updateRecords(t,e){const n=[];for(let o=0;o<e.length;o++){const r=e[o];if(Array.isArray(r))this.beforeChangedRecordsMap.delete(r.toString()),n.push(r),r.slice(0,-1).reduce((s,l)=>(s[l]===void 0&&(s[l]={}),s[l].children),this.records)[r[r.length-1]]=t[o];else{if(r>=this._sourceLength||r<0)continue;this.beforeChangedRecordsMap.delete(r.toString()),n.push(r);for(let s=0;s<this.fieldAggregators.length;s++)this.fieldAggregators[s].updateRecord(this.records[r],t[o]);this.records[r]=t[o]}}return this.userPagination&&this.updatePagerData(),n}updateRecordsForSorted(t,e){for(let n=0;n<e.length;n++){const o=e[n];if(o>=this._sourceLength||o<0)continue;const r=this.currentIndexedData[o];if(typeof r!="number")return;this.beforeChangedRecordsMap.delete(r.toString()),this.records[r]=t[n]}this.sortedIndexMap.clear()}sort(t){t=(Array.isArray(t)?t:[t]).filter(r=>{const s=this.columns.find(l=>l.field===r.field);return(s==null?void 0:s.sort)!==!1&&r.order!=="normal"}),this.lastSortStates=t;let e=t.map(r=>this.sortedIndexMap.get(r==null?void 0:r.field)||{asc:[],desc:[],normal:[]}),n=null;if(e.length>0&&(n=t.reduce((r,s,l)=>{var a;const h=(a=e[l])===null||a===void 0?void 0:a[s.order];return h&&h.length>0?h:r},null),n&&n.length>0))return this.currentIndexedData=n,this.updatePagerData(),void this.fireListeners(Wl.CHANGE_ORDER,null);const o=Array.from({length:this._sourceLength},(r,s)=>s);if(o.sort((r,s)=>t.reduce((l,a)=>l!==0?l:(a.orderFn||(a.order!=="desc"?(h,d)=>h===d?0:h>d?1:-1:(h,d)=>h===d?0:h<d?1:-1))(this.getOriginalField(r,a.field),this.getOriginalField(s,a.field),a.order),0)),this.currentIndexedData=o,this.hierarchyExpandLevel){let r=o.length;for(let s=0;s<r;s++){const l=this.getOriginalRecord(o[s]),a=this.pushChildrenNode(o[s],l.hierarchyState,this.getOriginalRecord(o[s]));r+=a,s+=a}}if(!e.length){e=t.map(()=>({asc:[],desc:[],normal:[]}));for(let r=0;r<t.length;r++)this.sortedIndexMap.set(t[r].field,e[r])}t.forEach((r,s)=>{e[s][r.order]=o.slice()}),this.updatePagerData(),this.fireListeners(Wl.CHANGE_ORDER,null)}setSortedIndexMap(t,e){this.sortedIndexMap.set(t,e)}clearFilteredChildren(t){var e,n;t.filteredChildren=void 0;for(let o=0;o<((n=(e=t.children)===null||e===void 0?void 0:e.length)!==null&&n!==void 0?n:0);o++)this.clearFilteredChildren(t.children[o])}filterRecord(t){var e,n,o;let r=!0;for(let s=0;s<((e=this.dataConfig.filterRules)===null||e===void 0?void 0:e.length);s++){const l=(n=this.dataConfig)===null||n===void 0?void 0:n.filterRules[s];if(l.filterKey){const a=t[l.filterKey];if(l.filteredValues.indexOf(a)===-1){r=!1;break}}else if(!(!((o=l.filterFunc)===null||o===void 0)&&o.call(l,t))){r=!1;break}}return r}updateFilterRulesForSorted(t){var e,n,o;this.lastFilterRules=this.dataConfig.filterRules,this.dataConfig.filterRules=t,this._source=this.processRecords((n=(e=this.dataSourceObj)===null||e===void 0?void 0:e.records)!==null&&n!==void 0?n:this.dataSourceObj),this._sourceLength=((o=this._source)===null||o===void 0?void 0:o.length)||0,this.sortedIndexMap.clear(),this.currentIndexedData=Array.from({length:this._sourceLength},(r,s)=>s),this.userPagination||(this.pagination.perPageCount=this._sourceLength,this.pagination.totalCount=this._sourceLength)}updateFilterRules(t){var e,n,o;this.lastFilterRules=this.dataConfig.filterRules,this.dataConfig.filterRules=t,this._source=this.processRecords((n=(e=this.dataSourceObj)===null||e===void 0?void 0:e.records)!==null&&n!==void 0?n:this.dataSourceObj),this._sourceLength=((o=this._source)===null||o===void 0?void 0:o.length)||0,this.currentIndexedData=Array.from({length:this._sourceLength},(r,s)=>s),this.userPagination||(this.pagination.perPageCount=this._sourceLength,this.pagination.totalCount=this._sourceLength,this.rowHierarchyType==="tree"&&this.initTreeHierarchyState()),this.updatePagerData()}clearSortedIndexMap(){this.lastSortStates&&this.lastSortStates.length>0&&this.sortedIndexMap.forEach((t,e)=>{this.lastSortStates.some(n=>n.field===e)?this.lastSortStates.forEach(n=>{n.order==="asc"?(t.desc=[],t.normal=[]):n.order==="desc"?(t.asc=[],t.normal=[]):(t.asc=[],t.desc=[])}):this.sortedIndexMap.delete(e)})}get sourceLength(){return this._sourceLength}set sourceLength(t){this._sourceLength!==t&&(this._sourceLength=t,this.fireListeners(Wl.SOURCE_LENGTH_UPDATE,this._sourceLength))}get length(){return this.currentPagerIndexedData.length}get dataSource(){return this}get currentPagerIndexedData(){return this._currentPagerIndexedData.length>0?this._currentPagerIndexedData:[]}release(){var t;(t=super.release)===null||t===void 0||t.call(this),this.lastFilterRules=null}clearSortedMap(){this.currentIndexedData&&(this.currentIndexedData.length=0),this.currentIndexedData=null,this.sortedIndexMap.forEach(t=>{t.asc&&(t.asc.length=0),t.desc&&(t.desc.length=0)}),this.sortedIndexMap.clear()}clearCurrentIndexedData(){this.currentIndexedData=null,this.currentPagerIndexedData.length=0}getOriginalRecord(t){let e;return e=this.dataSourceObj.records?Array.isArray(t)?Vc(this.records,t):this.records[t]:this._get(t),jn(e,n=>{this.recordPromiseCallBack(t,n)})}getRawRecord(t){var e,n;if(!((e=this.beforeChangedRecordsMap)===null||e===void 0)&&e.has(t.toString()))return(n=this.beforeChangedRecordsMap)===null||n===void 0?void 0:n.get(t.toString());let o;return o=this.dataSourceObj.records?Array.isArray(t)?Vc(this.records,t):this.records[t]:this._get(t),jn(o,r=>{this.recordPromiseCallBack(t,r)})}getOriginalField(t,e,n,o,r){if(e!==null)return hh(this.getOriginalRecord(t),e,n,o,r,s=>{this.fieldPromiseCallBack(t,e,s)})}getRawFieldData(t,e,n,o,r){if(e!==null)return hh(this.getRawRecord(t),e,n,o,r,s=>{this.fieldPromiseCallBack(t,e,s)})}hasOriginalField(t,e){if(e===null)return!1;if(typeof e=="function")return!0;const n=this.getOriginalRecord(t);return!!(n&&e in n)}fieldPromiseCallBack(t,e,n){}recordPromiseCallBack(t,e){}canChangeOrder(t,e){var n;if(!((n=this.dataSourceObj)===null||n===void 0)&&n.canChangeOrder)return this.dataSourceObj.canChangeOrder(t,e);if(this.hasHierarchyStateExpand){let o=this.currentPagerIndexedData[t],r=this.currentPagerIndexedData[e];if(o=Array.isArray(o)?[...o]:[o],r=Array.isArray(r)?[...r]:[r],e>t&&r.length>o.length){let s=this.currentPagerIndexedData[e+1];s=Array.isArray(s)?[...s]:[s],s.length<r.length&&r.splice(r.length-1,1)}if(o.length===r.length){for(let s=0;s<=o.length-2;s++)if(o[s]!==r[s])return!1;return!0}return!1}return!0}changeOrder(t,e){var n,o,r;if(!((n=this.dataSourceObj)===null||n===void 0)&&n.changeOrder)this.dataSourceObj.changeOrder(t,e);else if(!(!((o=this.lastSortStates)===null||o===void 0)&&o.some(s=>s.order==="asc"||s.order==="desc"))&&this.canChangeOrder(t,e))if(this.hasHierarchyStateExpand){let s,l,a=this.currentPagerIndexedData[t],h=this.currentPagerIndexedData[e];if(a=Array.isArray(a)?[...a]:[a],h=Array.isArray(h)?[...h]:[h],a.length>1||h.length>1){if(e>t&&h.length>a.length){let d=this.currentPagerIndexedData[e+1];d=Array.isArray(d)?[...d]:[d],d.length<h.length&&h.splice(h.length-1,1)}if(s=a.splice(a.length-1,1)[0],l=h.splice(h.length-1,1)[0],a.length>=1){const d=this.getOriginalRecord(a),u=d.filteredChildren?d.filteredChildren.splice(s,1):d.children.splice(s,1);u.unshift(l,0),Array.prototype.splice.apply((r=d.filteredChildren)!==null&&r!==void 0?r:d.children,u)}else{const d=this.records.splice(s,1);d.unshift(l,0),Array.prototype.splice.apply(this.records,d)}}else{s=this.currentPagerIndexedData[t],l=this.currentPagerIndexedData[e];const d=this.records.splice(s,1);d.unshift(l,0),Array.prototype.splice.apply(this.records,d)}this.restoreTreeHierarchyState(),this.updatePagerData()}else{const s=this.records.splice(t,1);s.unshift(e,0),Array.prototype.splice.apply(this.records,s)}}restoreTreeHierarchyState(){var t,e;if(this.hierarchyExpandLevel){for(let o=0;o<this._sourceLength;o++){const r=this.getOriginalRecord(o);((t=r.filteredChildren)!==null&&t!==void 0?t:r.children)&&!r.hierarchyState&&(r.hierarchyState=mt.collapse)}this.currentIndexedData=Array.from({length:this._sourceLength},(o,r)=>r);let n=this._sourceLength;for(let o=0;o<n;o++){const r=this.currentIndexedData[o],s=this.getOriginalRecord(r),l=(e=s.filteredChildren)!==null&&e!==void 0?e:s.children;if((l==null?void 0:l.length)>0&&s.hierarchyState===mt.expand){this.hasHierarchyStateExpand=!0;const a=this.restoreChildrenNodeHierarchy(r,s);o+=a,n+=a}else s.children===!0&&!s.hierarchyState&&(s.hierarchyState=mt.collapse)}}}restoreChildrenNodeHierarchy(t,e){var n,o;let r=0;const s=(n=e.filteredChildren)!==null&&n!==void 0?n:e.children,l=(o=s==null?void 0:s.length)!==null&&o!==void 0?o:0;for(let a=0;a<l;a++){e.hierarchyState===mt.expand&&(r+=1);const h=s[a],d=Array.isArray(t)?t.concat(a):[t,a];e.hierarchyState===mt.expand&&this.currentIndexedData.splice(this.currentIndexedData.indexOf(t)+r,0,d),r+=this.restoreChildrenNodeHierarchy(d,h)}return r}}Lo.EMPTY=new Lo({get(){},length:0});function Vc(i,t){var e;let n=i;for(let o=0;o<t.length;o++){const r=t[o];if(!n[r])return;n=n[r];const s=(e=n.filteredChildren)!==null&&e!==void 0?e:n==null?void 0:n.children;s&&o+1<t.length&&(n=s)}return n}function zv(i,t){return i.sort((e,n)=>{var o,r;Z(e)&&(e=[e]),Z(n)&&(n=[n]);const s=Math.max(e.length,n.length);for(let l=0;l<s;l++){const a=(o=e[l])!==null&&o!==void 0?o:-1,h=(r=n[l])!==null&&r!==void 0?r:-1;if(a!==h)return h-a}return 0})}var sH=ky();const lH=Ob(sH);function aH(i,t,e,n){(i[t]||(i[t]=new Map)).set(e,n)}class wd extends Lo{static get EVENT_TYPE(){return Lo.EVENT_TYPE}static ofArray(t,e,n,o,r,s){return new wd({get:l=>t[l],length:t.length,records:t},e,n,o,r,s)}constructor(t,e,n,o,r,s){let l;Q(e==null?void 0:e.groupByRules)&&(r="tree",l=!0),super(t,e,n,o,r,s),this._isGrouped=l,this._recordCache=[],this._fieldCache={}}getOriginalRecord(t){return Z(t)&&this._recordCache&&this._recordCache[t]?this._recordCache[t]:super.getOriginalRecord(t)}getRawRecord(t){var e,n,o,r;let s,l;if(this._isGrouped){if(s=this.getOriginRecordIndexForGroup(t),O(s)&&((e=this.beforeChangedRecordsMap)===null||e===void 0?void 0:e.has(s.toString())))return(n=this.beforeChangedRecordsMap)===null||n===void 0?void 0:n.get(s.toString())}else if(!((o=this.beforeChangedRecordsMap)===null||o===void 0)&&o.has(t.toString()))return(r=this.beforeChangedRecordsMap)===null||r===void 0?void 0:r.get(t.toString());return Z(t)&&this._recordCache&&this._recordCache[t]?this._recordCache[t]:(l=this.dataSourceObj.records?Array.isArray(t)?Vc(this.records,t):this.records[t]:this._get(t),jn(l,a=>{this.recordPromiseCallBack(t,a)}))}getOriginalField(t,e,n,o,r){const s=this._fieldCache&&this._fieldCache[t];if(s){const l=s.get(e);if(l)return l}return super.getOriginalField(t,e,n,o,r)}clearCache(){this._recordCache&&(this._recordCache=[]),this._fieldCache&&(this._fieldCache={})}fieldPromiseCallBack(t,e,n){aH(this._fieldCache,t,e,n)}recordPromiseCallBack(t,e){this._recordCache&&(this._recordCache[t]=e)}get records(){return Array.isArray(this._recordCache)&&this._recordCache.length>0?this._recordCache:super.records}release(){var t;(t=super.release)===null||t===void 0||t.call(this),this._recordCache=null,this._fieldCache=null}_generateFieldAggragations(){var t;if(super._generateFieldAggragations(),Q((t=this.dataConfig)===null||t===void 0?void 0:t.groupByRules)){const e=this.dataConfig.groupByRules;this.groupAggregator=new this.registedAggregators[Zt.CUSTOM]({field:"",aggregationFun:(n,o,r)=>{const s=new Map,l=[];for(let a=0;a<o.length;a++)Gc(o[a],l,s,e,0);return l}}),this.fieldAggregators.push(this.groupAggregator)}}processRecords(t){var e;const n=super.processRecords(t);return((e=this.groupAggregator)===null||e===void 0?void 0:e.value())||n}getGroupLength(){var t,e,n;return(n=(e=(t=this.dataConfig)===null||t===void 0?void 0:t.groupByRules)===null||e===void 0?void 0:e.length)!==null&&n!==void 0?n:0}updateGroup(){var t,e,n;this.clearCache();const o=this.source;this._source=this.processRecords((e=(t=this.dataSourceObj)===null||t===void 0?void 0:t.records)!==null&&e!==void 0?e:this.dataSourceObj),o&&I_(o,this.source),this.sourceLength=((n=this.source)===null||n===void 0?void 0:n.length)||0,this.sortedIndexMap.clear(),this.currentIndexedData=Array.from({length:this.sourceLength},(r,s)=>s),this.userPagination||(this.pagination.perPageCount=this.sourceLength,this.pagination.totalCount=this.sourceLength),this.initTreeHierarchyState(),this.updatePagerData()}getOriginRecordIndexForGroup(t){const e=this.getOriginalRecord(t);if(O(e)&&!(e.children&&e.children.length>0)){for(let n=0;n<this.dataSourceObj.records.length;n++)if(this.dataSourceObj.records[n]===e)return n}}addRecordsForGroup(t,e){if(!Q(t)||t.length===0)return;let n=this.getOriginRecordIndexForGroup(e);(n===void 0||n>this.dataSourceObj.records)&&(n=this.dataSourceObj.records.length),this.dataSourceObj.records.splice(n,0,...t),this.adjustBeforeChangedRecordsMap(n,t.length),this.updateGroup()}deleteRecordsForGroup(t){if(!Q(t)||t.length===0)return;const e=zv(t);for(let n=0;n<e.length;n++){const o=e[n];if(Z(o)&&(o>=this.sourceLength||o<0))continue;const r=this.getOriginRecordIndexForGroup(o);this.beforeChangedRecordsMap.delete(r.toString()),this.dataSourceObj.records.splice(r,1),this.sourceLength-=1,this.adjustBeforeChangedRecordsMap(r,1,"delete")}this.updateGroup()}updateRecordsForGroup(t,e){for(let n=0;n<e.length;n++){const o=e[n];if(Z(o)&&(o>=this.sourceLength||o<0))continue;const r=this.getOriginRecordIndexForGroup(o);this.beforeChangedRecordsMap.delete(r.toString()),this.dataSourceObj.records[r]=t[n]}this.updateGroup()}addRecordsForTree(t,e){if(Q(t)&&t.length!==0){if(this.adjustBeforeChangedRecordsMap(e,t.length),Z(e))this.dataSourceObj.records.splice(e,0,...t);else{const n=e.pop(),o=this.getOriginalRecord(e);o.children?o.children.splice(n,0,...t):o.children=t}this.initTreeHierarchyState(),this.updatePagerData()}}deleteRecordsForTree(t){if(!Q(t)||t.length===0)return;const e=zv(t);for(let n=0;n<e.length;n++){const o=e[n];if(!Z(o)||!(o>=this.sourceLength||o<0)){if(this.beforeChangedRecordsMap.delete(o.toString()),Z(o))this.dataSourceObj.records.splice(o,1);else{const r=o.pop();this.getOriginalRecord(o).children.splice(r,1)}this.adjustBeforeChangedRecordsMap(o,1,"delete")}}this.initTreeHierarchyState(),this.updatePagerData()}updateRecordsForTree(t,e){for(let n=0;n<e.length;n++){const o=e[n],r=t[n];if(!Z(o)||!(o>=this.sourceLength||o<0))if(this.beforeChangedRecordsMap.delete(o.toString()),Z(o))this.dataSourceObj.records.splice(o,1,r);else{const s=o.pop();this.getOriginalRecord(o).children.splice(s,1,r)}}this.initTreeHierarchyState(),this.updatePagerData()}adjustBeforeChangedRecordsMap(t,e,n="add"){if(this.rowHierarchyType==="tree"){let o;o=Z(t)?[t]:t;const r=[];this.beforeChangedRecordsMap.forEach((s,l)=>{var a,h;const d=l.split(","),u=Math.max(d.length,o.length);for(let c=0;c<u;c++){const f=(a=o[c])!==null&&a!==void 0?a:-1,g=(h=Number(d[c]))!==null&&h!==void 0?h:-1;if(f<g||f===g&&c===d.length-1&&c===o.length-1)return d[c]=(g+(n==="add"?e:-e)).toString(),void r.push({originKey:l,targetKey:d.toString(),value:s})}}),r.forEach(({originKey:s,targetKey:l,value:a})=>{this.beforeChangedRecordsMap.delete(s),this.beforeChangedRecordsMap.set(l,a)})}else super.adjustBeforeChangedRecordsMap(t,e,n)}cacheBeforeChangedRecord(t,e){var n;const o=this.getOriginalRecord(t);e.options.groupBy&&(t=this.getOriginRecordIndexForGroup(t)),this.beforeChangedRecordsMap.has(t.toString())||this.beforeChangedRecordsMap.set(t.toString(),(n=Do(o,void 0,["vtable_gantt_linkedFrom","vtable_gantt_linkedTo"]))!==null&&n!==void 0?n:{})}getGroupSeriesNumber(t){const e=this.dataSource.currentIndexedData[t],n=e.length-1;let o=e.length,r=1;for(;o>n;r++){const s=this.dataSource.currentIndexedData[t-r];o=Z(s)?1:s.length}return r-1}}function Gc(i,t,e,n,o){const r=n[o];if(!O(r))return void t.push(i);const s=lH(i,r);if(s!==void 0){if(e.has(s)){const l=e.get(s);return Gc(i,t[l].children,t[l].map,n,o+1)}return e.set(s,t.length),t.push({vtableMerge:!0,vtableMergeName:s,children:[],map:new Map}),Gc(i,t[t.length-1].children,t[t.length-1].map,n,o+1)}}function I_(i,t,e,n){if(!e){e=new Map;for(let o=0;o<i.length;o++){const r=i[o];r.vtableMerge&&e.set(r.vtableMergeName,o)}}if(!n){n=new Map;for(let o=0;o<t.length;o++){const r=t[o];r.vtableMerge&&n.set(r.vtableMergeName,o)}}for(let o=0;o<i.length;o++){const r=i[o],s=t[n.get(r.vtableMergeName)];O(s)&&(s.hierarchyState=i[o].hierarchyState),Q(r.children)&&Q(s.children)&&r.map.size!==0&&s.map.size!==0&&I_(r.children,s.children,r.map,s.map)}}var Nl={exports:{}},Iv;function hH(){if(Iv)return Nl.exports;Iv=1;var i={},t=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z]+?)\\s*$`].join(""),"i"),e=["style","variant","weight","size","lineHeight","family"],n=/([\.0-9]+)(.*)/,o=function(a,h,d){var u=a.match(n);if(u){a=parseFloat(u[1]);var c=u[2].toLowerCase().trim(),f=Math.round(a);switch(f===a&&(a=f),c){case"em":return h===null?void 0:a*h;case"px":return a;case"pt":return a/(72/d);case"pc":return a/(6/d);case"mm":return a*(d/25.4);case"cm":return a*(d/2.54);case"in":return a*d;case"%":return h===null?void 0:h*(a/100)}}},r={size:o,lineHeight:o},s={serif:1,"sans-serif":1,cursive:1,fantasy:1,monospace:1},l=Nl.exports=function(a,h,d){var u=a+"-"+(h||"null")+"@"+d;if(d=d||96,typeof i[u]<"u")return i[u];if(h&&(h=l(h,null,d)),a==="inherit")return h;var c=t.exec(a);if(!c){i[u]=null;return}c.shift();for(var f={},g=0;g<c.length;g++){var p=e[g],v=c[g];if(r[p]&&v){var m=h&&h[p]||null,b=r[p](v,m,d);typeof b>"u"&&p==="lineHeight"&&v?v=f.size*parseFloat(v):v=b}if(!(!v||v==="normal")){if(v==="inherit"){if(!h)return;v=h[p]}v.trim&&(v=v.trim()),f[p]=v}}Object.keys(f).length||(f=null),i[u]=f;var C=[];f.style&&C.push(f.style),f.variant&&C.push(f.variant),f.weight&&f.weight!=="400"&&f.weight!=="normal"&&C.push(f.weight),C.push(f.size+"px"),f.lineHeight&&(C[C.length-1]+="/"+f.lineHeight+"px");var _=f.family.split(",");return f.family=_.map(function(w){return w=w.trim(),s[w.toLowerCase()]&&(w=w.toLowerCase()),w}),C.push(f.family),Object.defineProperty(f,"toString",{value:function(){return C.map(function(w){return Array.isArray(w)?w.map(function(y){return y.indexOf(" ")>-1?'"'+y.replace(/["']/g,"")+'"':y}).join(", "):w}).join(" ")}}),f};return Nl.exports.generics=s,Nl.exports}var dH=hH();const uH=Ob(dH);function cH(i){return uH(i)}function xt(i){var t,e,n,o;if(Z(i)||jt(i)||Q(i)){let r=ga(i);return typeof r=="number"||typeof r=="string"?r=[r,r,r,r]:Array.isArray(r)&&(r=r.slice(0)),r}return i&&(isFinite(i.bottom)||isFinite(i.left)||isFinite(i.right)||isFinite(i.top))?[(t=i.top)!==null&&t!==void 0?t:0,(e=i.right)!==null&&e!==void 0?e:0,(n=i.bottom)!==null&&n!==void 0?n:0,(o=i.left)!==null&&o!==void 0?o:0]:[0,0,0,0]}const ea=0,O_=1,dh=2,D_=3,W_=10,N_=11,V_=12,gH=9,fH=13,pH=10,vH=12,mH=32,bH=37,CH=46,_H=48,wH=57,yH=65,SH=90,xH=97,RH=122;function AH(i){return i>=yH&&i<=SH}function BH(i){return i>=xH&&i<=RH}function MH(i){return BH(i)||AH(i)}function TH(i){return i===gH||i===pH||i===vH||i===fH||i===mH}function qd(i){return i>=_H&&i<=wH}function Ov(i){return i===CH}function Dv(i){return MH(i)||i===bH}function ws(i){return new Error(`calc parse error: ${i}`)}function PH(i){const t=i.replace(/calc\(/g,"(").trim(),e=[],n=t.length;for(let l=0;l<n;l++){const a=t[l],h=a.charCodeAt(0);if(a==="("||a===")")e.push({value:a,type:ea});else if(a==="*"||a==="/")e.push({value:a,type:dh});else if(a==="+"||a==="-")l=o(a,l+1)-1;else if(qd(h)||Ov(h))l=r(a,l+1)-1;else if(!TH(h))throw ws(i)}function o(l,a){if(a<n){const h=t[a],d=h.charCodeAt(0);if(qd(d)||Ov(d))return r(l+h,a+1)}return e.push({value:l,type:dh}),a}function r(l,a){let h=a;for(;h<n;h++){const d=t[h],u=d.charCodeAt(0);if(qd(u))l+=d;else{if(d!=="."){if(Dv(u))return s(l,d,h+1);break}if(l.indexOf(".")>=0)throw ws(i);l+=d}}if(l===".")throw ws(i);return e.push({value:parseFloat(l),type:D_}),h}function s(l,a,h){let d=h;for(;d<n;d++){const u=t[d];if(!Dv(u.charCodeAt(0)))break;a+=u}return e.push({value:parseFloat(l),unit:a,type:O_}),d}return e}const Wv={"*":3,"/":3,"+":2,"-":2};function G_(i,t){function e(o){const r=o.pop(),s=o.pop(),l=o.pop();if(!(l&&l.nodeType&&s&&s.type===dh&&r&&r.nodeType))throw ws(t);return{nodeType:N_,left:l,op:s,right:r}}const n=[];for(;i.length;){const o=i.shift();if(o.type===ea&&o.value==="("){let r=0;const s=A_.findIndex(i,l=>{if(l.type===ea&&l.value==="(")r++;else if(l.type===ea&&l.value===")"){if(!r)return!0;r--}return!1});if(s===-1)throw ws(t);n.push(G_(i.splice(0,s),t)),i.shift()}else if(o.type===dh){if(n.length>=3){const r=n[n.length-2].value;Wv[o.value]<=Wv[r]&&n.push(e(n))}n.push(o)}else if(o.type===O_){const{value:r,unit:s}=o;n.push({nodeType:W_,value:r,unit:s})}else o.type===D_&&n.push({nodeType:V_,value:o.value})}for(;n.length>1;)n.push(e(n));return n[0]}function HH(i){return G_(PH(i),i)}function jc(i,t){if(i.nodeType===N_){const e=jc(i.left,t),n=jc(i.right,t);switch(i.op.value){case"+":return e+n;case"-":return e-n;case"*":return e*n;case"/":return e/n;default:throw new Error(`calc error. unknown operator: ${i.op.value}`)}}else if(i.nodeType===W_)switch(i.unit){case"%":return i.value*t.full/100;case"px":return i.value;default:throw new Error(`calc error. unknown unit: ${i.unit}`)}else if(i.nodeType===V_)return i.value;throw new Error("calc error.")}function kH(i,t){return jc(HH(i),t)}function EH(i,t){return typeof i=="string"?kH(i.trim(),t):i-0}function LH(i){return!Pt(i)&&(!!Z(i)||+i==+i)}function Zd(i){return!!jt(i)&&!!i.endsWith("%")&&LH(i.substring(0,i.length-1))}function FH(i,t="vtable"){var e,n;const o=document.createElement("div");o.setAttribute("tabindex","0"),o.classList.add(t),o.style.outline="none",o.style.margin=`${i.top}px ${i.right}px ${i.bottom}px ${i.left}px`;const r=(o.offsetWidth||((e=o.parentElement)===null||e===void 0?void 0:e.offsetWidth)||1)-1,s=(o.offsetHeight||((n=o.parentElement)===null||n===void 0?void 0:n.offsetHeight)||1)-1;return o.style.width=r&&r-i.left-i.right+"px"||"0px",o.style.height=s&&s-i.top-i.bottom+"px"||"0px",o}function zH(i,t){var e,n;i.style.margin=`${t.top}px ${t.right}px ${t.bottom}px ${t.left}px`;const o=(i.offsetWidth||((e=i.parentElement)===null||e===void 0?void 0:e.offsetWidth)||1)-1,r=(i.offsetHeight||((n=i.parentElement)===null||n===void 0?void 0:n.offsetHeight)||1)-1;i.style.width=o&&o-t.left-t.right+"px"||"0px",i.style.height=r&&r-t.top-t.bottom+"px"||"0px"}function j_(i,t){const{dataSourceEventIds:e}=i.internalProps;e&&e.forEach(n=>i.internalProps.handler.off(n)),t(i),i.internalProps.dataSourceEventIds=[i.internalProps.handler.on(i.internalProps.dataSource,Lo.EVENT_TYPE.CHANGE_ORDER,()=>{i.dataSource.hierarchyExpandLevel&&i.refreshRowColCount(),i.render()})]}function Nv(i,t=[]){j_(i,()=>{i.internalProps.records=t;const e=i.internalProps.dataSource=wd.ofArray(t,i.internalProps.dataConfig,i.pagination,i.internalProps.columns,i.internalProps.layoutMap.rowHierarchyType,U_(i));i.addReleaseObj(e)})}function U_(i){var t;return i.options.hierarchyExpandLevel?i.options.hierarchyExpandLevel:i.options.groupBy?1/0:!((t=i._hasHierarchyTreeHeader)===null||t===void 0)&&t.call(i)?1:void 0}function IH(i,t){j_(i,()=>{var e,n;i.internalProps.dataSource&&((n=(e=i.internalProps.dataSource).release)===null||n===void 0||n.call(e)),t?t instanceof Lo?(i.internalProps.dataSource=t,i.internalProps.dataSource.supplementConfig(i.pagination,i.options.columns,i.internalProps.layoutMap.rowHierarchyType,U_(i))):i.internalProps.dataSource=new wd(t):i.internalProps.dataSource=Lo.EMPTY,i.addReleaseObj(i.internalProps.dataSource),i.internalProps.records=null})}function OH(i,t){if(!i.internalProps.frozenRowCount)return null;let{scrollTop:e}=i;const n=i.internalProps.frozenRowCount;for(let o=0;o<n;o++){const r=i.getRowHeight(o),s=e+r;if(s>t)return{top:e,row:o,bottom:s,height:r};e=s}return null}function DH(i,t){if(!i.internalProps.frozenColCount)return null;let{scrollLeft:e}=i;const n=i.internalProps.frozenColCount;for(let o=0;o<n;o++){const r=i.getColWidth(o),s=e+r;if(s>t)return{left:e,col:o,right:s,width:r};e=s}return null}function Ko(i,t){return Math.round(EH(t,i.internalProps.calcWidthContext))}function WH(i,t){return i?i.min&&i.min>t?i.min:i.max&&i.max<t?i.max:t:t}function NH(i){let t=0,e=0;i.frozenColCount>0&&(t=i.getFrozenColsWidth()),i.rightFrozenColCount>0&&(e=i.getRightFrozenColsWidth());let n=0,o=0;return i.frozenRowCount>0&&(n=i.getFrozenRowsHeight()),i.bottomFrozenRowCount>0&&(o=i.getBottomFrozenRowsHeight()),new qi(i.scrollLeft+t,i.scrollTop+n,i.tableNoFrameWidth-t-e,i.tableNoFrameHeight-n-o)}function no(i,t,e,n,o,r=!0){const s=xt(o("padding",i,e,n,t)),l=o("bgColor",i,e,n,t),a=o("font",i,e,n,t);let h,d,u,c,f;if(a){const{family:P,size:H,weight:L,style:F,variant:z}=cH(a);h=P.join(" "),d=H,u=L,c=F,c=z}else h=o("fontFamily",i,e,n,t),d=o("fontSize",i,e,n,t),u=o("fontWeight",i,e,n,t),c=o("fontStyle",i,e,n,t),f=o("fontVariant",i,e,n,t);const g=o("textAlign",i,e,n,t),p=o("textBaseline",i,e,n,t),v=o("color",i,e,n,t),m=o("strokeColor",i,e,n,t),b=o("lineHeight",i,e,n,t),C=o("underline",i,e,n,t),_=o("underlineDash",i,e,n,t),w=o("underlineOffset",i,e,n,t),y=o("lineThrough",i,e,n,t),x=Math.max(1,Math.floor(d/10)),S=o("textOverflow",i,e,n,t),R=o("borderColor",i,e,n,t),B=o("borderLineWidth",i,e,n,t),A=o("borderLineDash",i,e,n,t),M=o("marked",i,e,n,t),k=o("cursor",i,e,n,t),E=!(s&&l&&a&&g&&p&&v&&S&&R&&B&&A&&typeof C=="boolean"&&typeof y=="boolean"&&typeof M=="boolean");if(!r)return{hasFunctionPros:E};const T={text:{fontFamily:h,fontSize:d,fontWeight:u,fontStyle:c,fontVariant:f,fill:v,stroke:m!=null&&m,textAlign:g,textBaseline:p,lineHeight:b??d,underline:C?x:void 0,underlineDash:_,underlineOffset:w,lineThrough:y?x:void 0,ellipsis:S==="clip"?"":S==="ellipsis"?"...":O(S)?S:void 0},group:{fill:l,lineDash:A,lineWidth:B,stroke:R,cursor:k==="auto"||k==="default"?void 0:k},_vtable:{padding:s,marked:M}};if(Array.isArray(B)&&(T.group.strokeArrayWidth=xt(B)),Array.isArray(R)){const P=xt(R);T.group.stroke=!P.every(H=>!H)&&P,T.group.strokeArrayColor=xt(R)}return{theme:T,hasFunctionPros:E}}function yd(i,t,e){const n=e.theme.frameStyle.cornerRadius;if(Array.isArray(n)){if(i===0&&t===0)return[n[0],0,0,0];if(i===e.colCount-1&&t===0)return[0,n[1],0,0];if(i===0&&t===e.rowCount-1)return[0,0,0,n[3]];if(i===e.colCount-1&&t===e.rowCount-1)return[0,0,n[2],0]}else if(n){if(i===0&&t===0)return[n,0,0,0];if(i===e.colCount-1&&t===0)return[0,n,0,0];if(i===0&&t===e.rowCount-1)return[0,0,0,n];if(i===e.colCount-1&&t===e.rowCount-1)return[0,0,n,0]}return 0}function xO(i){var t,e,n,o;if(i){if(Array.isArray(i)){let r;for(let s=0;s<i.length;s++)if(i[s].autoRange){if(i[s].y==="sum"||i[s].x==="sum"||i[s].y1==="sum"||i[s].x1==="sum")return"sum";i[s].y!=="max"&&i[s].x!=="max"&&i[s].y1!=="max"&&i[s].x1!=="max"||(r="max"),typeof i[s].y=="number"&&typeof(r??0)=="number"&&(r=Math.max((t=r)!==null&&t!==void 0?t:0,i[s].y)),typeof i[s].x=="number"&&typeof(r??0)=="number"&&(r=Math.max((e=r)!==null&&e!==void 0?e:0,i[s].x)),typeof i[s].y1=="number"&&typeof(r??0)=="number"&&(r=Math.max((n=r)!==null&&n!==void 0?n:0,i[s].y1)),typeof i[s].x1=="number"&&typeof(r??0)=="number"&&(r=Math.max((o=r)!==null&&o!==void 0?o:0,i[s].x1))}return r}if(i.autoRange){if(i.y==="sum"||i.x==="sum"||i.y1==="sum"||i.x1==="sum")return"sum";if(i.y==="max"||i.x==="max"||i.y1==="max"||i.x1==="max")return"max";if(typeof i.y=="number")return i.y;if(typeof i.x=="number")return i.x;if(typeof i.y1=="number")return i.y1;if(typeof i.x1=="number")return i.x1}}}function Vl(i){for(let t=0;t<i.internalProps.columns.length;t++){const e=i.internalProps.columns[t];if(!e.aggregation){if(i.options.aggregation){let n;if(n=typeof i.options.aggregation=="function"?i.options.aggregation({col:t,field:e.field}):i.options.aggregation,n)if(Array.isArray(n)){const o=[];n.forEach(r=>{o.push(Object.assign({showOnTop:!1},r))}),e.aggregation=o}else e.aggregation=Object.assign({showOnTop:!1},n)}}}}function VH(i){for(let t=0;t<i.length;t++)if(i[t].aggregation)return!0;return!1}function GH(i){if(i.options.widthMode==="autoWidth"||i.options.defaultHeaderColWidth==="auto"||Array.isArray(i.options.defaultHeaderColWidth)&&i.options.defaultHeaderColWidth.includes("auto"))return!0;const t=i.internalProps.layoutMap.columnObjects;for(let e=0;e<t.length;e++)if(t[e].width==="auto")return!0;return!1}class Fo extends ko{constructor(t){super(t),this.attribute.visibleTime!=="mouseenter_cell"&&this.attribute.visibleTime!=="click_cell"||(this.attribute.opacity=0),this.attribute.hoverImage&&(this.attribute.originImage=this.attribute.image),this.attribute.isGif&&this.attribute.gif&&this.loadGif()}loadGif(){this.playing=!1,Wt.GetFile(this.attribute.gif+`?role=gif&radom=${Math.random()}`,"arrayBuffer").then(t=>{const e=Sf.parseGIF(t),n=Sf.decompressFrames(e,!0);this.renderGIF(n),this.resources.set(this.attribute.image,{state:"success",data:this.gifCanvas})}).catch(t=>{})}get backgroundWidth(){var t,e;return(e=(t=this.attribute.backgroundWidth)!==null&&t!==void 0?t:this.attribute.width)!==null&&e!==void 0?e:0}get backgroundHeight(){var t,e;return(e=(t=this.attribute.backgroundHeight)!==null&&t!==void 0?t:this.attribute.height)!==null&&e!==void 0?e:0}renderGIF(t){this.loadedFrames=t,this.frameIndex=0,this.tempCanvas||(this.tempCanvas=document.createElement("canvas"),this.tempCtx=this.tempCanvas.getContext("2d")),this.gifCanvas||(this.gifCanvas=document.createElement("canvas"),this.gifCtx=this.gifCanvas.getContext("2d")),this.gifCanvas.width=t[0].dims.width,this.gifCanvas.height=t[0].dims.height,this.playing=!0,this.lastTime=new Date().getTime(),this.animate().to({},1e3,"linear").loop(1/0)}renderFrame(t,e,n){const o=this.loadedFrames[this.frameIndex||0];o.disposalType===2&&this.gifCtx.clearRect(0,0,this.gifCanvas.width,this.gifCanvas.height),this.drawPatch(o),this.manipulate(t,e,n);const r=new Date().getTime()-this.lastTime;o.delay<r&&(this.frameIndex++,this.lastTime=new Date().getTime()),this.frameIndex>=this.loadedFrames.length&&(this.frameIndex=0)}drawPatch(t){const e=t.dims;this.frameImageData&&e.width===this.frameImageData.width&&e.height===this.frameImageData.height||(this.tempCanvas.width=e.width,this.tempCanvas.height=e.height,this.frameImageData=this.tempCtx.createImageData(e.width,e.height)),this.frameImageData.data.set(t.patch),this.tempCtx.putImageData(this.frameImageData,0,0),this.gifCtx.drawImage(this.tempCanvas,e.left,e.top)}manipulate(t,e,n){t.drawImage(this.gifCanvas,0,0,this.gifCanvas.width,this.gifCanvas.height,e,n,this.attribute.width,this.attribute.height)}setAttribute(t,e,n,o){super.setAttribute(t,e,n,o),t==="gif"&&this.loadGif()}setAttributes(t,e,n){super.setAttributes(t,e,n),t.gif&&this.loadGif()}}class $_ extends xe{constructor(t){var e,n,o,r,s;t.fill=(e=t.fill)!==null&&e!==void 0?e:"#00F",t.fontSize=(n=t.fontSize)!==null&&n!==void 0?n:12,t.underline=(o=t.underline)!==null&&o!==void 0?o:1,t.textBaseline=(r=t.textBaseline)!==null&&r!==void 0?r:"top",t.cursor=(s=t.cursor)!==null&&s!==void 0?s:"pointer",super(t)}}function Ks(i){return{rootContainer:new Gi({}),renderDefault:!0}}class jH{constructor(t){this.table=t,this.customLayoutFuncCache=new Map,this.reactRemoveGraphicCache=new Map,this.reactRemoveAllGraphicCache=new Map,this.headerCustomLayoutFuncCache=new Map,this.headerReactRemoveGraphicCache=new Map,this.headerReactRemoveAllGraphicCache=new Map}hasReactCreateGraphic(t,e){return e?this.headerCustomLayoutFuncCache.has(t):this.customLayoutFuncCache.has(t)}setReactCreateGraphic(t,e,n){n?this.headerCustomLayoutFuncCache.set(t,e):this.customLayoutFuncCache.set(t,e)}setReactRemoveGraphic(t,e,n){n?this.headerReactRemoveGraphicCache.set(t,e):this.reactRemoveGraphicCache.set(t,e)}setReactRemoveAllGraphic(t,e,n){n?this.headerReactRemoveAllGraphicCache.set(t,e):this.reactRemoveAllGraphicCache.set(t,e)}updateCustomCell(t,e){const n=this.table;if(n.isPivotTable()){const o=$H(t,n,e);for(let r=0;r<o.length;r++){const s=o[r];for(let l=s.start.col;l<=s.end.col;l++)for(let a=s.start.row;a<=s.end.row;a++)n.scenegraph.updateCellContent(l,a)}}else{const o=UH(t,n,e);for(let r=o.start.col;r<=o.end.col;r++)for(let s=o.start.row;s<=o.end.row;s++)n.scenegraph.updateCellContent(r,s)}n.widthMode==="autoWidth"&&n.scenegraph.recalculateColWidths(),n.isAutoRowHeight()&&n.scenegraph.recalculateRowHeights(),n.scenegraph.renderSceneGraph()}getCustomLayoutFunc(t,e){var n;if(this.table.isHeader(t,e)){const{componentId:r}=this.table.getHeaderDefine(t,e);return(n=this.headerCustomLayoutFuncCache.get(r))!==null&&n!==void 0?n:Ks}const{componentId:o}=this.table.getBodyColumnDefine(t,e);return this.customLayoutFuncCache.get(o)||Ks}removeCustomCell(t,e){let n;if(this.table.isHeader(t,e)){const o=this.table.getHeaderDefine(t,e),{componentId:r}=o;n=this.headerReactRemoveGraphicCache.get(r)}else{const o=this.table.getBodyColumnDefine(t,e),{componentId:r}=o;n=this.reactRemoveGraphicCache.get(r)}n&&n(t,e)}clearCache(){this.reactRemoveAllGraphicCache.forEach(t=>{t()}),this.headerReactRemoveAllGraphicCache.forEach(t=>{t()})}updateAllCustomCell(){this.customLayoutFuncCache.forEach((t,e)=>{this.updateCustomCell(e)}),this.headerCustomLayoutFuncCache.forEach((t,e)=>{this.updateCustomCell(e,!0)})}}function UH(i,t,e){const n=t.internalProps.rowSeriesNumber?1:0;if(e){const r=t.internalProps.layoutMap,{headerObjects:s}=t.internalProps.layoutMap;let l;for(let h=0;h<s.length;h++){const d=s[h];if(d.define.componentId===i){l=d.id;break}}const a=r.getHeaderCellAdressById(l);return r.getCellRange(a.col,a.row)}const{columnObjects:o}=t.internalProps.layoutMap;for(let r=0;r<o.length;r++)if(o[r].define.componentId===i)return{start:{col:n+r,row:t.columnHeaderLevelCount},end:{col:n+r,row:t.rowCount-1}};return{start:{col:0,row:0},end:{col:t.colCount-1,row:t.rowCount-1}}}function $H(i,t,e){const n=t.internalProps.rowSeriesNumber?1:0,o=[],r=t.internalProps.layoutMap;if(e){const{headerObjects:s}=r,l=[];for(let a=0;a<s.length;a++){const h=s[a];h&&h.define.componentId===i&&l.push(h.id)}for(let a=0;a<l.length;a++){const h=l[a],d=r.getHeaderCellAdressById(h),u=r.getCellRange(d.col,d.row);o.push(u)}}else{let s;const{columnObjects:l,indicatorsAsCol:a}=r;for(let h=0;h<l.length;h++)if(l[h].define.componentId===i){s=h;break}if(a)for(let h=r.rowHeaderLevelCount+s;h<r.colCount;h+=l.length){const d={start:{col:h+n,row:r.columnHeaderLevelCount},end:{col:h+n,row:r.rowCount-1}};o.push(d)}else for(let h=r.columnHeaderLevelCount+s;h<r.rowCount;h+=l.length){const d={start:{col:r.rowHeaderLevelCount+n,row:h},end:{col:r.colCount-1,row:h}};o.push(d)}}return o}function me(i){const t={abstractPos:{x:i.viewport.x,y:i.viewport.y}},e=zo(i.target);return e&&(t.eventArgs={col:e.col,row:e.row,event:i,targetCell:e,mergeInfo:KH(e),target:i.target}),t}function zo(i){for(;i&&i.parent;){if(i.role==="cell")return i;i=i.parent}return null}function KH(i){if(O(i.mergeStartCol)&&O(i.mergeStartRow)&&O(i.mergeEndCol)&&O(i.mergeEndRow))return{colStart:i.mergeStartCol,colEnd:i.mergeEndCol,rowStart:i.mergeStartRow,rowEnd:i.mergeEndRow}}const YH=/radio-\d+-\d+-(\d+)/,K_="_custom_",tn="custom-container",uh=K_+"_0";function to(i,t,e,n,o,r,s,l,a,h,d){var u,c,f;let g,p,v,m=!0,b=!1;if(i==="react-custom-layout"&&(i=((u=d.reactCustomLayout)===null||u===void 0?void 0:u.getCustomLayoutFunc(e,n))||Ks),typeof i=="function"){const C=i({col:(c=h==null?void 0:h.start.col)!==null&&c!==void 0?c:e,row:(f=h==null?void 0:h.start.row)!==null&&f!==void 0?f:n,dataValue:d.getCellOriginValue(e,n),value:d.getCellValue(e,n)||"",rect:{left:0,top:0,right:o,bottom:r,width:o,height:r},table:d,originCol:e,originRow:n});if(!C)return{renderDefault:!0};C.rootContainer&&(C.rootContainer=Ys(C.rootContainer,d.animationManager.timeline)),C.rootContainer instanceof Gi&&(v=C.rootContainer,v.name=tn,v.col=e,v.row=n),m=C.renderDefault,b=C.enableCellPadding}else if(typeof t=="function"){const C=t({col:e,row:n,dataValue:d.getCellOriginValue(e,n),value:d.getCellValue(e,n)||"",rect:{left:0,top:0,right:o,bottom:r,width:o,height:r},table:d});C&&(p=C.elements,m=C.renderDefault,C.expectedWidth,g=C.expectedHeight)}else t&&(t.expectedWidth,g=t.expectedHeight,p=t.elements,m=t.renderDefault);return p&&(v=XH(p,o,l?g:r,d.getCellValue(e,n))),b&&v.setAttributes({x:a[3],y:a[0],width:o-a[1]-a[3],height:r-a[0]-a[2]}),Sd(v,o,r),!h||h.start.col===h.end.col&&h.start.row===h.end.row||Y_(v,e,n,0),{elementsGroup:v,renderDefault:m}}function XH(i,t,e,n){const o=new Gi({x:0,y:0,width:t,height:e,fill:!1,stroke:!1,pickable:!1});return o.name=tn,qH(i,t,e,n).forEach(r=>{var s,l,a,h,d,u,c,f,g,p,v,m,b,C,_,w,y,x,S,R,B,A,M,k,E,T,P,H;switch(r.clickable&&(r.pickable=r.clickable),r.type){case"arc":const L=Og({x:r.x,y:r.y,dx:(s=r.dx)!==null&&s!==void 0?s:0,dy:(l=r.dy)!==null&&l!==void 0?l:0,fill:r.fill,stroke:r.stroke,outerRadius:r.radius,startAngle:r.startAngle,endAngle:r.endAngle,pickable:!!r.pickable,cursor:r.cursor});L.name=r.name,o.appendChild(L);break;case"text":if(r.background){const j=(h=(a=r.background)===null||a===void 0?void 0:a.expandX)!==null&&h!==void 0?h:0,V=(u=(d=r.background)===null||d===void 0?void 0:d.expandY)!==null&&u!==void 0?u:0,X=qt({x:r.x-j,y:r.y-V,dx:(c=r.dx)!==null&&c!==void 0?c:0,dy:(f=r.dy)!==null&&f!==void 0?f:0,width:r.width+2*j,height:r.height+2*V,cornerRadius:(p=(g=r.background)===null||g===void 0?void 0:g.cornerRadius)!==null&&p!==void 0?p:0,fill:(m=(v=r.background)===null||v===void 0?void 0:v.fill)!==null&&m!==void 0?m:"#888"});o.appendChild(X)}const F=new xe(Object.assign({pickable:!!r.pickable,fill:(b=r.color)!==null&&b!==void 0?b:r.fill},r));F.name=r.name,o.appendChild(F);break;case"rect":const z=qt({x:r.x,y:r.y,dx:(C=r.dx)!==null&&C!==void 0?C:0,dy:(_=r.dy)!==null&&_!==void 0?_:0,width:r.width,height:r.height,cornerRadius:r.radius,fill:r.fill,stroke:r.stroke,pickable:!!r.pickable,cursor:r.cursor});z.name=r.name,o.appendChild(z);break;case"circle":const I=DC({x:r.x,y:r.y,dx:(w=r.dx)!==null&&w!==void 0?w:0,dy:(y=r.dy)!==null&&y!==void 0?y:0,radius:r.radius,fill:r.fill,stroke:r.stroke,pickable:!!r.pickable,cursor:r.cursor});I.name=r.name,o.appendChild(I);break;case"icon":const N=new Fo({x:r.x,y:r.y,dx:(x=r.dx)!==null&&x!==void 0?x:0,dy:(S=r.dy)!==null&&S!==void 0?S:0,width:r.width,height:r.height,image:r.svg,backgroundWidth:r.hover?(R=r.hover.width)!==null&&R!==void 0?R:r.width:void 0,backgroundHeight:r.hover?(B=r.hover.width)!==null&&B!==void 0?B:r.width:void 0,backgroundColor:r.hover?(A=r.hover.bgColor)!==null&&A!==void 0?A:"rgba(22,44,66,0.2)":void 0,pickable:!!r.pickable,cursor:r.cursor});N.name=r.name,N.role="icon-custom",o.appendChild(N);break;case"image":const W=new Fo({x:r.x,y:r.y,dx:(M=r.dx)!==null&&M!==void 0?M:0,dy:(k=r.dy)!==null&&k!==void 0?k:0,width:r.width,height:r.height,image:r.src,backgroundWidth:r.hover?(E=r.hover.width)!==null&&E!==void 0?E:r.width:void 0,backgroundHeight:r.hover?(T=r.hover.width)!==null&&T!==void 0?T:r.width:void 0,backgroundColor:r.hover?(P=r.hover.bgColor)!==null&&P!==void 0?P:"rgba(22,44,66,0.2)":void 0,pickable:!!r.pickable,cursor:r.cursor,shape:r.shape});W.name=r.name,W.role="image-custom",o.appendChild(W);break;case"line":const D=hi({points:r.points,lineWidth:(H=r.lineWidth)!==null&&H!==void 0?H:1,stroke:r.stroke,pickable:!!r.pickable,cursor:r.cursor});D.name=r.name,o.appendChild(D)}}),o}function qH(i,t,e,n){const o=[],r=[0,0,0,0];for(let s=0;s<i.length;s++){const l=i[s],a=Object.assign({},l);for(const d in a)a.hasOwnProperty(d)&&Mt(a[d])&&(a[d]=a[d](n));const h=a;O(h.x)&&(h.x=jt(h.x)?un(h.x,t-r[1]):Number(h.x)),O(h.y)&&(h.y=jt(h.y)?un(h.y,e-r[2]):Number(h.y)),"width"in a&&(a.width=jt(a.width)?un(a.width,t-r[1]):Number(a.width)),"height"in a&&(a.height=jt(a.height)?un(a.height,e-r[2]):Number(a.height)),"radius"in a&&(a.radius=jt(a.radius)?un(a.radius,Math.min(t-r[1],e-r[2])):Number(a.radius)),"hover"in a&&(a.hover.x=jt(a.hover.x)?un(a.hover.x,t-r[1]):Number(a.hover.x),a.hover.y=jt(a.hover.y)?un(a.hover.y,e-r[2]):Number(a.hover.y),a.hover.width=jt(a.hover.width)?un(a.hover.width,t-r[1]):Number(a.hover.width),a.hover.height=jt(a.hover.height)?un(a.hover.height,e-r[2]):Number(a.hover.height),a.hover.x+=0,a.hover.y+=0),h.x=h.x+0,h.y=h.y+0,o.push(a)}return o}function un(i,t){return i.endsWith("px")?parseInt(i,10):i.endsWith("%")&&t?parseInt(i,10)/100*t:parseInt(i,10)}function Sd(i,t,e){i&&i.forEachChildren(n=>{var o,r;n&&(kt(n.attribute.width)&&n.attribute.width.percent&&n.setAttribute("width",Math.max(0,n.attribute.width.percent/100*t+((o=n.attribute.width.delta)!==null&&o!==void 0?o:0))),n.attribute.width<0&&n.setAttribute("width",0),kt(n.attribute.height)&&n.attribute.height.percent&&n.setAttribute("height",Math.max(0,n.attribute.height.percent/100*e+((r=n.attribute.height.delta)!==null&&r!==void 0?r:0))),n.attribute.height<0&&n.setAttribute("height",0),n.type==="group"&&Sd(n,n.attribute.width,n.attribute.height))})}function Ys(i,t){if(!i||!O(i.$$typeof)&&!O(i.vtype))return i;const e=i.type,{attribute:n,children:o,stateProxy:r,animation:s}=i.props,l=e({attribute:n});if(ZH(l,i.props),r&&(l.stateProxy=r),l.id=n.id,l.name=n.name,Q(o)?o.forEach(a=>{const h=Ys(a,t);h&&h.type&&l.add(h)}):o&&l.add(Ys(o,t)),Q(s)&&t){const a=l.animate();a.setTimeline(t),s.forEach(h=>{a[h[0]](...h.slice(1))})}return l}function ZH(i,t){let e=!1;switch(i.type){case"richtext":case"rich/image":break;default:e=!0}e&&Object.keys(t).forEach(n=>{const o=zB[n];o&&i.on(o,t[n])})}function Y_(i,t,e,n,o){i&&(i.name=`${K_}${o??""}_${n}`,i.onBeforeAttributeUpdate=JH,i.type==="group"&&i.childrenCount&&i.forEachChildren((r,s)=>{Y_(r,t,e,s,(o??"")+"_"+n)}))}function JH(i,t){const e=this;if(e.skipMergeUpdate)return;const n=zo(e);if(!n||!n.stage)return;const o=n.stage.table;e.skipAttributeUpdate=!0;const{mergeStartCol:r,mergeEndCol:s,mergeStartRow:l,mergeEndRow:a}=n;if(O(r)&&O(s)&&O(l)&&O(a)&&(r!==s||l!==a)){for(let h=r;h<=s;h++)for(let d=l;d<=a;d++){if(h===n.col&&d===n.row)continue;const u=o.scenegraph.highPerformanceGetCell(h,d);if(u.role==="cell"){const c=u.getChildByName(e.name,!0);if(!c||c.skipAttributeUpdate)continue;for(const f in i)i[f]!==c.attribute[f]&&f!=="dx"&&f!=="dy"&&c.setAttribute(f,i[f])}}e.skipAttributeUpdate=void 0}}const QH={};class X_{static setIcon(t,e){this.cache.set(t,e)}static getIcon(t){return this.cache.has(t)?this.cache.get(t):null}static hasIcon(t){return this.cache.has(t)}static clear(t){return this.cache.delete(t)}static clearAll(){this.cache=new Map}}X_.cache=new Map;let hs,ds,Uc,$c,ao,ho,Kc,q_,Z_,J_,Q_,uo,co,tw,ew,Yc,Xc,iw,nw,qc,Zc,go,fo,Jc;function Gl(i){var t,e,n,o,r,s,l,a,h,d,u,c,f,g,p,v,m,b,C,_,w,y,x,S;hs=(t=i==null?void 0:i.sort_color)!==null&&t!==void 0?t:"#282F38",ds=(e=i==null?void 0:i.sort_color_opacity)!==null&&e!==void 0?e:"0.35",Uc=(n=i==null?void 0:i.sort_color_2)!==null&&n!==void 0?n:"#416EFF",$c=(o=i==null?void 0:i.sort_color_opacity_2)!==null&&o!==void 0?o:"1",ao=(r=i==null?void 0:i.sort_size)!==null&&r!==void 0?r:16,ho=(s=i==null?void 0:i.sort_size_2)!==null&&s!==void 0?s:22,Kc=(l=i==null?void 0:i.frozen_color)!==null&&l!==void 0?l:"#282F38",q_=(a=i==null?void 0:i.frozen_color_opacity)!==null&&a!==void 0?a:"0.35",Z_=(h=i==null?void 0:i.frozen_color_opacity)!==null&&h!==void 0?h:"0.2",J_=(d=i==null?void 0:i.frozen_color_2)!==null&&d!==void 0?d:"#416EFF",Q_=(u=i==null?void 0:i.frozen_color_opacity_2)!==null&&u!==void 0?u:"1",uo=(c=i==null?void 0:i.frozen_size)!==null&&c!==void 0?c:22,co=(f=i==null?void 0:i.frozen_size_2)!==null&&f!==void 0?f:22,tw=(g=i==null?void 0:i.collapse_color)!==null&&g!==void 0?g:"#141414",ew=(p=i==null?void 0:i.collapse_color_opacity)!==null&&p!==void 0?p:"0.65",Yc=(v=i==null?void 0:i.collapse_size)!==null&&v!==void 0?v:16,Xc=(m=i==null?void 0:i.frozen_size_2)!==null&&m!==void 0?m:22,iw=(b=i==null?void 0:i.expand_color)!==null&&b!==void 0?b:"#141414",nw=(C=i==null?void 0:i.expand_color_opacity)!==null&&C!==void 0?C:"0.65",qc=(_=i==null?void 0:i.expand_size)!==null&&_!==void 0?_:16,Zc=(w=i==null?void 0:i.expand_size_2)!==null&&w!==void 0?w:22,go=(y=i==null?void 0:i.dragReorder_color)!==null&&y!==void 0?y:"#666666",fo=(x=i==null?void 0:i.dragReorder_color_opacity)!==null&&x!==void 0?x:"1",Jc=(S=i==null?void 0:i.dragReorder_size)!==null&&S!==void 0?S:20}const tk={get sort_downward(){return{type:"svg",svg:`<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"> <path d="M4.6665 9H11.3332L7.99984 13.1667L4.6665 9Z" fill="${Uc}"  fill-opacity="${$c}"/><path d="M11.3335 7L4.66683 7L8.00016 2.83333L11.3335 7Z" fill="${hs}" fill-opacity="${ds}"/></svg> `,width:ao,height:ao,funcType:Ot.sort,name:"sort_downward",positionType:It.contentRight,marginLeft:3,hover:{width:ho,height:ho,bgColor:"rgba(101, 117, 168, 0.1)"},cursor:"pointer"}},get sort_upward(){return{type:"svg",svg:`<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.6665 9H11.3332L7.99984 13.1667L4.6665 9Z" fill="${hs}"  fill-opacity="${ds}"/><path d="M11.3335 7L4.66683 7L8.00016 2.83333L11.3335 7Z" fill="${Uc}"  fill-opacity="${$c}"/> </svg>`,width:ao,height:ao,funcType:Ot.sort,positionType:It.contentRight,name:"sort_upward",marginLeft:3,hover:{width:ho,height:ho,bgColor:"rgba(101, 117, 168, 0.1)"},cursor:"pointer"}},get sort_normal(){return{type:"svg",svg:`<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.6665 9H11.3332L7.99984 13.1667L4.6665 9Z" fill="${hs}" fill-opacity="${ds}"/><path d="M11.3335 7L4.66683 7L8.00016 2.83333L11.3335 7Z" fill="${hs}" fill-opacity="${ds}"/></svg> `,width:ao,height:ao,funcType:Ot.sort,positionType:It.contentRight,name:"sort_normal",marginLeft:3,hover:{width:ho,height:ho,bgColor:"rgba(101, 117, 168, 0.1)"},cursor:"pointer"}},get freeze(){return{type:"svg",svg:`<svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg"><g clip-path="url(#clip0)"><path d="M17.1313 8.42047C17.1932 8.48238 17.2423 8.55587 17.2759 8.63676C17.3094 8.71764 17.3266 8.80434 17.3266 8.89189C17.3266 8.97944 17.3094 9.06613 17.2759 9.14702C17.2423 9.2279 17.1932 9.3014 17.1313 9.3633L13.3843 13.1103C13.7007 14.3048 13.5305 15.4443 12.8388 16.2395C12.8104 16.2781 12.7778 16.3136 12.7417 16.3451L12.712 16.3755C12.6501 16.4374 12.5766 16.4865 12.4957 16.52C12.4148 16.5535 12.3281 16.5707 12.2406 16.5707C12.153 16.5707 12.0663 16.5535 11.9854 16.52C11.9046 16.4865 11.8311 16.4374 11.7692 16.3755L9.17633 13.7826L6.05316 16.9058L5.11983 17.0925C5.09291 17.0979 5.06508 17.0965 5.03881 17.0886C5.01254 17.0806 4.98863 17.0663 4.96923 17.0469C4.94982 17.0275 4.9355 17.0036 4.92755 16.9773C4.9196 16.951 4.91827 16.9232 4.92366 16.8963L5.11033 15.963L8.23333 12.8396L5.64066 10.2471C5.57875 10.1852 5.52964 10.1117 5.49614 10.0309C5.46263 9.94997 5.44539 9.86327 5.44539 9.77572C5.44539 9.68817 5.46263 9.60148 5.49614 9.52059C5.52964 9.43971 5.57875 9.36621 5.64066 9.3043C5.65066 9.2943 5.66066 9.2843 5.67099 9.27464C5.70266 9.2383 5.73833 9.20547 5.77766 9.17664C6.57283 8.48564 7.71199 8.31564 8.90599 8.63197L12.6528 4.88497C12.7147 4.82306 12.7882 4.77395 12.8691 4.74045C12.95 4.70694 13.0367 4.6897 13.1242 4.6897C13.2118 4.6897 13.2985 4.70694 13.3794 4.74045C13.4603 4.77395 13.5338 4.82306 13.5957 4.88497L17.1312 8.42047H17.1313ZM15.7172 8.8918L13.1243 6.29914L9.56483 9.8588C9.47574 9.94788 9.36323 10.0099 9.24034 10.0376C9.11746 10.0654 8.98922 10.0578 8.87049 10.0156C8.22783 9.78764 7.63899 9.7553 7.17749 9.89814L12.1182 14.8388C12.261 14.3771 12.2287 13.7885 12.0007 13.146C11.9585 13.0272 11.9509 12.899 11.9787 12.7761C12.0064 12.6532 12.0684 12.5407 12.1575 12.4516L15.7172 8.89164V8.8918Z" fill="${Kc}" fill-opacity="${Z_}"/></g><defs><clipPath id="clip0"><rect width="22" height="22" fill="white"/></clipPath></defs></svg>`,width:uo,height:uo,name:"freeze",funcType:Ot.frozen,positionType:It.right,marginRight:0,hover:{width:co,height:co,bgColor:"rgba(101, 117, 168, 0.1)"},cursor:"pointer"}},get frozen(){return{type:"svg",svg:`<svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M8.49975 3.66663C8.32294 3.66663 8.15337 3.73686 8.02835 3.86189C7.90332 3.98691 7.83309 4.15648 7.83309 4.33329V9.63246C6.76475 10.2533 6.07942 11.1795 6.00625 12.2308C5.99892 12.2786 5.99692 12.3268 6.00009 12.3741L5.99975 12.4166C5.99975 12.5934 6.06999 12.763 6.19501 12.888C6.32004 13.0131 6.48961 13.0833 6.66642 13.0833H10.3333L10.3331 17.5L10.8611 18.292C10.8763 18.3148 10.8969 18.3335 10.9211 18.3464C10.9453 18.3594 10.9723 18.3662 10.9998 18.3662C11.0272 18.3662 11.0542 18.3594 11.0784 18.3464C11.1026 18.3335 11.1232 18.3148 11.1384 18.292L11.6664 17.5L11.6666 13.0833H15.3331C15.5099 13.0833 15.6795 13.0131 15.8045 12.888C15.9295 12.763 15.9998 12.5934 15.9998 12.4166C15.9998 12.4025 15.9998 12.3883 15.9994 12.3741C16.0028 12.3263 16.0008 12.2776 15.9933 12.2295C15.9196 11.1786 15.2343 10.2528 14.1664 9.63229V4.33329C14.1664 4.15648 14.0962 3.98691 13.9712 3.86189C13.8461 3.73686 13.6766 3.66663 13.4998 3.66663H8.49975Z" fill="${Kc}" fill-opacity="${q_}"/></svg>`,width:uo,height:uo,name:"frozen",funcType:Ot.frozen,positionType:It.right,marginRight:0,hover:{width:co,height:co,bgColor:"rgba(101, 117, 168, 0.1)"},cursor:"pointer"}},get frozenCurrent(){return{type:"svg",svg:`<svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M8.49975 3.66663C8.32294 3.66663 8.15337 3.73686 8.02835 3.86189C7.90332 3.98691 7.83309 4.15648 7.83309 4.33329V9.63246C6.76475 10.2533 6.07942 11.1795 6.00625 12.2308C5.99892 12.2786 5.99692 12.3268 6.00009 12.3741L5.99975 12.4166C5.99975 12.5934 6.06999 12.763 6.19501 12.888C6.32004 13.0131 6.48961 13.0833 6.66642 13.0833H10.3333L10.3331 17.5L10.8611 18.292C10.8763 18.3148 10.8969 18.3335 10.9211 18.3464C10.9453 18.3594 10.9723 18.3662 10.9998 18.3662C11.0272 18.3662 11.0542 18.3594 11.0784 18.3464C11.1026 18.3335 11.1232 18.3148 11.1384 18.292L11.6664 17.5L11.6666 13.0833H15.3331C15.5099 13.0833 15.6795 13.0131 15.8045 12.888C15.9295 12.763 15.9998 12.5934 15.9998 12.4166C15.9998 12.4025 15.9998 12.3883 15.9994 12.3741C16.0028 12.3263 16.0008 12.2776 15.9933 12.2295C15.9196 11.1786 15.2343 10.2528 14.1664 9.63229V4.33329C14.1664 4.15648 14.0962 3.98691 13.9712 3.86189C13.8461 3.73686 13.6766 3.66663 13.4998 3.66663H8.49975Z"  fill="${J_}" fill-opacity="${Q_}"/></svg>`,width:uo,height:uo,funcType:Ot.frozen,positionType:It.right,name:"frozenCurrent",marginRight:0,hover:{width:co,height:co,bgColor:"rgba(101, 117, 168, 0.1)"},cursor:"pointer"}},get dropdownIcon(){return{type:"svg",svg:'<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g><rect x="2" y="1" width="20" height="20" rx="10" fill="white"/><rect x="2.5" y="1.5" width="19" height="19" rx="9.5" stroke="#959DA5"/></g><path d="M14.9492 9.39531C15.0086 9.31911 15.0165 9.21887 14.9698 9.1356C14.923 9.05234 14.8294 9 14.7273 9L9.27273 9C9.17057 9 9.07697 9.05234 9.03023 9.1356C8.98348 9.21887 8.99142 9.31911 9.0508 9.39531L11.7781 12.8953C11.8293 12.961 11.9119 13 12 13C12.0881 13 12.1707 12.961 12.2219 12.8953L14.9492 9.39531Z" fill="#4F5965"/></svg>',width:24,height:24,funcType:Ot.dropDown,positionType:It.absoluteRight,name:"dropdownIcon",marginRight:0,hover:{width:24,height:24,bgColor:"rgba(101, 117, 168, 0.1)",image:'<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g><rect x="2" y="1" width="20" height="20" rx="10" fill="#1E54C9"/><rect x="2.5" y="1.5" width="19" height="19" rx="9.5" stroke="#141414" stroke-opacity="0.2"/></g><path d="M14.9492 9.39531C15.0086 9.31911 15.0165 9.21887 14.9698 9.1356C14.923 9.05234 14.8294 9 14.7273 9L9.27273 9C9.17057 9 9.07697 9.05234 9.03023 9.1356C8.98348 9.21887 8.99142 9.31911 9.0508 9.39531L11.7781 12.8953C11.8293 12.961 11.9119 13 12 13C12.0881 13 12.1707 12.961 12.2219 12.8953L14.9492 9.39531Z" fill="white"/></svg>'},cursor:"pointer",visibleTime:"mouseenter_cell"}},get play(){return{type:"svg",svg:'<svg width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="48" height="48" fill="white" fill-opacity="0.01" /><path d="M24 44C35.0457 44 44 35.0457 44 24C44 12.9543 35.0457 4 24 4C12.9543 4 4 12.9543 4 24C4 35.0457 12.9543 44 24 44Z" fill="none" stroke="#686a6e" stroke-width="4" stroke-linejoin="round" stroke-opacity="0.7" /><path d="M20 24V17.0718L26 20.5359L32 24L26 27.4641L20 30.9282V24Z" fill="none" stroke="#686a6e" stroke-width="4" stroke-linejoin="round" stroke-opacity="0.7" /></svg>',width:24,height:24,funcType:Ot.play,positionType:It.right,name:"play",marginRight:0,hover:{width:24,height:24,bgColor:"rgba(101, 117, 168, 0.1)"},cursor:"pointer"}},get damage_pic(){return{type:"svg",svg:'<svg width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M5 10V38C5 39.1046 5.89543 40 7 40H14H18L15 29L22 27L21 20L29 16L27 13L30 8H7C5.89543 8 5 8.89543 5 10Z" fill="none" stroke="#333" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/><path d="M43 38V10C43 8.89543 42.1046 8 41 8H38L34 14L37 19L28 23L29 31L22 33L24 40H41C42.1046 40 43 39.1046 43 38Z" fill="none" stroke="#333" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/><path fill-rule="evenodd" clip-rule="evenodd" d="M14.5 18C15.3284 18 16 17.3284 16 16.5C16 15.6716 15.3284 15 14.5 15C13.6716 15 13 15.6716 13 16.5C13 17.3284 13.6716 18 14.5 18Z" fill="none" stroke="#333" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/></svg>',width:24,height:24,funcType:Ot.damagePic,positionType:It.left,name:"damage_pic",marginRight:0,hover:{width:24,height:24,bgColor:"rgba(101, 117, 168, 0.1)"},cursor:"pointer"}},get loading_pic(){return{type:"svg",svg:'<svg viewBox="0 0 400 300" fill="none" xmlns="http://www.w3.org/2000/svg"><mask id="a" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="50" y="65" width="301" height="170"><path d="M350.3 65H50v169.8h300.3V65Z" fill="#fff"/></mask><g mask="url(#a)"><path fill-rule="evenodd" clip-rule="evenodd" d="M58.3 233.2h32.8v-36.8H58.3v36.8Z" fill="#C7DEFF"/><path d="M91.1 224.5v8.8H58.3M82.4 196.2H58.3" stroke="#071F4D"/><path fill-rule="evenodd" clip-rule="evenodd" d="M305.4 182.5s-2.7 12.6 0 17.4c2.7 4.8 8.3 6.7 12.4 4.4 4.2-2.4 5.3-8.1 2.6-12.9-2.7-4.8-15-8.9-15-8.9ZM336 204.7c4.3 2 9.7-.4 12-5.4 2.3-5-1.5-17.3-1.5-17.3s-11.8 5.1-14.1 10.1c-2.3 5-.7 10.6 3.6 12.6Z" fill="#00E4E5"/><path fill-rule="evenodd" clip-rule="evenodd" d="M326.7 174s-10 11.8-10 18.6c0 6.7 4.5 12.2 10 12.2s10-5.5 10-12.3c0-6.8-10-18.5-10-18.5Z" fill="#00E4E5"/><path d="M332.3 181.5c2.3 3.6 4.4 7.8 4.4 10.9M316.7 192.5c0-3.1 2.1-7.2 4.3-10.8" stroke="#071F4D"/><path fill-rule="evenodd" clip-rule="evenodd" d="M343.1 227.3v-9.7h-34v9.7c0 3.7 3 6.6 6.6 6.6h20.9c3.6 0 6.5-2.9 6.5-6.6Z" fill="#071F4D"/><path fill-rule="evenodd" clip-rule="evenodd" d="M350.4 220.8V198H302v22.8c0 5.9 4.8 10.7 10.7 10.7h26.9c5.9 0 10.7-4.8 10.8-10.7Z" fill="#C7DEFF"/><path fill-rule="evenodd" clip-rule="evenodd" d="M331.7 74.2H117.8L87.4 203h213.8l30.5-128.8Z" fill="#fff"/><path fill-rule="evenodd" clip-rule="evenodd" d="M337 74.2h-6.2l-30.6 129.2h6.2L337 74.2Z" fill="#fff"/><path fill-rule="evenodd" clip-rule="evenodd" d="M303.8 203.5h2.4l30.7-129.3h-1.8l-31.3 129.3Z" fill="#C7DEFF"/><path d="m337 74.2-30.6 129.2h-5.9" stroke="#071F4D"/><path fill-rule="evenodd" clip-rule="evenodd" d="M229.9 202.1h-47.6l2 9.6h47.3l-1.7-9.6Z" fill="#C7DEFF"/><path fill-rule="evenodd" clip-rule="evenodd" d="M94.7 172.6 87.4 203h213.1l7.8-30.4H94.7Z" fill="#006EFF"/><path fill-rule="evenodd" clip-rule="evenodd" d="M94.7 172.6 87.4 203h213.1l7.8-30.4H94.7Z" fill="#006EFF"/><path d="M138.5 74.2h193.2l-23.4 98.6M94.5 172.7l11-46.3M104.8 155.4l-2.3 11.5h6.7M316 112.1l1.1-4.5" stroke="#071F4D"/><path fill-rule="evenodd" clip-rule="evenodd" d="M148.3 138.1h97V119h-97v19.1Z" fill="#00E4E5"/><path d="M303.1 80.6h20.3l-4.6 19.6M228.3 234.3c3.6 0 6.3-3.2 5.7-6.8l-4.1-24.1" stroke="#071F4D"/><path fill-rule="evenodd" clip-rule="evenodd" d="M226.2 229.5h-68.9v1.2c0 2 1.6 3.7 3.7 3.7h60.1c2.8 0 5-2.2 5.1-4.9Z" fill="#C7DEFF"/><path d="M180.699 226.8h-19.9c-2.8 0-4.6 3-3.3 5.5m0 0c.6 1.2 1.9 2 3.3 2h57.8M175.9 203.4l3.6 17.6M241.2 234.3h65.1M104.6 234.3h41.3" stroke="#071F4D"/><path d="M206.2 234.3h14.9c3.1 0 5.5-2.8 5-5.9l-4.3-24.9M160.7 226.8h46M62.2 226.1h-9.5c-1.2 0-2.2-1-2.2-2.2v-18.3c0-1.2 1-2.2 2.2-2.2h9.5" stroke="#071F4D"/><path d="M53.4 171.7H68c2.1 0 3.7 1.7 3.7 3.7v16.1M79.1 192v-21.8c0-2.5 2-4.6 4.6-4.6h2.2c2.5 0 4.5-2 4.5-4.5m0 0c0-2.5-2-4.5-4.5-4.5H56.1c-2.4 0-4.3-1.9-4.3-4.3V148M71.2 165.2h-18M64 181.7v10.1" stroke="#C7DEFF"/><path fill-rule="evenodd" clip-rule="evenodd" d="M85.7 120H124c4.3 0 7.7-3.5 7.7-7.7V65.5H94.2c-4.7 0-8.5 4.9-8.5 11V120Z" fill="#C7DEFF"/><path d="M85.7 110.7V73c0-4.1 3.4-7.5 7.5-7.5h38.5M146.2 73.8v-2.5c0-3.2-2-5.8-5.8-5.8-2.8 0-6 1.1-6 5.8v42.4c0 4.7-3.8 8.5-8.5 8.5h-15.6" stroke="#071F4D"/><path d="M119.7 122.3H87c-6.1 0-11.1-5-11.1-11.1m0 0h39M126.1 122.3c-6.1 0-11.1-5-11.1-11.1" stroke="#071F4D"/><path fill-rule="evenodd" clip-rule="evenodd" d="M85.4 122.1h37.2c-6.5-1.8-8-10.5-8-10.5H76.2c.6 8.8 9.2 10.5 9.2 10.5Z" fill="#071F4D"/><path fill-rule="evenodd" clip-rule="evenodd" d="M95.8 102.9h4.8V83.6h-4.8v19.3ZM106.6 102.9h4.8V77.6h-4.8v25.3ZM117.3 102.9h4.8V89.1h-4.8v13.8Z" fill="#fff"/><path d="M273.2 195.9h16.9M261.2 195.9h5" stroke="#fff"/><path d="M62.4 201.9v2.9M62.4 224.5v2.9" stroke="#071F4D"/><path d="m153.6 138.1 9.7-19.1M168.8 138.1l9.7-19.1M184.1 138.1l9.7-19.1M199.4 138.1l9.7-19.1M214.6 138.1l9.8-19.1M229.9 138.1l9.7-19.1" stroke="#fff"/><path d="M148.3 138.1h121.6V119H148.3v19.1Z" stroke="#071F4D"/></g></svg>',width:400,height:300,name:"loading_pic",positionType:It.left}},get expand(){return{type:"svg",svg:`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none">
      <path d="M4.64988 6.81235C4.38797 6.48497 4.62106 6 5.04031 6L10.9597 6C11.3789 6 11.612 6.48497 11.3501 6.81235L8.39043 10.512C8.19027 10.7622 7.80973 10.7622 7.60957 10.512L4.64988 6.81235Z" fill="${iw}" fill-opacity="${nw}"/>
      </svg>`,width:qc,height:qc,funcType:Ot.expand,name:"expand",positionType:It.contentLeft,marginLeft:0,marginRight:4,hover:{width:Zc,height:Zc,bgColor:"rgba(101, 117, 168, 0.1)"},cursor:"pointer"}},get collapse(){return{type:"svg",svg:`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none">
      <path d="M5.81235 11.3501C5.48497 11.612 5 11.3789 5 10.9597L5 5.04031C5 4.62106 5.48497 4.38797 5.81235 4.64988L9.51196 7.60957C9.76216 7.80973 9.76216 8.19027 9.51196 8.39044L5.81235 11.3501Z"  fill="${tw}" fill-opacity="${ew}"/>
      </svg>`,width:Yc,height:Yc,funcType:Ot.collapse,name:"collapse",positionType:It.contentLeft,marginLeft:0,marginRight:4,hover:{width:Xc,height:Xc,bgColor:"rgba(101, 117, 168, 0.1)"},cursor:"pointer"}},get drillDown(){return{name:"drillDown",type:"svg",positionType:It.absolute,funcType:Ot.drillDown,svg:X2,width:13,height:13,cursor:"pointer"}},get drillUp(){return{name:"drillUp",type:"svg",positionType:It.absolute,funcType:Ot.drillUp,svg:q2,width:13,height:13,cursor:"pointer"}},get dragReorder(){return{type:"svg",svg:`<svg t="1710129136961" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5166" width="200" height="200"><path d="M362.666667 192m-64 0a64 64 0 1 0 128 0 64 64 0 1 0-128 0Z" fill="${go}"  fill-opacity="${fo}" p-id="5167"></path><path d="M661.333333 192m-64 0a64 64 0 1 0 128 0 64 64 0 1 0-128 0Z" fill="${go}"  fill-opacity="${fo}" p-id="5168"></path><path d="M362.666667 512m-64 0a64 64 0 1 0 128 0 64 64 0 1 0-128 0Z" fill="${go}"  fill-opacity="${fo}" p-id="5169"></path><path d="M661.333333 512m-64 0a64 64 0 1 0 128 0 64 64 0 1 0-128 0Z" fill="${go}"  fill-opacity="${fo}" p-id="5170"></path><path d="M362.666667 832m-64 0a64 64 0 1 0 128 0 64 64 0 1 0-128 0Z" fill="${go}"  fill-opacity="${fo}" p-id="5171"></path><path d="M661.333333 832m-64 0a64 64 0 1 0 128 0 64 64 0 1 0-128 0Z" fill="${go}"  fill-opacity="${fo}" p-id="5172"></path></svg>`,width:Jc,height:Jc,funcType:Ot.dragReorder,positionType:It.left,name:"dragReorder",marginLeft:-10,marginRight:10,cursor:"grab"}}};function Ni(){return dl(tk,QH)}class Tt extends Gi{clear(){this.removeAllChild()}getChildByName(t,e){let n=null;return this.forEachChildren(o=>o.name===t&&(n=o,!0)),e&&this.forEachChildren(o=>{if(o.getChildByName){const r=o.getChildByName(t,!0);if(r)return n=r,!0}return!1}),n}get width(){var t;let e=this.AABBBounds.width();return e!==1/0&&e!==-1/0||(e=0),Math.max(e,(t=this.attribute.width)!==null&&t!==void 0?t:0)}get height(){var t;let e=this.AABBBounds.height();return e!==1/0&&e!==-1/0||(e=0),Math.max(e,(t=this.attribute.height)!==null&&t!==void 0?t:0)}setDeltaWidth(t){var e;t!==0&&(this.setAttribute("width",((e=this.attribute.width)!==null&&e!==void 0?e:0)+t),this.border&&(this.border.setAttribute("width",this.border.attribute.width+t),this.border.type==="group"&&this.border.firstChild.setAttribute("width",this.border.firstChild.attribute.width+t)))}setDeltaHeight(t){var e;t!==0&&(this.setAttribute("height",((e=this.attribute.height)!==null&&e!==void 0?e:0)+t),this.border&&(this.border.setAttribute("height",this.border.attribute.height+t),this.border.type==="group"&&this.border.firstChild.setAttribute("width",this.border.firstChild.attribute.height+t)))}setDeltaX(t){t!==0&&this.setAttribute("x",this.attribute.x+t)}setDeltaY(t){t!==0&&this.setAttribute("y",this.attribute.y+t)}forEachChildrenSkipChild(t,e="border-rect",n=!1){if(n){let o=this._lastChild,r=0;for(;o;){if(o.name!==e&&t(o,r++))return;o=o._prev}}else{let o=this._firstChild,r=0;for(;o;){if(o.name!==e&&t(o,r++))return;o=o._next}}}getColGroup(t){let e=this._firstChild;if(!e)return null;for(let n=0;n<this.childrenCount;n++){if(e.col===t)return e;e=e._next}return null}getRowGroup(t){let e=this._firstChild;if(!e)return null;for(let n=0;n<this.childrenCount;n++){if(e.row===t)return e;e=e._next}return null}addCellGroup(t){if(this.childrenCount===0||this.lastChild.row===t.row-1)this.addChild(t);else{let e=this._firstChild;for(let n=0;n<this.childrenCount;n++){if(e.row===t.row-1)return void this.insertAfter(t,e);e=e._next}this.addChild(t)}}getChildAt(t){const e=super.getChildAt(t);return e&&e.name==="border-rect"?e._next:e}tryUpdateAABBBounds(){if(this.role==="cell"){if(!this.shouldUpdateAABBBounds())return this._AABBBounds;const t=this.shouldSelfChangeUpdateAABBBounds(),e=this.doUpdateAABBBounds();return this.addUpdateLayoutTag(),ek(this,t),e}return super.tryUpdateAABBBounds()}doUpdateAABBBounds(){if(this.role==="cell"){const t=this.attribute,{x:e,y:n,width:o,height:r}=t;return this._AABBBounds.setValue(e,n,e+o,n+r),this.parent&&this.parent.addChildUpdateBoundTag(),this.clearUpdateBoundTag(),this.shadowRoot&&this.shadowRoot.tryUpdateAABBBounds(),this._AABBBounds}return this.role==="body"||this.role==="row-header"||this.role==="col-header"||this.role==="right-frozen"||this.role==="bottom-frozen"||this.role==="corner-header"||this.role==="corner-right-top-header"||this.role==="corner-right-bottom-header"||this.role==="corner-left-bottom-header"?(this._AABBBounds.setValue(-1/0,-1/0,1/0,1/0),this.parent&&this.parent.addChildUpdateBoundTag(),this.clearUpdateBoundTag(),this.shadowRoot&&this.shadowRoot.tryUpdateAABBBounds(),this._AABBBounds):super.doUpdateAABBBounds()}updateColumnRowNumber(t){this.rowNumber?this.rowNumber=Math.max(this.rowNumber,t):this.rowNumber=t}updateColumnHeight(t){this.colHeight?this.colHeight+=t:this.colHeight=t}}function ek(i,t){i.stage&&i.stage.dirtyBounds&&i.stage.renderCount&&(i.isContainer&&!t||i.stage.dirty(i.globalAABBBounds))}function xd(i,t,e,n){const o=i/t;let r,s;return o>e/n?(r=e,s=r/o,(n-s)/2):(s=n,r=s*o,(e-r)/2),{width:r,height:s}}function Zg(i,t,e,n,o,r,s="left",l="middle",a=[0,0,0,0],h=0,d=0,u=0,c=0){const f=i+e,g=t+n;let p=i+a[3]+h;s==="right"||s==="end"?p=f-o-a[1]-d:s==="center"&&(p=i+(e-o+h-d)/2);let v=t+a[0]+u;return l==="bottom"||l==="alphabetic"||l==="ideographic"?v=g-r-a[2]-c:l==="middle"&&(v=t+(n-r+u-c)/2),{x:p,y:v}}function q(i,t,e,n,o){const r=t&&O(t[i])?t[i]:void 0;return typeof r=="function"?r({col:e,row:n,table:o,value:o.getCellValue(e,n),dataValue:o.getCellOriginValue(e,n),cellHeaderPaths:o.getCellHeaderPaths(e,n)}):r}function Rd(i,t,e,n,o){const r=t&&O(t[i])?t[i]:void 0;if(typeof r=="function")return r({col:e,row:n,table:o,value:o.getCellValue(e,n),dataValue:o.getCellOriginValue(e,n),cellHeaderPaths:o.getCellHeaderPaths(e,n)})}function rn(i,t,e,n){var o,r,s,l,a,h,d,u,c,f,g,p,v,m,b,C,_,w;let y=(r=(o=e==null?void 0:e.group)===null||o===void 0?void 0:o.strokeArrayWidth)!==null&&r!==void 0?r:void 0;return n.theme.cellInnerBorder||!d2(n.theme.frameStyle.borderLineWidth)||u2(n.theme.frameStyle.borderLineWidth)||(i===0&&(y=y??[(s=e==null?void 0:e.group)===null||s===void 0?void 0:s.lineWidth,(l=e==null?void 0:e.group)===null||l===void 0?void 0:l.lineWidth,(a=e==null?void 0:e.group)===null||a===void 0?void 0:a.lineWidth,(h=e==null?void 0:e.group)===null||h===void 0?void 0:h.lineWidth],y[3]=0),i===n.colCount-1&&(y=y??[(d=e==null?void 0:e.group)===null||d===void 0?void 0:d.lineWidth,(u=e==null?void 0:e.group)===null||u===void 0?void 0:u.lineWidth,(c=e==null?void 0:e.group)===null||c===void 0?void 0:c.lineWidth,(f=e==null?void 0:e.group)===null||f===void 0?void 0:f.lineWidth],y[1]=0),t===0&&(y=y??[(g=e==null?void 0:e.group)===null||g===void 0?void 0:g.lineWidth,(p=e==null?void 0:e.group)===null||p===void 0?void 0:p.lineWidth,(v=e==null?void 0:e.group)===null||v===void 0?void 0:v.lineWidth,(m=e==null?void 0:e.group)===null||m===void 0?void 0:m.lineWidth],y[0]=0),t===n.rowCount-1&&(y=y??[(b=e==null?void 0:e.group)===null||b===void 0?void 0:b.lineWidth,(C=e==null?void 0:e.group)===null||C===void 0?void 0:C.lineWidth,(_=e==null?void 0:e.group)===null||_===void 0?void 0:_.lineWidth,(w=e==null?void 0:e.group)===null||w===void 0?void 0:w.lineWidth],y[2]=0)),y}class ik extends Tt{constructor(t){super(t),this._autoWidth=!1,this._autoHeight=!1,this._leftGroup=new Tt({pickable:!1,fill:!1,stroke:!1}),this._leftGroup.role="content-left",this._rightGroup=new Tt({pickable:!1,fill:!1,stroke:!1}),this._rightGroup.role="content-right",this._centerGroup=new Tt({pickable:!1,fill:!1,stroke:!1}),this._centerGroup.role="content-center",this.appendChild(this._leftGroup),this.appendChild(this._rightGroup),this.appendChild(this._centerGroup)}setCellContentOption(t){this._autoWidth=t.autoWidth,this._autoHeight=t.autoHeight,this._cellWidth=t.cellWidth,this._originCellWidth=t.cellWidth,this._cellHeight=t.cellHeight,this._align=t.align,this._baseline=t.baseline}addLeftOccupyingIcon(t){var e,n,o;t.setAttribute("x",this._leftGroup.width+((e=t.attribute.marginLeft)!==null&&e!==void 0?e:0)),this._leftGroup.appendChild(t),this._leftGroup.setDeltaWidth(((n=t.attribute.marginLeft)!==null&&n!==void 0?n:0)+((o=t.attribute.marginRight)!==null&&o!==void 0?o:0)+t.attribute.width)}addRightOccupyingIcon(t){var e,n,o;t.setAttribute("x",this._rightGroup.width+((e=t.attribute.marginLeft)!==null&&e!==void 0?e:0)),this._rightGroup.appendChild(t),this._rightGroup.setDeltaWidth(((n=t.attribute.marginLeft)!==null&&n!==void 0?n:0)+((o=t.attribute.marginRight)!==null&&o!==void 0?o:0)+t.attribute.width)}addContent(t){const e=this._centerGroup.lastChild;e&&t.setAttributes({x:e.attribute.x+e.AABBBounds.width()}),this._centerGroup.appendChild(t),t instanceof xe&&(this._centerGroup.setAttribute("pickable",!1),t.setAttribute("textAlign","left"))}layout(){let t=this._leftGroup.width;t===1/0&&(t=0);let e=this._rightGroup.width;if(e===-1/0&&(e=0),this._autoWidth){const s=this._centerGroup.width;this._cellWidth=t+e+s,this.setAttribute("width",this._cellWidth)}else{const s=this._cellWidth-t-e;this.updateCenterLayout(s);const l=this._centerGroup.width;this._cellWidth=t+e+l,this.setAttribute("width",this._cellWidth)}this.updateHorizontalPos();const n=this._leftGroup.height,o=this._rightGroup.height,r=this._centerGroup.height;this._cellHeight=Math.max(n,o,r),this.setAttribute("height",this._cellHeight),this.updateVerticalPos()}updateCenterLayout(t){let e=t;this._centerGroup.forEachChildren(r=>{(r instanceof Fo||r instanceof $_)&&(e-=r.AABBBounds.width())});const n=this._centerGroup.getChildByName("text");n instanceof Di?n.setAttribute("width",e):n instanceof xe&&n.setAttribute("maxLineWidth",e);let o=0;this._centerGroup.forEachChildren(r=>{r.setAttribute("x",o),o+=r.AABBBounds.width()})}updateHorizontalPos(){this._leftGroup.setAttribute("x",0),this._rightGroup.setAttribute("x",this._cellWidth-this._rightGroup.width),this._centerGroup.setAttribute("x",this._leftGroup.width),this._align==="left"||this._align==="start"?this.setAttribute("dx",0):this._align==="center"?this.setAttribute("dx",-this.attribute.width/2):this._align!=="right"&&this._align!=="end"||this.setAttribute("dx",-this.attribute.width)}updateVerticalPos(){this._baseline==="top"?(this._leftGroup.setAttribute("y",0),this._rightGroup.setAttribute("y",0),this._centerGroup.setAttribute("y",0)):this._baseline==="middle"?(this._leftGroup.forEachChildren(t=>{t.setAttribute("y",(this._leftGroup.height-t.AABBBounds.height())/2)}),this._rightGroup.forEachChildren(t=>{t.setAttribute("y",(this._rightGroup.height-t.AABBBounds.height())/2)}),this._leftGroup.setAttribute("y",this._cellHeight/2-this._leftGroup.height/2),this._rightGroup.setAttribute("y",this._cellHeight/2-this._rightGroup.height/2),this._centerGroup.setAttribute("y",this._cellHeight/2-this._centerGroup.height/2)):this._baseline==="bottom"&&(this._leftGroup.forEachChildren(t=>{t.setAttribute("y",this._leftGroup.height-t.AABBBounds.height())}),this._rightGroup.forEachChildren(t=>{t.setAttribute("y",this._rightGroup.height-t.AABBBounds.height())}),this._leftGroup.setAttribute("y",this._cellHeight-this._leftGroup.height),this._rightGroup.setAttribute("y",this._cellHeight-this._rightGroup.height),this._centerGroup.setAttribute("y",this._cellHeight-this._centerGroup.height))}updateWidth(t){this._cellWidth=t,this._originCellWidth=t,this.layout()}updateHeight(t){this._cellHeight=t,this._cellWidth=this._originCellWidth;const e=this.getChildByName("text",!0);e&&e.setAttribute("heightLimit",t),this.layout()}}function ui(i,t,e){var n,o,r,s,l;let a=0;const h=e.internalProps.layoutMap;if(h.isHeader(i,t)){const d=h.getHeader(i,t);O(d==null?void 0:d.hierarchyLevel)&&(a=((n=d.hierarchyLevel)!==null&&n!==void 0?n:0)*(h.rowHierarchyType==="tree"&&(o=h.rowHierarchyIndent)!==null&&o!==void 0?o:0),h.rowHierarchyTextStartAlignment&&!e.internalProps.headerHelper.getHierarchyIcon(i,t)&&(a+=e.internalProps.headerHelper.getHierarchyIconWidth()))}else if(e.options.groupBy||!((r=e.getBodyColumnDefine(i,t))===null||r===void 0)&&r.tree){const d=e.dataSource.getIndexKey(e.getRecordShowIndexByCell(i,t)),u=(s=e.dataSource.getGroupLength())!==null&&s!==void 0?s:0;let c=Q(d)?d.length-1:0;u>0&&c===u&&(c=0),a=Array.isArray(d)&&e.getHierarchyState(i,t)!==mt.none?c*((l=h.hierarchyIndent)!==null&&l!==void 0?l:0):0,h.hierarchyTextStartAlignment&&!e.internalProps.bodyHelper.getHierarchyIcon(i,t)&&(a+=e.internalProps.bodyHelper.getHierarchyIconWidth())}return a}function Xs(i,t){var e,n;let o,r=!1;for(jt(i)&&i.length>(t.options.maxCharactersNumber||200)&&(i=i.slice(0,t.options.maxCharactersNumber||200),i+="…",r=!0),o=t.internalProps.enableLineBreak||!((e=t.options.customConfig)===null||e===void 0)&&e.multilinesForXTable?Rv(i).replace(/\r?\n/g,`
`).replace(/\r/g,`
`).split(`
`)||[]:[Rv(i)];o.length&&o.length>1&&!o[o.length-1];)o.pop();if(!((n=t.options.customConfig)===null||n===void 0)&&n.multilinesForXTable&&!t.internalProps.autoWrapText)for(;o.length&&o.length>1&&!o[0];)o.shift();return{text:o,moreThanMaxCharacters:r}}function nk(i,t,e,n,o,r,s,l,a,h,d,u,c,f,g){var p,v,m,b,C,_,w,y,x;let S,R=0,B=0,A=0;if(Array.isArray(t)&&t.length!==0){const{inlineFrontIcons:E,inlineEndIcons:T,contentLeftIcons:P,contentRightIcons:H,leftIconWidth:L,rightIconWidth:F,absoluteRightIconWidth:z}=Dr(t,i,g,c);let I;if(R=L,B=F,A=z,E.length===0&&T.length===0){let N=0;Z(c.theme._contentOffset)&&(d==="left"?N=c.theme._contentOffset:d==="right"&&(N=-c.theme._contentOffset));const W=g?ui(g.start.col,g.start.row,c):ui(i.col,i.row,c),{text:D,moreThanMaxCharacters:j}=Xs(e,c),V={text:D.length===1?D[0]:D,moreThanMaxCharacters:j,maxLineWidth:o?1/0:a-(n[1]+n[3])-R-B-W,textBaseline:"top",heightLimit:((b=c.options.customConfig)===null||b===void 0?void 0:b.limitContentHeight)===!1||r&&!(!((C=c.options.customConfig)===null||C===void 0)&&C.multilinesForXTable)?-1:h-Math.floor(n[0]+n[2]),pickable:!1,autoWrapText:s,lineClamp:l,wordBreak:"break-word",whiteSpace:((_=c.options.customConfig)===null||_===void 0?void 0:_.limitContentHeight)===!1||D.length!==1||s?"normal":"no-wrap",dx:(d==="left"?P.length?0:W:0)+N,keepCenterInLine:!0},X=new xe(f.text?Object.assign({},f.text,V):V);X.name="text",I=X}else{const N=Object.assign({text:e==null?void 0:e.toString()},((x=(y=(w=i.parent)===null||w===void 0?void 0:w.theme)===null||y===void 0?void 0:y.userTheme)===null||x===void 0?void 0:x.text)||{});f.text&&Object.assign(N,f.text),N.textBaseline="middle";const W=[...E.map(j=>ch(j)),N,...T.map(j=>ch(j))];W[0].textAlign=d;const D=new Di({width:o?0:a-(n[1]+n[3])-R-B,height:r&&s?0:Math.ceil(h-(n[0]+n[2])),textConfig:W,verticalDirection:r&&s?"top":u,ellipsis:N.ellipsis});D.name="text",I=D,D.bindIconEvent(),!g||g.start.col===g.end.col&&g.start.row===g.end.row||(D.onBeforeAttributeUpdate=rk)}if(P.length!==0||H.length!==0){const N=new ik({x:0,y:0,fill:!1,stroke:!1,pickable:!1});N.name="content",N.setCellContentOption({autoWidth:o,autoHeight:r,cellWidth:a-(n[1]+n[3])-R-B,cellHeight:h-(n[0]+n[2]),align:d,baseline:u});const W={addedHierarchyOffset:0};P.forEach(D=>{const j=Si(D,void 0,i.col,i.row,g,c,W);j.role="icon-content-left",j.name=D.name,N.addLeftOccupyingIcon(j)}),H.forEach(D=>{const j=Si(D,void 0,i.col,i.row,g,c,W);j.role="icon-content-right",j.name=D.name,N.addRightOccupyingIcon(j)}),N.addContent(I),i.appendChild(N),N.layout(),S=N.AABBBounds.width(),N.AABBBounds.height()}else i.firstChild?i.insertBefore(I,i.firstChild):i.appendChild(I),S=I.AABBBounds.width(),I.AABBBounds.height()}else if(O(e)){const{text:E,moreThanMaxCharacters:T}=Xs(e,c),P=g?ui(g.start.col,g.start.row,c):ui(i.col,i.row,c);let H=0;Z(c.theme._contentOffset)&&(d==="left"?H=c.theme._contentOffset:d==="right"&&(H=-c.theme._contentOffset));const L={text:E.length===1?E[0]:E,moreThanMaxCharacters:T,maxLineWidth:o?1/0:a-(n[1]+n[3]+P),textBaseline:"top",autoWrapText:s,lineClamp:l,wordBreak:"break-word",heightLimit:((p=c.options.customConfig)===null||p===void 0?void 0:p.limitContentHeight)===!1||r&&!(!((v=c.options.customConfig)===null||v===void 0)&&v.multilinesForXTable)?-1:h-Math.floor(n[0]+n[2]),pickable:!1,dx:(d==="left"?P:0)+H,whiteSpace:((m=c.options.customConfig)===null||m===void 0?void 0:m.limitContentHeight)===!1||E.length!==1||s?"normal":"no-wrap",keepCenterInLine:!0},F=new xe(f.text?Object.assign({},f.text,L):L);F.name="text",F.textBaseline=u,i.appendChild(F),S=F.AABBBounds.width(),F.AABBBounds.height()}const M=o?R+S+B:a-(n[1]+n[3]),k=h-(n[0]+n[2]);i.forEachChildren(E=>{E.role==="icon-left"?E.setAttribute("x",E.attribute.x+n[3]):E.role==="icon-right"?E.setAttribute("x",E.attribute.x+M-B+n[3]):E.role==="icon-absolute-right"?E.setAttribute("x",E.attribute.x+M-A+n[3]+n[1]):E.name!=="content"&&E.name!=="text"||(d==="center"&&E.type!=="richtext"?E.setAttribute("x",n[3]+R+(M-R-B)/2):d==="right"&&E.type!=="richtext"?E.setAttribute("x",n[3]+M-B):E.setAttribute("x",n[3]+R))}),i.forEachChildren(E=>{E.name!==tn&&(u==="middle"?E.setAttribute("y",n[0]+(k-E.AABBBounds.height())/2):u==="bottom"?E.setAttribute("y",n[0]+k-E.AABBBounds.height()):E.setAttribute("y",n[0]))}),i.setAttributes({width:M+n[1]+n[3],height:k+n[0]+n[2]})}function Si(i,t,e,n,o,r,s){var l,a,h,d,u,c;const f={};i.type==="image"?(i.isGif&&(f.gif=i.src),f.image=i.src):(i.type==="svg"||"svg"in i)&&(f.image=i.svg),f.width=i.width,f.height=i.height,f.visibleTime=(l=i.visibleTime)!==null&&l!==void 0?l:"always",f.funcType=i.funcType,f.interactive=i.interactive,f.isGif=i.isGif;let g,p=0;return s&&(s==null?void 0:s.addedHierarchyOffset)!==0||!Z(e)||!Z(n)||!r||i.funcType!==Ot.collapse&&i.funcType!==Ot.expand&&i.positionType!==It.contentLeft&&i.positionType!==It.contentRight||(p=o?ui(o.start.col,o.start.row,r):ui(e,n,r),s&&(s.addedHierarchyOffset=1)),f.marginLeft=((a=i.marginLeft)!==null&&a!==void 0?a:0)+p,f.marginRight=(h=i.marginRight)!==null&&h!==void 0?h:0,i.interactive===!1&&(f.pickable=!1),i.hover&&(f.backgroundWidth=(d=i.hover.width)!==null&&d!==void 0?d:i.width,f.backgroundHeight=(u=i.hover.width)!==null&&u!==void 0?u:i.width,f.backgroundColor=(c=i.hover.bgColor)!==null&&c!==void 0?c:"rgba(22,44,66,0.2)",f.hoverImage=i.hover.image),i.cursor&&(f.cursor=i.cursor),"shape"in i&&i.shape==="circle"&&(f.shape=i.shape),t?(t.setAttributes(f),t.loadImage(f.image),t.tooltip=i.tooltip,t.name=i.name,t):(i.type==="text"?(f.text=i.content,rt(f,i.style),g=new $_(f),g.tooltip=i.tooltip,g.name=i.name):(g=new Fo(f),g.tooltip=i.tooltip,g.name=i.name),g)}function ch(i){var t,e,n,o,r,s;const l={};return i.type==="image"?l.image=i.src:(i.type==="svg"||"svg"in i)&&(l.image=i.svg),l.visibleTime=(t=i.visibleTime)!==null&&t!==void 0?t:"always",l.funcType=i.funcType,l.id=i.name,l.width=i.width,l.height=i.height,(i.marginRight||i.marginLeft)&&(l.margin=[0,(e=i.marginRight)!==null&&e!==void 0?e:0,0,(n=i.marginLeft)!==null&&n!==void 0?n:0]),i.hover&&(l.backgroundWidth=(o=i.hover.width)!==null&&o!==void 0?o:i.width,l.backgroundHeight=(r=i.hover.height)!==null&&r!==void 0?r:i.height,l.backgroundShowMode="hover",l.hoverImage=i.hover.image,l.backgroundStroke=!1,l.backgroundFill=(s=i.hover.bgColor)!==null&&s!==void 0?s:"rgba(22,44,66,0.2)"),i.cursor&&(l.cursor=i.cursor),l.tooltip=i.tooltip,l}function gh(i,t,e,n,o,r,s,l,a){var h,d,u,c;Yt(i.contentWidth)&&(n=t-((h=i.contentWidth)!==null&&h!==void 0?h:i.attribute.width));let f,g=0,p=0,v=0,m=0;i.forEachChildren(y=>{var x,S,R,B;y.role==="icon-left"?(g+=y.AABBBounds.width()+((x=y.attribute.marginLeft)!==null&&x!==void 0?x:0)+((S=y.attribute.marginRight)!==null&&S!==void 0?S:0),p=Math.max(p,y.AABBBounds.height())):y.role==="icon-right"&&(v+=y.AABBBounds.width()+((R=y.attribute.marginLeft)!==null&&R!==void 0?R:0)+((B=y.attribute.marginRight)!==null&&B!==void 0?B:0),m=Math.max(m,y.AABBBounds.height()))});const b=i.getChildByName("text"),C=i.getChildByName("content");let _;b instanceof xe?(f=b.AABBBounds.height(),b.setAttribute("maxLineWidth",t-g-v-(r[1]+r[3])-((d=b.attribute.dx)!==null&&d!==void 0?d:0)-((u=a.table.theme._contentOffset)!==null&&u!==void 0?u:0)),_=b.AABBBounds.height()):b instanceof Di?(f=b.AABBBounds.height(),b.setAttribute("width",t-g-v-(r[1]+r[3])),_=b.AABBBounds.height()):C&&(f=C.AABBBounds.height(),C.updateWidth(t-g-v-(r[1]+r[3])),_=C.AABBBounds.height());const w=Math.round(Math.max(p,m,f)+r[0]+r[2]);if(i.forEachChildren(y=>{var x;if(y.role!=="icon-left")if(y.role==="icon-right")y.setAttribute("x",y.attribute.x+n);else if(y.role==="icon-absolute-right")y.setAttribute("x",y.attribute.x+n);else if(y.name==="content"||y.name==="text"&&y.type!=="richtext"){const S=(x=y.attribute.textAlign)!==null&&x!==void 0?x:s;S==="center"?y.setAttribute("x",r[3]+g+(t-(r[1]+r[3])-g-v)/2):S==="right"&&y.setAttribute("x",r[3]+t-(r[1]+r[3])-v)}else y.name==="mark"&&y.setAttribute("x",i.attribute.width)}),o){let y=Math.max(p,_,m);if(ok(a,i,Math.round(y+r[0]+r[2]),w))return!0;y=((c=i.contentHeight)!==null&&c!==void 0?c:e)-(r[0]+r[2]),i.forEachChildren(x=>{x.type!=="rect"&&x.type!=="chart"&&x.name!==tn&&(x.name==="mark"?x.setAttribute("y",0):l==="middle"?x.setAttribute("y",r[0]+(y-x.AABBBounds.height())/2):l==="bottom"?x.setAttribute("y",r[0]+y-x.AABBBounds.height()):x.setAttribute("y",r[0]))})}else l!=="middle"&&l!=="bottom"||i.forEachChildren(y=>{y.type!=="rect"&&y.type!=="chart"&&y.name!==tn&&(y.name==="mark"?y.setAttribute("y",0):l==="middle"?y.setAttribute("y",(e-r[2]+r[0]-y.AABBBounds.height())/2):l==="bottom"?y.setAttribute("y",e-y.AABBBounds.height()-r[2]):y.setAttribute("y",r[0]))});return!1}function fh(i,t,e,n,o,r,s,l){var a;const h=t-Math.floor(o[0]+o[2]),d=i.getChildByName("text");d instanceof xe&&!n?d.setAttributes({heightLimit:((a=l.options.customConfig)===null||a===void 0?void 0:a.limitContentHeight)===!1?-1:h}):d instanceof Di&&!n?d.setAttributes({height:h}):i.getChildByName("content")&&i.getChildByName("content").updateHeight(h),i.forEachChildren(u=>{u.setAttribute("dy",0),u.type==="rect"||u.type==="chart"||u.name===tn||(u.name==="mark"?u.setAttribute("y",0):s==="middle"?u.setAttribute("y",o[0]+(h-u.AABBBounds.height())/2):s==="bottom"?u.setAttribute("y",o[0]+h-u.AABBBounds.height()):u.setAttribute("y",o[0]))})}function ok(i,t,e,n){const o=i.table,r=ae(o,t.col,t.row);if(r&&r.end.row-r.start.row){n/=r.end.row-r.start.row+1,e/=r.end.row-r.start.row+1;for(let s=r.start.row;s<=r.end.row;s++){const l=o.getRowHeight(s);if(l===n&&e!==l||e>l)return!0}}else{const s=o.getRowHeight(t.row);if(s===n&&e!==s||e>s)return!0}return!1}function Dr(i,t,e,n){const o=[],r=[],s=[],l=[],a=[],h=[],d=[],u=[];let c=0,f=0,g=0,p=0,v=0,m=0;return i.forEach(b=>{switch(b.positionType){case It.left:o.push(b);break;case It.right:r.push(b);break;case It.contentLeft:s.push(b);break;case It.contentRight:l.push(b);break;case It.absoluteRight:u.push(b);break;case It.inlineFront:a.push(b);break;case It.inlineEnd:h.push(b)}}),o.forEach(b=>{var C,_,w;const y=Si(b,void 0,t.col,t.row,e,n);y.role="icon-left",y.name=b.name,y.setAttribute("x",c+((C=y.attribute.marginLeft)!==null&&C!==void 0?C:0)),c+=y.AABBBounds.width()+((_=y.attribute.marginLeft)!==null&&_!==void 0?_:0)+((w=y.attribute.marginRight)!==null&&w!==void 0?w:0),f=Math.max(f,y.AABBBounds.height()),t.appendChild(y)}),r.forEach(b=>{var C,_,w;const y=Si(b,void 0,t.col,t.row,e,n);y.role="icon-right",y.name=b.name,y.setAttribute("x",g+((C=y.attribute.marginLeft)!==null&&C!==void 0?C:0)),g+=y.AABBBounds.width()+((_=y.attribute.marginLeft)!==null&&_!==void 0?_:0)+((w=y.attribute.marginRight)!==null&&w!==void 0?w:0),p=Math.max(p,y.AABBBounds.height()),t.appendChild(y)}),d.forEach(b=>{var C,_,w;const y=Si(b,void 0,t.col,t.row,e,n);y.role="icon-absolute-left",y.name=b.name,y.setAttribute("x",v+((C=y.attribute.marginLeft)!==null&&C!==void 0?C:0)),v+=y.AABBBounds.width()+((_=y.attribute.marginLeft)!==null&&_!==void 0?_:0)+((w=y.attribute.marginRight)!==null&&w!==void 0?w:0),t.appendChild(y)}),u.forEach(b=>{var C,_,w;const y=Si(b,void 0,t.col,t.row,e,n);y.role="icon-absolute-right",y.name=b.name,y.setAttribute("x",m+((C=y.attribute.marginLeft)!==null&&C!==void 0?C:0)),m+=y.AABBBounds.width()+((_=y.attribute.marginLeft)!==null&&_!==void 0?_:0)+((w=y.attribute.marginRight)!==null&&w!==void 0?w:0),t.appendChild(y)}),{leftIcons:o,rightIcons:r,contentLeftIcons:s,contentRightIcons:l,inlineFrontIcons:a,inlineEndIcons:h,absoluteLeftIcons:d,absoluteRightIcons:u,leftIconWidth:c,leftIconHeight:f,rightIconWidth:g,rightIconHeight:p,absoluteLeftIconWidth:v,absoluteRightIconWidth:m}}function rk(i,t){if(i.hasOwnProperty("hoverIconId")){const e=this;if(e.skipMergeUpdate)return;const n=zo(e);if(!n||!n.stage)return;const o=n.stage.table;e.skipAttributeUpdate=!0;const{mergeStartCol:r,mergeEndCol:s,mergeStartRow:l,mergeEndRow:a}=n;if(O(r)&&O(s)&&O(l)&&O(a)&&(r!==s||l!==a)){for(let h=r;h<=s;h++)for(let d=l;d<=a;d++){if(h===n.col&&d===n.row){if(i.hoverIconId!==e.attribute.hoverIconId){const c=e._frameCache.icons.get(i.hoverIconId);e.updateHoverIconState(c)}continue}const u=o.scenegraph.highPerformanceGetCell(h,d);if(u.role==="cell"){const c=u.getChildByName(e.name,!0);if(!c||c.skipAttributeUpdate)continue;i.hoverIconId!==c.attribute.hoverIconId&&(c.setAttribute("hoverIconId",i.hoverIconId),u.addUpdateBoundTag())}}e.skipAttributeUpdate=void 0}}}function sk(i,t,e,n,o,r,s,l,a,h,d,u,c,f,g,p,v){var m,b,C,_,w,y,x,S,R,B,A,M,k,E,T,P,H,L,F,z,I,N,W,D,j,V,X,K,J,ot;const lt=f._getCellStyle(n,o),ct=Rd("padding",lt,n,o,f);!((m=f.options.customConfig)===null||m===void 0)&&m.imageMargin?h=xt((b=f.options.customConfig)===null||b===void 0?void 0:b.imageMargin):O(ct)&&(h=ct),!((C=g==null?void 0:g.text)===null||C===void 0)&&C.textAlign&&(d=(_=g==null?void 0:g.text)===null||_===void 0?void 0:_.textAlign),!((w=g==null?void 0:g.text)===null||w===void 0)&&w.textBaseline&&(u=(y=g==null?void 0:g.text)===null||y===void 0?void 0:y.textBaseline);const it=rn(n,o,g,f);let nt,ht;if(v&&(nt=f.scenegraph.highPerformanceGetCell(n,o,!0),nt&&nt.role==="cell"&&nt.setAttributes({x:t,y:e,width:r,height:s,lineWidth:(S=(x=g==null?void 0:g.group)===null||x===void 0?void 0:x.lineWidth)!==null&&S!==void 0?S:void 0,fill:(B=(R=g==null?void 0:g.group)===null||R===void 0?void 0:R.fill)!==null&&B!==void 0?B:void 0,stroke:(M=(A=g==null?void 0:g.group)===null||A===void 0?void 0:A.stroke)!==null&&M!==void 0?M:void 0,strokeArrayWidth:it??void 0,strokeArrayColor:(E=(k=g==null?void 0:g.group)===null||k===void 0?void 0:k.strokeArrayColor)!==null&&E!==void 0?E:void 0,cursor:(P=(T=g==null?void 0:g.group)===null||T===void 0?void 0:T.cursor)!==null&&P!==void 0?P:void 0,lineDash:(L=(H=g==null?void 0:g.group)===null||H===void 0?void 0:H.lineDash)!==null&&L!==void 0?L:void 0,lineCap:"butt",clip:!0,cornerRadius:g.group.cornerRadius})),nt&&nt.role==="cell"||(nt=new Tt({x:t,y:e,width:r,height:s,lineWidth:(z=(F=g==null?void 0:g.group)===null||F===void 0?void 0:F.lineWidth)!==null&&z!==void 0?z:void 0,fill:(N=(I=g==null?void 0:g.group)===null||I===void 0?void 0:I.fill)!==null&&N!==void 0?N:void 0,stroke:(D=(W=g==null?void 0:g.group)===null||W===void 0?void 0:W.stroke)!==null&&D!==void 0?D:void 0,strokeArrayWidth:it??void 0,strokeArrayColor:(V=(j=g==null?void 0:g.group)===null||j===void 0?void 0:j.strokeArrayColor)!==null&&V!==void 0?V:void 0,cursor:(K=(X=g==null?void 0:g.group)===null||X===void 0?void 0:X.cursor)!==null&&K!==void 0?K:void 0,lineDash:(ot=(J=g==null?void 0:g.group)===null||J===void 0?void 0:J.lineDash)!==null&&ot!==void 0?ot:void 0,lineCap:"butt",clip:!0,cornerRadius:g.group.cornerRadius}),nt.role="cell",nt.col=n,nt.row=o,i==null||i.addCellGroup(nt)),c){let at=n,dt=o;p&&(at=p.start.col,dt=p.start.row),ht=f.getCellIcons(at,dt)}let $=0,Y=0,_t=0;if(Array.isArray(ht)&&ht.length!==0){const{leftIconWidth:at,rightIconWidth:dt,absoluteRightIconWidth:ne}=Dr(ht,nt,p,f);$=at+dt,Y=at,_t=dt,nt.forEachChildren(gt=>{gt.role==="icon-left"?gt.setAttribute("x",gt.attribute.x+h[3]):gt.role==="icon-right"?gt.setAttribute("x",gt.attribute.x+r-dt-h[1]):gt.role==="icon-absolute-right"&&gt.setAttribute("x",gt.attribute.x+r-ne-h[1])}),nt.forEachChildren(gt=>{u==="middle"?gt.setAttribute("y",(s-gt.AABBBounds.height())/2):u==="bottom"?gt.setAttribute("y",s-gt.AABBBounds.height()-h[2]):gt.setAttribute("y",h[0])}),nt._cellLeftIconWidth=Y,nt._cellRightIconWidth=_t}const et=f.getCellValue(n,o),tt=ad({x:h[3],y:h[0],width:r-h[1]-h[3]-$,height:s-h[0]-h[2],image:et,cursor:"pointer"});return tt.name="image",tt.keepAspectRatio=l,tt.textAlign=d,tt.textBaseline=u,l||a?tt.resources&&tt.resources.has(tt.attribute.image)&&tt.resources.get(tt.attribute.image).state==="success"?setTimeout(()=>{Vv(a,l,h,d,u,tt,nt,f)},0):tt.successCallback=()=>{Vv(a,l,h,d,u,tt,nt,f),f.scenegraph.updateNextFrame()}:tt.resources&&tt.resources.has(tt.attribute.image)&&tt.resources.get(tt.attribute.image).state==="success"?qs(nt,n,o,0,0,f):tt.successCallback=()=>{qs(nt,n,o,0,0,f)},tt.failCallback=()=>{const at=Ni();tt.image=at.damage_pic.svg},nt.appendChild(tt),nt}function ow(i,t,e,n,o,r,s){let l=!1,a=null,h=null;const{width:d,height:u,isMerge:c}=kr(s,o.table);if(d<e+r[1]+r[3]&&(a=e+r[1]+r[3],l=!0),u<n+r[2]+r[0]&&(h=n+r[2]+r[0],l=!0),l){if(typeof a=="number")if(c)for(let f=s.mergeStartCol;f<=s.mergeEndCol;f++)o.setColWidth(f,a/(s.mergeEndCol-s.mergeStartCol+1));else o.setColWidth(i,a);if(typeof h=="number")if(c)for(let f=s.mergeStartRow;f<=s.mergeEndRow;f++)o.setRowHeight(f,h/(s.mergeEndRow-s.mergeStartRow+1));else o.setRowHeight(t,h);return o.component.updateScrollBar(),!0}return!1}function qs(i,t,e,n,o,r){var s,l,a,h,d,u,c,f,g,p,v,m;const b=i.getChildByName("image");if(!b)return;const C=typeof b.attribute.image!="string"&&b.attribute.image||((s=b.resources)===null||s===void 0?void 0:s.get(b.attribute.image).data);if(!C)return;const _=r._getCellStyle(t,e),w=(l=q("textAlign",_,t,e,r))!==null&&l!==void 0?l:"left",y=(a=q("textBaseline",_,t,e,r))!==null&&a!==void 0?a:"middle";let x;x=!((h=r.options.customConfig)===null||h===void 0)&&h.imageMargin?xt((d=r.options.customConfig)===null||d===void 0?void 0:d.imageMargin):(u=xt(q("padding",_,t,e,r)))!==null&&u!==void 0?u:[0,0,0,0];const{width:S,height:R,isMerge:B}=kr(i,r),A=(c=i.mergeStartCol)!==null&&c!==void 0?c:i.col,M=(f=i.mergeStartRow)!==null&&f!==void 0?f:i.row,k=(g=i.mergeEndCol)!==null&&g!==void 0?g:i.col,E=(p=i.mergeEndCol)!==null&&p!==void 0?p:i.row,T=(v=i._cellLeftIconWidth)!==null&&v!==void 0?v:0,P=(m=i._cellRightIconWidth)!==null&&m!==void 0?m:0;if(b.keepAspectRatio){const{width:H,height:L}=xd(C.width||C.videoWidth,C.height||C.videoHeight,S-(x[1]+x[3]),R-(x[0]+x[2])),F=Zg(0,0,S,R,H,L,w,y,x);for(let z=A;z<=k;z++)for(let I=M;I<=E;I++){const N=r.scenegraph.getCell(z,I).getChildByName("image");N==null||N.setAttributes({x:F.x,y:F.y,width:H,height:L})}}else for(let H=A;H<=k;H++)for(let L=M;L<=E;L++){const F=r.scenegraph.getCell(H,L).getChildByName("image");F==null||F.setAttributes({x:T+x[3],y:x[0],width:S-x[1]-x[3]-P-T,height:R-x[0]-x[2]})}if(i.getChildByName("play-icon")){const{width:F,height:z}=kr(i,r),I=Math.floor(Math.min(F-x[1]-x[3],z-x[2]-x[0])/2),N=0+(F>b.attribute.width?b.attribute.x-0+b.attribute.width/2:F/2),W=0+(z>b.attribute.height?b.attribute.y-0+b.attribute.height/2:z/2);for(let D=A;D<=k;D++)for(let j=M;j<=E;j++)r.scenegraph.getCell(D,j).getChildByName("play-icon").setAttributes({x:N-I/2,y:W-I/2,width:I,height:I})}i.forEachChildren(H=>{H.role==="icon-left"||(H.role==="icon-right"||H.role==="icon-absolute-right")&&H.setAttribute("x",H.attribute.x+n)}),i.forEachChildren(H=>{(H.type==="rect"||H.role&&H.role.startsWith("icon"))&&(y==="middle"?H.setAttribute("y",x[0]+(R-x[0]-x[2]-H.AABBBounds.height())/2):y==="bottom"?H.setAttribute("y",x[0]+R-x[0]-x[2]-H.AABBBounds.height()):H.setAttribute("y",x[0]))}),B&&Jg(i.mergeStartCol,i.mergeEndCol,i.mergeStartRow,i.mergeEndRow,r)}function kr(i,t){return i.role==="cell"&&O(i.mergeStartCol)&&O(i.mergeEndCol)&&O(i.mergeStartRow)&&O(i.mergeEndRow)?{width:t.getColsWidth(i.mergeStartCol,i.mergeEndCol),height:t.getRowsHeight(i.mergeStartRow,i.mergeEndRow),isMerge:!0}:{width:i.attribute.width,height:i.attribute.height,isMerge:!1}}function Jg(i,t,e,n,o){for(let r=i;r<=t;r++)for(let s=e;s<=n;s++){const l=o.scenegraph.getCell(r,s);if(l){const a=l.getChildByName("image");a&&a.setAttributes({dx:-o.getColsWidth(l.mergeStartCol,r-1),dy:-o.getRowsHeight(l.mergeStartRow,s-1)});const h=l.getChildByName("play-icon");h&&h.setAttributes({dx:-o.getColsWidth(l.mergeStartCol,r-1),dy:-o.getRowsHeight(l.mergeStartRow,s-1)})}}}function Vv(i,t,e,n,o,r,s,l){const a=r.resources.get(r.attribute.image).data,{col:h,row:d}=s;if(i&&!Gv(r)&&ow(h,d,a.width,a.height,l.scenegraph,e,s),t||Gv(r)){const{width:u,height:c,isMerge:f}=kr(s,l),{width:g,height:p}=xd(a.width,a.height,u-e[1]-e[3],c-e[0]-e[2]),v=Zg(0,0,u,c,g,p,n,o,e);r.setAttributes({x:v.x,y:v.y,width:g,height:p}),f&&Jg(s.mergeStartCol,s.mergeEndCol,s.mergeStartRow,s.mergeEndRow,l)}}function Gv(i){const t=Ni();return i.attribute.image===t.damage_pic.svg}function rw(i,t,e){i.then(()=>{e(),t.scenegraph.updateNextFrame()}).catch(n=>{})}function lk(i,t){var e,n;const o=this;if(o.shadowRoot&&o.shadowRoot.childrenCount&&(O(i.width)||O(i.height))){const r=o.shadowRoot.findChildrenByName("shadow-rect")[0];r&&r.setAttributes({width:(e=i.width)!==null&&e!==void 0?e:r.attribute.width,height:(n=i.height)!==null&&n!==void 0?n:r.attribute.height})}}function Qg(i,t,e,n,o,r,s,l,a,h,d,u,c,f,g,p,v,m){var b,C;let _,w=!1;if(ji(t)){if(n.scenegraph.highPerformanceGetCell(o,r).role!=="cell")return _;t=n.getCellValue(o,r),w=!0}if(i==="text"||i==="link"||m){if(i==="link"){const R=t,B=n.getCellOriginValue(o,r),A=n._getCellStyle(o,r);i==="link"&&("templateLink"in e&&e.templateLink||!("linkDetect"in e)||!zt(e.linkDetect,{col:o,row:r,table:n,value:R,dataValue:B,cellHeaderPaths:void 0})||qg.test(R))&&(p?(p.text.fill=q("linkColor",A,o,r,n),p.group.cursor="pointer"):p={text:{fill:q("linkColor",A,o,r,n)},group:{cursor:"pointer"}})}const{customElementsGroup:y,renderDefault:x}=jv(n,e,o,r,l,a,u,v,m);_=ut.getFunction("createTextCellGroup")(n,t,h,0,d,o,r,s,l,a,u,c,f,g,y,x,p,v,w);const S=n.internalProps.layoutMap.getAxisConfigInPivotChart(o,r);if(S){const R=new(ut.getComponent("axis"))(S,_.attribute.width,_.attribute.height,(b=S.__vtablePadding)!==null&&b!==void 0?b:u,n);_.clear(),_.appendChild(R.component),R.overlap()}else n.internalProps.layoutMap.isEmpty(o,r)?(_.setAttributes({fill:!1,stroke:!1}),_.clear()):n.internalProps.layoutMap.isAxisCell(o,r)&&_.clear()}else if(i==="image")_=ut.getFunction("createImageCellGroup")(h,0,d,o,r,l,a,e.keepAspectRatio,e.imageAutoSizing,u,c,f,g,n,p,v,w);else if(i==="video")_=ut.getFunction("createVideoCellGroup")(h,0,d,o,r,l,a,e.keepAspectRatio,e.imageAutoSizing,u,c,f,g,n,p,v,w);else if(i==="chart"){const y=n.internalProps.layoutMap.getChartInstance(o,r);_=ut.getFunction("createChartCellGroup")(null,h,0,d,o,r,l,a,u,t,e.chartModule,n.internalProps.layoutMap.getChartSpec(o,r),y,(C=n.internalProps.layoutMap.getChartDataId(o,r))!==null&&C!==void 0?C:"data",n,p,n.internalProps.layoutMap.isShareChartSpec(o,r),w,n.internalProps.layoutMap.isNoChartDataRenderNothing(o,r))}else if(i==="progressbar"){const{customElementsGroup:y,renderDefault:x}=jv(n,e,o,r,l,a,u,v,m),S=n._getCellStyle(o,r),R=n.getCellOriginValue(o,r);_=ut.getFunction("createTextCellGroup")(n,t,h,0,d,o,r,s,l,a,u,c,f,!1,y,x,p,v,w);const B=ut.getFunction("createProgressBarCell")(e,S,s,t,R,o,r,u,n,v);_.firstChild?_.insertBefore(B,_.firstChild):_.appendChild(B)}else i==="sparkline"?_=ut.getFunction("createSparkLineCellGroup")(null,h,0,d,o,r,l,a,u,n,p,w):i==="checkbox"?_=ut.getFunction("createCheckboxCellGroup")(null,h,0,d,o,r,s,l,a,u,c,f,g,n,p,e,v,w):i==="radio"?_=ut.getFunction("createRadioCellGroup")(null,h,0,d,o,r,s,l,a,u,c,f,n,p,e,v):i==="switch"?_=ut.getFunction("createSwitchCellGroup")(null,h,0,d,o,r,s,l,a,u,c,f,g,n,p,e,v,w):i==="button"&&(_=ut.getFunction("createButtonCellGroup")(null,h,0,d,o,r,s,l,a,u,c,f,g,n,p,e,v,w));return _.onBeforeAttributeUpdate=lk,_}function jv(i,t,e,n,o,r,s,l,a){let h,d=!0;if(a)h=a.elementsGroup,d=a.renderDefault;else{let u,c;if(i.getCellLocation(e,n)!=="body"?(u=t==null?void 0:t.headerCustomRender,c=t==null?void 0:t.headerCustomLayout):(u=(t==null?void 0:t.customRender)||i.customRender,c=t==null?void 0:t.customLayout),c||u){const f=to(c,u,e,n,o,r,!1,i.isAutoRowHeight(n),s,l,i);h=f.elementsGroup,d=f.renderDefault}}return{customElementsGroup:h,renderDefault:d}}function xi(i,t,e,n,o,r){var s,l,a,h,d,u,c,f,g,p,v,m,b,C,_,w,y,x;const S=e.scenegraph.highPerformanceGetCell(i,t,!0),R=e.getCellLocation(i,t);let B,A,M,k,E=e.getCellValue(i,t),T=!1;if(e.internalProps.customMergeCell){const lt=e.getCustomMerge(i,t);if(lt){const{range:ct,text:it,style:nt,customLayout:ht,customRender:$}=lt;A=ct,B=A.start.col!==A.end.col||A.start.row!==A.end.row,E=it,M=nt,(ht||$)&&(k=to(ht,$,ct.start.col,ct.start.row,e.getColsWidth(ct.start.col,ct.end.col),e.getRowsHeight(ct.start.row,ct.end.row),!1,e.isAutoRowHeight(t),[0,0,0,0],A,e)),T=!0}}let P=i,H=t;A&&(P=A.start.col,H=A.start.row);const L=R!=="body"?e.getHeaderDefine(P,H):e.getBodyColumnDefine(P,H);let F=R!=="body"||(L==null?void 0:L.dragOrder)||!!(L!=null&&L.icon)||!!(L!=null&&L.tree);A||!e.internalProps.enableTreeNodeMerge&&R==="body"&&!(L!=null&&L.mergeCell)||(A=e.getCellRange(i,t),B=A.start.col!==A.end.col||A.start.row!==A.end.row);let z=!1;if(e.internalProps.enableTreeNodeMerge&&B){const lt=e.getCellRawRecord(A.start.col,A.start.row),{vtableMergeName:ct,vtableMerge:it}=lt??{};z=it,it&&(F=!0,e.options.groupTitleCustomLayout&&(k=to(e.options.groupTitleCustomLayout,void 0,A.start.col,A.start.row,e.getColsWidth(A.start.col,A.end.col),e.getRowsHeight(A.start.row,A.end.row),!1,e.isAutoRowHeight(t),[0,0,0,0],A,e)),e.options.groupTitleFieldFormat?E=e.options.groupTitleFieldFormat(lt,i,t,e):ct&&(E=ct))}const I=M||e._getCellStyle(A?A.start.col:i,A?A.start.row:t),N=(s=I.autoWrapText)!==null&&s!==void 0?s:e.internalProps.autoWrapText,W=no(I,e,B?A.start.col:i,B?A.start.row:t,q).theme;if(W.group.cornerRadius=yd(i,t,e),!n&&!B&&!(L!=null&&L.customLayout||L!=null&&L.customRender||L!=null&&L.headerCustomLayout||L!=null&&L.headerCustomRender)&&(r||ak(i,t,S,N,F,e))){const lt=e.getColWidth(i),ct=e.getRowHeight(t),it=rn(i,t,W,e);S.setAttributes({width:lt,height:ct,lineWidth:(a=(l=W==null?void 0:W.group)===null||l===void 0?void 0:l.lineWidth)!==null&&a!==void 0?a:void 0,fill:(d=(h=W==null?void 0:W.group)===null||h===void 0?void 0:h.fill)!==null&&d!==void 0?d:void 0,stroke:(c=(u=W==null?void 0:W.group)===null||u===void 0?void 0:u.stroke)!==null&&c!==void 0?c:void 0,strokeArrayWidth:it??void 0,strokeArrayColor:(g=(f=W==null?void 0:W.group)===null||f===void 0?void 0:f.strokeArrayColor)!==null&&g!==void 0?g:void 0,cursor:(v=(p=W==null?void 0:W.group)===null||p===void 0?void 0:p.cursor)!==null&&v!==void 0?v:void 0,cornerRadius:(b=(m=W==null?void 0:W.group)===null||m===void 0?void 0:m.cornerRadius)!==null&&b!==void 0?b:0,lineDash:(_=(C=W==null?void 0:W.group)===null||C===void 0?void 0:C.lineDash)!==null&&_!==void 0?_:void 0,y:e.scenegraph.getCellGroupY(t)}),S.forEachChildren(ht=>{ht.setAttributes({dx:0,dy:0})});const nt=S.getChildByName("text");if(r&&nt){const ht={textBaseline:"top"};nt.setAttributes(W.text?Object.assign({},W.text,ht):ht)}else if(nt){const ht=e.getCellValue(i,t),{text:$,moreThanMaxCharacters:Y}=Xs(ht,e),_t=ui(i,t,e),et=I.lineClamp,tt=(w=xt(q("padding",I,i,t,e)))!==null&&w!==void 0?w:[0,0,0,0],at=W.text.textAlign;let dt=0;dt=at==="center"?tt[3]+(lt-(tt[1]+tt[3]))/2:at==="right"?tt[3]+lt-(tt[1]+tt[3]):tt[3];const ne={text:$.length!==1||N?$:$[0],moreThanMaxCharacters:Y,maxLineWidth:lt-(tt[1]+tt[3]+_t),textBaseline:"top",autoWrapText:N,lineClamp:et,wordBreak:"break-word",heightLimit:ct-Math.floor(tt[0]+tt[2]),pickable:!1,dx:at==="left"?_t:0,x:dt};if(nt.setAttributes(W.text?Object.assign({},W.text,ne):ne),nt.attribute.text){const gt=W.text.textBaseline,pe=ct-(tt[0]+tt[2]);let De=0;De=gt==="middle"?tt[0]+(pe-nt.AABBBounds.height())/2:gt==="bottom"?tt[0]+pe-nt.AABBBounds.height():tt[0],nt.setAttributes({y:De})}}return S}if(!n&&S.role==="empty")return;const D=z||T?"text":e.isHeader(i,t)?(y=e._getHeaderLayoutMap(i,t).headerType)!==null&&y!==void 0?y:"text":(x=e.getBodyColumnType(i,t))!==null&&x!==void 0?x:"text",j=W._vtable.padding,V=W.text.textAlign,X=W.text.textBaseline;let K,J,ot;if(A?(J=e.getColsWidth(A.start.col,A.end.col),ot=e.getRowsHeight(A.start.row,A.end.row)):(J=e.getColWidth(i),ot=e.getRowHeight(t)),ji(E)?(S.removeAllChild(),rw(E,e,hk.bind(null,{type:D,value:E,define:L,table:e,col:i,row:t,cellWidth:J,cellHeight:ot,oldCellGroup:S,padding:j,textAlign:V,textBaseline:X,mayHaveIcon:F,addNew:n,range:A,customResult:k,customStyle:M}))):K=sw(D,E,L,e,i,t,J,ot,S,j,V,X,F,n,W,A,k),B){const{width:lt}=K.attribute,{height:ct}=K.attribute;K.contentWidth=lt,K.contentHeight=ct,o?dk(A,J,ot,j,V,X,e,K):lw(A,J,ot,j,V,X,e)}return K}function sw(i,t,e,n,o,r,s,l,a,h,d,u,c,f,g,p,v){var m,b;if(ji(t)&&(t=n.getCellValue(o,r)),!f&&(a.row!==r||a.col!==o))return null;if(!f&&a.parent&&n.reactCustomLayout){const _=a.getChildByName("custom-container");if(_){const{col:w,row:y}=_;Z(w)&&Z(y)&&n.reactCustomLayout.removeCustomCell(w,y)}}const C=Qg(i,t,e,n,o,r,n.getColWidth(o),s,l,f?n.scenegraph.getColGroup(o):a.parent,f?0:n.scenegraph.getCellGroupY(r),h,d,u,c,g,p,v);return!f&&a.parent&&(a.parent.insertAfter(C,a),a.parent.removeChild(a),!((m=n.scenegraph)===null||m===void 0)&&m.proxy.cellCache.get(o)&&((b=n.scenegraph)===null||b===void 0||b.proxy.cellCache.set(o,C))),C}function ak(i,t,e,n,o,r){var s;const l=r.getBodyColumnType(i,t),a=r.isAutoRowHeight(t),h=r.getCellValue(i,t);return!(r.isHeader(i,t)||e.role!=="cell"||l!=="text"||n||a||o||((s=e.firstChild)===null||s===void 0?void 0:s.type)!=="text"||ji(h))}function hk(i){const{type:t,value:e,define:n,table:o,col:r,row:s,cellWidth:l,cellHeight:a,oldCellGroup:h,padding:d,textAlign:u,textBaseline:c,mayHaveIcon:f,addNew:g,range:p,customResult:v,customStyle:m}=i,b=m||o._getCellStyle(p?p.start.col:r,p?p.start.row:s),C=no(b,o,p?p.start.col:r,p?p.start.row:s,q).theme;C.group.cornerRadius=yd(r,s,o),sw(t,e,n,o,r,s,l,a,h,d,u,c,f,g,C,p,v)}function lw(i,t,e,n,o,r,s){for(let l=i.start.col;l<=i.end.col;l++)for(let a=i.start.row;a<=i.end.row;a++){const h=s.scenegraph.highPerformanceGetCell(l,a,!0);if(h.role!=="cell")continue;i.start.row!==i.end.row&&h.contentHeight!==e&&fh(h,e,e,s.isAutoRowHeight(a),n,o,r,s),i.start.col!==i.end.col&&h.contentWidth!==t&&gh(h,t,e,0,s.isAutoRowHeight(a),n,o,r,s.scenegraph),h.contentWidth=t,h.contentHeight=e;const d=s.getRowHeight(a);ul(h,s.getColWidth(l),d,i,s)}}function dk(i,t,e,n,o,r,s,l){const{col:a,row:h}=l;i.start.row!==i.end.row&&l.contentHeight!==e&&fh(l,e,e,s.isAutoRowHeight(h),n,o,r,s),i.start.col!==i.end.col&&l.contentWidth!==t&&gh(l,t,e,0,s.isAutoRowHeight(h),n,o,r,s.scenegraph),l.contentWidth=t,l.contentHeight=e;const d=s.getRowHeight(h);ul(l,s.getColWidth(a),d,i,s)}function ul(i,t,e,n,o){var r,s;const{col:l,row:a}=i,h=-o.getColsWidth(n.start.col,l-1);let d=0;if(!((r=o.options.customConfig)===null||r===void 0)&&r._disableColumnAndRowSizeRound)for(let v=n.start.row;v<=a-1;v++)d-=o.getRowHeight(v);else d=-o.getRowsHeight(n.start.row,a-1);i.forEachChildren(v=>{var m,b,C,_,w,y;typeof v._dx=="number"?(v.skipMergeUpdate=!0,v.setAttributes({dx:((m=v._dx)!==null&&m!==void 0?m:0)+h}),v.skipMergeUpdate=!1):(v.skipMergeUpdate=!0,v._dx=(b=v.attribute.dx)!==null&&b!==void 0?b:0,v.setAttributes({dx:((C=v.attribute.dx)!==null&&C!==void 0?C:0)+h}),v.skipMergeUpdate=!1),typeof v._dy=="number"?(v.skipMergeUpdate=!0,v.setAttributes({dy:((_=v._dy)!==null&&_!==void 0?_:0)+d}),v.skipMergeUpdate=!1):(v._dy=(w=v.attribute.dy)!==null&&w!==void 0?w:0,v.skipMergeUpdate=!0,v.setAttributes({dy:((y=v.attribute.dy)!==null&&y!==void 0?y:0)+d}),v.skipMergeUpdate=!1)});const u=(s=i.attribute.strokeArrayWidth)!==null&&s!==void 0?s:i.attribute.lineWidth,c=Q(u),f=[0,0,0,0];l===n.start.col&&(f[3]=c?u[3]:u),a===n.start.row&&(f[0]=c?u[0]:u),l===n.end.col&&(f[1]=c?u[1]:u),a===n.end.row&&(f[2]=c?u[2]:u);const g=t!==i.attribute.width,p=e!==i.attribute.height;return i.skipMergeUpdate=!0,i.setAttributes({width:t,height:e,strokeArrayWidth:f}),i.skipMergeUpdate=!1,i.mergeStartCol=n.start.col,i.mergeStartRow=n.start.row,i.mergeEndCol=n.end.col,i.mergeEndRow=n.end.row,{widthChange:g,heightChange:p}}function ph(i,t,e,n){if(n.internalProps.customMergeCell){const o=n.getCustomMerge(i,t);if(o){const{range:r,text:s,style:l,customLayout:a,customRender:h}=o;if(a||h){const d=to(a,h,r.start.col,r.start.row,n.getColsWidth(r.start.col,r.end.col),n.getRowsHeight(r.start.row,r.end.row),!1,n.isAutoRowHeight(t),[0,0,0,0],r,n).elementsGroup;e.childrenCount>0&&d?e.insertBefore(d,e.firstChild):d&&e.appendChild(d);const u=n.getRowHeight(t),c=n.getColWidth(i),{width:f}=e.attribute,{height:g}=e.attribute;return e.contentWidth=f,e.contentHeight=g,ul(e,c,u,r,n),r}}}}function Zn(i){return!!(i.role==="cell"&&Z(i.mergeStartCol)&&Z(i.mergeStartRow)&&Z(i.mergeEndCol)&&Z(i.mergeEndRow))}const Jd=new Pr({}),ys=new Hr({}),uk=new ll({});function ck(i,t,e,n,o,r,s,l,a,h,d,u,c,f,g){const p=kt(i)?i.text:i,v=Cd(p).split(`
`)||[],m=g.getColsWidth(t,n),b=q("size",o,t,e,g);let C=0;if(r){const _=q("spaceBetweenTextAndIcon",o,t,e,g),w=m-(f[1]+f[3])-s-b-_;Jd.setAttributes({text:{maxLineWidth:w,text:v,fontSize:l,fontStyle:a,fontWeight:h,fontFamily:d,lineHeight:u,wordBreak:"break-word",lineClamp:c},icon:{width:Math.floor(b/1.4),height:Math.floor(b/1.4)},box:{width:b,height:b},spaceBetweenTextAndIcon:_}),Jd.render(),C=Jd.AABBBounds.height()}else C=Math.max(b,v.length*u);return C}function gk(i,t,e,n,o,r,s,l,a,h,d,u,c,f,g){var p;if(Q(i)){let v=0;const m=g.getBodyColumnDefine(t,e),b=q("spaceBetweenRadio",o,t,e,g),C=(p=m==null?void 0:m.radioDirectionInCell)!==null&&p!==void 0?p:"vertical";return C==="vertical"?i.forEach((_,w)=>{const y=Qd(_,t,e,n,o,r,s,l,a,h,d,u,c,f,g);v+=y,w!==i.length-1&&(v+=b)}):C==="horizontal"&&i.forEach(_=>{const w=Qd(_,t,e,n,o,r,s,l,a,h,d,u,c,f,g);v=Math.max(w,v)}),v}return Qd(i,t,e,n,o,r,s,l,a,h,d,u,c,f,g)}function Qd(i,t,e,n,o,r,s,l,a,h,d,u,c,f,g){const p=kt(i)?i.text:i,v=Cd(p).split(`
`)||[],m=g.getColsWidth(t,n),b=q("size",o,t,e,g);let C=q("outerRadius",o,t,e,g);const _=Z(C)?2*C:b;let w=0;if(r){const y=q("spaceBetweenTextAndIcon",o,t,e,g),x=m-(f[1]+f[3])-s-_-y;Z(C)||(C=Math.round(b/2)),ys.setAttributes({text:{maxLineWidth:x,text:v,fontSize:l,fontStyle:a,fontWeight:h,fontFamily:d,lineHeight:u,wordBreak:"break-word",lineClamp:c},circle:{outerRadius:C},spaceBetweenTextAndIcon:y}),ys.render(),w=ys.AABBBounds.height()}else w=Math.max(b,v.length*u);return w}function fk(i,t,e,n,o,r,s,l,a,h,d,u,c,f,g){return q("boxWidth",o,t,e,g)}function pk(i,t,e,n,o,r,s,l,a,h,d,u,c,f,g){const p=kt(i)?i.text:i,v=Cd(p).split(`
`)||[],m=g.getColsWidth(t,n),b=q("buttonPadding",o,t,e,g),C=q("buttonLineWidth",o,t,e,g);let _=0;if(r){const w=m-(f[1]+f[3]);uk.setAttributes({text:v,textStyle:{maxLineWidth:w,fontSize:l,fontStyle:a,fontWeight:h,fontFamily:d,lineHeight:u,wordBreak:"break-word",lineClamp:c},padding:b,panel:{visible:!0,fill:"red",stroke:"red",lineWidth:C}}),ys.render(),_=ys.AABBBounds.height()}else _=v.length*u+2*b;return _}let vk="",Qc="quick";const mk=new Ct((i,t,e,n)=>{e(yn)?n(yn).to($v).inSingletonScope():i(yn).to($v).inSingletonScope()});new Ct((i,t,e,n)=>{e(yn)?n(yn).to(wr).inSingletonScope():i(yn).to(wr).inSingletonScope()});const Uv=new Map;function tg(i,t,e,n="normal"){const o=`${i}-${t}-${e}-${n}`,r=Uv.get(o);if(r)return r;const s=(l={fontSize:i,fontFamily:e,fontWeight:t,fontStyle:n},new wn(Object.assign({defaultFontParams:{fontFamily:qe.fontFamily,fontSize:qe.fontSize},getTextBounds:sd,specialCharSet:`{}()//&-/: .,@%'"~…=——${wn.ALPHABET_CHAR_SET}${wn.ALPHABET_CHAR_SET.toUpperCase()}0123456789${vk}`},{}),l));var l;return Uv.set(o,s),s}class $v extends wr{_fastMeasure(t,e){const{fontSize:n,fontFamily:o="Arial,sans-serif",fontWeight:r="normal",fontStyle:s="normal"}=e,l=tg(n,r,o,s).measure(t,Qc);if(!O(l.fontBoundingBoxAscent)&&!O(l.fontBoundingBoxDescent)){const{ascent:a,descent:h}=this.measureTextBoundADscentEstimate(e);l.fontBoundingBoxAscent=a,l.fontBoundingBoxDescent=h}return l}measureTextWidth(t,e){return this._fastMeasure(t,e).width}measureText(t,e){return this._fastMeasure(t,e)}_measureTextWithoutAlignBaseline(t,e,n){return this._fastMeasure(t,e)}_measureTextWithAlignBaseline(t,e,n){return this._fastMeasure(t,e)}}class bk{measureText(t,e){const{fontSize:n,fontFamily:o="Arial,sans-serif",fontWeight:r="normal",fontStyle:s="normal"}=e;return tg(n,r,o,s).measure(t,Qc)}measureTextWidth(t,e){const{fontSize:n,fontFamily:o="Arial,sans-serif",fontWeight:r="normal",fontStyle:s="normal"}=e;return tg(n,r,o,s).measure(t,Qc).width}clipText(t,e,n){if(t.length===0)return{str:"",width:0};let o=this.measureTextWidth(t,e);return o<=n?{str:t,width:o}:(o=this.measureTextWidth(t[0],e),o>n?{str:"",width:0}:this._clipText(t,e,n,0,t.length-1))}_clipText(t,e,n,o,r){const s=Math.floor((o+r)/2),l=t.substring(0,s+1),a=this.measureTextWidth(l,e);let h;if(a>n){if(l.length<=1)return{str:"",width:0};const d=t.substring(0,s);return h=this.measureTextWidth(d,e),h<=n?{str:d,width:h}:this._clipText(t,e,n,o,s)}if(a<n){if(s>=t.length-1)return{str:t,width:this.measureTextWidth(t,e)};const d=t.substring(0,s+2);return h=this.measureTextWidth(d,e),h>=n?{str:l,width:a}:this._clipText(t,e,n,s,r)}return{str:l,width:a}}clipTextWithSuffix(t,e,n,o){if(o==="")return this.clipText(t,e,n);if(t.length===0)return{str:"",width:0};const r=this.measureTextWidth(t,e);if(r<=n)return{str:t,width:r};const s=this.measureTextWidth(o,e);if(s>n)return{str:"",width:0};n-=s;const l=this._clipText(t,e,n,0,t.length-1);return l.str+=o,l.width+=s,l}}const aw=new bk,Kv=new xe({ignoreBuf:!0});function hw(i){return Kv.initAttributes(Object.assign(Object.assign({},i),{ignoreBuf:!0})),Kv.AABBBounds}const Yv=new Di({width:0,height:0,textConfig:[]});function Ri(i,t,e,n=!0,o){var r,s,l,a,h,d,u,c,f,g,p;typeof window<"u"&&window.performance.now();const v=[],m=[];if(o)for(let y=t;y<=e;y++)v[y]=i.getRowHeight(y);const b=i.internalProps.layoutMap;i.isPivotTable()&&(b.enableUseGetBodyCache(),b.enableUseHeaderPathCache()),i.defaultHeaderRowHeight,i.defaultHeaderColWidth;const C=i.defaultHeaderRowHeight==="auto"||Q(i.defaultHeaderRowHeight)&&i.defaultHeaderRowHeight.some(y=>y==="auto"),_=i.isAutoRowHeight()||i.heightMode==="adaptive"&&i.options.autoHeightInAdaptiveMode!==!1,w=i.options.defaultRowHeight==="auto";if(_||C||w){t=t??0,e=e??i.rowCount-1,(t===0&&e===i.rowCount-1||n)&&i._clearRowRangeHeightsMap();for(let y=t;y<i.columnHeaderLevelCount;y++){let x=0,S=i.colCount-1;if((i.isPivotTable()&&!i.isPivotChart()||i.isPivotChart()&&!i.internalProps.layoutMap.indicatorsAsCol)&&wk(i,y)&&!ae(i,i.rowHeaderLevelCount,y)&&(x=0,S=i.rowHeaderLevelCount),_||i.getDefaultRowHeight(y)==="auto"){const R=yi(y,x,S,i);m[y]=Math.round(R),i.heightAdaptiveMode!=="only-body"&&o||i._setRowHeight(y,R)}}for(let y=i.rowCount-i.bottomFrozenRowCount;y<=e;y++)if(_||i.getDefaultRowHeight(y)==="auto"){const x=yi(y,0,i.colCount-1,i);o?m[y]=Math.round(x):i._setRowHeight(y,x)}if(!(e<i.columnHeaderLevelCount||!_&&!w))if(i.internalProps.transpose||i.isPivotTable()&&!i.internalProps.layoutMap.indicatorsAsCol||i.options.customComputeRowHeight||!Ck(i))if(i.internalProps.transpose||i.isPivotTable()&&!i.internalProps.layoutMap.indicatorsAsCol)for(let y=Math.max(t,i.columnHeaderLevelCount);y<=e;y++){let x;x=_k(i,y)?yi(y,0,i.rowHeaderLevelCount,i):yi(y,0,i.colCount-1,i),o?m[y]=Math.round(x):i._setRowHeight(y,x)}else for(let y=Math.max(t,i.columnHeaderLevelCount);y<=e;y++){const x=yi(y,0,i.colCount-1,i);o?m[y]=Math.round(x):i._setRowHeight(y,x)}else{yk(yi(i.columnHeaderLevelCount,0,i.colCount-1,i),i.columnHeaderLevelCount,i.rowCount-1-i.bottomFrozenRowCount,i,o?m:void 0);for(let y=i.rowCount-i.bottomFrozenRowCount;y<=e;y++){const x=yi(y,0,i.colCount-1,i);o?m[y]=Math.round(x):i._setRowHeight(y,x)}}}else if((i.heightMode==="adaptive"||i.autoFillHeight)&&i.clearRowHeightCache(),o)for(let y=t;y<=e;y++)m[y]=i.getRowHeight(y);if((t===0&&e===i.rowCount-1||n)&&i._clearRowRangeHeightsMap(),i.heightMode==="adaptive"){i._clearRowRangeHeightsMap();let y=i.tableNoFrameHeight,x=0,S=i.rowCount;if(i.heightAdaptiveMode==="only-body"){const A=i.getRowsHeight(0,i.columnHeaderLevelCount-1),M=i.isPivotChart()?i.getBottomFrozenRowsHeight():0;y=i.tableNoFrameHeight-A-M,x=i.columnHeaderLevelCount,S=i.isPivotChart()?i.rowCount-i.bottomFrozenRowCount:i.rowCount}let R=0;for(let A=x;A<S;A++)R+=o&&(r=m[A])!==null&&r!==void 0?r:i.getRowHeight(A);const B=y/R;for(let A=x;A<S;A++){let M;M=A===S-1?y-(o?m.reduce((k,E,T)=>T>=x&&T<=S-2?k+E:k,0):i.getRowsHeight(x,S-2)):Math.round((o&&(s=m[A])!==null&&s!==void 0?s:i.getRowHeight(A))*B),o?m[A]=M:i._setRowHeight(A,M,!1)}}else if(i.autoFillHeight){i._clearRowRangeHeightsMap();const y=i.tableNoFrameHeight;let x=0,S=0;for(let R=0;R<i.rowCount;R++){const B=o&&(l=m[R])!==null&&l!==void 0?l:i.getRowHeight(R);(R<i.columnHeaderLevelCount||i.isPivotChart()&&R>=i.rowCount-i.bottomFrozenRowCount)&&(S+=B),x+=B}if(i.scenegraph._dealAutoFillHeightOriginRowsHeight=x,x<y&&x-S>0){const R=i.columnHeaderLevelCount,B=i.isPivotChart()?i.rowCount-i.bottomFrozenRowCount:i.rowCount,A=(y-S)/(x-S);for(let M=R;M<B;M++){let k;k=M===B-1?y-S-(o?m.reduce((E,T,P)=>P>=R&&P<=B-2?E+T:E,0):i.getRowsHeight(R,B-2)):Math.round((o&&(a=m[M])!==null&&a!==void 0?a:i.getRowHeight(M))*A),o?m[M]=k:i._setRowHeight(M,k,!1)}}}if(o){for(let y=t;y<=e;y++){const x=(h=m[y])!==null&&h!==void 0?h:i.getRowHeight(y);O(x)&&i._setRowHeight(y,x)}for(let y=0;y<=i.frozenRowCount-1;y++){const x=i.getRowHeight(y);x!==((d=v[y])!==null&&d!==void 0?d:i.getRowHeight(y))&&i.scenegraph.updateRowHeight(y,x-((u=v[y])!==null&&u!==void 0?u:i.getRowHeight(y)),!0)}for(let y=i.rowCount-i.bottomFrozenRowCount;y<=i.rowCount-1;y++){const x=i.getRowHeight(y);x!==((c=v[y])!==null&&c!==void 0?c:i.getRowHeight(y))&&i.scenegraph.updateRowHeight(y,x-((f=v[y])!==null&&f!==void 0?f:i.getRowHeight(y)),!0)}for(let y=i.scenegraph.proxy.rowStart;y<=i.scenegraph.proxy.rowEnd;y++){const x=i.getRowHeight(y);x!==((g=v[y])!==null&&g!==void 0?g:i.getRowHeight(y))&&i.scenegraph.updateRowHeight(y,x-((p=v[y])!==null&&p!==void 0?p:i.getRowHeight(y)),!0)}}i.isPivotTable()&&(b.disableUseGetBodyCache(),b.disableUseHeaderPathCache())}function yi(i,t,e,n){var o;if(!(n.isAutoRowHeight()||n.heightMode==="adaptive"&&n.options.autoHeightInAdaptiveMode!==!1)&&n.getDefaultRowHeight(i)!=="auto")return n.getDefaultRowHeight(i);let r;if(n.options.customComputeRowHeight){const l=n.options.customComputeRowHeight({row:i,table:n});if(typeof l=="number")return l;if(l!=="auto")return n.getDefaultRowHeight(i)}if(n.isPivotChart()&&i>=n.columnHeaderLevelCount&&i<n.rowCount-n.bottomFrozenRowCount)if(n.internalProps.layoutMap.indicatorsAsCol){const l=n.internalProps.layoutMap.getOptimunHeightForChart(i);if(l>0)return l}else{const l=n.getDefaultRowHeight(i);if(Z(l))return l}for(let l=t;l<=e;l++){const a=Sk(l,i,n);if(a&&(r=O(r)?Math.max(a.height,r):a.height,!a.renderDefault))continue;if(n.isPivotChart()){const d=n.internalProps.layoutMap.getAxisConfigInPivotChart(l,i);if(d){const u=ut.getFunction("computeAxisComponentHeight")(d,n);if(typeof u=="number"){r=O(r)?Math.max(u,r):u;continue}}}if(n.isPivotChart()&&(n.isLeftFrozenColumn(l)&&n.isBottomFrozenRow(i)||n.isRightFrozenColumn(l)&&n.isBottomFrozenRow(i)))continue;const h=xk(l,i,n.isHeader(l,i)?(o=n._getHeaderLayoutMap(l,i))===null||o===void 0?void 0:o.headerType:n.getBodyColumnType(l,i),n);r=O(r)?Math.max(h,r):h}if(O(r))return r;const s=n.getDefaultRowHeight(i);return Z(s)?s:n.defaultRowHeight}function Ck(i){var t,e,n;const{layoutMap:o}=i.internalProps,r=i.columnHeaderLevelCount;if((i.internalProps.autoWrapText||i.internalProps.enableLineBreak||i.isPivotChart())&&(i.isAutoRowHeight()||i.options.heightMode==="adaptive"))return!1;for(let s=0;s<i.colCount;s++){const l=o.getBody(s,r);if(l.cellType==="radio"||typeof l.style=="function"||typeof l.icon=="function"||!((t=l.define)===null||t===void 0)&&t.customRender||!((e=l.define)===null||e===void 0)&&e.customLayout||typeof((n=l.define)===null||n===void 0?void 0:n.icon)=="function")return!1;const a=i._getCellStyle(s,r);if(typeof a.padding=="function"||typeof a.fontSize=="function"||typeof a.lineHeight=="function"||a.autoWrapText===!0)return!1}return!0}function _k(i,t){var e,n,o;const{layoutMap:r}=i.internalProps;if((i.internalProps.autoWrapText||i.internalProps.enableLineBreak)&&(i.isAutoRowHeight()||i.options.heightMode==="adaptive"))return!1;const s=r.getBody(i.rowHeaderLevelCount,t);if(typeof s.style=="function"||typeof s.icon=="function"||!((e=s.define)===null||e===void 0)&&e.customRender||!((n=s.define)===null||n===void 0)&&n.customLayout||typeof((o=s.define)===null||o===void 0?void 0:o.icon)=="function")return!1;const l=i._getCellStyle(i.rowHeaderLevelCount,t);return typeof l.padding!="function"&&typeof l.fontSize!="function"&&typeof l.lineHeight!="function"&&l.autoWrapText!==!0}function wk(i,t){var e,n,o;const{layoutMap:r}=i.internalProps;if(i.internalProps.autoWrapText&&(i.isAutoRowHeight()||i.options.heightMode==="adaptive"))return!1;const s=r.getHeader(i.rowHeaderLevelCount,t);if(typeof s.style=="function"||typeof s.icons=="function"||!((e=s.define)===null||e===void 0)&&e.headerCustomRender||!((n=s.define)===null||n===void 0)&&n.headerCustomLayout||typeof((o=s.define)===null||o===void 0?void 0:o.icon)=="function")return!1;const l=i._getCellStyle(i.rowHeaderLevelCount,t);return typeof l.padding!="function"&&typeof l.fontSize!="function"&&typeof l.lineHeight!="function"&&l.autoWrapText!==!0}function yk(i,t,e,n,o){if(!n.internalProps.useOneRowHeightFillAll){for(let r=t;r<=e;r++)o?o[r]=i:n._setRowHeight(r,i);n.internalProps.useOneRowHeightFillAll=!0}}function Sk(i,t,e){var n,o,r,s,l,a,h;const d=e.getCustomRender(i,t);let u=e.getCustomLayout(i,t);if(d||u){let c,f=1,g=0,p=!1,v=!1;(e.isHeader(i,t)||!((n=e.getBodyColumnDefine(i,t))===null||n===void 0)&&n.mergeCell||e.hasCustomMerge())&&(c=e.getCellRange(i,t),f=c.end.row-c.start.row+1);const m={col:(o=c==null?void 0:c.start.col)!==null&&o!==void 0?o:i,row:(r=c==null?void 0:c.start.row)!==null&&r!==void 0?r:t,dataValue:e.getCellOriginValue(i,t),value:e.getCellValue(i,t)||"",rect:Rk(i,t,e),table:e,originCol:i,originRow:t};if(u==="react-custom-layout"&&(u=((s=e.reactCustomLayout)===null||s===void 0?void 0:s.getCustomLayoutFunc(i,t))||Ks),Mt(u)){const b=u(m);b.rootContainer?(b.rootContainer=Ys(b.rootContainer),Sd(b.rootContainer,e.getColWidth(i),0),b.rootContainer.setStage(e.scenegraph.stage),g=(l=b.rootContainer.AABBBounds.height())!==null&&l!==void 0?l:0,p=b.renderDefault,v=b.enableCellPadding):(g=0,p=b.renderDefault,v=b.enableCellPadding)}else if(typeof d=="function"){const b=d(m);g=(a=b==null?void 0:b.expectedHeight)!==null&&a!==void 0?a:0,p=b==null?void 0:b.renderDefault}else g=(h=d==null?void 0:d.expectedHeight)!==null&&h!==void 0?h:0,p=d==null?void 0:d.renderDefault;if(v){const b=e._getCellStyle(i,t),C=xt(q("padding",b,i,t,e));g+=C[0]+C[2]}return{height:g/f,renderDefault:p}}}function xk(i,t,e,n){var o,r,s,l;let a=0;const h=n.getCellValue(i,t),d=n._getCellStyle(i,t);let u=0,c=0;const f=[];let g=0;const p=[];let v=0,m=!1;if(n.getCellLocation(i,t)!=="body")m=!0;else{const T=n.getBodyColumnDefine(i,t);m=!!(T!=null&&T.icon)||!!(T!=null&&T.tree)||(T==null?void 0:T.dragOrder)}if(m){const T=n.getCellIcons(i,t);T==null||T.forEach(P=>{var H,L,F,z,I,N,W,D,j,V;P.positionType!==It.absoluteRight&&P.positionType!==It.inlineFront&&P.positionType!==It.inlineEnd?(c+=((H=P.width)!==null&&H!==void 0?H:0)+((L=P.marginLeft)!==null&&L!==void 0?L:0)+((F=P.marginRight)!==null&&F!==void 0?F:0),u=Math.max(u,(z=P.height)!==null&&z!==void 0?z:0)):P.positionType===It.inlineFront?(f.push(P),g=Math.max(g,((I=P.height)!==null&&I!==void 0?I:0)+((N=P.marginLeft)!==null&&N!==void 0?N:0)+((W=P.marginRight)!==null&&W!==void 0?W:0))):P.positionType===It.inlineEnd&&(p.push(P),v=Math.max(v,((D=P.height)!==null&&D!==void 0?D:0)+((j=P.marginLeft)!==null&&j!==void 0?j:0)+((V=P.marginRight)!==null&&V!==void 0?V:0)))})}let b=1,C=i;if(n.isHeader(i,t)||!((o=n.getBodyColumnDefine(i,t))===null||o===void 0)&&o.mergeCell||n.hasCustomMerge()){const T=n.getCellRange(i,t);b=T.end.row-T.start.row+1,i=T.start.col,C=T.end.col}const _=xt(q("padding",d,i,t,n)),w=q("fontSize",d,i,t,n),y=q("fontStyle",d,i,t,n),x=q("fontWeight",d,i,t,n),S=(r=q("lineHeight",d,i,t,n))!==null&&r!==void 0?r:w,R=q("fontFamily",d,i,t,n),B=q("autoWrapText",d,i,t,n),A=q("lineClamp",d,i,t,n),M=q("underline",d,i,t,n),k=(s=q("underlineOffset",d,i,t,n))!==null&&s!==void 0?s:0;let E;if(e!=="text"&&e!=="link"&&e!=="progressbar"&&e!=="checkbox"&&e!=="radio"&&e!=="switch"&&e!=="button")a=S;else if(e==="checkbox")a=ck(h,i,t,C,d,B,c,w,y,x,R,S,A,_,n);else if(e==="radio")a=gk(h,i,t,C,d,B,c,w,y,x,R,S,A,_,n);else if(e==="switch")a=fk(h,i,t,C,d,B,c,w,y,x,R,S,A,_,n);else if(e==="button")a=pk(h,i,t,C,d,B,c,w,y,x,R,S,A,_,n);else{E=h;const T=Xs(E,n).text,P=n.getColsWidth(i,C);if(f.length||p.length)if(B){const H=Object.assign({text:h==null?void 0:h.toString(),fontFamily:R,fontSize:w,fontStyle:y,fontWeight:x,lineHeight:S});H.textBaseline="middle";const L=[...f.map(F=>ch(F)),H,...p.map(F=>ch(F))];Yv.setAttributes({width:P-(_[1]+_[3])-c,height:0,textConfig:L}),a=Yv.AABBBounds.height()}else a=0,T.forEach((H,L)=>{var F;!((F=n.options.customConfig)===null||F===void 0)&&F.multilinesForXTable&&L!==0||(L===0&&f.length?a+=Math.max(S,g):L===T.length-1&&p.length?a+=Math.max(S,v):a+=S)});else if(B){const H=ui(i,t,n),L=P-(_[1]+_[3])-c-H;a=(hw({maxLineWidth:L,text:T,fontSize:w,fontStyle:y,fontWeight:x,fontFamily:R,lineHeight:S,wordBreak:"break-word",whiteSpace:T.length!==1||B?"normal":"no-wrap",lineClamp:A}).height()||(typeof S=="number"?S:w))+(M?k:0)}else a=!((l=n.options.customConfig)===null||l===void 0)&&l.multilinesForXTable?S:T.length*S}return(Math.max(a,u)+_[0]+_[2])/b}function Rk(i,t,e){return{left:0,top:0,right:e.getColWidth(i),bottom:e.getRowHeight(t),width:e.getColWidth(i),height:0}}function oo(i,t){if(!t||!t.proxy)return{colStart:0,colEnd:0,rowStart:0,rowEnd:0};const{mergeStartCol:e,mergeEndCol:n,mergeStartRow:o,mergeEndRow:r,col:s,row:l}=i;return{colStart:e,colEnd:n,rowStart:o,rowEnd:r}}function Ak(i,t){const e=i.start.col,n=i.end.col,o=i.start.row,r=i.end.row;let s=e,l=n,a=o,h=r;for(let d=e;d<=n;d++)for(let u=o;u<=r;u++){const c=t.getCellRange(d,u);c&&(s=Math.min(s,c.start.col),l=Math.max(l,c.end.col),a=Math.min(a,c.start.row),h=Math.max(h,c.end.row))}return i.start.col=s,i.end.col=l,i.start.row=a,i.end.row=h,i}function Xv(i,t,e,n){n||i.table._setRowHeight(t,i.table.getRowHeight(t)+e,!0);for(let s=0;s<i.table.colCount;s++){const l=i.getCell(s,t);if(l.role==="empty")continue;const a=ae(i.table,s,t);a&&a.start.col!==s||(dw(i,l,s,t,l.attribute.height+e,e,i.table.isHeader(s,t)),i.updateCellContentWhileResize(s,t))}let o=0,r=0;t<i.table.frozenRowCount?(o=t+1,r=i.table.frozenRowCount-1):t>=i.table.rowCount-i.table.bottomFrozenRowCount?(o=t+1,r=i.table.rowCount-1):(o=t+1,r=Math.min(i.proxy.rowEnd,i.table.rowCount-i.table.bottomFrozenRowCount-1));for(let s=0;s<i.table.colCount;s++)for(let l=o;l<=r;l++){const a=i.highPerformanceGetCell(s,l);a.role==="cell"&&a.setAttribute("y",a.attribute.y+e)}}function dw(i,t,e,n,o,r,s){t&&Bk(i,t,e,n,o,r)}function Bk(i,t,e,n,o,r,s){var l,a,h,d,u;if(t.attribute.height===o&&!t.needUpdateHeight)return;t.needUpdateHeight=!1,t.setAttribute("height",o);const c=(l=i.table.getCellRawRecord(e,n))===null||l===void 0?void 0:l.vtableMerge,f=!!i.table.getCustomMerge(e,n),g=c||f?"text":i.table.isHeader(e,n)?(a=i.table._getHeaderLayoutMap(e,n).headerType)!==null&&a!==void 0?a:"text":(h=i.table.getBodyColumnType(e,n))!==null&&h!==void 0?h:"text";if(g==="progressbar"){const p=i.table.getBodyColumnDefine(e,n),v=i.table._getCellStyle(e,n),m=i.table.getCellValue(e,n),b=i.table.getCellOriginValue(e,n),C=xt(q("padding",v,e,n,i.table));let _;p!=null&&p.mergeCell&&(_=i.table.getCellRange(e,n));const w=ut.getFunction("createProgressBarCell")(p,v,t.attribute.width,m,b,e,n,C,i.table,_),y=t.getChildByName("progress-bar");t.insertBefore(w,y),t.removeChild(y),y.removeAllChild(),y.release(),qv(t,o,r,i.table.isAutoRowHeight(n),!0,i.table)}else if(g==="sparkline"){t.removeAllChild();const p=i.table._getCellStyle(e,n),v=xt(q("padding",p,e,n,i.table));ut.getFunction("createSparkLineCellGroup")(t,t.parent,t.attribute.x,t.attribute.y,e,n,t.attribute.width,t.attribute.height,v,i.table,no(p,i.table,e,n,q).theme,!1)}else if(g==="image"||g==="video")qs(t,e,n,0,r,i.table);else if(((d=t.firstChild)===null||d===void 0?void 0:d.name)==="axis")(u=t.firstChild)===null||u===void 0||u.originAxis.resize(t.attribute.width,t.attribute.height);else{let p=!0;const v=t.getChildByName(tn)||t.getChildByName(uh);if(v){let m;t.removeChild(v);const b=ph(e,n,t,i.table);if(b)for(let C=b.start.row;C<=b.end.row;C++){if(C===n)continue;const _=i.getCell(e,C),w=_.getChildByName(tn)||_.getChildByName(uh);w.removeAllChild(),_.removeChild(w),ph(e,C,_,i.table)}else{let C,_;const w=i.table.getCellLocation(e,n),{vtableMerge:y}=i.table.getCellRawRecord(e,n)||{};if(y&&i.table.options.groupTitleCustomLayout)_=i.table.options.groupTitleCustomLayout;else if(w!=="body"){const x=i.table.getHeaderDefine(e,n);C=x==null?void 0:x.headerCustomRender,_=x==null?void 0:x.headerCustomLayout}else{const x=i.table.getBodyColumnDefine(e,n);C=(x==null?void 0:x.customRender)||i.table.customRender,_=x==null?void 0:x.customLayout}if((C||_)&&Zn(t))for(let x=t.mergeStartCol;x<=t.mergeEndCol;x++)for(let S=t.mergeStartRow;S<=t.mergeEndRow;S++)S!==n&&i.updateCellContent(x,S);if(_||C){const x=i.table._getCellStyle(e,n),S=xt(q("padding",x,e,n,i.table));let R=t.attribute.width,B=t.attribute.height;Zn(t)&&(R=i.table.getColsWidth(t.mergeStartCol,t.mergeEndCol),B=i.table.getRowsHeight(t.mergeStartRow,t.mergeEndRow));const A=to(_,C,e,n,R,B,!1,i.table.isAutoRowHeight(n),S,Zn(t)?{start:{col:t.mergeStartCol,row:t.mergeStartRow},end:{col:t.mergeEndCol,row:t.mergeEndRow}}:void 0,i.table);m=A.elementsGroup,p=A.renderDefault}t.childrenCount>0&&m?t.insertBefore(m,t.firstChild):m&&t.appendChild(m)}}qv(t,o,r,i.table.isAutoRowHeight(n),p,i.table)}}function qv(i,t,e,n,o,r){if(Zn(i)){t=0;for(let d=i.mergeStartRow;d<=i.mergeEndRow;d++)t+=r.getRowHeight(d);const{colStart:s,colEnd:l,rowStart:a,rowEnd:h}=oo(i,r.scenegraph);for(let d=s;d<=l;d++)for(let u=a;u<=h;u++){const c=r.scenegraph.getCell(d,u);if(c.role!=="cell")continue;if(c.forEachChildren(v=>{v.setAttributes({dx:0,dy:0})}),o){const v=r._getCellStyle(s,a),m=xt(q("padding",v,d,u,r));fh(c,t,e,n,m,v.textAlign,v.textBaseline,r)}const f=r.getRowHeight(u),g=r.getColWidth(d);c.contentHeight=t;const{widthChange:p}=ul(c,g,f,{start:{col:i.mergeStartCol,row:i.mergeStartRow},end:{col:i.mergeEndCol,row:i.mergeEndRow}},r);p&&(c.needUpdateWidth=!0)}}else{const s=r._getCellStyle(i.col,i.row),l=xt(q("padding",s,i.col,i.row,r));fh(i,t,e,n,l,s.textAlign,s.textBaseline,r)}}function Mk(i,t,e,n){n||i.table._setColWidth(t,i.table.getColWidth(t)+e,!0);const o=i.getColGroup(t,!0),r=i.getColGroupInRightTopCorner(t);o&&!r&&Yo(o,e,"col-corner",i),r&&Yo(r,e,"right-top",i);const s=i.getColGroup(t);s&&Yo(s,e,"row-body",i);const l=i.getColGroupInLeftBottomCorner(t);l&&Yo(l,e,"left-bottom",i);const a=i.getColGroupInBottom(t);a&&Yo(a,e,"bottom",i);const h=i.getColGroupInRightBottomCorner(t);h&&Yo(h,e,"right-bottom",i),t<i.frozenColCount?(i.cornerHeaderGroup.forEachChildrenSkipChild((d,u)=>{d.col>t&&d.setAttribute("x",d.attribute.x+e)}),i.rowHeaderGroup.forEachChildrenSkipChild((d,u)=>{d.col>t&&d.setAttribute("x",d.attribute.x+e)})):(i.colHeaderGroup.forEachChildrenSkipChild((d,u)=>{d.col>t&&d.setAttribute("x",d.attribute.x+e)}),i.bodyGroup.forEachChildrenSkipChild((d,u)=>{d.col>t&&d.setAttribute("x",d.attribute.x+e)})),l&&i.leftBottomCornerGroup.forEachChildrenSkipChild((d,u)=>{d.col>t&&d.setAttribute("x",d.attribute.x+e)}),a&&i.bottomFrozenGroup.forEachChildrenSkipChild((d,u)=>{d.col>t&&d.setAttribute("x",d.attribute.x+e)}),h&&i.rightBottomCornerGroup.forEachChildrenSkipChild((d,u)=>{d.col>t&&d.setAttribute("x",d.attribute.x+e)})}function Yo(i,t,e,n){var o,r,s,l,a,h,d;let u=!1;const c=(o=i==null?void 0:i.attribute.width)!==null&&o!==void 0?o:0;if(i==null||i.setAttribute("width",c+t),i==null||i.forEachChildren((f,g)=>{if(Tk(n,f,f.col,f.row,c,c+t,t,e!=="row-body"||f.col<n.table.rowHeaderLevelCount,n.table.internalProps.autoWrapText)){const p=ae(n.table,f.col,f.row);if(p&&p.end.row-p.start.row)for(let v=p.start.row;v<=p.end.row;v++)Jv(n,v);else Jv(n,f.row);u=!0}}),u){let f,g,p,v=0;for(let m=0;m<n.table.colCount;m++){if(e==="col-corner"?(p=0,f=n.getColGroup(m,!0),g=(r=n.colHeaderGroup.attribute.height)!==null&&r!==void 0?r:0):e==="row-body"?(p=n.table.frozenRowCount,f=n.getColGroup(m,!1),g=(s=n.bodyGroup.attribute.height)!==null&&s!==void 0?s:0):e==="bottom"?(p=n.table.rowCount-n.table.bottomFrozenRowCount,f=n.getColGroupInBottom(m),g=(l=n.bottomFrozenGroup.attribute.height)!==null&&l!==void 0?l:0):e==="left-bottom"?(p=n.table.rowCount-n.table.bottomFrozenRowCount,f=n.getColGroupInLeftBottomCorner(m),g=(a=n.leftBottomCornerGroup.attribute.height)!==null&&a!==void 0?a:0):e==="right-top"?(p=0,f=n.getColGroupInRightTopCorner(m),g=(h=n.rightTopCornerGroup.attribute.height)!==null&&h!==void 0?h:0):e==="right-bottom"&&(p=n.table.rowCount-n.table.bottomFrozenRowCount,f=n.getColGroupInRightBottomCorner(m),g=(d=n.rightBottomCornerGroup.attribute.height)!==null&&d!==void 0?d:0),!f)continue;let b=0;f.forEachChildren(C=>{var _;C.setAttribute("y",b),b+=(_=n.table.getRowHeight(C.row))!==null&&_!==void 0?_:0}),v=b}n.updateContainerHeight(p,v-g);for(let m=0;m<n.table.frozenColCount;m++){const b=n.getColGroupInLeftBottomCorner(m);let C=0;b==null||b.forEachChildren(_=>{_.setAttribute("y",C),C+=n.table.getRowHeight(_.row)})}for(let m=n.table.colCount-n.table.rightFrozenColCount;m<n.table.colCount;m++){const b=n.getColGroupInRightBottomCorner(m);let C=0;b==null||b.forEachChildren(_=>{_.setAttribute("y",C),C+=n.table.getRowHeight(_.row)})}for(let m=n.table.frozenColCount;m<n.table.colCount-n.table.rightFrozenColCount;m++){const b=n.getColGroupInBottom(m);let C=0;b==null||b.forEachChildren(_=>{_.setAttribute("y",C),C+=n.table.getRowHeight(_.row)})}}}function Tk(i,t,e,n,o,r,s,l,a){var h,d,u,c,f,g,p;if(t.attribute.width===r&&!t.needUpdateWidth)return!1;t.needUpdateWidth=!1,t.setAttribute("width",r);const v=t;if(!v)return!1;const m=i.table.isAutoRowHeight(n),b=(h=i.table.getCellRawRecord(e,n))===null||h===void 0?void 0:h.vtableMerge,C=!!i.table.getCustomMerge(e,n),_=b||C?"text":i.table.isHeader(e,n)?(d=i.table._getHeaderLayoutMap(e,n).headerType)!==null&&d!==void 0?d:"text":(u=i.table.getBodyColumnType(e,n))!==null&&u!==void 0?u:"text";let w=!1;if(_==="progressbar"){const y=i.table.getBodyColumnDefine(e,n),x=i.table._getCellStyle(e,n),S=i.table.getCellValue(e,n),R=i.table.getCellOriginValue(e,n),B=xt(q("padding",x,e,n,i.table));let A;y!=null&&y.mergeCell&&(A=i.table.getCellRange(e,n));const M=ut.getFunction("createProgressBarCell")(y,x,v.attribute.width,S,R,e,n,B,i.table,A),k=v.getChildByName("progress-bar");v.insertBefore(M,k),v.removeChild(k),k.removeAllChild(),k.release();const E=Zv(v,r,s,m,!0,i.table);w=w||E}else if(_==="sparkline"){v.removeAllChild();const y=i.table._getCellStyle(e,n),x=xt(q("padding",y,e,n,i.table));ut.getFunction("createSparkLineCellGroup")(v,v.parent,v.attribute.x,v.attribute.y,e,n,v.attribute.width,v.attribute.height,x,i.table,no(y,i.table,e,n,q).theme,!1)}else if(_==="image"||_==="video")qs(v,e,n,s,0,i.table);else if(((c=v.firstChild)===null||c===void 0?void 0:c.name)==="axis"){const y=i.table.internalProps.layoutMap.getAxisConfigInPivotChart(e,n),x=i.table._getCellStyle(e,n),S=xt(q("padding",x,e,n,i.table));if(y){const R=new(ut.getComponent("axis"))(y,v.attribute.width,v.attribute.height,(f=y.__vtablePadding)!==null&&f!==void 0?f:S,i.table);v.clear(),v.appendChild(R.component),R.overlap()}}else if(((g=t.firstChild)===null||g===void 0?void 0:g.name)==="axis")(p=t.firstChild)===null||p===void 0||p.originAxis.resize(t.attribute.width,t.attribute.height);else{let y=!0;const x=t.getChildByName(tn)||t.getChildByName(uh);if(x){let R;t.removeChild(x);const B=ph(e,n,t,i.table);if(B)for(let A=B.start.col;A<=B.end.col;A++){if(A===e)continue;const M=i.getCell(A,n),k=M.getChildByName(tn)||M.getChildByName(uh);k.removeAllChild(),M.removeChild(k),ph(A,n,M,i.table)}else{let A,M;const k=i.table.getCellLocation(e,n),{vtableMerge:E}=i.table.getCellRawRecord(e,n)||{};if(E&&i.table.options.groupTitleCustomLayout)M=i.table.options.groupTitleCustomLayout;else if(k!=="body"){const T=i.table.getHeaderDefine(e,n);A=T==null?void 0:T.headerCustomRender,M=T==null?void 0:T.headerCustomLayout}else{const T=i.table.getBodyColumnDefine(e,n);A=(T==null?void 0:T.customRender)||i.table.customRender,M=T==null?void 0:T.customLayout}if((A||M)&&Zn(v)){for(let T=v.mergeStartCol;T<=v.mergeEndCol;T++)if(T!==e)for(let P=v.mergeStartRow;P<=v.mergeEndRow;P++)i.updateCellContent(T,P)}if(M||A){const T=i.table._getCellStyle(e,n),P=xt(q("padding",T,e,n,i.table));let H=v.attribute.width,L=v.attribute.height;Zn(v)&&(H=i.table.getColsWidth(v.mergeStartCol,v.mergeEndCol),L=i.table.getRowsHeight(v.mergeStartRow,v.mergeEndRow));const F=to(M,A,e,n,H,L,!1,i.table.isAutoRowHeight(n),P,Zn(v)?{start:{col:v.mergeStartCol,row:v.mergeStartRow},end:{col:v.mergeEndCol,row:v.mergeEndRow}}:void 0,i.table);R=F.elementsGroup,y=F.renderDefault,w=!0}t.childrenCount>0&&R?t.insertBefore(R,t.firstChild):R&&t.appendChild(R)}}const S=Zv(v,r,s,m,y,i.table);w=w||S}return a||(a=i.table._getCellStyle(e,n).autoWrapText),!(!m||!a)&&w}function Zv(i,t,e,n,o,r){if(Zn(i)){t=0;let d=!1;for(let v=i.mergeStartCol;v<=i.mergeEndCol;v++)t+=r.getColWidth(v);let u=0;for(let v=i.mergeStartRow;v<=i.mergeEndRow;v++)u+=r.getRowHeight(v);const{colStart:c,colEnd:f,rowStart:g,rowEnd:p}=oo(i,r.scenegraph);for(let v=c;v<=f;v++)for(let m=g;m<=p;m++){if(v===i.col&&m!==i.row)continue;const b=r.scenegraph.getCell(v,m);if(b.role!=="cell")continue;b.forEachChildren(x=>{x.setAttributes({dx:0,dy:0})});let C=!1;if(o){const x=r._getCellStyle(c,g),S=xt(q("padding",x,v,m,r)),R=x.textAlign,B=x.textBaseline;C=gh(b,t,u,e,n,S,R,B,r.scenegraph);const A=ui(b.col,b.row,r);if(A){const M=b.getChildByName("text"),k=b.getChildByName("expand")||b.getChildByName("collapse");(k==null?void 0:k.role)!=="icon-left"&&M&&M.setAttribute("dx",A)}}const _=r.getRowHeight(m),w=r.getColWidth(v);b.contentWidth=t;const{heightChange:y}=ul(b,w,_,{start:{col:i.mergeStartCol,row:i.mergeStartRow},end:{col:i.mergeEndCol,row:i.mergeEndRow}},r);y&&(b.needUpdateHeight=!0),d=d||C}return d}const s=r._getCellStyle(i.col,i.row),l=xt(q("padding",s,i.col,i.row,r)),a=s.textAlign,h=s.textBaseline;return gh(i,t,r.getRowHeight(i.row),e,n,l,a,h,r.scenegraph)}function Jv(i,t){const e=Math.round(yi(t,0,i.table.colCount-1,i.table));i.table._setRowHeight(t,e,!0);for(let n=0;n<i.table.colCount;n++){const o=e,r=i.highPerformanceGetCell(n,t);r.role!=="empty"&&dw(i,r,n,t,o,o-r.attribute.height,i.table.isHeader(n,t))}}var si;(function(i){i.dropDown="dropDown",i.contextmenu="contextmenu",i.custom="custom"})(si||(si={}));const Jt={fontSize:12,fontFamily:"Arial,sans-serif",color:"#000",highlightColor:"#2E68CF",hoverBgColor:"#EEE",lineHeight:30,bgColor:"#FFF",cornerRadius:4,borderWidth:.5,borderColor:"#CCC",menuPadding:6,menuItemPadding:9,maxLineWidth:200};let Pk=class{constructor(t){this._table=t,this._menuInstance=new Tt({x:0,y:0,fill:Jt.bgColor,stroke:Jt.borderColor,cornerRadius:Jt.cornerRadius,lineWidth:Jt.borderWidth}),this._menuInfo={x:-1,y:-1,col:-1,row:-1,type:si.dropDown,menuInfo:[],highlightIndex:-1}}bindTableComponent(t){t.appendChild(this._menuInstance),this.bindEvent()}release(){}attach(t,e,n,o,r,s){if(r===si.dropDown&&this.checkDropDownMenuChange(n,o)){const l=this.getMenuInfo(n,o,r);if(!l)return;const{menuInfo:a,highlightIndex:h}=l;this.updateMenuInfo(n,o,r,a,h),this.updateMenuInstance(a,h)}else if(r===si.contextmenu&&this.checkContextMenuChange(t,e)){const l=this.getMenuInfo(n,o,r);if(!l)return;const{menuInfo:a,highlightIndex:h}=l;this.updateMenuInfo(n,o,r,a,h),this.updateMenuInstance(a,h)}this.updatePosition(t-this._table.scenegraph.x,e-this._table.scenegraph.y),this.addToScene()}updateMenuInfo(t,e,n,o,r){this._menuInfo.col=t,this._menuInfo.row=e,this._menuInfo.type=n,this._menuInfo.menuInfo=o,this._menuInfo.highlightIndex=r}checkDropDownMenuChange(t,e){const{type:n,col:o,row:r}=this._menuInfo;return n!==si.dropDown||t!==o||e!==r}checkContextMenuChange(t,e){var n;const{type:o,menuInfo:r}=this._menuInfo;return o!==si.contextmenu||r!==((n=this._table.internalProps.menu)===null||n===void 0?void 0:n.contextMenuItems)}updateMenuInstance(t,e){this._menuInstance.removeAllChild();let n=Jt.menuPadding;const o=Jt.menuPadding;let r=0;t.forEach((s,l)=>{var a,h;const d=e===l;let u,c;typeof s=="string"?c=s:typeof s=="object"&&(c=s.text,u=d?s.selectedIcon:s.icon);const f=new Tt({y:n,x:o,height:Jt.lineHeight,fill:Jt.bgColor});f.role="menu-item",this._menuInstance.appendChild(f),f.stateProxy=p=>p==="hover"?{fill:Jt.hoverBgColor}:{fill:Jt.bgColor},f.addEventListener("pointerenter",p=>{f.addState("hover",!0,!1),this._table.scenegraph.updateNextFrame()}),f.addEventListener("pointerleave",p=>{f.removeState("hover",!1),this._table.scenegraph.updateNextFrame()});const g=new xe({x:Jt.menuItemPadding,y:Jt.menuItemPadding,fill:d?Jt.highlightColor:Jt.color,text:c,textBaseline:"top",fontSize:Jt.fontSize,fontFamily:Jt.fontFamily,pickable:!1,maxLineWidth:Jt.maxLineWidth,ellipsis:"…"});if(f.addChild(g),u){g.AABBBounds.height();const p=(a=u.width)!==null&&a!==void 0?a:16,v=(h=u.height)!==null&&h!==void 0?h:16,m=new Fo({x:Jt.menuItemPadding,y:(Jt.lineHeight-v)/2,width:p,height:v,image:u.svg,pickable:!1});m.role="menu-icon",f.insertBefore(m,g),g.setAttribute("x",p+Jt.menuItemPadding)}r=Math.max(f.AABBBounds.width(),r),n+=Jt.lineHeight}),this._menuInstance.setAttributes({width:r+2*Jt.menuItemPadding+2*Jt.menuPadding,height:n+Jt.menuPadding}),this._menuInstance.forEachChildren(s=>{s.setAttribute("width",r+2*Jt.menuItemPadding)})}updatePosition(t,e){this._menuInstance.setAttributes({x:this._menuInfo.type===si.dropDown?t-this._menuInstance.attribute.width:t,y:e}),this._menuInfo.x=si.dropDown?t-this._menuInstance.attribute.width:t,this._menuInfo.y=e}addToScene(){this._table.scenegraph.updateNextFrame()}detach(){this._menuInstance.setAttributes({x:-1e3,y:-1e3}),this._table.scenegraph.updateNextFrame()}getMenuInfo(t,e,n){var o;if(n===si.dropDown){let r=this._table.globalDropDownMenu;r=this._table._getHeaderLayoutMap(t,e).dropDownMenu,typeof r=="function"&&(r=r({row:e,col:t,table:this._table}));let s=-1;if(Array.isArray(r)){for(let l=0;l<r.length;l++)if(this._table._dropDownMenuIsHighlight(t,e,l)){s=l;break}}return{menuInfo:r,highlightIndex:s}}if(n===si.contextmenu){const r=(o=this._table.internalProps.menu)===null||o===void 0?void 0:o.contextMenuItems;let s;if(Array.isArray(r))s=r;else if(typeof r=="function"){const{field:l}=this._table.isHeader(t,e)?this._table.getHeaderDefine(t,e):this._table.getBodyColumnDefine(t,e);s=r(l,e,t)}return{menuInfo:s,highlightIndex:-1}}}bindEvent(){this._menuInstance.addEventListener("click",t=>{const{target:e}=t;if(e&&e.role==="menu-item"){const n=this.getEventInfo(e),o=this._table.getMenuInfo(this._menuInfo.col,this._menuInfo.row,this._menuInfo.type),r=Object.assign(n,o);r.event=t.nativeEvent,this._table.fireListeners(U.DROPDOWN_MENU_CLICK,r)}})}getEventInfo(t){const e=t.parent;let n=0;e.forEachChildren((s,l)=>s===t&&(n=l-1,!0));const o=typeof this._menuInfo.menuInfo[n]=="string"?this._menuInfo.menuInfo[n]:this._menuInfo.menuInfo[n].text,r=typeof this._menuInfo.menuInfo[n]=="string"?o:this._menuInfo.menuInfo[n].menuKey||o;return{col:this._menuInfo.col,row:this._menuInfo.row,dropDownIndex:n,highlight:n===this._menuInfo.highlightIndex,text:o,menuKey:r}}get bounds(){return this._menuInstance.globalAABBBounds}};const tu=Ni();class Hk{constructor(){const t=tu.drillDown;this.icon=new Fo({x:-1e3,y:-1e3,image:t.svg,width:t.width,height:t.height,dx:-t.width/2,dy:-t.height/2,visible:!1,funcType:t.funcType,cursor:t.cursor}),this.icon.role="icon-drill"}appand(t){t.appendChild(this.icon)}update(t,e,n,o,r,s){if(!t||o&&r)return this.icon.setAttributes({x:-1e3,y:-1e3,visible:!1}),void s.updateNextFrame();const l=tu.drillDown,a=tu.drillUp;this.icon.setAttributes({x:e,y:n,image:o?l.svg:a.svg,visible:!0}),this.icon.loadImage(this.icon.attribute.image),s.updateNextFrame()}}class kk{constructor(t){const e=t.theme.dragHeaderSplitLine.lineWidth,n=t.theme.dragHeaderSplitLine.lineColor,o=t.theme.dragHeaderSplitLine.shadowBlockColor;this.columnMoverLabel=zs({visible:!1,pickable:!1,x:0,y:0,symbolType:"triangle",fill:n}),this.columnMoverLine=hi({visible:!1,pickable:!1,stroke:n,lineWidth:e,x:0,y:0,points:[{x:0,y:0},{x:0,y:0}]}),this.columnMoverBack=qt({visible:!1,pickable:!1,fill:o,x:0,y:0,width:0,height:0}),this.table=t}appand(t){t.appendChild(this.columnMoverLabel),t.appendChild(this.columnMoverLine),t.appendChild(this.columnMoverBack)}show(t,e,n){const o=this.table.getCellLocation(t,e),r=ae(this.table,t,e);r&&(t=r.start.col,e=r.start.row);let s=0,l=0,a=0,h=0,d=0,u=0,c=0,f=0,g=Math.PI;const p=[];return o==="columnHeader"?(s=this.table.getColsWidth(0,t-1)-this.table.stateManager.scroll.horizontalBarPos,l=this.table.getRowsHeight(0,this.table.frozenRowCount-1),h=this.table.tableNoFrameHeight,a=r?this.table.getColsWidth(r.start.col,r.end.col):this.table.getColWidth(t),d=s-n,c=s+a,f=2,p.push({x:0,y:0}),p.push({x:0,y:this.table.tableNoFrameHeight})):(o==="rowHeader"||this.table.internalProps.layoutMap.isSeriesNumberInBody(t,e))&&(l=this.table.getRowsHeight(0,e-1)-this.table.stateManager.scroll.verticalBarPos,s=this.table.getColsWidth(0,this.table.frozenColCount-1),a=this.table.tableNoFrameWidth,h=r?this.table.getRowsHeight(r.start.row,r.end.row):this.table.getRowHeight(e),u=l-n,c=2,f=l+h,g=Math.PI/2,p.push({x:0,y:0}),p.push({x:this.table.tableNoFrameWidth,y:0})),this.columnMoverBack.setAttributes({visible:!0,x:s-d,y:l-u,width:a,height:h,dx:d,dy:u}),this.columnMoverLine.setAttributes({x:c,y:f,visible:!0,points:p}),this.columnMoverLabel.setAttributes({visible:!0,x:c,y:f,angle:g}),{backX:s-d,lineX:c,backY:l-u,lineY:f}}hide(){this.columnMoverLabel.setAttribute("visible",!1),this.columnMoverLine.setAttribute("visible",!1),this.columnMoverBack.setAttribute("visible",!1)}update(t,e,n,o){typeof t=="number"&&typeof e=="number"?(this.columnMoverLabel.setAttribute("x",e),this.columnMoverLine.setAttribute("x",e),this.columnMoverBack.setAttribute("x",t)):typeof n=="number"&&typeof o=="number"&&(this.columnMoverLabel.setAttribute("y",o),this.columnMoverLine.setAttribute("y",o),this.columnMoverBack.setAttribute("y",n))}updateStyle(){const t=this.table.theme.dragHeaderSplitLine.lineWidth,e=this.table.theme.dragHeaderSplitLine.lineColor,n=this.table.theme.dragHeaderSplitLine.shadowBlockColor;this.columnMoverLabel.setAttributes({fill:e}),this.columnMoverLine.setAttributes({stroke:e,lineWidth:t}),this.columnMoverBack.setAttributes({fill:n})}}function jl(i,t,e){if(e)return Math.min(t.tableNoFrameWidth,t.getAllColsWidth())-t.getColsWidth(i,t.colCount-1);let n=t.getColsWidth(0,i);return i>=t.frozenColCount&&(n-=t.scrollLeft),n}function Qv(i,t,e){if(e)return Math.min(t.tableNoFrameWidth,t.getAllRowsHeight())-t.getRowsHeight(i,t.rowCount-1);let n=t.getRowsHeight(0,i);return i>=t.frozenRowCount&&(n-=t.scrollTop),n}class Ek{constructor(t){var e,n,o,r,s,l,a,h,d,u,c,f,g,p,v,m,b;this.table=t;const C=this.table.theme;this.createScrollBar();const _=(e=C.columnResize)===null||e===void 0?void 0:e.lineColor,w=(n=C.columnResize)===null||n===void 0?void 0:n.lineWidth,y=(o=C.columnResize)===null||o===void 0?void 0:o.bgColor,x=(r=C.columnResize)===null||r===void 0?void 0:r.width,S=(l=(s=C.columnResize)===null||s===void 0?void 0:s.labelVisible)===null||l===void 0||l,R=(a=C.columnResize)===null||a===void 0?void 0:a.labelColor,B=(h=C.columnResize)===null||h===void 0?void 0:h.labelFontSize,A=(d=C.columnResize)===null||d===void 0?void 0:d.labelFontFamily,M=(u=C.columnResize)===null||u===void 0?void 0:u.labelBackgroundFill,k=(c=C.columnResize)===null||c===void 0?void 0:c.labelBackgroundCornerRadius;this.labelVisible=S,this.columnResizeLine=hi({visible:!1,pickable:!1,stroke:_,lineWidth:w,x:0,y:0,points:[{x:0,y:0},{x:0,y:0}]}),this.columnResizeBgLine=hi({visible:!1,pickable:!1,stroke:y,lineWidth:x,x:0,y:0,points:[{x:0,y:0},{x:0,y:0}]});const E=ec({visible:!1,pickable:!1,x:0,y:0,fontSize:B,fill:R,fontFamily:A,text:"",textBaseline:"top",dx:16,dy:-B/2}),T=qt({visible:!1,pickable:!1,fill:M,x:0,y:0,width:5*B*.8,height:B+8,cornerRadius:k,dx:12,dy:-B/2-4});this.columnResizeLabel=pa({visible:!1,pickable:!1,x:0,y:0}),this.columnResizeLabel.appendChild(T),this.columnResizeLabel.appendChild(E),this.rowResizeLine=hi({visible:!1,pickable:!1,stroke:_,lineWidth:w,x:0,y:0,points:[{x:0,y:0},{x:0,y:0}]}),this.rowResizeBgLine=hi({visible:!1,pickable:!1,stroke:y,lineWidth:x,x:0,y:0,points:[{x:0,y:0},{x:0,y:0}]});const P=ec({visible:!1,pickable:!1,x:0,y:0,fontSize:B,fill:R,fontFamily:A,text:"",textBaseline:"top",dx:16,dy:-B/2}),H=qt({visible:!1,pickable:!1,fill:M,x:0,y:0,width:5*B*.8,height:B+8,cornerRadius:k,dx:12,dy:-B/2-4});this.rowResizeLabel=pa({visible:!1,pickable:!1,x:0,y:0}),this.rowResizeLabel.appendChild(H),this.rowResizeLabel.appendChild(P),this.cellMover=new kk(this.table);const L=(g=(f=C.frozenColumnLine)===null||f===void 0?void 0:f.shadow)===null||g===void 0?void 0:g.width,F=(v=(p=C.frozenColumnLine)===null||p===void 0?void 0:p.shadow)===null||v===void 0?void 0:v.startColor,z=(b=(m=C.frozenColumnLine)===null||m===void 0?void 0:m.shadow)===null||b===void 0?void 0:b.endColor;this.frozenShadowLine=qt({visible:!0,pickable:!1,x:0,y:0,width:L,height:0,fill:{gradient:"linear",x0:0,y0:0,x1:1,y1:0,stops:[{color:F,offset:0},{color:z,offset:1}]}}),this.rightFrozenShadowLine=qt({visible:!0,pickable:!1,x:0,y:0,width:L,height:0,fill:{gradient:"linear",x0:0,y0:0,x1:1,y1:0,stops:[{color:z,offset:0},{color:F,offset:1}]}}),this.menu=new Pk(this.table),this.drillIcon=new Hk}addToGroup(t){t.addChild(this.frozenShadowLine),t.addChild(this.rightFrozenShadowLine),t.addChild(this.columnResizeBgLine),t.addChild(this.columnResizeLine),t.addChild(this.columnResizeLabel),t.addChild(this.rowResizeBgLine),t.addChild(this.rowResizeLine),t.addChild(this.rowResizeLabel),this.table.theme.scrollStyle.hoverOn&&!this.table.theme.scrollStyle.barToSide?(t.addChild(this.hScrollBar),t.addChild(this.vScrollBar)):(t.stage.defaultLayer.addChild(this.hScrollBar),t.stage.defaultLayer.addChild(this.vScrollBar)),this.menu.bindTableComponent(t),this.drillIcon.appand(t),this.cellMover.appand(t)}createScrollBar(){var t,e,n,o,r,s;const l=this.table.theme,a=(t=l.scrollStyle)===null||t===void 0?void 0:t.scrollRailColor,h=(e=l.scrollStyle)===null||e===void 0?void 0:e.scrollSliderColor,d=(n=l.scrollStyle)===null||n===void 0?void 0:n.scrollSliderCornerRadius,u=(o=l.scrollStyle)===null||o===void 0?void 0:o.width,c=(r=l.scrollStyle)===null||r===void 0?void 0:r.horizontalPadding,f=(s=l.scrollStyle)===null||s===void 0?void 0:s.verticalPadding;let g;g=O(d)?{cornerRadius:d,fill:h}:{fill:h},this.hScrollBar=new Eo({direction:"horizontal",x:2*-this.table.tableNoFrameWidth,y:2*-this.table.tableNoFrameHeight,width:this.table.tableNoFrameWidth,height:u,padding:c,railStyle:{fill:a},sliderStyle:g,range:[0,.1],visible:!1}),this.hScrollBar.render(),this.hScrollBar.hideAll(),this.vScrollBar=new Eo({direction:"vertical",x:2*-this.table.tableNoFrameWidth,y:2*-this.table.tableNoFrameHeight,width:u,height:this.table.tableNoFrameHeight-this.table.getFrozenRowsHeight(),padding:f,railStyle:{fill:a},sliderStyle:g,range:[0,.1],visible:!1}),this.vScrollBar.render(),this.vScrollBar.hideAll()}updateScrollBar(){var t,e,n,o,r,s,l;const a=this.table.stateManager.scroll.horizontalBarPos,h=this.table.stateManager.scroll.verticalBarPos,d=this.table.theme,u=(t=d.scrollStyle)===null||t===void 0?void 0:t.width,c=(e=d.scrollStyle)===null||e===void 0?void 0:e.visible,f=(o=(n=d.scrollStyle)===null||n===void 0?void 0:n.horizontalVisible)!==null&&o!==void 0?o:c,g=(s=(r=d.scrollStyle)===null||r===void 0?void 0:r.verticalVisible)!==null&&s!==void 0?s:c,p=Math.ceil(this.table.scenegraph.tableGroup.attribute.width),v=Math.ceil(this.table.scenegraph.tableGroup.attribute.height),m=this.table.getAllRowsHeight(),b=this.table.getAllColsWidth(),C=this.table.getFrozenRowsHeight(),_=this.table.getFrozenColsWidth(),w=this.table.getBottomFrozenRowsHeight(),y=this.table.getRightFrozenColsWidth(),x=!((l=this.table.options.customConfig)===null||l===void 0)&&l._disableColumnAndRowSizeRound?1:0;if(b>p+x){const S=Math.min(v,m),R=Math.max(.05,(p-_)/(b-_)),B=this.table.theme.scrollStyle.hoverOn;let A=0;A=this.table.theme.scrollStyle.barToSide?this.table.tableNoFrameHeight-(B?u:-this.table.scenegraph.tableGroup.attribute.y)+this.table.tableY:S-(B?u:-this.table.scenegraph.tableGroup.attribute.y),this.hScrollBar.setAttributes({x:_+(B?0:this.table.scenegraph.tableGroup.attribute.x),y:A,width:p-_-y,range:[0,R],visible:f==="always"});const M=this.hScrollBar.AABBBounds&&this.hScrollBar.globalAABBBounds;this.hScrollBar._viewPosition={x:M.x1,y:M.y1},f==="always"&&this.hScrollBar.showAll()}else this.hScrollBar.setAttributes({x:2*-this.table.tableNoFrameWidth,y:2*-this.table.tableNoFrameHeight,width:0,visible:!1});if(m>v+x){const S=Math.min(p,b),R=Math.max(.05,(v-C)/(m-C));let B=0;const A=this.table.theme.scrollStyle.hoverOn;B=this.table.theme.scrollStyle.barToSide?this.table.tableNoFrameWidth-(A?u:-this.table.scenegraph.tableGroup.attribute.x)+this.table.tableX:S-(A?u:-this.table.scenegraph.tableGroup.attribute.x),this.vScrollBar.setAttributes({x:B,y:C+(A?0:this.table.scenegraph.tableGroup.attribute.y),height:v-C-w,range:[0,R],visible:g==="always"});const M=this.vScrollBar.AABBBounds&&this.vScrollBar.globalAABBBounds;this.vScrollBar._viewPosition={x:M.x1,y:M.y1},g==="always"&&this.vScrollBar.showAll()}else this.vScrollBar.setAttributes({x:2*-this.table.tableNoFrameWidth,y:2*-this.table.tableNoFrameHeight,height:0,visible:!1});this.table.stateManager.setScrollLeft(a),this.table.stateManager.setScrollTop(h)}hideResizeCol(){this.columnResizeLine.setAttribute("visible",!1),this.columnResizeBgLine.setAttribute("visible",!1),this.columnResizeLabel.setAttribute("visible",!1),this.columnResizeLabel.hideAll()}showResizeCol(t,e,n){const o=jl(t,this.table,n);this.columnResizeLine.setAttributes({visible:!0,x:o,points:[{x:0,y:0},{x:0,y:this.table.getRowsHeight(0,this.table.rowCount-1)}]}),this.columnResizeBgLine.setAttributes({visible:!0,x:o,points:[{x:0,y:0},{x:0,y:this.table.getRowsHeight(0,this.table.rowCount-1)}]}),this.labelVisible&&(this.columnResizeLabel.showAll(),this.columnResizeLabel.setAttributes({visible:!0,x:o,y:e}),this.columnResizeLabel.lastChild.setAttribute("text",`${this.table.getColWidth(t)}px`))}updateResizeCol(t,e,n){const o=jl(t,this.table,n);this.columnResizeLine.setAttributes({x:o,points:[{x:0,y:0},{x:0,y:this.table.getRowsHeight(0,this.table.rowCount-1)}]}),this.columnResizeBgLine.setAttributes({x:o,points:[{x:0,y:0},{x:0,y:this.table.getRowsHeight(0,this.table.rowCount-1)}]}),this.labelVisible&&(this.columnResizeLabel.setAttributes({x:o,y:e}),this.columnResizeLabel.lastChild.setAttribute("text",`${Math.floor(this.table.getColWidth(t))}px`))}hideResizeRow(){this.rowResizeLine.setAttribute("visible",!1),this.rowResizeBgLine.setAttribute("visible",!1),this.rowResizeLabel.setAttribute("visible",!1),this.rowResizeLabel.hideAll()}showResizeRow(t,e,n){const o=Qv(t,this.table,n);this.rowResizeLine.setAttributes({visible:!0,y:o,points:[{y:0,x:0},{y:0,x:this.table.getColsWidth(0,this.table.colCount-1)}]}),this.rowResizeBgLine.setAttributes({visible:!0,y:o,points:[{y:0,x:0},{y:0,x:this.table.getColsWidth(0,this.table.colCount-1)}]}),this.labelVisible&&(this.rowResizeLabel.showAll(),this.rowResizeLabel.setAttributes({visible:!0,y:o,x:e}),this.rowResizeLabel.lastChild.setAttribute("text",`${this.table.getRowHeight(t)}px`))}updateResizeRow(t,e,n){const o=Qv(t,this.table,n);this.rowResizeLine.setAttributes({y:o,points:[{y:0,x:0},{y:0,x:this.table.getColsWidth(0,this.table.colCount-1)}]}),this.rowResizeBgLine.setAttributes({y:o,points:[{y:0,x:0},{y:0,x:this.table.getColsWidth(0,this.table.colCount-1)}]}),this.labelVisible&&(this.rowResizeLabel.setAttributes({y:o,x:e}),this.rowResizeLabel.lastChild.setAttribute("text",`${Math.floor(this.table.getRowHeight(t))}px`))}hideMoveCol(){this.cellMover.hide()}showMoveCol(t,e,n){return this.cellMover.show(t,e,n)}updateMoveCol(t,e,n,o){this.cellMover.update(t,e,n,o)}setFrozenColumnShadow(t,e){if(t<0)this.frozenShadowLine.setAttributes({visible:!1});else{const n=jl(t,this.table,e);this.frozenShadowLine.setAttributes({visible:!0,x:n,height:this.table.getDrawRange().height})}}setRightFrozenColumnShadow(t){if(t>=this.table.colCount)this.rightFrozenShadowLine.setAttributes({visible:!1});else{const e=jl(t,this.table,!0);this.rightFrozenShadowLine.setAttributes({visible:!0,x:e-this.rightFrozenShadowLine.attribute.width,height:this.table.getDrawRange().height})}}hideVerticalScrollBar(){var t;const e=this.table.theme.scrollStyle.visible,n=(t=this.table.theme.scrollStyle.verticalVisible)!==null&&t!==void 0?t:e;n!=="focus"&&n!=="scrolling"||(this.vScrollBar.setAttribute("visible",!1),this.vScrollBar.hideAll(),this.table.scenegraph.updateNextFrame())}showVerticalScrollBar(){var t;const e=this.table.theme.scrollStyle.visible,n=(t=this.table.theme.scrollStyle.verticalVisible)!==null&&t!==void 0?t:e;n!=="focus"&&n!=="scrolling"||(this.vScrollBar.setAttribute("visible",!0),this.vScrollBar.showAll(),this.table.scenegraph.updateNextFrame())}hideHorizontalScrollBar(){var t;const e=this.table.theme.scrollStyle.visible,n=(t=this.table.theme.scrollStyle.horizontalVisible)!==null&&t!==void 0?t:e;n!=="focus"&&n!=="scrolling"||(this.hScrollBar.setAttribute("visible",!1),this.hScrollBar.hideAll(),this.table.scenegraph.updateNextFrame())}showHorizontalScrollBar(){var t;const e=this.table.theme.scrollStyle.visible,n=(t=this.table.theme.scrollStyle.horizontalVisible)!==null&&t!==void 0?t:e;n!=="focus"&&n!=="scrolling"||(this.hScrollBar.setAttribute("visible",!0),this.hScrollBar.showAll(),this.table.scenegraph.updateNextFrame())}updateVerticalScrollBarPos(t){const e=this.vScrollBar.attribute.range,n=e[1]-e[0],o=t*(1-n);this.vScrollBar.setAttribute("range",[o,o+n]);const r=this.vScrollBar.AABBBounds&&this.vScrollBar.globalAABBBounds;this.vScrollBar._viewPosition={x:r.x1,y:r.y1}}updateHorizontalScrollBarPos(t){const e=this.hScrollBar.attribute.range,n=e[1]-e[0],o=t*(1-n);this.hScrollBar.setAttribute("range",[o,o+n]);const r=this.hScrollBar.AABBBounds&&this.hScrollBar.globalAABBBounds;this.hScrollBar._viewPosition={x:r.x1,y:r.y1}}updateStyle(){var t,e,n,o,r,s,l,a,h,d,u,c,f,g,p,v,m,b,C,_,w,y,x;const S=this.table.theme,R=(t=S.scrollStyle)===null||t===void 0?void 0:t.scrollRailColor,B=(e=S.scrollStyle)===null||e===void 0?void 0:e.scrollSliderColor,A=(n=S.scrollStyle)===null||n===void 0?void 0:n.scrollSliderCornerRadius,M=(o=S.scrollStyle)===null||o===void 0?void 0:o.width,k=(r=S.scrollStyle)===null||r===void 0?void 0:r.horizontalPadding,E=(s=S.scrollStyle)===null||s===void 0?void 0:s.verticalPadding;let T;T=O(A)?{cornerRadius:A,fill:B}:{fill:B},this.hScrollBar.setAttributes({height:M,padding:k,railStyle:{fill:R},sliderStyle:T}),this.vScrollBar.setAttributes({width:M,padding:E,railStyle:{fill:R},sliderStyle:T});const P=(l=S.columnResize)===null||l===void 0?void 0:l.lineColor,H=(a=S.columnResize)===null||a===void 0?void 0:a.lineWidth,L=(h=S.columnResize)===null||h===void 0?void 0:h.bgColor,F=(d=S.columnResize)===null||d===void 0?void 0:d.width;this.columnResizeLine.setAttributes({stroke:P,lineWidth:H}),this.columnResizeBgLine=hi({stroke:L,lineWidth:F});const z=(u=S.columnResize)===null||u===void 0?void 0:u.labelColor,I=(c=S.columnResize)===null||c===void 0?void 0:c.labelFontSize,N=(f=S.columnResize)===null||f===void 0?void 0:f.labelFontFamily,W=(g=S.columnResize)===null||g===void 0?void 0:g.labelBackgroundFill,D=(p=S.columnResize)===null||p===void 0?void 0:p.labelBackgroundCornerRadius,j=(m=(v=S.columnResize)===null||v===void 0?void 0:v.labelVisible)===null||m===void 0||m;this.labelVisible=j,this.columnResizeLabel.lastChild.setAttributes({fontSize:I,fill:z,fontFamily:N,dy:-I/2}),this.columnResizeLabel.firstChild.setAttributes({fill:W,width:5*I*.8,height:I+8,cornerRadius:D,dy:-I/2-4}),this.rowResizeLabel.lastChild.setAttributes({fontSize:I,fill:z,fontFamily:N,dy:-I/2}),this.rowResizeLabel.firstChild.setAttributes({fill:W,width:5*I*.8,height:I+8,cornerRadius:D,dy:-I/2-4});const V=(C=(b=S.frozenColumnLine)===null||b===void 0?void 0:b.shadow)===null||C===void 0?void 0:C.width,X=(w=(_=S.frozenColumnLine)===null||_===void 0?void 0:_.shadow)===null||w===void 0?void 0:w.startColor,K=(x=(y=S.frozenColumnLine)===null||y===void 0?void 0:y.shadow)===null||x===void 0?void 0:x.endColor;this.frozenShadowLine.setAttributes({width:V,fill:{gradient:"linear",x0:0,y0:0,x1:1,y1:0,stops:[{color:X,offset:0},{color:K,offset:1}]}}),this.rightFrozenShadowLine.setAttributes({width:V,fill:{gradient:"linear",x0:0,y0:0,x1:1,y1:0,stops:[{color:K,offset:0},{color:X,offset:1}]}}),this.cellMover.updateStyle()}}function Hi(i,t,e,n,o){var r,s,l,a,h,d;if(!t)return;const u=e==="table",{shadowBlur:c,shadowOffsetX:f,shadowOffsetY:g,shadowColor:p,cornerRadius:v,borderColor:m,borderLineWidth:b,borderLineDash:C}=t;let _=!1;const w={},y={pickable:!1};c&&u&&(y.shadowBlur=c,y.shadowOffsetX=f,y.shadowOffsetY=g,y.shadowColor=p,y.stroke=!0,y.stroke=p,y.lineWidth=1,_=!0),b&&(y.stroke=!0,y.fill=!1,y.stroke=tf(m??"#E1E4E8",n,b),y.lineWidth=b,C&&(y.lineDash=C),y.lineCap="butt"),Array.isArray(m)&&(y.strokeArrayColor=xt(m)),Array.isArray(b)&&(y.strokeArrayWidth=xt(b),y.lineWidth=1),v&&(y.cornerRadius=v,w.cornerRadius=v);const x=y.strokeArrayWidth?y.strokeArrayWidth[0]:(r=y.lineWidth)!==null&&r!==void 0?r:0,S=y.strokeArrayWidth?y.strokeArrayWidth[1]:(s=y.lineWidth)!==null&&s!==void 0?s:0,R=y.strokeArrayWidth?y.strokeArrayWidth[2]:(l=y.lineWidth)!==null&&l!==void 0?l:0,B=y.strokeArrayWidth?y.strokeArrayWidth[3]:(a=y.lineWidth)!==null&&a!==void 0?a:0;if(i.setAttributes(w),!o)if(y.stroke)if(y.x=B/2,y.y=x/2,y.pickable=!1,u){if(v)if(Array.isArray(v)){const k=xt(v);y.cornerRadius=k,w.cornerRadius=k,k[0]&&(k[0]=k[0]+Math.min(B,x)/2),k[1]&&(k[1]=k[1]+Math.min(x,S)/2),k[2]&&(k[2]=k[2]+Math.min(S,R)/2),k[3]&&(k[3]=k[3]+Math.min(R,B)/2)}else if(Q(b)){const k=[];y.cornerRadius=k,w.cornerRadius=k,k[0]=v+Math.min(B,x)/2,k[1]=v+Math.min(x,S)/2,k[2]=v+Math.min(S,R)/2,k[3]=v+Math.min(R,B)/2}else y.cornerRadius=v+((h=y.lineWidth)!==null&&h!==void 0?h:0)/2,w.cornerRadius=v+((d=y.lineWidth)!==null&&d!==void 0?d:0)/2;let A,M;if(t.innerBorder?(y.x=i.attribute.x+B/2,y.y=i.attribute.y+x/2,y.width=i.attribute.width-B/2-S/2,y.height=i.attribute.height-x/2-R/2):(y.x=i.attribute.x-B/2,y.y=i.attribute.y-x/2,y.width=i.attribute.width+B/2+S/2,y.height=i.attribute.height+x/2+R/2),_){y.fill="white",y.notAdjustPos=!0,M=pa(y),M.name="table-border-rect",A=qt({x:B/2,y:x/2,width:i.attribute.width,height:i.attribute.height,fill:"red",cornerRadius:i.attribute.cornerRadius,globalCompositeOperation:"destination-out"}),M.addChild(A);const k=qt({x:B/2,y:x/2,width:i.attribute.width,height:i.attribute.height,fill:"transparent",pickable:!1,globalCompositeOperation:"source-over"});M.addChild(k)}else M=qt(y),M.name="table-border-rect";t.innerBorder&&!_?i.parent.insertAfter(M,i):i.parent.insertBefore(M,i),i.border=M}else{y.width=i.attribute.width-B/2-S/2,y.height=i.attribute.height-x/2-R/2;const A=qt(y);A.name="border-rect",i.addChild(A),i.border=A}else{const A=qt({fill:!1,stroke:!1,pickable:!1,lineWidth:0});A.name="border-rect",i.addChild(A),i.border=A}}function tm(i,t,e){var n;if(!t)return;const{borderColor:o}=t;(n=i.border)===null||n===void 0||n.setAttribute("stroke",tf(o,e))}function tf(i,t,e){let n=!0;return!t&&!Q(e)||Q(i)?t?n=t:t||Q(i)?Q(i)&&(n=!0):n=i:n=(t??e).map(o=>!!o&&i),n}function cn(i){var t,e,n,o;if(!i.border)return;const r=i.border.attribute.strokeArrayWidth?i.border.attribute.strokeArrayWidth[0]:(t=i.border.attribute.lineWidth)!==null&&t!==void 0?t:0,s=i.border.attribute.strokeArrayWidth?i.border.attribute.strokeArrayWidth[1]:(e=i.border.attribute.lineWidth)!==null&&e!==void 0?e:0,l=i.border.attribute.strokeArrayWidth?i.border.attribute.strokeArrayWidth[2]:(n=i.border.attribute.lineWidth)!==null&&n!==void 0?n:0,a=i.border.attribute.strokeArrayWidth?i.border.attribute.strokeArrayWidth[3]:(o=i.border.attribute.lineWidth)!==null&&o!==void 0?o:0;i.border.setAttributes({borderLeft:a,borderTop:r,borderRight:s,borderBottom:l,width:i.attribute.width-a/2-s/2,height:i.attribute.height-r/2-l/2}),i.border.type==="group"&&i.border.firstChild.setAttributes({width:i.attribute.width,height:i.attribute.height})}function Lk(i){if(!i.theme.frameStyle.cornerRadius)return;const t=i.theme.frameStyle.cornerRadius,{cornerHeaderGroup:e,colHeaderGroup:n,rowHeaderGroup:o,bodyGroup:r,rightTopCornerGroup:s,leftBottomCornerGroup:l,rightBottomCornerGroup:a,rightFrozenGroup:h,bottomFrozenGroup:d}=i.scenegraph;e.setAttribute("cornerRadius",0),n.setAttribute("cornerRadius",0),o.setAttribute("cornerRadius",0),r.setAttribute("cornerRadius",0),s.setAttribute("cornerRadius",0),l.setAttribute("cornerRadius",0),a.setAttribute("cornerRadius",0),h.setAttribute("cornerRadius",0),d.setAttribute("cornerRadius",0);const u=M_(t);e.attribute.width>0&&e.attribute.height>0?Ee(e,[u[0],0,0,0]):n.attribute.height>0?Ee(n,[u[0],0,0,0]):o.attribute.width>0?Ee(o,[u[0],0,0,0]):Ee(r,[u[0],0,0,0]),l.attribute.width>0&&l.attribute.height>0?Ee(l,[0,0,0,u[3]]):d.attribute.height>0?Ee(d,[0,0,0,u[3]]):o.attribute.width>0?Ee(o,[0,0,0,u[3]]):Ee(r,[0,0,0,u[3]]),s.attribute.width>0&&s.attribute.height>0?Ee(s,[0,u[1],0,0]):n.attribute.height>0?Ee(n,[0,u[1],0,0]):h.attribute.width>0?Ee(h,[0,u[1],0,0]):Ee(r,[0,u[1],0,0]),a.attribute.width>0&&a.attribute.height>0?Ee(a,[0,0,u[2],0]):h.attribute.width>0?Ee(h,[0,0,u[2],0]):d.attribute.height>0?Ee(d,[0,0,u[2],0]):Ee(r,[0,0,u[2],0])}function Ee(i,t){i.setAttribute("cornerRadius",t),i.border&&i.border.setAttribute("cornerRadius",t)}const uw=ke();class mr extends Gi{constructor(t,e){if(super(e),this.type="chart",this.numberType=uw,this.isShareChartSpec=t,e.chartInstance)this.chartInstance=e.chartInstance;else{const n=this.chartInstance=new e.ClassType(e.spec,rt({},this.attribute.tableChartOption,{renderCanvas:e.canvas,mode:this.attribute.mode==="node"?"node":"desktop-browser",modeParams:this.attribute.modeParams,canvasControled:!1,viewBox:{x1:0,x2:0,y1:0,y2:0},dpr:e.dpr,interactive:!1,animation:!1,autoFit:!1}));n.renderSync(),n.getStage().enableDirtyBounds(),e.chartInstance=this.chartInstance=n}}activate(t){var e,n,o,r,s;this.active=!0;const{col:l,row:a}=this.parent,{x1:h,y1:d,x2:u,y2:c}=this.getViewBox(),f=Fk(l,a,t).intersect({x1:h-t.scrollLeft,x2:u-t.scrollLeft,y1:d-t.scrollTop,y2:c-t.scrollTop});(e=this.activeChartInstance)===null||e===void 0||e.release(),this.activeChartInstance=new this.attribute.ClassType(this.attribute.spec,rt({},this.attribute.tableChartOption,{renderCanvas:this.attribute.canvas,mode:"desktop-browser",canvasControled:!1,viewBox:{x1:0,x2:u-h,y1:0,y2:c-d},dpr:t.internalProps.pixelRatio,animation:!1,interactive:!0,autoFit:!1,beforeRender:m=>{const b=this.stage,C=m.window.getContext(),_=b.window.getViewBoxTransform(),w=b.window.getViewBox();C.inuse=!0,C.clearMatrix(),C.setTransform(_.a,_.b,_.c,_.d,_.e,_.f,!0),C.translate(w.x1,w.y1),C.setTransformForCurrent(!0),C.beginPath(),C.rect(f.x1,f.y1,f.x2-f.x1,f.y2-f.y1),C.clip(),C.clearMatrix(),t.options.canvas&&!m.needRender&&(m.pauseRender(),t.scenegraph.stage.dirtyBounds.union(this.globalAABBBounds),t.scenegraph.updateNextFrame())},afterRender(m){m.window.getContext().inuse=!1,m.needRender=!1,g.resumeRender()}}));const g=this.activeChartInstance.getStage(),p=this.globalTransMatrix.clone(),v=this.stage.window.getViewBoxTransform();p.multiply(v.a,v.b,v.c,v.d,v.e,v.f),g.window.setViewBoxTransform&&g.window.setViewBoxTransform(p.a,p.b,p.c,p.d,p.e,p.f),this.activeChartInstance.renderSync(),(o=(n=t.internalProps.layoutMap)===null||n===void 0?void 0:n.updateDataStateToActiveChartInstance)===null||o===void 0||o.call(n,this.activeChartInstance),this.activeChartInstance.on("click",m=>{var b;((b=this.attribute.spec.select)===null||b===void 0?void 0:b.enable)===!1?t.scenegraph.updateChartState(null):mr.temp&&t.scenegraph.updateChartState(m==null?void 0:m.datum)}),this.activeChartInstance.on("brushEnd",m=>{var b;t.scenegraph.updateChartState((b=m==null?void 0:m.value)===null||b===void 0?void 0:b.inBrushData),mr.temp=0,setTimeout(()=>{mr.temp=1},0)}),(s=(r=t)._bindChartEvent)===null||s===void 0||s.call(r,this.activeChartInstance)}deactivate(){var t,e;this.active=!1,(t=this.activeChartInstance)===null||t===void 0||t.updateViewBox({x1:-1e3,x2:-800,y1:-1e3,y2:-800},!1,!1),(e=this.activeChartInstance)===null||e===void 0||e.release(),this.activeChartInstance=null}updateData(t){this.attribute.data=t}getViewBox(){var t,e,n,o,r,s,l,a;const h=this.parent,d=this.attribute.cellPadding,u=this.stage.table,{x1:c,y1:f,x2:g,y2:p}=h.globalAABBBounds;return{x1:Math.ceil(c+d[3]+u.scrollLeft+((e=(t=u.options.viewBox)===null||t===void 0?void 0:t.x1)!==null&&e!==void 0?e:0)),x2:Math.ceil(c+h.attribute.width-d[1]+u.scrollLeft+((o=(n=u.options.viewBox)===null||n===void 0?void 0:n.x1)!==null&&o!==void 0?o:0)),y1:Math.ceil(f+d[0]+u.scrollTop+((s=(r=u.options.viewBox)===null||r===void 0?void 0:r.y1)!==null&&s!==void 0?s:0)),y2:Math.ceil(f+h.attribute.height-d[2]+u.scrollTop+((a=(l=u.options.viewBox)===null||l===void 0?void 0:l.y1)!==null&&a!==void 0?a:0))}}}function Fk(i,t,e){var n,o,r,s,l,a,h,d;const{layoutMap:u}=e.internalProps,c=new Rn,f=e.scenegraph.tableGroup.globalAABBBounds;return c.x1=f.x1,c.x2=f.x2,c.y1=f.y1,c.y2=f.y2,u.isLeftBottomCorner(i,t)||u.isRightTopCorner(i,t)||u.isLeftTopCorner(i,t)||u.isRightBottomCorner(i,t)||(u.isFrozenColumn(i,t)?(c.y1=f.y1+e.getFrozenRowsHeight(),c.y2=f.y2-e.getBottomFrozenRowsHeight()):u.isFrozenRow(i,t)?(c.x1=f.x1+e.getFrozenColsWidth(),c.x2=f.x2-e.getRightFrozenColsWidth()):u.isRightFrozenColumn(i,t)?(c.y1=f.y1+e.getFrozenRowsHeight(),c.y2=f.y2-e.getBottomFrozenRowsHeight()):u.isBottomFrozenRow(i,t)?(c.x1=f.x1+e.getFrozenColsWidth(),c.x2=f.x2-e.getRightFrozenColsWidth()):u.isFrozenColumn(i,t)||u.isRightFrozenColumn(i,t)||(c.x1=f.x1+e.getFrozenColsWidth(),c.x2=f.x2-e.getRightFrozenColsWidth(),c.y1=f.y1+e.getFrozenRowsHeight(),c.y2=f.y2-e.getBottomFrozenRowsHeight())),c.x1=c.x1+((o=(n=e.options.viewBox)===null||n===void 0?void 0:n.x1)!==null&&o!==void 0?o:0),c.x2=c.x2+((s=(r=e.options.viewBox)===null||r===void 0?void 0:r.x1)!==null&&s!==void 0?s:0),c.y1=c.y1+((a=(l=e.options.viewBox)===null||l===void 0?void 0:l.y1)!==null&&a!==void 0?a:0),c.y2=c.y2+((d=(h=e.options.viewBox)===null||h===void 0?void 0:h.y1)!==null&&d!==void 0?d:0),c}mr.temp=1;const eg=[],ig=[];let ng=5,og=!1;function em(i){O(i)&&(ng=i)}function zk(){return og}function cw(i){var t,e,n,o,r,s,l;const{axes:a,dataId:h,data:d,spec:u,ClassType:c,canvas:f,mode:g,modeParams:p,dpr:v}=i.attribute;let{chartInstance:m}=i;m||(m=new c(u,{renderCanvas:f,mode:g==="node"?"node":"desktop-browser",modeParams:p,canvasControled:!1,viewBox:{x1:0,x2:0,y1:0,y2:0},dpr:v,interactive:!1,animation:!1,autoFit:!1}),m.renderSync(),i.chartInstance=m);const b=i.getViewBox();b.x2<=b.x1&&(b.x2=b.x1+1),b.y2<=b.y1&&(b.y2=b.y1+1),m.updateViewBox({x1:0,x2:b.x2-b.x1,y1:0,y2:b.y2-b.y1},!1,!1);const C=m.getStage(),_=i.globalTransMatrix.clone(),w=i.stage.window.getViewBoxTransform();_.multiply(w.a,w.b,w.c,w.d,w.e,w.f),C.window.setViewBoxTransform&&C.window.setViewBoxTransform(_.a,_.b,_.c,_.d,_.e,_.f);const{table:y}=i.getRootNode();let x=!1;if(y.options.specFormat){const S=y.options.specFormat(i.attribute.spec,m,i);if(S.needFormatSpec&&S.spec){const R=S.spec;m.updateSpecSync(R),x=(t=S.updateSpec)===null||t===void 0||t}}if(!x)if(a==null||a.forEach((S,R)=>{var B,A,M,k,E;S.type==="band"?m.updateModelSpec({type:"axes",index:R},{domain:S.domain.slice(0)},!0):m.updateModelSpecSync({type:"axes",index:R},{min:(A=(B=S.range)===null||B===void 0?void 0:B.min)!==null&&A!==void 0?A:0,max:(k=(M=S.range)===null||M===void 0?void 0:M.max)!==null&&k!==void 0?k:0,tick:{tickMode:(E=S.tick)===null||E===void 0?void 0:E.tickMode}},!0)}),(n=(e=y.internalProps.layoutMap)===null||e===void 0?void 0:e.updateDataStateToActiveChartInstance)===null||n===void 0||n.call(e,m),typeof h=="string")m.updateDataSync(h,d??[]);else{const S=[];for(const R in h){const B=h[R],A=u.series.find(M=>{var k;return((k=M==null?void 0:M.data)===null||k===void 0?void 0:k.id)===R});S.push({id:R,values:B?(o=d==null?void 0:d.filter(M=>M.hasOwnProperty(B)))!==null&&o!==void 0?o:[]:d??[],fields:(r=A==null?void 0:A.data)===null||r===void 0?void 0:r.fields}),m.updateFullDataSync||m.updateDataSync(R,B?(s=d==null?void 0:d.filter(M=>M.hasOwnProperty(B)))!==null&&s!==void 0?s:[]:d??[])}(l=m.updateFullDataSync)===null||l===void 0||l.call(m,S)}Ik(m.getStage(),i)}function gw(i){og=!0,ig.length>0?requestAnimationFrame(()=>{const t=ig.splice(0,ng);eg.splice(0,ng),t.forEach(e=>{cw(e),e.addUpdateBoundTag()}),i.render(),gw(i)}):og=!1}const Yi=2e3;function Ik(i,t){var e;const{viewWidth:n,viewHeight:o}=i;if(n<Yi&&o<Yi)return t.cacheCanvas=im(i),void(t.isShareChartSpec||((e=t.chartInstance)===null||e===void 0||e.release(),t.chartInstance=null,t.setAttribute("chartInstance",null)));const r=Math.ceil(o/Yi),s=Math.ceil(n/Yi),l=[];for(let a=0;a<r;a++)for(let h=0;h<s;h++){const d=h*Yi,u=a*Yi,c=d+Yi>n?n:d+Yi,f=u+Yi>o?o:u+Yi,g=c-d,p=f-u,v=new Rn;v.setValue(d,u,c,f);const m=im(i,!1,v);l.push({canvas:m,x:d,y:u,width:g,height:p})}t.cacheCanvas=l}function im(i,t=!0,e){if(i.releaseStatus==="released")return null;const n=i.window.getViewBoxTransform(),o=Ok(i,t,e);o.setViewBoxTransform(n.a,n.b,n.c,n.d,0,0),i.renderTo(o);const r=o.getNativeHandler();return r.nativeCanvas?r.nativeCanvas:null}function Ok(i,t=!0,e){const n=i.window.getViewBoxTransform(),o=bt.get(Hs),r=e?-e.x1:0,s=e?-e.y1:0,l=e?e.x2:i.viewWidth,a=e?e.y2:i.viewHeight,h=e?e.width():i.viewWidth,d=e?e.height():i.viewHeight;return o.create({viewBox:{x1:r,y1:s,x2:l,y2:a},width:h*n.a,height:d*n.d,dpr:i.window.dpr,canvasControled:!0,offscreen:!0,title:""}),i.renderTo(o),o}var Dk=function(i,t,e,n){var o,r=arguments.length,s=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var l=i.length-1;l>=0;l--)(o=i[l])&&(s=(r<3?o(s):r>3?o(t,e,s):o(t,e))||s);return r>3&&s&&Object.defineProperty(t,e,s),s};const Wk=Symbol.for("ChartRender");let Ss=class extends ei{constructor(){super(...arguments),this.numberType=uw}drawShape(i,t,e,n,o,r,s,l){var a,h,d,u;const c=yt(i,r==null?void 0:r.theme).group,{dataId:f,data:g,spec:p}=i.attribute,{width:v=c.width,height:m=c.height}=(i.getViewBox(),i.attribute),{table:b}=i.getRootNode(),{active:C,cacheCanvas:_,activeChartInstance:w}=i;if(!C&&_)Q(_)?_.forEach(y=>{const{x,y:S,width:R,height:B,canvas:A}=y;t.drawImage(A,x,S,R,B)}):t.drawImage(_,e,n,v,m);else if(w){if(b.options.specFormat){const B=b.options.specFormat(i.attribute.spec,w,i);if(B.needFormatSpec&&B.spec){const A=B.spec;w.updateSpecSync(A)}}const y=i.getViewBox();w.updateViewBox({x1:0,x2:y.x2-y.x1,y1:0,y2:y.y2-y.y1},!1,!1);const x=w.getStage();x.needRender=!0;const S=i.globalTransMatrix.clone(),R=i.stage.window.getViewBoxTransform().clone();if(R.multiply(S.a,S.b,S.c,S.d,S.e,S.f),x.window.setViewBoxTransform(R.a,R.b,R.c,R.d,R.e,R.f),typeof f=="string")w.updateDataSync(f,g??[]);else{const B=[];for(const A in f){const M=f[A],k=p.series.find(E=>{var T;return((T=E==null?void 0:E.data)===null||T===void 0?void 0:T.id)===A});B.push({id:A,values:M?(a=g==null?void 0:g.filter(E=>E.hasOwnProperty(M)))!==null&&a!==void 0?a:[]:g??[],fields:(h=k==null?void 0:k.data)===null||h===void 0?void 0:h.fields}),w.updateFullDataSync||w.updateDataSync(A,M?(d=g==null?void 0:g.filter(E=>E.hasOwnProperty(M)))!==null&&d!==void 0?d:[]:g??[])}(u=w.updateFullDataSync)===null||u===void 0||u.call(w,B)}}else b.internalProps.renderChartAsync?(eg.indexOf(`${i.parent.col}+${i.parent.row}`)===-1&&(eg.push(`${i.parent.col}+${i.parent.row}`),ig.push(i)),zk()||gw(b)):cw(i)}draw(i,t,e,n){this._draw(i,{},!1,e,n)}};Ss=Dk([st()],Ss);var Ad=function(i,t,e,n){var o,r=arguments.length,s=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var l=i.length-1;l>=0;l--)(o=i[l])&&(s=(r<3?o(s):r>3?o(t,e,s):o(t,e))||s);return r>3&&s&&Object.defineProperty(t,e,s),s};let vh=class{constructor(){this.time=Et.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(i,t,e,n,o,r,s,l,a,h,d,u,c){const{shape:f}=i.attribute;if(f==="circle"){const{width:g=a.width,height:p=a.height}=i.attribute;t.beginPath(),t.arc(e+g/2,n+p/2,Math.min(g,p)/2,0,2*Math.PI),t.closePath(),t.save(),t.clip()}}};vh=Ad([st()],vh);let mh=class{constructor(){this.time=Et.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(i,t,e,n,o,r,s,l,a,h,d,u,c){const{shape:f}=i.attribute;f==="circle"&&t.restore()}};mh=Ad([st()],mh);let bh=class{constructor(){this.time=Et.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(i,t,e,n,o,r,s,l,a,h,d,u,c){const{isGif:f}=i.attribute;f&&i.playing&&(i.attribute.opacity=0)}};bh=Ad([st()],bh);let Ch=class{constructor(){this.time=Et.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(i,t,e,n,o,r,s,l,a,h,d,u,c){const{isGif:f}=i.attribute;f&&i.playing&&(i.attribute.opacity=1,t.globalAlpha=i.attribute.opacity,i.renderFrame(t,e,n))}};Ch=Ad([st()],Ch);function Nk(i,t){var e,n,o,r,s,l,a,h,d,u,c;let f,g;if(i.role==="cell"&&O(i.mergeStartCol)&&O(i.mergeStartRow)&&O(i.mergeEndCol)&&O(i.mergeEndRow)){const{colStart:v,colEnd:m,rowStart:b,rowEnd:C}=oo(i,t.scenegraph);for(let _=v;_<=m;_++)for(let w=b;w<=C;w++){const y=nm(t.stateManager,_,w,i);!y||f&&y!=="cellBgColor"||(f=y)}}else i.role==="cell"&&(f=nm(t.stateManager,i.col,i.row,i));if(!f)return;const p=t.internalProps.layoutMap;return p.isCornerHeader(i.col,i.row)?g=((e=t.theme.cornerHeaderStyle)===null||e===void 0?void 0:e.hover)||((n=t.theme.headerStyle)===null||n===void 0?void 0:n.hover):p.isColumnHeader(i.col,i.row)?g=(o=t.theme.headerStyle)===null||o===void 0?void 0:o.hover:p.isRowHeader(i.col,i.row)?g=(r=t.theme.rowHeaderStyle)===null||r===void 0?void 0:r.hover:p.isBottomFrozenRow(i.col,i.row)?g=((s=t.theme.bottomFrozenStyle)===null||s===void 0?void 0:s.hover)||(t.isListTable()?(l=t.theme.bodyStyle)===null||l===void 0?void 0:l.hover:(a=t.theme.headerStyle)===null||a===void 0?void 0:a.hover):p.isRightFrozenColumn(i.col,i.row)?g=((h=t.theme.rightFrozenStyle)===null||h===void 0?void 0:h.hover)||(t.isListTable()?(d=t.theme.bodyStyle)===null||d===void 0?void 0:d.hover:(u=t.theme.rowHeaderStyle)===null||u===void 0?void 0:u.hover):t.isHeader(i.col,i.row)||(g=(c=t.theme.bodyStyle)===null||c===void 0?void 0:c.hover),q(f,g,i.col,i.row,t)}function nm(i,t,e,n){var o;const{highlightScope:r,disableHeader:s,cellPos:l}=i.hover,a=i.table,h=a.isHeader(t,e);if(h&&s)return;let d;if(r===Ht.single&&l.col===t&&l.row===e?d="cellBgColor":r===Ht.column&&l.col===t?d=l.col===t&&l.row===e?"cellBgColor":"inlineColumnBgColor":r===Ht.row&&l.row===e?d=l.col===t&&l.row===e?"cellBgColor":"inlineRowBgColor":r===Ht.cross&&(l.col===t&&l.row===e?d="cellBgColor":l.col===t?d="inlineColumnBgColor":l.row===e&&(d="inlineRowBgColor")),d){let u;if(h){const c=a.getHeaderDefine(t,e);u=c==null?void 0:c.disableHeaderHover,n.firstChild&&n.firstChild.name==="axis"&&(!((o=a.options.hover)===null||o===void 0)&&o.disableAxisHover)&&(u=!0)}else{const c=a.getBodyColumnDefine(t,e);u=c==null?void 0:c.disableHover}u&&(d=void 0)}return d}function Vk(i,t){var e,n,o,r,s,l,a,h,d,u,c;let f,g;if(i.role==="cell"&&O(i.mergeStartCol)&&O(i.mergeStartRow)&&O(i.mergeEndCol)&&O(i.mergeEndRow)){const{colStart:v,colEnd:m,rowStart:b,rowEnd:C}=oo(i,t.scenegraph);for(let _=v;_<=m;_++)for(let w=b;w<=C;w++){const y=om(t.stateManager,_,w);!y||f&&y!=="cellBgColor"||(f=y)}}else i.role==="cell"&&(f=om(t.stateManager,i.col,i.row));if(!f)return;const p=t.internalProps.layoutMap;return p.isCornerHeader(i.col,i.row)?g=((e=t.theme.cornerHeaderStyle)===null||e===void 0?void 0:e.select)||((n=t.theme.headerStyle)===null||n===void 0?void 0:n.select):p.isColumnHeader(i.col,i.row)?g=(o=t.theme.headerStyle)===null||o===void 0?void 0:o.select:p.isRowHeader(i.col,i.row)?g=(r=t.theme.rowHeaderStyle)===null||r===void 0?void 0:r.select:p.isBottomFrozenRow(i.col,i.row)?g=((s=t.theme.bottomFrozenStyle)===null||s===void 0?void 0:s.select)||(t.isListTable()?(l=t.theme.bodyStyle)===null||l===void 0?void 0:l.select:(a=t.theme.headerStyle)===null||a===void 0?void 0:a.select):p.isRightFrozenColumn(i.col,i.row)?g=((h=t.theme.rightFrozenStyle)===null||h===void 0?void 0:h.select)||(t.isListTable()?(d=t.theme.bodyStyle)===null||d===void 0?void 0:d.select:(u=t.theme.rowHeaderStyle)===null||u===void 0?void 0:u.select):t.isHeader(i.col,i.row)||(g=(c=t.theme.bodyStyle)===null||c===void 0?void 0:c.select),q(f,g,i.col,i.row,t)}function Gk(i){return i.start.col!==i.end.col||i.start.row!==i.end.row}function jk(i,t,e){let n;const{highlightScope:o,cellPos:r,ranges:s}=i.select,l=s[0],a=Math.min(l.start.col,l.end.col),h=Math.max(l.start.col,l.end.col),d=Math.min(l.start.row,l.end.row),u=Math.max(l.start.row,l.end.row);return o===Ht.single&&r.col===t&&r.row===e?n="cellBgColor":o===Ht.column&&t>=a&&t<=h?n=Bi(s[0],t,e)?"cellBgColor":"inlineColumnBgColor":o===Ht.row&&e>=d&&e<=u?n=Bi(s[0],t,e)?"cellBgColor":"inlineRowBgColor":o===Ht.cross&&(Bi(s[0],t,e)?n="cellBgColor":t>=a&&t<=h?n="inlineColumnBgColor":e>=d&&e<=u&&(n="inlineRowBgColor")),n}function Uk(i,t,e){let n;const{highlightScope:o,cellPos:r}=i.select;return o===Ht.single&&r.col===t&&r.row===e?n="cellBgColor":o===Ht.column&&r.col===t?n=r.col===t&&r.row===e?"cellBgColor":"inlineColumnBgColor":o===Ht.row&&r.row===e?n=r.col===t&&r.row===e?"cellBgColor":"inlineRowBgColor":o===Ht.cross&&(r.col===t&&r.row===e?n="cellBgColor":r.col===t?n="inlineColumnBgColor":r.row===e&&(n="inlineRowBgColor")),n}function om(i,t,e,n){const{highlightInRange:o,disableHeader:r,ranges:s}=i.select;let l;const a=s.length===1&&Gk(s==null?void 0:s[0])&&o;if(a?(s==null?void 0:s.length)===1&&s[0].start&&s[0].end:(s==null?void 0:s.length)===1&&s[0].end.col===s[0].start.col&&s[0].end.row===s[0].start.row){if(i.table.isHeader(t,e)&&r)return;l=a?jk(i,t,e):Uk(i,t,e),l&&Yn(i.table,t,e)&&(l=void 0)}else if(i.table.theme.selectionStyle.selectionFillMode==="replace")for(let h=0;h<s.length;h++){const d=s[h],u=Math.min(d.start.col,d.end.col),c=Math.max(d.start.col,d.end.col),f=Math.min(d.start.row,d.end.row),g=Math.max(d.start.row,d.end.row);if(u<=t&&f<=e&&c>=t&&g>=e){l="cellBgColor";break}}return l}function Yn(i,t,e){var n,o;const r=(n=i.options.select)===null||n===void 0?void 0:n.disableSelect;if(typeof r=="function"?r(t,e,i):r)return!0;if(i.isHeader(t,e)){let s=(o=i.options.select)===null||o===void 0?void 0:o.disableHeaderSelect;if(s)return!0;const l=i.getHeaderDefine(t,e);if(s=l==null?void 0:l.disableHeaderSelect,s)return!0}else{const s=i.getBodyColumnDefine(t,e),l=s==null?void 0:s.disableSelect;if(typeof l=="function"?l(t,e,i):l)return!0}return!1}var Hn=function(i,t,e,n){var o,r=arguments.length,s=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var l=i.length-1;l>=0;l--)(o=i[l])&&(s=(r<3?o(s):r>3?o(t,e,s):o(t,e))||s);return r>3&&s&&Object.defineProperty(t,e,s),s};let _h=class{constructor(){this.time=Et.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(i,t,e,n,o,r,s,l,a,h,d,u,c){const{stroke:f=a.stroke,strokeArrayWidth:g=a.strokeArrayWidth,strokeArrayColor:p=a.strokeArrayColor}=i.attribute;f&&(Array.isArray(g)||Array.isArray(p))&&(c.doStroke=!1)}};_h=Hn([st()],_h);let wh=class{constructor(){this.time=Et.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(i,t,e,n,o,r,s,l,a,h,d,u){var c,f;const{stroke:g=a.stroke,strokeArrayColor:p=a.strokeArrayColor,strokeArrayWidth:v=a.strokeArrayWidth,lineWidth:m=a.lineWidth,strokeColor:b=a.stroke,cornerRadius:C=a.cornerRadius}=i.attribute;let _,w,{width:y=a.width,height:x=a.height}=i.attribute;if(g&&(Array.isArray(v)||m!==0)&&(Array.isArray(p)||Array.isArray(v))){if(typeof m=="number"&&1&m||Array.isArray(v)&&v.some(S=>1&S)){const S=i.stage.table;if(!S)return;const R=((c=S==null?void 0:S.theme)===null||c===void 0?void 0:c.cellBorderClipDirection)==="bottom-right";if(R){if(e=Math.floor(e)-.5,n=Math.floor(n)-.5,i.role==="cell"){const M=i.col,k=i.row;M===0&&(e+=1),k===0&&(n+=1)}}else e=Math.floor(e)+.5,n=Math.floor(n)+.5;!((f=S.options.customConfig)===null||f===void 0)&&f._disableColumnAndRowSizeRound&&(y=Math.round(y),x=Math.round(x));const{width:B,height:A}=ef(i,Math.ceil(y),Math.ceil(x),R);_=B,w=A}else _=Math.ceil(y),w=Math.ceil(x);C===0||Q(C)&&C.every(S=>S===0)?pw(i,t,e,n,a,g,v||m,p||b,_,w):(t.beginPath(),en(t,e,n,_,w,C,new Array(4).fill(0).map((S,R)=>(B,A,M,k)=>{mw(R,B,A,M,k,i,t,e,n,a,g,v||m,p||b,_,w)})),t.stroke())}}};wh=Hn([st()],wh);function fw(i){if(!Array.isArray(i))return{isSplitDraw:!1,width:i};let t;for(let e=0;e<i.length;e++){const n=i[e];if(n)if(t){if(n!==t)return{isSplitDraw:!0}}else t=n}return{isSplitDraw:!1,width:t}}function pw(i,t,e,n,o,r,s,l,a,h,d,u){var c,f,g,p;const v=fw(s),m=!Array.isArray(s),b=!Array.isArray(r),C=Array.isArray(u),_=Array.isArray(l)||v.isSplitDraw;t.setStrokeStyle(i,i.attribute,e,n,o);const{lineDash:w=o.lineDash}=i.attribute;let y=!1;w.length&&w.some(A=>Array.isArray(A))&&(y=!0),t.beginPath(),t.moveTo(e,n);const x=(b||r[0])&&(m||s[0]),S=(b||r[1])&&(m||s[1]),R=(b||r[2])&&(m||s[2]),B=(b||r[3])&&(m||s[3]);if(x){const A=(m?v.width:s[0])/2,M=(m?v.width:s[0])/2;C&&Array.isArray(u[0])?(t.moveTo(e-A+(a+A+M)*u[0][0],n),t.lineTo(e-A+(a+A+M)*(u[0][1]-u[0][0]),n),t.moveTo(e+a+M,n)):(t.moveTo(e-A,n),t.lineTo(e+a+M,n)),(_||y)&&(l&&l[0]?t.strokeStyle=l[0]:l&&!l[0]&&(t.strokeStyle="transparent"),m||(t.lineWidth=s[0]),t.lineDashOffset=t.currentMatrix.e/t.currentMatrix.a,y&&t.setLineDash((c=w[0])!==null&&c!==void 0?c:[]),t.stroke(),t.beginPath(),t.moveTo(e+a,n))}else t.moveTo(e+a,n);if(S){const A=(m?v.width:s[1])/2,M=(m?v.width:s[1])/2;C&&Array.isArray(u[1])?(t.moveTo(e+a,n-A+h*u[1][0]),t.lineTo(e+a,n-A+(h+A+M)*(u[1][1]-u[1][0])),t.moveTo(e+a,n+h+M)):(t.moveTo(e+a,n-A),t.lineTo(e+a,n+h+M)),(_||y)&&(l&&l[1]?t.strokeStyle=l[1]:l&&!l[1]&&(t.strokeStyle="transparent"),m||(t.lineWidth=s[1]),t.lineDashOffset=t.currentMatrix.f/t.currentMatrix.d,y&&t.setLineDash((f=w[1])!==null&&f!==void 0?f:[]),t.stroke(),t.beginPath(),t.moveTo(e+a,n+h))}else t.moveTo(e+a,n+h);if(R){const A=(m?v.width:s[2])/2,M=(m?v.width:s[2])/2;C&&Array.isArray(u[2])?(t.moveTo(e-A+(a+A+M)*u[2][0],n+h),t.lineTo(e-A+(a+A+M)*(u[2][1]-u[2][0]),n+h),t.moveTo(e-A,n+h)):(t.moveTo(e-A,n+h),t.lineTo(e+a+M,n+h)),(_||y)&&(l&&l[2]?t.strokeStyle=l[2]:l&&!l[2]&&(t.strokeStyle="transparent"),m||(t.lineWidth=s[2]),t.lineDashOffset=t.currentMatrix.e/t.currentMatrix.a,y&&t.setLineDash((g=w[2])!==null&&g!==void 0?g:[]),t.stroke(),t.beginPath(),t.moveTo(e,n+h))}else t.moveTo(e,n+h);if(B){const A=(m?v.width:s[3])/2,M=(m?v.width:s[3])/2;C&&Array.isArray(u[3])?(t.moveTo(e,n-A+(h+A+M)*u[3][0]),t.lineTo(e,n-A+(h+A+M)*(u[3][1]-u[3][0])),t.moveTo(e,n-A)):(t.moveTo(e,n-A),t.lineTo(e,n+h+M)),(_||y)&&(l&&l[3]?t.strokeStyle=l[3]:l&&!l[3]&&(t.strokeStyle="transparent"),m||(t.lineWidth=s[3]),t.lineDashOffset=t.currentMatrix.f/t.currentMatrix.d,y&&t.setLineDash((p=w[3])!==null&&p!==void 0?p:[]),t.stroke(),t.beginPath(),t.moveTo(e,n))}else t.moveTo(e,n);_||y||(!m&&v.width&&(t.lineWidth=v.width),t.stroke()),t.lineDashOffset=0,t.setLineDash([])}let yh=class{constructor(){this.time=Et.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(i,t,e,n,o,r,s,l,a,h,d,u,c){var f;const{lineDash:g=a.lineDash,stroke:p=a.stroke,strokeArrayColor:v=a.strokeArrayColor,strokeArrayWidth:m=a.strokeArrayWidth}=i.attribute;p&&Array.isArray(g)&&g.length&&(!((f=g[0])===null||f===void 0)&&f.length)&&!Array.isArray(v)&&!Array.isArray(m)&&(c.doStroke=!1)}};yh=Hn([st()],yh);let Sh=class{constructor(){this.time=Et.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(i,t,e,n,o,r,s,l,a,h,d,u){var c,f,g,p,v,m;const{lineDash:b=a.lineDash,stroke:C=a.stroke,strokeArrayColor:_=a.strokeArrayColor,strokeArrayWidth:w=a.strokeArrayWidth,lineWidth:y=a.lineWidth}=i.attribute;if(!C||!(Array.isArray(b)&&b.length&&(!((c=b[0])===null||c===void 0)&&c.length))||Array.isArray(_)||Array.isArray(w))return;const x=i.stage.table;if(!x)return;const S=Q(b[0])?$k(b):[b,b,b,b];let R,B,{width:A=a.width,height:M=a.height}=i.attribute;if(!((f=x.options.customConfig)===null||f===void 0)&&f._disableColumnAndRowSizeRound?(A=Math.round(A),M=Math.round(M)):(A=Math.ceil(A),M=Math.ceil(M)),1&y){const k=x.theme.cellBorderClipDirection==="bottom-right",E=0,T=0;k?(e=Math.floor(e)-.5,n=Math.floor(n)-.5,i.role==="cell"&&(i.col===0&&(e+=1),i.row===0&&(n+=1))):(e=Math.floor(e)+.5,n=Math.floor(n)+.5);const{width:P,height:H}=ef(i,Math.ceil(A+E),Math.ceil(M+T),k);R=P,B=H}else R=Math.ceil(A),B=Math.ceil(M);t.setStrokeStyle(i,i.attribute,e,n,a),t.beginPath(),t.moveTo(e,n),t.lineTo(e+R,n),t.lineDashOffset=t.currentMatrix.e/t.currentMatrix.a,t.setLineDash((g=S[0])!==null&&g!==void 0?g:[]),t.stroke(),t.beginPath(),t.moveTo(e+R,n),t.lineTo(e+R,n+B),t.lineDashOffset=t.currentMatrix.f/t.currentMatrix.d,t.setLineDash((p=S[1])!==null&&p!==void 0?p:[]),t.stroke(),t.beginPath(),t.moveTo(e,n+B),t.lineTo(e+R,n+B),t.lineDashOffset=t.currentMatrix.e/t.currentMatrix.a,t.setLineDash((v=S[2])!==null&&v!==void 0?v:[]),t.stroke(),t.beginPath(),t.moveTo(e,n),t.lineTo(e,n+B),t.lineDashOffset=t.currentMatrix.f/t.currentMatrix.d,t.setLineDash((m=S[3])!==null&&m!==void 0?m:[]),t.stroke(),t.lineDashOffset=0,t.setLineDash([])}};Sh=Hn([st()],Sh);let xh=class{constructor(){this.time=Et.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(i,t,e,n,o,r,s,l,a,h,d,u,c){const{lineWidth:f=a.lineWidth,stroke:g=a.stroke,lineDash:p=a.lineDash,strokeArrayWidth:v=a.strokeArrayWidth,strokeArrayColor:m=a.strokeArrayColor,notAdjustPos:b}=i.attribute;b!==!0&&g&&Array.isArray(p)&&!p.length&&!Array.isArray(m)&&!Array.isArray(v)&&1&f&&(c.doStroke=!1)}};xh=Hn([st()],xh);let Rh=class{constructor(){this.time=Et.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(i,t,e,n,o,r,s,l,a,h,d,u){var c,f;const{lineWidth:g=a.lineWidth,stroke:p=a.stroke,lineDash:v=a.lineDash,strokeArrayWidth:m=a.strokeArrayWidth,strokeArrayColor:b=a.strokeArrayColor,notAdjustPos:C,cornerRadius:_=a.cornerRadius}=i.attribute;let{width:w=a.width,height:y=a.height}=i.attribute;if(C!==!0&&p&&Array.isArray(v)&&!v.length&&!Array.isArray(b)&&!Array.isArray(m)&&1&g){const x=i.stage.table;if(!x)return;!((c=x.options.customConfig)===null||c===void 0)&&c._disableColumnAndRowSizeRound&&(w=Math.round(w),y=Math.round(y)),t.beginPath();const S=((f=x==null?void 0:x.theme)===null||f===void 0?void 0:f.cellBorderClipDirection)==="bottom-right",R=0,B=0;S?(e=Math.floor(e)-.5,n=Math.floor(n)-.5,i.role==="cell"&&(i.col===0&&(e+=1),i.row===0&&(n+=1))):(e=Math.floor(e)+.5,n=Math.floor(n)+.5);const{width:A,height:M}=ef(i,Math.ceil(w),Math.ceil(y),S);_?en(t,e,n,A+R,M+B,_):t.rect(e,n,A,M),t.setStrokeStyle(i,i.attribute,e,n,a),t.stroke()}}};Rh=Hn([st()],Rh);let Ah=class{constructor(){this.time=Et.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(i,t,e,n,o,r,s,l,a,h,d,u,c){if(i.role==="cell"){const f=i.stage.table;if(f){const g=Vk(i,f);if(g)i.attribute._vtableHightLightFill=g;else if(f.stateManager.interactionState!==vt.scrolling){const p=Nk(i,f);p&&(i.attribute._vtableHightLightFill=p)}}}}};Ah=Hn([st()],Ah);let Bh=class{constructor(){this.time=Et.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(i,t,e,n,o,r,s,l,a,h,d,u){if(i.attribute._vtableHightLightFill&&!d){if(s){const c=i.attribute.fill;i.attribute.fill=i.attribute._vtableHightLightFill,t.setCommonStyle(i,i.attribute,e,n,a),t.fill(),i.attribute.fill=c,i.attribute._vtableHightLightFill=void 0}}}};Bh=Hn([st()],Bh);let Mh=class{constructor(){this.time=Et.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(i,t,e,n,o,r,s,l,a,h,d,u,c){var f,g,p,v,m,b;const C=i.stage.table;C&&(i.role==="body"?gn(t,-((f=i.attribute.x)!==null&&f!==void 0?f:0)+C.getFrozenColsWidth(),-((g=i.attribute.y)!==null&&g!==void 0?g:0)+C.getFrozenRowsHeight(),i.parent.attribute.width-C.getFrozenColsWidth()-C.getRightFrozenColsWidth(),i.parent.attribute.height-C.getFrozenRowsHeight()-C.getBottomFrozenRowsHeight()):i.role==="row-header"?gn(t,0,-((p=i.attribute.y)!==null&&p!==void 0?p:0)+C.getFrozenRowsHeight(),C.getFrozenColsWidth(),i.parent.attribute.height-C.getFrozenRowsHeight()-C.getBottomFrozenRowsHeight()):i.role==="col-header"?gn(t,-((v=i.attribute.x)!==null&&v!==void 0?v:0)+C.getFrozenColsWidth(),0,i.parent.attribute.width-C.getFrozenColsWidth()-C.getRightFrozenColsWidth(),C.getFrozenRowsHeight()):i.role==="right-frozen"?gn(t,0,-((m=i.attribute.y)!==null&&m!==void 0?m:0)+C.getFrozenRowsHeight(),C.getRightFrozenColsWidth(),i.parent.attribute.height-C.getFrozenRowsHeight()-C.getBottomFrozenRowsHeight()):i.role==="bottom-frozen"?gn(t,-((b=i.attribute.x)!==null&&b!==void 0?b:0)+C.getFrozenColsWidth(),0,i.parent.attribute.width-C.getFrozenColsWidth()-C.getRightFrozenColsWidth(),C.getBottomFrozenRowsHeight()):i.role==="corner-header"?gn(t,0,0,C.getFrozenColsWidth(),C.getFrozenRowsHeight()):i.role==="corner-right-top-header"?gn(t,0,0,C.getRightFrozenColsWidth(),C.getFrozenRowsHeight()):i.role==="corner-right-bottom-header"?gn(t,0,0,C.getRightFrozenColsWidth(),C.getBottomFrozenRowsHeight()):i.role==="corner-left-bottom-header"&&gn(t,0,0,C.getFrozenColsWidth(),C.getBottomFrozenRowsHeight()))}};Mh=Hn([st()],Mh);const Xo=Math.pow(2,24);function gn(i,t,e,n,o){i.beginPath();const r=i.applyedMatrix;Math.abs(r.f)>Xo||Math.abs(r.g)>Xo?i.rect(t-Xo,e-Xo,n+2*Xo,o+2*Xo):i.rect(t,e,n,o)}function ef(i,t,e,n){const o=i.stage.table;if(!o)return{width:t,height:e};if(i.role==="cell"){let r=i.col,s=i.row;const l=ae(o,r,s);l&&(r=l.end.col,s=l.end.row),r!==o.colCount-1||n?(r===o.frozenColCount-1&&o.scrollLeft&&!n||r===0&&n)&&(t-=1):t-=1,s!==o.rowCount-1||n?(s===o.frozenRowCount-1&&o.scrollTop&&!n||s===0&&n)&&(e-=1):e-=1}else i.role==="corner-frozen"&&(o.scrollLeft&&!n&&(t-=1),o.scrollTop&&!n&&(e-=1));return{width:t,height:e}}function $k(i){return i.length===1?[i[0],i[0],i[0],i[0]]:i.length===2?[i[0],i[1],i[0],i[1]]:i}var vw=function(i,t,e,n){var o,r=arguments.length,s=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var l=i.length-1;l>=0;l--)(o=i[l])&&(s=(r<3?o(s):r>3?o(t,e,s):o(t,e))||s);return r>3&&s&&Object.defineProperty(t,e,s),s};let xs=class{constructor(){this.time=Et.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(i,t,e,n,o,r,s,l,a,h,d,u,c){const{stroke:f=a.stroke,strokeArrayWidth:g=a.strokeArrayWidth,strokeArrayColor:p=a.strokeArrayColor}=i.attribute;f&&(Array.isArray(f)||Array.isArray(g)||Array.isArray(p))&&(c.doStroke=!1)}};xs=vw([st()],xs);let Rs=class{constructor(){this.time=Et.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(i,t,e,n,o,r,s,l,a,h,d,u){const{width:c=a.width,height:f=a.height,stroke:g=a.stroke,strokeArrayColor:p=a.strokeArrayColor,strokeArrayWidth:v=a.strokeArrayWidth,lineWidth:m=a.lineWidth,strokeColor:b=a.stroke,cornerRadius:C=a.cornerRadius}=i.attribute;g&&(Array.isArray(v)||m!==0)&&(Array.isArray(g)||Array.isArray(p)||Array.isArray(v))&&(i.name!=="border-rect"&&i.name!=="table-border-rect"&&(typeof m=="number"&&1&m||Array.isArray(v)&&v.some(y=>1&y))&&(e=Math.floor(e)+.5,n=Math.floor(n)+.5),C===0||Q(C)&&C.every(y=>y===0)?pw(i,t,e,n,a,g,v||m,p||b,Math.ceil(c+0),Math.ceil(f+0)):(t.beginPath(),en(t,e,n,c,f,C,new Array(4).fill(0).map((y,x)=>(S,R,B,A)=>{mw(x,S,R,B,A,i,t,e,n,a,g,v||m,p||b,Math.ceil(c+0),Math.ceil(f+0))})),t.stroke()))}};Rs=vw([st()],Rs);function mw(i,t,e,n,o,r,s,l,a,h,d,u,c,f,g){var p,v,m,b;const C=r,_=h,w=fw(u),y=!Array.isArray(u),x=!Array.isArray(d),S=Array.isArray(c)||w.isSplitDraw;s.setStrokeStyle(r,r.attribute,l,a,h);const{lineDash:R=_.lineDash}=C.attribute;let B=!1;R.length&&R.some(T=>Array.isArray(T))&&(B=!0),s.moveTo(l,a);const A=(x||d[0])&&(y||u[0]),M=(x||d[1])&&(y||u[1]),k=(x||d[2])&&(y||u[2]),E=(x||d[3])&&(y||u[3]);A&&i===0?(y?w.width:u[0],y?w.width:u[0],s.moveTo(t,e),s.lineTo(n,o),(S||B)&&(c&&c[0]?s.strokeStyle=c[0]:c&&!c[0]&&(s.strokeStyle="transparent"),y||(s.lineWidth=u[0]),s.lineDashOffset=s.currentMatrix.e/s.currentMatrix.a,B&&s.setLineDash((p=R[0])!==null&&p!==void 0?p:[]),s.stroke(),s.beginPath())):i===0&&s.moveTo(l+f,a),M&&i===1?(y?w.width:u[1],y?w.width:u[1],s.moveTo(t,e),s.lineTo(n,o),(S||B)&&(c&&c[1]?s.strokeStyle=c[1]:c&&!c[1]&&(s.strokeStyle="transparent"),y||(s.lineWidth=u[1]),s.lineDashOffset=s.currentMatrix.f/s.currentMatrix.d,B&&s.setLineDash((v=R[1])!==null&&v!==void 0?v:[]),s.stroke(),s.beginPath(),s.moveTo(l+f,a+g))):i===1&&s.moveTo(l+f,a+g),k&&i===2?(y?w.width:u[2],y?w.width:u[2],s.moveTo(t,e),s.lineTo(n,o),(S||B)&&(c&&c[2]?s.strokeStyle=c[2]:c&&!c[2]&&(s.strokeStyle="transparent"),y||(s.lineWidth=u[2]),s.lineDashOffset=s.currentMatrix.e/s.currentMatrix.a,B&&s.setLineDash((m=R[2])!==null&&m!==void 0?m:[]),s.stroke(),s.beginPath(),s.moveTo(l,a+g))):i===2&&s.moveTo(l,a+g),E&&i===3?(y?w.width:u[3],y?w.width:u[3],s.moveTo(t,e),s.lineTo(n,o),(S||B)&&(c&&c[3]?s.strokeStyle=c[3]:c&&!c[3]&&(s.strokeStyle="transparent"),y||(s.lineWidth=u[3]),s.lineDashOffset=s.currentMatrix.f/s.currentMatrix.d,B&&s.setLineDash((b=R[3])!==null&&b!==void 0?b:[]),s.stroke(),s.beginPath(),s.moveTo(l,a))):i===3&&s.moveTo(l,a),S||B||(!y&&w.width&&(s.lineWidth=w.width),s.stroke()),s.lineDashOffset=0,s.setLineDash([]),s.closePath()}var Kk=function(i,t,e,n){var o,r=arguments.length,s=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var l=i.length-1;l>=0;l--)(o=i[l])&&(s=(r<3?o(s):r>3?o(t,e,s):o(t,e))||s);return r>3&&s&&Object.defineProperty(t,e,s),s};let es,Th=class{constructor(){this.order=1,this.interceptors=[new Yk]}afterDrawItem(i,t,e,n,o){for(let r=0;r<this.interceptors.length;r++)if(this.interceptors[r].afterDrawItem&&this.interceptors[r].afterDrawItem(i,t,e,n,o))return!0;return!1}beforeDrawItem(i,t,e,n,o){if((!i.in3dMode||e.in3dInterceptor)&&!i.shadowRoot&&!(i.baseGraphic||i.attribute.globalZIndex||i.interactiveGraphic))return!1;for(let r=0;r<this.interceptors.length;r++)if(this.interceptors[r].beforeDrawItem&&this.interceptors[r].beforeDrawItem(i,t,e,n,o))return!0;return!1}};Th=Kk([st()],Th);class Yk{constructor(){this.order=1}afterDrawItem(t,e,n,o,r){return t.type==="image"&&this.drawItem(t,e,n,o,r),!1}drawItem(t,e,n,o,r){const{image:s,gif:l}=t.attribute;if(l&&t.playing||!s||!t.resources)return!1;const a=t.resources.get(s);if(!a||a.state!=="loading")return!1;if(!es){const p=Ni(),v=p.loading_pic.svg,m=p.loading_pic.width,b=p.loading_pic.height;es=ad({width:m,height:b,image:v})}const{image:h}=es.attribute;if(!s||!es.resources)return!1;const d=es.resources.get(h);if(d.state!=="success")return!1;const{context:u}=n;u.highPerformanceSave(),t.parent&&u.setTransformFromMatrix(t.parent.globalTransMatrix,!0),t.glyphHost&&t.glyphHost.parent&&u.setTransformFromMatrix(t.glyphHost.parent.globalTransMatrix,!0);const c=t.AABBBounds,{width:f,height:g}=xd(d.data.width,d.data.height,c.width(),c.height());return u.drawImage(d.data,c.x1+(c.width()-f)/2,c.y1+(c.height()-g)/2,f,g),u.highPerformanceRestore(),!0}}var Xk=function(i,t,e,n){var o,r=arguments.length,s=r<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,e):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(i,t,e,n);else for(var l=i.length-1;l>=0;l--)(o=i[l])&&(s=(r<3?o(s):r>3?o(t,e,s):o(t,e))||s);return r>3&&s&&Object.defineProperty(t,e,s),s};let Ph=class{constructor(){this.time=Et.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(i,t,e,n,o,r,s,l,a,h,d,u,c){var f,g;const{text:p,underline:v=a.underline,lineThrough:m=a.lineThrough,direction:b=a.direction,whiteSpace:C=a.whiteSpace,fontSize:_=a.fontSize,verticalMode:w=a.verticalMode,ellipsis:y=a.ellipsis,textAlign:x=a.textAlign,textBaseline:S=a.textBaseline,x:R=a.x,y:B=a.y}=i.attribute;let A=!1;if(Array.isArray(i)){const T=(f=i.cache)===null||f===void 0?void 0:f.layoutData;y&&T&&T.lines.every(P=>P.str==="")&&(A=!0)}else{const{cache:T}=i;y&&T&&T.clipedText===""&&T.clipedWidth===0&&(A=!0)}if(!A)return;const M=jt(y)?y:"...",k=(g=il(i.attribute.lineHeight,_))!==null&&g!==void 0?g:_;let E=0;k!==_&&(S==="top"?E=(k-_)/2:S==="middle"||S==="bottom"&&(E=-(k-_)/2)),r&&(u?u(t,i.attribute,a):l&&(t.setStrokeStyle(i,i.attribute,R-e,B-n,a),t.strokeText(M,R,B+E))),o&&(d?d(t,i.attribute,a):s&&(t.setCommonStyle(i,i.attribute,R-e,B-n,a),t.fillText(M,R,B+E),this.drawUnderLine(v,m,i,R,B+E,0,a,t,M)))}drawUnderLine(i,t,e,n,o,r,s,l,a){if(t+i<=0)return;const{textAlign:h=s.textAlign,textBaseline:d=s.textBaseline,fontSize:u=s.fontSize,fontFamily:c=s.fontFamily,fontWeight:f=s.fontWeight,fontStyle:g=s.fontStyle,fill:p=s.fill,opacity:v=s.opacity,underlineOffset:m=s.underlineOffset,underlineDash:b=s.underlineDash,fillOpacity:C=s.fillOpacity}=e.attribute;if(!i&&!t)return;const _=aw.measureTextWidth(a,{fontSize:u,fontFamily:c,fontWeight:f,fontStyle:g}),w=Sr(h,_),y=Es(d,u,u),x={lineWidth:0,stroke:p,opacity:v,strokeOpacity:C};if(i){x.lineWidth=i,l.setStrokeStyle(e,x,n,o,s),l.setLineDash(b),l.beginPath();const S=o+y+u+m;l.moveTo(n+w,S,r),l.lineTo(n+w+_,S,r),l.stroke()}if(t){x.lineWidth=t,l.setStrokeStyle(e,x,n,o,s),l.beginPath();const S=o+y+u/2;l.moveTo(n+w,S,r),l.lineTo(n+w+_,S,r),l.stroke()}}};Ph=Xk([st()],Ph);const qk=new Ct((i,t,e,n)=>{e(xr)?n(xr).to(xs).inSingletonScope():(i(xs).toSelf().inSingletonScope(),i(So).toService(xs)),e(Rr)?n(Rr).to(Rs).inSingletonScope():(i(Rs).toSelf().inSingletonScope(),i(So).toService(Rs)),i(Ss).toSelf().inSingletonScope(),i(Wk).to(Ss),i($e).to(Ss),i(vh).toSelf().inSingletonScope(),i(yo).toService(vh),i(mh).toSelf().inSingletonScope(),i(yo).toService(mh),i(bh).toSelf().inSingletonScope(),i(yo).toService(bh),i(Ch).toSelf().inSingletonScope(),i(yo).toService(Ch),i(Ah).toSelf().inSingletonScope(),i(ki).toService(Ah),i(Bh).toSelf().inSingletonScope(),i(ki).toService(Bh),i(wh).toSelf().inSingletonScope(),i(ki).toService(wh),i(_h).toSelf().inSingletonScope(),i(ki).toService(_h),i(yh).toSelf().inSingletonScope(),i(ki).toService(yh),i(Sh).toSelf().inSingletonScope(),i(ki).toService(Sh),i(xh).toSelf().inSingletonScope(),i(ki).toService(xh),i(Rh).toSelf().inSingletonScope(),i(ki).toService(Rh),i(Mh).toSelf().inSingletonScope(),i(ki).toService(Mh),i(Th).toSelf().inSingletonScope(),i(Fs).toService(Th),i(Ph).toSelf().inSingletonScope(),i(va).toService(Ph)});function Ai(i,t,e,n){var o,r,s,l,a,h,d,u;i.internalProps.columnWidthConfig&&i._parseColumnWidthConfig(i.internalProps.columnWidthConfig),i.isPivotTable()&&i.internalProps.columnWidthConfigForRowHeader&&i._parseColumnWidthConfigForRowHeader(i.internalProps.columnWidthConfigForRowHeader),t=t??0,e=e??i.colCount-1,t===0&&e===i.colCount-1&&i._clearColRangeWidthsMap();const c=i.internalProps.layoutMap;i.isPivotTable()&&(c.enableUseGetBodyCache(),c.enableUseHeaderPathCache());const f=[],g=[];if(n)for(let p=0;p<i.colCount;p++)f[p]=i.getColWidth(p);for(let p=t;p<=e;p++){let v;if(i.internalProps.transpose||((r=(o=i.internalProps.layoutMap.columnObjects)===null||o===void 0?void 0:o[p])===null||r===void 0?void 0:r.columnWidthComputeMode)!=="only-header"&&i.columnWidthComputeMode!=="only-header"||!("showHeader"in i.internalProps.layoutMap))v=i.internalProps.transpose||((l=(s=i.internalProps.layoutMap.columnObjects)===null||s===void 0?void 0:s[p])===null||l===void 0?void 0:l.columnWidthComputeMode)!=="only-body"&&i.columnWidthComputeMode!=="only-body"?br(p,0,i.rowCount-1,i):br(p,i.internalProps.layoutMap.getBodyRange().start.row,i.internalProps.layoutMap.getBodyRange().end.row,i);else{const m=i.internalProps.layoutMap.showHeader;i.internalProps.layoutMap.showHeader=!0,v=br(p,0,i.internalProps.layoutMap.headerLevelCount-1,i),i.internalProps.layoutMap.showHeader=m}i._setColContentWidth(p,v),i.getColWidth(p)!==v&&i._clearColRangeWidthsMap(p),n?g[p]=Math.round(i._adjustColWidth(p,v)):i._setColWidth(p,i._adjustColWidth(p,v),!1,!0)}if(i.widthMode==="adaptive"){i._clearColRangeWidthsMap();const p=i.tableNoFrameWidth;let v=0,m=0,b=i.colCount;if(i.widthAdaptiveMode==="only-body"){for(let C=0;C<i.colCount;C++){const _=n&&(a=g[C])!==null&&a!==void 0?a:i.getColWidth(C);(C<i.rowHeaderLevelCount||i.isPivotChart()&&C>=i.colCount-i.rightFrozenColCount)&&(v+=_)}m=i.rowHeaderLevelCount,b=i.isPivotChart()?i.colCount-i.rightFrozenColCount:i.colCount}Hh(p-v,m,b,n,g,i)}else if(i.autoFillWidth){i._clearColRangeWidthsMap();const p=i.tableNoFrameWidth;let v=0,m=0;for(let b=0;b<i.colCount;b++){const C=n&&(h=g[b])!==null&&h!==void 0?h:i.getColWidth(b);(b<i.rowHeaderLevelCount+i.leftRowSeriesNumberCount||i.isPivotChart()&&b>=i.colCount-i.rightFrozenColCount)&&(v+=C),m+=C}m<p&&m>v&&Hh(p-v,i.rowHeaderLevelCount+i.leftRowSeriesNumberCount,i.isPivotChart()?i.colCount-i.rightFrozenColCount:i.colCount,n,g,i)}if(n){for(let p=0;p<i.colCount;p++){const v=(u=(d=g[p])!==null&&d!==void 0?d:i.getColWidth(p))!==null&&u!==void 0?u:i.getColWidth(p);v!==f[p]&&i._setColWidth(p,v,!1,!0)}i.stateManager.checkFrozen();for(let p=0;p<i.colCount;p++){const v=i.getColWidth(p);v!==f[p]&&i.scenegraph.updateColWidth(p,v-f[p],!0,!0)}i.scenegraph.updateContainer(!0)}i.isPivotTable()&&(c.disableUseGetBodyCache(),c.disableUseHeaderPathCache())}function br(i,t,e,n,o=!1){let r=tE(i,n);return n.internalProps.transpose&&r==="auto"&&(n.columnWidthComputeMode==="only-header"&&i>=n.rowHeaderLevelCount||n.columnWidthComputeMode==="only-body"&&i<n.rowHeaderLevelCount)&&(r=n.getDefaultColumnWidth(i)),o&&!n.internalProps.transpose?rm(r,i,t,e,o,n):typeof r=="number"?r:r!=="auto"&&typeof r=="string"?n._adjustColWidth(i,n._colWidthDefineToPxWidth(r)):rm(r,i,t,e,o,n)}function rm(i,t,e,n,o,r){var s,l,a,h,d;let u=0,c=1,f=1;if(n-e>5e3&&(f=Math.ceil((n-e)/5e3)),r.isPivotChart()&&t>=r.rowHeaderLevelCount&&t<r.colCount-r.rightFrozenColCount){if(r.internalProps.layoutMap.indicatorsAsCol)return r.defaultColWidth;{const v=r.internalProps.layoutMap.getOptimunWidthForChart(t);if(v>0)return v}}for(let v=e;v<=n;v+=c){if(r.isPivotChart()){const x=r.internalProps.layoutMap,S=x.getAxisConfigInPivotChart(t,v);if(S){const R=ut.getFunction("computeAxisComponentWidth")(S,r);if(typeof R=="number"){u=Math.max(R,u);continue}}else if(x.isLeftBottomCorner(t,v)||x.isRightTopCorner(t,v)||x.isRightBottomCorner(t,v))continue}const m=Zk(t,v,r);if(m&&(u=Math.max(m.width,u),!m.renderDefault))continue;const b=i;if(typeof b=="number"&&r.widthMode==="standard"&&!o){u=Math.max(b,u);continue}const C=r.isHeader(t,v)?(s=r._getHeaderLayoutMap(t,v))===null||s===void 0?void 0:s.headerType:r.getBodyColumnType(t,v);if(O(C)&&C!=="text"&&C!=="link"&&C!=="progressbar"&&C!=="checkbox"&&C!=="radio"&&C!=="switch"&&C!=="button"){u=Math.max(u,r.getColWidthDefinedNumber(t)||0);continue}let _=0;const w=r.internalProps.layoutMap;if(w.isHeader(t,v)){const x=w.getHeader(t,v);if(((l=x==null?void 0:x.define)===null||l===void 0?void 0:l.columnWidthComputeMode)==="only-body")continue;O(x==null?void 0:x.hierarchyLevel)&&(_=((a=x.hierarchyLevel)!==null&&a!==void 0?a:0)*(w.rowHierarchyType==="tree"&&(h=w.rowHierarchyIndent)!==null&&h!==void 0?h:0),w.rowHierarchyTextStartAlignment&&!r.internalProps.headerHelper.getHierarchyIcon(t,v)&&(_+=r.internalProps.headerHelper.getHierarchyIconWidth()))}else if(r.isListTable()){c=f;const x=r.getBodyColumnDefine(t,v);if(x!=null&&x.tree){const S=r.dataSource.getIndexKey(r.getRecordShowIndexByCell(t,v));_=Array.isArray(S)&&r.getHierarchyState(t,v)!==mt.none?(S.length-1)*((d=w.hierarchyIndent)!==null&&d!==void 0?d:0):0,w.hierarchyTextStartAlignment&&!r.internalProps.bodyHelper.getHierarchyIcon(t,v)&&(_+=r.internalProps.headerHelper.getHierarchyIconWidth())}}const y=Jk(t,v,C,r);u=Math.max(y+_,u),c>1&&r.bottomFrozenRowCount>0&&v<r.rowCount-r.bottomFrozenRowCount&&v+c>=r.rowCount-r.bottomFrozenRowCount&&(v=r.rowCount-r.bottomFrozenRowCount-c,c=1,f=1)}const g=r.getMinColWidth(t),p=r.getMaxColWidth(t);return u<g?g:u>p?p:(u<=0&&(u=r.defaultColWidth),u)}function Zk(i,t,e){var n,o,r,s,l,a,h;const d=e.getCustomRender(i,t);let u=e.getCustomLayout(i,t);if(d||u){let c,f=1,g=0,p=!1,v=!1;(e.isHeader(i,t)||!((n=e.getBodyColumnDefine(i,t))===null||n===void 0)&&n.mergeCell||e.hasCustomMerge())&&(c=e.getCellRange(i,t),f=c.end.col-c.start.col+1);const m={col:(o=c==null?void 0:c.start.col)!==null&&o!==void 0?o:i,row:(r=c==null?void 0:c.start.row)!==null&&r!==void 0?r:t,dataValue:e.getCellOriginValue(i,t),value:e.getCellValue(i,t)||"",rect:Qk(i,t,e),table:e,originCol:i,originRow:t};if(u==="react-custom-layout"&&(u=((s=e.reactCustomLayout)===null||s===void 0?void 0:s.getCustomLayoutFunc(i,t))||Ks),Mt(u)){const b=u(m);if(b.rootContainer){b.rootContainer=Ys(b.rootContainer),Sd(b.rootContainer,0,e.getRowHeight(t));const C=b.rootContainer.attribute.width;b.rootContainer.setStage(e.scenegraph.stage),g=C>0?C:(l=b.rootContainer.AABBBounds.width())!==null&&l!==void 0?l:0,p=b.renderDefault,v=b.enableCellPadding}else g=0,p=b.renderDefault,v=b.enableCellPadding}else if(typeof d=="function"){const b=d(m);g=(a=b==null?void 0:b.expectedWidth)!==null&&a!==void 0?a:0,p=b==null?void 0:b.renderDefault}else g=(h=d==null?void 0:d.expectedWidth)!==null&&h!==void 0?h:0,p=d==null?void 0:d.renderDefault;if(g=Math.ceil(g),v){const b=e._getCellStyle(i,t),C=xt(q("padding",b,i,t,e));g+=C[1]+C[3]}return{width:g/f,renderDefault:p}}}function Jk(i,t,e,n){var o,r,s,l;let a=0;const h=n.getCellValue(i,t),d=n._getCellStyle(i,t);let u=0,c=!1;if(n.getCellLocation(i,t)!=="body")c=!0;else{const w=n.getBodyColumnDefine(i,t);c=!!(w!=null&&w.icon)||!!(w!=null&&w.tree)||(w==null?void 0:w.dragOrder)}if(c){const w=n.getCellIcons(i,t);w==null||w.forEach(y=>{var x,S,R;y.positionType!==It.absoluteRight&&(u+=((x=y.width)!==null&&x!==void 0?x:0)+((S=y.marginLeft)!==null&&S!==void 0?S:0)+((R=y.marginRight)!==null&&R!==void 0?R:0))})}let f=1;if(n.isHeader(i,t)||!((o=n.getBodyColumnDefine(i,t))===null||o===void 0)&&o.mergeCell||n.hasCustomMerge()){const w=n.getCellRange(i,t);f=w.end.col-w.start.col+1}const g=xt(q("padding",d,i,t,n)),p=g[1]+g[3],v=q("fontSize",d,i,t,n),m=q("fontFamily",d,i,t,n),b=q("fontWeight",d,i,t,n);let C;if(e==="checkbox")C=kt(h)?h.text:h;else if(e==="radio")if(Q(h)){C="";const w=n.getBodyColumnDefine(i,t),y=(r=w==null?void 0:w.radioDirectionInCell)!==null&&r!==void 0?r:"vertical";y==="vertical"?h.forEach(x=>{C+=(kt(x)?x.text:x).toString()+`
`}):y==="horizontal"&&h.forEach(x=>{C+=(kt(x)?x.text:x).toString()})}else C=kt(h)?h.text:h;else if(e==="button"){const w=n.getBodyColumnDefine(i,t),y=zt(w.text,{col:i,row:t,table:n,context:null,value:h,dataValue:n.getCellOriginValue(i,t)});C=(s=y??h)!==null&&s!==void 0?s:""}else C=h;const _=Xs(C,n).text;if(_.length>=1&&(_.length!==1||_[0]!=="")?_.forEach(w=>{const y=n.measureText(w,{fontSize:v,fontFamily:m,fontWeight:b}).width;a=Math.max((y+p+4+u)/f,a)}):a=Math.max((p+4+u)/f,a),n.internalProps.limitMaxAutoWidth!==!1&&(a=Math.min(typeof n.internalProps.limitMaxAutoWidth=="number"?n.internalProps.limitMaxAutoWidth:450,a)),e==="checkbox"){const w=q("size",d,i,t,n);if(a+=w,C){const y=q("spaceBetweenTextAndIcon",d,i,t,n);a+=y}}else if(e==="radio"){const w=q("size",d,i,t,n),y=q("outerRadius",d,i,t,n),x=Z(y)?2*y:w,S=q("spaceBetweenTextAndIcon",d,i,t,n);if(Q(h)){const R=n.getBodyColumnDefine(i,t),B=q("spaceBetweenRadio",d,i,t,n),A=(l=R==null?void 0:R.radioDirectionInCell)!==null&&l!==void 0?l:"vertical";A==="vertical"?(a+=x,a+=S):A==="horizontal"&&(a+=(x+S)*h.length,a+=B*(h.length-1))}else a+=x,C&&(a+=S)}else if(e==="switch")a=q("boxWidth",d,i,t,n);else if(e==="button"){const w=q("buttonPadding",d,i,t,n);a+=2*w}return a}function Qk(i,t,e){return{left:0,top:0,right:e.getColWidth(i),bottom:e.getRowHeight(t),width:null,height:null}}function tE(i,t){const e=t.getColWidthDefined(i);return t.internalProps._widthResizedColMap.has(i)?t.getColWidth(i):e}function Hh(i,t,e,n,o,r,s){var l,a,h,d;let u=0;const c=[],f=[];let g=0;for(let v=t;v<e;v++){const m=n&&(l=o[v])!==null&&l!==void 0?l:r.getColWidth(v),b=r.getMaxColWidth(v),C=r.getMinColWidth(v);m!==b&&m!==C?(u+=m,c.push(v)):i-=m,!((a=r.options.customConfig)===null||a===void 0)&&a.shrinkSparklineFirst&&r.getBodyColumnType(v,0)==="sparkline"&&(f.push({col:v,width:m}),g+=m-r.defaultColWidth)}const p=i/u;if(!((h=r.options.customConfig)===null||h===void 0)&&h.shrinkSparklineFirst&&p<1&&u-i<g)for(let v=0;v<f.length;v++){const{col:m,width:b}=f[v],C=(u-i)/f.length,_=Math.floor(b-C);n?o[m]=r._adjustColWidth(m,_):s?r.scenegraph.setColWidth(m,r._adjustColWidth(m,_)):r._setColWidth(m,r._adjustColWidth(m,_),!1,!0)}else for(let v=0;v<c.length;v++){const m=c[v];let b;b=v===c.length-1?i-c.reduce((C,_,w)=>{var y;return _!==m?C+(n?(y=o[_])!==null&&y!==void 0?y:r.getColWidth(m):r.getColWidth(_)):C},0):Math.round((n&&(d=o[m])!==null&&d!==void 0?d:r.getColWidth(m))*p),n?o[m]=r._adjustColWidth(m,b):s?r.scenegraph.setColWidth(m,r._adjustColWidth(m,b)):r._setColWidth(m,r._adjustColWidth(m,b),!1,!0)}}const kh=new Tt({});kh.role="empty";function ia(i,t,e,n,o,r,s,l,a){var h,d;let u,c,f,g=0;i.lastChild&&i.lastChild.row===n-1?g=i.lastChild.attribute.y+i.lastChild.attribute.height:i.colHeight&&(g=i.colHeight);for(let p=n;p<=o;p++){const v=p;let m,b,C,_,w=l.getCellLocation(t,v),y=l.getCellValue(t,v),x=e,S=l.getRowHeight(v),R=!1;if(l.internalProps.customMergeCell){const P=l.getCustomMerge(t,v);if(P){const{range:H,text:L,style:F,customLayout:z,customRender:I}=P;if(m=H,b=m.start.col!==m.end.col||m.start.row!==m.end.row,b){const N=sm(m,r,l,n>m.start.row);x=N.cellWidth,S=N.cellHeight}y=L,C=F,(z||I)&&(_=to(z,I,H.start.col,H.start.row,l.getColsWidth(H.start.col,H.end.col),l.getRowsHeight(H.start.row,H.end.row),!1,l.isAutoRowHeight(v),[0,0,0,0],m,l)),R=!0}}let B,A=t,M=v;m&&(A=m.start.col,M=m.start.row),!l.isPivotTable()&&(w==="columnHeader"||w==="cornerHeader")&&v>=l.columnHeaderLevelCount&&(w="body"),B=!l.isPivotTable()&&l.isSeriesNumberInBody(t,v)?l.getBodyColumnDefine(A,M):w!=="body"?l.getHeaderDefine(A,M):l.getBodyColumnDefine(A,M);let k=w!=="body"||(B==null?void 0:B.dragOrder)||!!(B!=null&&B.icon)||!!(B!=null&&B.tree);if(!m&&(l.internalProps.enableTreeNodeMerge||w!=="body"||B!=null&&B.mergeCell)&&(m=l.getCellRange(t,v),b=m.start.col!==m.end.col||m.start.row!==m.end.row,b)){const P=sm(m,r,l,n>m.start.row);x=P.cellWidth,S=P.cellHeight}let E=!1;if(l.internalProps.enableTreeNodeMerge&&b){const P=l.getCellRawRecord(m.start.col,m.start.row),{vtableMergeName:H,vtableMerge:L}=P??{};E=L,L&&(k=!0,l.options.groupTitleCustomLayout&&(_=to(l.options.groupTitleCustomLayout,void 0,m.start.col,m.start.row,l.getColsWidth(m.start.col,m.end.col),l.getRowsHeight(m.start.row,m.end.row),!1,l.isAutoRowHeight(v),[0,0,0,0],m,l)),l.options.groupTitleFieldFormat?y=l.options.groupTitleFieldFormat(P,t,v,l):H&&(y=H))}const T=E||R?"text":(d=l.isHeader(t,v)?(h=l._getHeaderLayoutMap(t,v).headerType)!==null&&h!==void 0?h:"text":l.getBodyColumnType(t,v))!==null&&d!==void 0?d:"text";if(ji(y)){iE(t,v,0,g,x,S,i),rw(y,l,eE.bind(null,{type:T,value:y,define:B,table:l,col:t,row:v,colWidth:e,cellWidth:x,cellHeight:S,columnGroup:i,y:g,customStyle:C,mayHaveIcon:k,cellLocation:w,range:m,customResult:_,defaultRowHeight:s})),i.updateColumnRowNumber(v);const P=l.getRowHeight(v);i.updateColumnHeight(P),g+=P}else{const P=C||l._getCellStyle(m?m.start.col:t,m?m.start.row:v),H=no(P,l,m?m.start.col:t,m?m.start.row:v,q).theme;H.group.cornerRadius=yd(t,v,l),H.group.width=e,H.group.height=Array.isArray(s)?s[v]:s,H._vtable.padding&&(u=H._vtable.padding),H.text.textAlign&&(c=H.text.textAlign),H.text.textBaseline&&(f=H.text.textBaseline),w==="body"||H.group.fill||(H.group.fill="#fff");const L=Qg(T,y,B,l,t,v,e,x,S,i,g,u,c,f,k,H,m,_);if(i.updateColumnRowNumber(v),b){const F=l.getRowHeight(v),{width:z}=(l.getColWidth(t),L.attribute),{height:I}=L.attribute;L.contentWidth=z,L.contentHeight=I,lw(m,z,I,u,c,f,l),i.updateColumnHeight(F),g+=F}else i.updateColumnHeight(S),g+=S}}return i.setAttribute("width",e),{width:e,height:g}}function eE(i){let t,e,n;const{type:o,value:r,define:s,table:l,col:a,row:h,colWidth:d,cellWidth:u,cellHeight:c,columnGroup:f,y:g,cellLocation:p,mayHaveIcon:v,customStyle:m,range:b,customResult:C,defaultRowHeight:_}=i,w=m||l._getCellStyle(b?b.start.col:a,b?b.start.row:h),y=no(w,l,b?b.start.col:a,b?b.start.row:h,q).theme;y.group.cornerRadius=yd(a,h,l),y.group.width=d,y.group.height=Array.isArray(_)?_[h]:_,y._vtable.padding&&(t=y._vtable.padding),y.text.textAlign&&(e=y.text.textAlign),y.text.textBaseline&&(n=y.text.textBaseline),p==="body"||y.group.fill||(y.group.fill="#fff"),Qg(o,r,s,l,a,h,d,u,c,f,g,t,e,n,v,y,b,C)}function sm(i,t,e,n){let o=0,r=0;const s=t.get(`${i.start.col},${i.start.row};${i.end.col},${i.end.row}`);if(!s||n){for(let l=i.start.col;l<=i.end.col;l++)o+=e.getColWidth(l);for(let l=i.start.row;l<=i.end.row;l++)r+=e.getRowHeight(l);t.set(`${i.start.col},${i.start.row};${i.end.col},${i.end.row}`,{cellWidth:o,cellHeight:r})}else o=s.cellWidth,r=s.cellHeight;return{cellWidth:o,cellHeight:r}}function iE(i,t,e,n,o,r,s){const l=new Tt({x:e,y:n,width:o,height:r});l.role="cell",l.col=i,l.row=t,s.addChild(l)}function be(i,t,e,n,o,r,s,l,a,h){if(n>o||r>s)return;const{layoutMap:d,defaultHeaderRowHeight:u,defaultColWidth:c}=a.internalProps,f=a.defaultRowHeight;let g=0,p=0;for(let v=n;v<=o;v++){const m=v,b=a.getColWidth(m),C=new Tt({x:t+g,y:e,width:b,height:0,clip:!1,pickable:!1});C.role="column",C.col=v,i.addChild(C);const{width:_,height:w}=ia(C,m,b,r,s,a.scenegraph.mergeMap,l==="columnHeader"&&Z(u)?u:f,a);g+=_,p=Math.max(p,w)}i.setAttribute("width",g),i.setAttribute("height",p)}function nE(i,t,e,n,o,r,s,l,a){var h,d,u,c,f,g,p,v,m,b,C,_;const{table:w}=a,{leftBottomCornerGroup:y,rightTopCornerGroup:x,rightBottomCornerGroup:S}=w.scenegraph;let R,B,A,M;a.setParamsForRow(),a.setParamsForColumn(),(w.widthMode==="adaptive"||w.options.autoWrapText&&(w.heightMode==="adaptive"||w.isAutoRowHeight()))&&(A=w.colCount-1),R=Math.min(a.firstScreenColLimit-1,w.colCount-1),w.heightMode==="adaptive"&&(M=w.rowCount-1),B=Math.min(a.firstScreenRowLimit-1,w.rowCount-1),w.internalProps._widthResizedColMap.size===0&&Ai(w,0,A??R),w.internalProps._heightResizedRowMap.size===0&&Ri(w,0,w.options.canvasHeight==="auto"?w.rowCount-1:M??B),R<w.colCount-w.rightFrozenColCount&&Ai(w,w.colCount-w.rightFrozenColCount,w.colCount-1),B<w.rowCount-w.bottomFrozenRowCount&&Ri(w,w.rowCount-w.bottomFrozenRowCount,w.rowCount-1),w.scenegraph.colHeaderGroup.setAttribute("x",w.getFrozenColsWidth()),w.scenegraph.rowHeaderGroup.setAttribute("y",w.getFrozenRowsHeight()),w.scenegraph.bottomFrozenGroup.setAttribute("x",w.getFrozenColsWidth()),w.scenegraph.rightFrozenGroup.setAttribute("y",w.getFrozenRowsHeight()),w.scenegraph.bodyGroup.setAttributes({x:w.getFrozenColsWidth(),y:w.getFrozenRowsHeight()}),be(i,s,l,0,w.frozenColCount-1,0,w.frozenRowCount-1,w.isListTable()?"columnHeader":"cornerHeader",w),R-w.rightFrozenColCount>=w.frozenColCount&&be(t,s,l,w.frozenColCount,R-w.rightFrozenColCount,0,w.frozenRowCount-1,"columnHeader",w),w.frozenColCount>0&&(w.leftRowSeriesNumberCount>0&&be(e,s,l,0,w.leftRowSeriesNumberCount-1,w.frozenRowCount,B-w.bottomFrozenRowCount,"rowHeader",w),w.frozenColCount>w.leftRowSeriesNumberCount&&be(e,s,l,w.leftRowSeriesNumberCount,Math.min(w.frozenColCount-1,w.rowHeaderLevelCount+w.leftRowSeriesNumberCount-1),w.frozenRowCount,B-w.bottomFrozenRowCount,"rowHeader",w),w.frozenColCount>w.rowHeaderLevelCount+w.leftRowSeriesNumberCount&&be(e,s,l,w.rowHeaderLevelCount+w.leftRowSeriesNumberCount,w.frozenColCount-1,w.frozenRowCount,B-w.bottomFrozenRowCount,"body",w)),w.bottomFrozenRowCount>0&&(w.frozenColCount>0&&(w.leftRowSeriesNumberCount>0&&be(y,s,l,0,w.leftRowSeriesNumberCount-1,w.rowCount-1-w.bottomFrozenRowCount+1,w.rowCount-1,"rowHeader",w),w.rowHeaderLevelCount>0&&be(y,s,l,w.leftRowSeriesNumberCount,w.leftRowSeriesNumberCount+w.rowHeaderLevelCount-1,w.rowCount-1-w.bottomFrozenRowCount+1,w.rowCount-1,"rowHeader",w),w.frozenColCount>w.rowHeaderLevelCount+w.leftRowSeriesNumberCount&&be(y,s,l,w.rowHeaderLevelCount+w.leftRowSeriesNumberCount,w.frozenColCount-1,w.rowCount-1-w.bottomFrozenRowCount+1,w.rowCount-1,"body",w)),R-w.rightFrozenColCount>=w.frozenColCount&&be(o,s,l,w.frozenColCount,R-w.rightFrozenColCount,w.rowCount-1-w.bottomFrozenRowCount+1,w.rowCount-1,w.isPivotChart()?"rowHeader":"body",w)),w.rightFrozenColCount>0&&(be(x,s,l,w.colCount-1-w.rightFrozenColCount+1,w.colCount-1,0,w.frozenRowCount-1,"columnHeader",w),be(n,s,l,w.colCount-1-w.rightFrozenColCount+1,w.colCount-1,w.frozenRowCount,B-w.bottomFrozenRowCount,w.isPivotChart()?"rowHeader":"body",w)),w.bottomFrozenRowCount>0&&w.rightFrozenColCount>0&&be(S,s,l,w.colCount-1-w.rightFrozenColCount+1,w.colCount-1,w.rowCount-1-w.bottomFrozenRowCount+1,w.rowCount-1,"body",w),R-w.rightFrozenColCount>=w.frozenColCount&&be(r,s,l,w.frozenColCount,R-w.rightFrozenColCount,w.frozenRowCount,B-w.bottomFrozenRowCount,"body",w),r.firstChild||t.firstChild||i.firstChild||e.firstChild?(a.currentRow=(c=(d=(h=r.firstChild)===null||h===void 0?void 0:h.rowNumber)!==null&&d!==void 0?d:(u=e.firstChild)===null||u===void 0?void 0:u.rowNumber)!==null&&c!==void 0?c:a.totalRow,a.rowEnd=a.currentRow,a.rowUpdatePos=a.rowEnd+1,a.referenceRow=a.rowStart+Math.floor((a.rowEnd-a.rowStart)/2),a.currentCol=(_=(b=(v=(g=(f=r.lastChild)===null||f===void 0?void 0:f.col)!==null&&g!==void 0?g:(p=t.lastChild)===null||p===void 0?void 0:p.col)!==null&&v!==void 0?v:(m=e.lastChild)===null||m===void 0?void 0:m.col)!==null&&b!==void 0?b:(C=i.lastChild)===null||C===void 0?void 0:C.col)!==null&&_!==void 0?_:a.totalCol,a.colEnd=a.currentCol,a.colUpdatePos=a.colEnd+1,a.referenceCol=a.colStart+Math.floor((a.colEnd-a.colStart)/2),a.progress()):(a.currentRow=a.totalRow,a.rowEnd=a.currentRow,a.rowUpdatePos=a.rowEnd+1,a.referenceRow=a.rowStart+Math.floor((a.rowEnd-a.rowStart)/2),a.currentCol=a.totalCol,a.colEnd=a.currentCol,a.colUpdatePos=a.colEnd+1,a.referenceCol=a.colStart+Math.floor((a.colEnd-a.colStart)/2))}function lm(i){let t=i.firstChild;for(;t&&t.type!=="group";)t=t._next;return t}function Zs(i){let t=i.lastChild;for(;t&&t.type!=="group";)t=t._prev;return t}function oE(i){let t=i._prev;for(;t&&t.type!=="group";)t=t._prev;return t}function rE(i){let t=i._next;for(;t&&t.type!=="group";)t=t._next;return t}function rg(i,t,e,n="left"){for(let l=i;l<=t;l++){const a=e.scenegraph.getColGroup(l);a&&eu(a,e,n);const h=e.scenegraph.getColGroup(l,!0);h&&eu(h,e,n);const d=e.scenegraph.getColGroupInBottom(l);d&&eu(d,e,n)}const o=Math.min(e.scenegraph.proxy.colLimit,e.scenegraph.proxy.bodyRightCol-e.scenegraph.proxy.bodyLeftCol+1),r=e.getColsWidth(e.frozenColCount,e.frozenColCount+o),s=e.getColsWidth(e.frozenColCount,e.colCount-1);e.scenegraph.proxy.xLimitLeft=r/2,e.scenegraph.proxy.xLimitRight=s-r/2}function eu(i,t,e="left"){if(e==="left"){let n;const o=oE(i);n=o?o.attribute.x+t.getColWidth(i._prev.col):t.getColsWidth(t.frozenColCount,i.col-1),i.setAttribute("x",n)}else{let n;const o=rE(i);n=o?o.attribute.x-t.getColWidth(i.col):t.getColsWidth(t.frozenColCount,i.col-1),i.setAttribute("x",n)}}var bw=function(i,t,e,n){return new(e||(e=Promise))(function(o,r){function s(h){try{a(n.next(h))}catch(d){r(d)}}function l(h){try{a(n.throw(h))}catch(d){r(d)}}function a(h){var d;h.done?o(h.value):(d=h.value,d instanceof e?d:new e(function(u){u(d)})).then(s,l)}a((n=n.apply(i,t||[])).next())})};function sE(i,t,e,n){return bw(this,void 0,void 0,function*(){if(!t)return;const o=t.col,r=t.left;let s;if(s=e?n.bodyRightCol-n.colEnd:n.screenLeftCol-n.referenceCol,lE(s,o,r,i,n),e){const l=n.table.scenegraph.getColGroup(n.colEnd);if(l){const a=l.attribute.x+l.attribute.width-(n.table.tableNoFrameWidth-n.table.getFrozenColsWidth()-n.table.getRightFrozenColsWidth())-i;n.deltaX=-a,n.table.scenegraph.setBodyAndColHeaderX(-i+n.deltaX)}}n.table.scenegraph.updateNextFrame()})}function lE(i,t,e,n,o){i>0?(am(i,"left",o.screenLeftCol,e,n,o),o.updateDeltaX(n,e,t),o.table.scenegraph.setBodyAndColHeaderX(-n+o.deltaX)):i<0?(am(-i,"right",o.screenLeftCol,e,n,o),o.updateDeltaX(n,e,t),o.table.scenegraph.setBodyAndColHeaderX(-n+o.deltaX)):(o.updateDeltaX(n,e,t),o.table.scenegraph.setBodyAndColHeaderX(-n+o.deltaX))}function am(i,t,e,n,o,r){return bw(this,void 0,void 0,function*(){if(t==="left"&&r.colEnd+i>r.bodyRightCol?i=r.bodyRightCol-r.colEnd:t==="right"&&r.colStart-i<r.bodyLeftCol&&(i=r.colStart-r.bodyLeftCol),i!==0)if(i<0&&(t=t==="left"?"right":"left",i=-i),i<r.colEnd-r.colStart){const s=t==="left"?r.colStart:r.colEnd-i+1,l=t==="left"?r.colStart+i-1:r.colEnd,a=t==="left"?r.colEnd+1:r.colStart-i,h=t==="left"?r.colEnd+i:r.colStart-1;Ai(r.table,a,h),hE(s,l,t,r);const d=a,u=h;r.colStart=t==="left"?r.colStart+i:r.colStart-i,r.colEnd=t==="left"?r.colEnd+i:r.colEnd-i,Js(d,u,r),rg(d,u,r.table,t);const c=r.table.scenegraph.getColGroup(e)||r.table.scenegraph.getColGroup(e,!0),f=n-(c.attribute.x+r.table.getFrozenColsWidth()+r.table.scenegraph.proxy.deltaX);r.table.scenegraph.proxy.deltaX+=f,r.currentCol=t==="left"?r.currentCol+i:r.currentCol-i,r.totalCol=Math.max(0,Math.min(r.table.colCount-1,t==="left"?r.totalCol+i:r.totalCol-i)),r.referenceCol=r.colStart+Math.floor((r.colEnd-r.colStart)/2),r.colUpdatePos=a,r.colUpdateDirection=t,r.table.scenegraph.updateNextFrame()}else{const s=t==="left"?r.colStart+i:r.colStart-i,l=t==="left"?r.colEnd+i:r.colEnd-i;Ai(r.table,s,l),dE(r.table.getColsWidth(r.bodyLeftCol,s-1),i,t,r);const a=s,h=l;r.colStart=s,r.colEnd=l,Js(a,h,r),rg(a,h,r.table,l>r.bodyRightCol-(r.colEnd-r.colStart+1)?"right":"left"),r.currentCol=t==="left"?r.currentCol+i:r.currentCol-i,r.totalCol=Math.max(0,Math.min(r.table.colCount-1,t==="left"?r.totalCol+i:r.totalCol-i)),r.referenceCol=r.colStart+Math.floor((r.colEnd-r.colStart)/2),r.colUpdatePos=r.colStart,r.colUpdateDirection=l>r.bodyRightCol-(r.colEnd-r.colStart+1)?"right":"left",r.table.scenegraph.updateNextFrame()}})}function As(i,t,e){i.col=t,i.forEachChildren(n=>{n.col=t,n.needUpdate=!0}),i.setAttribute("x",e),i.needUpdate=!0}function Ul(i,t){if(!i)return;let e=i.firstChild;for(;e;)e=t.updateCellGroupContent(e)._next;i.needUpdate=!1,i.setAttribute("width",t.table.getColWidth(i.col))}function aE(i,t){if(!i)return;const e=t.screenTopRow,n=Math.max(t.bodyTopRow,e-1*t.screenRowCount),o=Math.min(t.bodyBottomRow,e+2*t.screenRowCount,t.table.rowCount-1);for(let r=n;r<=o;r++){const s=t.highPerformanceGetCell(i.col,r,!0);t.updateCellGroupContent(s)}t.rowUpdatePos=t.rowStart,i.needUpdate=!1,i.setAttribute("width",t.table.getColWidth(i.col))}function hE(i,t,e,n){for(let o=i;o<=t;o++)n.table.scenegraph.bodyGroup.childrenCount>0&&n.table.scenegraph.bodyGroup.firstChild.type==="group"&&iu(n.table.scenegraph.bodyGroup,e,n),n.table.scenegraph.colHeaderGroup.childrenCount>0&&n.table.scenegraph.colHeaderGroup.firstChild.type==="group"&&iu(n.table.scenegraph.colHeaderGroup,e,n),n.table.scenegraph.bottomFrozenGroup.childrenCount>0&&n.table.scenegraph.bottomFrozenGroup.firstChild.type==="group"&&iu(n.table.scenegraph.bottomFrozenGroup,e,n)}function iu(i,t,e){if(t==="left"){const n=lm(i),o=Zs(i);As(n,o.col+1,o.attribute.x+e.table.getColWidth(o.col)),i.appendChild(n),i.border&&i.appendChild(i.border)}else{const n=Zs(i),o=lm(i);As(n,o.col-1,o.attribute.x-e.table.getColWidth(o.col-1)),i.insertBefore(n,i.firstChild)}}function Js(i,t,e){for(let n=i;n<=t;n++){const o=e.table.scenegraph.getColGroup(n,!0);o&&Ul(o,e);const r=e.table.scenegraph.getColGroupInBottom(n);r&&Ul(r,e);const s=e.table.scenegraph.getColGroupInRightTopCorner(n);s&&Ul(s,e);const l=e.table.scenegraph.getColGroupInRightBottomCorner(n);l&&Ul(l,e);const a=e.table.scenegraph.getColGroup(n);a&&aE(a,e)}nu(e.table.scenegraph.colHeaderGroup),nu(e.table.scenegraph.bottomFrozenGroup),nu(e.table.scenegraph.bodyGroup),e.progress()}function dE(i,t,e,n){n.table.scenegraph.colHeaderGroup.forEachChildren((o,r)=>{o.type==="group"&&As(o,e==="left"?o.col+t:o.col-t,r===0?i:o._prev.attribute.x+n.table.getColWidth(o._prev.col))}),n.table.scenegraph.bottomFrozenGroup.forEachChildren((o,r)=>{o.type==="group"&&As(o,e==="left"?o.col+t:o.col-t,r===0?i:o._prev.attribute.x+n.table.getColWidth(o._prev.col))}),n.table.scenegraph.bodyGroup.forEachChildren((o,r)=>{o.type==="group"&&As(o,e==="left"?o.col+t:o.col-t,r===0?i:o._prev.attribute.x+n.table.getColWidth(o._prev.col))})}function nu(i){var t,e;const n=Zs(i);if(n&&(i.setAttribute("width",n.attribute.x+n.attribute.width),i.border)){const o=i.border;o.setAttribute("width",n.attribute.x+n.attribute.width-((t=o.attribute.borderLeft)!==null&&t!==void 0?t:0)/2-((e=o.attribute.borderRight)!==null&&e!==void 0?e:0)/2)}}function li(i,t,e,n,o,r="up",s){var l,a;if(r==="up")for(let c=i;c<=t;c++)for(let f=e;f<=n;f++){const g=o.scenegraph.highPerformanceGetCell(c,f,!0);if(g.role!=="cell"||!g.row)continue;let p;if(g._prev)p=((l=g._prev)===null||l===void 0?void 0:l.attribute.y)+o.getRowHeight(g._prev.row);else if(s){const v=n===o.rowCount-o.bottomFrozenRowCount-1?n:n+1;if(p=o.scenegraph.highPerformanceGetCell(c,v,!0).attribute.y,O(p))for(let m=f;m<v;m++)p-=o.getRowHeight(m)}else p=hm(g.row,o);O(p)&&g.setAttribute("y",p)}else for(let c=i;c<=t;c++)for(let f=n;f>=e;f--){const g=o.scenegraph.highPerformanceGetCell(c,f,!0);if(g.role!=="cell"||!g.row)continue;let p;if(g._next)p=((a=g._next)===null||a===void 0?void 0:a.attribute.y)-o.getRowHeight(g.row);else if(s){const v=e<=o.frozenRowCount?o.frozenRowCount:e-1;e<=o.frozenRowCount?p=0:p=o.scenegraph.highPerformanceGetCell(c,v,!0).attribute.y;for(let m=v;m<f;m++)p+=o.getRowHeight(m)}else p=hm(g.row,o);O(p)&&g.setAttribute("y",p)}const h=Math.min(o.scenegraph.proxy.rowLimit,o.scenegraph.proxy.bodyBottomRow-o.scenegraph.proxy.bodyTopRow+1),d=o.getRowsHeight(o.frozenRowCount,o.frozenRowCount+h),u=o.getRowsHeight(o.frozenRowCount,o.rowCount-1);o.scenegraph.proxy.yLimitTop=d/2,o.scenegraph.proxy.yLimitBottom=u-d/2}function hm(i,t){let e;return e=i<t.frozenRowCount?t.getRowsHeight(0,i-1):i>=t.rowCount-t.bottomFrozenRowCount?t.getRowsHeight(t.rowCount-t.bottomFrozenRowCount,i-1):t.getRowsHeight(t.frozenRowCount,i-1),e}var Cw=function(i,t,e,n){return new(e||(e=Promise))(function(o,r){function s(h){try{a(n.next(h))}catch(d){r(d)}}function l(h){try{a(n.throw(h))}catch(d){r(d)}}function a(h){var d;h.done?o(h.value):(d=h.value,d instanceof e?d:new e(function(u){u(d)})).then(s,l)}a((n=n.apply(i,t||[])).next())})};function uE(i,t,e,n){return Cw(this,void 0,void 0,function*(){if(!t)return;const o=t.row,r=t.top;let s;if(s=e?n.bodyBottomRow-n.rowEnd:o-n.referenceRow,cE(s,o,r,i,n),e){const l=n.table.scenegraph.highPerformanceGetCell(n.colStart,n.rowEnd,!0);if(l.role==="cell"){const a=l.attribute.y+l.attribute.height-(n.table.tableNoFrameHeight-n.table.getFrozenRowsHeight()-n.table.getBottomFrozenRowsHeight())-i;n.deltaY=-a,n.updateBody(i-n.deltaY)}}})}function cE(i,t,e,n,o){i>0?(dm(i,"up",t,e,n,o),o.updateDeltaY(n,e,t),o.updateBody(n-o.deltaY)):i<0?(dm(-i,"down",t,e,n,o),o.updateDeltaY(n,e,t),o.updateBody(n-o.deltaY)):(o.updateDeltaY(n,e,t),o.updateBody(n-o.deltaY))}function dm(i,t,e,n,o,r){return Cw(this,void 0,void 0,function*(){if(t==="up"&&r.rowEnd+i>r.bodyBottomRow?i=r.bodyBottomRow-r.rowEnd:t==="down"&&r.rowStart-i<r.bodyTopRow&&(i=r.rowStart-r.bodyTopRow),i!==0)if(i<0&&(t=t==="up"?"down":"up",i=-i),i<r.rowEnd-r.rowStart){const s=t==="up"?r.rowStart:r.rowEnd-i+1,l=t==="up"?r.rowStart+i-1:r.rowEnd,a=t==="up"?r.rowEnd+1:r.rowStart-i,h=t==="up"?r.rowEnd+i:r.rowStart-1;let d,u;r.table.isAutoRowHeight()?(d=a,u=h):(d=Math.max(r.bodyTopRow,e-1*r.screenRowCount),u=Math.min(r.bodyBottomRow,e+2*r.screenRowCount,r.table.rowCount-1)),Ri(r.table,d,u,!1),gE(s,l,t,r),r.rowStart=t==="up"?r.rowStart+i:r.rowStart-i,r.rowEnd=t==="up"?r.rowEnd+i:r.rowEnd-i;const c=Qs(d,u,r,!0);r.table.isAutoRowHeight()&&(li(r.bodyLeftCol,r.bodyRightCol,d,u,r.table,h>r.bodyBottomRow-(r.rowEnd-r.rowStart+1)?"down":"up",!0),li(0,r.table.frozenColCount-1,d,u,r.table,h>r.bodyBottomRow-(r.rowEnd-r.rowStart+1)?"down":"up",!0),li(r.table.colCount-r.table.rightFrozenColCount,r.table.colCount-1,d,u,r.table,h>r.bodyBottomRow-(r.rowEnd-r.rowStart+1)?"down":"up",!0)),r.currentRow=t==="up"?r.currentRow+i:r.currentRow-i,r.totalRow=Math.max(0,Math.min(r.bodyBottomRow,t==="up"?r.totalRow+i:r.totalRow-i,r.table.rowCount-1)),r.referenceRow=r.rowStart+Math.floor((r.rowEnd-r.rowStart)/2),r.table.isAutoRowHeight()&&c?r.rowUpdatePos=Math.min(r.rowUpdatePos,r.rowEnd+1):r.rowUpdatePos=Math.min(r.rowUpdatePos,a),r.rowUpdateDirection=t,r.table.scenegraph.updateNextFrame(),yield r.progress()}else{const s=t==="up"?r.rowStart+i:r.rowStart-i,l=Math.min(r.table.rowCount-1,t==="up"?r.rowEnd+i:r.rowEnd-i),a=r.table.getRowsHeight(r.bodyTopRow,s-1);let h,d;r.table.isAutoRowHeight()?(h=s,d=l):(h=Math.max(r.bodyTopRow,e-1*r.screenRowCount),d=Math.min(r.bodyBottomRow,e+2*r.screenRowCount,r.table.rowCount-1)),Ri(r.table,h,d,!1),fE(a,i,t,r),r.rowStart=s,r.rowEnd=l;const u=Qs(h,d,r,!0);r.table.isAutoRowHeight()&&(li(r.bodyLeftCol,r.bodyRightCol,h,d,r.table,l>r.bodyBottomRow-(r.rowEnd-r.rowStart+1)?"down":"up"),li(0,r.table.frozenColCount-1,h,d,r.table,l>r.bodyBottomRow-(r.rowEnd-r.rowStart+1)?"down":"up"),li(r.table.colCount-r.table.rightFrozenColCount,r.table.colCount-1,h,d,r.table,l>r.bodyBottomRow-(r.rowEnd-r.rowStart+1)?"down":"up")),r.currentRow=t==="up"?r.currentRow+i:r.currentRow-i,r.totalRow=Math.max(0,Math.min(r.bodyBottomRow,t==="up"?r.totalRow+i:r.totalRow-i,r.table.rowCount-1)),r.referenceRow=r.rowStart+Math.floor((r.rowEnd-r.rowStart)/2),r.table.isAutoRowHeight()&&u?r.rowUpdatePos=r.rowEnd+1:r.rowUpdatePos=r.rowStart,r.rowUpdateDirection=l>r.bodyBottomRow-(r.rowEnd-r.rowStart+1)?"down":"up",r.table.scenegraph.updateNextFrame(),yield r.progress()}})}function gE(i,t,e,n){for(let o=0;o<n.table.frozenColCount;o++){const r=n.table.scenegraph.getColGroup(o);if(r)for(let s=i;s<=t;s++)ou(r,e,n)}for(let o=n.table.colCount-n.table.rightFrozenColCount;o<n.table.colCount;o++){const r=n.table.scenegraph.getColGroup(o);if(r)for(let s=i;s<=t;s++)ou(r,e,n)}for(let o=n.bodyLeftCol;o<=n.bodyRightCol;o++){const r=n.table.scenegraph.getColGroup(o);if(r)for(let s=i;s<=t;s++)ou(r,e,n)}}function ou(i,t,e){if(i.childrenCount>=1)if(t==="up"){const n=i.firstChild;e.updateCellGroupPosition(n,i.lastChild.row+1,i.lastChild.attribute.y+e.table.getRowHeight(i.lastChild.row)),i.appendChild(n)}else{const n=i.lastChild;e.updateCellGroupPosition(n,i.firstChild.row-1,i.firstChild.attribute.y-e.table.getRowHeight(n.row)),i.insertBefore(n,i.firstChild)}}function fE(i,t,e,n){for(let o=0;o<n.table.frozenColCount;o++){const r=n.table.scenegraph.getColGroup(o);r==null||r.forEachChildren((s,l)=>{n.updateCellGroupPosition(s,e==="up"?s.row+t:s.row-t,l===0?i:s._prev.attribute.y+n.table.getRowHeight(s._prev.row))})}for(let o=n.table.colCount-n.table.rightFrozenColCount;o<n.table.colCount;o++){const r=n.table.scenegraph.getColGroup(o);r==null||r.forEachChildren((s,l)=>{n.updateCellGroupPosition(s,e==="up"?s.row+t:s.row-t,l===0?i:s._prev.attribute.y+n.table.getRowHeight(s._prev.row))})}for(let o=n.bodyLeftCol;o<=n.bodyRightCol;o++){const r=n.table.scenegraph.getColGroup(o);r==null||r.forEachChildren((s,l)=>{n.updateCellGroupPosition(s,e==="up"?s.row+t:s.row-t,l===0?i:s._prev.attribute.y+n.table.getRowHeight(s._prev.row))})}}function Qs(i,t,e,n=!1){for(let l=0;l<e.table.frozenColCount;l++)for(let a=i;a<=t;a++){const h=e.highPerformanceGetCell(l,a,!0);e.updateCellGroupContent(h)}for(let l=e.table.colCount-e.table.rightFrozenColCount;l<e.table.colCount;l++)for(let a=i;a<=t;a++){const h=e.highPerformanceGetCell(l,a);e.updateCellGroupContent(h)}let o=e.bodyLeftCol,r=e.bodyRightCol,s=!0;if(n){const l=e.screenLeftCol;o=Math.max(e.bodyLeftCol,l-1*e.screenColCount),r=Math.min(e.bodyRightCol,l+2*e.screenColCount),o===e.bodyLeftCol&&r===e.bodyRightCol||(s=!1)}for(let l=o;l<=r;l++)for(let a=i;a<=t;a++){const h=e.highPerformanceGetCell(l,a);e.updateCellGroupContent(h)}return ru(e.table.scenegraph.rowHeaderGroup),ru(e.table.scenegraph.rightFrozenGroup),ru(e.table.scenegraph.bodyGroup),e.table.scenegraph.updateNextFrame(),s}function ru(i){var t,e;const n=Zs(i);if(!n)return;const o=Zs(n);if(o&&(i.setAttribute("height",o.attribute.y+o.attribute.height),i.border)){const r=i.border;r.setAttribute("height",o.attribute.y+o.attribute.height-((t=r.attribute.borderTop)!==null&&t!==void 0?t:0)/2-((e=r.attribute.borderBottom)!==null&&e!==void 0?e:0)/2)}}var pE=function(i,t,e,n){return new(e||(e=Promise))(function(o,r){function s(h){try{a(n.next(h))}catch(d){r(d)}}function l(h){try{a(n.throw(h))}catch(d){r(d)}}function a(h){var d;h.done?o(h.value):(d=h.value,d instanceof e?d:new e(function(u){u(d)})).then(s,l)}a((n=n.apply(i,t||[])).next())})};function vE(i){var t;return pE(this,void 0,void 0,function*(){let e,n;i.table.scenegraph.bodyGroup.forEachChildren((s,l)=>{s.type==="group"&&(s.needUpdate=!0,s==null||s.forEachChildren(a=>{a.needUpdate=!0}))}),i.table.isAutoRowHeight()?(e=i.rowStart,n=i.rowEnd):(e=Math.max(i.bodyTopRow,i.screenTopRow-1*i.screenRowCount),n=Math.min(i.bodyBottomRow,i.screenTopRow+2*i.screenRowCount,i.table.rowCount-1));const o=i.table.getAllRowsHeight();Ri(i.table,e,n);const r=i.table.getAllRowsHeight();o!==r&&i.table.scenegraph.updateContainerHeight(i.table.frozenRowCount,r-o);for(let s=0;(t=s<i.table.frozenColCount)!==null&&t!==void 0&&t;s++){const l=i.table.scenegraph.getColGroup(s);l==null||l.setAttribute("chartInstance",void 0);for(let a=i.rowStart;a<=i.rowEnd;a++)i.table.scenegraph.updateCellContent(s,a);for(let a=i.table.rowCount-i.table.bottomFrozenRowCount;a<i.table.rowCount;a++)i.table.scenegraph.updateCellContent(s,a)}for(let s=i.colStart;s<=i.colEnd;s++){const l=i.table.scenegraph.getColGroup(s);l==null||l.setAttribute("chartInstance",void 0);for(let a=i.table.rowCount-i.table.bottomFrozenRowCount;a<i.table.rowCount;a++)i.table.scenegraph.updateCellContent(s,a)}for(let s=i.table.colCount-i.table.rightFrozenColCount;s<i.table.colCount;s++){const l=i.table.scenegraph.getColGroup(s);l==null||l.setAttribute("chartInstance",void 0);for(let a=i.rowStart;a<=i.rowEnd;a++)i.table.scenegraph.updateCellContent(s,a);for(let a=i.table.rowCount-i.table.bottomFrozenRowCount;a<i.table.rowCount;a++)i.table.scenegraph.updateCellContent(s,a)}Qs(e,n,i),i.table.isAutoRowHeight()&&li(i.bodyLeftCol,i.bodyRightCol,e,n,i.table,i.rowEnd>i.bodyBottomRow-(i.rowEnd-i.rowStart+1)?"down":"up"),i.rowUpdatePos=i.rowStart,i.rowUpdateDirection=i.rowEnd>i.bodyBottomRow-(i.rowEnd-i.rowStart+1)?"down":"up",i.table.scenegraph.updateNextFrame(),i.table.isAutoRowHeight()||(yield i.progress())})}var mE=function(i,t,e,n){return new(e||(e=Promise))(function(o,r){function s(h){try{a(n.next(h))}catch(d){r(d)}}function l(h){try{a(n.throw(h))}catch(d){r(d)}}function a(h){var d;h.done?o(h.value):(d=h.value,d instanceof e?d:new e(function(u){u(d)})).then(s,l)}a((n=n.apply(i,t||[])).next())})};function bE(i){return mE(this,void 0,void 0,function*(){i.table.scenegraph.bodyGroup.forEachChildren((n,o)=>{n.type==="group"&&(n.needUpdate=!0,n==null||n.forEachChildren(r=>{r.needUpdate=!0}))});const t=Math.max(i.bodyLeftCol,i.screenLeftCol-1*i.screenColCount),e=Math.min(i.bodyRightCol,i.screenLeftCol+2*i.screenColCount);Ai(i.table,t,e);for(let n=i.colStart;n<=i.colEnd;n++){const o=i.table.scenegraph.getColGroup(n);o==null||o.setAttribute("chartInstance",void 0);for(let r=i.table.rowCount-i.table.bottomFrozenRowCount;r<i.table.rowCount;r++)i.table.scenegraph.updateCellContent(n,r)}for(let n=i.table.colCount-i.table.rightFrozenColCount;n<i.table.colCount;n++){const o=i.table.scenegraph.getColGroup(n);o==null||o.setAttribute("chartInstance",void 0);for(let r=i.rowStart;r<=i.rowEnd;r++)i.table.scenegraph.updateCellContent(n,r);for(let r=i.table.rowCount-i.table.bottomFrozenRowCount;r<i.table.rowCount;r++)i.table.scenegraph.updateCellContent(n,r)}Js(t,e,i),i.colUpdatePos=i.colStart,i.colUpdateDirection=i.colEnd>i.bodyRightCol-(i.colEnd-i.colStart+1)?"right":"left",i.table.scenegraph.updateNextFrame(),yield i.progress()})}function Bs(i){const{changedCells:t}=i.internalProps.stick;t.forEach(g=>{i.scenegraph.getCell(g.col,g.row).forEachChildren(p=>{p.setAttributes({dx:g.dx,dy:g.dy})})}),t.clear();const{scrollTop:e,scrollLeft:n,frozenRowCount:o,frozenColCount:r}=i,s=i.getFrozenRowsHeight(),l=i.getFrozenColsWidth(),{row:a}=i.getRowAt(e+s+1),{col:h}=i.getColAt(n+l+1),d=Math.max(a,i.frozenRowCount),u=Math.max(h,i.frozenColCount),c=i.getAllRowsHeight()>i.tableNoFrameHeight?i.getRowAt(e+i.tableNoFrameHeight-i.getBottomFrozenRowsHeight()-1).row:i.rowCount-i.bottomFrozenRowCount-1,f=i.getAllColsWidth()>i.tableNoFrameWidth?i.getColAt(n+i.tableNoFrameWidth-i.getRightFrozenColsWidth()-1).col:i.colCount-i.rightFrozenColCount-1;if(!(f<0||c<0)){for(let g=0;g<o&&!(f<u);g++)[u,f].forEach(p=>{const v=i._getCellStyle(p,g);v!=null&&v.textStick&&(v==null?void 0:v.textStick)!=="vertical"&&gm(i.scenegraph.getCell(p,g),l+i.tableX,i.tableNoFrameWidth-i.getRightFrozenColsWidth()+i.tableX,t,v==null?void 0:v.textStickBaseOnAlign,i)});for(let g=0;g<r&&!(c<d);g++)[d,c].forEach(p=>{const v=i._getCellStyle(g,p);v!=null&&v.textStick&&(v==null?void 0:v.textStick)!=="horizontal"&&um(i.scenegraph.getCell(g,p),s+i.tableY,i.tableNoFrameHeight-i.getBottomFrozenRowsHeight()+i.tableY,t,v==null?void 0:v.textStickBaseOnAlign,i)});for(let g=u;g<=f&&!(c<d);g++)[d,c].forEach(p=>{const v=i._getCellStyle(g,p);v!=null&&v.textStick&&(v==null?void 0:v.textStick)!=="horizontal"&&um(i.scenegraph.getCell(g,p),s+i.tableY,i.tableNoFrameHeight-i.getBottomFrozenRowsHeight()+i.tableY,t,v==null?void 0:v.textStickBaseOnAlign,i)});for(let g=d;g<=c&&!(f<u);g++)[u,f].forEach(p=>{const v=i._getCellStyle(p,g);v!=null&&v.textStick&&(v==null?void 0:v.textStick)!=="vertical"&&gm(i.scenegraph.getCell(p,g),l+i.tableX,i.tableNoFrameWidth-i.getRightFrozenColsWidth()+i.tableX,t,v==null?void 0:v.textStickBaseOnAlign,i)})}}function um(i,t,e,n,o,r){if(Z(i.mergeStartCol)&&Z(i.mergeStartRow)&&Z(i.mergeEndCol)&&Z(i.mergeEndRow)){const{colStart:s,colEnd:l,rowStart:a,rowEnd:h}=oo(i,r.scenegraph);for(let d=s;d<=l;d++)for(let u=a;u<=h;u++){const c=r.scenegraph.getCell(d,u);c.role==="cell"&&cm(c,t,e,n,o)}}else cm(i,t,e,n,o)}function cm(i,t,e,n,o){var r,s,l,a,h,d,u,c,f,g,p,v,m,b,C,_,w;const y=i.getChildByName("text",!0)||i.getChildByName("image",!0);if(!y)return;if(y.type==="image"){const{image:B}=y.attribute;if(!B||!y.resources||y.resources.get(B).state!=="success")return}const x=(r=y.textBaseline)!==null&&r!==void 0?r:"top";y.AABBBounds.width();const S=y.globalAABBBounds.y1,R=y.globalAABBBounds.y2;if(x==="middle"&&o){const B=i.globalAABBBounds.y1+((l=(s=i.firstChild)===null||s===void 0?void 0:s.attribute.dy)!==null&&l!==void 0?l:0),A=B+((h=(a=i.contentHeight)!==null&&a!==void 0?a:i.attribute.height)!==null&&h!==void 0?h:0);if(B<t||A>e){const M=Math.max(B,t),k=Math.min(A,e),E=y.globalTransMatrix.f-(k+M)/2+y.AABBBounds.height()/2;!n.has(`${i.col}-${i.row}`)&&n.set(`${i.col}-${i.row}`,{col:i.col,row:i.row,dx:(u=(d=i.firstChild)===null||d===void 0?void 0:d.attribute.dx)!==null&&u!==void 0?u:0,dy:(f=(c=i.firstChild)===null||c===void 0?void 0:c.attribute.dy)!==null&&f!==void 0?f:0}),i.forEachChildren(T=>{var P;T.setAttribute("dy",((P=T.attribute.dy)!==null&&P!==void 0?P:0)-E+2)})}}else if(S<t){const B=S-t;!n.has(`${i.col}-${i.row}`)&&n.set(`${i.col}-${i.row}`,{col:i.col,row:i.row,dx:(p=(g=i.firstChild)===null||g===void 0?void 0:g.attribute.dx)!==null&&p!==void 0?p:0,dy:(m=(v=i.firstChild)===null||v===void 0?void 0:v.attribute.dy)!==null&&m!==void 0?m:0}),i.forEachChildren(A=>{var M;A.setAttribute("dy",((M=A.attribute.dy)!==null&&M!==void 0?M:0)-B+2)})}else if(R>e){const B=R-e;!n.has(`${i.col}-${i.row}`)&&n.set(`${i.col}-${i.row}`,{col:i.col,row:i.row,dx:(C=(b=i.firstChild)===null||b===void 0?void 0:b.attribute.dx)!==null&&C!==void 0?C:0,dy:(w=(_=i.firstChild)===null||_===void 0?void 0:_.attribute.dy)!==null&&w!==void 0?w:0}),i.forEachChildren(A=>{var M;A.setAttribute("dy",((M=A.attribute.dy)!==null&&M!==void 0?M:0)-B)})}}function gm(i,t,e,n,o,r){if(Z(i.mergeStartCol)&&Z(i.mergeStartRow)&&Z(i.mergeEndCol)&&Z(i.mergeEndRow)){const{colStart:s,colEnd:l,rowStart:a,rowEnd:h}=oo(i,r.scenegraph);for(let d=s;d<=l;d++)for(let u=a;u<=h;u++){const c=r.scenegraph.getCell(d,u);c.role==="cell"&&fm(c,t,e,n,o)}}else fm(i,t,e,n,o)}function fm(i,t,e,n,o){var r,s,l,a,h,d,u,c,f,g,p,v,m,b,C,_,w,y;const x=i.getChildByName("text",!0)||i.getChildByName("image",!0);if(!x)return;if(x.type==="image"){const{image:A}=x.attribute;if(!A||!x.resources||x.resources.get(A).state!=="success")return}const S=(s=(r=x.attribute.textAlign)!==null&&r!==void 0?r:x.textAlign)!==null&&s!==void 0?s:"left";x.AABBBounds.width();const R=x.globalAABBBounds.x1,B=x.globalAABBBounds.x2;if(S==="center"&&o){const A=i.globalAABBBounds.x1+((a=(l=i.firstChild)===null||l===void 0?void 0:l.attribute.dx)!==null&&a!==void 0?a:0),M=A+((d=(h=i.contentWidth)!==null&&h!==void 0?h:i.attribute.width)!==null&&d!==void 0?d:0);if(A<t||M>e){const k=Math.max(A,t),E=Math.min(M,e),T=x.globalTransMatrix.e-(E+k)/2;!n.has(`${i.col}-${i.row}`)&&n.set(`${i.col}-${i.row}`,{col:i.col,row:i.row,dx:(c=(u=i.firstChild)===null||u===void 0?void 0:u.attribute.dx)!==null&&c!==void 0?c:0,dy:(g=(f=i.firstChild)===null||f===void 0?void 0:f.attribute.dy)!==null&&g!==void 0?g:0}),i.forEachChildren(P=>{var H;P.setAttribute("dx",((H=P.attribute.dx)!==null&&H!==void 0?H:0)-T+2)})}}else if(R<t){const A=R-t;!n.has(`${i.col}-${i.row}`)&&n.set(`${i.col}-${i.row}`,{col:i.col,row:i.row,dx:(v=(p=i.firstChild)===null||p===void 0?void 0:p.attribute.dx)!==null&&v!==void 0?v:0,dy:(b=(m=i.firstChild)===null||m===void 0?void 0:m.attribute.dy)!==null&&b!==void 0?b:0}),i.forEachChildren(M=>{var k;M.setAttribute("dx",((k=M.attribute.dx)!==null&&k!==void 0?k:0)-A+2)})}else if(B>e){const A=B-e;!n.has(`${i.col}-${i.row}`)&&n.set(`${i.col}-${i.row}`,{col:i.col,row:i.row,dx:(_=(C=i.firstChild)===null||C===void 0?void 0:C.attribute.dx)!==null&&_!==void 0?_:0,dy:(y=(w=i.firstChild)===null||w===void 0?void 0:w.attribute.dy)!==null&&y!==void 0?y:0}),i.forEachChildren(M=>{var k;M.setAttribute("dx",((k=M.attribute.dx)!==null&&k!==void 0?k:0)-A)})}}function pm(i){var t,e;const n=i.internalProps.layoutMap.headerObjects,o=i.internalProps.layoutMap.columnObjects;for(let r=0;r<n.length;r++){const s=n[r];if(s&&(!((t=s.style)===null||t===void 0)&&t.textStick))return!0}for(let r=0;r<o.length;r++){const s=o[r];if(s&&(!((e=s.style)===null||e===void 0)&&e.textStick))return!0}return!!(i.theme.headerStyle.textStick||i.theme.rowHeaderStyle.textStick||i.theme.bodyStyle.textStick)}var bi=function(i,t,e,n){return new(e||(e=Promise))(function(o,r){function s(h){try{a(n.next(h))}catch(d){r(d)}}function l(h){try{a(n.throw(h))}catch(d){r(d)}}function a(h){var d;h.done?o(h.value):(d=h.value,d instanceof e?d:new e(function(u){u(d)})).then(s,l)}a((n=n.apply(i,t||[])).next())})};class CE{constructor(t){this.isRelease=!1,this.mode="column",this.rowLimit=200,this.currentRow=0,this.rowStart=0,this.rowEnd=0,this.referenceRow=0,this.screenTopRow=0,this.deltaY=0,this.deltaHeight=0,this.colLimit=100,this.screenLeftCol=0,this.deltaX=0,this.deltaWidth=0,this.cellCache=new Map,this.table=t,this.table.isPivotChart()?(this.rowLimit=Math.max(100,Math.ceil(2*t.tableNoFrameHeight/t.defaultRowHeight)),this.colLimit=Math.max(100,Math.ceil(2*t.tableNoFrameWidth/t.defaultColWidth))):this.table.isAutoRowHeight()?this.rowLimit=Math.max(100,Math.ceil(2*t.tableNoFrameHeight/t.defaultRowHeight)):(this.table.widthMode==="autoWidth"||(this.rowLimit=Math.max(200,Math.ceil(2*t.tableNoFrameHeight/t.defaultRowHeight))),this.colLimit=Math.max(100,Math.ceil(2*t.tableNoFrameWidth/t.defaultColWidth))),this.table.internalProps.transpose?this.mode="row":this.table.isPivotTable()&&(this.mode="pivot"),this.table.options.maintainedDataCount&&(this.rowLimit=this.table.options.maintainedDataCount)}get bodyLeftCol(){return this.table.frozenColCount}get bodyTopRow(){return this.table.frozenRowCount}setParamsForColumn(){this.bodyRightCol=this.table.colCount-1-this.table.rightFrozenColCount;const t=Math.min(this.colLimit,this.bodyRightCol-this.bodyLeftCol+1);this.totalActualBodyColCount=t,this.totalCol=this.bodyLeftCol+t-1,this.colStart=this.bodyLeftCol,this.colEnd=this.totalCol;const e=this.table.defaultColWidth;this.taskColCount=1*Math.ceil(this.table.tableNoFrameWidth/e);const n=e*t,o=e*(this.bodyRightCol-this.bodyLeftCol+1);this.xLimitLeft=n/2,this.xLimitRight=o-n/2;const r=5*this.table.tableNoFrameWidth;this.screenColCount=Math.ceil(this.table.tableNoFrameWidth/e),this.firstScreenColLimit=Math.max(15,this.bodyLeftCol+Math.min(this.colLimit,Math.ceil(r/e))),this.colUpdatePos=this.bodyRightCol}setParamsForRow(){this.bodyBottomRow=this.table.rowCount-1-this.table.bottomFrozenRowCount;const t=Math.min(this.rowLimit,this.bodyBottomRow-this.bodyTopRow+1);this.totalActualBodyRowCount=t,this.totalRow=this.bodyTopRow+t-1,this.rowStart=this.bodyTopRow,this.rowEnd=this.totalRow;const e=this.table.defaultRowHeight;this.taskRowCount=1*Math.ceil(this.table.tableNoFrameHeight/e);const n=e*t,o=e*(this.bodyBottomRow-this.bodyTopRow+1);this.yLimitTop=n/2,this.yLimitBottom=o-n/2;const r=5*this.table.tableNoFrameHeight;this.screenRowCount=Math.ceil(this.table.tableNoFrameHeight/e),this.firstScreenRowLimit=Math.max(30,this.bodyTopRow+Math.min(this.rowLimit,Math.ceil(r/e))),this.rowUpdatePos=this.bodyBottomRow}refreshRowCount(){this.bodyBottomRow=this.table.rowCount-1-this.table.bottomFrozenRowCount;const t=Math.min(this.rowLimit,this.bodyBottomRow-this.bodyTopRow+1);this.totalActualBodyRowCount=t,this.totalRow=this.rowStart+t-1}refreshColCount(){this.bodyRightCol=this.table.colCount-1-this.table.rightFrozenColCount;const t=Math.min(this.colLimit,this.bodyRightCol-this.bodyLeftCol+1);this.totalActualBodyColCount=t,this.totalCol=this.bodyLeftCol+t-1,this.colStart=this.bodyLeftCol,this.colEnd=this.totalCol}resize(){const t=this.table.defaultColWidth;this.taskColCount=1*Math.ceil(this.table.tableNoFrameWidth/t);const e=5*this.table.tableNoFrameWidth;this.screenColCount=Math.ceil(this.table.tableNoFrameWidth/t),this.firstScreenColLimit=this.bodyLeftCol+Math.min(this.colLimit,Math.ceil(e/t));const n=this.table.defaultRowHeight;this.taskRowCount=1*Math.ceil(this.table.tableNoFrameHeight/n);const o=5*this.table.tableNoFrameHeight;this.screenRowCount=Math.ceil(this.table.tableNoFrameHeight/n),this.firstScreenRowLimit=this.bodyTopRow+Math.min(this.rowLimit,Math.ceil(o/n))}createGroupForFirstScreen(t,e,n,o,r,s,l,a){nE(t,e,n,o,r,s,l,a,this)}progress(){return bi(this,void 0,void 0,function*(){if(!this.isProgressing)return this.isProgressing=!0,new Promise((t,e)=>{setTimeout(()=>bi(this,void 0,void 0,function*(){this.isProgressing=!1,this.isRelease||(this.colUpdatePos<=this.colEnd?(yield this.updateColCellGroupsAsync(),yield this.progress()):this.rowUpdatePos<=this.rowEnd?(yield this.updateRowCellGroupsAsync(),yield this.progress()):this.currentCol<this.totalCol?(yield this.createCol(),yield this.progress()):this.currentRow<this.totalRow&&(yield this.createRow(),yield this.progress()),Bs(this.table),this.table.scenegraph.updateNextFrame(),t())}),16)})})}createRow(){return bi(this,void 0,void 0,function*(){this.taskRowCount&&this.createRowCellGroup(this.taskRowCount)})}createCol(){return bi(this,void 0,void 0,function*(){this.taskColCount&&this.createColGroup(this.taskRowCount)})}createRowCellGroup(t){const e=Math.min(this.totalRow,this.currentRow+t);if(Ri(this.table,this.currentRow+1,e,!1),this.rowEnd=e,this.table.frozenColCount){let o=0;for(let r=0;r<this.table.frozenColCount;r++){const s=this.table.scenegraph.getColGroup(r),{height:l}=(this.table.isListTable(),ia(s,r,s.attribute.width,this.currentRow+1,e,this.table.scenegraph.mergeMap,this.table.defaultRowHeight,this.table));o=Math.max(o,l),this.table.scenegraph.rowHeaderGroup.setAttribute("height",o)}}if(this.table.rightFrozenColCount){let o=0;for(let r=this.table.colCount-this.table.rightFrozenColCount;r<this.table.colCount;r++){const s=this.table.scenegraph.getColGroup(r),{height:l}=(this.table.isPivotChart(),ia(s,r,s.attribute.width,this.currentRow+1,e,this.table.scenegraph.mergeMap,this.table.defaultRowHeight,this.table));o=Math.max(o,l),this.table.scenegraph.rightFrozenGroup.setAttribute("height",o)}}let n=0;for(let o=this.bodyLeftCol;o<=this.bodyRightCol;o++){const r=this.table.scenegraph.getColGroup(o);if(!r)continue;this.table.rowHeaderLevelCount;const{height:s}=ia(r,o,r.attribute.width,this.currentRow+1,e,this.table.scenegraph.mergeMap,this.table.defaultRowHeight,this.table);n=Math.max(n,s)}this.table.scenegraph.bodyGroup.setAttribute("height",n),this.currentRow=e,this.rowUpdatePos=this.rowEnd,this.table.scenegraph.updateContainer(),this.table.scenegraph.updateBorderSizeAndPosition()}createColGroup(t){const e=Math.min(this.totalCol,this.currentCol+t);Ai(this.table,this.currentCol+1,e),this.colEnd=e;for(let s=0;s<this.table.rowCount;s++){const l=this.highPerformanceGetCell(this.currentCol,s);l.role==="cell"&&Z(l.mergeStartCol)&&l.mergeStartCol>this.currentCol&&this.table.scenegraph.updateCellContent(l.col,l.row)}if(this.table.frozenRowCount){const s=this.table.scenegraph.colHeaderGroup.lastChild instanceof Tt?this.table.scenegraph.colHeaderGroup.lastChild:this.table.scenegraph.colHeaderGroup.lastChild._prev,l=s.attribute.x+s.attribute.width,a=s.attribute.y;be(this.table.scenegraph.colHeaderGroup,l,a,this.currentCol+1,e,0,this.table.frozenRowCount-1,"columnHeader",this.table)}if(this.table.bottomFrozenRowCount){const s=this.table.scenegraph.bottomFrozenGroup.lastChild instanceof Tt?this.table.scenegraph.bottomFrozenGroup.lastChild:this.table.scenegraph.bottomFrozenGroup.lastChild._prev,l=s.attribute.x+s.attribute.width,a=s.attribute.y;be(this.table.scenegraph.bottomFrozenGroup,l,a,this.currentCol+1,e,this.table.rowCount-this.table.bottomFrozenRowCount,this.table.rowCount-1,"columnHeader",this.table)}let n=this.table.scenegraph.bodyGroup.lastChild&&(this.table.scenegraph.bodyGroup.lastChild instanceof Tt?this.table.scenegraph.bodyGroup.lastChild:this.table.scenegraph.bodyGroup.lastChild._prev);n||(n=this.table.scenegraph.colHeaderGroup.lastChild&&(this.table.scenegraph.colHeaderGroup.lastChild instanceof Tt?this.table.scenegraph.colHeaderGroup.lastChild:this.table.scenegraph.colHeaderGroup.lastChild._prev));const o=n.attribute.x+n.attribute.width,r=n.attribute.y;be(this.table.scenegraph.bodyGroup,o,r,this.currentCol+1,e,this.rowStart,this.rowEnd,"body",this.table),this.currentCol=e,this.colUpdatePos=this.colEnd,this.table.scenegraph.updateContainer(),this.table.scenegraph.updateBorderSizeAndPosition()}setY(t,e=!1){return bi(this,void 0,void 0,function*(){const n=this.table.getRowsHeight(this.bodyTopRow,this.bodyTopRow+(this.rowEnd-this.rowStart+1))/2,o=this.table.getAllRowsHeight()-n,r=this.table.getTargetRowAt(t+this.table.scenegraph.colHeaderGroup.attribute.height);r&&(this.screenTopRow=r.row),t<n&&this.rowStart===this.bodyTopRow||t>o&&this.rowEnd===this.bodyBottomRow?(this.updateDeltaY(t),this.updateBody(t-this.deltaY)):this.table.scenegraph.bodyGroup.firstChild&&this.table.scenegraph.bodyGroup.firstChild.type==="group"&&this.table.scenegraph.bodyGroup.firstChild.childrenCount!==0||this.table.scenegraph.rowHeaderGroup.firstChild&&this.table.scenegraph.rowHeaderGroup.firstChild.type==="group"&&this.table.scenegraph.rowHeaderGroup.firstChild.childrenCount!==0?this.dynamicSetY(t,r,e):(this.updateDeltaY(t),this.updateBody(t-this.deltaY))})}setX(t,e=!1){return bi(this,void 0,void 0,function*(){const n=this.table.getColsWidth(this.bodyLeftCol,this.bodyLeftCol+(this.colEnd-this.colStart+1))/2,o=this.table.getAllColsWidth()-n,r=this.table.getTargetColAt(t+this.table.scenegraph.rowHeaderGroup.attribute.width);r&&(this.screenLeftCol=r.col),t<n&&this.colStart===this.bodyLeftCol||t>o&&this.colEnd===this.bodyRightCol||this.table.scenegraph.bodyGroup.firstChild&&this.table.scenegraph.bodyGroup.firstChild.type==="group"&&this.table.scenegraph.bodyGroup.firstChild.childrenCount===0?(this.updateDeltaX(t),this.table.scenegraph.setBodyAndColHeaderX(-t+this.deltaX)):this.dynamicSetX(t,r,e)})}dynamicSetY(t,e,n=!1){return bi(this,void 0,void 0,function*(){uE(t,e,n,this)})}dynamicSetX(t,e,n=!1){return bi(this,void 0,void 0,function*(){sE(t,e,n,this)})}updateBody(t){this.table.scenegraph.setBodyAndRowHeaderY(-t)}updateRowCellGroupsAsync(){return bi(this,void 0,void 0,function*(){this.updateCellGroups(this.taskRowCount)})}updateCellGroups(t){const e=Math.min(this.bodyBottomRow,this.rowUpdatePos+t);this.table.isAutoRowHeight()&&Ri(this.table,this.rowUpdatePos,e,!1),Qs(this.rowUpdatePos,e,this),this.table.isAutoRowHeight()&&(li(this.bodyLeftCol,this.bodyRightCol,this.rowUpdatePos,e,this.table,this.rowUpdateDirection,!0),li(0,this.table.frozenColCount-1,this.rowUpdatePos,e,this.table,this.rowUpdateDirection,!0),li(this.table.colCount-this.table.rightFrozenColCount,this.table.colCount-1,this.rowUpdatePos,e,this.table,this.rowUpdateDirection,!0)),this.rowUpdatePos=e+1}updateBottomFrozenCellGroups(){const t=this.table.rowCount-this.table.bottomFrozenRowCount,e=this.table.rowCount-1;this.table.isAutoRowHeight()&&Ri(this.table,t,e,!1),Qs(t,e,this),this.table.isAutoRowHeight()&&(li(this.bodyLeftCol,this.bodyRightCol,t,e,this.table,this.rowUpdateDirection),li(0,this.table.frozenColCount-1,t,e,this.table,this.rowUpdateDirection),li(this.table.colCount-this.table.rightFrozenColCount,this.table.colCount-1,t,e,this.table,this.rowUpdateDirection))}updateRightFrozenCellGroups(){const t=this.table.colCount-this.table.rightFrozenColCount,e=this.table.colCount-1;this.table.widthMode==="autoWidth"&&Ai(this.table,t,e,!1),Js(t,e,this),this.table.isAutoRowHeight()&&rg(t,e,this.table,this.colUpdateDirection)}updateColCellGroupsAsync(){return bi(this,void 0,void 0,function*(){this.updateColGroups(this.taskRowCount)})}updateColGroups(t){const e=Math.min(this.bodyRightCol,this.colUpdatePos+t);Ai(this.table,this.colUpdatePos,e),Js(this.colUpdatePos,e,this),this.colUpdatePos=e+1}updateCellGroupPosition(t,e,n){t.row=e,t.mergeStartCol=void 0,t.mergeStartRow=void 0,t.mergeEndCol=void 0,t.mergeEndRow=void 0,t.setAttribute("y",n),t.needUpdate=!0,t.needUpdateForAutoRowHeight=!0}updateCellGroupContent(t){if(!t.needUpdate||t.role!=="cell")return t;const e=this.table.scenegraph.updateCellContent(t.col,t.row);return t.needUpdate=!1,e||t}sortCellVertical(){return bi(this,void 0,void 0,function*(){yield vE(this)})}sortCellHorizontal(){return bi(this,void 0,void 0,function*(){yield bE(this)})}highPerformanceGetCell(t,e,n){if(e>=this.table.frozenRowCount&&e<this.table.rowCount-this.table.bottomFrozenRowCount&&(e<this.rowStart||e>this.rowEnd)||t>=this.table.frozenColCount&&t<this.table.colCount-this.table.rightFrozenColCount&&(t<this.colStart||t>this.colEnd))return kh;if(this.cellCache.get(t)){const r=this.cellCache.get(t);if((r._next||r._prev)&&Math.abs(r.row-e)<e){let l=sg(r,e);return l&&(n||l.role!=="shadow-cell")||(l=this.table.scenegraph.getCell(t,e,n)),l.row&&this.cellCache.set(t,l),l}const s=this.table.scenegraph.getCell(t,e,n);return s.col===t&&s.row&&this.cellCache.set(t,s),s}const o=this.table.scenegraph.getCell(t,e,n);return o.col===t&&o.row&&this.cellCache.set(t,o),o}updateDeltaY(t,e,n){if(this.rowStart===this.bodyTopRow){const o=this.table.scenegraph.highPerformanceGetCell(this.colStart,this.rowStart,!0);if(o.role==="cell"){const r=o.attribute.y;this.deltaY=-r}}else if(this.rowEnd===this.bodyBottomRow){const o=this.table.scenegraph.highPerformanceGetCell(this.colStart,this.rowEnd,!0);if(o.role==="cell"){const r=o.attribute.y+o.attribute.height-(this.table.getAllRowsHeight()-this.table.getFrozenRowsHeight()-this.table.getBottomFrozenRowsHeight());this.deltaY=-r}}else if(O(e)&&O(n)){let o=this.table.scenegraph.highPerformanceGetCell(this.colStart,n,!0);o.role!=="cell"&&(o=this.table.scenegraph.highPerformanceGetCell(0,n,!0));const r=t-this.deltaY,s=e-r,l=o.attribute.y-r+this.table.getFrozenRowsHeight();this.deltaY=s-l}}updateDeltaX(t,e,n){if(this.colStart===this.bodyLeftCol){const o=this.table.scenegraph.getColGroup(this.colStart);if(o){const r=o.attribute.x;this.deltaX=-r}}else if(this.colEnd===this.bodyRightCol){const o=this.table.scenegraph.getColGroup(this.colEnd);if(o){const r=o.attribute.x+o.attribute.width-(this.table.getAllColsWidth()-this.table.getFrozenColsWidth()-this.table.getRightFrozenColsWidth());this.deltaX=-r}}else if(O(e)&&O(n)){const o=this.table.scenegraph.getColGroup(n)||this.table.scenegraph.getColGroup(n,!0),r=t-this.deltaX,s=e-r,l=o.attribute.x-r+this.table.getFrozenColsWidth();this.deltaX=s-l}}release(){this.isRelease=!0}}function sg(i,t){if(!i)return null;if(i.row===t)return i;const e=i._prev,n=i._next;return i.row>t&&e&&e.row===i.row-1?sg(e,t):i.row<t&&n&&n.row===i.row+1?sg(n,t):null}function _E(i,t,e,n,o,r){const s=r.scenegraph;for(let l=i;l<=t;l++){const a=r.getColWidth(l),h=r.scenegraph.getColGroup(l,!0),d=r.scenegraph.getColGroup(l),u=r.scenegraph.getColGroupInBottom(l),c=r.scenegraph.getColGroupInLeftBottomCorner(l),f=r.scenegraph.getColGroupInRightBottomCorner(l);h&&(h.setAttribute("width",a),h.forEachChildren(g=>{g.setAttribute("width",a)})),d&&(d.setAttribute("width",a),d.forEachChildren(g=>{g.setAttribute("width",a)})),u&&(u.setAttribute("width",a),u.forEachChildren(g=>{g.setAttribute("width",a)})),f&&(f.setAttribute("width",a),f.forEachChildren(g=>{g.setAttribute("width",a)})),c&&(c.setAttribute("width",a),c.forEachChildren(g=>{g.setAttribute("width",a)}))}if(s.updateContainer(),o==="column")for(let l=i;l<=t;l++){const a=r.scenegraph.getColGroup(l);a==null||a.setAttribute("chartInstance",void 0);for(let h=0;h<=r.frozenRowCount-1;h++)s.updateCellContent(l,h);for(let h=s.bodyRowStart;h<=s.bodyRowEnd;h++)s.updateCellContent(l,h);for(let h=r.rowCount-r.bottomFrozenRowCount;h<=r.rowCount-1;h++)s.updateCellContent(l,h)}else{for(let l=0;l<=r.frozenColCount-1;l++){const a=r.scenegraph.getColGroup(l);a==null||a.setAttribute("chartInstance",void 0);for(let h=e;h<=n;h++)s.updateCellContent(l,h)}for(let l=s.bodyColStart;l<=s.bodyColEnd;l++){const a=r.scenegraph.getColGroup(l);a==null||a.setAttribute("chartInstance",void 0);for(let h=e;h<=n;h++)s.updateCellContent(l,h)}for(let l=r.colCount-r.rightFrozenColCount;l<=r.colCount-1;l++){const a=r.scenegraph.getColGroup(l);a==null||a.setAttribute("chartInstance",void 0);for(let h=e;h<=n;h++)s.updateCellContent(l,h)}}}function _w(i){i.customSelectedRangeComponents.forEach((t,e)=>{su(t,e,i)}),i.selectingRangeComponents.forEach((t,e)=>{su(t,e,i)}),i.selectedRangeComponents.forEach((t,e)=>{su(t,e,i)})}function su(i,t,e){var n,o,r,s,l,a,h,d,u;const c=e.table,[f,g,p,v]=t.split("-"),m=parseInt(f,10),b=parseInt(g,10),C=parseInt(p,10),_=parseInt(v,10);let w,y=m,x=b,S=C,R=_;switch(i.role){case"rowHeader":w=c.getBodyVisibleRowRange(),w&&(x=Math.max(b,w.rowStart-1),R=Math.min(_,w.rowEnd+1));break;case"columnHeader":case"bottomFrozen":w=c.getBodyVisibleCellRange(),w&&(y=Math.max(m,w.colStart-1),S=Math.min(C,w.colEnd+1));break;case"cornerHeader":case"rightTopCorner":case"leftBottomCorner":case"rightBottomCorner":break;case"rightFrozen":w=c.getBodyVisibleCellRange(),w&&(x=Math.max(b,w.rowStart-1),R=Math.min(_,w.rowEnd+1));break;default:w=c.getBodyVisibleCellRange(),w&&(x=Math.max(b,w.rowStart-1),R=Math.min(_,w.rowEnd+1),y=Math.max(m,w.colStart-1),S=Math.min(C,w.colEnd+1))}const B=c.getColsWidth(y,S),A=c.getRowsHeight(x,R),M=e.highPerformanceGetCell(y,x).globalAABBBounds,k=e.highPerformanceGetCell(S,R).globalAABBBounds;i.rect.setAttributes({x:M.x1-e.tableGroup.attribute.x,y:M.y1-e.tableGroup.attribute.y,width:B,height:A,visible:!0}),i.fillhandle&&((n=i.fillhandle)===null||n===void 0||n.setAttributes({x:k.x2-e.tableGroup.attribute.x-3,y:k.y2-e.tableGroup.attribute.y-3,width:6,height:6,visible:!0}));let E=!!c.frozenColCount&&m===c.frozenColCount;!E&&c.frozenColCount&&c.scrollLeft>0&&m>=c.frozenColCount&&c.getColsWidth(0,m-1)-c.scrollLeft<c.getFrozenColsWidth()&&(E=!0);let T=!!c.rightFrozenColCount&&c.rightFrozenColCount>0&&C===c.colCount-c.rightFrozenColCount-1;!T&&c.rightFrozenColCount&&C<c.colCount-c.rightFrozenColCount&&c.getColsWidth(0,C)-c.scrollLeft>c.tableNoFrameWidth-c.getRightFrozenColsWidth()&&(T=!0);let P=!c.frozenRowCount||b===c.frozenRowCount;!P&&c.frozenRowCount&&c.scrollTop>0&&b>=c.frozenRowCount&&c.getRowsHeight(0,b-1)-c.scrollTop<c.getFrozenRowsHeight()&&(P=!0);let H=!!c.bottomFrozenRowCount&&_===c.rowCount-c.bottomFrozenRowCount-1;if(!H&&c.bottomFrozenRowCount&&_<c.rowCount-c.bottomFrozenRowCount&&c.getRowsHeight(0,_)-c.scrollTop>c.tableNoFrameHeight-c.getBottomFrozenRowsHeight()&&(H=!0),E&&i.rect.attribute.stroke[3]||T&&i.rect.attribute.stroke[1]||P&&i.rect.attribute.stroke[0]||H&&i.rect.attribute.stroke[2]){if(E&&i.rect.attribute.stroke[3]&&e.tableGroup.insertAfter(i.rect,i.role==="columnHeader"?e.cornerHeaderGroup:i.role==="bottomFrozen"?e.leftBottomCornerGroup:e.rowHeaderGroup),H&&i.rect.attribute.stroke[2]&&e.tableGroup.insertAfter(i.rect,i.role==="rowHeader"?e.leftBottomCornerGroup:i.role==="rightFrozen"?e.rightBottomCornerGroup:e.bottomFrozenGroup),P&&i.rect.attribute.stroke[0]&&e.tableGroup.insertAfter(i.rect,i.role==="rowHeader"?e.cornerHeaderGroup:i.role==="rightFrozen"?e.rightTopCornerGroup:e.colHeaderGroup),T&&i.rect.attribute.stroke[1]&&e.tableGroup.insertAfter(i.rect,i.role==="columnHeader"?e.rightTopCornerGroup:i.role==="bottomFrozen"?e.rightBottomCornerGroup:e.rightFrozenGroup),i.rect.attribute.x<c.getFrozenColsWidth()&&c.scrollLeft>0&&(i.role==="body"||i.role==="columnHeader"||i.role==="bottomFrozen")){const F=i.rect.attribute.width-(c.getFrozenColsWidth()-i.rect.attribute.x);i.rect.setAttributes({x:i.rect.attribute.x+(c.getFrozenColsWidth()-i.rect.attribute.x),width:F>0?F:0}),(o=i.fillhandle)===null||o===void 0||o.setAttributes({visible:F>0})}if(c.getRightFrozenColsWidth()>0&&e.rightFrozenGroup.attribute.height>0&&i.rect.attribute.x+i.rect.attribute.width>e.rightFrozenGroup.attribute.x&&(i.role==="body"||i.role==="columnHeader"||i.role==="bottomFrozen")){const F=e.rightFrozenGroup.attribute.x-i.rect.attribute.x;i.rect.setAttributes({x:i.rect.attribute.x,width:F>0?F:0}),(r=i.fillhandle)===null||r===void 0||r.setAttributes({visible:F-B>0})}if(i.rect.attribute.y<e.colHeaderGroup.attribute.height&&c.scrollTop>0&&(i.role==="body"||i.role==="rowHeader"||i.role==="rightFrozen")){const F=i.rect.attribute.height-(e.colHeaderGroup.attribute.height-i.rect.attribute.y);i.rect.setAttributes({y:i.rect.attribute.y+(e.colHeaderGroup.attribute.height-i.rect.attribute.y),height:F>0?F:0}),(s=i.fillhandle)===null||s===void 0||s.setAttributes({visible:F>0})}if(e.bottomFrozenGroup.attribute.width>0&&e.bottomFrozenGroup.attribute.height>0&&i.rect.attribute.y+i.rect.attribute.height>e.bottomFrozenGroup.attribute.y&&(i.role==="body"||i.role==="rowHeader"||i.role==="rightFrozen")){const F=e.bottomFrozenGroup.attribute.y-i.rect.attribute.y;i.rect.setAttributes({y:i.rect.attribute.y,height:F>0?F:0}),(l=i.fillhandle)===null||l===void 0||l.setAttributes({visible:F-A>0})}}else e.tableGroup.insertAfter(i.rect,i.role==="body"?e.bodyGroup:i.role==="columnHeader"?e.colHeaderGroup:i.role==="rowHeader"?e.rowHeaderGroup:i.role==="cornerHeader"?e.cornerHeaderGroup:i.role==="rightTopCorner"?e.rightTopCornerGroup:i.role==="rightFrozen"?e.rightFrozenGroup:i.role==="leftBottomCorner"?e.leftBottomCornerGroup:i.role==="bottomFrozen"?e.bottomFrozenGroup:e.rightBottomCornerGroup);let L=0;typeof i.rect.attribute.lineWidth=="number"&&(L=Math.ceil(i.rect.attribute.lineWidth/2)),C===c.colCount-1&&(Array.isArray(i.rect.attribute.lineWidth)&&(L=Math.ceil(((a=i.rect.attribute.lineWidth[1])!==null&&a!==void 0?a:0)/2)),i.rect.setAttributes({width:i.rect.attribute.width-L})),m===0&&(Array.isArray(i.rect.attribute.lineWidth)&&(L=Math.ceil(((h=i.rect.attribute.lineWidth[3])!==null&&h!==void 0?h:0)/2)),i.rect.setAttributes({x:i.rect.attribute.x+L,width:i.rect.attribute.width-L})),_===c.rowCount-1&&(Array.isArray(i.rect.attribute.lineWidth)&&(L=Math.ceil(((d=i.rect.attribute.lineWidth[2])!==null&&d!==void 0?d:0)/2)),i.rect.setAttributes({height:i.rect.attribute.height-L})),b===0&&(Array.isArray(i.rect.attribute.lineWidth)&&(L=Math.ceil(((u=i.rect.attribute.lineWidth[0])!==null&&u!==void 0?u:0)/2)),i.rect.setAttributes({y:i.rect.attribute.y+L,height:i.rect.attribute.height-L}))}function vm(i,t,e=!0){const n=i.table,o=t.start.col,r=t.start.row,s=t.end.col,l=t.end.row,a=t.skipBodyMerge;let h=Math.max(Math.min(s,o),0),d=Math.max(Math.min(l,r),0),u=Math.min(Math.max(s,o),n.colCount-1),c=Math.min(Math.max(l,r),n.rowCount-1);const f=()=>{let x=!1;for(let S=h;S<=u;S++){if(S===h)for(let R=d;R<=c;R++){if(!n.isHeader(S,R)&&a)continue;const B=ae(n,S,R);if(B&&B.start.col<h){h=B.start.col,x=!0;break}}if(!x&&S===u)for(let R=d;R<=c;R++){if(!n.isHeader(S,R)&&a)continue;const B=ae(n,S,R);if(B&&Math.min(B.end.col,n.colCount-1)>u){u=B.end.col,x=!0;break}}if(x)break}if(!x)for(let S=d;S<=c;S++){if(S===d)for(let R=h;R<=u;R++){if(!n.isHeader(R,S)&&a)continue;const B=ae(n,R,S);if(B&&B.start.row<d){d=B.start.row,x=!0;break}}if(!x&&S===c)for(let R=h;R<=u;R++){if(!n.isHeader(R,S)&&a)continue;const B=ae(n,R,S);if(B&&Math.min(B.end.row,n.rowCount-1)>c){c=B.end.row,x=!0;break}}if(x)break}x&&f()};e&&f(),i.selectingRangeComponents.forEach((x,S)=>{var R;x.rect.delete(),(R=x.fillhandle)===null||R===void 0||R.delete()}),i.selectingRangeComponents=new Map;let g=!1,p=!1,v=!1,m=!1,b=!1,C=!1,_=!1,w=!1,y=!1;if(h<=n.frozenColCount-1&&d<=n.frozenRowCount-1&&(C=!0),u>=n.colCount-n.rightFrozenColCount&&d<=n.frozenRowCount-1&&(_=!0),h<=n.frozenColCount-1&&c>=n.rowCount-n.bottomFrozenRowCount&&(y=!0),u>=n.colCount-n.rightFrozenColCount&&c>=n.rowCount-n.bottomFrozenRowCount&&(w=!0),h<=n.frozenColCount-1&&c>=n.frozenRowCount&&d<=n.rowCount-n.bottomFrozenRowCount-1&&(g=!0),u>=n.colCount-n.rightFrozenColCount&&c>=n.frozenRowCount&&d<=n.rowCount-n.bottomFrozenRowCount-1&&(p=!0),d<=n.frozenRowCount-1&&u>=n.frozenColCount&&h<=n.colCount-n.rightFrozenColCount-1&&(v=!0),c>=n.rowCount-n.bottomFrozenRowCount&&u>=n.frozenColCount&&h<=n.colCount-n.rightFrozenColCount-1&&(m=!0),h<=n.colCount-n.rightFrozenColCount-1&&u>=n.frozenColCount&&d<=n.rowCount-n.bottomFrozenRowCount-1&&c>=n.frozenRowCount&&(b=!0),C){const x=Math.min(u,n.frozenColCount-1),S=Math.min(c,n.frozenRowCount-1),R=[!0,!v,!g,!0];i.createCellSelectBorder(h,d,x,S,"cornerHeader",`${h}${d}${u}${c}`,R)}if(_){const x=Math.max(h,n.colCount-n.rightFrozenColCount),S=Math.min(c,n.frozenRowCount-1),R=[!0,!0,!p,!v];i.createCellSelectBorder(x,d,u,S,"rightTopCorner",`${h}${d}${u}${c}`,R)}if(y){const x=Math.min(u,n.frozenColCount-1),S=Math.max(d,n.rowCount-n.bottomFrozenRowCount),R=[!g,!m,!0,!0];i.createCellSelectBorder(h,S,x,c,"leftBottomCorner",`${h}${d}${u}${c}`,R)}if(w){const x=Math.max(h,n.colCount-n.rightFrozenColCount),S=Math.max(d,n.rowCount-n.bottomFrozenRowCount),R=[!p,!0,!0,!m];i.createCellSelectBorder(x,S,u,c,"rightBottomCorner",`${h}${d}${u}${c}`,R)}if(v){const x=Math.max(h,n.frozenColCount),S=Math.min(u,n.colCount-n.rightFrozenColCount-1),R=Math.min(c,n.frozenRowCount-1),B=[!0,!_,!b,!C];i.createCellSelectBorder(x,d,S,R,"columnHeader",`${h}${d}${u}${c}`,B)}if(m){const x=Math.max(h,n.frozenColCount),S=Math.min(u,n.colCount-n.rightFrozenColCount-1),R=Math.max(d,n.rowCount-n.bottomFrozenRowCount),B=[!b,!w,!0,!y];i.createCellSelectBorder(x,R,S,c,"bottomFrozen",`${h}${d}${u}${c}`,B)}if(g){const x=Math.max(d,n.frozenRowCount),S=Math.min(c,n.rowCount-n.bottomFrozenRowCount-1),R=Math.min(u,n.frozenColCount-1),B=[!C,!b,!y,!0];i.createCellSelectBorder(h,x,R,S,"rowHeader",`${h}${d}${u}${c}`,B)}if(p){const x=Math.max(d,n.frozenRowCount),S=Math.min(c,n.rowCount-n.bottomFrozenRowCount-1),R=Math.max(h,n.colCount-n.rightFrozenColCount),B=[!_,!0,!w,!b];i.createCellSelectBorder(R,x,u,S,"rightFrozen",`${h}${d}${u}${c}`,B)}if(b){const x=Math.max(h,n.frozenColCount),S=Math.max(d,n.frozenRowCount),R=Math.min(u,n.colCount-n.rightFrozenColCount-1),B=Math.min(c,n.rowCount-n.bottomFrozenRowCount-1),A=[!v,!p,!m,!g];i.createCellSelectBorder(x,S,R,B,"body",`${h}${d}${u}${c}`,A)}}function mm(i){i.selectingRangeComponents.forEach((t,e)=>{t.rect.setAttribute("opacity",0)}),i.selectedRangeComponents.forEach((t,e)=>{t.rect.setAttribute("opacity",0)})}function bm(i){i.selectingRangeComponents.forEach((t,e)=>{t.rect.setAttribute("opacity",1)}),i.selectedRangeComponents.forEach((t,e)=>{t.rect.setAttribute("opacity",1)})}function wE(i,t,e,n,o,r,s,l){var a,h,d,u,c,f,g,p;let v=!!(!((a=i.table.options.excelOptions)===null||a===void 0)&&a.fillHandle);if(((h=i.table.stateManager.select.ranges)===null||h===void 0?void 0:h.length)>1)v=!1,i.removeFillHandleFromSelectComponents();else if(((d=i.table.stateManager.select.ranges)===null||d===void 0?void 0:d.length)===1){const M=Math.max(i.table.stateManager.select.ranges[0].start.row,i.table.stateManager.select.ranges[0].end.row),k=Math.max(i.table.stateManager.select.ranges[0].start.col,i.table.stateManager.select.ranges[0].end.col);i.table.isHeader(k,M)&&(v=!1)}!Array.isArray(l)||l[1]!==!1&&l[2]!==!1||(v=!1);const m=Math.min(t,n),b=Math.min(e,o),C=Math.max(t,n),_=Math.max(e,o),w=i.highPerformanceGetCell(m,b).globalAABBBounds,y=i.highPerformanceGetCell(C,_).globalAABBBounds,x=i.table.theme,S=(u=x.selectionStyle)===null||u===void 0?void 0:u.cellBorderColor,R=(c=x.selectionStyle)===null||c===void 0?void 0:c.cellBorderLineWidth,B=qt({pickable:!1,fill:((f=x.selectionStyle)===null||f===void 0?void 0:f.selectionFillMode)!=="replace"&&((p=(g=x.selectionStyle)===null||g===void 0?void 0:g.cellBgColor)!==null&&p!==void 0?p:"rgba(0, 0, 255,0.1)"),lineWidth:R,stroke:l.map(M=>!!M&&S),x:w.x1-i.tableGroup.attribute.x,y:w.y1-i.tableGroup.attribute.y,width:0,height:0,visible:!0});let A;v&&(A=qt({pickable:!1,fill:S,stroke:S,x:y.x2-3,y:y.y2-3,width:6,height:6,visible:!0})),i.lastSelectId=s,i.selectingRangeComponents.set(`${m}-${b}-${C}-${_}-${s}`,{rect:B,fillhandle:A,role:r}),i.tableGroup.insertAfter(B,r==="body"?i.bodyGroup:r==="columnHeader"?i.colHeaderGroup:r==="rowHeader"?i.rowHeaderGroup:r==="cornerHeader"?i.cornerHeaderGroup:r==="rightTopCorner"?i.rightTopCornerGroup:r==="rightFrozen"?i.rightFrozenGroup:r==="leftBottomCorner"?i.leftBottomCornerGroup:r==="bottomFrozen"?i.bottomFrozenGroup:i.rightBottomCornerGroup),v&&i.tableGroup.insertAfter(A,r==="body"?i.bodyGroup:r==="columnHeader"?i.colHeaderGroup:r==="rowHeader"?i.rowHeaderGroup:r==="cornerHeader"?i.cornerHeaderGroup:r==="rightTopCorner"?i.rightTopCornerGroup:r==="rightFrozen"?i.rightFrozenGroup:r==="leftBottomCorner"?i.leftBottomCornerGroup:r==="bottomFrozen"?i.bottomFrozenGroup:i.rightBottomCornerGroup)}function Cm(i){i.selectingRangeComponents.forEach((t,e)=>{var n;i.selectedRangeComponents.get(e)&&(i.selectingRangeComponents.get(e).rect.delete(),(n=i.selectingRangeComponents.get(e).fillhandle)===null||n===void 0||n.delete()),i.selectedRangeComponents.set(e,t)}),i.selectingRangeComponents=new Map,i.updateNextFrame()}function yE(i){i.selectedRangeComponents.forEach((t,e)=>{var n;e.split("-")[4]===i.lastSelectId&&(t.rect.delete(),(n=t.fillhandle)===null||n===void 0||n.delete(),i.selectedRangeComponents.delete(e))})}function _m(i){i.selectedRangeComponents.forEach((t,e)=>{var n;t.rect.delete(),(n=t.fillhandle)===null||n===void 0||n.delete()}),i.selectedRangeComponents=new Map}function ww(i){i.selectingRangeComponents.forEach((t,e)=>{var n;t.rect.delete(),(n=t.fillhandle)===null||n===void 0||n.delete()}),i.selectingRangeComponents=new Map}function SE(i){i.selectedRangeComponents.forEach((t,e)=>{var n;(n=t.fillhandle)===null||n===void 0||n.delete(),t.fillhandle=void 0})}function xE(i,t,e,n,o){var r,s;const l=n.scenegraph,a=_s(i.map(v=>v.row)).sort((v,m)=>m-v),h=_s(t.map(v=>v.row)).sort((v,m)=>v-m),d=_s(e.map(v=>v.row)).sort((v,m)=>v-m);let u;if(d.length&&(u=au(d[0]-1,d[d.length-1]+1,l)),h.length){const v=au(h[0]-1,h[h.length-1]+1,l);u=O(u)?O(v)?Math.min(u,v):u:v}if(a.length){const v=au(a[0]-1,a[a.length-1]+1,l);u=O(u)?O(v)?Math.min(u,v):u:v}a.forEach(v=>{RE(v,l,o)});const c=n.rowHeightsMap;if(a.forEach(v=>{c.delete(v)}),a.length){BE(l);const v=lu(a[a.length-1]-1,a[0]-a.length+1,l);u=O(u)?O(v)?Math.min(u,v):u:v}let f;if(l.table._clearRowRangeHeightsMap(),h.forEach(v=>{const m=AE(v,l,o);f=f??m,c.insert(v)}),ME(l),h.length){const v=lu(h[0]-1,h[h.length-1]+1,l);u=O(u)?O(v)?Math.min(u,v):u:v}for(let v=0;v<n.colCount;v++)d.forEach(m=>{if(m<n.frozenRowCount){const b=ae(l.table,v,m);if(b)for(let C=b.start.col;C<=b.end.col;C++)for(let _=b.start.row;_<=b.end.row;_++)xi(C,_,l.table,!1);else xi(v,m,l.table,!1)}else if(m>n.rowCount-1||m<l.table.rowCount-l.table.bottomFrozenRowCount&&(m<l.proxy.rowStart||m>l.proxy.rowEnd))yw(m,l);else{const b=ae(l.table,v,m);if(b)for(let C=b.start.col;C<=b.end.col;C++)for(let _=b.start.row;_<=b.end.row;_++)xi(C,_,l.table,!1);else xi(v,m,l.table,!1)}});if(d.length){const v=lu(d[0]-1,d[d.length-1]+1,l);u=O(u)?O(v)?Math.min(u,v):u:v}if(Z(f)){for(let v=0;v<Math.max(n.colCount,(r=n.internalProps._oldColCount)!==null&&r!==void 0?r:n.colCount);v++)for(let m=f;m<Math.max(n.rowCount,(s=n.internalProps._oldRowCount)!==null&&s!==void 0?s:n.rowCount);m++){const b=l.highPerformanceGetCell(v,m,!0);b&&(b.needUpdate=!0)}u=O(u)?O(f)?Math.min(u,f):u:f}if(Z(u)&&(l.proxy.rowUpdatePos=Math.min(l.proxy.rowUpdatePos,u)),h.length){if(!Z(f)){const v=Math.min(...h);l.proxy.rowUpdatePos=Math.min(v,l.proxy.rowUpdatePos)}l.proxy.rowUpdateDirection="down",l.proxy.updateCellGroups(2*l.proxy.screenRowCount),p()}else a.length&&(TE(a[a.length-1],l),l.proxy.updateCellGroups(2*l.proxy.screenRowCount),p());l.proxy.progress();const g=n.getRowsHeight(n.frozenRowCount,n.rowCount-1-n.bottomFrozenRowCount);function p(){if((h==null?void 0:h[(h==null?void 0:h.length)-1])>=n.rowCount-n.bottomFrozenRowCount||(d==null?void 0:d[(d==null?void 0:d.length)-1])>=n.rowCount-n.bottomFrozenRowCount||(a==null?void 0:a[0])>=n.rowCount-n.bottomFrozenRowCount){for(let v=0;v<n.colCount;v++)for(let m=n.rowCount-n.bottomFrozenRowCount;m<n.rowCount;m++){const b=l.highPerformanceGetCell(v,m,!0);b&&(b.needUpdate=!0)}l.proxy.updateBottomFrozenCellGroups()}}l.updateContainerHeight(l.table.frozenRowCount,g-l.bodyGroup.attribute.height)}function RE(i,t,e){const n=t.proxy;if(i>=n.rowStart&&i<=n.rowEnd&&(yw(i,t),n.rowEnd--,n.currentRow--),!e){n.bodyBottomRow--;const o=Math.min(n.rowLimit,n.bodyBottomRow-n.bodyTopRow+1);n.totalActualBodyRowCount=o,n.totalRow=Math.min(n.table.rowCount-1,n.rowStart+o-1)}}function AE(i,t,e){const n=t.proxy;if(!e){n.bodyBottomRow++;const o=Math.min(n.rowLimit,n.bodyBottomRow-n.bodyTopRow+1);n.totalActualBodyRowCount=o,n.totalRow=n.rowStart+o-1}if(!(i<n.rowStart))return i>n.rowEnd?n.rowEnd-n.rowStart+1<n.rowLimit?(n.rowEnd++,n.currentRow++,wm(i,t),i):void 0:(n.rowEnd-n.rowStart+1<n.rowLimit&&(n.rowEnd++,n.currentRow++,wm(i,t)),i)}function BE(i){function t(e,n){e.row=n;const o=ae(i.table,e.col,e.row);o?(e.mergeStartCol=o.start.col,e.mergeEndCol=o.end.col,e.mergeStartRow=o.start.row,e.mergeEndRow=o.end.row):(e.mergeStartCol=void 0,e.mergeEndCol=void 0,e.mergeStartRow=void 0,e.mergeEndRow=void 0)}i.bodyGroup.forEachChildren(e=>{let n=i.bodyRowStart;e==null||e.forEachChildren(o=>{t(o,n),n++})}),i.rowHeaderGroup.forEachChildren(e=>{let n=i.bodyRowStart;e==null||e.forEachChildren(o=>{t(o,n),n++})}),i.rightFrozenGroup.forEachChildren(e=>{let n=i.bodyRowStart;e==null||e.forEachChildren(o=>{t(o,n),n++})}),i.bottomFrozenGroup.forEachChildren(e=>{let n=i.table.rowCount-i.table.bottomFrozenRowCount;e==null||e.forEachChildren(o=>{t(o,n),n++})}),i.leftBottomCornerGroup.forEachChildren(e=>{let n=i.table.rowCount-i.table.bottomFrozenRowCount;e==null||e.forEachChildren(o=>{t(o,n),n++})}),i.rightBottomCornerGroup.forEachChildren(e=>{let n=i.table.rowCount-i.table.bottomFrozenRowCount;e==null||e.forEachChildren(o=>{t(o,n),n++})})}function ME(i){function t(e,n,o){e.row=n,e.setAttribute("y",o);const r=ae(i.table,e.col,e.row);r?(e.mergeStartCol=r.start.col,e.mergeEndCol=r.end.col,e.mergeStartRow=r.start.row,e.mergeEndRow=r.end.row):(e.mergeStartCol=void 0,e.mergeEndCol=void 0,e.mergeStartRow=void 0,e.mergeEndRow=void 0)}i.bodyGroup.forEachChildren(e=>{let n=i.bodyRowStart,o=i.getCellGroupY(n);e==null||e.forEachChildren(r=>{t(r,n,o),n++,o+=r.attribute.height})}),i.rowHeaderGroup.forEachChildren(e=>{let n=i.bodyRowStart,o=i.getCellGroupY(n);e==null||e.forEachChildren(r=>{t(r,n,o),n++,o+=r.attribute.height})}),i.rightFrozenGroup.forEachChildren(e=>{let n=i.bodyRowStart,o=i.getCellGroupY(n);e==null||e.forEachChildren(r=>{t(r,n,o),n++,o+=r.attribute.height})}),i.bottomFrozenGroup.forEachChildren(e=>{let n=i.table.rowCount-i.table.bottomFrozenRowCount,o=0;e==null||e.forEachChildren(r=>{t(r,n,o),n++,o+=r.attribute.height})}),i.leftBottomCornerGroup.forEachChildren(e=>{let n=i.table.rowCount-i.table.bottomFrozenRowCount,o=0;e==null||e.forEachChildren(r=>{t(r,n,o),n++,o+=r.attribute.height})}),i.rightBottomCornerGroup.forEachChildren(e=>{let n=i.table.rowCount-i.table.bottomFrozenRowCount,o=0;e==null||e.forEachChildren(r=>{t(r,n,o),n++,o+=r.attribute.height})})}function wm(i,t){for(let e=0;e<t.table.colCount;e++){const n=new Tt({x:0,y:0,width:t.table.getColWidth(e),height:t.table.getRowHeight(i)});if(n.role="cell",n.col=e,n.row=i,n.needUpdate=!0,!n)continue;const o=t.getColGroup(e);if(o)if(o.firstChild&&i<o.firstChild.row)o.insertBefore(n,o.firstChild),o.firstChild.row=o.firstChild.row+1;else if(o.lastChild&&i>o.lastChild.row)o.appendChild(n);else{const r=t.highPerformanceGetCell(e,i,!0);r!==n&&(o.insertBefore(n,r),r&&(r.row=r.row+1),r!==o.lastChild&&o.lastChild&&(o.lastChild.row=o.lastChild.row+1))}}}function yw(i,t){for(let e=0;e<t.table.colCount;e++){const n=t.getColGroup(e,!1);if(!n)continue;let o;n.forEachChildren(r=>r.row===i&&(o=r,!0)),o&&(n.updateColumnHeight(-o.attribute.height),n.removeChild(o))}}function lu(i,t,e){let n;for(let o=0;o<e.table.colCount;o++){const r=e.table.getCellRange(o,i);let s;r.start.row<=i+1&&r.end.row>=i+1&&(Eh(r,e),s=r.start.row);const l=e.table.getCellRange(o,t);l.start.row<=t+1&&l.end.row>=t+1&&(Eh(l,e),s=l.start.row),O(s)&&(n=O(n)?Math.min(n,s):s)}return n}function au(i,t,e){let n;for(let o=0;o<e.table.colCount;o++){let r;const s=e.highPerformanceGetCell(o,i);s.mergeStartRow&&s.mergeEndRow&&s.mergeEndRow>i&&(Eh({start:{row:s.mergeStartRow,col:e.table.isAutoRowHeight()?0:s.mergeStartCol},end:{row:s.mergeEndRow,col:e.table.isAutoRowHeight()?e.table.colCount-1:s.mergeEndCol}},e),r=s.mergeStartRow);const l=e.highPerformanceGetCell(o,t);l.mergeStartRow&&l.mergeEndRow&&l.mergeStartRow<t&&(Eh({start:{row:l.mergeStartRow,col:e.table.isAutoRowHeight()?0:l.mergeStartCol},end:{row:l.mergeEndRow,col:e.table.isAutoRowHeight()?e.table.colCount-1:l.mergeEndCol}},e),r=l.mergeStartRow),O(r)&&(n=O(n)?Math.min(n,r):r)}return n}function Eh(i,t){const{start:e,end:n}=i;for(let o=e.col;o<=n.col;o++)for(let r=e.row;r<=n.row;r++){const s=t.highPerformanceGetCell(o,r,!0);s&&(s.needUpdate=!0)}}function TE(i,t){if(t.table.isHasSeriesNumber())for(let e=i;e<=t.table.rowCount-1;e++)xi(0,e,t.table,!1)}function PE(i){const{internalProps:t}=i;t.bodyDomContainer=document.createElement("div"),t.bodyDomContainer.id="vtable-body-dom-container",t.bodyDomContainer.classList.add("table-component-container"),t.element.appendChild(t.bodyDomContainer),t.headerDomContainer=document.createElement("div"),t.headerDomContainer.id="vtable-header-dom-container",t.headerDomContainer.classList.add("table-component-container"),t.element.appendChild(t.headerDomContainer),t.frozenBodyDomContainer=document.createElement("div"),t.frozenBodyDomContainer.id="vtable-frozen-body-dom-container",t.frozenBodyDomContainer.classList.add("table-component-container"),t.element.appendChild(t.frozenBodyDomContainer),t.frozenHeaderDomContainer=document.createElement("div"),t.frozenHeaderDomContainer.id="vtable-frozen-header-dom-container",t.frozenHeaderDomContainer.classList.add("table-component-container"),t.element.appendChild(t.frozenHeaderDomContainer),t.rightFrozenBodyDomContainer=document.createElement("div"),t.rightFrozenBodyDomContainer.id="vtable-right-frozen-body-dom-container",t.rightFrozenBodyDomContainer.classList.add("table-component-container"),t.element.appendChild(t.rightFrozenBodyDomContainer),t.rightFrozenHeaderDomContainer=document.createElement("div"),t.rightFrozenHeaderDomContainer.id="vtable-right-frozen-header-dom-container",t.rightFrozenHeaderDomContainer.classList.add("table-component-container"),t.element.appendChild(t.rightFrozenHeaderDomContainer),t.frozenBottomDomContainer=document.createElement("div"),t.frozenBottomDomContainer.id="vtable-frozen-bottom-dom-container",t.frozenBottomDomContainer.classList.add("table-component-container"),t.element.appendChild(t.frozenBottomDomContainer),t.bottomDomContainer=document.createElement("div"),t.bottomDomContainer.id="vtable-bottom-dom-container",t.bottomDomContainer.classList.add("table-component-container"),t.element.appendChild(t.bottomDomContainer),t.rightFrozenBottomDomContainer=document.createElement("div"),t.rightFrozenBottomDomContainer.id="vtable-right-frozen-bottom-dom-container",t.rightFrozenBottomDomContainer.classList.add("table-component-container"),t.element.appendChild(t.rightFrozenBottomDomContainer)}function HE(i){const{headerDomContainer:t,bodyDomContainer:e,frozenBodyDomContainer:n,frozenHeaderDomContainer:o,rightFrozenBodyDomContainer:r,rightFrozenHeaderDomContainer:s,bottomDomContainer:l,frozenBottomDomContainer:a,rightFrozenBottomDomContainer:h}=i.internalProps;if(!(t||e||n||o||r||s||l||a||h))return;const d=i.getAllColsWidth(),u=Math.min(d,i.tableNoFrameWidth),c=i.getFrozenColsWidth(),f=i.getRightFrozenColsWidth(),g=c+f,p=Math.min(d-g,u-g),v=i.getAllRowsHeight(),m=Math.min(v,i.tableNoFrameHeight),b=i.getFrozenRowsHeight(),C=i.getBottomFrozenRowsHeight(),_=b+C,w=Math.min(v-_,m-_);i.frozenColCount>0?(t.style.left=`${i.tableX+c}px`,e.style.left=`${i.tableX+c}px`,l.style.left=`${i.tableX+c}px`):i.frozenColCount===0&&(t.style.left=`${i.tableX}px`,e.style.left=`${i.tableX}px`,l.style.left=`${i.tableX}px`),n.style.left=`${i.tableX}px`,o.style.left=`${i.tableX}px`,t.style.width=`${p}px`,t.style.height=`${b}px`,e.style.top=`${i.tableY}px`,e.style.width=`${p}px`,e.style.height=`${w}px`,e.style.top=`${i.tableY+b}px`,n.style.width=`${c}px`,n.style.height=`${w}px`,n.style.top=`${i.tableY+b}px`,o.style.width=`${c}px`,o.style.height=`${b}px`,o.style.top=`${i.tableY}px`,r.style.width=`${f}px`,r.style.height=`${w}px`,r.style.top=`${i.tableY+b}px`,r.style.left=i.tableX+u-f+"px",s.style.width=`${f}px`,s.style.height=`${b}px`,s.style.top=`${i.tableY}px`,s.style.left=i.tableX+u-f+"px",l.style.width=`${p}px`,l.style.height=`${C}px`,l.style.top=i.tableY+m-C+"px",a.style.width=`${c}px`,a.style.height=`${C}px`,a.style.top=i.tableY+m-C+"px",h.style.width=`${f}px`,h.style.height=`${C}px`,h.style.top=i.tableY+m-C+"px",h.style.left=i.tableX+u-f+"px"}function Sw(i){if(!i.table.reactCustomLayout)return;const{table:t,stage:e}=i,n=e.pluginService.findPluginsByName("ReactAttributePlugin")[0],{htmlMap:o,renderId:r}=n;for(const s in o){const l=o[s],{graphic:a,wrapContainer:h,renderId:d}=l;if(d!==r)continue;let u;if(i.frozenColCount>t.frozenColCount){const c=zo(a);if(!c)continue;const{col:f,row:g}=c;g>=t.rowCount-t.bottomFrozenRowCount&&f<i.frozenColCount&&f>=t.frozenColCount&&a.attribute.react.container===t.frozenBottomDomContainer?u=t.bottomDomContainer:g>=t.frozenRowCount&&f<i.frozenColCount&&f>=t.frozenColCount&&a.attribute.react.container===t.frozenBodyDomContainer?u=t.bodyDomContainer:g<t.frozenRowCount&&f<i.frozenColCount&&f>=t.frozenColCount&&a.attribute.react.container===t.frozenHeaderDomContainer&&(u=t.headerDomContainer)}else if(i.frozenColCount<t.frozenColCount){const c=zo(a);if(!c)continue;const{col:f,row:g}=c;g>=t.rowCount-t.bottomFrozenRowCount&&f<t.frozenColCount&&f>=i.frozenColCount&&a.attribute.react.container===t.bottomDomContainer?u=t.frozenBottomDomContainer:g>=t.frozenRowCount&&f<t.frozenColCount&&f>=i.frozenColCount&&a.attribute.react.container===t.bodyDomContainer?u=t.frozenBodyDomContainer:g<t.frozenRowCount&&f<t.frozenColCount&&f>=i.frozenColCount&&a.attribute.react.container===t.headerDomContainer&&(u=t.frozenHeaderDomContainer)}u&&(u.appendChild(h),l.nativeContainer=u,l.container=u,a.attribute.react.container=u,n.updateStyleOfWrapContainer(a,e,h,u,a.attribute.react))}}function kE(i){var t,e;if(i.table.frozenColCount>i.table.rowHeaderLevelCount){i.rowHeaderGroup.setAttribute("height",i.bodyGroup.attribute.height),i.rowHeaderGroup.setAttribute("y",i.bodyGroup.attribute.y),i.cornerHeaderGroup.setAttribute("height",i.colHeaderGroup.attribute.height);for(let n=0;n<i.table.frozenColCount-i.table.rowHeaderLevelCount;n++)xw(i),Rw(i),Mw(i)}else if(i.table.frozenColCount<i.table.rowHeaderLevelCount){i.bodyGroup.setAttribute("height",i.rowHeaderGroup.attribute.height),i.bodyGroup.setAttribute("y",i.rowHeaderGroup.attribute.y),i.colHeaderGroup.setAttribute("height",i.cornerHeaderGroup.attribute.height);for(let n=0;n<i.table.rowHeaderLevelCount-i.table.frozenColCount;n++)Aw(i),Bw(i),Tw(i)}i.bodyGroup.setAttribute("x",i.rowHeaderGroup.attribute.width),i.colHeaderGroup.setAttribute("x",i.cornerHeaderGroup.attribute.width),i.updateContainer(),i.updateBorderSizeAndPosition(),i.isPivot||i.table.transpose?i.table.options.frozenColCount?i.component.setFrozenColumnShadow(i.table.frozenColCount-1):i.table.options.frozenColCount&&i.component.setRightFrozenColumnShadow(i.table.colCount-i.table.rightFrozenColCount):(i.component.setFrozenColumnShadow(i.table.frozenColCount-1),i.component.setRightFrozenColumnShadow(i.table.colCount-i.table.rightFrozenColCount)),i.hasFrozen=!0,i.frozenColCount=i.table.frozenColCount,i.frozenRowCount=(e=(t=i.colHeaderGroup.firstChild)===null||t===void 0?void 0:t.childrenCount)!==null&&e!==void 0?e:0}function EE(i){var t,e,n,o;if(i.frozenColCount>i.table.frozenColCount){i.bodyGroup.setAttribute("height",i.rowHeaderGroup.attribute.height),i.bodyGroup.setAttribute("y",i.rowHeaderGroup.attribute.y),i.colHeaderGroup.setAttribute("height",i.cornerHeaderGroup.attribute.height);for(let r=0;r<i.frozenColCount-i.table.frozenColCount;r++)Aw(i),Bw(i),Tw(i)}else if(i.frozenColCount<i.table.frozenColCount){i.rowHeaderGroup.setAttribute("height",i.bodyGroup.attribute.height),i.rowHeaderGroup.setAttribute("y",i.bodyGroup.attribute.y),i.cornerHeaderGroup.setAttribute("height",i.colHeaderGroup.attribute.height);for(let r=0;r<i.table.frozenColCount-i.frozenColCount;r++)xw(i),Rw(i),Mw(i)}Sw(i),i.recreateAllSelectRangeComponents(),i.frozenColCount=i.table.frozenColCount,i.frozenRowCount=(e=(t=i.colHeaderGroup.firstChild)===null||t===void 0?void 0:t.childrenCount)!==null&&e!==void 0?e:0,i.proxy.colStart=(o=(n=i.bodyGroup.firstChild)===null||n===void 0?void 0:n.col)!==null&&o!==void 0?o:i.table.frozenColCount,i.bodyGroup.setAttribute("x",i.rowHeaderGroup.attribute.width),i.colHeaderGroup.setAttribute("x",i.cornerHeaderGroup.attribute.width),i.updateContainer(),i.updateBorderSizeAndPosition(),i.isPivot||i.table.transpose?i.table.options.frozenColCount?i.component.setFrozenColumnShadow(i.table.frozenColCount-1):i.table.options.rightFrozenColCount&&i.component.setRightFrozenColumnShadow(i.table.colCount-i.table.rightFrozenColCount):(i.component.setFrozenColumnShadow(i.table.frozenColCount-1),i.component.setRightFrozenColumnShadow(i.table.colCount-i.table.rightFrozenColCount)),i.hasFrozen=!0}function xw(i){const t=i.bodyGroup.firstChild instanceof Tt?i.bodyGroup.firstChild:null;t&&(i.rowHeaderGroup.appendChild(t),i.rowHeaderGroup.setAttribute("width",i.rowHeaderGroup.attribute.width+t.attribute.width),i.bodyGroup.setAttribute("width",i.bodyGroup.attribute.width-t.attribute.width))}function Rw(i){const t=i.colHeaderGroup.firstChild instanceof Tt?i.colHeaderGroup.firstChild:null;t&&(i.cornerHeaderGroup.appendChild(t),i.cornerHeaderGroup.setAttribute("width",i.cornerHeaderGroup.attribute.width+t.attribute.width),i.colHeaderGroup.setAttribute("width",i.colHeaderGroup.attribute.width-t.attribute.width))}function Aw(i){var t;const e=i.rowHeaderGroup.lastChild instanceof Tt?i.rowHeaderGroup.lastChild:(t=i.rowHeaderGroup.lastChild)===null||t===void 0?void 0:t._prev;e&&(Mi(i.bodyGroup,e,i.bodyGroup.firstChild),i.bodyGroup.setAttribute("width",i.bodyGroup.attribute.width+e.attribute.width),i.rowHeaderGroup.setAttribute("width",i.rowHeaderGroup.attribute.width-e.attribute.width))}function Bw(i){var t;const e=i.cornerHeaderGroup.lastChild instanceof Tt?i.cornerHeaderGroup.lastChild:(t=i.cornerHeaderGroup.lastChild)===null||t===void 0?void 0:t._prev;e&&(Mi(i.colHeaderGroup,e,i.colHeaderGroup.firstChild),i.colHeaderGroup.setAttribute("width",i.colHeaderGroup.attribute.width+e.attribute.width),i.cornerHeaderGroup.setAttribute("width",i.cornerHeaderGroup.attribute.width-e.attribute.width))}function Mw(i){const t=i.bottomFrozenGroup.firstChild instanceof Tt?i.bottomFrozenGroup.firstChild:null;t&&(i.leftBottomCornerGroup.appendChild(t),i.leftBottomCornerGroup.setAttribute("width",i.leftBottomCornerGroup.attribute.width+t.attribute.width),i.bottomFrozenGroup.setAttribute("width",i.bottomFrozenGroup.attribute.width-t.attribute.width),i.table.isPivotChart()&&t.forEachChildren(e=>{e.setAttributes({stroke:!1,fill:!1})}))}function Tw(i){var t;const e=i.leftBottomCornerGroup.lastChild instanceof Tt?i.leftBottomCornerGroup.lastChild:(t=i.leftBottomCornerGroup.lastChild)===null||t===void 0?void 0:t._prev;e&&(Mi(i.bottomFrozenGroup,e,i.bottomFrozenGroup.firstChild),i.bottomFrozenGroup.setAttribute("width",i.bottomFrozenGroup.attribute.width+e.attribute.width),i.leftBottomCornerGroup.setAttribute("width",i.leftBottomCornerGroup.attribute.width-e.attribute.width),i.table.isPivotChart()&&e.forEachChildren(n=>{var o,r,s,l;const a=i.table._getCellStyle(n.col,n.row),h=i.table.getCellRange(n.col,n.row),d=no(a,i.table,h?h.start.col:n.col,h?h.start.row:n.row,q).theme;n.setAttributes({fill:(r=(o=d==null?void 0:d.group)===null||o===void 0?void 0:o.fill)!==null&&r!==void 0?r:void 0,stroke:(l=(s=d==null?void 0:d.group)===null||s===void 0?void 0:s.stroke)!==null&&l!==void 0?l:void 0})}))}function LE(i,t){const{table:e,proxy:n,rightTopCornerGroup:o,rightFrozenGroup:r,rightBottomCornerGroup:s,bottomFrozenGroup:l,bodyGroup:a,colHeaderGroup:h}=t,d=t.table.rightFrozenColCount;if(i>d){for(let c=e.colCount-d-1;c>=e.colCount-i;c--)Mi(r,t.getColGroup(c),r.firstChild),Mi(o,t.getColGroup(c,!0),o.firstChild),Mi(s,t.getColGroupInBottom(c),s.firstChild);let u=0;r.forEachChildren(c=>{c.setAttribute("x",u),u+=c.attribute.width}),u=0,o.forEachChildren(c=>{c.setAttribute("x",u),u+=c.attribute.width}),u=0,s.forEachChildren(c=>{c.setAttribute("x",u),u+=c.attribute.width})}else if(i<d){for(let c=e.colCount-d;c<e.colCount-i;c++){const f=t.getColGroup(c);f.setAttribute("x",a.lastChild.attribute.x+e.getColWidth(a.lastChild.col)),a.appendChild(f);const g=t.getColGroupInRightTopCorner(c);g.setAttribute("x",h.lastChild.attribute.x+e.getColWidth(h.lastChild.col)),h.appendChild(g);const p=t.getColGroupInRightBottomCorner(c);p.setAttribute("x",l.lastChild.attribute.x+e.getColWidth(l.lastChild.col)),l.appendChild(p)}let u=0;r.forEachChildren(c=>{c.setAttribute("x",u),u+=c.attribute.width}),u=0,o.forEachChildren(c=>{c.setAttribute("x",u),u+=c.attribute.width}),u=0,s.forEachChildren(c=>{c.setAttribute("x",u),u+=c.attribute.width})}r.setAttribute("width",e.getColsWidth(e.colCount-i,e.colCount-1)),o.setAttribute("width",e.getColsWidth(e.colCount-i,e.colCount-1)),s.setAttribute("width",e.getColsWidth(e.colCount-i,e.colCount-1)),e.internalProps.rightFrozenColCount=i,t.updateContainer(),t.component.updateScrollBar(),t.updateNextFrame()}function FE(i,t){const{table:e,proxy:n,bottomFrozenGroup:o,leftBottomCornerGroup:r,rightBottomCornerGroup:s}=t;o.childrenCount||(n.table.isPivotChart()||(be(r,0,0,0,e.frozenColCount-1,0,-1,"rowHeader",e),be(s,0,0,e.colCount-e.rightFrozenColCount,e.colCount-1,0,-1,"body",e)),be(o,0,0,n.colStart,n.colEnd,0,-1,"body",e));const l=t.table.bottomFrozenRowCount;if(i>l){for(let a=0;a<e.frozenColCount;a++){const h=t.getColGroupInLeftBottomCorner(a);for(let u=e.rowCount-l-1;u>=e.rowCount-i;u--)Mi(h,t.getCell(a,u,!0),h.firstChild);let d=0;h.forEachChildren(u=>{u.setAttribute("y",d),d+=e.getRowHeight(u.row)})}for(let a=n.colStart;a<=n.colEnd;a++){const h=t.getColGroupInBottom(a);for(let u=e.rowCount-l-1;u>=e.rowCount-i;u--)Mi(h,t.getCell(a,u,!0),h.firstChild);let d=0;h.forEachChildren(u=>{u.setAttribute("y",d),d+=e.getRowHeight(u.row)})}if(e.rightFrozenColCount>0)for(let a=e.colCount-e.rightFrozenColCount;a<e.colCount;a++){const h=t.getColGroupInRightBottomCorner(a);for(let u=e.rowCount-l-1;u>=e.rowCount-i;u--)Mi(h,t.getCell(a,u,!0),h.firstChild);let d=0;h.forEachChildren(u=>{u.setAttribute("y",d),d+=e.getRowHeight(u.row)})}}else if(i<l){for(let a=0;a<e.rowHeaderLevelCount;a++){const h=t.getColGroup(a);for(let c=e.rowCount-l;c<e.rowCount-i;c++){const f=t.getCell(a,c,!0);f.setAttribute("y",h.lastChild.attribute.y+e.getRowHeight(h.lastChild.row)),h.appendChild(f)}const d=t.getColGroupInLeftBottomCorner(a);let u=0;d.forEachChildren(c=>{c.setAttribute("y",u),u+=e.getRowHeight(c.row)})}for(let a=n.colStart;a<=n.colEnd;a++){const h=t.getColGroup(a);for(let c=e.rowCount-l;c<e.rowCount-i;c++){const f=t.getCell(a,c,!0);f.setAttribute("y",h.lastChild.attribute.y+e.getRowHeight(h.lastChild.row)),h.appendChild(f)}const d=t.getColGroupInBottom(a);let u=0;d.forEachChildren(c=>{c.setAttribute("y",u),u+=e.getRowHeight(c.row)})}if(e.rightFrozenColCount>0)for(let a=e.colCount-e.rightFrozenColCount;a<e.colCount;a++){const h=t.getColGroup(a);for(let c=e.rowCount-l;c<e.rowCount-i;c++){const f=t.getCell(a,c,!0);f.setAttribute("y",h.lastChild.attribute.y+e.getRowHeight(h.lastChild.row)),h.appendChild(f)}const d=t.getColGroupInRightBottomCorner(a);let u=0;d.forEachChildren(c=>{c.setAttribute("y",u),u+=e.getRowHeight(c.row)})}}o.setAttribute("height",e.getRowsHeight(e.rowCount-i,e.rowCount-1)),r.setAttribute("height",e.getRowsHeight(e.rowCount-i,e.rowCount-1)),s.setAttribute("height",e.getRowsHeight(e.rowCount-i,e.rowCount-1)),e.internalProps.bottomFrozenRowCount=i,t.updateContainer(),t.component.updateScrollBar(),t.updateNextFrame()}function Mi(i,t,e){t&&i&&(e?i.insertBefore(t,e):i.appendChild(t))}function zE(i){var t,e,n,o,r;if(i.frozenRowCount>i.table.frozenRowCount){i.bodyGroup.setAttribute("width",i.colHeaderGroup.attribute.width),i.bodyGroup.setAttribute("x",i.colHeaderGroup.attribute.x),i.rowHeaderGroup.setAttribute("width",i.cornerHeaderGroup.attribute.width);for(let s=0;s<i.frozenRowCount-i.table.frozenRowCount;s++)WE(i),NE(i),VE(i)}else if(i.frozenRowCount<i.table.frozenRowCount){i.colHeaderGroup.setAttribute("width",i.bodyGroup.attribute.width),i.colHeaderGroup.setAttribute("x",i.bodyGroup.attribute.x),i.cornerHeaderGroup.setAttribute("width",i.rowHeaderGroup.attribute.width);for(let s=0;s<i.table.frozenRowCount-i.frozenRowCount;s++)IE(i),OE(i),DE(i)}Sw(i),i.recreateAllSelectRangeComponents(),i.frozenRowCount=i.table.frozenRowCount,i.frozenColCount=(e=(t=i.rowHeaderGroup)===null||t===void 0?void 0:t.childrenCount)!==null&&e!==void 0?e:0,i.proxy.rowStart=(r=(o=(n=i.bodyGroup.firstChild)===null||n===void 0?void 0:n.firstChild)===null||o===void 0?void 0:o.row)!==null&&r!==void 0?r:i.table.frozenRowCount,i.bodyGroup.setAttribute("y",i.colHeaderGroup.attribute.height),i.rowHeaderGroup.setAttribute("y",i.cornerHeaderGroup.attribute.height),i.updateContainer(),i.updateBorderSizeAndPosition(),i.hasFrozen=!0}function IE(i){var t;let e=!1;for(let n=0;n<i.bodyGroup.childrenCount;n++){const o=i.bodyGroup.children[n].firstChild;(t=i.colHeaderGroup.children[n])===null||t===void 0||t.appendChild(o),e||(i.colHeaderGroup.setAttribute("height",i.colHeaderGroup.attribute.height+o.attribute.height),i.bodyGroup.setAttribute("height",i.bodyGroup.attribute.height-o.attribute.height),e=!0)}}function OE(i){var t;let e=!1;for(let n=0;n<i.rowHeaderGroup.childrenCount;n++){const o=i.rowHeaderGroup.children[n].firstChild;(t=i.cornerHeaderGroup.children[n])===null||t===void 0||t.appendChild(o),e||(i.cornerHeaderGroup.setAttribute("height",i.cornerHeaderGroup.attribute.height+o.attribute.height),i.rowHeaderGroup.setAttribute("height",i.rowHeaderGroup.attribute.height-o.attribute.height),e=!0)}}function DE(i){var t;let e=!1;for(let n=0;n<i.rightFrozenGroup.childrenCount;n++){const o=i.rightFrozenGroup.children[n].firstChild;(t=i.rightTopCornerGroup.children[n])===null||t===void 0||t.appendChild(o),e||(i.rightTopCornerGroup.setAttribute("height",i.rightTopCornerGroup.attribute.height+o.attribute.height),i.rightFrozenGroup.setAttribute("height",i.rightFrozenGroup.attribute.height-o.attribute.height),e=!0)}}function WE(i){let t=!1;for(let e=0;e<i.colHeaderGroup.childrenCount;e++){const n=i.colHeaderGroup.children[e].lastChild;Mi(i.bodyGroup.children[e],n,i.bodyGroup.children[e].firstChild),t||(i.colHeaderGroup.setAttribute("height",i.colHeaderGroup.attribute.height-n.attribute.height),i.bodyGroup.setAttribute("height",i.bodyGroup.attribute.height+n.attribute.height),t=!0)}}function NE(i){let t=!1;for(let e=0;e<i.cornerHeaderGroup.childrenCount;e++){const n=i.cornerHeaderGroup.children[e].lastChild;Mi(i.rowHeaderGroup.children[e],n,i.rowHeaderGroup.children[e].firstChild),t||(i.cornerHeaderGroup.setAttribute("height",i.cornerHeaderGroup.attribute.height-n.attribute.height),i.rowHeaderGroup.setAttribute("height",i.rowHeaderGroup.attribute.height+n.attribute.height),t=!0)}}function VE(i){let t=!1;for(let e=0;e<i.rightTopCornerGroup.childrenCount;e++){const n=i.rightTopCornerGroup.children[e].lastChild;Mi(i.rightFrozenGroup.children[e],n,i.rightFrozenGroup.children[e].firstChild),t||(i.rightTopCornerGroup.setAttribute("height",i.rightTopCornerGroup.attribute.height-n.attribute.height),i.rightFrozenGroup.setAttribute("height",i.rightFrozenGroup.attribute.height+n.attribute.height),t=!0)}}function GE(i,t){const{table:e}=i,n=e.internalProps.layoutMap,o=t===-1?"all":e.internalProps.columnResizeType;if(o==="column"){const r=i.getColGroup(t),s=i.getColGroup(t,!0),l=i.getColGroupInBottom(t,!0);if(r==null||r.forEachChildren(a=>{Ci(a,e.getColWidth(a.col),e.getRowHeight(a.row))}),s==null||s.forEachChildren(a=>{Ci(a,e.getColWidth(a.col),e.getRowHeight(a.row))}),l==null||l.forEachChildren(a=>{Ci(a,e.getColWidth(a.col),e.getRowHeight(a.row))}),e.widthMode==="adaptive"&&t<e.colCount-1){const a=i.getColGroup(t+1),h=i.getColGroup(t+1,!0),d=i.getColGroupInBottom(t+1,!0);a==null||a.forEachChildren(u=>{Ci(u,e.getColWidth(u.col),e.getRowHeight(u.row))}),h==null||h.forEachChildren(u=>{Ci(u,e.getColWidth(u.col),e.getRowHeight(u.row))}),d==null||d.forEachChildren(u=>{Ci(u,e.getColWidth(u.col),e.getRowHeight(u.row))})}}else{let r,s,l,a=e.rowHeaderLevelCount,h=e.colCount-1;if(o==="indicator")if(n.indicatorsAsCol)r=n.getIndicatorKey(t,e.columnHeaderLevelCount);else{const d=n.getCellHeaderPaths(t,e.columnHeaderLevelCount-1),u=d.colHeaderPaths[d.colHeaderPaths.length-1];s=u.dimensionKey,l=u.value}else if(o==="indicatorGroup"){const d=e.internalProps.layoutMap,u=d.getCellHeaderPaths(e.stateManager.columnResize.col,e.columnHeaderLevelCount),c=d.getHeadNodeByRowOrColDimensions(u.colHeaderPaths.slice(0,u.colHeaderPaths.length-1));a=c.startInTotal+e.frozenColCount,h=c.startInTotal+e.frozenColCount+c.size-1}for(let d=a;d<=h;d++){const u=i.getColGroup(d),c=i.getColGroup(d,!0),f=i.getColGroupInBottom(d,!0);if(u){if(o==="indicator"){const g=n.getIndicatorKey(d,e.columnHeaderLevelCount);if(n.indicatorsAsCol&&g!==r)continue;if(!n.indicatorsAsCol){const p=n.getCellHeaderPaths(d,e.columnHeaderLevelCount-1),v=p==null?void 0:p.colHeaderPaths[p.colHeaderPaths.length-1];if(!v||s!==v.dimensionKey||l!==v.value)continue}}u.forEachChildren(g=>{Ci(g,e.getColWidth(g.col),e.getRowHeight(g.row))}),c==null||c.forEachChildren(g=>{Ci(g,e.getColWidth(g.col),e.getRowHeight(g.row))}),f==null||f.forEachChildren(g=>{Ci(g,e.getColWidth(g.col),e.getRowHeight(g.row))})}}}}function jE(i,t){var e;const{table:n}=i,o=n.internalProps.layoutMap,r=n.stateManager,s=t===-1?"all":n.internalProps.rowResizeType;let l,a,h,d=n.columnHeaderLevelCount,u=n.rowCount-1;if(s==="indicator")if(o.indicatorsAsCol){const f=o.getCellHeaderPaths(n.rowHeaderLevelCount-1,t),g=(e=f.rowHeaderPaths)===null||e===void 0?void 0:e[f.rowHeaderPaths.length-1];a=g==null?void 0:g.dimensionKey,h=g==null?void 0:g.value}else l=o.getIndicatorKey(n.rowHeaderLevelCount,t);else if(s==="indicatorGroup"){const f=n.internalProps.layoutMap,g=f.getCellHeaderPaths(n.rowHeaderLevelCount,t),p=f.getHeadNodeByRowOrColDimensions(g.rowHeaderPaths.slice(0,g.rowHeaderPaths.length-1));d=p.startInTotal+n.frozenRowCount,u=p.startInTotal+n.frozenRowCount+p.size-1}const c=[{startCol:i.proxy.colStart,endCol:i.proxy.colEnd}];n.frozenColCount&&c.push({startCol:0,endCol:n.frozenColCount-1}),n.rightFrozenColCount&&c.push({startCol:n.colCount-n.rightFrozenColCount,endCol:n.colCount-1}),c.forEach(({startCol:f,endCol:g})=>{for(let p=f;p<=g;p++)if(s==="row"){const v=i.highPerformanceGetCell(p,t);if(v.role!=="cell")continue;if(Ci(v,n.getColWidth(v.col),n.getRowHeight(v.row)),n.heightMode==="adaptive"&&t<n.rowCount-1){const m=i.highPerformanceGetCell(p,t+1);Ci(m,n.getColWidth(m.col),n.getRowHeight(m.row))}}else for(let v=d;v<=u;v++){if(s==="indicator"){const b=o.getIndicatorKey(r.table.rowHeaderLevelCount,v);if(!o.indicatorsAsCol&&b!==l)continue;if(o.indicatorsAsCol){const C=o.getCellHeaderPaths(r.table.rowHeaderLevelCount-1,v),_=C==null?void 0:C.rowHeaderPaths[C.rowHeaderPaths.length-1];if(!_||a!==_.dimensionKey||h!==_.value)continue}}const m=i.highPerformanceGetCell(p,v);m.role==="cell"&&Ci(m,n.getColWidth(m.col),n.getRowHeight(m.row))}})}function lg(i){var t;for(let e=i.proxy.colStart;e<=i.proxy.colEnd;e++){const n=i.getColGroup(e);(t=n==null?void 0:n.getChildren())===null||t===void 0||t.forEach(o=>{o.children.forEach(r=>{r.type==="chart"&&(r.cacheCanvas=null,r.addUpdateBoundTag())})})}}function AO(i,t,e){e.getCell(i,t).children.forEach(n=>{n.type==="chart"&&(n.cacheCanvas=null,n.addUpdateBoundTag())})}function BO(i){var t;const e=i.table;for(let n=i.proxy.colStart;n<=i.proxy.colEnd;n++){const o=i.getColGroup(n);(t=o==null?void 0:o.getChildren())===null||t===void 0||t.forEach(r=>{const s=r.col,l=r.row;r.children.forEach(a=>{if(a.type==="chart"){a.updateData(e.getCellValue(s,l));const h=a.attribute.spec,d=h.type;if(d!=="gauge"&&d!=="rose"&&d!=="radar"){const u=e.internalProps.layoutMap.getChartAxes(s,l);a.setAttribute("axes",u),h.axes=u}a.setAttribute("spec",h)}})})}$l(i.rowHeaderGroup,i.table),$l(i.colHeaderGroup,i.table),$l(i.rightFrozenGroup,i.table),$l(i.bottomFrozenGroup,i.table)}function UE(i,t){const e=i.table;if(e.isPivotChart()){const n=e._selectedDataItemsInChart.length;if((t===null||(t==null?void 0:t.length)===0||Object.keys(t).length===0)&&n===0)return;const o=[];if(Array.isArray(t))t.forEach(r=>{if(r&&r.key!==0&&Object.keys(r).length>0){const s={};for(const l in r)l.startsWith("VGRAMMAR_")||l.startsWith("__VCHART")||(s[l]=r[l]);o.push(s)}});else if(t&&t.key!==0&&Object.keys(t).length>0){const r={};for(const s in t)s.startsWith("VGRAMMAR_")||s.startsWith("__VCHART")||(r[s]=t[s]);o.push(r)}mg(e._selectedDataItemsInChart,o)||(e._selectedDataItemsInChart=o,e.internalProps.layoutMap.updateDataStateToChartInstance(),lg(i),e.scenegraph.updateNextFrame())}}function $l(i,t){i.forEachChildren(e=>{e.role==="column"&&e.forEachChildren(n=>{var o;if(n.role==="cell"){let r=!1;if(n.forEachChildren(s=>s.name==="axis"&&(r=!0,!0)),r){const s=t.internalProps.layoutMap.getAxisConfigInPivotChart(n.col,n.row),l=t._getCellStyle(n.col,n.row),a=xt(q("padding",l,n.col,n.row,t)),h=new(ut.getComponent("axis"))(s,n.attribute.width,n.attribute.height,(o=s.__vtablePadding)!==null&&o!==void 0?o:a,t);n.clear(),n.appendChild(h.component),h.overlap()}}})})}function Ci(i,t,e){i.forEachChildren(n=>{n.type==="chart"&&(n.cacheCanvas=null,n.setAttributes({width:Math.ceil(t-n.attribute.cellPadding[3]-n.attribute.cellPadding[1]),height:Math.ceil(e-n.attribute.cellPadding[0]-n.attribute.cellPadding[2])}))})}function $E(i){const t=i.table.tableNoFrameWidth,e=i.table.tableNoFrameHeight;i.tableGroup=new Tt({x:0,y:0,width:t,height:e,clip:!0,pickable:!1}),i.tableGroup.role="table";const n=Xi(0,0,!i.table.options.enableTreeStickCell);n.role="col-header",i.colHeaderGroup=n;const o=Xi(0,0,!i.table.options.enableTreeStickCell);o.role="corner-header",i.cornerHeaderGroup=o;const r=Xi(0,0,!0);r.role="row-header",i.rowHeaderGroup=r;const s=Xi(t,0,!0);s.role="body",i.bodyGroup=s;const l=Xi(0,0,!0);l.role="right-frozen",i.rightFrozenGroup=l;const a=Xi(0,0,!0);a.role="bottom-frozen",i.bottomFrozenGroup=a;const h=Xi(0,0);h.role="component",i.componentGroup=h;const d=Xi(0,0,!0);d.role="corner-right-top-header",i.rightTopCornerGroup=d;const u=Xi(0,0,!0);u.role="corner-right-bottom-header",i.rightBottomCornerGroup=u;const c=Xi(0,0,!0);c.role="corner-left-bottom-header",i.leftBottomCornerGroup=c,i.tableGroup.addChild(s),i.tableGroup.addChild(r),i.tableGroup.addChild(a),i.tableGroup.addChild(n),i.tableGroup.addChild(l),i.tableGroup.addChild(u),i.tableGroup.addChild(d),i.tableGroup.addChild(c),i.tableGroup.addChild(o),i.tableGroup.addChild(h)}function Xi(i,t,e){return new Tt({x:0,y:0,width:i,height:t,clip:e!=null&&e,pickable:!1})}function fn(i,t){return i.forEachChildrenSkipChild((e,n)=>{e.setAttribute("x",t),t+=e.attribute.width}),t}function KE(i,t,e){i!==-1&&t!==-1&&(Ui(i,t,n=>n.attribute.visibleTime==="mouseenter_cell",n=>{n.setAttribute("opacity",0);const o=n.parent.getChildByName("icon-back");o&&o.setAttribute("visible",!1)},e),e.updateNextFrame())}function YE(i,t,e){i!==-1&&t!==-1&&(Ui(i,t,n=>n.attribute.visibleTime==="mouseenter_cell",n=>{n.setAttribute("opacity",1)},e),e.updateNextFrame())}function XE(i,t,e){i!==-1&&t!==-1&&(Ui(i,t,n=>n.attribute.visibleTime==="click_cell",n=>{n.setAttribute("opacity",0)},e),e.updateNextFrame())}function qE(i,t,e){i!==-1&&t!==-1&&(Ui(i,t,n=>n.attribute.visibleTime==="click_cell",n=>{n.setAttribute("opacity",1)},e),e.updateNextFrame())}function ZE(i,t,e,n,o){let r;return o.getCell(i,t).forEachChildren(s=>{s.role&&s.role.startsWith("icon")&&s.containsPoint(e,n,Ts.GLOBAL)&&(r=s)}),r}function JE(i,t,e,n,o){var r,s;if((i.attribute.backgroundColor||i.attribute.hoverImage)&&Ui(t,e,l=>l.name===i.name,l=>{var a,h,d,u,c,f,g,p;if(l.attribute.backgroundColor){let v=l.parent.getChildByName("icon-back");v?v.setAttributes({x:((a=l.attribute.x)!==null&&a!==void 0?a:0)+(l.AABBBounds.width()-l.backgroundWidth)/2,y:((h=l.attribute.y)!==null&&h!==void 0?h:0)+(l.AABBBounds.height()-l.backgroundHeight)/2,dx:(d=l.attribute.dx)!==null&&d!==void 0?d:0,dy:(u=l.attribute.dy)!==null&&u!==void 0?u:0,width:l.backgroundWidth,height:l.backgroundHeight,fill:l.attribute.backgroundColor,cornerRadius:5,visible:!0}):(v=qt({x:((c=l.attribute.x)!==null&&c!==void 0?c:0)+(l.AABBBounds.width()-l.backgroundWidth)/2,y:((f=l.attribute.y)!==null&&f!==void 0?f:0)+(l.AABBBounds.height()-l.backgroundHeight)/2,dx:(g=l.attribute.dx)!==null&&g!==void 0?g:0,dy:(p=l.attribute.dy)!==null&&p!==void 0?p:0,width:l.backgroundWidth,height:l.backgroundHeight,fill:l.attribute.backgroundColor,cornerRadius:5,pickable:!1,visible:!0}),v.name="icon-back"),l.parent.insertBefore(v,l)}l.attribute.hoverImage&&l.attribute.image!==l.attribute.hoverImage&&(l.image=l.attribute.hoverImage)},o),i.tooltip){const{x1:l,x2:a,y1:h,y2:d}=i.globalAABBBounds,u={content:i.tooltip.title,referencePosition:{rect:{left:l,right:a,top:h,bottom:d,width:i.globalAABBBounds.width(),height:i.globalAABBBounds.height()},placement:i.tooltip.placement},disappearDelay:i.tooltip.disappearDelay,style:Object.assign({},(r=o.table.internalProps.theme)===null||r===void 0?void 0:r.tooltipStyle,(s=i.tooltip)===null||s===void 0?void 0:s.style)};o.table.internalProps.tooltipHandler.isBinded(u)||o.table.showTooltip(t,e,u)}}function QE(i,t,e,n){(i.attribute.backgroundColor||i.attribute.hoverImage)&&Ui(t,e,o=>o.name===i.name,o=>{const r=o.parent.getChildByName("icon-back");r&&r.setAttribute("visible",!1),o.attribute.hoverImage&&o.attribute.image!==o.attribute.originImage&&(o.image=o.attribute.originImage)},n)}function ym(i,t,e,n,o){const r=i.name;Ui(e,n,s=>s.name===r,s=>{Si(t,s),s.name=t.name},o),o.updateNextFrame()}function tL(i,t,e,n){const o=n.getCell(i,t);if(O(o.mergeStartCol)&&O(o.mergeStartRow)&&O(o.mergeEndCol)&&O(o.mergeEndRow))for(let r=o.mergeStartCol;r<=o.mergeEndCol;r++)for(let s=o.mergeStartRow;s<=o.mergeEndRow;s++){let l;n.getCell(r,s).forEachChildren(a=>a.attribute.funcType==="sort"&&(l=a,!0)),l&&(Si(e,l),l.name=e.name)}else{let r;Xg(o,"children",s=>s.attribute.funcType==="sort"&&(r=s,!0)),r&&(Si(e,r),r.name=e.name)}}function eL(i,t,e,n,o){const r=o.getCellRange(i,t),s=o.getCellRange(e,n);return r.start.col===s.start.col&&r.start.row===s.start.row&&r.end.col===s.end.col&&r.end.row===s.end.row}function iL(i){const{col:t,row:e,iconMark:n,order:o,oldSortCol:r,oldSortRow:s,oldIconMark:l,scene:a}=i,h=a.table.internalProps.headerHelper.getSortIcon(o,a.table,t,e);if(n&&ym(n,h,t,e,a),!eL(t,e,r,s,a.table)){const d=a.table.internalProps.headerHelper.getSortIcon("normal",a.table,r,s);l?ym(l,d,r,s,a):tL(r,s,d,a)}}function nL(i){for(let t=0;t<i.table.colCount;t++)for(let e=0;e<i.table.columnHeaderLevelCount;e++)Ui(t,e,n=>n.attribute.funcType==="frozen",n=>{const o=i.table.internalProps.headerHelper.getFrozenIcon(t,e);Si(o,n),n.name=o.name},i)}function oL(i,t,e){let n;n=e.table.isHeader(i,t)?e.table.internalProps.headerHelper.getHierarchyIcon(i,t):e.table.internalProps.bodyHelper.getHierarchyIcon(i,t),Ui(i,t,o=>o.attribute.funcType===Ot.collapse||o.attribute.funcType===Ot.expand,o=>{Si(n,o),o.name=n.name},e)}function ag(i,t,e){i&&i.role!=="empty"&&i.forEachChildren(n=>{n.type==="group"?ag(n,t,e):t(n)&&e(n)})}function Ui(i,t,e,n,o){const r=o.getCell(i,t);if(r.role==="cell"&&O(r.mergeStartCol)&&O(r.mergeStartRow)&&O(r.mergeEndCol)&&O(r.mergeEndRow)){const{colStart:s,colEnd:l,rowStart:a,rowEnd:h}=oo(r,o);for(let d=s;d<=l;d++)for(let u=a;u<=h;u++)ag(o.highPerformanceGetCell(d,u),e,n)}else ag(r,e,n)}function rL(i,t,e){Ui(i,t,n=>n.attribute.funcType===Ot.dropDown,n=>{n.oldVisibleTime=n.attribute.visibleTime,n.setAttribute("visibleTime","always"),n.setAttribute("opacity",1)},e)}function sL(i,t,e){Ui(i,t,n=>n.attribute.funcType===Ot.dropDown,n=>{n.oldVisibleTime&&n.setAttribute("visibleTime",n.oldVisibleTime),n.setAttribute("opacity",n.attribute.visibleTime==="always"?1:0)},e)}function hu(i,t){const{bgColor:e,borderColor:n,borderLineWidth:o,borderLineDash:r}=t,s={x:0,y:0,width:0,height:0,visible:!1,pickable:!0,fill:e};return s.stroke=tf(n,void 0),s.lineWidth=o,r&&(s.lineDash=r),s.lineCap="butt",Array.isArray(n)&&(s.strokeArrayColor=xt(n)),Array.isArray(o)&&(s.strokeArrayWidth=xt(o),s.lineWidth=1),i.setAttributes(s),i.role="corner-frozen",i}function lL(i,t,e,n){var o,r;const s=n.scenegraph,l=du(i.map(g=>g.col)).sort((g,p)=>p-g),a=du(t.map(g=>g.col)).sort((g,p)=>g-p),h=du(e.map(g=>g.col)).sort((g,p)=>g-p);l.forEach(g=>{aL(g,s)});const d=n.colWidthsMap;let u;if(l.forEach(g=>{d.delAndReorder(g)}),l.length&&Sm(s),s.table._clearColRangeWidthsMap(),a.forEach(g=>{const p=hL(g,s);Sm(s),u=u??p,d.addAndReorder(g)}),dL(s),h.forEach(g=>{for(let p=0;p<n.rowCount;p++){const v=ae(s.table,g,p);if(v)for(let m=v.start.col;m<=v.end.col;m++)for(let b=v.start.col;b<=v.end.col;b++)xi(b,p,s.table,!1);else xi(g,p,s.table,!1)}}),Z(u)){for(let g=u;g<Math.max(n.colCount,(o=n.internalProps._oldColCount)!==null&&o!==void 0?o:n.colCount);g++)for(let p=0;p<Math.max(n.rowCount,(r=n.internalProps._oldRowCount)!==null&&r!==void 0?r:n.rowCount);p++){const v=s.highPerformanceGetCell(g,p,!0);v&&(v.needUpdate=!0)}s.proxy.colUpdatePos=u}if(a.length){if(!Z(u)){const g=Math.min(...a);s.proxy.colUpdatePos=g}s.proxy.colUpdateDirection="left",s.proxy.updateColGroups(2*s.proxy.screenColCount),f(),s.proxy.progress()}else l.length&&(s.proxy.updateColGroups(2*s.proxy.screenColCount),f(),s.proxy.progress());const c=n.getColsWidth(n.frozenColCount,n.colCount-1);function f(){if((a==null?void 0:a[(a==null?void 0:a.length)-1])>=n.colCount-n.rightFrozenColCount||(h==null?void 0:h[(h==null?void 0:h.length)-1])>=n.colCount-n.rightFrozenColCount||(l==null?void 0:l[0])>=n.colCount-n.rightFrozenColCount){for(let g=n.colCount-n.rightFrozenColCount;g<n.colCount;g++)for(let p=0;p<n.rowCount;p++){const v=s.highPerformanceGetCell(g,p,!0);v&&(v.needUpdate=!0)}s.proxy.updateRightFrozenCellGroups()}}s.updateContainerWidth(s.table.frozenColCount,c-s.bodyGroup.attribute.width)}function aL(i,t){const e=t.proxy;if(i>=t.table.rowHeaderLevelCount&&!(i>=t.table.colCount-t.table.rightFrozenColCount)){const o=t.getColGroup(i,!1);o&&o.parent===t.bodyGroup&&t.bodyGroup.removeChild(o);const r=t.getColGroupInBottom(i);r&&r.parent===t.bottomFrozenGroup&&t.bottomFrozenGroup.removeChild(r);const s=t.getColGroup(i,!0);s&&s.parent===t.colHeaderGroup&&t.colHeaderGroup.removeChild(s)}i>=e.colStart&&i<=e.colEnd&&(e.colEnd--,e.currentCol--),e.bodyRightCol--;const n=Math.min(e.colLimit,e.bodyRightCol-e.bodyLeftCol+1);e.totalActualBodyColCount=n,e.totalCol=e.colStart+n-1}function hL(i,t){const e=t.proxy;e.bodyRightCol++;const n=Math.min(e.colLimit,e.bodyRightCol-e.bodyLeftCol+1);if(e.totalActualBodyColCount=n,e.totalCol=e.colStart+n-1,!(i<e.colStart))return i>e.colEnd?e.colEnd-e.colStart+1<e.colLimit?(e.colEnd++,e.currentCol++,xm(i,t),i):void 0:(e.colEnd-e.colStart+1<e.colLimit&&(e.colEnd++,e.currentCol++,xm(i,t)),i)}function du(i){const t=[];for(let e=0;e<i.length;e++)t.indexOf(i[e])===-1&&t.push(i[e]);return t}function Sm(i){let t=i.bodyColStart;function e(n){n.col=t;const o=ae(i.table,n.col,n.row);o&&(n.mergeStartCol=o.start.col,n.mergeStartCol=o.start.col,n.mergeEndCol=o.end.col,n.mergeEndCol=o.end.col),n.role}i.bodyGroup.forEachChildren(n=>{n.col=t,n==null||n.forEachChildren(o=>{e(o)}),t++}),t=i.bodyColStart,i.colHeaderGroup.forEachChildren(n=>{n.col=t,n==null||n.forEachChildren(o=>{e(o)}),t++}),t=i.bodyColStart,i.bottomFrozenGroup.forEachChildren(n=>{n.col=t,n==null||n.forEachChildren(o=>{e(o)}),t++})}function dL(i){let t=i.bodyColStart,e=i.getCellGroupX(t);function n(o){o.col=t;const r=ae(i.table,o.col,o.row);r&&(o.mergeStartCol=r.start.col,o.mergeStartCol=r.start.col,o.mergeEndCol=r.end.col,o.mergeEndCol=r.end.col),o.role}i.bodyGroup.forEachChildren(o=>{o.col=t,o==null||o.forEachChildren(r=>{n(r)}),o.setAttribute("x",e),e+=o.attribute.width,t++}),t=i.bodyColStart,e=i.getCellGroupX(t),i.colHeaderGroup.forEachChildren(o=>{o.col=t,o==null||o.forEachChildren(r=>{n(r)}),o.setAttribute("x",e),e+=o.attribute.width,t++}),t=i.bodyColStart,e=i.getCellGroupX(t),i.bottomFrozenGroup.forEachChildren(o=>{o.col=t,o==null||o.forEachChildren(r=>{n(r)}),o.setAttribute("x",e),e+=o.attribute.width,t++}),t=i.table.colCount-i.table.rightFrozenColCount,e=0,i.rightFrozenGroup.forEachChildren(o=>{o.col=t,o==null||o.forEachChildren(r=>{n(r)}),o.setAttribute("x",e),e+=o.attribute.width,t++}),t=i.table.colCount-i.table.rightFrozenColCount,e=0,i.rightTopCornerGroup.forEachChildren(o=>{o.col=t,o==null||o.forEachChildren(r=>{n(r)}),o.setAttribute("x",e),e+=o.attribute.width,t++}),t=i.table.colCount-i.table.rightFrozenColCount,e=0,i.rightBottomCornerGroup.forEachChildren(o=>{o.col=t,o==null||o.forEachChildren(r=>{n(r)}),o.setAttribute("x",e),e+=o.attribute.width,t++})}function xm(i,t){if(t.colHeaderGroup&&t.table.columnHeaderLevelCount>0){const n=new Tt({x:0,y:0,width:t.table.getColWidth(i),height:0,clip:!1,pickable:!1});n.role="column",n.col=i;const o=t.getColGroup(i,!0);o?t.colHeaderGroup.insertBefore(n,o):t.colHeaderGroup.appendChild(n),e(n,i,0,t.table.columnHeaderLevelCount-1)}if(t.bodyGroup){const n=new Tt({x:0,y:0,width:t.table.getColWidth(i),height:0,clip:!1,pickable:!1});n.role="column",n.col=i;const o=t.getColGroup(i,!1);o?t.bodyGroup.insertBefore(n,o):t.bodyGroup.appendChild(n),e(n,i,t.bodyRowStart,t.bodyRowEnd)}if(t.bottomFrozenGroup&&t.table.bottomFrozenRowCount>0){const n=new Tt({x:0,y:0,width:t.table.getColWidth(i),height:0,clip:!1,pickable:!1});n.role="column",n.col=i;const o=t.getColGroupInBottom(i);o?t.bottomFrozenGroup.insertBefore(n,o):t.bottomFrozenGroup.appendChild(n),e(n,i,t.table.rowCount-t.table.bottomFrozenRowCount,t.table.rowCount-1)}function e(n,o,r,s){for(let l=r;l<=s;l++){const a=new Tt({x:0,y:0,width:t.table.getColWidth(o),height:t.table.getRowHeight(l)});a.role="cell",a.col=o,a.row=l,a.needUpdate=!0,n.appendChild(a)}}}function uL(i){var t,e,n,o;if(!i.options.animationAppear)return;let r,s,l,a;i.options.animationAppear===!0?(r=500,s=0,l="one-by-one",a="column"):(r=(t=i.options.animationAppear.duration)!==null&&t!==void 0?t:500,s=(e=i.options.animationAppear.delay)!==null&&e!==void 0?e:0,l=(n=i.options.animationAppear.type)!==null&&n!==void 0?n:"one-by-one",a=(o=i.options.animationAppear.direction)!==null&&o!==void 0?o:"row");const{scenegraph:h,frozenColCount:d,frozenRowCount:u}=i,{colStart:c,colEnd:f,rowStart:g,rowEnd:p}=h.proxy;for(let v=0;v<=f;v++)for(let m=0;m<=p;m++){const b=h.highPerformanceGetCell(v,m);b&&b.role==="cell"&&b.forEachChildren(C=>{C.setAttribute("opacity",0),C.animate().wait(l==="one-by-one"?(a==="row"?m:v)*(r-s):s).to({opacity:1},r,"linear")})}}function cL(i,t){const{selectedRangeComponents:e}=t;e.forEach((n,o)=>{n.rect.setAttributes(i)}),t.updateNextFrame()}x_(),bt.load(qk),bt.load(mk);class gL{constructor(t){let e,n;this._needUpdateContainer=!1,this.table=t,this.hasFrozen=!1,this.clear=!0,this.mergeMap=new Map,jT(this.table.theme.textPopTipStyle),Bt.mode==="node"?(Qt.setEnv("node",t.options.modeParams),e=t.canvasWidth,n=t.canvasHeight):t.options.canvas&&t.options.viewBox?(Qt.setEnv("browser"),e=t.options.viewBox.x2-t.options.viewBox.x1,n=t.options.viewBox.y2-t.options.viewBox.y1):(Qt.setEnv("browser"),e=t.canvas.width,n=t.canvas.height),this.stage=nB(Object.assign({canvas:t.canvas,width:e,height:n,disableDirtyBounds:!1,background:t.theme.underlayBackgroundColor,dpr:t.internalProps.pixelRatio,enableLayout:!0,beforeRender:o=>{this.table.options.beforeRender&&this.table.options.beforeRender(o),this.table.animationManager.ticker.start()},afterRender:o=>{this.table.options.afterRender&&this.table.options.afterRender(o),this.table.fireListeners("after_render",null)},canvasControled:!t.options.canvas,viewBox:t.options.viewBox},t.options.renderOption)),this.stage.defaultLayer.setTheme({group:{boundsPadding:0,strokeBoundsBuffer:0,lineJoin:"round"},text:{ignoreBuf:!0}}),this.initSceneGraph(),this.stage.defaultLayer.add(this.tableGroup),this.stage.table=this.table,this.createComponent()}get width(){var t,e;return(e=(t=this.tableGroup.attribute)===null||t===void 0?void 0:t.width)!==null&&e!==void 0?e:0}get height(){var t,e;return(e=(t=this.tableGroup.attribute)===null||t===void 0?void 0:t.height)!==null&&e!==void 0?e:0}get x(){var t,e;return(e=(t=this.tableGroup.attribute)===null||t===void 0?void 0:t.x)!==null&&e!==void 0?e:0}get y(){var t,e;return(e=(t=this.tableGroup.attribute)===null||t===void 0?void 0:t.y)!==null&&e!==void 0?e:0}get bodyRowStart(){var t;return(t=this.proxy.rowStart)!==null&&t!==void 0?t:0}get bodyRowEnd(){var t;return(t=this.proxy.rowEnd)!==null&&t!==void 0?t:this.table.rowCount-1}get bodyColStart(){var t;return(t=this.proxy.colStart)!==null&&t!==void 0?t:0}get bodyColEnd(){var t;return(t=this.proxy.colEnd)!==null&&t!==void 0?t:this.table.colCount-1}initSceneGraph(){this.isPivot=this.table.isPivotTable(),$E(this)}clearCells(){var t,e;this.table.animationManager.clear(),(this.table.isPivotChart()||this.table._hasCustomRenderOrLayout())&&this.stage.pluginService.findPluginsByName("poptipForText").forEach(n=>{n.deactivate(this.stage.pluginService)}),this.clear=!0,this.hasFrozen=!1,this.mergeMap.clear(),this.colHeaderGroup.clear(),delete this.colHeaderGroup.border,this.rowHeaderGroup.clear(),delete this.rowHeaderGroup.border,this.cornerHeaderGroup.clear(),delete this.cornerHeaderGroup.border,this.bodyGroup.clear(),delete this.bodyGroup.border,this.bottomFrozenGroup.clear(),delete this.bottomFrozenGroup.border,this.rightFrozenGroup.clear(),delete this.rightFrozenGroup.border,this.rightTopCornerGroup.clear(),delete this.rightTopCornerGroup.border,this.rightBottomCornerGroup.clear(),delete this.rightBottomCornerGroup.border,this.leftBottomCornerGroup.clear(),delete this.leftBottomCornerGroup.border,this.colHeaderGroup.setAttributes({x:0,y:0,width:0,height:0}),this.rowHeaderGroup.setAttributes({x:0,y:0,width:0,height:0}),this.cornerHeaderGroup.setAttributes({x:0,y:0,width:0,height:0}),this.bodyGroup.setAttributes({x:0,y:0,width:0,height:0}),this.rightFrozenGroup.setAttributes({x:0,y:0,width:0,height:0}),this.bottomFrozenGroup.setAttributes({x:0,y:0,width:0,height:0}),this.rightTopCornerGroup.setAttributes({x:0,y:0,width:0,height:0,visible:!1}),this.leftBottomCornerGroup.setAttributes({x:0,y:0,width:0,height:0,visible:!1}),this.rightBottomCornerGroup.setAttributes({x:0,y:0,width:0,height:0,visible:!1}),this.tableGroup.setAttributes({x:this.table.tableX,y:this.table.tableY,width:0,height:0}),this.tableGroup.border&&(this.tableGroup.parent.removeChild(this.tableGroup.border),delete this.tableGroup.border),(t=this.proxy)===null||t===void 0||t.release(),(e=this.table.reactCustomLayout)===null||e===void 0||e.clearCache()}updateStageBackground(){this.stage.background=this.table.theme.underlayBackgroundColor,this.stage.renderNextFrame()}createComponent(){this.component=new Ek(this.table),this.component.addToGroup(this.componentGroup),this.selectedRangeComponents=new Map,this.selectingRangeComponents=new Map,this.customSelectedRangeComponents=new Map}updateComponent(){this.component.updateStyle()}createSceneGraph(t=!1){t||(this.table.rowHeightsMap.clear(),this.table.internalProps.layoutMap.clearCellRangeMap()),(this.table.isPivotChart()||this.table._hasCustomRenderOrLayout())&&this.stage.pluginService.autoEnablePlugins.getContributions().forEach(e=>{e.name==="poptipForText"&&this.stage.pluginService.register(e)}),this.clear=!1,this.frozenColCount=this.table.frozenColCount,this.frozenRowCount=this.table.frozenRowCount,this.proxy=new CE(this.table),Hi(this.tableGroup,this.table.theme.frameStyle,this.tableGroup.role,void 0,!0),this.table.isPivotChart()&&(hu(this.rightTopCornerGroup,this.table.theme.cornerRightTopCellStyle||this.table.theme.cornerHeaderStyle||{}),hu(this.leftBottomCornerGroup,this.table.theme.cornerLeftBottomCellStyle||this.table.theme.cornerHeaderStyle||{}),hu(this.rightBottomCornerGroup,this.table.theme.cornerRightBottomCellStyle||this.table.theme.cornerHeaderStyle||{})),this.proxy.createGroupForFirstScreen(this.cornerHeaderGroup,this.colHeaderGroup,this.rowHeaderGroup,this.rightFrozenGroup,this.bottomFrozenGroup,this.bodyGroup,0,0),this.afterScenegraphCreated()}renderSceneGraph(){this.stage.render()}getCell(t,e,n){var o,r,s,l,a,h;let d;if(d=this.table.rightFrozenColCount>0&&t>=this.table.colCount-this.table.rightFrozenColCount&&e<this.table.frozenRowCount?(o=this.rightTopCornerGroup.getColGroup(t))===null||o===void 0?void 0:o.getRowGroup(e):this.table.bottomFrozenRowCount>0&&e>=this.table.rowCount-this.table.bottomFrozenRowCount&&t<this.table.frozenColCount?(r=this.leftBottomCornerGroup.getColGroup(t))===null||r===void 0?void 0:r.getRowGroup(e):this.table.rightFrozenColCount>0&&this.table.bottomFrozenRowCount>0&&t>=this.table.colCount-this.table.rightFrozenColCount&&e>=this.table.rowCount-this.table.bottomFrozenRowCount?(s=this.rightBottomCornerGroup.getColGroup(t))===null||s===void 0?void 0:s.getRowGroup(e):this.table.rightFrozenColCount>0&&t>this.table.colCount-1-this.table.rightFrozenColCount?(l=this.rightFrozenGroup.getColGroup(t))===null||l===void 0?void 0:l.getRowGroup(e):this.table.bottomFrozenRowCount>0&&e>this.table.rowCount-1-this.table.bottomFrozenRowCount?(a=this.bottomFrozenGroup.getColGroup(t))===null||a===void 0?void 0:a.getRowGroup(e):(h=this.getColGroup(t,e<this.frozenRowCount))===null||h===void 0?void 0:h.getRowGroup(e),d&&d.role==="shadow-cell"&&!n){const u=this.table.getCellRange(t,e);u.start.col===t&&u.start.row===e||(d=this.getCell(u.start.col,u.start.row))}return d||kh}highPerformanceGetCell(t,e,n){return this.proxy.highPerformanceGetCell(t,e,n)}getColGroup(t,e=!1){let n;return n=t<this.frozenColCount&&e?this.cornerHeaderGroup.getColGroup(t):t<this.frozenColCount?this.rowHeaderGroup.getColGroup(t):e&&this.table.rightFrozenColCount>0&&t>this.table.colCount-1-this.table.rightFrozenColCount?this.rightTopCornerGroup.getColGroup(t):!e&&this.table.rightFrozenColCount>0&&t>this.table.colCount-1-this.table.rightFrozenColCount?this.rightFrozenGroup.getColGroup(t):e?this.colHeaderGroup.getColGroup(t):this.bodyGroup.getColGroup(t),n||void 0}getColGroupInBottom(t,e=!1){var n;if(e){const o=(n=this.getColGroupInLeftBottomCorner(t))!==null&&n!==void 0?n:this.getColGroupInRightBottomCorner(t);if(o)return o}if(this.table.bottomFrozenRowCount>0)return this.bottomFrozenGroup.getColGroup(t)}getColGroupInLeftBottomCorner(t){if(this.table.bottomFrozenRowCount>0)return this.leftBottomCornerGroup.getColGroup(t)}getColGroupInRightTopCorner(t){if(this.table.rightFrozenColCount>0)return this.rightTopCornerGroup.getColGroup(t)}getColGroupInRightBottomCorner(t){if(this.table.rightFrozenColCount>0&&this.table.bottomFrozenRowCount>0)return this.rightBottomCornerGroup.getColGroup(t)}getCellSize(t,e){const n=this.getCell(t,e),o=ae(this.table,t,e);let r=n.attribute.width,s=n.attribute.height;return o&&(r/=o.end.col-o.start.col+1,s/=o.end.row-o.start.row+1),{width:r,height:s}}updateNextFrame(){this.updateContainerSync(),this.resetAllSelectComponent(),this.stage.renderNextFrame()}resetAllSelectComponent(){var t,e,n,o;(((e=(t=this.table.stateManager.select)===null||t===void 0?void 0:t.ranges)===null||e===void 0?void 0:e.length)>0||((o=(n=this.table.stateManager.select)===null||n===void 0?void 0:n.customSelectRanges)===null||o===void 0?void 0:o.length)>0)&&_w(this)}hideHoverIcon(t,e){KE(t,e,this)}showHoverIcon(t,e){YE(t,e,this)}hideClickIcon(t,e){XE(t,e,this)}showClickIcon(t,e){qE(t,e,this)}getIcon(t,e,n,o){return ZE(t,e,n,o,this)}setIconHoverStyle(t,e,n,o){JE(t,e,n,o,this)}updateSortIcon(t){const{col:e,row:n,iconMark:o,order:r,oldSortCol:s,oldSortRow:l,oldIconMark:a}=t;iL({col:e,row:n,iconMark:o,order:r,oldSortCol:s,oldSortRow:l,oldIconMark:a,scene:this})}updateFrozenIcon(t,e){nL(this)}updateHierarchyIcon(t,e){oL(t,e,this)}setIconNormalStyle(t,e,n){QE(t,e,n,this)}residentHoverIcon(t,e){rL(t,e,this)}resetResidentHoverIcon(t,e){sL(t,e,this)}deactivateChart(t,e){var n,o;if(t===-1||e===-1)return;const r=this.getCell(t,e);(o=(n=r==null?void 0:r.firstChild)===null||n===void 0?void 0:n.deactivate)===null||o===void 0||o.call(n)}activateChart(t,e){var n,o,r;if(t===-1||e===-1)return;const s=this.getCell(t,e);return(o=(n=s==null?void 0:s.firstChild)===null||n===void 0?void 0:n.activate)===null||o===void 0||o.call(n,this.table),(r=s==null?void 0:s.firstChild)===null||r===void 0?void 0:r.activeChartInstance}removeInteractionBorder(t,e){const n=this.getCell(t,e);n.setAttribute("highlightStroke",void 0),n.setAttribute("highlightStrokeArrayWidth",void 0),n.setAttribute("highlightStrokeArrayColor",void 0)}createCellSelectBorder(t,e,n,o,r,s,l){wE(this,t,e,n,o,r,s,l)}moveSelectingRangeComponentsToSelectedRangeComponents(){Cm(this)}deleteLastSelectedRangeComponents(){yE(this)}deleteAllSelectBorder(){_m(this),ww(this)}updateCellSelectBorder(t,e=!0){vm(this,t,e)}removeFillHandleFromSelectComponents(){SE(this)}recreateAllSelectRangeComponents(){_m(this),this.table.stateManager.select.ranges.forEach(t=>{vm(this,t),Cm(this)})}updateColWidth(t,e,n,o){Mk(this,t,Math.round(e),o),n||this.updateContainer(!0)}updateChartSizeForResizeColWidth(t){GE(this,t)}updateChartSizeForResizeRowHeight(t){jE(this,t)}updateChartState(t){this.table.isPivotChart()&&UE(this,t)}updateCheckboxCellState(t,e,n){var o,r;if(this.table.transpose)(o=this.bodyGroup.children)===null||o===void 0||o.forEach(s=>{var l;(l=s.getChildAt(e))===null||l===void 0||l.getChildren().forEach(a=>{a.name==="checkbox"&&(n==="indeterminate"?(a.setAttribute("indeterminate",!0),a.setAttribute("checked",void 0)):(a.setAttribute("indeterminate",void 0),a.setAttribute("checked",n)))})});else{const s=this.getColGroup(t);(r=s==null?void 0:s.children)===null||r===void 0||r.forEach(l=>{l.getChildren().find(a=>{a.name==="checkbox"&&(n==="indeterminate"?(a.setAttribute("indeterminate",!0),a.setAttribute("checked",void 0)):(a.setAttribute("indeterminate",void 0),a.setAttribute("checked",n)))})})}}updateHeaderCheckboxCellState(t,e,n){var o,r;this.table.transpose?(o=this.rowHeaderGroup.children)===null||o===void 0||o.forEach(s=>{s.getChildAt(e).getChildren().forEach(l=>{l.name==="checkbox"&&(n==="indeterminate"?(l.setAttribute("indeterminate",!0),l.setAttribute("checked",void 0)):(l.setAttribute("indeterminate",void 0),l.setAttribute("checked",n)))})}):(r=this.getColGroup(t,!0).children)===null||r===void 0||r.forEach(s=>{s.getChildren().find(l=>{l.name==="checkbox"&&(n==="indeterminate"?(l.setAttribute("indeterminate",!0),l.setAttribute("checked",void 0)):(l.setAttribute("indeterminate",void 0),l.setAttribute("checked",n)))})})}updateAutoColWidth(t){this.table.internalProps._widthResizedColMap.delete(t);const e=this.table.getColWidth(t),n=br(t,0,this.table.rowCount-1,this.table,!0);n!==e&&this.updateColWidth(t,n-e)}recalculateColWidths(){const t=this.table;t.widthMode==="adaptive"||t.autoFillWidth||t.internalProps.transpose?Ai(this.table,0,this.table.colCount-1,!0):(t._clearColRangeWidthsMap(),t.frozenColCount>0&&Ai(this.table,0,t.frozenColCount-1,!0),t.rightFrozenColCount>0&&Ai(this.table,t.rightFrozenColCount,t.colCount-1,!0),Ai(t,this.proxy.colStart,this.proxy.colEnd,!0))}recalculateRowHeights(){const t=this.table;t.internalProps.useOneRowHeightFillAll=!1,t.heightMode==="adaptive"||t.autoFillHeight?Ri(this.table,0,this.table.rowCount-1,!0,!0):(t.frozenRowCount>0&&Ri(this.table,0,t.frozenRowCount-1,!0,!0),t.bottomFrozenRowCount>0&&Ri(this.table,t.bottomFrozenRowCount,t.rowCount-1,!0,!0),Ri(t,this.proxy.rowStart,this.proxy.rowEnd,!0,!0))}resize(){this.proxy.resize(),(this.table.widthMode==="adaptive"||this.table.autoFillWidth)&&(this.table.internalProps._widthResizedColMap.size===0?this.recalculateColWidths():this.dealWidthMode()),this.table.heightMode==="adaptive"?this.table.internalProps._heightResizedRowMap.size===0?this.recalculateRowHeights():this.dealHeightMode():this.table.autoFillHeight&&this.dealHeightMode(),this.resetFrozen(),this.updateTableSize(),this.updateBorderSizeAndPosition(),this.component.updateScrollBar(),(this.table.widthMode==="adaptive"||this.table.heightMode==="adaptive"||this.table.autoFillWidth||this.table.autoFillHeight)&&this.updateChartSizeForResizeColWidth(-1),this.proxy.progress(),this.updateNextFrame()}updateTableSize(){var t,e,n,o,r,s,l,a,h,d,u,c,f;if(this.tableGroup.setAttributes({x:this.table.tableX,y:this.table.tableY,width:Math.min(this.table.tableNoFrameWidth,Math.max(this.colHeaderGroup.attribute.width,this.bodyGroup.attribute.width,this.bottomFrozenGroup.attribute.width,0)+Math.max(this.cornerHeaderGroup.attribute.width,this.rowHeaderGroup.attribute.width,this.leftBottomCornerGroup.attribute.width,0)+Math.max(this.rightTopCornerGroup.attribute.width,this.rightFrozenGroup.attribute.width,this.rightBottomCornerGroup.attribute.width,0)),height:Math.min(this.table.tableNoFrameHeight,Math.max(this.colHeaderGroup.attribute.height,this.cornerHeaderGroup.attribute.height,this.rightTopCornerGroup.attribute.height,0)+Math.max(this.rowHeaderGroup.attribute.height,this.bodyGroup.attribute.height,this.rightFrozenGroup.attribute.height,0)+Math.max(this.leftBottomCornerGroup.attribute.height,this.bottomFrozenGroup.attribute.height,this.rightBottomCornerGroup.attribute.height,0))}),this.tableGroup.border){const g=(t=this.tableGroup.border)===null||t===void 0?void 0:t.attribute;let p,v,m,b;g!=null&&g.strokeArrayWidth?(p=g.strokeArrayWidth?g.strokeArrayWidth[0]:(e=g.lineWidth)!==null&&e!==void 0?e:0,v=g.strokeArrayWidth?g.strokeArrayWidth[1]:(n=g.lineWidth)!==null&&n!==void 0?n:0,m=g.strokeArrayWidth?g.strokeArrayWidth[2]:(o=g.lineWidth)!==null&&o!==void 0?o:0,b=g.strokeArrayWidth?g.strokeArrayWidth[3]:(r=g.lineWidth)!==null&&r!==void 0?r:0):(p=(s=g==null?void 0:g.lineWidth)!==null&&s!==void 0?s:0,v=(l=g==null?void 0:g.lineWidth)!==null&&l!==void 0?l:0,m=(a=g==null?void 0:g.lineWidth)!==null&&a!==void 0?a:0,b=(h=g==null?void 0:g.lineWidth)!==null&&h!==void 0?h:0),this.tableGroup.border.type==="rect"?!((d=this.table.theme.frameStyle)===null||d===void 0)&&d.innerBorder?this.tableGroup.border.setAttributes({x:this.table.tableX+b/2,y:this.table.tableY+p/2,width:this.tableGroup.attribute.width-b/2-v/2,height:this.tableGroup.attribute.height-p/2-m/2}):this.tableGroup.border.setAttributes({x:this.table.tableX-b/2,y:this.table.tableY-p/2,width:this.tableGroup.attribute.width+b/2+v/2,height:this.tableGroup.attribute.height+p/2+m/2}):this.tableGroup.border.type==="group"&&(!((u=this.table.theme.frameStyle)===null||u===void 0)&&u.innerBorder?(this.tableGroup.border.setAttributes({x:this.table.tableX+b/2,y:this.table.tableY+p/2,width:this.tableGroup.attribute.width-b/2-v/2,height:this.tableGroup.attribute.height-p/2-m/2}),(c=this.tableGroup.border.firstChild)===null||c===void 0||c.setAttributes({x:0,y:0,width:this.tableGroup.attribute.width-b/2-v/2,height:this.tableGroup.attribute.height-p/2-m/2})):(this.tableGroup.border.setAttributes({x:this.table.tableX-b/2,y:this.table.tableY-p/2,width:this.tableGroup.attribute.width+b/2+v/2,height:this.tableGroup.attribute.height+p/2+m/2}),(f=this.tableGroup.border.firstChild)===null||f===void 0||f.setAttributes({x:b/2,y:p/2,width:this.tableGroup.attribute.width,height:this.tableGroup.attribute.height})))}this.table.bottomFrozenRowCount>0&&(this.bottomFrozenGroup.setAttribute("y",this.tableGroup.attribute.height-this.table.getBottomFrozenRowsHeight()),this.leftBottomCornerGroup.setAttributes({visible:!0,y:this.tableGroup.attribute.height-this.table.getBottomFrozenRowsHeight(),height:this.table.getBottomFrozenRowsHeight(),width:this.table.getFrozenColsWidth()}),this.rightBottomCornerGroup.setAttributes({visible:!0,y:this.tableGroup.attribute.height-this.table.getBottomFrozenRowsHeight(),height:this.table.getBottomFrozenRowsHeight()})),this.table.rightFrozenColCount>0&&(this.rightFrozenGroup.setAttribute("x",this.tableGroup.attribute.width-this.table.getRightFrozenColsWidth()),this.rightTopCornerGroup.setAttributes({visible:!0,x:this.tableGroup.attribute.width-this.table.getRightFrozenColsWidth(),width:this.table.getRightFrozenColsWidth(),height:this.table.getFrozenRowsHeight()}),this.rightBottomCornerGroup.setAttributes({visible:!0,x:this.tableGroup.attribute.width-this.table.getRightFrozenColsWidth(),width:this.table.getRightFrozenColsWidth()})),this.updateDomContainer()}updateRowHeight(t,e,n){e=Math.round(e),Xv(this,t,e,n),this.updateContainerHeight(t,e)}updateRowsHeight(t,e,n){for(let o=0;o<t.length;o++){const r=t[o];if(r>=this.proxy.rowStart&&r<=this.proxy.rowEnd){const s=e[o];Xv(this,r,Math.round(s),n),this._updateContainerHeight(r,s)}}this.updateTableSize(),this.component.updateScrollBar(),this.updateNextFrame()}updateContainerWidth(t,e){t<this.frozenColCount?(this.rowHeaderGroup.setDeltaWidth(e),this.cornerHeaderGroup.setDeltaWidth(e),this.colHeaderGroup.setDeltaX(e),this.bodyGroup.setDeltaX(e)):(this.colHeaderGroup.setDeltaWidth(e),this.bodyGroup.setDeltaWidth(e)),this.updateTableSize(),this.component.updateScrollBar(),this.updateNextFrame()}_updateContainerHeight(t,e){t<this.table.frozenRowCount?(this.colHeaderGroup.setDeltaHeight(e),this.cornerHeaderGroup.setDeltaHeight(e),this.rowHeaderGroup.setDeltaY(e),this.bodyGroup.setDeltaY(e),this.table.rightFrozenColCount&&this.rightFrozenGroup.setDeltaY(e)):t>=this.table.rowCount-this.table.bottomFrozenRowCount?(this.leftBottomCornerGroup.setDeltaHeight(e),this.bottomFrozenGroup.setDeltaHeight(e),this.table.rightFrozenColCount&&this.rightBottomCornerGroup.setDeltaHeight(e)):(this.rowHeaderGroup.setDeltaHeight(e),this.bodyGroup.setDeltaHeight(e),this.table.rightFrozenColCount&&this.rightFrozenGroup.setDeltaHeight(e))}updateContainerHeight(t,e){this._updateContainerHeight(t,e),this.updateTableSize(),this.component.updateScrollBar(),this.updateNextFrame()}setColWidth(t,e){const n=this.table.getColWidth(t);n!==e&&(this.updateColWidth(t,e-n),this.table._clearColRangeWidthsMap(t))}setRowHeight(t,e){const n=this.table.getRowHeight(t);n!==e&&((t>=this.proxy.rowStart&&t<=this.proxy.rowEnd||t>=this.table.rowCount-this.table.bottomFrozenRowCount&&t<=this.table.rowCount-1||t<this.table.frozenRowCount)&&this.updateRowHeight(t,e-n),this.table._clearRowRangeHeightsMap(t))}setX(t,e=!1){this.table.scenegraph.proxy.setX(-t,e)}setY(t,e=!1){this.table.scenegraph.proxy.setY(-t,e)}setBodyAndRowHeaderY(t){var e,n;const o=(e=this.bodyGroup.firstChild)===null||e===void 0?void 0:e.firstChild,r=(n=this.bodyGroup.firstChild)===null||n===void 0?void 0:n.lastChild;t===0&&o&&o.row===this.table.frozenRowCount&&o.attribute.y+t<0?t=-o.attribute.y:r&&this.table.tableNoFrameHeight<this.table.getAllRowsHeight()&&r.row===this.table.rowCount-this.table.bottomFrozenRowCount-1&&r.attribute.y+r.attribute.height+t<this.table.tableNoFrameHeight-this.table.getFrozenRowsHeight()-this.table.getBottomFrozenRowsHeight()&&(t=this.table.tableNoFrameHeight-this.table.getFrozenRowsHeight()-this.table.getBottomFrozenRowsHeight()-r.attribute.y-r.attribute.height),this.colHeaderGroup.attribute.height+t!==this.bodyGroup.attribute.y&&(this.bodyGroup.setAttribute("y",this.colHeaderGroup.attribute.height+t),this.rowHeaderGroup.setAttribute("y",this.cornerHeaderGroup.attribute.height+t),this.table.rightFrozenColCount>0&&this.rightFrozenGroup.setAttribute("y",this.rightTopCornerGroup.attribute.height+t),this.updateNextFrame())}setBodyAndColHeaderX(t){const e=this.bodyGroup.firstChild,n=this.bodyGroup.lastChild;t===0&&e&&e.col===this.table.frozenColCount&&e.attribute.x+t<0?t=-e.attribute.x:n&&this.table.tableNoFrameWidth<this.table.getAllColsWidth()&&n.col===this.table.colCount-this.table.rightFrozenColCount-1&&n.attribute.x+n.attribute.width+t<this.table.tableNoFrameWidth-this.table.getFrozenColsWidth()-this.table.getRightFrozenColsWidth()&&(t=this.table.tableNoFrameWidth-this.table.getFrozenColsWidth()-this.table.getRightFrozenColsWidth()-n.attribute.x-n.attribute.width),this.table.getFrozenColsWidth()+t!==this.bodyGroup.attribute.x&&(this.bodyGroup.setAttribute("x",this.table.getFrozenColsWidth()+t),this.colHeaderGroup.setAttribute("x",this.table.getFrozenColsWidth()+t),this.table.bottomFrozenRowCount>0&&this.bottomFrozenGroup.setAttribute("x",this.table.getFrozenColsWidth()+t),this.updateNextFrame())}afterScenegraphCreated(){this.isPivot||this.table.transpose?this.table.options.frozenColCount?this.component.setFrozenColumnShadow(this.table.frozenColCount-1):this.table.options.rightFrozenColCount?this.component.setRightFrozenColumnShadow(this.table.colCount-this.table.rightFrozenColCount):this.component.setFrozenColumnShadow(-1):(this.component.setFrozenColumnShadow(this.table.frozenColCount-1),this.component.setRightFrozenColumnShadow(this.table.colCount-this.table.rightFrozenColCount)),this.table.stateManager.checkFrozen(),this.updateContainer(),this.createFrameBorder(),this.updateBorderSizeAndPosition(),this.component.updateScrollBar(),Bs(this.table),this.table.options.animationAppear&&uL(this.table),this.updateNextFrame()}dealWidthMode(){const t=this.table;if(t.widthMode==="adaptive"){t._clearColRangeWidthsMap();const s=t.tableNoFrameWidth;let l=0;for(let d=0;d<t.colCount;d++)(d<t.rowHeaderLevelCount||t.isPivotChart()&&d>=t.colCount-t.rightFrozenColCount)&&(l+=t.getColWidth(d));const a=t.rowHeaderLevelCount,h=t.isPivotChart()?t.colCount-t.rightFrozenColCount:t.colCount;Hh(s-l,a,h,!1,[],t,!0)}else if(t.autoFillWidth){t._clearColRangeWidthsMap();const s=t.tableNoFrameWidth;let l=0,a=0;for(let h=0;h<t.colCount;h++){const d=t.getColWidth(h);(h<t.rowHeaderLevelCount||t.isPivotChart()&&h>=t.colCount-t.rightFrozenColCount)&&(l+=d),a+=d}if(a<s&&a>l){const h=t.rowHeaderLevelCount,d=t.isPivotChart()?t.colCount-t.rightFrozenColCount:t.colCount;Hh(s-l,h,d,!1,[],t,!0)}}let e=0;this.bodyGroup.forEachChildrenSkipChild(s=>{e+=s.attribute.width}),this.bodyGroup.setAttribute("width",e);let n=0;this.colHeaderGroup.forEachChildrenSkipChild(s=>{n+=s.attribute.width}),this.colHeaderGroup.setAttribute("width",n);let o=0;this.rowHeaderGroup.forEachChildrenSkipChild(s=>{o+=s.attribute.width}),this.rowHeaderGroup.setAttribute("width",o);let r=0;this.cornerHeaderGroup.forEachChildrenSkipChild(s=>{r+=s.attribute.width}),this.cornerHeaderGroup.setAttribute("width",r),this.colHeaderGroup.setAttribute("x",this.cornerHeaderGroup.attribute.width),this.rowHeaderGroup.setAttribute("y",this.cornerHeaderGroup.attribute.height),this.bodyGroup.setAttributes({x:this.rowHeaderGroup.attribute.width,y:this.colHeaderGroup.attribute.height})}dealHeightMode(){var t;const e=this.table;if(e.heightMode==="adaptive"){e._clearRowRangeHeightsMap();const n=e.getRowsHeight(0,e.columnHeaderLevelCount-1),o=e.isPivotChart()?e.getBottomFrozenRowsHeight():0,r=e.tableNoFrameHeight-n-o,s=e.columnHeaderLevelCount,l=e.isPivotChart()?e.rowCount-e.bottomFrozenRowCount:e.rowCount;let a=0;for(let d=s;d<l;d++)a+=e.getRowHeight(d);const h=r/a;for(let d=s;d<l;d++){let u;u=d===l-1?r-e.getRowsHeight(s,l-2):Math.round(e.getRowHeight(d)*h),this.setRowHeight(d,u)}}else if(e.autoFillHeight){e._clearRowRangeHeightsMap();const n=e.tableNoFrameHeight;let o=0,r=0;for(let s=0;s<e.rowCount;s++){const l=e.getRowHeight(s);(s<e.columnHeaderLevelCount||e.isPivotChart()&&s>=e.rowCount-e.bottomFrozenRowCount)&&(r+=l),o+=l}if(((t=this._dealAutoFillHeightOriginRowsHeight)!==null&&t!==void 0?t:o)<n&&o-r>0){const s=e.columnHeaderLevelCount,l=e.isPivotChart()?e.rowCount-e.bottomFrozenRowCount:e.rowCount,a=(n-r)/(o-r);for(let h=s;h<l;h++){let d;d=h===l-1?n-r-e.getRowsHeight(s,l-2):Math.round(e.getRowHeight(h)*a),this.setRowHeight(h,d)}}}}dealFrozen(){kE(this)}resetFrozen(){EE(this)}resetRowFrozen(){zE(this)}updateCellLayoutWidthCertainWidth(t,e,n){const o=t.attribute.width;let r=!1;return t.forEachChildren((s,l)=>{l+=e;const a=ae(this.table,n,l);a?s=this.getCell(a.start.col,a.start.row):s.setAttribute("width",o);const h=this.table._getCellStyle(n,l),d=xt(q("padding",h,n,l,this.table)),u=s.getChildByName("text");let c=0,f=0;if(u)c=u.AABBBounds.height()+(d[0]+d[2]),u.setAttribute("maxLineWidth",o-(d[1]+d[3])),f=u.AABBBounds.height()+(d[0]+d[2]);else{const p=s.getChildAt(1);c=p.AABBBounds.height()+(d[0]+d[2]),p._cellWidth=o-(d[1]+d[3]),p.layout(),f=p.AABBBounds.height()+(d[0]+d[2])}const g=this.table.getRowHeight(l);s.attribute.height!==f&&(s.setAttribute("height",f),(g===c||f>g)&&(r=!0))}),r}updateHeaderPosition(t,e,n,o,r){_E(t,e,n,o,r,this.table)}updateContainerAttrWidthAndX(){var t,e,n;const o=fn(this.cornerHeaderGroup,0),r=fn(this.rowHeaderGroup,0),s=this.colHeaderGroup.hasChildNodes()&&this.colHeaderGroup.firstChild?fn(this.colHeaderGroup,this.colHeaderGroup.firstChild.col>0?this.table.getColsWidth((t=this.table.frozenColCount)!==null&&t!==void 0?t:0,this.colHeaderGroup.firstChild.col-1):0):0,l=this.bodyGroup.hasChildNodes()&&this.bodyGroup.firstChild?fn(this.bodyGroup,this.bodyGroup.firstChild.col>0?this.table.getColsWidth((e=this.table.frozenColCount)!==null&&e!==void 0?e:0,this.bodyGroup.firstChild.col-1):0):0,a=fn(this.rightFrozenGroup.childrenCount>0?this.rightFrozenGroup:this.rightTopCornerGroup,0);this.bottomFrozenGroup.hasChildNodes()&&this.bottomFrozenGroup.firstChild&&fn(this.bottomFrozenGroup,this.bottomFrozenGroup.firstChild.col>0?this.table.getColsWidth((n=this.table.frozenColCount)!==null&&n!==void 0?n:0,this.bottomFrozenGroup.firstChild.col-1):0),fn(this.leftBottomCornerGroup,0),fn(this.rightTopCornerGroup,0),fn(this.rightBottomCornerGroup,0),this.cornerHeaderGroup.setDeltaWidth(o-this.cornerHeaderGroup.attribute.width),this.leftBottomCornerGroup.setDeltaWidth(o-this.leftBottomCornerGroup.attribute.width),this.colHeaderGroup.setDeltaWidth(s-this.colHeaderGroup.attribute.width),this.rowHeaderGroup.setDeltaWidth(r-this.rowHeaderGroup.attribute.width),this.bottomFrozenGroup.setDeltaWidth(s-this.bottomFrozenGroup.attribute.width),this.rightFrozenGroup.setDeltaWidth(a-this.rightFrozenGroup.attribute.width),this.rightTopCornerGroup.setDeltaWidth(a-this.rightTopCornerGroup.attribute.width),this.rightBottomCornerGroup.setDeltaWidth(a-this.rightBottomCornerGroup.attribute.width),this.bodyGroup.setDeltaWidth(l-this.bodyGroup.attribute.width),this.colHeaderGroup.setAttribute("x",this.cornerHeaderGroup.attribute.width),this.bottomFrozenGroup.setAttribute("x",this.table.getFrozenColsWidth()),this.bodyGroup.setAttribute("x",this.rowHeaderGroup.attribute.width)}updateContainer(t=!1){t?this._needUpdateContainer||(this._needUpdateContainer=!0,setTimeout(()=>{this.updateContainerSync()},0)):(this._needUpdateContainer=!0,this.updateContainerSync())}updateContainerSync(){this._needUpdateContainer&&(this._needUpdateContainer=!1,this.updateContainerAttrWidthAndX(),this.updateTableSize(),this.component.updateScrollBar(),this.updateNextFrame())}updateCellContentWhileResize(t,e){var n;const o=!((n=this.table.getCellRawRecord(t,e))===null||n===void 0)&&n.vtableMerge?"text":this.table.isHeader(t,e)?this.table._getHeaderLayoutMap(t,e).headerType:this.table.getBodyColumnType(t,e),r=this.getCell(t,e);o!=="image"&&o!=="video"||qs(r,t,e,0,0,this.table)}createFrameBorder(){var t,e,n,o,r;this.updateTableSize();const s=!this.isPivot&&!this.table.internalProps.transpose;Hi(this.bodyGroup,this.table.theme.bodyStyle.frameStyle,this.bodyGroup.role,s?[!0,!0,!0,!1]:void 0),Hi(this.rowHeaderGroup,this.isPivot||this.table.internalProps.transpose?this.table.theme.rowHeaderStyle.frameStyle:this.table.theme.bodyStyle.frameStyle,this.rowHeaderGroup.role,s?[!0,!1,!0,!0]:void 0),Hi(this.colHeaderGroup,this.table.theme.headerStyle.frameStyle,this.colHeaderGroup.role,s?[!0,!0,!0,!1]:void 0),Hi(this.cornerHeaderGroup,this.isPivot?this.table.theme.cornerHeaderStyle.frameStyle:this.table.theme.headerStyle.frameStyle,this.cornerHeaderGroup.role,s?[!0,!1,!0,!0]:void 0),!((t=this.table.theme.cornerLeftBottomCellStyle)===null||t===void 0)&&t.frameStyle&&Hi(this.leftBottomCornerGroup,this.table.theme.cornerLeftBottomCellStyle.frameStyle,this.leftBottomCornerGroup.role,s?[!0,!1,!0,!0]:void 0),!((e=this.table.theme.bottomFrozenStyle)===null||e===void 0)&&e.frameStyle&&Hi(this.bottomFrozenGroup,this.table.theme.bottomFrozenStyle.frameStyle,this.bottomFrozenGroup.role,s?[!0,!0,!0,!1]:void 0),!((n=this.table.theme.rightFrozenStyle)===null||n===void 0)&&n.frameStyle&&Hi(this.rightFrozenGroup,this.table.theme.rightFrozenStyle.frameStyle,this.rightFrozenGroup.role,void 0),!((o=this.table.theme.cornerRightTopCellStyle)===null||o===void 0)&&o.frameStyle&&Hi(this.rightTopCornerGroup,this.table.theme.cornerRightTopCellStyle.frameStyle,this.rightTopCornerGroup.role,void 0),!((r=this.table.theme.cornerRightBottomCellStyle)===null||r===void 0)&&r.frameStyle&&Hi(this.rightBottomCornerGroup,this.table.theme.cornerRightBottomCellStyle.frameStyle,this.rightBottomCornerGroup.role,void 0),Hi(this.tableGroup,this.table.theme.frameStyle,this.tableGroup.role,void 0)}getResizeColAt(t,e,n){const o=this.table.theme.columnResize.resizeHotSpotSize/2;let r;if(!n){const s=this.table.getDrawRange();return e>=s.top&&e<=s.bottom&&(r=this.table.getCellAtRelativePosition(t-o,e),r.col===this.table.colCount-1)?r:{col:-1,row:-1}}return n.stage?(t<n.globalAABBBounds.x1+o?r={col:n.col-1,row:n.row,x:n.globalAABBBounds.x1}:n.globalAABBBounds.x2-o<t&&(r={col:n.col,row:n.row,x:n.globalAABBBounds.x2}),r&&this.table.rightFrozenColCount>0&&r.col>=this.table.colCount-this.table.rightFrozenColCount-1&&this.table.tableNoFrameWidth-this.table.getFrozenColsWidth()-this.table.getRightFrozenColsWidth()+this.table.scrollLeft<this.bodyGroup.attribute.width&&(r.col=r.col+1,r.rightFrozen=!0),r||{col:-1,row:-1}):{col:-1,row:-1}}getResizeRowAt(t,e,n){const o=this.table.theme.columnResize.resizeHotSpotSize/2;if(n){let r;if(e<n.globalAABBBounds.y1+o?r={col:n.col,row:n.row-1,y:n.globalAABBBounds.y1}:n.globalAABBBounds.y2-o<e&&(r={col:n.col,row:n.row,y:n.globalAABBBounds.y2}),r&&this.table.bottomFrozenRowCount>0&&r.row>=this.table.rowCount-this.table.bottomFrozenRowCount-1&&this.table.tableNoFrameHeight-this.table.getFrozenRowsHeight()-this.table.getBottomFrozenRowsHeight()+this.table.scrollTop<this.bodyGroup.attribute.height&&(r.row=r.row+1,r.bottomFrozen=!0),r)return r}return{col:-1,row:-1}}updateFrozen(){this.clear||(this.resetFrozen(),this.component.updateScrollBar())}updateRowFrozen(){this.clear||(this.resetRowFrozen(),this.component.updateScrollBar())}dealWidthRightFrozen(t){this.clear?this.table.internalProps.rightFrozenColCount=t:LE(t,this)}dealWidthBottomFrozen(t){this.clear?this.table.internalProps.bottomFrozenRowCount=t:FE(t,this)}updateBorderSizeAndPosition(){this.bodyGroup.border&&(this.bodyGroup.appendChild(this.bodyGroup.border),cn(this.bodyGroup),this.rowHeaderGroup.attribute.width,tm(this.bodyGroup,this.table.theme.bodyStyle.frameStyle)),this.colHeaderGroup.border&&(this.colHeaderGroup.appendChild(this.colHeaderGroup.border),cn(this.colHeaderGroup),this.cornerHeaderGroup.attribute.width,tm(this.colHeaderGroup,this.table.theme.headerStyle.frameStyle)),this.rowHeaderGroup.border&&(this.rowHeaderGroup.appendChild(this.rowHeaderGroup.border),cn(this.rowHeaderGroup)),this.cornerHeaderGroup.border&&(this.cornerHeaderGroup.appendChild(this.cornerHeaderGroup.border),cn(this.cornerHeaderGroup)),this.leftBottomCornerGroup.border&&(this.leftBottomCornerGroup.appendChild(this.leftBottomCornerGroup.border),cn(this.leftBottomCornerGroup)),this.bottomFrozenGroup.border&&(this.bottomFrozenGroup.appendChild(this.bottomFrozenGroup.border),cn(this.bottomFrozenGroup)),this.rightFrozenGroup.border&&(this.rightFrozenGroup.appendChild(this.rightFrozenGroup.border),cn(this.rightFrozenGroup)),this.rightTopCornerGroup.border&&(this.rightTopCornerGroup.appendChild(this.rightTopCornerGroup.border),cn(this.rightTopCornerGroup)),this.rightBottomCornerGroup.border&&(this.rightBottomCornerGroup.appendChild(this.rightBottomCornerGroup.border),cn(this.rightBottomCornerGroup)),Lk(this.table)}sortCell(){this.isPivot||(this.table.transpose?this.proxy.sortCellHorizontal():this.proxy.sortCellVertical())}getCellOverflowText(t,e){const n=this.getCell(t,e).getChildByName("text",!0);if(n&&n.type==="text"){if(n.attribute.moreThanMaxCharacters)return this.table.getCellValue(t,e);if(n.cliped)return this.table.getCellValue(t,e)}else if(n&&n.type==="richtext"){const o=n;if(o.attribute.ellipsis&&o._frameCache&&o.attribute.height<o._frameCache.actualHeight)return o.attribute.textConfig.find(r=>r.text),this.table.getCellValue(t,e)}return null}updateDrill(t,e,n,o,r){this.component.drillIcon.update(t,e,n,o,r,this)}updateCellContent(t,e,n=!1){if(!this.clear)return xi(t,e,this.table,void 0,void 0,n)}setPixelRatio(t){this.stage.disableDirtyBounds(),this.stage.window.setDpr(t),this.stage.render(),this.stage.enableDirtyBounds()}updateRow(t,e,n=[],o=!0,r){this.table.internalProps.layoutMap.clearCellRangeMap(),this.table.internalProps.useOneRowHeightFillAll=!1;const s=_s(e.map(h=>h.row)).sort((h,d)=>h-d),l=_s(n.map(h=>h.row)).sort((h,d)=>h-d),a=this.table.getAllRowsHeight()-[...s,...l].reduce((h,d)=>h+this.table.getRowHeight(d),0)<=this.table.tableNoFrameHeight;if(xE(t,e,n,this.table,r),o&&this.recalculateColWidths(),this.table.heightMode==="adaptive"||this.table.autoFillHeight&&(this.table.getAllRowsHeight()<=this.table.tableNoFrameHeight||a))this.table.scenegraph.recalculateRowHeights();else if(this.table.isAutoRowHeight())for(let h=0;h<l.length;h++){const d=l[h],u=this.table.getRowHeight(d),c=yi(d,0,this.table.colCount-1,this.table);(d>=this.proxy.rowStart&&d<=this.proxy.rowEnd||d>=this.table.rowCount-this.table.bottomFrozenRowCount&&d<=this.table.rowCount-1)&&this.table.scenegraph.updateRowHeight(d,c-u)}this.table.stateManager.checkFrozen(),this.isPivot||this.table.transpose?this.table.options.frozenColCount?this.component.setFrozenColumnShadow(this.table.frozenColCount-1):this.table.options.rightFrozenColCount&&this.component.setRightFrozenColumnShadow(this.table.colCount-this.table.rightFrozenColCount):(this.component.setFrozenColumnShadow(this.table.frozenColCount-1),this.component.setRightFrozenColumnShadow(this.table.colCount-this.table.rightFrozenColCount)),this.component.updateScrollBar(),this.updateNextFrame()}updateCol(t,e,n=[]){lL(t,e,n,this.table),this.recalculateColWidths(),this.recalculateRowHeights(),this.table.stateManager.checkFrozen(),this.isPivot||this.table.transpose?this.table.options.frozenColCount?this.component.setFrozenColumnShadow(this.table.frozenColCount-1):this.table.options.rightFrozenColCount&&this.component.setRightFrozenColumnShadow(this.table.colCount-this.table.rightFrozenColCount):(this.component.setFrozenColumnShadow(this.table.frozenColCount-1),this.component.setRightFrozenColumnShadow(this.table.colCount-this.table.rightFrozenColCount)),this.component.updateScrollBar(),this.updateNextFrame()}updateCornerHeaderCells(){for(let t=0;t<this.table.frozenColCount;t++)for(let e=0;e<this.table.frozenRowCount;e++)xi(t,e,this.table,!1)}updateRowHeaderCells(){for(let t=0;t<this.table.frozenColCount;t++)for(let e=this.table.frozenRowCount;e<this.table.rowCount;e++)xi(t,e,this.table,!1)}updateColumnHeaderCells(){for(let t=0;t<this.table.frozenRowCount;t++)for(let e=this.table.frozenColCount;e<this.table.colCount;e++)xi(e,t,this.table,!1)}getColumnGroupX(t){return t<this.table.rowHeaderLevelCount?this.table.getColsWidth(0,t-1):t<this.table.colCount-this.table.rightFrozenColCount?this.table.getColsWidth(this.table.rowHeaderLevelCount,t-1):t<this.table.colCount?this.table.getColsWidth(this.table.colCount-this.table.bottomFrozenRowCount,t-1):0}getCellGroupY(t){return t<this.table.frozenRowCount?this.table.getRowsHeight(0,t-1):t<this.table.rowCount-this.table.bottomFrozenRowCount?this.table.getRowsHeight(this.table.frozenRowCount,t-1):t<this.table.rowCount?this.table.getRowsHeight(this.table.rowCount-this.table.bottomFrozenRowCount,t-1):0}getCellGroupX(t){return t<this.table.rowHeaderLevelCount?this.table.getColsWidth(0,t-1):t<this.table.colCount-this.table.rightFrozenColCount?this.table.getColsWidth(this.table.rowHeaderLevelCount,t-1):t<this.table.colCount?this.table.getColsWidth(this.table.colCount-this.table.rightFrozenColCount,t-1):0}updateDomContainer(){HE(this.table)}setLoadingHierarchyState(t,e){const n=this.getCell(t,e).getChildByName("collapse",!0);if(n){const o=Ni()[Ve.loadingIconName];o&&Si(o,n,t,e)}}temporarilyUpdateSelectRectStyle(t){cL(t,this)}resetSelectRectStyle(){this.recreateAllSelectRangeComponents()}}function fL(i,t,e){for(let n=0;n<e.length;n++){const o=e[n];if(Bi(o,i,t))return!0}return!1}function pL(i,t,e,n){for(let o=0;o<e.length;o++){const r=e[o];if(B2(r,{start:i,end:t}))return!0}return!1}function Wr(i,t,e){const n=i.highPerformanceGetCell(t,e);if(n.role==="cell"&&O(n.mergeStartCol)&&O(n.mergeStartRow)&&O(n.mergeEndCol)&&O(n.mergeEndRow)){const{colStart:o,colEnd:r,rowStart:s,rowEnd:l}=oo(n,i);for(let a=o;a<=r;a++)for(let h=s;h<=l;h++){const d=i.highPerformanceGetCell(a,h);d.role==="cell"&&d.addUpdateBoundTag()}}else n.addUpdateBoundTag()}function Rm(i,t,e,n,o){const r=i.table;for(let l=0;l<r.columnHeaderLevelCount;l++)Wr(i,t,l);const s=i.getColGroup(t);return s==null||s.addUpdateBoundTag(),!0}function Am(i,t,e,n,o,r){const s=i.table;for(let a=0;a<s.columnHeaderLevelCount;a++)Wr(i,t,a);const l=i.getColGroup(t);return l==null||l.addUpdateBoundTag(),!0}function Bm(i,t,e,n,o){const r=i.table;for(let s=0;s<r.colCount;s++)Wr(i,s,e);return!0}function Mm(i,t,e,n,o,r){const s=i.table;for(let l=0;l<s.colCount;l++)Wr(i,l,e);return!0}function vL(i,t,e,n,o){return Wr(i,t,e),!0}function mL(i,t,e,n,o){return Wr(i,t,e),!0}function bL(i,t,e){const{table:n}=i,{scenegraph:o}=n,{highlightScope:r,singleStyle:s,disableHeader:l,cellPos:a,cellPosContainHeader:h}=i.hover,d=a.col,u=a.row;if(r===Ht.none||l&&(h.col!==t||h.row!==e)){const p=h.col,v=h.row;o.hideHoverIcon(p,v),o.showHoverIcon(t,e),h.col=t,h.row=e}if((l&&n.isHeader(t,e)||r===Ht.none)&&(t=-1,e=-1),d===t&&u===e)return;o.deactivateChart(d,u),o.activateChart(t,e);let c=!1;const{ranges:f,highlightScope:g}=i.select;if(d!==-1&&u!==-1&&(c=CL(o,d,u,f,s,r),l||o.hideHoverIcon(d,u)),t===-1||e===-1)return a.col=-1,a.row=-1,void(!c||d===t&&u===e||i.table.scenegraph.updateNextFrame());r===Ht.single?c=!!mL(o,t,e):r===Ht.row?c=!!Mm(o,t,e):r===Ht.column?c=!!Am(o,t):r===Ht.cross&&(c=!!Mm(o,t,e),c=!!Am(o,t)),r===Ht.none||l||o.showHoverIcon(t,e),a.col=t,a.row=e,c&&i.table.scenegraph.updateNextFrame()}function CL(i,t,e,n,o,r,s){let l=!1;return r===Ht.single?l=!!vL(i,t,e):r===Ht.row?l=!!Bm(i,t,e):r===Ht.column?l=!!Rm(i,t):r===Ht.cross&&(l=!!Bm(i,t,e),l=!!Rm(i,t)),l}function _L(i,t,e){e.frozenColCount>0?i!==e.frozenColCount-1?e.setFrozenColCount(i+1):e.setFrozenColCount(0):e.setFrozenColCount(i+1)}function wL(i,t,e,n){var o;let r,s=null,l=!1;if(Array.isArray(e.sortState))for(let c=0;c<e.sortState.length&&(r=e.sortState[c],r&&(s=e._getHeaderCellBySortState(r)),s&&(l=Tm(i,t,s.col,s.row,e)),!l);c++);else r=e.sortState,r&&(s=e._getHeaderCellBySortState(r)),s&&(l=Tm(i,t,s.col,s.row,e));const a=e.getHeaderDefine(i,t);if(r&&l&&(a!=null&&a.sort)?r.order=r.order==="asc"?"desc":r.order==="desc"?"normal":"asc":a!=null&&a.sort?r={field:e.getHeaderField(i,t),order:"asc"}:l&&(a!=null&&a.showSort)||(r={field:e.getHeaderField(i,t),order:"normal"}),r.event=n,e.fireListeners(U.SORT_CLICK,r).includes(!1))return;let h=!1,d=e.internalProps.sortState?Array.isArray(e.internalProps.sortState)&&(h=!0)?e.internalProps.sortState:[e.internalProps.sortState]:[];if(Array.isArray(d)){const c=d.findIndex(f=>f.field===r.field);c>=0?d[c]=r:d.push(r)}d=d.filter(c=>c.order!=="normal"),d=e.internalProps.multipleSort&&(h=!0)?d:d.splice(-1),d=h&&d.length?d:d[0],e.internalProps.sortState=d,e.stateManager.setSortState(d),a!=null&&a.sort&&yL(d,e),e.internalProps.useOneRowHeightFillAll=!1,e.internalProps.layoutMap.clearCellRangeMap(),e.scenegraph.sortCell();const u=!!(!((o=e.stateManager.select.ranges)===null||o===void 0)&&o.length);e.stateManager.updateSelectPos(-1,-1),e.stateManager.endSelectCells(!0,u)}function yL(i,t,e){i=Array.isArray(i)||!i?i:[i],t.dataSource.sort((i||[]).map(n=>{var o,r;const s=t.internalProps.layoutMap.headerObjects.find(l=>l&&l.field===n.field);return{field:n.field,order:n.order||"asc",orderFn:typeof((o=s==null?void 0:s.define)===null||o===void 0?void 0:o.sort)=="function"?(r=s==null?void 0:s.define)===null||r===void 0?void 0:r.sort:ah}}))}function Tm(i,t,e,n,o){return o._getLayoutCellId(i,t)===o._getLayoutCellId(e,n)}function SL(i,t,e,n,o,r,s=!0,l=!1){var a,h;const{table:d,interactionState:u}=i,{scenegraph:c}=d,{highlightScope:f,disableHeader:g,cellPos:p,disableCtrlMultiSelect:v}=i.select;if(t!==-1&&e!==-1&&s&&d._makeVisibleCell(t,e),t!==-1&&e!==-1&&s)if(u===vt.grabing&&i.select.ranges.length>0){const m=i.select.ranges[i.select.ranges.length-1];t>m.start.col&&t>m.end.col&&d._makeVisibleCell(t+1,e),e>m.start.row&&e>m.end.row&&d._makeVisibleCell(t,e+1),t<m.start.col&&t<m.end.col&&d._makeVisibleCell(t-1,e),e<m.start.row&&e<m.end.row&&d._makeVisibleCell(t,e-1)}else d._makeVisibleCell(t,e);if(r){i.select.ranges=[],c.deleteAllSelectBorder();let m=0,b=0;const{disableHeaderSelect:C,disableRowSeriesNumberSelect:_}=((a=d.options.keyboardOptions)===null||a===void 0?void 0:a.selectAllOnCtrlA)||{};C&&(m=d.rowHeaderLevelCount,b=d.columnHeaderLevelCount),(_||C&&d.transpose)&&d.options.rowSeriesNumber&&(m+=1),i.select.ranges.push({start:{col:m,row:b},end:{col:d.colCount-1,row:d.rowCount-1}});const w=i.select.ranges[i.select.ranges.length-1];c.updateCellSelectBorder(w,!1)}else if(p.col===-1||p.row===-1||t!==-1&&e!==-1)if(u!==vt.default||d.eventManager.isDraging||d.stateManager.isResizeCol()){if((u===vt.grabing||d.eventManager.isDraging)&&!d.stateManager.isResizeCol()){let m=!0;p.col===-1&&(p.col=t),p.row===-1&&(p.row=e),p.col=t,p.row=e;const b=i.select.ranges[i.select.ranges.length-1];if(b){if(d.internalProps.layoutMap.isSeriesNumberInBody(b.start.col,b.start.row))m=!1,b.end={col:d.colCount-1,row:e};else if(i.fillHandle.isFilling){if(i.fillHandle.direction==="top")if(e===i.fillHandle.beforeFillMinRow&&e===i.fillHandle.beforeFillMaxRow)b.start.row=b.end.row=e;else if(e<=i.fillHandle.beforeFillMinRow){if(b.start.row<b.end.row){const C=b.start.row;b.start.row=b.end.row,b.end.row=C}b.end.row=e}else e===i.fillHandle.beforeFillMaxRow&&(b.start.row>b.end.row?b.start.row=e:b.end.row=e);else if(i.fillHandle.direction==="bottom"){if(e>=i.fillHandle.beforeFillMaxRow){if(b.start.row>b.end.row){const C=b.start.row;b.start.row=b.end.row,b.end.row=C}b.end.row=e}}else if(i.fillHandle.direction==="left")if(t===i.fillHandle.beforeFillMinCol&&t===i.fillHandle.beforeFillMaxCol)b.start.col=b.end.col=t;else if(t<=i.fillHandle.beforeFillMinCol){if(b.start.col<b.end.col){const C=b.start.col;b.start.col=b.end.col,b.end.col=C}b.end.col=t}else t===i.fillHandle.beforeFillMaxCol&&(b.start.col>b.end.col?b.start.col=t:b.end.col=t);else if(i.fillHandle.direction==="right"&&t>=i.fillHandle.beforeFillMaxCol){if(b.start.col>b.end.col){const C=b.start.col;b.start.col=b.end.col,b.end.col=C}b.end.col=t}}else{b.end={col:t,row:e};const C=l?{start:{col:t,row:e},end:{col:t,row:e}}:d.getCellRange(t,e);b.start.col<C.end.col?b.end.col=C.end.col:b.start.col>C.start.col&&(b.end.col=C.start.col),b.start.row<C.end.row?b.end.row=C.end.row:b.start.row>C.start.row&&(b.end.row=C.start.row),i.select.headerSelectMode==="body"&&(d.isRowHeader(t,e)?(b.start.col=d.rowHeaderLevelCount+d.leftRowSeriesNumberCount,b.end.col=d.colCount-1):d.isColumnHeader(t,e)?(b.start.row=d.columnHeaderLevelCount,b.end.row=d.rowCount-1):d.internalProps.layoutMap.isSeriesNumberInBody(t,e)?(b.start.col=d.leftRowSeriesNumberCount,b.end.col=d.colCount-1):d.isCornerHeader(t,e)?(b.start.col=d.rowHeaderLevelCount+d.leftRowSeriesNumberCount,b.start.row=d.columnHeaderLevelCount,b.end.col=d.colCount-1,b.end.row=d.rowCount-1):d.isSeriesNumber(t,e)&&(b.start.col=d.leftRowSeriesNumberCount,b.start.row=d.columnHeaderLevelCount,b.end.col=d.colCount-1,b.end.row=d.rowCount-1)),l&&(b.skipBodyMerge=!0)}c.updateCellSelectBorder(b,m)}}}else{const m=i.select.ranges[i.select.ranges.length-1];if(n&&m){if(o&&!v||(p.col=t,p.row=e),i.select.headerSelectMode!=="cell"&&d.isColumnHeader(t,e)){const b=Math.min(m.start.col,m.end.col,t),C=Math.max(m.start.col,m.end.col,t),_=Math.min(m.start.row,m.end.row,e),w=d.rowCount-1;i.select.headerSelectMode==="body"?(m.start={col:b,row:d.columnHeaderLevelCount},m.end={col:C,row:d.rowCount-1}):(m.start={col:b,row:_},m.end={col:C,row:w})}else if(i.select.headerSelectMode!=="cell"&&d.isRowHeader(t,e)){const b=Math.min(m.start.col,m.end.col,t),C=d.colCount-1,_=Math.min(m.start.row,m.end.row,e),w=Math.max(m.start.row,m.end.row,e);i.select.headerSelectMode==="body"?(m.start={col:d.leftRowSeriesNumberCount+d.rowHeaderLevelCount,row:_},m.end={col:d.colCount-1,row:w}):(m.start={col:b,row:_},m.end={col:C,row:w})}else if(i.select.headerSelectMode!=="cell"&&d.isSeriesNumberInBody(t,e)){const b=Math.min(m.start.col,m.end.col,t),C=d.colCount-1,_=Math.min(m.start.row,m.end.row,e),w=Math.max(m.start.row,m.end.row,e);i.select.headerSelectMode==="body"?(m.start={col:d.leftRowSeriesNumberCount,row:_},m.end={col:d.colCount-1,row:w}):(m.start={col:b,row:_},m.end={col:C,row:w})}else m.end={col:t,row:e};c.deleteLastSelectedRangeComponents(),c.updateCellSelectBorder(m)}else{let b=!0;if(p.col===-1||p.row===-1||o&&!v||(i.select.ranges=[],c.deleteAllSelectBorder()),i.select.headerSelectMode!=="cell"&&d.isColumnHeader(t,e)){const _=d.getCellRange(t,e);i.select.headerSelectMode==="body"?i.select.ranges.push({start:{col:_.start.col,row:d.columnHeaderLevelCount},end:{col:_.end.col,row:d.rowCount-1},skipBodyMerge:!0}):i.select.ranges.push({start:{col:_.start.col,row:e},end:{col:_.end.col,row:d.rowCount-1},skipBodyMerge:!0})}else if(i.select.headerSelectMode!=="cell"&&d.isRowHeader(t,e)){const _=d.getCellRange(t,e);i.select.headerSelectMode==="body"?i.select.ranges.push({start:{col:d.rowHeaderLevelCount+d.leftRowSeriesNumberCount,row:_.start.row},end:{col:d.colCount-1,row:_.end.row},skipBodyMerge:!0}):i.select.ranges.push({start:{col:t,row:_.start.row},end:{col:d.colCount-1,row:_.end.row},skipBodyMerge:!0})}else if(d.internalProps.layoutMap.isSeriesNumberInHeader(t,e))b=!1,i.select.headerSelectMode==="body"?i.select.ranges.push({start:{col:d.leftRowSeriesNumberCount,row:d.columnHeaderLevelCount},end:{col:d.colCount-1,row:d.rowCount-1},skipBodyMerge:!0}):i.select.ranges.push({start:{col:0,row:0},end:{col:d.colCount-1,row:d.rowCount-1},skipBodyMerge:!0});else if(d.internalProps.layoutMap.isSeriesNumberInBody(t,e))b=!1,i.select.headerSelectMode==="body"?i.select.ranges.push({start:{col:d.leftRowSeriesNumberCount,row:e},end:{col:d.colCount-1,row:e},skipBodyMerge:!0}):i.select.ranges.push({start:{col:t,row:e},end:{col:d.colCount-1,row:e},skipBodyMerge:!0});else if(d.internalProps.layoutMap.isCornerHeader(t,e))b=!1,i.select.headerSelectMode==="body"?i.select.ranges.push({start:{col:d.rowHeaderLevelCount+d.leftRowSeriesNumberCount,row:d.columnHeaderLevelCount},end:{col:d.colCount-1,row:d.rowCount-1},skipBodyMerge:!0}):i.select.ranges.push({start:{col:d.leftRowSeriesNumberCount,row:0},end:{col:d.colCount-1,row:d.rowCount-1},skipBodyMerge:!0});else if(t>=0&&e>=0){const _=l?{start:{col:t,row:e},end:{col:t,row:e}}:d.getCellRange(t,e);i.select.ranges.push({start:{col:_.start.col,row:_.start.row},end:{col:_.end.col,row:_.end.row},skipBodyMerge:l||void 0})}p.col=t,p.row=e;const C=(h=i.select.ranges)===null||h===void 0?void 0:h[i.select.ranges.length-1];C&&c.updateCellSelectBorder(C,b)}}else p.col=-1,p.row=-1,i.select.ranges=[],c.deleteAllSelectBorder();c.updateNextFrame()}function xL(i){i.moveSelectingRangeComponentsToSelectedRangeComponents()}const us=dl(U,{PIVOT_SORT_CLICK:"pivot_sort_click",DRILLMENU_CLICK:"drillmenu_click"}),MO=dl(U,{VCHART_EVENT_TYPE:"vchart_event_type"});function RL(i,t,e,n,o){const r=o.getCellLocation(i,t);let s=0,l=0,a=!1;r==="columnHeader"?(s=o.getColsWidth(0,o.rowHeaderLevelCount-1)-(o.frozenColCount===0?o.scrollLeft:0),l=o.getRowsHeight(0,t-1)+o.getRowHeight(t)/2,a=!0):r==="rowHeader"&&(l=o.getRowsHeight(0,o.columnHeaderLevelCount-1),s=o.getColsWidth(0,i-1)+o.getColWidth(i)/2,a=!0),o.scenegraph.updateDrill(a,s,l,e,n)}function AL(i,t,e){const n=e.scenegraph.getCell(i,t).getChildByName("sparkline"),o=n==null?void 0:n.getChildByName("highlight-line"),r=n==null?void 0:n.getChildByName("highlight-symbol");o&&o.setAttributes({visible:!1,pickable:!1}),r&&r.setAttributes({visible:!1,pickable:!1}),e.scenegraph.updateNextFrame()}function BL(i,t,e,n,o){var r,s;const l=o.scenegraph.getCell(i,t).getChildByName("sparkline"),a=l==null?void 0:l.getChildByName("sparkline-line"),h=l==null?void 0:l.getChildByName("sparkline-symbol-group");if(!a)return!1;const d=a.bandwidth,u=a.min,c=a.max,f=a.attribute.points;let g;e-=l.globalAABBBounds.x1,l.globalAABBBounds.y1;for(let p=0;p<f.length;p++){const{x:v,y:m,defined:b,rawData:C}=f[p];if(Math.abs(e-v)<d/2&&(g={point:f[p],points:f,pointsBandWidth:d,pointData:C},b)){const _=l.getChildByName("highlight-line");if(_)_.setAttributes({points:[{x:v,y:c},{x:v,y:u}],visible:!0,pickable:!0});else{const y=hi({points:[{x:v,y:c},{x:v,y:u}],lineWidth:(r=a.hover)===null||r===void 0?void 0:r.strokeWidth,stroke:(s=a.hover)===null||s===void 0?void 0:s.stroke});y.name="highlight-line",l.addChild(y)}const w=l.getChildByName("highlight-symbol");if(w)w.setAttributes({x:v,y:m,visible:!0,pickable:!0});else{const y=zs({x:v,y:m,stroke:h.hover.stroke,lineWidth:h.hover.strokeWidth,fill:h.hover.fill,size:2*h.hover.size,symbolType:"circle"});y.name="highlight-symbol",l.addChild(y)}break}}if(o.scenegraph.updateNextFrame(),g){const p={col:i,row:t,field:o.getHeaderField(i,t),value:o.getCellValue(i,t),dataValue:o.getCellOriginValue(i,t),cellHeaderPaths:o.internalProps.layoutMap.getCellHeaderPaths(i,t),title:o.getBodyColumnDefine(i,t).title,cellRange:o.getCellRelativeRect(i,t),sparkline:{pointData:g.pointData},scaleRatio:o.canvas.getBoundingClientRect().width/o.canvas.offsetWidth};o.fireListeners(U.MOUSEOVER_CHART_SYMBOL,p)}return!0}function ML(i,t,e){const n=e.getCellRange(i.col,i.row);if(e.isColumnHeader(i.col,i.row)){const o=e.getCellRange(t.col,n.start.row);t.row>=e.columnHeaderLevelCount&&(t.row=e.columnHeaderLevelCount-1),t.col>=i.col?t.col=o.end.col:t.col=o.start.col}else if(e.isRowHeader(i.col,i.row)){const o=e.internalProps.layoutMap,r=e.getCellRange(n.start.col,t.row);if(t.col>=e.rowHeaderLevelCount+o.leftRowSeriesNumberColumnCount&&(t.col=e.rowHeaderLevelCount+o.leftRowSeriesNumberColumnCount-1),o.rowHierarchyType==="tree"){const s=o.getCellHeaderPathsWithTreeNode(i.col,i.row).rowHeaderPaths,l=o.getCellHeaderPathsWithTreeNode(t.col,t.row).rowHeaderPaths;if(s.length<=l.length){const a=l[s.length-1];a&&(t.row>=i.row?t.row=a.startInTotal+a.size-1+e.columnHeaderLevelCount:t.row=a.startInTotal+e.columnHeaderLevelCount)}}else t.row>=i.row?t.row=r.end.row:t.row=r.start.row}return t}function TL(i,t,e,n,o,r){var s;if(!("canMoveHeaderPosition"in o.table.internalProps.layoutMap))return;o.columnMove.moving=!0,o.columnMove.colSource=i,o.columnMove.rowSource=t,o.columnMove.x=e-o.table.tableX,o.columnMove.y=n-o.table.tableY;const l=o.table.getCellLocation(i,t),a=l==="columnHeader"?o.columnMove.x:l==="rowHeader"||o.table.internalProps.layoutMap.isSeriesNumberInBody(i,t)?o.columnMove.y:0,{backX:h,lineX:d,backY:u,lineY:c}=o.table.scenegraph.component.showMoveCol(i,t,a);o.table.fireListeners(U.CHANGE_HEADER_POSITION_START,{col:i,row:t,x:e,y:n,backX:h,lineX:d,backY:u,lineY:c,event:r});const f=!!(!((s=o.select.ranges)===null||s===void 0)&&s.length);o.table.stateManager.updateSelectPos(-1,-1),o.table.stateManager.endSelectCells(!0,f),o.table.scenegraph.updateNextFrame()}function PL(i,t,e,n,o,r){if(!("canMoveHeaderPosition"in o.table.internalProps.layoutMap))return;const s=ML({col:o.columnMove.colSource,row:o.columnMove.rowSource},{col:i,row:t},o.table);if(o.table.internalProps.layoutMap.canMoveHeaderPosition({col:o.columnMove.colSource,row:o.columnMove.rowSource},{col:s.col,row:s.row})){let l,a,h,d;o.columnMove.x=e-o.table.tableX,o.columnMove.y=n-o.table.tableY,o.columnMove.colTarget=s.col,o.columnMove.rowTarget=s.row,o.updateCursor("grabbing");const u=o.table.getCellLocation(o.columnMove.colSource,o.columnMove.rowSource);u==="columnHeader"?(a=o.columnMove.x,l=o.table.isLeftFrozenColumn(i)?o.columnMove.colTarget>=o.columnMove.colSource?o.table.getColsWidth(0,o.columnMove.colTarget):o.table.getColsWidth(0,o.columnMove.colTarget-1):o.table.isRightFrozenColumn(i)?o.table.tableNoFrameWidth-o.table.getColsWidth(s.col+1,o.table.colCount-1):(o.columnMove.colTarget>=o.columnMove.colSource?o.table.getColsWidth(0,o.columnMove.colTarget):o.table.getColsWidth(0,o.columnMove.colTarget-1))-o.table.stateManager.scroll.horizontalBarPos):(u==="rowHeader"||o.table.internalProps.layoutMap.isSeriesNumberInBody(i,t))&&(d=o.columnMove.y,h=o.table.isFrozenRow(t)?o.columnMove.rowTarget>=o.columnMove.rowSource?o.table.getRowsHeight(0,o.columnMove.rowTarget):o.table.getRowsHeight(0,o.columnMove.rowTarget-1):o.table.isBottomFrozenRow(t)?o.table.tableNoFrameHeight-o.table.getRowsHeight(s.row+1,o.table.rowCount-1):(o.columnMove.rowTarget>=o.columnMove.rowSource?o.table.getRowsHeight(0,o.columnMove.rowTarget):o.table.getRowsHeight(0,o.columnMove.rowTarget-1))-o.table.stateManager.scroll.verticalBarPos),o.table.scenegraph.component.updateMoveCol(a,l,d,h),o.table.fireListeners(U.CHANGING_HEADER_POSITION,{col:i,row:t,x:e,y:n,backX:a,lineX:l,backY:d,lineY:h,event:r}),o.table.scenegraph.updateNextFrame()}else o.updateCursor("not-allowed"),o.columnMove.colTarget=o.columnMove.colSource,o.columnMove.rowTarget=o.columnMove.rowSource}function HL(i){var t,e;let n=!1;if("canMoveHeaderPosition"in i.table.internalProps.layoutMap&&i.columnMove.moving&&i.columnMove.colSource>=0&&i.columnMove.rowSource>=0&&i.columnMove.colTarget>=0&&i.columnMove.rowTarget>=0&&((t=i.table.options.customConfig)===null||t===void 0?void 0:t.notUpdateInColumnRowMove)!==!0){const o=i.table.getCellRange(i.columnMove.colSource,i.columnMove.rowSource),r=i.table.getCellRange(i.columnMove.colTarget,i.columnMove.rowTarget),s=i.table._moveHeaderPosition({col:i.columnMove.colSource,row:i.columnMove.rowSource},{col:i.columnMove.colTarget,row:i.columnMove.rowTarget});if(!s||s.targetIndex===s.sourceIndex)return i.updateCursor(),i.columnMove.moving=!1,delete i.columnMove.colSource,delete i.columnMove.rowSource,delete i.columnMove.colTarget,delete i.columnMove.rowTarget,i.table.scenegraph.component.hideMoveCol(),i.table.scenegraph.updateNextFrame(),!1;{i.table.internalProps.useOneRowHeightFillAll=!1,i.table.internalProps.layoutMap.clearCellRangeMap();const l=i.table.getCellRange(i.columnMove.colSource,i.columnMove.rowSource),a=i.table.getCellRange(i.columnMove.colTarget,i.columnMove.rowTarget),h=Math.min(l.start.col,a.start.col,o.start.col,r.start.col),d=Math.max(l.end.col,a.end.col,o.end.col,r.end.col),u=Math.min(l.start.row,a.start.row,o.start.row,r.start.row);let c=Math.max(l.end.row,a.end.row,o.end.row,r.end.row);s.moveType==="row"&&i.table.internalProps.layoutMap.rowHierarchyType==="tree"&&(c=s.targetIndex>s.sourceIndex?c+s.targetSize-1:c+s.sourceSize-1),!i.table.transpose&&i.table.internalProps.layoutMap.isSeriesNumberInBody(i.columnMove.colSource,i.columnMove.rowSource)&&(i.table.changeRecordOrder(s.sourceIndex,s.targetIndex),i.changeCheckboxAndRadioOrder(s.sourceIndex,s.targetIndex)),s.moveType==="column"?Pm(h,d,0,-1,i.table):Pm(0,-1,u,c,i.table),i.table.clearCellStyleCache(),i.table.internalProps.layoutMap.isSeriesNumberInBody(i.columnMove.colSource,i.columnMove.rowSource)?i.table.scenegraph.updateHeaderPosition(i.table.scenegraph.proxy.colStart,i.table.scenegraph.proxy.colEnd,i.table.scenegraph.proxy.rowStart,i.table.scenegraph.proxy.rowEnd,s.moveType):s.moveType==="column"?i.table.scenegraph.updateHeaderPosition(h,d,0,-1,s.moveType):i.table.scenegraph.updateHeaderPosition(0,-1,u,c,s.moveType),i.table.internalProps.frozenColDragHeaderMode==="adjustFrozenCount"&&i.table.isListTable()&&(i.table.isLeftFrozenColumn(i.columnMove.colTarget)&&!i.table.isLeftFrozenColumn(i.columnMove.colSource)?i.table.frozenColCount+=l.end.col-l.start.col+1:i.table.isLeftFrozenColumn(i.columnMove.colSource)&&!i.table.isLeftFrozenColumn(i.columnMove.colTarget)&&(i.table.frozenColCount-=l.end.col-l.start.col+1),i.table.isRightFrozenColumn(i.columnMove.colTarget)&&!i.table.isRightFrozenColumn(i.columnMove.colSource)?i.table.rightFrozenColCount+=l.end.col-l.start.col+1:i.table.isRightFrozenColumn(i.columnMove.colSource)&&!i.table.isRightFrozenColumn(i.columnMove.colTarget)&&(i.table.rightFrozenColCount-=l.end.col-l.start.col+1)),n=!0}}return i.columnMove.moving=!1,setTimeout(()=>{delete i.columnMove.colSource,delete i.columnMove.rowSource,delete i.columnMove.colTarget,delete i.columnMove.rowTarget},0),i.table.scenegraph.component.hideMoveCol(),i.columnResize.col<i.table.frozenColCount&&!i.table.isPivotTable()&&!i.table.transpose?(i.table.scenegraph.component.setFrozenColumnShadow(i.table.frozenColCount-1,i.columnResize.isRightFrozen),i.table.scenegraph.component.setRightFrozenColumnShadow(i.table.colCount-i.table.rightFrozenColCount)):i.columnResize.col>=i.table.colCount-i.table.rightFrozenColCount&&!i.table.isPivotTable()&&!i.table.transpose?i.table.scenegraph.component.setRightFrozenColumnShadow(i.table.colCount-i.table.rightFrozenColCount):i.table.options.frozenColCount?i.table.scenegraph.component.setFrozenColumnShadow(i.table.frozenColCount-1):i.table.options.rightFrozenColCount&&i.table.scenegraph.component.setRightFrozenColumnShadow(i.table.colCount-i.table.rightFrozenColCount),i.table.scenegraph.updateNextFrame(),((e=i.table.options.customConfig)===null||e===void 0?void 0:e.notUpdateInColumnRowMove)===!0||n}function Pm(i,t,e,n,o){for(let r=i;r<=t;r++)o._clearColRangeWidthsMap(r);for(let r=e;r<=n;r++)o._clearRowRangeHeightsMap(r)}function Ms(i){var t;if(!i)return;const e=!((t=i.role)===null||t===void 0)&&t.startsWith("icon")?i:i.type==="richtext"?i._currentHoverIcon:void 0;return e?i.type==="richtext"?{icon:e,position:{left:i.globalAABBBounds.x1+e.globalAABBBounds.x1,right:i.globalAABBBounds.x1+e.globalAABBBounds.x2,top:i.globalAABBBounds.y1+e.globalAABBBounds.y1,bottom:i.globalAABBBounds.y1+e.globalAABBBounds.y2,width:e.globalAABBBounds.x2-e.globalAABBBounds.x1,height:e.globalAABBBounds.y2-e.globalAABBBounds.y1},type:"richtext-icon"}:{icon:e,position:{left:e.globalAABBBounds.x1,right:e.globalAABBBounds.x2,top:e.globalAABBBounds.y1,bottom:e.globalAABBBounds.y2,width:e.globalAABBBounds.x2-e.globalAABBBounds.x1,height:e.globalAABBBounds.y2-e.globalAABBBounds.y1},type:"icon"}:void 0}function kL(i,t,e){i=Math.ceil(i),t=Math.ceil(t);let n=e.columnResize.isRightFrozen?e.columnResize.x-i:i-e.columnResize.x;if(Math.abs(n)<1)return;const o=e.table.getColWidth(e.columnResize.col);let r=o;r+=n;const s=e.table.getMinColWidth(e.columnResize.col),l=e.table.getMaxColWidth(e.columnResize.col);if(r<s||r>l){if(o===s||o===l)return;n=o-s>l-o?l-o:s-o}let a=e.table.getColWidth(e.columnResize.col)+n;if(a<e.table.internalProps.limitMinWidth&&(a=e.table.internalProps.limitMinWidth,n=a-e.table.getColWidth(e.columnResize.col)),e.table.widthMode==="adaptive"&&e.columnResize.col<e.table.colCount-1){const h=e.table.getColWidth(e.columnResize.col+1),d=e.table.getMinColWidth(e.columnResize.col+1),u=e.table.getMaxColWidth(e.columnResize.col+1);let c=h;if(c-=n,c<d||c>u){if(h===d||h===u)return;n=h-d>u-h?u-h:d-h}c-n<e.table.internalProps.limitMinWidth&&(n=c-e.table.internalProps.limitMinWidth)}n=Math.ceil(n),e.columnResize.col<e.table.rowHeaderLevelCount||e.columnResize.col>=e.table.colCount-e.table.rightFrozenColCount?Hm(n,e):e.table.internalProps.columnResizeType==="indicator"?LL(n,e):e.table.internalProps.columnResizeType==="indicatorGroup"?FL(n,e):e.table.internalProps.columnResizeType==="all"?EL(n,e):Hm(n,e),e.columnResize.x=i,e.table.scenegraph.component.updateResizeCol(e.columnResize.col,t,e.columnResize.isRightFrozen),e.columnResize.col<e.table.frozenColCount&&!e.table.isPivotTable()&&!e.table.transpose?e.table.scenegraph.component.setFrozenColumnShadow(e.table.frozenColCount-1,e.columnResize.isRightFrozen):e.table.options.frozenColCount&&e.table.scenegraph.component.setFrozenColumnShadow(e.table.frozenColCount-1),(e.columnResize.col>=e.table.colCount-e.table.rightFrozenColCount&&!e.table.isPivotTable()&&!e.table.transpose||e.table.options.rightFrozenColCount)&&e.table.scenegraph.component.setRightFrozenColumnShadow(e.table.colCount-e.table.rightFrozenColCount),e.table.scenegraph.updateNextFrame()}function Hm(i,t){t.table.widthMode==="adaptive"&&t.columnResize.col<t.table.colCount-1?(t.table.scenegraph.updateColWidth(t.columnResize.col,i),t.table.scenegraph.updateColWidth(t.columnResize.col+1,-i),t.table.internalProps._widthResizedColMap.add(t.columnResize.col),t.table.internalProps._widthResizedColMap.add(t.columnResize.col+1)):(t.table.scenegraph.updateColWidth(t.columnResize.col,i),t.table.internalProps._widthResizedColMap.add(t.columnResize.col))}function EL(i,t){const e=t.table.internalProps.layoutMap;for(let n=t.table.frozenColCount;n<t.table.colCount-t.table.rightFrozenColCount;n++){if(!(t.table.internalProps.transpose||t.table.isPivotTable()&&!e.indicatorsAsCol)){const o=e.getBody(n,t.table.columnHeaderLevelCount);if(o!=null&&o.disableColumnResize)continue}t.table.scenegraph.updateColWidth(n,i),t.table.internalProps._widthResizedColMap.add(n)}}function LL(i,t){const e=t.table.internalProps.layoutMap;let n,o,r;if(e.indicatorsAsCol)n=e.getIndicatorKey(t.columnResize.col,t.table.columnHeaderLevelCount);else{const s=e.getCellHeaderPaths(t.columnResize.col,t.table.columnHeaderLevelCount-1),l=s.colHeaderPaths[s.colHeaderPaths.length-1];o=l.dimensionKey,r=l.value}for(let s=t.table.rowHeaderLevelCount;s<t.table.colCount-t.table.rightFrozenColCount;s++){const l=e.getIndicatorKey(s,t.table.columnHeaderLevelCount);if(e.indicatorsAsCol&&l===n)t.table.scenegraph.updateColWidth(s,i),t.table.internalProps._widthResizedColMap.add(s);else if(!e.indicatorsAsCol){const a=e.getCellHeaderPaths(s,t.table.columnHeaderLevelCount-1),h=a==null?void 0:a.colHeaderPaths[a.colHeaderPaths.length-1];h&&o===h.dimensionKey&&r===h.value&&(t.table.scenegraph.updateColWidth(s,i),t.table.internalProps._widthResizedColMap.add(s))}}}function FL(i,t){const e=t.table.internalProps.layoutMap,n=e.getCellHeaderPaths(t.columnResize.col,t.table.columnHeaderLevelCount),o=e.getHeadNodeByRowOrColDimensions(n.colHeaderPaths.slice(0,n.colHeaderPaths.length-1)),r=o.startInTotal+t.table.frozenColCount,s=o.startInTotal+t.table.frozenColCount+o.size-1,l=t.table.getColsWidth(r,s),a=i;for(let h=r;h<=s;h++){if(!(t.table.internalProps.transpose||t.table.isPivotTable()&&!e.indicatorsAsCol)){const u=e.getBody(h,t.table.columnHeaderLevelCount);if(u!=null&&u.disableColumnResize)continue}let d=t.table.getColWidth(h)/l*a;d>0&&d<.5?d=.5:d<0&&d>=-.5&&(d=-.5),t.table.scenegraph.updateColWidth(h,d),t.table.internalProps._widthResizedColMap.add(h)}}function zL(i,t,e,n,o,r){const s=r.table.getRecordShowIndexByCell(i,t);if(s>=0){const l=r.table.dataSource.getIndexKey(s);n==="column"?Z(o)?(r.radioState[e]={},r.radioState[e][l]=o):r.radioState[e]=l:(r.radioState[e]||(r.radioState[e]={}),Z(o)?r.radioState[e][l]=o:r.radioState[e][l]=!0)}}function IL(i,t,e){var n;const o=e.getBodyColumnDefine(i,t),r=o==null?void 0:o.field,s=e.getCellType(i,t);if(O(r)&&s==="radio"){const l=e.dataSource.getIndexKey(e.getRecordShowIndexByCell(i,t)),a=(n=e.stateManager.radioState)===null||n===void 0?void 0:n[r];if(Z(a)){if(a===l)return!0}else if(kt(a)){const h=a[l];if(Z(h))return h}}return!1}function OL(i,t,e,n,o,r,s){var l,a,h,d,u;const c=s.table.getRecordShowIndexByCell(i,t);if(c>=0){const f=s.table.dataSource.getIndexKey(c);if(n==="column"){if(!O(s.radioState[e])&&r)return Z(o)?(s.radioState[e]={},s.radioState[e][f]=o):s.radioState[e]=f,!0;if(Z(s.radioState[e])&&!Z(o))return s.radioState[e]===f;if(Z(s.radioState[e])&&Z(o)||kt(s.radioState[e])&&!Z(o))return!1;if(kt(s.radioState[e])&&Z(o))return s.radioState[e][f]===o}else if(n==="cell"){if(!O(s.radioState[e])&&r)return s.radioState[e]={},Z(o)?s.radioState[e][f]=o:s.radioState[e][f]=!0,!0;if(!O((l=s.radioState[e])===null||l===void 0?void 0:l[f])&&r)return Z(o)?s.radioState[e][f]=o:s.radioState[e][f]=!0,!0;if(He((a=s.radioState[e])===null||a===void 0?void 0:a[f])&&!Z(o))return s.radioState[e][f];if(He((h=s.radioState[e])===null||h===void 0?void 0:h[f])&&Z(o)||Z((d=s.radioState[e])===null||d===void 0?void 0:d[f])&&!Z(o))return!1;if(Z((u=s.radioState[e])===null||u===void 0?void 0:u[f])&&Z(o))return s.radioState[e][f]===o}}return r}function DL(i,t,e,n){const o=n.scenegraph.getCell(i,t);if(o)if(Z(e)){const r=o.getChildAt(e);r==null||r._handlePointerUp()}else{const r=o.getChildByName("radio");r==null||r._handlePointerUp()}}function WL(i,t,e){const{radioState:n,table:o}=e;if(o.internalProps.transpose?(i=o.getRecordShowIndexByCell(i,0),t=o.getRecordShowIndexByCell(t,0)):(i=o.getRecordShowIndexByCell(0,i),t=o.getRecordShowIndexByCell(0,t)),i>t){const r=n[i];for(let s=i;s>t;s--)n[s]=n[s-1];n[t]=r}else if(i<t){const r=n[i];for(let s=i;s<t;s++)n[s]=n[s+1];n[t]=r}}function NL(i,t,e,n,o){const r=o.table.getRecordShowIndexByCell(i,t);if(r>=0){const s=o.table.dataSource.getIndexKey(r).toString();o.checkedState.has(s)?o.checkedState.get(s)[e]=n:o.checkedState.set(s,{[e]:n})}}function VL(i,t,e){var n;e.headerCheckedState[i]=t,(n=e.checkedState)===null||n===void 0||n.forEach(o=>{o[i]=t})}function GL(i,t,e,n,o){var r,s;if(o.table.isHeader(i,t)){if(O(o.headerCheckedState[e]))return o.headerCheckedState[e];if(typeof n=="function")return;if(O(n))o.headerCheckedState[e]=n;else if(((r=o.checkedState)===null||r===void 0?void 0:r.size)>0)return o.updateHeaderCheckedState(e,i,t);return o.headerCheckedState[e]}const l=o.table.getRecordShowIndexByCell(i,t);if(l>=0){const a=o.table.dataSource.getIndexKey(l).toString();if(O((s=o.checkedState.get(a))===null||s===void 0?void 0:s[e]))return o.checkedState.get(a)[e];o.checkedState.has(a)?o.checkedState.get(a)[e]=n:o.checkedState.set(a,{[e]:n})}return n}function jL(i,t){t.checkedState.clear(),t.headerCheckedState={},t.radioState={};let e=!1;if(t._checkboxCellTypeFields=[],t._headerCheckFuncs={},t.table.internalProps.layoutMap.headerObjects.forEach((n,o)=>{if(n.headerType==="checkbox"){const r=n.define.checked;r==null||typeof r=="function"?(e=!0,typeof r=="function"&&(t._headerCheckFuncs[n.field]=r)):t.headerCheckedState[n.field]=r,n.define.cellType!=="checkbox"&&!Mt(n.define.cellType)||n.fieldFormat||t._checkboxCellTypeFields.push(n.field)}}),t.table.leftRowSeriesNumberCount===1)t.headerCheckedState._vtable_rowSeries_number=!1,t._checkboxCellTypeFields.push("_vtable_rowSeries_number"),e=!0;else if(t.table.leftRowSeriesNumberCount>1){for(let n=0;n<t.table.leftRowSeriesNumberCount;n++)t.headerCheckedState[`_vtable_rowSeries_number_${n}`]=!1,t._checkboxCellTypeFields.push(`_vtable_rowSeries_number_${n}`);e=!0}e&&qL(i,t)}function UL(i,t,e,n){let o=!0,r=!0,s=!1;return t.checkedState.forEach((l,a)=>{var h,d;a=a.includes(",")?a.split(",").map(g=>Number(g)):Number(a);const u=t.table.getTableIndexByRecordIndex(a),c=t.table.transpose?t.table.getCustomMerge(u,n):t.table.getCustomMerge(e,u),f=(h=t.table.dataSource)===null||h===void 0?void 0:h.get(a);c||!(!((d=t.table.internalProps.rowSeriesNumber)===null||d===void 0)&&d.enableTreeCheckbox)&&(f!=null&&f.vtableMerge)||((l==null?void 0:l[i])!==!0?o=!1:(r=!1,s=!0))}),o?(t.headerCheckedState[i]=!0,o):r?(t.headerCheckedState[i]=!1,!1):!!s&&(t.headerCheckedState[i]="indeterminate","indeterminate")}function $L(i,t){for(let e=t.checkedState.size;e<i.length;e++){const n=i[e];t._checkboxCellTypeFields.forEach(o=>{const r=n[o];let s;kt(r)?s=r.checked:typeof r=="boolean"&&(s=r);const l=e.toString();t.checkedState.get(l)||t.checkedState.set(l,{}),t.checkedState.get(l)[o]=s})}}function KL(i,t,e,n){const o=n.scenegraph.getCell(i,t),r=o==null?void 0:o.getChildByName("checkbox");if(!r){const a=n.getHeaderField(i,t);if(n.isHeader(i,t))n.stateManager.setHeaderCheckedState(a,e),n.getCellType(i,t)==="checkbox"&&n.scenegraph.updateCheckboxCellState(i,t,e);else if(n.stateManager.setCheckedState(i,t,a,e),n.getCellType(i,t)==="checkbox"){const h=n.stateManager.headerCheckedState[a],d=n.stateManager.updateHeaderCheckedState(a,i,t);h!==d&&n.scenegraph.updateHeaderCheckboxCellState(i,t,d)}return}const{checked:s,indeterminate:l}=r.attribute;l?(e||r._handlePointerUp(),r._handlePointerUp()):s?e||r._handlePointerUp():e&&r._handlePointerUp()}function na(i,t,e,n){const o=n.scenegraph.getCell(i,t),r=o==null?void 0:o.getChildByName("checkbox");r&&(e==="indeterminate"?(r.setAttribute("indeterminate",!0),r.setAttribute("checked",void 0)):(r.setAttribute("indeterminate",void 0),r.setAttribute("checked",e)))}function YL(i,t,e){const{checkedState:n,table:o}=e;let r,s;if(o.internalProps.transpose?(i=o.getRecordShowIndexByCell(i,0),t=o.getRecordShowIndexByCell(t,0)):(r=o.isPivotTable()?void 0:o.getRecordIndexByCell(0,i),s=o.isPivotTable()?void 0:o.getRecordIndexByCell(0,t)),Z(r)&&Z(s)){if(i>t){const l=n.get(i.toString());for(let a=i;a>t;a--)n.set(a.toString(),n.get((a-1).toString()));n.set(t.toString(),l)}else if(i<t){const l=n.get(i.toString());for(let a=i;a<t;a++)n.set(a.toString(),n.get((a+1).toString()));n.set(t.toString(),l)}}else if(Q(r)&&Q(s)){if((i=r[r.length-1])>(t=s[s.length-1])){const l=n.get(r.toString());for(let a=i;a>t;a--){const h=[...r];h[h.length-1]=a;const d=[...r];d[d.length-1]=a-1,n.set(h.toString(),n.get(d.toString()))}n.set(s.toString(),l)}else if(i<t){const l=n.get(r.toString());for(let a=i;a<t;a++){const h=[...r];h[h.length-1]=a;const d=[...r];d[d.length-1]=a+1,n.set(h.toString(),n.get(d.toString()))}n.set(s.toString(),l)}}}function XL(i){const t=[],e=i.dataSource,n=e.dataConfig.groupByRules.length+1;return e.currentIndexedData.forEach((o,r)=>{if(Q(o)&&o.length===n){const s=e.getOriginRecordIndexForGroup(o);t[s]=i.stateManager.checkedState.get(o.toString())}}),t}function qL(i,t){const e=t.table,n=e.isPivotTable()?0:e.internalProps.transpose?e.rowHeaderLevelCount:e.columnHeaderLevelCount,o=e.isPivotTable()?Q(i)?i.length:0:e.internalProps.transpose?e.colCount:e.rowCount;for(let r=0;r+n<o;r++){const s=e.isPivotTable()?i[r]:e.dataSource.get(r);t._checkboxCellTypeFields.forEach(l=>{const a=s&&s[l];let h;if(kt(a)?h=a.checked:typeof a=="boolean"&&(h=a),h==null){const u=t._headerCheckFuncs[l];if(u){const c=t.table.getCellAddrByFieldRecord(l,r);h=zt(u,{col:c.col,row:c.row,table:t.table,context:null,value:a})}}const d=e.isPivotTable()?r.toString():t.table.dataSource.getIndexKey(r).toString();t.checkedState.get(d)||t.checkedState.set(d,{}),t.checkedState.get(d)[l]=h})}}function ZL(i,t,e){i=Math.ceil(i),t=Math.ceil(t);let n=e.rowResize.isBottomFrozen?e.rowResize.y-t:t-e.rowResize.y;if(Math.abs(n)<1)return;e.table.getRowHeight(e.rowResize.row);let o=e.table.getRowHeight(e.rowResize.row)+n;if(o<e.table.internalProps.limitMinHeight&&(o=e.table.internalProps.limitMinHeight,n=o-e.table.getRowHeight(e.rowResize.row)),e.table.heightMode==="adaptive"&&e.rowResize.row<e.table.rowCount-1){let r=e.table.getRowHeight(e.rowResize.row+1);r-=n,r-n<e.table.internalProps.limitMinHeight&&(n=r-e.table.internalProps.limitMinHeight)}n=Math.ceil(n),e.rowResize.row<e.table.columnHeaderLevelCount||e.rowResize.row>=e.table.rowCount-e.table.bottomFrozenRowCount?km(n,e):e.table.internalProps.rowResizeType==="indicator"?QL(n,e):e.table.internalProps.rowResizeType==="indicatorGroup"?tF(n,e):e.table.internalProps.rowResizeType==="all"?JL(n,e):km(n,e),e.rowResize.y=t,e.table.scenegraph.component.updateResizeRow(e.rowResize.row,i,e.rowResize.isBottomFrozen),e.table.scenegraph.updateNextFrame()}function km(i,t){t.table.heightMode==="adaptive"&&t.rowResize.row<t.table.rowCount-1?(t.table.scenegraph.updateRowHeight(t.rowResize.row,i),t.table.scenegraph.updateRowHeight(t.rowResize.row+1,-i),t.table.internalProps._heightResizedRowMap.add(t.rowResize.row),t.table.internalProps._heightResizedRowMap.add(t.rowResize.row+1)):(t.table.scenegraph.updateRowHeight(t.rowResize.row,i),t.table.internalProps._heightResizedRowMap.add(t.rowResize.row))}function JL(i,t){for(let e=t.table.frozenRowCount;e<t.table.rowCount-t.table.bottomFrozenRowCount;e++)t.table.scenegraph.updateRowHeight(e,i),t.table.internalProps._heightResizedRowMap.add(e)}function QL(i,t){var e,n;const o=t.table.internalProps.layoutMap;let r,s,l;if(o.indicatorsAsCol){const a=o.getCellHeaderPaths(t.table.rowHeaderLevelCount-1,t.rowResize.row),h=(e=a.rowHeaderPaths)===null||e===void 0?void 0:e[a.rowHeaderPaths.length-1];s=h==null?void 0:h.dimensionKey,l=h==null?void 0:h.value}else r=o.getIndicatorKey(t.table.rowHeaderLevelCount,t.rowResize.row);for(let a=t.table.columnHeaderLevelCount;a<t.table.rowCount-t.table.bottomFrozenRowCount;a++){const h=o.getIndicatorKey(t.table.rowHeaderLevelCount,a);if(o.indicatorsAsCol||h!==r){if(o.indicatorsAsCol){const d=o.getCellHeaderPaths(t.table.rowHeaderLevelCount-1,a),u=(n=d==null?void 0:d.rowHeaderPaths)===null||n===void 0?void 0:n[d.rowHeaderPaths.length-1];u&&s===u.dimensionKey&&l===u.value&&(t.table.scenegraph.updateRowHeight(a,i),t.table.internalProps._heightResizedRowMap.add(a))}}else t.table.scenegraph.updateRowHeight(a,i),t.table.internalProps._heightResizedRowMap.add(a)}}function tF(i,t){const e=t.table.internalProps.layoutMap,n=e.getCellHeaderPaths(t.table.rowHeaderLevelCount,t.rowResize.row),o=e.getHeadNodeByRowOrColDimensions(n.rowHeaderPaths.slice(0,n.rowHeaderPaths.length-1)),r=o.startInTotal+t.table.frozenRowCount,s=o.startInTotal+t.table.frozenRowCount+o.size-1,l=t.table.getRowsHeight(r,s),a=i;for(let h=r;h<=s;h++){let d=t.table.getRowHeight(h)/l*a;d>0&&d<.5?d=.5:d<0&&d>=-.5&&(d=-.51),t.table.scenegraph.updateRowHeight(h,d),t.table.internalProps._heightResizedRowMap.add(h)}}function eF(i){const{customSelectedRangeComponents:t}=i.table.scenegraph;t.forEach((e,n)=>{e.rect.delete()}),t.clear(),i.select.customSelectRanges=[]}function iF(i,t){const{customSelectedRangeComponents:e}=t.table.scenegraph;i.forEach(n=>{var o,r,s,l;const{range:a,style:h}=n,d=qt({fill:(o=h.cellBgColor)!==null&&o!==void 0&&o,stroke:(r=h.cellBorderColor)!==null&&r!==void 0&&r,lineWidth:(s=h.cellBorderLineWidth)!==null&&s!==void 0?s:0,lineDash:(l=h.cellBorderLineDash)!==null&&l!==void 0?l:[],pickable:!1});e.set(`${a.start.col}-${a.start.row}-${a.end.col}-${a.end.row}`,{rect:d,role:"body"})}),t.select.customSelectRanges=i,_w(t.table.scenegraph),t.table.scenegraph.updateNextFrame()}class nF{constructor(t){this.fastScrolling=!1,this.checkedState=new Map,this.headerCheckedState={},this._checkboxCellTypeFields=[],this._headerCheckFuncs={},this.radioState={},this.resetInteractionState=P_(e=>{this.updateInteractionState(e??vt.default)},100),this.table=t,this.initState(),this.updateVerticalScrollBar=this.updateVerticalScrollBar.bind(this),this.updateHorizontalScrollBar=this.updateHorizontalScrollBar.bind(this)}initState(){this._initState(),this.setHoverState(),this.setSelectState(),this.setFrozenState()}updateOptionSetState(){this._updateOptionSetState(),this.setHoverState(),this.setSelectState(),this.setFrozenState()}_updateOptionSetState(){this.interactionState=vt.default,this.hoverIcon={col:-1,row:-1,icon:null},this.columnResize={col:-1,x:0,resizing:!1},this.rowResize={row:-1,y:0,resizing:!1},this.columnMove={colSource:-1,colTarget:-1,rowSource:-1,rowTarget:-1,x:0,y:0,moving:!1},this.menu={x:-1,y:-1,isShow:!1,itemList:[],bounds:new Rn,highlightIndex:-1,dropDownMenuHighlight:[]},this.sort=[{col:-1,row:-1,order:"normal"}],this.frozen={col:-1,row:-1},this.tablePosition={absoluteX:0,absoluteY:0},this.drill={col:-1,row:-1},this.sparkLine={col:-1,row:-1}}_initState(){this.interactionState=vt.default,this.select={highlightScope:Ht.single,ranges:[],cellPos:{col:-1,row:-1},selecting:!1},this.fillHandle={isFilling:!1,startX:void 0,startY:void 0},this.hover={highlightScope:Ht.single,cellPos:{col:-1,row:-1}},this.hoverIcon={col:-1,row:-1,icon:null},this.columnResize={col:-1,x:0,resizing:!1},this.rowResize={row:-1,y:0,resizing:!1},this.columnMove={colSource:-1,colTarget:-1,rowSource:-1,rowTarget:-1,x:0,y:0,moving:!1},this.menu={x:-1,y:-1,isShow:!1,itemList:[],bounds:new Rn,highlightIndex:-1,dropDownMenuHighlight:[]},this.sort=[{col:-1,row:-1,order:"normal"}],this.frozen={col:-1,row:-1},this.scroll={horizontalBarPos:0,verticalBarPos:0},this.tablePosition={absoluteX:0,absoluteY:0},this.drill={col:-1,row:-1},this.sparkLine={col:-1,row:-1}}setHoverState(){var t;const{highlightMode:e,disableHover:n,disableHeaderHover:o}=(t=this.table.options.hover)!==null&&t!==void 0?t:{highlightMode:"cell"};n?this.hover.highlightScope=Ht.none:e==="cross"?this.hover.highlightScope=Ht.cross:e==="row"?this.hover.highlightScope=Ht.row:e==="column"?this.hover.highlightScope=Ht.column:e==="cell"&&(this.hover.highlightScope=Ht.single),this.hover.singleStyle=!n,this.hover.disableHeader=o,(this.hover.highlightScope===Ht.none||o)&&(this.hover.cellPosContainHeader={col:-1,row:-1})}setSelectState(){var t;const{headerSelectMode:e,disableSelect:n,disableHeaderSelect:o,highlightMode:r,highlightInRange:s}=Object.assign({},{headerSelectMode:"inline",disableSelect:!1,disableHeaderSelect:!1,highlightMode:"cell",highlightInRange:!1},this.table.options.select);this.select.highlightScope=n===!0?Ht.none:r==="cross"?Ht.cross:r==="row"?Ht.row:r==="column"?Ht.column:Ht.single,this.select.singleStyle=!n,this.select.disableHeader=o,this.select.headerSelectMode=e,this.select.highlightInRange=s,this.select.disableCtrlMultiSelect=((t=this.table.options.keyboardOptions)===null||t===void 0?void 0:t.ctrlMultiSelect)===!1}isSelected(t,e){let n=!1;return this.select.ranges.forEach(o=>{Bi(o,t,e)&&(n=!0)}),n}setSortState(t){const e=this,n=(t=!t||Array.isArray(t)?t:[t])&&t.reduce((o,r)=>{var s,l,a;const h=(s=function(d){const u=[];return function c(f,g=0){f.forEach(p=>{var v;const m=p.startInTotal?(v=p.startInTotal+e.table.internalProps.layoutMap.leftRowSeriesNumberColumnCount)!==null&&v!==void 0?v:0:g;p.columns?c(p.columns,m):u.push(Object.assign(Object.assign({},p),{startIndex:m}))})}(d),u}(this.table.internalProps.columns))===null||s===void 0?void 0:s.find(d=>(d==null?void 0:d.field)===(r==null?void 0:r.field));return this.table.internalProps.transpose?o.push({field:r.field,order:r.order,row:(l=(h==null?void 0:h.startInTotal)+this.table.internalProps.layoutMap.leftRowSeriesNumberColumnCount)!==null&&l!==void 0?l:0,col:h==null?void 0:h.level}):o.push({field:r.field,order:r.order,col:(a=(h==null?void 0:h.startInTotal)+this.table.internalProps.layoutMap.leftRowSeriesNumberColumnCount)!==null&&a!==void 0?a:0,row:h==null?void 0:h.level}),o},[]);this.sort=n||[]}setFrozenState(){this.frozen.col=this.table.frozenColCount-1}updateInteractionState(t){if(this.interactionState===t)return;t===vt.scrolling&&(this.interactionStateBeforeScroll=this.interactionState);const e=this.interactionState;this.interactionState=t,e===vt.scrolling&&vt.default}updateHoverhighlightScope(t){this.hover.highlightScope!==t&&(this.hover.highlightScope=t)}updateHoverPos(t,e){bL(this,t,e)}updateSelectPos(t,e,n=!1,o=!1,r=!1,s=!0,l=!1){e!==-1&&e!==-1&&(this.select.selecting=!0),SL(this,t,e,n,o,r,s,l)}checkCellRangeInSelect(t,e){return pL(t,e,this.select.ranges,this.select.highlightScope)}updateHoverIcon(t,e,n,o){var r,s,l,a,h,d,u,c,f;if(!((r=this.residentHoverIcon)===null||r===void 0)&&r.icon&&n===((s=this.residentHoverIcon)===null||s===void 0?void 0:s.icon))return;const g=Ms(n);if(g)if(g.type==="richtext-icon"){const p=g.icon;if(this.hoverIcon.icon&&this.hoverIcon.icon!==((a=this.residentHoverIcon)===null||a===void 0?void 0:a.icon)&&(this.table.scenegraph.setIconNormalStyle(this.hoverIcon.icon,this.hoverIcon.col,this.hoverIcon.row),this.hoverIcon.col=-1,this.hoverIcon.col=-1,this.hoverIcon.icon=null,this.table.scenegraph.updateNextFrame()),p.attribute.tooltip){const v={content:p.attribute.tooltip.title,referencePosition:{rect:g.position,placement:p.attribute.tooltip.placement},style:Object.assign({},(h=this.table.internalProps.theme)===null||h===void 0?void 0:h.tooltipStyle,(d=p.tooltip)===null||d===void 0?void 0:d.style,(c=(u=p.attribute)===null||u===void 0?void 0:u.tooltip)===null||c===void 0?void 0:c.style),disappearDelay:p.attribute.tooltip.disappearDelay};this.table.internalProps.tooltipHandler.isBinded(v)||this.table.showTooltip(t,e,v)}}else{const p=g.icon;p!==this.hoverIcon.icon&&(this.hoverIcon.icon&&this.hoverIcon.icon!==((f=this.residentHoverIcon)===null||f===void 0?void 0:f.icon)&&this.table.scenegraph.setIconNormalStyle(this.hoverIcon.icon,this.hoverIcon.col,this.hoverIcon.row),this.hoverIcon.col=t,this.hoverIcon.row=e,this.hoverIcon.icon=p,this.table.scenegraph.setIconHoverStyle(p,t,e,o),this.table.scenegraph.updateNextFrame())}else this.hoverIcon.icon&&this.hoverIcon.icon!==((l=this.residentHoverIcon)===null||l===void 0?void 0:l.icon)&&(this.table.scenegraph.setIconNormalStyle(this.hoverIcon.icon,this.hoverIcon.col,this.hoverIcon.row),this.hoverIcon.col=-1,this.hoverIcon.col=-1,this.hoverIcon.icon=null,this.table.scenegraph.updateNextFrame())}isResizeCol(){return this.columnResize.resizing}isResizeRow(){return this.rowResize.resizing}isFillHandle(){return this.fillHandle.isFilling}isSelecting(){return this.select.selecting}endSelectCells(t=!0,e=!0){if(this.select.selecting){if(this.select.selecting=!1,this.select.ranges.length===0)return;const n=this.select.ranges[this.select.ranges.length-1];Ak(n,this.table);let o=!1;for(let l=0;l<this.select.ranges.length-1;l++){const a=this.select.ranges[l];if(a&&a.start.col===n.start.col&&a.start.row===n.start.row&&a.end.col===n.end.col&&a.end.row===n.end.row){o=!0;break}}o?(this.select.ranges.pop(),ww(this.table.scenegraph),this.table.scenegraph.selectingRangeComponents.clear()):xL(this.table.scenegraph);const r=this.select.ranges[this.select.ranges.length-1].end.col,s=this.select.ranges[this.select.ranges.length-1].end.row;t&&this.table.fireListeners(U.SELECTED_CELL,{ranges:this.select.ranges,col:r,row:s})}else e&&this.select.ranges.length===0&&this.table.fireListeners(U.SELECTED_CLEAR,{})}endResizeCol(){setTimeout(()=>{this.columnResize.resizing=!1},0),this.table.scenegraph.updateChartSizeForResizeColWidth(this.columnResize.col),this.checkFrozen(),this.table.scenegraph.component.hideResizeCol(),this.table.scenegraph.updateNextFrame()}startResizeCol(t,e,n,o){this.columnResize.resizing=!0,this.columnResize.col=t,this.columnResize.x=e,this.columnResize.isRightFrozen=o,this.table.scenegraph.component.showResizeCol(t,n,o),this.table.scenegraph.updateNextFrame()}updateResizeCol(t,e){kL(t,e,this)}endResizeRow(){setTimeout(()=>{this.rowResize.resizing=!1},0),this.table.scenegraph.updateChartSizeForResizeRowHeight(this.rowResize.row),this.table.scenegraph.component.hideResizeRow(),this.table.scenegraph.updateNextFrame()}startResizeRow(t,e,n,o){this.rowResize.resizing=!0,this.rowResize.row=t,this.rowResize.y=n,this.rowResize.isBottomFrozen=o,this.table.scenegraph.component.showResizeRow(t,e,o),this.table.scenegraph.updateNextFrame()}updateResizeRow(t,e){ZL(t,e,this)}startFillSelect(t,e){this.fillHandle.isFilling=!0,this.fillHandle.startX=t,this.fillHandle.startY=e;const n=this.select.ranges[this.select.ranges.length-1];this.fillHandle.beforeFillMinCol=Math.min(n.start.col,n.end.col),this.fillHandle.beforeFillMinRow=Math.min(n.start.row,n.end.row),this.fillHandle.beforeFillMaxCol=Math.max(n.start.col,n.end.col),this.fillHandle.beforeFillMaxRow=Math.max(n.start.row,n.end.row),this.table.fireListeners(U.MOUSEDOWN_FILL_HANDLE,{})}endFillSelect(){this.fillHandle.isFilling=!1,this.fillHandle.startX=void 0,this.fillHandle.startY=void 0,this.fillHandle.directionRow=void 0;const t=Math.min(this.select.ranges[0].start.col,this.select.ranges[0].end.col),e=Math.min(this.select.ranges[0].start.row,this.select.ranges[0].end.row),n=Math.max(this.select.ranges[0].start.col,this.select.ranges[0].end.col),o=Math.max(this.select.ranges[0].start.row,this.select.ranges[0].end.row);this.fillHandle.beforeFillMinCol===t&&this.fillHandle.beforeFillMinRow===e&&this.fillHandle.beforeFillMaxCol===n&&this.fillHandle.beforeFillMaxRow===o||this.table.eventManager.isDraging&&this.table.fireListeners(U.DRAG_FILL_HANDLE_END,{direction:this.fillHandle.direction}),this.fillHandle.beforeFillMaxCol=void 0,this.fillHandle.beforeFillMaxRow=void 0,this.fillHandle.beforeFillMinCol=void 0,this.fillHandle.beforeFillMinRow=void 0}startMoveCol(t,e,n,o,r){TL(t,e,n,o,this,r)}updateMoveCol(t,e,n,o,r){PL(t,e,n,o,this,r)}isMoveCol(){return this.columnMove.moving}endMoveCol(){return HL(this)}checkFrozen(){var t;let e=this.table.options.frozenColCount?this.table.options.frozenColCount:this.table.isPivotTable()||this.table.isListTable()&&this.table.internalProps.transpose?((t=this.table.rowHeaderLevelCount)!==null&&t!==void 0?t:0)+this.table.internalProps.layoutMap.leftRowSeriesNumberColumnCount:0;if(e){e>this.table.colCount&&(e=this.table.colCount);const n=this.table._getMaxFrozenWidth();if(this.table.getColsWidth(0,e-1)>n)if(this.table.internalProps.unfreezeAllOnExceedsMaxWidth)this.table._setFrozenColCount(0),this.setFrozenCol(-1);else{const o=this.table._getComputedFrozenColCount(e);this.table._setFrozenColCount(o),this.setFrozenCol(o)}else this.table.frozenColCount!==e&&(this.table._setFrozenColCount(e),this.setFrozenCol(e))}}setFrozenCol(t){t!==this.frozen.col?(this.frozen.col=t,this.table.scenegraph.updateFrozen(),this.table.scenegraph.updateFrozenIcon(0,this.table.colCount-1)):this.table.scenegraph.updateFrozenIcon(0,this.table.colCount-1)}setFrozenRow(t){t!==this.frozen.row&&(this.frozen.row=t,this.table.scenegraph.updateRowFrozen())}checkVerticalScrollBarEnd(){var t,e;const n=this.table.getAllRowsHeight(),o=this.scroll.verticalBarPos,r=this.table.tableNoFrameHeight;o+r>=n&&this.table.fireListeners(U.SCROLL_VERTICAL_END,{scrollTop:o,scrollLeft:this.scroll.horizontalBarPos,scrollHeight:(t=this.table.theme.scrollStyle)===null||t===void 0?void 0:t.width,scrollWidth:(e=this.table.theme.scrollStyle)===null||e===void 0?void 0:e.width,viewHeight:r,viewWidth:this.table.tableNoFrameWidth})}checkHorizontalScrollBarEnd(){var t,e;const n=this.table.getAllColsWidth(),o=this.scroll.horizontalBarPos,r=this.table.tableNoFrameWidth;o+r>=n&&this.table.fireListeners(U.SCROLL_HORIZONTAL_END,{scrollTop:this.scroll.verticalBarPos,scrollLeft:o,scrollHeight:(t=this.table.theme.scrollStyle)===null||t===void 0?void 0:t.width,scrollWidth:(e=this.table.theme.scrollStyle)===null||e===void 0?void 0:e.width,viewHeight:this.table.tableNoFrameHeight,viewWidth:r})}updateVerticalScrollBar(t){var e,n;const o=this.table.getAllRowsHeight(),r=this.scroll.verticalBarPos;this.scroll.verticalBarPos=Math.ceil(t*(o-this.table.scenegraph.height)),O(this.scroll.verticalBarPos)&&!isNaN(this.scroll.verticalBarPos)||(this.scroll.verticalBarPos=0),this.table.scenegraph.setY(-this.scroll.verticalBarPos,t===1),this.scroll.verticalBarPos-=this.table.scenegraph.proxy.deltaY,this.table.scenegraph.proxy.deltaY=0,this.updateHoverPos(-1,-1),this.table.fireListeners(U.SCROLL,{event:void 0,scrollTop:this.scroll.verticalBarPos,scrollLeft:this.scroll.horizontalBarPos,scrollHeight:(e=this.table.theme.scrollStyle)===null||e===void 0?void 0:e.width,scrollWidth:(n=this.table.theme.scrollStyle)===null||n===void 0?void 0:n.width,viewHeight:this.table.tableNoFrameHeight,viewWidth:this.table.tableNoFrameWidth,scrollDirection:"vertical",scrollRatioY:t}),r!==this.scroll.verticalBarPos&&this.checkVerticalScrollBarEnd()}updateHorizontalScrollBar(t){var e,n;const o=this.table.getAllColsWidth(),r=this.scroll.horizontalBarPos;this.scroll.horizontalBarPos=Math.ceil(t*(o-this.table.scenegraph.width)),O(this.scroll.horizontalBarPos)&&!isNaN(this.scroll.horizontalBarPos)||(this.scroll.horizontalBarPos=0),this.table.scenegraph.setX(-this.scroll.horizontalBarPos,t===1),this.scroll.horizontalBarPos-=this.table.scenegraph.proxy.deltaX,this.table.scenegraph.proxy.deltaX=0,this.updateHoverPos(-1,-1),this.table.fireListeners(U.SCROLL,{event:void 0,scrollTop:this.scroll.verticalBarPos,scrollLeft:this.scroll.horizontalBarPos,scrollHeight:(e=this.table.theme.scrollStyle)===null||e===void 0?void 0:e.width,scrollWidth:(n=this.table.theme.scrollStyle)===null||n===void 0?void 0:n.width,viewHeight:this.table.tableNoFrameHeight,viewWidth:this.table.tableNoFrameWidth,scrollDirection:"horizontal",scrollRatioX:t}),r!==this.scroll.horizontalBarPos&&this.checkHorizontalScrollBarEnd()}setScrollTop(t,e,n=!0){var o,r,s;const l=this.table.getAllRowsHeight(),a=!((o=this.table.options.customConfig)===null||o===void 0)&&o._disableColumnAndRowSizeRound?1:0;t=Math.max(0,Math.min(t,l-this.table.scenegraph.height-a)),((t=Math.ceil(t))!==this.scroll.verticalBarPos||this.table.isPivotChart())&&this.updateHoverPos(-1,-1);const h=this.scroll.verticalBarPos;this.scroll.verticalBarPos=t,O(this.scroll.verticalBarPos)&&!isNaN(this.scroll.verticalBarPos)||(this.scroll.verticalBarPos=0),this.table.scenegraph.setY(-t);const d=t/(l-this.table.scenegraph.height);this.table.scenegraph.component.updateVerticalScrollBarPos(d),h!==t&&n&&(this.table.fireListeners(U.SCROLL,{event:e==null?void 0:e.nativeEvent,scrollTop:this.scroll.verticalBarPos,scrollLeft:this.scroll.horizontalBarPos,scrollHeight:(r=this.table.theme.scrollStyle)===null||r===void 0?void 0:r.width,scrollWidth:(s=this.table.theme.scrollStyle)===null||s===void 0?void 0:s.width,viewHeight:this.table.tableNoFrameHeight,viewWidth:this.table.tableNoFrameWidth,scrollDirection:"vertical",scrollRatioY:d}),this.checkVerticalScrollBarEnd())}setScrollLeft(t,e,n=!0){var o,r,s;this.table.scrollLeft;const l=this.table.getAllColsWidth(),a=(this.table.getFrozenColsWidth(),!((o=this.table.options.customConfig)===null||o===void 0)&&o._disableColumnAndRowSizeRound?1:0);t=Math.max(0,Math.min(t,l-this.table.scenegraph.width-a)),(t=Math.ceil(t))!==this.scroll.horizontalBarPos&&this.updateHoverPos(-1,-1);const h=this.scroll.horizontalBarPos;this.scroll.horizontalBarPos=t,O(this.scroll.horizontalBarPos)&&!isNaN(this.scroll.horizontalBarPos)||(this.scroll.horizontalBarPos=0),this.table.scenegraph.setX(-t);const d=t/(l-this.table.scenegraph.width);this.table.scenegraph.component.updateHorizontalScrollBarPos(d),h!==t&&n&&(this.table.fireListeners(U.SCROLL,{event:e==null?void 0:e.nativeEvent,scrollTop:this.scroll.verticalBarPos,scrollLeft:this.scroll.horizontalBarPos,scrollHeight:(r=this.table.theme.scrollStyle)===null||r===void 0?void 0:r.width,scrollWidth:(s=this.table.theme.scrollStyle)===null||s===void 0?void 0:s.width,viewHeight:this.table.tableNoFrameHeight,viewWidth:this.table.tableNoFrameWidth,scrollDirection:"horizontal",scrollRatioX:d}),this.checkHorizontalScrollBarEnd())}hideVerticalScrollBar(){this.table.scenegraph.component.hideVerticalScrollBar()}showVerticalScrollBar(t){this.table.scenegraph.component.showVerticalScrollBar(),t&&(clearTimeout(this._clearVerticalScrollBar),this._clearVerticalScrollBar=setTimeout(()=>{var e;(e=this.table.scenegraph)===null||e===void 0||e.component.hideVerticalScrollBar()},1e3))}hideHorizontalScrollBar(){this.table.scenegraph.component.hideHorizontalScrollBar()}showHorizontalScrollBar(t){this.table.scenegraph.component.showHorizontalScrollBar(),t&&(clearTimeout(this._clearHorizontalScrollBar),this._clearHorizontalScrollBar=setTimeout(()=>{var e;(e=this.table.scenegraph)===null||e===void 0||e.component.hideHorizontalScrollBar()},1e3))}triggerContextMenu(t,e,n,o){this.menu.isShow&&this.menu.x===n&&this.menu.y===o?this.hideMenu():this.showContextMenu(t,e,n,o)}showContextMenu(t,e,n,o){var r;!((r=this.table.internalProps.menu)===null||r===void 0)&&r.contextMenuItems&&(this.table.internalProps.menu.renderMode==="html"?this.menu.isShow=!0:(this.menu.isShow=!0,this.menu.x=n,this.menu.y=o,this.table.scenegraph.component.menu.attach(n,o,t,e,si.contextmenu)),this.table.fireListeners(U.SHOW_MENU,{x:n,y:o,col:t,row:e,type:"contextmenu"}))}triggerDropDownMenu(t,e,n,o,r){this.table.fireListeners(U.DROPDOWN_ICON_CLICK,{col:t,row:e,event:r}),this.menu.isShow?this.hideMenu():this.showDropDownMenu(t,e,n,o)}showDropDownMenu(t,e,n,o){this.table.internalProps.menu.renderMode==="html"?this.menu.isShow=!0:(this.menu.isShow=!0,this.table.scenegraph.component.menu.attach(n,o,t,e,si.dropDown),this.menu.bounds=this.table.scenegraph.component.menu.bounds),this.table.fireListeners(U.SHOW_MENU,{x:n,y:o,col:t,row:e,type:"dropDown"}),this.residentHoverIcon&&this.table.scenegraph.setIconNormalStyle(this.residentHoverIcon.icon,this.residentHoverIcon.col,this.residentHoverIcon.row);const r=this.table.scenegraph.getCell(t,e);let s;r.forEachChildren(l=>l.attribute.funcType===Ot.dropDown&&(s=l,!0)),s&&(this.residentHoverIcon={col:t,row:e,icon:s},this.table.scenegraph.setIconHoverStyle(this.residentHoverIcon.icon,this.residentHoverIcon.col,this.residentHoverIcon.row,r),this.table.scenegraph.residentHoverIcon(t,e))}hideMenu(){this.menu.isShow&&(this.table.fireListeners(U.DROPDOWN_MENU_CLEAR,null),this.table.fireListeners(U.HIDE_MENU,null),this.menu.isShow=!1,this.table.scenegraph.component.menu.detach(),this.residentHoverIcon&&(this.table.scenegraph.setIconNormalStyle(this.residentHoverIcon.icon,this.residentHoverIcon.col,this.residentHoverIcon.row),this.table.scenegraph.resetResidentHoverIcon(this.residentHoverIcon.col,this.residentHoverIcon.row),this.residentHoverIcon=null))}setDropDownMenuHighlight(t){this.menu.dropDownMenuHighlight=t;for(let e=0;e<t.length;e++){const{col:n,row:o}=t[e],r=this.table.getCellRange(n,o);if(r)for(let s=r.start.col;s<=r.end.col;s++)for(let l=r.start.row;l<=r.end.row;l++)this.table.scenegraph.updateCellContent(s,l)}}dropDownMenuIsHighlight(t,e,n){const o=this.menu.dropDownMenuHighlight;if(Array.isArray(o))for(let r=0;r<o.length;r++){const s=o[r];let{col:l,row:a}=s;const{field:h,menuKey:d}=s;if(typeof l!="number"||typeof a!="number")if(this.table.isPivotTable()){const u=this.table.internalProps.layoutMap.getPivotCellAdress(h);if(!u)continue;l=u.col,a=u.row}else{const u=this.table.internalProps.layoutMap.getHeaderCellAddressByField(h);if(!u)continue;l=u.col,a=u.row}if(O(l)&&O(a)&&this.table.isCellRangeEqual(t,e,l,a)){let u=this.table._getHeaderLayoutMap(l??t,a??e).dropDownMenu||this.table.globalDropDownMenu;if(typeof u=="function"&&(u=u({row:a,col:l,table:this.table})),u)for(let c=0;c<u.length;c++){const f=u[c];if(kt(f)&&(f.menuKey||f.text)===(d||"")&&c===n||jt(f)&&f===d&&c===n)return!0}}}return!1}triggerSort(t,e,n,o){if(this.table.isPivotTable()){const c=this.table.getPivotSortState(t,e),f=c?c.toUpperCase():"NORMAL",g=f==="ASC"?"DESC":f==="DESC"?"NORMAL":"ASC";return this.table.sort(t,e,g),void this.table.fireListeners(us.PIVOT_SORT_CLICK,{col:t,row:e,order:f||"normal",dimensionInfo:this.table.internalProps.layoutMap.getPivotDimensionInfo(t,e),cellLocation:this.table.getCellLocation(t,e),event:o})}const r=[...this.sort],s=this.table.internalProps.multipleSort||!r.length?null:this.sort[this.sort.length-1];wL(t,e,this.table,o);const l=this.table.getCellRange(t,e),a=this.sort.find(c=>c.col===l.start.col&&c.row===l.start.row),h=this.table.internalProps.multipleSort||!s?null:s.col,d=this.table.internalProps.multipleSort||!s?null:s.row,u=r.findIndex(c=>c.col===t&&c.row===e);u>=0&&r.splice(u,1),this.table.scenegraph.updateSortIcon({col:t,row:e,iconMark:n,order:a==null?void 0:a.order,oldSortCol:h,oldSortRow:d,oldIconMark:s==null?void 0:s.icon}),a&&(a.icon=n),this.table.internalProps.multipleSort||r.forEach(c=>{this.table.scenegraph.updateSortIcon({col:null,row:null,iconMark:null,order:"normal",oldSortCol:c.col,oldSortRow:c.row,oldIconMark:null})}),this.table.fireListeners(us.AFTER_SORT,{order:a==null?void 0:a.order,field:this.table.getHeaderField(t,e),event:o})}updateSortState(t){var e,n,o,r,s,l,a,h;t=Array.isArray(t)?t:[t];for(let u=0;u<t.length;u++){if(t[u].field===((e=this.sort[u])===null||e===void 0?void 0:e.field)&&t[t.length-1].order===((n=this.sort[u])===null||n===void 0?void 0:n.order))return;const c=this.table.internalProps.multipleSort?null:((o=this.sort[u])===null||o===void 0?void 0:o.col)||null,f=this.table.internalProps.multipleSort?null:((r=this.sort[u])===null||r===void 0?void 0:r.row)||null;((s=this.sort[u])===null||s===void 0?void 0:s.order)==="asc"||(l=this.sort[u])===null||l===void 0||l.order,this.setSortState(t.slice(0,u+1));const g=this.table.internalProps.layoutMap.getHeaderCellAddressByField(t[u].field);this.sort[u].col=g.col,this.sort[u].row=g.row;const p=this.table.scenegraph.getCell(this.sort[u].col,this.sort[u].row);let v;Xg(p,"children",m=>m.attribute.funcType==="sort"&&(v=m,!0)),this.table.scenegraph.updateSortIcon({col:this.sort[u].col,row:this.sort[u].row,iconMark:v,order:this.sort[u].order,oldSortCol:c,oldSortRow:f,oldIconMark:(a=this.sort[u])===null||a===void 0?void 0:a.icon})}const d=[];this.table.internalProps.layoutMap.columnTree.tree.children.forEach(u=>{t.some(c=>c.field===u.field)||d.push(u)});for(let u=0;u<d.length;u++){const c=d[u];this.table.scenegraph.updateSortIcon({col:null,row:null,iconMark:null,order:null,oldSortCol:(h=c.startInTotal+this.table.internalProps.layoutMap.leftRowSeriesNumberColumnCount)!==null&&h!==void 0?h:0,oldSortRow:c.level,oldIconMark:null})}}triggerFreeze(t,e,n){if(!this.table.isPivotTable()&&!this.table.transpose){if(_L(t,e,this.table),this.table.hasListeners(us.FREEZE_CLICK)){const o=this.table.internalProps.layoutMap.columnObjects.slice(0,t+1);this.table.fireListeners(us.FREEZE_CLICK,{col:t,row:e,fields:o.reduce((r,s)=>r.concat(s.field),[]),colCount:this.table.frozenColCount})}this.frozen.icon=n}}updateCursor(t="default"){this.table.getElement().style.cursor=t}updateDrillState(t,e,n,o,r,s){this.drill.dimensionKey=t,this.drill.title=e,this.drill.drillDown=n,this.drill.drillUp=o,this.drill.col=r,this.drill.row=s,RL(r,s,n,o,this.table)}updateSparklineHoverPose(t,e,n,o){this.sparkLine.col!==-1&&this.sparkLine.row!==-1&&AL(this.sparkLine.col,this.sparkLine.row,this.table);let r=!1;t!==-1&&e!==-1&&(r=BL(t,e,n,o,this.table)),r?(this.sparkLine.col=t,this.sparkLine.row=e):(this.sparkLine.col=-1,this.sparkLine.row=-1)}setCheckedState(t,e,n,o){return NL(t,e,n,o,this)}setHeaderCheckedState(t,e){return VL(t,e,this)}syncCheckedState(t,e,n,o){return GL(t,e,n,o,this)}initCheckedState(t){return jL(t,this)}updateHeaderCheckedState(t,e,n){return UL(t,this,e,n)}initLeftRecordsCheckState(t){return $L(t,this)}setRadioState(t,e,n,o,r){zL(t,e,n,o,r,this)}syncRadioState(t,e,n,o,r,s){return OL(t,e,n,o,r,s,this)}changeCheckboxAndRadioOrder(t,e){this.checkedState.size&&YL(t,e,this),this.radioState.length&&WL(t,e,this)}setCustomSelectRanges(t){eF(this),iF(t,this)}}function oF(i){Bt.mode==="browser"&&i.on(U.CLICK_CELL,t=>{const{col:e,row:n}=t;if(t.target.type==="image"&&t.target.role&&t.target.role.startsWith("icon"))return;let o;o=i.internalProps.layoutMap.isHeader(e,n)?i.isPivotTable()?i._getHeaderLayoutMap(e,n).headerType:i.getHeaderDefine(e,n).headerType:i.getBodyColumnType(e,n);const r=i.isHeader(e,n)?i.getHeaderDefine(e,n):i.getBodyColumnDefine(e,n),s=i.getCellValue(e,n),l=i.getCellOriginValue(e,n);if(o==="link"){let a=zt(r.linkJump,{col:e,row:n,table:i,value:s,dataValue:l,cellHeaderPaths:void 0});if(a=a!==!1,!a)return;const h=r.templateLink;let d,u=zt(r.linkDetect,{col:e,row:n,table:i,value:s,dataValue:l,cellHeaderPaths:void 0});if(u=u!==!1,h){const g=i.getCellOriginRecord(e,n);if(g&&g.vtableMerge)return;const p=Object.assign({__value:s,__dataValue:l},g);if(Mt(h))d=h(p,e,n,i);else{const v=/\{\s*(\S+?)\s*\}/g;d=h.replace(v,(m,b)=>p[b])}}else if(u){if(!qg.test(s))return;d=s}else d=s;if(!d)return;const c=r.linkTarget,f=r.linkWindowFeatures;window.open(d,c,f)}else if(o==="image"){const{clickToPreview:a}=r;if(a===!1)return;const h=document.createElement("div");h.style.width="100%",h.style.height="100%",h.style.position="absolute",h.style.top="0",h.style.left="0",h.style.backgroundColor="rgba(30, 30, 30, 0.4)",h.style.display="flex",h.style.justifyContent="center",h.style.alignItems="center",h.style.overflow="hidden",h.style.zIndex="9999",h.addEventListener("click",u=>{u.target===h&&document.body.removeChild(h)});const d=new Image;d.src=s,d.style.maxWidth="80%",d.style.maxHeight="80%",h.appendChild(d),document.body.appendChild(h)}else if(o==="video"){const{clickToPreview:a}=r;if(a===!1)return;const h=document.createElement("div");h.style.width="100%",h.style.height="100%",h.style.position="absolute",h.style.top="0",h.style.left="0",h.style.backgroundColor="rgba(30, 30, 30, 0.4)",h.style.display="flex",h.style.justifyContent="center",h.style.alignItems="center",h.style.overflow="hidden",h.style.zIndex="9999",h.addEventListener("click",u=>{u.target===h&&document.body.removeChild(h)});const d=document.createElement("video");d.src=s,d.style.maxWidth="80%",d.style.maxHeight="80%",d.setAttribute("preload","auto"),d.setAttribute("controls","true"),h.appendChild(d),document.body.appendChild(h)}})}function rF(i){i.on(U.MOUSEENTER_CELL,t=>{const{col:e,row:n}=t;if(e===-1||n===-1)return;const o=i.internalProps.layoutMap.getHeaderDimension(e,n);o!=null&&o.drillDown||o!=null&&o.drillUp?i.stateManager.updateDrillState(o.dimensionKey,o.title,o.drillDown,o.drillUp,e,n):i.stateManager.updateDrillState(void 0,void 0,!1,!1,-1,-1)}),i.on(U.MOUSELEAVE_TABLE,t=>{i.stateManager.updateDrillState(void 0,void 0,!1,!1,-1,-1)})}function sF(i){i.fireListeners(us.DRILLMENU_CLICK,i.stateManager.drill)}function lF(i){const t=i.internalProps.layoutMap.rowsDefine,e=i.internalProps.layoutMap.columnsDefine;for(let n=0;n<t.length;n++){const o=t[n];if(typeof o!="string"&&(o.drillDown||o.drillUp))return!0}for(let n=0;n<e.length;n++){const o=e[n];if(typeof o!="string"&&(o.drillDown||o.drillUp))return!0}return!1}function Em(i){if(i.eventManager.bindSparklineHoverEvent)return;let t=!1;i.isPivotTable()?t=i.internalProps.layoutMap.indicatorsDefine.some(e=>typeof e!="string"&&e.cellType==="sparkline"):t=i.internalProps.layoutMap.columnObjects.some(e=>e.cellType==="sparkline"||typeof e.cellType=="function"),t&&(i.eventManager.bindSparklineHoverEvent=!0,i.on(U.MOUSEMOVE_CELL,e=>{const{col:n,row:o,x:r,y:s}=e;i.getBodyColumnType(n,o)!=="sparkline"&&i.stateManager.updateSparklineHoverPose(-1,-1,0,0),i.stateManager.updateSparklineHoverPose(n,o,r,s)}),i.on(U.MOUSELEAVE_TABLE,e=>{i.stateManager.updateSparklineHoverPose(-1,-1,0,0)}))}function Lh(i,t,e=!0){var n;let{deltaX:o,deltaY:r}=i;i.shiftKey&&i.deltaY&&(o=r,r=0);const[s,l]=aF(o,r,{horizontal:1,vertical:1});(s||l)&&t.interactionState!==vt.scrolling&&t.updateInteractionState(vt.scrolling),s&&(t.setScrollLeft(t.scroll.horizontalBarPos+s,i),t.showHorizontalScrollBar(!0)),l&&(t.setScrollTop(t.scroll.verticalBarPos+l,i),t.showVerticalScrollBar(!0)),e&&t.resetInteractionState(t.interactionStateBeforeScroll),!((n=i.nativeEvent)===null||n===void 0)&&n.cancelable&&(t.table.internalProps.overscrollBehavior==="none"||Math.abs(r)>=Math.abs(o)&&r!==0&&Pw(r,t)||Math.abs(r)<=Math.abs(o)&&o!==0&&Hw(o,t))&&i.nativeEvent.preventDefault()}function aF(i,t,e){var n,o;const r=Math.abs(i/t),s=r<=.5?0:i,l=r>2?0:t;return[Math.ceil(s*((n=e.horizontal)!==null&&n!==void 0?n:0)),Math.ceil(l*((o=e.vertical)!==null&&o!==void 0?o:0))]}function Pw(i,t){return t.table.getAllRowsHeight()-t.table.scenegraph.height!=0&&!hF(i,t)&&!dF(i,t)}function Hw(i,t){return t.table.getAllColsWidth()-t.table.scenegraph.width!=0&&!uF(i,t)&&!cF(i,t)}function hF(i,t){return t.table.getAllRowsHeight()-t.table.scenegraph.height!==0&&i<=0&&t.scroll.verticalBarPos<1}function dF(i,t){var e;const n=!((e=t.table.options.customConfig)===null||e===void 0)&&e._disableColumnAndRowSizeRound?1:0,o=t.table.getAllRowsHeight()-t.table.scenegraph.height;return o!==0&&i>=0&&Math.abs(t.scroll.verticalBarPos-o)<1+n}function uF(i,t){return t.table.getAllColsWidth()-t.table.scenegraph.width!==0&&i<=0&&t.scroll.horizontalBarPos<1}function cF(i,t){var e;const n=!((e=t.table.options.customConfig)===null||e===void 0)&&e._disableColumnAndRowSizeRound?1:0,o=t.table.getAllColsWidth()-t.table.scenegraph.width;return o!==0&&i>=0&&Math.abs(t.scroll.horizontalBarPos-o)<1+n}class gF{constructor(t){this.stateManager=t}setScrollHandle(t){this.scrollHandle=t}startInertia(t,e,n){this.lastTime=Date.now(),this.speedX=t,this.speedY=e,this.friction=n,this.runingId||(this.runingId=requestAnimationFrame(this.inertia.bind(this)))}inertia(){var t;const e=Date.now(),n=e-this.lastTime;let o=!0;const r=Math.pow(this.friction,n/16),s=r*this.speedX,l=r*this.speedY;let a=0,h=0;Math.abs(s)>.05&&(o=!1,a=(this.speedX+s)/2*n),Math.abs(l)>.05&&(o=!1,h=(this.speedY+l)/2*n),(t=this.scrollHandle)===null||t===void 0||t.call(this,a,h),o?this.runingId=null:(this.lastTime=e,this.speedX=s,this.speedY=l,this.runingId=requestAnimationFrame(this.inertia.bind(this)))}endInertia(){cancelAnimationFrame(this.runingId),this.runingId=null}isInertiaScrolling(){return!!this.runingId}}function hg(i,t,e){var n,o,r,s;t&&((n=i.stateManager.columnMove)===null||n===void 0?void 0:n.colSource)!==-1&&((o=i.stateManager.columnMove)===null||o===void 0?void 0:o.rowSource)!==-1&&((r=i.stateManager.columnMove)===null||r===void 0?void 0:r.colTarget)!==-1&&((s=i.stateManager.columnMove)===null||s===void 0?void 0:s.rowTarget)!==-1?i.hasListeners(U.CHANGE_HEADER_POSITION)&&i.fireListeners(U.CHANGE_HEADER_POSITION,{target:{col:i.stateManager.columnMove.colTarget,row:i.stateManager.columnMove.rowTarget},source:{col:i.stateManager.columnMove.colSource,row:i.stateManager.columnMove.rowSource},event:e}):t||i.hasListeners(U.CHANGE_HEADER_POSITION_FAIL)&&i.fireListeners(U.CHANGE_HEADER_POSITION_FAIL,{target:{col:i.stateManager.columnMove.colTarget,row:i.stateManager.columnMove.rowTarget},source:{col:i.stateManager.columnMove.colSource,row:i.stateManager.columnMove.rowSource},event:e})}function fF(i){const t=i.table,e=t.stateManager;t.scenegraph.tableGroup.addEventListener("pointermove",r=>{var s,l,a,h,d,u,c,f,g,p,v,m,b,C,_,w,y,x,S;const R=(l=(s=t.eventManager.LastPointerXY)===null||s===void 0?void 0:s.x)!==null&&l!==void 0?l:r.x,B=(h=(a=t.eventManager.LastPointerXY)===null||a===void 0?void 0:a.y)!==null&&h!==void 0?h:r.y;t.eventManager.LastPointerXY={x:r.x,y:r.y},i.touchSetTimeout&&(clearTimeout(i.touchSetTimeout),i.touchSetTimeout=void 0);const A=me(r);if(A.eventArgs&&t.hasListeners(U.MOUSEMOVE_TABLE)&&t.fireListeners(U.MOUSEMOVE_TABLE,{col:A.eventArgs.col,row:A.eventArgs.row,x:A.abstractPos.x,y:A.abstractPos.y,event:r.nativeEvent,target:(d=A==null?void 0:A.eventArgs)===null||d===void 0?void 0:d.target,mergeCellInfo:(u=A.eventArgs)===null||u===void 0?void 0:u.mergeInfo}),e.interactionState===vt.grabing&&!(!((c=t.editorManager)===null||c===void 0)&&c.editingEditor))return void(Math.abs(R-r.x)+Math.abs(B-r.y)>=1&&(e.isResizeCol()||e.isResizeRow()||(e.isMoveCol()?i.dealColumnMover(A):e.isFillHandle()?i.dealFillSelect(A,!0):((f=t.options.select)===null||f===void 0?void 0:f.disableDragSelect)||i.dealTableSelect(A,!0))));!(!((g=t.options.select)===null||g===void 0)&&g.disableDragSelect)&&t.eventManager.isDraging&&e.isSelecting()&&!(!((p=t.editorManager)===null||p===void 0)&&p.editingEditor)&&i.dealTableSelect(A,!0);const M=r.path.find(k=>k.role==="cell");if(t.hasListeners(U.MOUSELEAVE_CELL)&&(t.stateManager.hover.cellPos.col===-1||t.stateManager.hover.cellPos.row===-1||(M==null?void 0:M.col)===t.stateManager.hover.cellPos.col&&(M==null?void 0:M.row)===t.stateManager.hover.cellPos.row||t.fireListeners(U.MOUSELEAVE_CELL,{col:t.stateManager.hover.cellPos.col,row:t.stateManager.hover.cellPos.row,cellRange:t.getCellRangeRelativeRect({col:t.stateManager.hover.cellPos.col,row:t.stateManager.hover.cellPos.row}),scaleRatio:t.canvas.getBoundingClientRect().width/t.canvas.offsetWidth,event:r.nativeEvent,target:(v=A==null?void 0:A.eventArgs)===null||v===void 0?void 0:v.target})),t.hasListeners(U.MOUSEENTER_CELL)&&((M==null?void 0:M.role)!=="cell"||!O(M.col)||!O(M.row)||M.col===t.stateManager.hover.cellPos.col&&M.row===t.stateManager.hover.cellPos.row||M.col===((m=t.stateManager.hover.cellPosContainHeader)===null||m===void 0?void 0:m.col)&&M.row===((b=t.stateManager.hover.cellPosContainHeader)===null||b===void 0?void 0:b.row)||t.fireListeners(U.MOUSEENTER_CELL,{col:M.col,row:M.row,cellRange:t.getCellRangeRelativeRect({col:M.col,row:M.row}),scaleRatio:t.canvas.getBoundingClientRect().width/t.canvas.offsetWidth,event:r.nativeEvent,target:(C=A==null?void 0:A.eventArgs)===null||C===void 0?void 0:C.target,mergeCellInfo:(_=A.eventArgs)===null||_===void 0?void 0:_.mergeInfo})),i.dealIconHover(A),i.dealTableHover(A),t.theme.columnResize.visibleOnHover&&i.checkColumnResize(A,!0),A.eventArgs&&t.hasListeners(U.MOUSEMOVE_CELL)){let k,E;if(!((w=A.eventArgs)===null||w===void 0)&&w.target){const T=Ms((y=A.eventArgs)===null||y===void 0?void 0:y.target);T&&(k=T.icon,E=T.position)}t.fireListeners(U.MOUSEMOVE_CELL,{col:A.eventArgs.col,row:A.eventArgs.row,x:A.abstractPos.x,y:A.abstractPos.y,event:r.nativeEvent,targetIcon:k?{name:k.name,position:E,funcType:k.attribute.funcType}:void 0,target:(x=A==null?void 0:A.eventArgs)===null||x===void 0?void 0:x.target,mergeCellInfo:(S=A.eventArgs)===null||S===void 0?void 0:S.mergeInfo})}}),t.scenegraph.tableGroup.addEventListener("pointerout",r=>{var s;const l=me(r),a=(s=l==null?void 0:l.eventArgs)===null||s===void 0?void 0:s.target;(a==null?void 0:a.role)==="table"&&i.dealTableHover()}),t.scenegraph.tableGroup.addEventListener("pointerover",r=>{var s,l;const a=me(r),h=(s=a==null?void 0:a.eventArgs)===null||s===void 0?void 0:s.target;if(h&&t.hasListeners(U.MOUSEOVER_CHART_SYMBOL)&&h.type==="symbol"){const d=r.composedPath().find(u=>u.roll==="cell");if(d){const{col:u,row:c}=d,f={col:u,row:c,field:t.getHeaderField(u,c),value:t.getCellValue(u,c),dataValue:t.getCellOriginValue(u,c),cellHeaderPaths:t.internalProps.layoutMap.getCellHeaderPaths(u,c),title:t.getBodyColumnDefine(u,c).title,cellRange:t.getCellRelativeRect(u,c),event:r.nativeEvent,sparkline:{pointData:void 0},scaleRatio:t.canvas.getBoundingClientRect().width/t.canvas.offsetWidth,target:(l=a==null?void 0:a.eventArgs)===null||l===void 0?void 0:l.target};t.fireListeners(U.MOUSEOVER_CHART_SYMBOL,f)}}}),t.scenegraph.tableGroup.addEventListener("pointerenter",r=>{(t.theme.scrollStyle.horizontalVisible&&t.theme.scrollStyle.horizontalVisible==="focus"||!t.theme.scrollStyle.horizontalVisible&&t.theme.scrollStyle.visible==="focus")&&e.showHorizontalScrollBar(),(t.theme.scrollStyle.verticalVisible&&t.theme.scrollStyle.verticalVisible==="focus"||!t.theme.scrollStyle.verticalVisible&&t.theme.scrollStyle.visible==="focus")&&e.showVerticalScrollBar(),t.hasListeners(U.MOUSEENTER_TABLE)&&t.fireListeners(U.MOUSEENTER_TABLE,{event:r.nativeEvent})}),t.scenegraph.tableGroup.addEventListener("pointerleave",r=>{e.isResizeCol()||e.isResizeRow()||e.isMoveCol()||e.isSelecting()||(e.updateInteractionState(vt.default),e.updateCursor()),(t.theme.scrollStyle.horizontalVisible&&t.theme.scrollStyle.horizontalVisible==="focus"||!t.theme.scrollStyle.horizontalVisible&&t.theme.scrollStyle.visible==="focus")&&e.hideHorizontalScrollBar(),(t.theme.scrollStyle.verticalVisible&&t.theme.scrollStyle.verticalVisible==="focus"||!t.theme.scrollStyle.verticalVisible&&t.theme.scrollStyle.visible==="focus")&&e.hideVerticalScrollBar(),t.hasListeners(U.MOUSELEAVE_CELL)&&t.stateManager.hover.cellPos.col!==-1&&t.stateManager.hover.cellPos.row!==-1&&t.fireListeners(U.MOUSELEAVE_CELL,{col:t.stateManager.hover.cellPos.col,row:t.stateManager.hover.cellPos.row,cellRange:t.getCellRangeRelativeRect({col:t.stateManager.hover.cellPos.col,row:t.stateManager.hover.cellPos.row}),scaleRatio:t.canvas.getBoundingClientRect().width/t.canvas.offsetWidth,event:r.nativeEvent,target:void 0}),i.dealTableHover();const s=r.target;s&&!s.isDescendantsOf(t.scenegraph.tableGroup)&&t.fireListeners(U.MOUSELEAVE_TABLE,{event:r.nativeEvent})});const n=r=>{var s;const l=r.target;if(!t.getElement().contains(l)){const a=(s=t.editorManager)===null||s===void 0?void 0:s.completeEdit(r);Il(a,h=>{h!==!1&&(e.updateInteractionState(vt.default),i.dealTableHover())})}},o=r=>{var s;const l=r.target;if(!t.getElement().contains(l)&&!t.internalProps.menuHandler.containElement(l)){const a=(s=t.editorManager)===null||s===void 0?void 0:s.completeEdit(r);Il(a,h=>{var d,u;if(h!==!1&&(!((d=t.options.select)===null||d===void 0)&&d.outsideClickDeselect)){const c=!!(!((u=e.select.ranges)===null||u===void 0)&&u.length);i.dealTableSelect(),e.endSelectCells(!0,c)}})}};i.globalEventListeners.push({name:"pointerup",env:"document",callback:n}),i.globalEventListeners.push({name:"pointerdown",env:"document",callback:o}),Qt.addEventListener("pointerup",n),Qt.addEventListener("pointerdown",o),t.scenegraph.tableGroup.addEventListener("pointerdown",r=>{var s,l,a,h,d;if(t.hasListeners(U.MOUSEDOWN_TABLE)&&t.fireListeners(U.MOUSEDOWN_TABLE,{event:r.nativeEvent}),t.eventManager.isDown=!0,t.eventManager.LastBodyPointerXY={x:r.x,y:r.y},t.eventManager.LastPointerXY={x:r.x,y:r.y},r.button!==0)return;const u=me(r);if(i.downIcon=void 0,e.interactionState!==vt.default||(t.isPivotChart()&&((s=u==null?void 0:u.eventArgs)===null||s===void 0?void 0:s.target.type)!=="chart"&&t.scenegraph.updateChartState(null),((l=u.eventArgs)===null||l===void 0?void 0:l.target)!==((a=e.residentHoverIcon)===null||a===void 0?void 0:a.icon)&&e.hideMenu(),((h=u==null?void 0:u.eventArgs)===null||h===void 0?void 0:h.target.type)==="chart"))return;const c=(d=t.editorManager)===null||d===void 0?void 0:d.completeEdit(r.nativeEvent);Il(c,f=>{var g,p,v,m,b,C,_;if(f===!1)return;const w=!((v=(p=(g=u==null?void 0:u.eventArgs)===null||g===void 0?void 0:g.target)===null||p===void 0?void 0:p.role)===null||v===void 0)&&v.startsWith("icon")?u.eventArgs.target:!((m=r.target.role)===null||m===void 0)&&m.startsWith("icon")?r.target:void 0;if(i.downIcon=w,w&&w.attribute.interactive!==!1)w.attribute.funcType===Ot.dragReorder&&(e.startMoveCol(u.eventArgs.col,u.eventArgs.row,u.abstractPos.x,u.abstractPos.y,(C=(b=u.eventArgs)===null||b===void 0?void 0:b.event)===null||C===void 0?void 0:C.nativeEvent),e.updateInteractionState(vt.grabing));else if(r.pointerType==="touch")i.touchEnd=!1,i.touchSetTimeout=setTimeout(()=>{i.isTouchdown=!1,i.touchMove=!0,(i.touchEnd||!i.checkColumnResize(u,!0)&&!i.checkRowResize(u,!0))&&(i.touchEnd||!i.chechColumnMover(u))?i.dealTableSelect(u)&&!i.touchEnd&&e.updateInteractionState(vt.grabing):e.updateInteractionState(vt.grabing)},500),i.dealTableHover(u);else{if(!i.checkCellFillhandle(u)&&(i.checkColumnResize(u,!0)||i.checkRowResize(u,!0)))return t.scenegraph.updateChartState(null),void e.updateInteractionState(vt.grabing);if(i.chechColumnMover(u)||i.checkCellFillhandle(u,!0)&&i.dealFillSelect(u))return void e.updateInteractionState(vt.grabing);i.dealTableSelect(u)&&e.updateInteractionState(vt.grabing)}if(t.hasListeners(U.MOUSEDOWN_CELL)){const y=me(r);y.eventArgs&&t.fireListeners(U.MOUSEDOWN_CELL,{col:y.eventArgs.col,row:y.eventArgs.row,event:r.nativeEvent,target:(_=y==null?void 0:y.eventArgs)===null||_===void 0?void 0:_.target,mergeCellInfo:y.eventArgs.mergeInfo})}})}),t.scenegraph.tableGroup.addEventListener("pointerup",r=>{var s,l,a,h;if(r.button===0){if(e.interactionState==="grabing"){if(e.updateInteractionState(vt.default),e.isResizeCol())Fh(t);else if(e.isResizeRow())zh(t);else if(e.isMoveCol()){const d=t.stateManager.endMoveCol();hg(t,d,r.nativeEvent)}else if(e.isSelecting()){t.stateManager.endSelectCells(),t.stateManager.isFillHandle()&&t.stateManager.endFillSelect();const d=me(r);if(t.eventManager.isDraging&&d.eventArgs&&t.hasListeners(U.DRAG_SELECT_END)){const u={event:r.nativeEvent,cells:[],col:d.eventArgs.target.col,row:d.eventArgs.target.row,scaleRatio:t.canvas.getBoundingClientRect().width/t.canvas.offsetWidth,target:(s=d==null?void 0:d.eventArgs)===null||s===void 0?void 0:s.target,mergeCellInfo:(l=d.eventArgs)===null||l===void 0?void 0:l.mergeInfo};u.cells=t.getSelectedCellInfos(),t.fireListeners(U.DRAG_SELECT_END,u)}}}else e.interactionState===vt.scrolling&&e.updateInteractionState(vt.default);if(t.hasListeners(U.MOUSEUP_CELL)){const d=me(r);d.eventArgs&&t.fireListeners(U.MOUSEUP_CELL,{col:d.eventArgs.col,row:d.eventArgs.row,event:r.nativeEvent,target:(a=d==null?void 0:d.eventArgs)===null||a===void 0?void 0:a.target,mergeCellInfo:(h=d.eventArgs)===null||h===void 0?void 0:h.mergeInfo})}}}),t.scenegraph.tableGroup.addEventListener("rightdown",r=>{var s,l,a,h;const d=me(r);if(d.eventArgs){e.triggerContextMenu(d.eventArgs.col,d.eventArgs.row,d.abstractPos.x,d.abstractPos.y);const{col:u,row:c}=d.eventArgs;if(t.hasListeners(U.CONTEXTMENU_CELL)){const f=t.getCellInfo(u,c);let g,p;if(!((s=d.eventArgs)===null||s===void 0)&&s.target){const m=Ms((l=d.eventArgs)===null||l===void 0?void 0:l.target);m&&(g=m.icon,p=m.position)}const v=Object.assign(Object.assign({},f),{event:r.nativeEvent,cells:[],targetIcon:g?{name:g.name,position:p,funcType:g.attribute.funcType}:void 0,target:(a=d==null?void 0:d.eventArgs)===null||a===void 0?void 0:a.target,mergeCellInfo:(h=d.eventArgs)===null||h===void 0?void 0:h.mergeInfo});A2(t.stateManager.select.ranges,u,c)?v.cells=t.getSelectedCellInfos():v.cells=[[f]],t.fireListeners(U.CONTEXTMENU_CELL,v)}}}),t.scenegraph.tableGroup.addEventListener("pointertap",r=>{var s,l,a,h,d;if(t.stateManager.columnResize.resizing)return;const u=me(r);if(!i.touchMove&&r.button===0&&u.eventArgs&&t.hasListeners(U.CLICK_CELL)){const{col:c,row:f}=u.eventArgs,g=t.getCellInfo(c,f);let p,v;if(!((s=u.eventArgs)===null||s===void 0)&&s.target){const b=Ms((l=u.eventArgs)===null||l===void 0?void 0:l.target);b&&(p=b.icon,v=b.position)}const m=Object.assign(Object.assign({},g),{event:r.nativeEvent,federatedEvent:r,cells:[],targetIcon:p?{name:p.name,position:v,funcType:p.attribute.funcType}:void 0,target:(a=u==null?void 0:u.eventArgs)===null||a===void 0?void 0:a.target,mergeCellInfo:(h=u.eventArgs)===null||h===void 0?void 0:h.mergeInfo});t.fireListeners(U.CLICK_CELL,m)}if(!t.stateManager.columnResize.resizing&&!t.stateManager.columnMove.moving&&(i.dealIconClick(r,u),(u==null?void 0:u.eventArgs)&&i.touchSetTimeout&&r.pointerType==="touch")){const c=me(r);if(i.touchSetTimeout){clearTimeout(i.touchSetTimeout);const f=!!(!((d=e.select.ranges)===null||d===void 0)&&d.length);i.dealTableSelect(c),e.endSelectCells(!0,f),i.touchSetTimeout=void 0}}}),t.scenegraph.stage.addEventListener("pointerdown",r=>{var s,l,a,h;const d=me(r);!((s=d.eventArgs)===null||s===void 0)&&s.target&&((l=d.eventArgs)===null||l===void 0?void 0:l.target)===((a=e.residentHoverIcon)===null||a===void 0?void 0:a.icon)||e.hideMenu();const u=(h=t.editorManager)===null||h===void 0?void 0:h.completeEdit(r.nativeEvent);Il(u,c=>{var f;if(c===!1)return;const g=!((f=r.target.role)===null||f===void 0)&&f.startsWith("icon")?r.target:void 0;if(i.downIcon=g,!(g||i.checkCellFillhandle(d)||e.columnResize.resizing||!i.checkColumnResize(d,!0))){t.scenegraph.updateChartState(null),e.updateInteractionState(vt.grabing);const{eventArgs:p}=d;p!=null&&p.targetCell||t.getCellAt(d.abstractPos.x-t.theme.columnResize.resizeHotSpotSize/2,d.abstractPos.y)&&t.hasListeners(U.MOUSEDOWN_TABLE)&&t.fireListeners(U.MOUSEDOWN_TABLE,{event:r.nativeEvent})}})}),t.scenegraph.stage.addEventListener("pointerup",r=>{e.interactionState==="grabing"&&(e.updateInteractionState(vt.default),e.isResizeCol()?Fh(t):e.isResizeRow()&&zh(t))}),t.scenegraph.stage.addEventListener("pointertap",r=>{var s,l,a;const h=r.target;if(t.eventManager.isDraging||!h||!h.isDescendantsOf(t.scenegraph.stage)&&h.stage!==h||h.isDescendantsOf(t.scenegraph.tableGroup))t.eventManager.isDraging&&e.isSelecting()&&e.endSelectCells();else{e.updateInteractionState(vt.default),i.dealTableHover();const d=!!(!((s=e.select.ranges)===null||s===void 0)&&s.length);((a=(l=t.options.select)===null||l===void 0?void 0:l.blankAreaClickDeselect)===null||a===void 0||a)&&i.dealTableSelect(),e.endSelectCells(!0,d),e.updateCursor(),t.scenegraph.updateChartState(null)}}),t.scenegraph.stage.addEventListener("pointermove",r=>{const s=me(r);e.isResizeCol()||i.checkColumnResize(s)?t.stateManager.select&&i.checkCellFillhandle(s)?e.updateCursor("crosshair"):e.updateCursor("col-resize"):e.isResizeRow()||i.checkRowResize(s)?t.stateManager.select&&i.checkCellFillhandle(s)?e.updateCursor("crosshair"):e.updateCursor("row-resize"):e.isMoveCol()||e.updateCursor()}),t.scenegraph.tableGroup.addEventListener("checkbox_state_change",r=>{var s,l;const a=me(r),{col:h,row:d}=a.eventArgs,u=t.getCellInfo(h,d),c=ae(t,h,d);if(c)for(let g=c.start.col;g<=c.end.col;g++)for(let p=c.start.row;p<=c.end.row;p++)t.scenegraph.getCell(g,p).forEachChildren(v=>{v.name==="checkbox"&&v.setAttributes({checked:r.target.attribute.checked,indeterminate:r.target.attribute.indeterminate})});const f=Object.assign(Object.assign({},u),{event:r.nativeEvent,target:(s=a==null?void 0:a.eventArgs)===null||s===void 0?void 0:s.target,mergeCellInfo:(l=a==null?void 0:a.eventArgs)===null||l===void 0?void 0:l.mergeInfo,checked:r.detail.checked});if(t.isHeader(h,d))t.stateManager.setHeaderCheckedState(u.field,r.detail.checked),t.getCellType(h,d)==="checkbox"&&t.scenegraph.updateCheckboxCellState(h,d,r.detail.checked);else if(t.stateManager.setCheckedState(h,d,u.field,r.detail.checked),t.getCellType(h,d)==="checkbox"){const g=t.stateManager.headerCheckedState[u.field],p=t.stateManager.updateHeaderCheckedState(u.field,h,d);g!==p&&t.scenegraph.updateHeaderCheckboxCellState(h,d,p)}t.fireListeners(U.CHECKBOX_STATE_CHANGE,f),t.scenegraph.updateNextFrame()}),t.scenegraph.tableGroup.addEventListener("radio_checked",r=>{var s,l,a;const h=me(r),{col:d,row:u,target:c}=h.eventArgs,f=t.getCellInfo(d,u),g=(s=YH.exec(c.id))===null||s===void 0?void 0:s[1],p=ae(t,d,u);if(p)for(let C=p.start.col;C<=p.end.col;C++)for(let _=p.start.row;_<=p.end.row;_++)t.scenegraph.getCell(C,_).forEachChildren(w=>{w.name==="radio"&&w.id===c.id&&w.setAttributes({checked:!0})});const v=t.getBodyColumnDefine(d,u).radioCheckType||"column";if(v==="cell")if(p)for(let C=p.start.col;C<=p.end.col;C++)for(let _=p.start.row;_<=p.end.row;_++)t.scenegraph.getCell(C,_).forEachChildren(w=>{w.name==="radio"&&w.id!==c.id&&w.setAttributes({checked:!1})});else t.scenegraph.getCell(d,u).forEachChildren(C=>{C.name==="radio"&&C.id!==c.id&&C.setAttributes({checked:!1})});else v==="column"&&t.scenegraph.getColGroup(d).forEachChildren(C=>{C.forEachChildren(_=>{_.name==="radio"&&_.id!==c.id&&_.setAttributes({checked:!1})})});const m=g?Number(g):void 0;t.stateManager.setRadioState(d,u,f.field,v,m);const b=Object.assign(Object.assign({},f),{event:r.nativeEvent,target:(l=h==null?void 0:h.eventArgs)===null||l===void 0?void 0:l.target,mergeCellInfo:(a=h==null?void 0:h.eventArgs)===null||a===void 0?void 0:a.mergeInfo,radioIndexInCell:m});t.fireListeners(U.RADIO_STATE_CHANGE,b),t.scenegraph.updateNextFrame()}),t.scenegraph.tableGroup.addEventListener("switch_state_change",r=>{var s,l;const a=me(r),{col:h,row:d,target:u}=a.eventArgs,c=t.getCellInfo(h,d),f=ae(t,h,d);if(f)for(let p=f.start.col;p<=f.end.col;p++)for(let v=f.start.row;v<=f.end.row;v++)t.scenegraph.getCell(p,v).forEachChildren(m=>{m.name==="switch"&&m.setAttributes({checked:r.target.attribute.checked})});const g=Object.assign(Object.assign({},c),{event:r.nativeEvent,target:(s=a==null?void 0:a.eventArgs)===null||s===void 0?void 0:s.target,mergeCellInfo:(l=a==null?void 0:a.eventArgs)===null||l===void 0?void 0:l.mergeInfo,checked:r.detail.checked});t.stateManager.setCheckedState(h,d,c.field,r.detail.checked),t.fireListeners(U.SWITCH_STATE_CHANGE,g),t.scenegraph.updateNextFrame()}),t.scenegraph.stage.addEventListener("wheel",r=>{var s;r.path.find(l=>l.name==="legend")||((s=t.editorManager)===null||s===void 0||s.completeEdit(),t.eventManager._enableTableScroll&&Lh(r,e))})}function pF(i){const t=i.table;i.gesture=new OB(t.scenegraph.tableGroup,{tap:{interval:300}}),i.gesture.on("doubletap",e=>{vF(e,t)})}function Fh(i){i.stateManager.endResizeCol();const t=[];for(let e=0;e<i.colCount;e++)t.push(i.getColWidth(e));i.fireListeners(U.RESIZE_COLUMN_END,{col:i.stateManager.columnResize.col,colWidths:t})}function zh(i){i.stateManager.endResizeRow(),i.fireListeners(U.RESIZE_ROW_END,{row:i.stateManager.rowResize.row,rowHeight:i.getRowHeight(i.stateManager.rowResize.row)})}function vF(i,t){var e,n,o,r,s,l;const a=me(i);let h=-1,d=-1;a.eventArgs&&(h=a.eventArgs.col,d=a.eventArgs.row);const u=t.getCellValue(h,d),c=(n=(e=a.eventArgs)===null||e===void 0?void 0:e.targetCell)===null||n===void 0?void 0:n.globalAABBBounds;if(c&&t.internalProps.focusControl.setFocusRect(new qi(c.x1+t.scrollLeft,c.y1+t.scrollTop,c.x2-c.x1,c.y2-c.y1),u),t.hasListeners(U.DBLCLICK_CELL)){const f=t.getCellInfo(h,d);let g,p;if(!((o=a.eventArgs)===null||o===void 0)&&o.target){const m=Ms((r=a.eventArgs)===null||r===void 0?void 0:r.target);m&&(g=m.icon,p=m.position)}const v=Object.assign(Object.assign({},f),{event:i.nativeEvent,federatedEvent:i,cells:[],targetIcon:g?{name:g.name,position:p,funcType:g.attribute.funcType}:void 0,target:(s=a==null?void 0:a.eventArgs)===null||s===void 0?void 0:s.target,mergeCellInfo:(l=a==null?void 0:a.eventArgs)===null||l===void 0?void 0:l.mergeInfo});t.fireListeners(U.DBLCLICK_CELL,v)}}function mF(i){const t=i.table,e=t.stateManager,n=t.scenegraph;n.component.vScrollBar.addEventListener("pointerover",s=>{e.showVerticalScrollBar()}),n.component.hScrollBar.addEventListener("pointerover",s=>{e.showHorizontalScrollBar()}),n.component.vScrollBar.addEventListener("pointerout",s=>{e.interactionState!==vt.scrolling&&e.hideVerticalScrollBar()}),n.component.hScrollBar.addEventListener("pointerout",s=>{e.interactionState!==vt.scrolling&&e.hideHorizontalScrollBar()}),n.component.vScrollBar.addEventListener("pointermove",s=>{n.table.stateManager.updateCursor("default"),s.stopPropagation()}),n.component.vScrollBar.addEventListener("pointerdown",s=>{s.stopPropagation(),n.table.hasListeners(U.MOUSEDOWN_TABLE)&&n.table.fireListeners(U.MOUSEDOWN_TABLE,{event:s.nativeEvent})}),n.component.vScrollBar.addEventListener("scrollDown",s=>{var l;n.table.eventManager.LastBodyPointerXY={x:s.x,y:s.y},n.table.eventManager.isDown=!0,e.interactionState!==vt.scrolling&&e.updateInteractionState(vt.scrolling),n.table.stateManager.hideMenu(),(l=n.table.editorManager)===null||l===void 0||l.completeEdit(),n.table.hasListeners(U.MOUSEDOWN_TABLE)&&n.table.fireListeners(U.MOUSEDOWN_TABLE,{event:s.nativeEvent})}),n.component.vScrollBar.addEventListener("pointerup",()=>{e.fastScrolling=!1,n.table.eventManager.isDraging=!1,e.interactionState===vt.scrolling&&e.updateInteractionState(vt.default)}),n.component.vScrollBar.addEventListener("pointerupoutside",()=>{e.fastScrolling=!1,e.interactionState===vt.scrolling&&e.updateInteractionState(vt.default)}),n.component.vScrollBar.addEventListener("scrollUp",s=>{n.table.eventManager.isDraging=!1}),n.component.hScrollBar.addEventListener("pointermove",s=>{n.table.stateManager.updateCursor("default"),s.stopPropagation()}),n.component.hScrollBar.addEventListener("pointerdown",s=>{s.stopPropagation(),n.table.hasListeners(U.MOUSEDOWN_TABLE)&&n.table.fireListeners(U.MOUSEDOWN_TABLE,{event:s.nativeEvent})}),n.component.hScrollBar.addEventListener("scrollDown",s=>{var l;n.table.eventManager.LastBodyPointerXY={x:s.x,y:s.y},n.table.eventManager.isDown=!0,e.interactionState!==vt.scrolling&&e.updateInteractionState(vt.scrolling),n.table.stateManager.hideMenu(),(l=n.table.editorManager)===null||l===void 0||l.completeEdit(),n.table.hasListeners(U.MOUSEDOWN_TABLE)&&n.table.fireListeners(U.MOUSEDOWN_TABLE,{event:s.nativeEvent})}),n.component.hScrollBar.addEventListener("pointerup",()=>{e.fastScrolling=!1,n.table.eventManager.isDraging=!1,e.interactionState===vt.scrolling&&e.updateInteractionState(vt.default)}),n.component.hScrollBar.addEventListener("pointerupoutside",()=>{e.fastScrolling=!1,e.interactionState===vt.scrolling&&e.updateInteractionState(vt.default)}),n.component.hScrollBar.addEventListener("scrollUp",s=>{n.table.eventManager.isDraging=!1});const o=Av(e.updateVerticalScrollBar,20),r=Av(e.updateHorizontalScrollBar,20);n.component.vScrollBar.addEventListener("scrollDrag",s=>{n.table.eventManager.isDown&&(n.table.eventManager.isDraging=!0),e.fastScrolling=!0,e.interactionState!==vt.scrolling&&e.updateInteractionState(vt.scrolling);const l=s.detail.value[0]/(1-s.detail.value[1]+s.detail.value[0]);o(l,s)}),n.component.hScrollBar.addEventListener("scrollDrag",s=>{n.table.eventManager.isDown&&(n.table.eventManager.isDraging=!0),e.fastScrolling=!0,e.interactionState!==vt.scrolling&&e.updateInteractionState(vt.scrolling);const l=s.detail.value[0]/(1-s.detail.value[1]+s.detail.value[0]);r(l)})}let po=1;function kw(){return R_?po=1:(po=Math.ceil(window.devicePixelRatio||1),po>1&&po%2!=0&&(po+=1)),po}kw();var bF=function(i,t,e,n){return new(e||(e=Promise))(function(o,r){function s(h){try{a(n.next(h))}catch(d){r(d)}}function l(h){try{a(n.throw(h))}catch(d){r(d)}}function a(h){var d;h.done?o(h.value):(d=h.value,d instanceof e?d:new e(function(u){u(d)})).then(s,l)}a((n=n.apply(i,t||[])).next())})};function CF(i){const t=i.table,e=t.stateManager,n=t.internalProps.handler;function o(g){var p;if(t.hasListeners(U.KEYDOWN)){const v={keyCode:(p=g.keyCode)!==null&&p!==void 0?p:g.which,code:g.code,event:g,scaleRatio:t.canvas.getBoundingClientRect().width/t.canvas.offsetWidth};t.fireListeners(U.KEYDOWN,v)}}n.on(t.getElement(),"blur",g=>{i.dealTableHover()}),n.on(t.getElement(),"keydown",g=>{var p,v,m,b,C,_,w,y,x,S,R,B,A,M,k,E,T,P,H,L;if(g.key==="a"&&(g.ctrlKey||g.metaKey))!((p=t.keyboardOptions)===null||p===void 0)&&p.selectAllOnCtrlA&&(g.preventDefault(),i.deelTableSelectAll());else if(e.select.cellPos.col>=0&&e.select.cellPos.row>=0&&(g.key==="ArrowUp"||g.key==="ArrowDown"||g.key==="ArrowLeft"||g.key==="ArrowRight")){if(((m=(v=t.options.keyboardOptions)===null||v===void 0?void 0:v.moveEditCellOnArrowKeys)===null||m===void 0||!m)&&(!((b=t.editorManager)===null||b===void 0)&&b.editingEditor)||((C=t.options.keyboardOptions)===null||C===void 0?void 0:C.moveSelectedCellOnArrowKeys)===!1)return;let F,z;if(g.preventDefault(),g.stopPropagation(),g.key==="ArrowUp"?g.ctrlKey||g.metaKey?(F=e.select.cellPos.col,z=0):(g.shiftKey,F=e.select.cellPos.col,z=Math.min(t.rowCount-1,Math.max(0,e.select.cellPos.row-1))):g.key==="ArrowDown"?g.ctrlKey||g.metaKey?(F=e.select.cellPos.col,z=t.rowCount-1):(g.shiftKey,F=e.select.cellPos.col,z=Math.min(t.rowCount-1,Math.max(0,e.select.cellPos.row+1))):g.key==="ArrowLeft"?g.ctrlKey||g.metaKey?(F=0,z=e.select.cellPos.row):(g.shiftKey,z=e.select.cellPos.row,F=Math.min(t.colCount-1,Math.max(0,e.select.cellPos.col-1))):g.key==="ArrowRight"&&(g.ctrlKey||g.metaKey?(F=t.colCount-1,z=e.select.cellPos.row):(g.shiftKey,z=e.select.cellPos.row,F=Math.min(t.colCount-1,Math.max(0,e.select.cellPos.col+1)))),Yn(t,F,z))return;t.selectCell(F,z,g.shiftKey),(w=(_=t.options.keyboardOptions)===null||_===void 0?void 0:_.moveEditCellOnArrowKeys)!==null&&w!==void 0&&w&&(!((y=t.editorManager)===null||y===void 0)&&y.editingEditor)&&(t.editorManager.completeEdit(),t.getElement().focus(),t.getEditor(F,z)&&t.editorManager.startEditCell(F,z))}else if(g.key==="Escape")(x=t.editorManager)===null||x===void 0||x.cancelEdit(),t.getElement().focus();else if(g.key==="Enter"){if(!((S=t.editorManager)===null||S===void 0)&&S.editingEditor){if(o(g),t.editorManager.completeEdit(),t.getElement().focus(),((R=t.options.keyboardOptions)===null||R===void 0?void 0:R.moveFocusCellOnEnter)===!0){const F=e.select.cellPos.col,z=Math.min(t.rowCount-1,Math.max(0,e.select.cellPos.row+1));if(Yn(t,F,z))return;t.selectCell(F,z,g.shiftKey)}return}if(((B=t.options.keyboardOptions)===null||B===void 0?void 0:B.moveFocusCellOnEnter)===!0){const F=e.select.cellPos.col,z=Math.min(t.rowCount-1,Math.max(0,e.select.cellPos.row+1));if(Yn(t,F,z))return;t.selectCell(F,z,g.shiftKey)}else if(((M=(A=t.options.keyboardOptions)===null||A===void 0?void 0:A.editCellOnEnter)===null||M===void 0||M)&&((E=(k=t.stateManager.select.ranges)===null||k===void 0?void 0:k.length)!==null&&E!==void 0?E:0)===1){const F=t.stateManager.select.ranges[0].start.col,z=t.stateManager.select.ranges[0].start.row,I=t.stateManager.select.ranges[0].end.col,N=t.stateManager.select.ranges[0].end.row;F===I&&z===N&&t.getEditor(F,z)&&t.editorManager.startEditCell(F,z)}}else if(g.key==="Tab"){if(((P=(T=t.options.keyboardOptions)===null||T===void 0?void 0:T.moveFocusCellOnTab)===null||P===void 0||P)&&e.select.cellPos.col>=0&&e.select.cellPos.row>=0){if(e.select.cellPos.col===t.colCount-1&&e.select.cellPos.row===t.rowCount-1)return;let F,z;if(g.preventDefault(),e.select.cellPos.col===t.colCount-1?(z=Math.min(t.rowCount-1,e.select.cellPos.row+1),F=t.rowHeaderLevelCount):(z=e.select.cellPos.row,F=e.select.cellPos.col+1),Yn(t,F,z))return;t.selectCell(F,z),!((H=t.editorManager)===null||H===void 0)&&H.editingEditor&&(t.editorManager.completeEdit(),t.getElement().focus(),t.getEditor(F,z)&&t.editorManager.startEditCell(F,z))}}else if(!(g.ctrlKey||g.metaKey||g.shiftKey)){const F=t.options.editCellTrigger;if((F==="keydown"||Array.isArray(F)&&F.includes("keydown"))&&!(!((L=t.editorManager)===null||L===void 0)&&L.editingEditor)){const z=/^[a-zA-Z0-9+\-*\/%=.,\s]$/;g.key.match(z)&&t.editorManager.startEditCell(e.select.cellPos.col,e.select.cellPos.row,"")}}o(g)}),n.on(t.getElement(),"copy",g=>bF(this,void 0,void 0,function*(){var p,v;if(!((p=t.keyboardOptions)===null||p===void 0)&&p.copySelected){const m=t.getCopyValue();if(O(m)){g.preventDefault();const b=yield navigator.permissions.query({name:"clipboard-write"});if(!((v=navigator.clipboard)===null||v===void 0)&&v.write&&b.state==="granted"){const C=w=>{const y=["<table>"],x=['<meta name="author" content="Visactor"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join(""),S=w.split(`\r
`);return S.forEach(function(R,B){const A=R.split("	"),M=[];B===0&&y.push("<tbody>"),A.forEach(function(k,E){const T=k?k.toString().replace(/&/g,"&amp;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"<br>").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,P=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(P.length-1)} </span>`).replace(/\t/gi,"&#9;"):" ";M.push(`<td>${T}</td>`)}),y.push("<tr>",...M,"</tr>"),B===S.length-1&&y.push("</tbody>")}),y.push("</table>"),[x,y.join("")].join("")},_=C(m);navigator.clipboard.write([new ClipboardItem({"text/html":new Blob([_],{type:"text/html"}),"text/plain":new Blob([m],{type:"text/plain"})})])}else M2.IE?window.clipboardData.setData("Text",m):g.clipboardData.setData("text/plain",m);t.fireListeners(U.COPY_DATA,{cellRange:t.stateManager.select.ranges,copyData:m})}}})),n.on(t.getElement(),"paste",g=>{var p,v,m,b;if(!((p=t.keyboardOptions)===null||p===void 0)&&p.pasteValueToCell&&t.changeCellValues){if(!((v=t.editorManager)===null||v===void 0)&&v.editingEditor)return;if(((m=t.stateManager.select.ranges)===null||m===void 0?void 0:m.length)>0)if(!((b=navigator.clipboard)===null||b===void 0)&&b.read)navigator.clipboard.read().then(C=>{for(const _ of C)_.types.includes("text/html")?l(_):_.types.length===1&&_.types[0]==="text/plain"&&h(_)});else{const C=t.stateManager.select.ranges,_=Math.min(C[0].start.col,C[0].end.col),w=Math.min(C[0].start.row,C[0].end.row),y=(g.clipboardData||window.Clipboard).getData("text").split(`
`),x=[];y.forEach(function(S,R){const B=S.split("	"),A=[];x.push(A),B.forEach(function(M,k){k===B.length-1&&(M=M.trim()),A.push(M)})}),t.changeCellValues(_,w,x)}}}),n.on(t.getElement(),"contextmenu",g=>{var p;((p=t.eventOptions)===null||p===void 0?void 0:p.preventDefaultContextMenu)!==!1&&g.preventDefault()}),t.options.canvas||n.on(t.getContainer(),"resize",g=>{var p;t.isReleased||g.width===0&&g.height===0||((t.autoFillWidth||t.autoFillHeight)&&((p=t.editorManager)===null||p===void 0||p.completeEdit()),O(t.options.pixelRatio)||t.setPixelRatio(kw()),g.windowSizeNotChange||t.resize())});const r=/<tr[^>]*>([\s\S]*?)<\/tr>/g,s=/<td[^>]*>([\s\S]*?)<\/td>/g;function l(g){const p=t.stateManager.select.ranges,v=p.length,m=Math.min(p[v-1].start.col,p[v-1].end.col),b=Math.min(p[v-1].start.row,p[v-1].end.row),C=Math.max(p[v-1].start.col,p[v-1].end.col),_=Math.max(p[v-1].start.row,p[v-1].end.row);let w=0,y=0,x=[];g.getType("text/html").then(S=>{S.text().then(R=>{var B,A;if(R&&/(<table)|(<TABLE)/g.test(R)){const M=Array.from(R.matchAll(r));for(const k of M){const E=k[1],T=Array.from(E.matchAll(s)).map(P=>P[1].replace(/(<(?!br)([^>]+)>)/gi,"").replace(/<br(\s*|\/)>[\r\n]?/gim,`
`).replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&#9;/gi,"	").replace(/&nbsp;/g," "));x.push(T),w=Math.max(w,(B=T==null?void 0:T.length)!==null&&B!==void 0?B:0)}y=(A=x.length)!==null&&A!==void 0?A:0,x=d(x,y,w,_-b+1,C-m+1),t.changeCellValues(m,b,x,!0)}else navigator.clipboard.read().then(M=>{for(const k of M)k.types.includes("text/plain")&&k.getType("text/plain").then(E=>{E.text().then(a)})})})})}function a(g){var p;const v=t.stateManager.select.ranges,m=v.length,b=Math.min(v[m-1].start.col,v[m-1].end.col),C=Math.min(v[m-1].start.row,v[m-1].end.row),_=Math.max(v[m-1].start.col,v[m-1].end.col),w=Math.max(v[m-1].start.row,v[m-1].end.row);let y=0,x=0,S=[];g.split(`
`).forEach(function(R,B){var A;const M=R.split("	"),k=[];S.push(k),M.forEach(function(E,T){T===M.length-1&&(E=E.trim()),k.push(E)}),y=Math.max(y,(A=k==null?void 0:k.length)!==null&&A!==void 0?A:0)}),x=(p=S.length)!==null&&p!==void 0?p:0,S=d(S,x,y,w-C+1,_-b+1),t.changeCellValues(b,C,S,!0)}function h(g){const p=t.stateManager.select.ranges,v=p.length,m=Math.min(p[v-1].start.col,p[v-1].end.col),b=Math.min(p[v-1].start.row,p[v-1].end.row),C=Math.max(p[v-1].start.col,p[v-1].end.col),_=Math.max(p[v-1].start.row,p[v-1].end.row);let w=0,y=0;g.getType("text/plain").then(x=>{x.text().then(S=>{var R;const B=S.replace(/\r(?!\n)/g,`\r
`).split(`\r
`);let A=[];B.length>1&&B[B.length-1]===""&&B.pop(),B.forEach(function(M,k){var E;const T=M.split("	"),P=[];A.push(P),T.forEach(function(H,L){H.includes(`
`)&&(H=H.replace(/^"(.*)"$/,"$1").replace(/["]*/g,F=>new Array(Math.floor(F.length/2)).fill('"').join(""))),P.push(H)}),w=Math.max(w,(E=P==null?void 0:P.length)!==null&&E!==void 0?E:0)}),y=(R=A.length)!==null&&R!==void 0?R:0,A=d(A,y,w,_-b+1,C-m+1),t.changeCellValues(m,b,A,!0)})})}function d(g,p,v,m,b){if(b>v||m>p){if(b%v==0&&m%p==0){const C=[];for(let _=0;_<m;_++){const w=[];C.push(w);for(let y=0;y<b;y++){const x=_%p,S=y%v;w.push(g[x][S])}}return C}return g}return g}const u=g=>{t.eventManager.LastBodyPointerXY={x:g.x,y:g.y},t.eventManager.isDown=!0};i.globalEventListeners.push({name:"pointerdown",env:"body",callback:u}),document.body.addEventListener("pointerdown",u);const c=g=>{if(g.target!==t.canvas&&(p=>{var v,m;if(e.menu.isShow&&setTimeout(()=>{t.internalProps.menuHandler.pointInMenuElement(p.clientX,p.clientY)||e.menu.isShow&&e.hideMenu()},0),e.isResizeCol())Fh(t);else if(e.isResizeRow())zh(t);else if(e.isMoveCol()){const b=t.stateManager.endMoveCol();hg(t,b,p)}else if(e.isSelecting()&&(!((m=(v=t.stateManager.select)===null||v===void 0?void 0:v.ranges)===null||m===void 0)&&m.length)){const b=t.stateManager.select.ranges[t.stateManager.select.ranges.length-1].end.col,C=t.stateManager.select.ranges[t.stateManager.select.ranges.length-1].end.row;if(t.stateManager.endSelectCells(),t.hasListeners(U.DRAG_SELECT_END)){const _={event:p,cells:[],col:b,row:C,scaleRatio:t.canvas.getBoundingClientRect().width/t.canvas.offsetWidth,target:void 0};_.cells=t.getSelectedCellInfos(),t.fireListeners(U.DRAG_SELECT_END,_)}}})(g),t.eventManager.LastBodyPointerXY=null,t.eventManager.isDown=!1,t.eventManager.isDraging=!1,t.eventManager.inertiaScroll.endInertia(),e.interactionState==="grabing"&&e.isResizeCol())Fh(t);else if(e.interactionState==="grabing"&&e.isResizeRow())zh(t);else if(e.isMoveCol()){const p=t.stateManager.endMoveCol();hg(t,p,g)}};i.globalEventListeners.push({name:"pointerup",env:"document",callback:c}),document.addEventListener("pointerup",c);const f=g=>{var p,v,m,b,C;if(t.eventManager.isDown&&t.eventManager.LastBodyPointerXY){const x=(v=(p=t.eventManager.LastBodyPointerXY)===null||p===void 0?void 0:p.x)!==null&&v!==void 0?v:g.x,S=(b=(m=t.eventManager.LastBodyPointerXY)===null||m===void 0?void 0:m.y)!==null&&b!==void 0?b:g.y;(Math.abs(x-g.x)>1||Math.abs(S-g.y)>1)&&(t.eventManager.isDraging=!0)}const{x:_,y:w}=t._getMouseAbstractPoint(g,!1);e.interactionState===vt.grabing&&(e.isResizeCol()?(i.dealColumnResize(_,w),t.hasListeners(U.RESIZE_COLUMN)&&t.fireListeners(U.RESIZE_COLUMN,{col:t.stateManager.columnResize.col,colWidth:t.getColWidth(t.stateManager.columnResize.col)})):e.isResizeRow()&&(i.dealRowResize(_,w),t.hasListeners(U.RESIZE_ROW)&&t.fireListeners(U.RESIZE_ROW,{row:t.stateManager.rowResize.row,rowHeight:t.getRowHeight(t.stateManager.rowResize.row)})));const y=t.stateManager.isSelecting();if(i._enableTableScroll&&i.isDraging&&y&&((C=t.stateManager.select.ranges)===null||C===void 0?void 0:C.length)>0){const x=t.getDrawRange(),S=t.getFrozenRowsHeight(),R=t.getBottomFrozenRowsHeight(),B=t.getFrozenColsWidth(),A=t.getRightFrozenColsWidth(),M=t.stateManager.select.ranges[t.stateManager.select.ranges.length-1].start;if(t.isSeriesNumber(M.col,M.row))return;const k=t.stateManager.select.ranges[t.stateManager.select.ranges.length-1].end,E=(t.isFrozenRow(M.row)===!1||t.isFrozenRow(k.row)===!1)&&t.getAllRowsHeight()>t.tableNoFrameHeight,T=(t.isFrozenColumn(M.col)===!1||t.isFrozenColumn(k.col)===!1)&&t.getAllColsWidth()>t.tableNoFrameWidth;if((w>x.bottom-R||w<x.top+S)&&E||(_>x.right-A||_<x.left+B)&&T){t.eventManager.scrollXSpeed=0,t.eventManager.scrollYSpeed=0;let P=!1,H=!1,L=!1,F=!1;w>x.bottom-R&&E&&t.scrollTop+t.tableNoFrameHeight<t.getAllRowsHeight()?(P=!0,t.eventManager.scrollYSpeed=-(w-x.bottom+R)/50):w<x.top+S&&E&&t.scrollTop>0&&(H=!0,t.eventManager.scrollYSpeed=-(w-x.top-S)/50),_>x.right-A&&T&&t.scrollLeft+t.tableNoFrameWidth<t.getAllColsWidth()?(L=!0,t.eventManager.scrollXSpeed=-(_-x.right+A)/50):_<x.left+B&&T&&t.scrollLeft>0&&(F=!0,t.eventManager.scrollXSpeed=-(_-x.left-B)/50),t.eventManager.inertiaScroll.startInertia(t.eventManager.scrollXSpeed,t.eventManager.scrollYSpeed,1),t.eventManager.inertiaScroll.setScrollHandle((z,I)=>{let N,W;Lh({deltaX:-z,deltaY:-I},t.stateManager,!1),P?W=t.scrollTop+x.height-R-20:H&&(W=t.scrollTop+S+20),L?N=t.scrollLeft+x.width-A-20:F&&(N=t.scrollLeft+B+20);let D=!1,j=!1;L||F||(_>t.tableNoFrameWidth-t.getRightFrozenColsWidth()&&_<t.tableNoFrameWidth||_>0&&_<t.getFrozenColsWidth()?(N=_,j=!0):N=t.scrollLeft+_),P||H||(w>t.tableNoFrameHeight-t.getBottomFrozenRowsHeight()&&w<t.tableNoFrameHeight||w>0&&w<t.getFrozenRowsHeight()?(W=w,D=!0):W=t.scrollTop+w),t.stateManager.updateInteractionState(vt.grabing);const V=t.getTargetColAtConsiderRightFrozen(N,j),X=t.getTargetRowAtConsiderBottomFrozen(W,D);O(V)&&O(X)&&t.stateManager.updateSelectPos(V.col,X.row,!1,!1,!1,!1)})}else t.eventManager.inertiaScroll.isInertiaScrolling()?t.eventManager.inertiaScroll.endInertia():t.eventManager.scrollYSpeed=0}};i.globalEventListeners.push({name:"pointermove",env:"body",callback:f}),document.body.addEventListener("pointermove",f)}function _F(i){const t=i.table,e=t.stateManager,n=t.scenegraph;i.touchMovePoints=[],t.scenegraph.tableGroup.addEventListener("touchstart",l=>{l.target.isChildOf(n.component.vScrollBar)||l.target.isChildOf(n.component.vScrollBar)||(i.isTouchdown=!0,i.touchMovePoints.push({x:l.page.x,y:l.page.y,timestamp:Date.now()}))});const o=l=>{var a,h;if(i.touchMove&&l.preventDefault(),i.isTouchdown&&Lm(l)){if(((h=(a=i.downIcon)===null||a===void 0?void 0:a.attribute)===null||h===void 0?void 0:h.funcType)===Ot.dragReorder)l.preventDefault();else if(i.touchMovePoints.length>4&&i.touchMovePoints.shift(),i.touchMovePoints.push({x:l.changedTouches[0].pageX,y:l.changedTouches[0].pageY,timestamp:Date.now()}),i._enableTableScroll){const d=-i.touchMovePoints[i.touchMovePoints.length-1].x+i.touchMovePoints[i.touchMovePoints.length-2].x,u=-i.touchMovePoints[i.touchMovePoints.length-1].y+i.touchMovePoints[i.touchMovePoints.length-2].y;Lh({deltaX:d,deltaY:u},e),l.cancelable&&(t.internalProps.overscrollBehavior==="none"||Math.abs(u)>=Math.abs(d)&&u!==0&&Pw(u,e)||Math.abs(u)<=Math.abs(d)&&d!==0&&Hw(d,e))&&l.preventDefault()}}};window.addEventListener("touchmove",o,{passive:!1}),i.globalEventListeners.push({name:"touchmove",env:"window",callback:o});const r=l=>{var a,h,d,u;if(i.touchEnd=!0,i.touchMove=!1,i.isTouchdown&&Lm(l)){if(((h=(a=i.downIcon)===null||a===void 0?void 0:a.attribute)===null||h===void 0?void 0:h.funcType)===Ot.dragReorder)l.preventDefault();else if(!((d=i.touchMovePoints)===null||d===void 0)&&d.length&&(i.touchMovePoints.length>4&&i.touchMovePoints.shift(),i.touchMovePoints.push({x:l.changedTouches[0].pageX,y:l.changedTouches[0].pageY,timestamp:Date.now()}),i._enableTableScroll)){const c=i.touchMovePoints[0],f=i.touchMovePoints[((u=i.touchMovePoints)===null||u===void 0?void 0:u.length)-1],g=(f.x-c.x)/(f.timestamp-c.timestamp),p=(f.y-c.y)/(f.timestamp-c.timestamp);i.inertiaScroll.startInertia(g,p,.95),t.eventManager.inertiaScroll.setScrollHandle((v,m)=>{Lh({deltaX:-v,deltaY:-m},t.stateManager)})}i.isTouchdown=!1,i.touchMovePoints=[]}};window.addEventListener("touchend",r),i.globalEventListeners.push({name:"touchend",env:"window",callback:r});const s=l=>{i.touchEnd=!0,i.touchMove=!1,i.isTouchdown&&(i.isTouchdown=!1,i.touchMovePoints=[])};window.addEventListener("touchcancel",s),i.globalEventListeners.push({name:"touchcancel",env:"window",callback:s})}function Lm(i){return!!i.changedTouches}function wF(i){i.isPivotChart()&&i.scenegraph.tableGroup.addEventListener("click",t=>{var e;if(!i.stateManager.columnMove.moving&&!i.stateManager.columnResize.resizing)if(t.target.name==="axis-label"){const n=me(t),{col:o,row:r}=n.eventArgs,s=i.internalProps.layoutMap;let l,a;s.indicatorsAsCol?(l=s.getDimensionKeyInChartSpec(s.rowHeaderLevelCount,r),a=s.getCellHeaderPaths(s.rowHeaderLevelCount-2,r).rowHeaderPaths):(l=s.getDimensionKeyInChartSpec(o,s.columnHeaderLevelCount),a=s.getCellHeaderPaths(o,s.columnHeaderLevelCount-1).colHeaderPaths);const h=a.map(d=>({key:d.dimensionKey,value:d.value})).filter(d=>d.key);if(h.push({key:l,value:t.target.attribute.text}),i._selectedDimensionInChart.length&&yF(i._selectedDimensionInChart,h))return;i._selectedDimensionInChart=h,s.updateDataStateToChartInstance(),lg(i.scenegraph),i.scenegraph.updateNextFrame()}else!((e=i._selectedDimensionInChart)===null||e===void 0)&&e.length&&(i._selectedDimensionInChart.length=0,i.internalProps.layoutMap.updateDataStateToChartInstance(),lg(i.scenegraph),i.scenegraph.updateNextFrame())})}function yF(i,t){if(i.length!==t.length)return!1;for(let e=0;e<i.length;e++)if(i[e].key!==t[e].key||i[e].value!==t[e].value)return!1;return!0}function SF(i){i.isPivotChart()&&(i.on(U.MOUSEENTER_CELL,t=>{i.scenegraph.getCell(t.col,t.row).forEachChildren(e=>{if(e.name==="axis"){const n=Fm(t.col,t.row,i.internalProps.layoutMap);t.axisPosition=n,i.fireListeners(U.MOUSEENTER_AXIS,t)}})}),i.on(U.MOUSELEAVE_CELL,t=>{i.scenegraph.getCell(t.col,t.row).forEachChildren(e=>{if(e.name==="axis"){const n=Fm(t.col,t.row,i.internalProps.layoutMap);t.axisPosition=n,i.fireListeners(U.MOUSELEAVE_AXIS,t)}})}))}function Fm(i,t,e){if(e.indicatorsAsCol){if(e.hasTwoIndicatorAxes&&t===e.columnHeaderLevelCount-1&&i>=e.rowHeaderLevelCount&&i<e.colCount-e.rightFrozenColCount)return"top";if(t===e.rowCount-e.bottomFrozenRowCount&&i>=e.rowHeaderLevelCount&&i<e.colCount-e.rightFrozenColCount)return"bottom";if(i===e.rowHeaderLevelCount-1&&t>=e.rowHeaderLevelCount&&t<e.rowCount-e.bottomFrozenRowCount)return"left"}else{if(i===e.rowHeaderLevelCount-1&&t>=e.columnHeaderLevelCount&&t<e.rowCount-e.bottomFrozenRowCount)return"left";if(i===e.colCount-e.rightFrozenColCount&&t>=e.columnHeaderLevelCount&&t<e.rowCount-e.bottomFrozenRowCount)return"right";if(t===e.rowCount-e.bottomFrozenRowCount&&i>=e.rowHeaderLevelCount&&i<e.colCount-e.rightFrozenColCount)return"bottom"}return"bottom"}function xF(i){i.on("checkbox_state_change",t=>{var e;if(((e=i.internalProps.rowSeriesNumber)===null||e===void 0?void 0:e.enableTreeCheckbox)!==!0)return;const{col:n,row:o,checked:r}=t,s=i.getCellOriginRecord(n,o),l=i.dataSource.currentPagerIndexedData,a=i.getRecordShowIndexByCell(n,o);let h=l[a];if(Z(h)&&(h=[h]),s.vtableMerge)if(r)i.getHierarchyState(n,o)===mt.collapse?Im(!0,h,i):zm(!0,a,h,l,i),uu(a,h,l,i);else{i.getHierarchyState(n,o)===mt.collapse?Im(!1,h,i):zm(!1,a,h,l,i),uu(a,h,l,i);const d=i.stateManager.headerCheckedState._vtable_rowSeries_number,u=i.stateManager.updateHeaderCheckedState("_vtable_rowSeries_number",n,o);d!==u&&i.scenegraph.updateHeaderCheckboxCellState(n,o,u)}else uu(a,h,l,i)})}function zm(i,t,e,n,o){var r;let s=t+1;for(;Q(n[s])&&((r=n[s])===null||r===void 0?void 0:r.length)>e.length;){const l=o.columnHeaderLevelCount+s;o.stateManager.setCheckedState(0,l,"_vtable_rowSeries_number",i),na(0,l,i,o),s++}}function uu(i,t,e,n){var o;let r=t.length-1;if(r>0){let s=i-1;for(;r>0&&s>=0;)(Q(e[s])&&((o=e[s])===null||o===void 0?void 0:o.length)===r||r===1&&Z(e[s]))&&(RF(0,n.columnHeaderLevelCount+s,e[s],n),r--),s--}}function RF(i,t,e,n){const{checkedState:o}=n.stateManager,r=e.toString(),s=Q(e)?e.length:1;let l=!1;const a=[];if(o.forEach((u,c)=>{l&&(c.split(",").length===s?l=!1:a.push(u._vtable_rowSeries_number)),c===r&&(l=!0)}),a.length===0)return;const h=a.every(u=>!!u),d=a.every(u=>!u);h?(n.stateManager.setCheckedState(i,t,"_vtable_rowSeries_number",!0),na(i,t,!0,n)):d?(n.stateManager.setCheckedState(i,t,"_vtable_rowSeries_number",!1),na(i,t,!1,n)):(n.stateManager.setCheckedState(i,t,"_vtable_rowSeries_number","indeterminate"),na(i,t,"indeterminate",n))}function Im(i,t,e){const{checkedState:n}=e.stateManager,o=t.toString(),r=Q(t)?t.length:1;let s=!1;n.forEach((l,a)=>{s&&(a.split(",").length===r?s=!1:l._vtable_rowSeries_number=i),a===o&&(s=!0)})}function AF(i){i.on(U.CLICK_CELL,t=>{const{col:e,row:n,target:o}=t;o.name!=="button"||o.attribute.disable||i.hasListeners(U.BUTTON_CLICK)&&i.fireListeners(U.BUTTON_CLICK,{col:e,row:n,event:t.event})})}class BF{constructor(t){this.isDown=!1,this.isDraging=!1,this.globalEventListeners=[],this._enableTableScroll=!0,this.table=t,this.handleTextStickBindId=[],this.inertiaScroll=new gF(t.stateManager),Bt.mode==="node"||t.options.disableInteraction||(this.bindOuterEvent(),setTimeout(()=>{this.bindSelfEvent()},0))}bindOuterEvent(){fF(this),CF(this),mF(this),_F(this),pF(this)}updateEventBinder(){setTimeout(()=>{var t;this.table.isReleased||(pm(this.table)&&((t=this.handleTextStickBindId)===null||t===void 0?void 0:t.length)===0?(this.handleTextStickBindId.push(this.table.on(U.SCROLL,e=>{Bs(this.table)})),this.handleTextStickBindId.push(this.table.on(U.RESIZE_COLUMN_END,e=>{Bs(this.table)})),this.handleTextStickBindId.push(this.table.on(U.RESIZE_ROW_END,e=>{Bs(this.table)}))):!pm(this.table)&&this.handleTextStickBindId&&(this.handleTextStickBindId.forEach(e=>{this.table.off(e)}),this.handleTextStickBindId=[]),Em(this.table))},0)}bindSelfEvent(){if(this.table.isReleased)return;const t=this.table.stateManager;this.table.on(U.ICON_CLICK,e=>{var n;const{col:o,row:r,x:s,y:l,funcType:a,icon:h,event:d}=e;if(a===Ot.dropDown)t.triggerDropDownMenu(o,r,s,l,d);else if(a===Ot.sort)t.triggerSort(o,r,h,d);else if(a===Ot.frozen)t.triggerFreeze(o,r,h);else if(a===Ot.drillDown)sF(this.table);else if(a===Ot.collapse||a===Ot.expand){const u=!!(!((n=t.select.ranges)===null||n===void 0)&&n.length);t.updateSelectPos(-1,-1),t.endSelectCells(!0,u),this.table.toggleHierarchyState(o,r)}}),this.table.on(U.DROPDOWN_MENU_CLICK,()=>{t.hideMenu()}),this.updateEventBinder(),oF(this.table),this.table.on(U.DBLCLICK_CELL,e=>{var n,o,r;if(e.federatedEvent){const s=me(e.federatedEvent),l=this.table.scenegraph.getResizeColAt(s.abstractPos.x,s.abstractPos.y,(n=s.eventArgs)===null||n===void 0?void 0:n.targetCell),a=(o=this.table.options.disableDblclickAutoResizeColWidth)!==null&&o!==void 0?o:(r=this.table.options.resize)===null||r===void 0?void 0:r.disableDblclickAutoResizeColWidth;if(this.table.eventManager.checkCellFillhandle(s))this.table.fireListeners(U.DBLCLICK_FILL_HANDLE,{});else if(this.table._canResizeColumn(l.col,l.row)&&l.col>=0&&!a){this.table.scenegraph.updateAutoColWidth(l.col),this.table.internalProps._widthResizedColMap.add(l.col),this.table.scenegraph.updateChartSizeForResizeColWidth(l.col);const h=this.table.stateManager;h.columnResize.col<h.table.frozenColCount&&!h.table.isPivotTable()&&!h.table.transpose&&h.table.scenegraph.component.setFrozenColumnShadow(h.table.frozenColCount-1,h.columnResize.isRightFrozen);const d=[];for(let u=0;u<this.table.colCount;u++)d.push(this.table.getColWidth(u));this.table.fireListeners(U.RESIZE_COLUMN_END,{col:l.col,colWidths:d})}}}),this.table.isPivotTable()&&lF(this.table)&&rF(this.table),Em(this.table),wF(this.table),SF(this.table),xF(this.table),AF(this.table)}dealTableHover(t){if(!t)return void this.table.stateManager.updateHoverPos(-1,-1);const{eventArgs:e}=t;e?this.table.stateManager.updateHoverPos(e.col,e.row):this.table.stateManager.updateHoverPos(-1,-1)}dealIconHover(t){const{eventArgs:e}=t;e?this.table.stateManager.updateHoverIcon(e.col,e.row,e.target,e.targetCell):this.table.stateManager.updateHoverIcon(-1,-1,void 0,void 0)}dealMenuHover(t){}dealTableSelect(t,e){var n,o,r,s,l;if(!t)return this.table.stateManager.updateSelectPos(-1,-1),!1;const{eventArgs:a}=t;if(a){if(a.target.name==="checkbox"||a.target.name==="radio"||a.target.name==="switch"||a.target.name==="button")return!1;if(this.table.isHeader(a.col,a.row)&&Yn(this.table,a.col,a.row))return e||this.table.stateManager.updateSelectPos(-1,-1),!1;if(!this.table.isHeader(a.col,a.row)&&Yn(this.table,a.col,a.row)){if(!e){const h=!!(!((n=this.table.stateManager.select.ranges)===null||n===void 0)&&n.length);this.table.stateManager.updateSelectPos(-1,-1),h&&this.table.stateManager.endSelectCells(!0,h)}return!1}return!this.table.isPivotChart()||((o=t==null?void 0:t.eventArgs)===null||o===void 0?void 0:o.target.name)!=="axis-label"&&((r=t==null?void 0:t.eventArgs)===null||r===void 0?void 0:r.target.type)!=="chart"?(this.table.stateManager.updateSelectPos(a.col,a.row,a.event.shiftKey,a.event.ctrlKey||a.event.metaKey,!1,!e&&((l=(s=this.table.options.select)===null||s===void 0?void 0:s.makeSelectCellVisible)===null||l===void 0||l)),!0):(this.table.stateManager.updateSelectPos(-1,-1),!1)}return!1}dealFillSelect(t,e){var n,o;const{eventArgs:r}=t;if(r){if(!((o=(n=this.table.stateManager.select)===null||n===void 0?void 0:n.ranges)===null||o===void 0)&&o.length&&this.table.stateManager.isFillHandle()){let s,l;const a=this.table.stateManager.select.ranges[this.table.stateManager.select.ranges.length-1];e&&(O(this.table.stateManager.fillHandle.directionRow)||(Math.abs(this.table.stateManager.fillHandle.startY-t.abstractPos.y)>=Math.abs(this.table.stateManager.fillHandle.startX-t.abstractPos.x)?this.table.stateManager.fillHandle.directionRow=!0:this.table.stateManager.fillHandle.directionRow=!1),Math.abs(this.table.stateManager.fillHandle.startY-t.abstractPos.y)>=Math.abs(this.table.stateManager.fillHandle.startX-t.abstractPos.x)?this.table.stateManager.fillHandle.startY-t.abstractPos.y>0?this.table.stateManager.fillHandle.direction="top":this.table.stateManager.fillHandle.direction="bottom":this.table.stateManager.fillHandle.startX-t.abstractPos.x>0?this.table.stateManager.fillHandle.direction="left":this.table.stateManager.fillHandle.direction="right",this.table.stateManager.fillHandle.directionRow?(s=r.row,l=a.end.col):(s=a.end.row,l=r.col)),this.table.stateManager.updateSelectPos(e?l:a.end.col,e?s:a.end.row,!0,r.event.ctrlKey||r.event.metaKey,!1,!e)}else this.table.stateManager.updateSelectPos(r.col,r.row,r.event.shiftKey,r.event.ctrlKey||r.event.metaKey,!1,!e);return!0}return!1}deelTableSelectAll(){this.table.stateManager.updateSelectPos(-1,-1,!1,!1,!0),this.table.fireListeners(U.SELECTED_CELL,{ranges:this.table.stateManager.select.ranges,col:0,row:0})}dealMenuSelect(t){}checkColumnResize(t,e){const{eventArgs:n}=t;if(this.table.options.enableTreeStickCell&&!n)return!1;const o=this.table.scenegraph.getResizeColAt(t.abstractPos.x,t.abstractPos.y,n==null?void 0:n.targetCell);return this.table._canResizeColumn(o.col,o.row)&&o.col>=0?(e&&this.table.stateManager.startResizeCol(o.col,t.abstractPos.x,t.abstractPos.y,o.rightFrozen),!0):(this.table.stateManager.isResizeCol()&&this.table.stateManager.endResizeCol(),!1)}checkRowResize(t,e){const{eventArgs:n}=t;if(n){const o=this.table.scenegraph.getResizeRowAt(t.abstractPos.x,t.abstractPos.y,n.targetCell);if(this.table._canResizeRow(o.col,o.row)&&o.row>=0)return e&&this.table.stateManager.startResizeRow(o.row,t.abstractPos.x,t.abstractPos.y,o.bottomFrozen),!0}return!1}checkCellFillhandle(t,e){var n,o,r,s;if(!((n=this.table.options.excelOptions)===null||n===void 0)&&n.fillHandle){const{eventArgs:l}=t;if(l&&(!((r=(o=this.table.stateManager.select)===null||o===void 0?void 0:o.ranges)===null||r===void 0)&&r.length)){const a=Math.max(this.table.stateManager.select.ranges[this.table.stateManager.select.ranges.length-1].start.col,this.table.stateManager.select.ranges[this.table.stateManager.select.ranges.length-1].end.col),h=Math.max(this.table.stateManager.select.ranges[this.table.stateManager.select.ranges.length-1].start.row,this.table.stateManager.select.ranges[this.table.stateManager.select.ranges.length-1].end.row),d=this.table.scenegraph.highPerformanceGetCell(a,h).globalAABBBounds,u=Math.abs(t.abstractPos.x-d.x2),c=Math.abs(t.abstractPos.y-d.y2),f=18;if(!((s=this.table.stateManager.fillHandle)===null||s===void 0)&&s.isFilling||u<=f/2&&c<=f/2)return e&&this.table.stateManager.startFillSelect(t.abstractPos.x,t.abstractPos.y),!0}}return!1}dealColumnResize(t,e){this.table.stateManager.updateResizeCol(t,e)}dealRowResize(t,e){this.table.stateManager.updateResizeRow(t,e)}chechColumnMover(t){var e;const{eventArgs:n}=t;return!(!n||!this.table._canDragHeaderPosition(n.col,n.row))&&(this.table.stateManager.startMoveCol(n.col,n.row,t.abstractPos.x,t.abstractPos.y,(e=n==null?void 0:n.event)===null||e===void 0?void 0:e.nativeEvent),!0)}dealColumnMover(t){var e;const{eventArgs:n}=t;O(n.col)&&O(n.row)&&this.table.stateManager.updateMoveCol(n.col,n.row,t.abstractPos.x,t.abstractPos.y,(e=n==null?void 0:n.event)===null||e===void 0?void 0:e.nativeEvent)}startColumnResize(t){}dealIconClick(t,e){const{eventArgs:n}=e,{target:o,event:r,col:s,row:l}=n||{target:t.target,event:t,col:-1,row:-1},a=o;if(a.role&&a.role.startsWith("icon-"))return this.table.fireListeners(U.ICON_CLICK,{name:a.name,x:(a.globalAABBBounds.x1+a.globalAABBBounds.x2)/2,y:a.globalAABBBounds.y2,col:s,row:l,funcType:a.attribute.funcType,icon:a,event:r}),!0;if(o instanceof Di){const h=o.pickIcon(r.global);if(h)return this.table.fireListeners(U.ICON_CLICK,{name:h.attribute.id,x:h.globalX+h.globalAABBBounds.width()/2,y:h.globalY+h.AABBBounds.height(),col:s,row:l,funcType:h.attribute.funcType,icon:h,event:r}),!0}return!1}release(){this.gesture.release(),this.globalEventListeners.forEach(t=>{t.env==="document"?document.removeEventListener(t.name,t.callback):t.env==="body"?document.body.removeEventListener(t.name,t.callback):t.env==="window"&&window.removeEventListener(t.name,t.callback)}),this.globalEventListeners=[]}enableScroll(){this._enableTableScroll=!0}disableScroll(){this._enableTableScroll=!1}}let Om;const MF=i=>{const t=i.value;return Number(t)>80?"#20a8d8":Number(t)>50?"#4dbd74":Number(t)>20?"#ffc107":"#f86c6b"};class Ih extends Wi{static get DEFAULT(){return Om||(Om=new Ih)}constructor(t={},e={}){var n,o,r,s,l,a,h,d,u,c,f,g,p,v,m;super(t,e),this._showBar=(n=t.showBar)===null||n===void 0||n,this._barColor=(o=t.barColor)!==null&&o!==void 0?o:MF,this._barPositiveColor=(r=t.barPositiveColor)!==null&&r!==void 0?r:"#4dbd74",this._barNegativeColor=(s=t.barNegativeColor)!==null&&s!==void 0?s:"#f86c6b",this._barAxisColor=(l=t.barAxisColor)!==null&&l!==void 0?l:"black",this._barBgColor=t.barBgColor,this._barHeight=(a=t.barHeight)!==null&&a!==void 0?a:3,this._barHeight=(h=t.barHeight)!==null&&h!==void 0?h:3,this._barBottom=(d=t.barBottom)!==null&&d!==void 0?d:0,this._barPadding=(u=t.barPadding)!==null&&u!==void 0?u:[0,0,0,0],this._showBarMark=(c=t.showBarMark)!==null&&c!==void 0&&c,this._barMarkPositiveColor=(f=t.barMarkPositiveColor)!==null&&f!==void 0?f:"#4dbd74",this._barMarkNegativeColor=(g=t.barMarkNegativeColor)!==null&&g!==void 0?g:"#f86c6b",this._barMarkWidth=(p=t.barMarkWidth)!==null&&p!==void 0?p:2,this._barMarkPosition=(v=t.barMarkPosition)!==null&&v!==void 0?v:"right",this._barRightToLeft=(m=t.barRightToLeft)!==null&&m!==void 0&&m}get showBar(){return this._showBar}set showBar(t){this._showBar=t}get barColor(){return this._barColor}set barColor(t){this._barColor=t}get barBgColor(){return this._barBgColor}set barBgColor(t){this._barBgColor=t}get barHeight(){return this._barHeight}set barHeight(t){this._barHeight=t}get barBottom(){return this._barBottom}set barBottom(t){this._barBottom=t}get barPositiveColor(){return this._barPositiveColor}set barPositiveColor(t){this._barPositiveColor=t}get barNegativeColor(){return this._barNegativeColor}set barNegativeColor(t){this._barNegativeColor=t}get barAxisColor(){return this._barAxisColor}set barAxisColor(t){this._barAxisColor=t}get barPadding(){return this._barPadding}set barPadding(t){this._barPadding=t}get showBarMark(){return this._showBarMark}set showBarMark(t){this._showBarMark=t}get barMarkPositiveColor(){return this._barMarkPositiveColor}set barMarkPositiveColor(t){this._barMarkPositiveColor=t}get barMarkNegativeColor(){return this._barMarkNegativeColor}set barMarkNegativeColor(t){this._barMarkNegativeColor=t}get barMarkWidth(){return this._barMarkWidth}set barMarkWidth(t){this._barMarkWidth=t}get barMarkPosition(){return this._barMarkPosition}set barMarkPosition(t){this._barMarkPosition=t}get barRightToLeft(){return this._barRightToLeft}set barRightToLeft(t){this._barRightToLeft=t}clone(){return new Ih(this,null)}}const TF=["type","content","style","color","width","height","marginRight","marginLeft","src","svg","name","path","positionType","tooltip","hover","cursor","shape","interactive","isGif"],PF=TF;class HF{constructor(t){this._table=t;const e=Ni();this.expandIcon=e[Ve.expandIconName],this.collapseIcon=e[Ve.collapseIconName]}getIcons(t,e,n,o,r){const s=[],l=this.getHierarchyIcon(t,e);l&&s.push(l);const{icon:a}=this._table.getBodyColumnDefine(t,e);if(a){let h;typeof a=="function"?h=a({col:t,row:e,value:n,dataValue:o,table:this._table}):h=a;const d=Ni(),u=c=>{let f;f=typeof c=="string"?d[c]:c,f&&s.push(f)};Array.isArray(h)?h.forEach((c,f)=>{u(c)}):u(h)}return r&&s.forEach((h,d)=>{(h.content||h.src)&&(s[d]=this.getCellIconFromRecordValue(h,t,e))}),s}getStyleClass(t){switch(t){case"text":case"link":return $s;case"image":case"video":return r2;case"chart":case"sparkline":return Wi;case"progressbar":return Ih;case"checkbox":return Wc;case"radio":return Ro;case"switch":return Ao;case"button":return Bo}return $s}getCellIconFromRecordValue(t,e,n){if(Array.isArray(t))return t.map(s=>this.getCellIconFromRecordValue(s,e,n));if(!T_.isObject(t)||typeof t=="function")return this._table.getFieldData(t,e,n);const o={},r=t;return PF.forEach(s=>{var l,a;if(r[s]!==void 0){const h=this._table.getFieldData(r[s],e,n);O(h)?o[s]=h:!((a=(l=this._table)._hasField)===null||a===void 0)&&a.call(l,r[s],e,n)||(o[s]=r[s])}}),o}getHierarchyIcon(t,e){const n=this._table.getHierarchyState(t,e);return n===mt.expand?this.expandIcon:n===mt.collapse?this.collapseIcon:void 0}getHierarchyIconWidth(){var t,e;return this.expandIcon.width+((t=this.expandIcon.marginLeft)!==null&&t!==void 0?t:0)+((e=this.expandIcon.marginRight)!==null&&e!==void 0?e:0)}}function Zi(i,t){const e=document.createElement(i);return t&&e.classList.add(...t),e}function kF(){if(Bt.mode==="node")return;const i=document.createElement("style");i.id="vtable-menu-styleSheet",i.textContent=`
@keyframes vtable__menu-element--shown-animation {
	0% {
		opacity: 0;
	}
	100% {
		opacity: 1;
	}
}
.vtable__menu-element {
	position: absolute;
	box-sizing: border-box;
	border-radius: 4px;
	background-color: #fff;
	padding: 6px 0;
	/* pointer-events: none; */
	user-select: none;
	color: #000;
	max-width: 300px;
	z-index: 99999;
	border: #CCC 0.5px solid;
	cursor: default;
	width: max-content;
	box-shadow: 0px 8px 16px rgba(27, 31, 35, 0.12);
  max-height: 100%;
  overflow-y: auto;
}
.vtable__menu-element--hidden {
	opacity: 0;
	/* transform: translate(-50%, -50%); */
	transition: opacity 75ms linear;
	z-index: -9999;
}
.vtable__menu-element--shown {
	opacity: 1;
	/* transform: translate(-50%, -50%); */
	animation: vtable__menu-element--shown-animation 150ms ease-out;
}
.vtable__menu-element__content {
	font-family: Roboto;
	font-size: 12px;
	overflow: hidden;
	display: inline-block;
	/* height: 100%; */
	line-height: 30px;
}
.vtable__menu-element__item {
	height: 32px;
	padding: 0px 12px;
	cursor: pointer;
	position: relative;
	display: flex;
	align-items: center;
	justify-content: flex-start;
}
.vtable__menu-element__item:hover {
	background-color: rgba(27, 31, 35, 0.06);
}
.vtable__menu-element__icon{
	/* vertical-align: top; */
	display: flex;
	/* line-height: 30px; */
	margin-right: 6px;
}
.vtable__menu-element__no-event {
	pointer-events: none;
}
.vtable__menu-element--select {
	color: #2E68CF;
}.vtable__menu-element--normal {
	color: rgba(20, 20, 20, 0.9);;
}
.vtable__menu-element__split {
	height: 0px;
	border: 1px solid rgb(209, 213, 218);
	margin: 5px 0;
}
.vtable__menu-element__title {
	color: rgb(149, 149, 149);
}
.vtable__menu-element__arrow {
	position: absolute;
	right: 3px;
	font-weight: bold;
	margin-top: 1px;
}
.vtable__menu-element__item-text {
	margin-right: 15px;
}
`,document.head.appendChild(i)}kF();const fi="vtable__menu-element",EF=`${fi}__item`,cu=`${fi}__content`,Ke=`${fi}--hidden`,pn=`${fi}--shown`,LF=`${fi}--normal`,FF=`${fi}--select`,zF=`${fi}__icon`,IF=`${fi}__split`,OF=`${fi}__title`,DF=`${fi}__arrow`,is=`${fi}__no-event`,Dm=`${fi}__item-text`;function Wm(){return Zi("div",[fi,Ke])}function cs(i,t,e,n,o,r){const s=i.getCellRange(n,o);for(let l=0;l<t.length;l++){const a=t[l];let{col:h,row:d}=a;const{field:u,menuKey:c}=a;if(typeof h!="number"||typeof d!="number")if(i.isPivotTable()){const f=i.internalProps.layoutMap.getPivotCellAdress(u);if(!f)continue;h=f.col,d=f.row}else{const f=i.internalProps.layoutMap.getHeaderCellAddressByField(u);if(!f)continue;h=f.col,d=f.row}if(O(h)&&O(d)&&Bi(s,h,d)&&e===c)return!0}return!1}class WF{constructor(t){var e,n,o,r,s,l,a,h,d,u,c;this._handler=new _d,this._rootElement=Wm(),this._secondElement=Wm(),this._secondElement.sub=!0,this._showChildrenIndex=-1,this._rootElement.addEventListener("wheel",f=>{f.stopPropagation()}),(e=this._rootElement)===null||e===void 0||e.addEventListener("mousedown",f=>{f.stopPropagation(),f.preventDefault()}),(n=this._rootElement)===null||n===void 0||n.addEventListener("contextmenu",f=>{f.stopPropagation(),f.preventDefault()}),(o=this._rootElement)===null||o===void 0||o.addEventListener("touchend",f=>{if(f.stopPropagation(),f.preventDefault(),this._rootElement.classList.contains(Ke))return;const{col:g,row:p,dropDownIndex:v,menuKey:m,text:b,hasChildren:C}=f.target;if(typeof v!="number"||C)return void f.stopPropagation();const _=t.isPivotTable()?t.internalProps.layoutMap.getPivotDimensionInfo(g,p):t.getHeaderField(g,p),w=t._dropDownMenuIsHighlight(g,p,v);t.fireListeners(U.DROPDOWN_MENU_CLICK,{col:g,row:p,field:_,menuKey:m,text:b,highlight:w,cellLocation:t.getCellLocation(g,p),event:f}),t.fireListeners(U.DROPDOWN_MENU_CLEAR,null),t.fireListeners(U.HIDE_MENU,null),f.stopPropagation()}),(r=this._rootElement)===null||r===void 0||r.addEventListener("click",f=>{if(f.stopPropagation(),f.preventDefault(),this._rootElement.classList.contains(Ke))return;const{col:g,row:p,dropDownIndex:v,menuKey:m,text:b,hasChildren:C}=f.target;if(typeof v!="number"||C)return void f.stopPropagation();const _=t.isPivotTable()?t.internalProps.layoutMap.getPivotDimensionInfo(g,p):t.getHeaderField(g,p),w=t._dropDownMenuIsHighlight(g,p,v);t.fireListeners(U.DROPDOWN_MENU_CLICK,{col:g,row:p,field:_,menuKey:m,text:b,highlight:w,cellLocation:t.getCellLocation(g,p),event:f}),t.fireListeners(U.DROPDOWN_MENU_CLEAR,null),t.fireListeners(U.HIDE_MENU,null),f.stopPropagation()}),(s=this._rootElement)===null||s===void 0||s.addEventListener("mousemove",f=>{var g,p;if(this._rootElement.classList.contains(Ke))return;f.stopPropagation();const{hasChildren:v,dropDownIndex:m,col:b,row:C,sub:_}=f.target;if(v){this._showChildrenIndex=m;const w=this._secondElement;w==null||w.classList.remove(Ke),w==null||w.classList.add(pn),w.innerHTML="";const y=(g=this._menuInstanceInfo.content[m])===null||g===void 0?void 0:g.children;for(let S=0;S<y.length;S++){const R=y[S],B=Nm(R,!!t.stateManager.menu.dropDownMenuHighlight&&cs(t,t.stateManager.menu.dropDownMenuHighlight,typeof R=="object"?(R==null?void 0:R.menuKey)||(R==null?void 0:R.text):R,b,C));B.col=b,B.row=C,B.dropDownIndex=S,typeof R=="string"?(B.text=R,B.menuKey=R):typeof R=="object"&&(B.text=R.text,B.menuKey=R.menuKey||R.text),B.sub=!0,B.sub=!0,w.appendChild(B)}const x=f.target.getBoundingClientRect();this._bindSecondElement(t,b,C,x.right,x.top)}else if(v&&this._showChildrenIndex===m){const w=this._secondElement;w==null||w.classList.remove(Ke),w==null||w.classList.add(pn)}else!_&&(!((p=this._secondElement)===null||p===void 0)&&p.classList.contains(pn))&&setTimeout(()=>{if(this._mouseEnterSecondElement!==!0){this._showChildrenIndex=-1;const w=this._secondElement;w==null||w.classList.remove(pn),w==null||w.classList.add(Ke)}},300)}),(l=this._secondElement)===null||l===void 0||l.addEventListener("wheel",f=>{f.stopPropagation()}),(a=this._secondElement)===null||a===void 0||a.addEventListener("mousemove",f=>{this._rootElement.classList.contains(Ke)||f.stopPropagation()}),(h=this._secondElement)===null||h===void 0||h.addEventListener("mouseenter",f=>{this._mouseEnterSecondElement=!0}),(d=this._secondElement)===null||d===void 0||d.addEventListener("mouseleave",f=>{this._mouseEnterSecondElement=!1}),(u=this._secondElement)===null||u===void 0||u.addEventListener("mousedown",f=>{f.stopPropagation(),f.preventDefault()}),(c=this._secondElement)===null||c===void 0||c.addEventListener("click",f=>{if(f.stopPropagation(),f.preventDefault(),this._secondElement.classList.contains(Ke))return;const{col:g,row:p,dropDownIndex:v,menuKey:m,text:b,hasChildren:C}=f.target;if(typeof v!="number"||C)return void f.stopPropagation();const _=t.isPivotTable()?t.internalProps.layoutMap.getPivotDimensionInfo(g,p):t.getHeaderField(g,p);let w=!1;this._menuInstanceInfo.content.forEach((y,x)=>{if(typeof y=="object"&&y.children&&y.children.length)for(let S=0;S<y.children.length;S++){const R=y.children[S];if(cs(t,t.stateManager.menu.dropDownMenuHighlight,typeof R=="object"?R==null?void 0:R.menuKey:R,g,p)&&m===(typeof R=="object"?R==null?void 0:R.menuKey:R))return void(w=!0)}}),t.fireListeners(U.DROPDOWN_MENU_CLICK,{col:g,row:p,field:_,cellHeaderPaths:t.isPivotTable()?t.getCellHeaderPaths(g,p):void 0,menuKey:m,text:b,highlight:w,cellLocation:t.getCellLocation(g,p),event:f}),t.fireListeners(U.DROPDOWN_MENU_CLEAR,null),t.fireListeners(U.HIDE_MENU,null),f.stopPropagation()})}get rootElement(){return this._rootElement}release(){this.unbindFromCell();const t=this._rootElement;t!=null&&t.parentElement&&t.parentElement.removeChild(t),this._handler.release(),delete this._rootElement}bindToCell(t,e,n,o){var r,s;const l=this._rootElement,a=this._secondElement;if(this._menuInstanceInfo=o,l==null||l.classList.remove(pn),l==null||l.classList.add(Ke),a==null||a.classList.remove(pn),a==null||a.classList.add(Ke),this._canBindToCell(t,e,n)){if(l.innerHTML="",Array.isArray(o.content)){const h=o.content;for(let d=0;(r=d<(h==null?void 0:h.length))!==null&&r!==void 0&&r;d++){const u=h[d];let c=!!t.stateManager.menu.dropDownMenuHighlight&&cs(t,t.stateManager.menu.dropDownMenuHighlight,typeof u=="object"?(u==null?void 0:u.menuKey)||(u==null?void 0:u.text):u,e,n);if(t.stateManager.menu.dropDownMenuHighlight&&typeof u=="object"&&Array.isArray(u.children)&&u.children.length)for(let g=0;g<u.children.length;g++){const p=u.children[g];if(cs(t,t.stateManager.menu.dropDownMenuHighlight,typeof p=="object"?(p==null?void 0:p.menuKey)||(p==null?void 0:p.text):p,e,n)){c=!0;break}}const f=Nm(u,c);f.col=e,f.row=n,f.dropDownIndex=d,typeof u=="string"?(f.text=u,f.menuKey=u):typeof u=="object"&&(f.text=u.text,f.menuKey=u.menuKey||u.text,!((s=u.children)===null||s===void 0)&&s.length&&(f.hasChildren=!0)),l.appendChild(f)}}if(this._bindToCell(t,e,n,o.position,o.referencePosition))return l==null||l.classList.add(pn),l==null||l.classList.remove(Ke),!0}else this.unbindFromCell();return!1}unbindFromCell(){const t=this._rootElement,e=this._secondElement;this._menuInstanceInfo=void 0,t!=null&&t.parentElement&&(t.classList.remove(pn),t.classList.add(Ke)),e!=null&&e.parentElement&&(e.classList.remove(pn),e.classList.add(Ke))}_canBindToCell(t,e,n){var o;const r=t.getCellRangeRelativeRect({col:e,row:n}),s=(o=t.internalProps.menu.parentElement)!==null&&o!==void 0?o:t.getElement(),{top:l,bottom:a,left:h,right:d}=r;if(t.isFrozenCell(e,n))return!0;if(a<t.getFrozenRowsHeight()||d<t.getFrozenColsWidth()||h>t.tableNoFrameWidth-t.getRightFrozenColsWidth()||l>t.tableNoFrameHeight-t.getBottomFrozenRowsHeight())return!1;const{offsetHeight:u,offsetWidth:c}=s;return!(u<l)&&!(c<h)}_bindToCell(t,e,n,o,r){var s;const l=this._rootElement,a=(s=t.internalProps.menu.parentElement)!==null&&s!==void 0?s:t.getElement(),{width:h,height:d,left:u,top:c}=a.getBoundingClientRect();if(l){l.parentElement!==a&&a.appendChild(l),l.style.left="0px";const f=.8*h;l.style.maxWidth=`${f}px`;const g=l.offsetWidth,p=l.offsetHeight;let v,m;o?(v=o.x,m=o.y):r&&(v=r.rect.right-g,m=r.rect.bottom);const b=a.getBoundingClientRect(),C=b.width/a.offsetWidth,_=b.height/a.offsetHeight;m*_+p>d&&(m=(d-p)/_),m<0&&(m/=2);let w=0,y=0;if(t.getElement()!==a){const{left:x,top:S}=t.getElement().getBoundingClientRect();w=S-c,y=x-u}return l.style.top=`${m+w}px`,v<0?v=0:v*C+g>h&&(v=(h-g)/C),l.style.left=`${v+y}px`,!0}return!1}_bindSecondElement(t,e,n,o,r){var s;const l=this._secondElement,a=this._rootElement,h=(s=t.internalProps.menu.parentElement)!==null&&s!==void 0?s:t.getElement(),{width:d,left:u,top:c}=h.getBoundingClientRect(),{x:f,y:g,width:p}=a.getBoundingClientRect();if(l){l.parentElement!==h&&h.appendChild(l),l.style.left="0px";const v=.8*d;l.style.maxWidth=`${v}px`;const m=l.clientWidth,b=r-4-c,C=o-u;l.style.top=`${b}px`;let _=C;return _+m>d?_=_-m-p:_+=4,l.style.left=`${_}px`,!0}return!1}pointInMenuElement(t,e){const n=this._rootElement,{x:o,y:r,width:s,height:l}=n.getBoundingClientRect();if(t>o-5&&t<o+s+5&&e>r-5&&e<r+l+5)return!0;if(this._secondElement){const{x:a,y:h,width:d,height:u}=n.getBoundingClientRect();if(t>a-5&&t<a+d+5&&e>h-5&&e<h+u+5)return!0}return!1}}function Nm(i,t){var e,n,o;const r=Zi("div",[EF,t?FF:LF]);if(typeof i=="string"){const s=Zi("span",[cu,is,Dm]);s.innerHTML=i,r.appendChild(s)}else if(typeof i=="object"){const s=(e=i.type)!==null&&e!==void 0?e:"item";if(s==="split")return r==null||r.classList.add(IF),r;if(!((n=i==null?void 0:i.icon)===null||n===void 0)&&n.svg)if(qg.test(i.icon.svg)){const a=new Image;i.icon.width?a.style.width=i.icon.width.toString()+"px":a.style.width="16px",i.icon.height?a.style.height=i.icon.height.toString()+"px":a.style.height="16px",a.src=i.icon.svg,r.appendChild(a)}else{const a=Zi("span",[zF,is]);a.innerHTML=t&&i.selectedIcon&&i.selectedIcon.svg?i.selectedIcon.svg:i.icon.svg,i.icon.width&&a.children[0].setAttribute("width",i.icon.width.toString()),i.icon.height&&a.children[0].setAttribute("height",i.icon.height.toString()),r.appendChild(a)}const l=Zi("span",[cu,is,Dm]);if(l.innerHTML=i.text,r.appendChild(l),s==="title")r==null||r.classList.add(is,OF);else if(!((o=i==null?void 0:i.children)===null||o===void 0)&&o.length){const a=Zi("span",[cu,is,DF]);a.innerHTML=t?'<svg width="8" height="12" viewBox="0 0 10 17" fill="none" xmlns="http://www.w3.org/2000/svg" style="vertical-align: baseline"><path d="M1.78186 16.7729L0.300378 15.2915L6.8189 8.77295L0.300377 2.25443L1.78186 0.77295L9.78186 8.77295L1.78186 16.7729Z" fill="#2E68CF" fill-opacity="0.65"></path></svg>':'<svg width="8" height="12" viewBox="0 0 10 17" fill="none" xmlns="http://www.w3.org/2000/svg" style="vertical-align: baseline"><path d="M1.78186 16.7729L0.300378 15.2915L6.8189 8.77295L0.300377 2.25443L1.78186 0.77295L9.78186 8.77295L1.78186 16.7729Z" fill="#141414" fill-opacity="0.65"></path></svg>',r.appendChild(a)}}return r}let Vm;const NF={CHANGE_STYLE:"change_style"};class Io extends md{static get EVENT_TYPE(){return NF}static get DEFAULT(){return Vm||(Vm=new Io)}constructor(t={},e={}){var n,o,r,s,l,a,h,d,u,c,f,g,p,v,m,b,C,_,w,y,x,S,R,B,A,M,k,E,T,P,H,L;super(),this._defaultPadding=[10,16,10,16],this._color=(n=t.color)!==null&&n!==void 0?n:e==null?void 0:e.color,this._strokeColor=(o=t==null?void 0:t.strokeColor)!==null&&o!==void 0?o:e==null?void 0:e.strokeColor,this._fontSize=(r=t.fontSize)!==null&&r!==void 0?r:e==null?void 0:e.fontSize,this._fontFamily=(s=t.fontFamily)!==null&&s!==void 0?s:e==null?void 0:e.fontFamily,this._fontWeight=(l=t.fontWeight)!==null&&l!==void 0?l:e==null?void 0:e.fontWeight,this._fontVariant=(a=t.fontVariant)!==null&&a!==void 0?a:e==null?void 0:e.fontVariant,this._fontStyle=(h=t.fontStyle)!==null&&h!==void 0?h:e==null?void 0:e.fontStyle,this._textOverflow=((d=t.textOverflow)!==null&&d!==void 0?d:e==null?void 0:e.textOverflow)||"ellipsis",this._textStick=(c=(u=t.textStick)!==null&&u!==void 0?u:e==null?void 0:e.textStick)!==null&&c!==void 0&&c,this._textStickBaseOnAlign=(g=(f=t.textStickBaseOnAlign)!==null&&f!==void 0?f:e==null?void 0:e.textStickBaseOnAlign)!==null&&g!==void 0&&g,this._marked=(v=(p=t.marked)!==null&&p!==void 0?p:e==null?void 0:e.marked)!==null&&v!==void 0&&v,this._textAlign=((m=t.textAlign)!==null&&m!==void 0?m:e==null?void 0:e.textAlign)||"left",this._textBaseline=((b=t.textBaseline)!==null&&b!==void 0?b:e==null?void 0:e.textBaseline)||"middle",this._bgColor=(C=t.bgColor)!==null&&C!==void 0?C:e==null?void 0:e.bgColor,this._padding=(w=(_=t.padding)!==null&&_!==void 0?_:e==null?void 0:e.padding)!==null&&w!==void 0?w:this._defaultPadding,this._borderColor=(y=t.borderColor)!==null&&y!==void 0?y:e==null?void 0:e.borderColor,this._lineHeight=(x=t.lineHeight)!==null&&x!==void 0?x:e==null?void 0:e.lineHeight,this._underline=(S=t.underline)!==null&&S!==void 0?S:e==null?void 0:e.underline,this._underlineColor=(R=t.underlineColor)!==null&&R!==void 0?R:e==null?void 0:e.underlineColor,this._underlineDash=(B=t.underlineDash)!==null&&B!==void 0?B:e==null?void 0:e.underlineDash,this._underlineOffset=(A=t.underlineOffset)!==null&&A!==void 0?A:e==null?void 0:e.underlineOffset,this._lineThrough=(M=t.lineThrough)!==null&&M!==void 0?M:e==null?void 0:e.lineThrough,this._lineThroughColor=(k=t.lineThroughColor)!==null&&k!==void 0?k:e==null?void 0:e.lineThroughColor,this._lineThroughDash=(E=t.lineThroughDash)!==null&&E!==void 0?E:e==null?void 0:e.lineThroughDash,this._linkColor=(T=t.linkColor)!==null&&T!==void 0?T:e==null?void 0:e.linkColor,this._cursor=(P=t.cursor)!==null&&P!==void 0?P:e==null?void 0:e.cursor,this._borderLineWidth=(H=t.borderLineWidth)!==null&&H!==void 0?H:e==null?void 0:e.borderLineWidth,this._borderLineDash=(L=t.borderLineDash)!==null&&L!==void 0?L:e==null?void 0:e.borderLineDash}get bgColor(){return this._bgColor}set bgColor(t){this._bgColor=t}get color(){return this._color}set color(t){this._color=t}get strokeColor(){return this._strokeColor}set strokeColor(t){this._strokeColor=t}get fontSize(){return this._fontSize}set fontSize(t){this._fontSize=t}get fontFamily(){return this._fontFamily}set fontFamily(t){this._fontFamily=t}get fontWeight(){return this._fontWeight}set fontWeight(t){this._fontWeight=t}get fontVariant(){return this._fontVariant}set fontVariant(t){this._fontVariant=t}get fontStyle(){return this._fontStyle}set fontStyle(t){this._fontStyle=t}get textOverflow(){return this._textOverflow}set textOverflow(t){this._textOverflow=t}get padding(){var t;return(t=this._padding)!==null&&t!==void 0?t:this._defaultPadding}set padding(t){this._padding=t}get borderColor(){return this._borderColor}set borderColor(t){this._borderColor=t}get textStick(){return this._textStick}set textStick(t){this._textStick=t}get textStickBaseOnAlign(){return this._textStickBaseOnAlign}set textStickBaseOnAlign(t){this._textStickBaseOnAlign=t}get marked(){return this._marked}set marked(t){this._marked=t}get textAlign(){return this._textAlign}set textAlign(t){this._textAlign=t}get textBaseline(){return this._textBaseline}set textBaseline(t){this._textBaseline=t}get lineHeight(){return this._lineHeight}set lineHeight(t){this._lineHeight=t}get underline(){return this._underline}set underline(t){this._underline=t}get underlineColor(){return this._underlineColor}set underlineColor(t){this._underlineColor=t}get underlineDash(){return this._underlineDash}set underlineDash(t){this._underlineDash=t}get underlineOffset(){return this._underlineOffset}set underlineOffset(t){this._underlineOffset=t}get lineThrough(){return this._lineThrough}set lineThrough(t){this._lineThrough=t}get lineThroughColor(){return this._lineThroughColor}set lineThroughColor(t){this._lineThroughColor=t}get lineThroughDash(){return this._lineThroughDash}set lineThroughDash(t){this._lineThroughDash=t}get linkColor(){return this._linkColor}set linkColor(t){this._linkColor=t}get cursor(){return this._cursor}set cursor(t){this._cursor=t}get borderLineWidth(){return this._borderLineWidth}set borderLineWidth(t){this._borderLineWidth=t}get borderLineDash(){return this._borderLineDash}set borderLineDash(t){this._borderLineDash=t}clone(){return new Io(this)}}let Gm;class Oh extends Io{static get DEFAULT(){return Gm||(Gm=new Oh)}constructor(t={},e={}){var n;super(t,e),this.textAlign=((n=t.textAlign)!==null&&n!==void 0?n:e==null?void 0:e.textAlign)||"center"}clone(){return new Oh(this)}}let jm;class Dh extends Io{static get DEFAULT(){return jm||(jm=new Dh)}constructor(t={},e=null){var n,o;super(t,e),this._autoWrapText=(n=t==null?void 0:t.autoWrapText)!==null&&n!==void 0?n:e==null?void 0:e.autoWrapText,this._lineClamp=(o=t==null?void 0:t.lineClamp)!==null&&o!==void 0?o:e==null?void 0:e.lineClamp}clone(){return new Dh(this,null)}get lineClamp(){return this._lineClamp}set lineClamp(t){this._lineClamp=t}get autoWrapText(){return this._autoWrapText}set autoWrapText(t){this._autoWrapText=t}}let Um;class Mo extends Io{static get DEFAULT(){return Um||(Um=new Mo)}constructor(t={},e={},n={}){var o,r,s,l,a,h,d,u,c,f,g,p,v,m,b,C,_,w,y,x,S,R;super(t,e),this._size=((r=(o=t==null?void 0:t.size)!==null&&o!==void 0?o:e==null?void 0:e.size)!==null&&r!==void 0?r:n==null?void 0:n.size)||14,this._spaceBetweenTextAndIcon=((l=(s=t==null?void 0:t.spaceBetweenTextAndIcon)!==null&&s!==void 0?s:e==null?void 0:e.spaceBetweenTextAndIcon)!==null&&l!==void 0?l:n==null?void 0:n.spaceBetweenTextAndIcon)||8,this._defaultFill=(h=(a=t==null?void 0:t.checkboxStyle)===null||a===void 0?void 0:a.defaultFill)!==null&&h!==void 0?h:n==null?void 0:n.defaultFill,this._defaultStroke=(u=(d=t==null?void 0:t.checkboxStyle)===null||d===void 0?void 0:d.defaultStroke)!==null&&u!==void 0?u:n==null?void 0:n.defaultStroke,this._disableFill=(f=(c=t==null?void 0:t.checkboxStyle)===null||c===void 0?void 0:c.disableFill)!==null&&f!==void 0?f:n==null?void 0:n.disableFill,this._checkedFill=(p=(g=t==null?void 0:t.checkboxStyle)===null||g===void 0?void 0:g.checkedFill)!==null&&p!==void 0?p:n==null?void 0:n.checkedFill,this._checkedStroke=(m=(v=t==null?void 0:t.checkboxStyle)===null||v===void 0?void 0:v.checkedStroke)!==null&&m!==void 0?m:n==null?void 0:n.checkedStroke,this._disableCheckedFill=(C=(b=t==null?void 0:t.checkboxStyle)===null||b===void 0?void 0:b.disableCheckedFill)!==null&&C!==void 0?C:n==null?void 0:n.disableCheckedFill,this._disableCheckedStroke=(w=(_=t==null?void 0:t.checkboxStyle)===null||_===void 0?void 0:_.disableCheckedStroke)!==null&&w!==void 0?w:n==null?void 0:n.disableCheckedStroke,this._checkIconImage=(x=(y=t==null?void 0:t.checkboxStyle)===null||y===void 0?void 0:y.checkIconImage)!==null&&x!==void 0?x:n==null?void 0:n.checkIconImage,this._indeterminateIconImage=(R=(S=t==null?void 0:t.checkboxStyle)===null||S===void 0?void 0:S.indeterminateIconImage)!==null&&R!==void 0?R:n==null?void 0:n.indeterminateIconImage}get size(){return this._size}set size(t){this._size=t}get spaceBetweenTextAndIcon(){return this._spaceBetweenTextAndIcon}set spaceBetweenTextAndIcon(t){this._spaceBetweenTextAndIcon=t}get defaultFill(){return this._defaultFill}set defaultFill(t){this._defaultFill=t}get defaultStroke(){return this._defaultStroke}set defaultStroke(t){this._defaultStroke=t}get disableFill(){return this._disableFill}set disableFill(t){this._disableFill=t}get checkedFill(){return this._checkedFill}set checkedFill(t){this._checkedFill=t}get checkedStroke(){return this._checkedStroke}set checkedStroke(t){this._checkedStroke=t}get disableCheckedFill(){return this._disableCheckedFill}set disableCheckedFill(t){this._disableCheckedFill=t}get disableCheckedStroke(){return this._disableCheckedStroke}set disableCheckedStroke(t){this._disableCheckedStroke=t}get checkIconImage(){return this._checkIconImage}set checkIconImage(t){this._checkIconImage=t}get indeterminateIconImage(){return this._indeterminateIconImage}set indeterminateIconImage(t){this._indeterminateIconImage=t}getStyle(t){return new Mo(t,this)}clone(){return new Mo(this)}}function oa(i,t,e,n,o,r){var s;return i||t?i instanceof Io?i:typeof i=="function"?oa(i(e),t,e,n,o,r):(i||(i={}),o&&!O(i.autoWrapText)&&(i.autoWrapText=!0),n===Mo?new Mo(i??{},t??{},(s=r.checkboxStyle)!==null&&s!==void 0?s:{}):new n(i??{},t??{})):n.DEFAULT}class VF{constructor(t){this._table=t;const e=Ni();this.freezeIcon=e[Ve.freezeIconName],this.frozenIcon=e[Ve.frozenIconName],this.frozenCurrentIcon=e[Ve.frozenCurrentIconName],this.normalIcon=e[Ve.normalIconName],this.upIcon=e[Ve.upwardIconName],this.downIcon=e[Ve.downwardIconName],this.dropDownAbsoluteIcon=e[Ve.dropdownIconName],this.expandIcon=e[Ve.expandIconName],this.collapseIcon=e[Ve.collapseIconName]}getIcons(t,e){const n=[];if(this._table.isPivotTable()){const{showSort:l,sort:a}=this._table.internalProps.layoutMap.getHeader(t,e);let h;if(h=typeof l=="function"?l({col:t,row:e,table:this._table}):l,h){let d=this._table.getPivotSortState(t,e);d&&(d=d.toUpperCase());const u=d==="ASC"?this.upIcon:d==="DESC"?this.downIcon:this.normalIcon;u&&n.push(u)}else if(a){const d=this.getSortIconForPivotTable(this._table.getPivotSortState(t,e),this._table,t,e);d&&n.push(d)}}else{const l=this._table.sortState;let a;a=void 0;const h=this._table.getCellRange(t,e);if(l)if(Array.isArray(l))for(let u=0;u<l.length;u++){const c=l[u],f=this._table._getHeaderCellBySortState(c);if(f&&Bi(h,f.col,f.row)){({order:a}=c);break}}else{const u=this._table._getHeaderCellBySortState(l);u&&Bi(h,u.col,u.row)&&({order:a}=l)}const d=this.getSortIcon(a,this._table,t,e);d&&n.push(d)}if(this._table.showFrozenIcon&&t<this._table.allowFrozenColCount){const l=this.getFrozenIcon(t,e);l&&n.push(l)}if(this.checkDropDownIcon(this._table,t,e)){const l=this.dropDownAbsoluteIcon;n.push(l)}const o=this.getDropDownStateIcons(this._table,t,e);o.length&&n.push(...o);const{headerIcon:r}=this._table._getHeaderLayoutMap(t,e),s=this.getHierarchyIcon(t,e);if(s&&n.push(s),r){let l;typeof r=="function"?l=r({col:t,row:e,value:this._table.getCellValue(t,e),dataValue:this._table.getCellOriginValue(t,e),table:this._table}):l=r;const a=Ni(),h=d=>{let u;u=typeof d=="string"?a[d]:d,u&&n.push(u)};Array.isArray(l)?l.forEach((d,u)=>{h(d)}):h(l)}return n}getFrozenIcon(t,e){if(this._table.isPivotTable()||this._table.transpose||this._table.rightFrozenColCount&&t>=this._table.colCount-this._table.rightFrozenColCount)return null;const n=this._table.getHeaderDefine(t,e);if(n.columns&&n.columns.length>0)return null;let o=this.freezeIcon;return this._table.options.frozenColCount-1>t?o=this.frozenIcon:this._table.options.frozenColCount-1===t&&(o=this.frozenCurrentIcon),o}getSortIcon(t,e,n,o){const r=t==="asc"?this.upIcon:t==="desc"?this.downIcon:this.normalIcon,s=e.getHeaderDefine(n,o);let l;return s&&(l=typeof s.showSort=="function"?s.showSort({col:n,row:o,table:this._table}):s.showSort),!s||l===!1||!O(l)&&!s.sort||s.columns&&s.columns.length>0?null:r}getSortIconForPivotTable(t,e,n,o){const r=e.getHeaderDefine(n,o);let s;return r&&(s=typeof r.showSort=="function"?r.showSort({col:n,row:o,table:this._table}):r.showSort),!r||s===!1||!O(s)&&!r.sort||r.columns&&r.columns.length>0?null:(t==null?void 0:t.toUpperCase())==="ASC"?this.upIcon:(t==null?void 0:t.toUpperCase())==="DESC"?this.downIcon:this.normalIcon}getDropDownStateIcons(t,e,n){var o,r,s;const l=t.getHeaderDefine(e,n),a=t._getHeaderLayoutMap(e,n);let{dropDownMenu:h}=a;typeof h=="function"&&(h=h({row:n,col:e,table:t}));let d=t.globalDropDownMenu;typeof d=="function"&&(d=d({row:n,col:e,table:t}));const u=[];if(Array.isArray(h)&&h.length||Array.isArray(d)&&d.length&&!(!((o=l==null?void 0:l.columns)===null||o===void 0)&&o.length)){const c=h||d;let f=-1,g=-1;for(let p=0;p<c.length;p++){const v=c[p];if(typeof v=="object"&&v.children&&v.children.length)for(let m=0;m<v.children.length;m++){const b=v.children[m];if(!((r=t.stateManager.menu)===null||r===void 0)&&r.dropDownMenuHighlight&&cs(t,(s=t.stateManager.menu)===null||s===void 0?void 0:s.dropDownMenuHighlight,typeof b=="object"?b==null?void 0:b.menuKey:b,e,n)){f=p,g=m;break}}if(t._dropDownMenuIsHighlight(e,n,p)){f=p;break}}if(f!==-1){let p;p=g!==-1?c[f].children[g]:c[f],p.stateIcon&&(p.stateIcon.svg?u.push({type:"svg",name:p.stateIcon.src||p.stateIcon.svg,width:p.stateIcon.width||22,height:p.stateIcon.height||22,svg:p.stateIcon.svg,positionType:It.right,marginRight:0,funcType:Ot.dropDownState,interactive:!1}):p.stateIcon.src&&u.push({type:"image",name:p.stateIcon.src||p.stateIcon.svg,width:p.stateIcon.width||22,height:p.stateIcon.height||22,src:p.stateIcon.src,positionType:It.right,marginRight:0,funcType:Ot.dropDownState,interactive:!1}))}}return u}getDropDownIconRect(t,e,n){var o,r,s,l,a,h,d,u;const c=(l=(r=(o=this.downIcon.hover)===null||o===void 0?void 0:o.width)!==null&&r!==void 0?r:(s=this.downIcon)===null||s===void 0?void 0:s.width)!==null&&l!==void 0?l:0,f=(u=(h=(a=this.downIcon.hover)===null||a===void 0?void 0:a.height)!==null&&h!==void 0?h:(d=this.downIcon)===null||d===void 0?void 0:d.height)!==null&&u!==void 0?u:0,g=t.right-2-c,p=t.right-2;let v;return v=n==="middle"?t.top+t.height/2-c/2:n==="top"?t.top+e/2:n==="bottom"?t.bottom-2*e:t.top,{left:g,right:p,top:v,bottom:f+v,width:c,height:f}}getHierarchyIcon(t,e){const{hierarchyState:n}=this._table._getHeaderLayoutMap(t,e);if(n){if(n===mt.expand)return this.expandIcon;if(n===mt.collapse)return this.collapseIcon}}getHierarchyIconWidth(){var t,e;return this.expandIcon.width+((t=this.expandIcon.marginLeft)!==null&&t!==void 0?t:0)+((e=this.expandIcon.marginRight)!==null&&e!==void 0?e:0)}checkDropDownIcon(t,e,n){var o;if(t.isPivotTable()){let r=t._getHeaderLayoutMap(e,n).dropDownMenu;if(typeof r=="function"&&(r=r({row:n,col:e,table:t})),Array.isArray(r)&&r.length)return!0}else{const r=t.getHeaderDefine(e,n),s=r.dropDownMenu;let l=t.globalDropDownMenu;if(typeof l=="function"&&(l=l({row:n,col:e,table:t})),Array.isArray(s)&&s.length||(!Array.isArray(r.dropDownMenu)||r.dropDownMenu.length!==0)&&Array.isArray(l)&&l.length&&!(!((o=r==null?void 0:r.columns)===null||o===void 0)&&o.length))return!0}return!1}getStyleClass(t){switch(t){case"text":case"link":return Dh;case"image":case"video":return Oh;case"checkbox":return Mo}}setTableColumnsEditor(){const t=(e,n)=>{e==null||e.forEach((o,r)=>{o.editor&&(n[r].editor=o.editor),o.columns&&t(o.columns,n[r].columns)})};t(this._table.options.columns,this._table.internalProps.columns)}}class $m extends EventTarget{constructor(t,e){if(super(),this._table=t,Bt.mode==="node")return;const n=document.createElement("div");n.style.opacity="0",n.dataset.vtable="vtable",n.style.pointerEvents="none",n.classList.add("input-container");const o=this._input=document.createElement("input");n.appendChild(o),o.classList.add("table-focus-control"),o.dataset.vtable="vtable",o.readOnly=!0,e.appendChild(n),this._container=n}focus(){this._input.focus({preventScroll:!0})}setFocusRect(t,e){const n=this._input;n.value=e,n.select();const o=t.top-this._table.scrollTop,r=t.left-this._table.scrollLeft;n.style.top=`${o.toFixed()}px`,n.style.left=`${r.toFixed()}px`,n.style.width=`${t.width.toFixed()}px`,n.style.height=`${t.height.toFixed()}px`}get input(){return this._input}release(){var t;(t=this._container.parentElement)===null||t===void 0||t.removeChild(this._container)}}class Km{constructor(t){this.isUpdate=!1,this._keys=[],this._sorted=!1,this.data=new Map,this._keys.length=0,this.cumulativeSum=new Map,this.difference=new Map,this.totalSum=0,this.table=t}get length(){return this.data.size}clear(){this._keys=[],this.data.clear(),this.cumulativeSum.clear(),this.difference.clear(),this.totalSum=0}clearRange(){this.cumulativeSum.clear(),this.difference.clear()}add(t,e){if(!O(e))return;const n=this.table.getRowHeight(t);this.data.has(t)||(this._keys.push(t),this._sorted=!1),this.data.set(t,e),this.totalSum+=e,this.updateDifference(t,e-n)}remove(t){if(this.data.has(t)){const e=this.data.get(t);this.data.delete(t);const n=this._keys.indexOf(t);n!==-1&&this._keys.splice(n,1),this.totalSum-=e;const o=this.table.getRowHeight(t);this.updateDifference(t,o-e)}}put(t,e){if(O(e))if(this.data.has(t)){const n=this.data.get(t);if(n===e)return;this.data.set(t,e);const o=e-n;this.totalSum+=o,this.updateDifference(t,o)}else this.add(t,e)}get(t){return this.data.get(t)}has(t){return this.data.has(t)}_sort(){const{_keys:t}=this;this._sorted||(t.sort((e,n)=>e<n?-1:e>n?1:0),this._sorted=!0)}updateDifference(t,e){var n;const o=(n=this.difference.get(t))!==null&&n!==void 0?n:0;this.difference.set(t,o+e),this.update()}getSumInRange(t,e){return this.calculatePrefixSum(e)-this.calculatePrefixSum(t-1)}updateCumulativeSum(t,e){for(const[n,o]of this.cumulativeSum)n>=t&&this.cumulativeSum.set(n,o+e)}calculatePrefixSum(t){if(t<0)return 0;if(this.cumulativeSum.has(t)){let e=this.cumulativeSum.get(t);for(const[n,o]of this.difference)n<=t&&(e+=o);return e}return this.dealDiffenence(),this.getCumulativeSum(t)}getCumulativeSum(t){var e;let n=0;for(let o=t;o>=0;o--){if(this.cumulativeSum.has(o)){n+=this.cumulativeSum.get(o);break}n+=(e=this.data.get(o))!==null&&e!==void 0?e:this.table.getRowHeight(o)}return this.cumulativeSum.set(t,n),n}update(){this.isUpdate||(this.isUpdate=!0,setTimeout(()=>{this.dealDiffenence(),this.isUpdate=!1},0))}dealDiffenence(){for(const[t]of this.cumulativeSum)for(const[e,n]of this.difference)if(t>=e){const o=this.cumulativeSum.get(t);this.cumulativeSum.set(t,o+n)}this.difference.clear()}insert(t,e){for(let o=t;o<=this.getLastIndex();o++)this.cumulativeSum.delete(o);const n=this.getLastIndex()+1;this.adjustOrder(t,t+1,n-t),O(e)&&this.put(t,e)}getLastIndex(){return this._sort(),this._keys[this._keys.length-1]}delLast(){const t=this.getLastIndex();this.remove(t)}delete(t){if(!this.has(t))return;for(let n=t;n<=this.getLastIndex();n++)this.cumulativeSum.delete(n);const e=this.getLastIndex();this.adjustOrder(t+1,t,e-t),this.delLast()}adjustOrder(t,e,n){this.clearRange(),this._sort();const{_keys:o}=this;if(t>e){const s=[];for(let l=qo(o,t+n-1);l>=0;l--){const a=o[l];if(a>=t)s.push(this.get(a));else if(e<=a&&a<t)this.put(a+n,this.get(a));else if(a<e)break}for(let l=0;l<n;l++)this.put(e+l,s[n-1-l])}const{length:r}=o;if(t<e){const s=[];for(let l=qo(o,t);l<r;l++){const a=o[l];if(a>=t&&a<t+n)s.push(this.get(a));else if(t+n<=a&&a<=e)this.put(a-n,this.get(a));else if(a>e)break}for(let l=0;l<n;l++)this.put(e+l,s[l])}}exchangeOrder(t,e,n,o,r){const{_keys:s}=this;if(this._sorted||(s.sort((l,a)=>l<a?-1:l>a?1:0),this._sorted=!0),t>n){const l=[],a=[];for(let h=qo(s,n);h<qo(s,t)+e;h++){const d=s[h];d>=t&&d<t+e?a.push(this.get(d)):l.push(this.get(d))}for(let h=0;h<e;h++)this.put(r+h,a[h]);for(let h=0;h<l.length;h++)this.put(r+e+h,l[h])}else{const l=[],a=[];for(let h=qo(s,t);h<qo(s,n)+o;h++){const d=s[h];d>=t&&d<t+e?a.push(this.get(d)):l.push(this.get(d))}for(let h=0;h<e;h++)this.put(r+h,a[h]);for(let h=0;h<l.length;h++)this.put(t+h,l[h])}}}function qo(i,t){let e=0,n=i.length-1;for(;e<=n;){const o=Math.floor((e+n)/2);if(i[o]===t)return o;i[o]>t?n=o-1:e=o+1}return n<0?0:n}class GF{constructor(t){this._table=t;const e=Ni();this.dragReorderIconName=e[Ve.dragReorderIconName]}getIcons(t,e){return[this.dragReorderIconName]}}class dg{constructor(t,e,n="grid",o=void 0){this.hasHideNode=!1,this.sizeIncludeParent=!1,this.tree={id:0,dimensionKey:"",value:"",children:[],level:-1,afterSpanLevel:-1,levelSpan:1,startIndex:0,size:0,startInTotal:0,hierarchyState:void 0},this.totalLevel=0,this.expandedMaxLevel=0,this.dimensionKeys=new Kn,this.dimensionKeysIncludeVirtual=new Kn,this.cache=new Map,this.sizeIncludeParent=o!=null,this.setExpandLevel=o,this.hierarchyType=n,this.sharedVar=e,this.reset(t)}reset(t){this.totalLevel=0,this.expandedMaxLevel=0,this.hasHideNode=!1,this.cache.clear(),this.dimensionKeys=new Kn,this.dimensionKeysIncludeVirtual=new Kn,this.tree.children=t,this.setTreeNode(this.tree,0,this.tree)}setTreeNode(t,e,n){var o,r,s,l;t.startIndex=e,t.startInTotal=((o=n.startInTotal)!==null&&o!==void 0?o:0)+t.startIndex,t.hide&&(this.hasHideNode=!0),((r=t.dimensionKey)!==null&&r!==void 0?r:t.indicatorKey)&&(t.virtual||this.dimensionKeys.contain(t.indicatorKey?Dl:t.dimensionKey)||this.dimensionKeys.put(t.level,t.indicatorKey?Dl:t.dimensionKey),this.dimensionKeysIncludeVirtual.contain(t.indicatorKey?Dl:t.dimensionKey)||this.dimensionKeysIncludeVirtual.put(t.level,t.indicatorKey?Dl:t.dimensionKey),t.id||(t.id=++this.sharedVar.seqId));let a=t.dimensionKey&&this.sizeIncludeParent?1:0;const h=t.children||t.columns;return this.hierarchyType==="grid"||this.hierarchyType===null?(h==null?void 0:h.length)>=1?h.forEach(d=>{var u,c,f;d.level=((u=t.level)!==null&&u!==void 0?u:0)+1,this.hierarchyType==="grid"&&(d.afterSpanLevel=((c=t.afterSpanLevel)!==null&&c!==void 0?c:0)+((f=t.levelSpan)!==null&&f!==void 0?f:1)),this.totalLevel=Math.max(this.totalLevel,d.level+1),a+=this.setTreeNode(d,a,t)}):a=1:t.hierarchyState===mt.expand&&(h==null?void 0:h.length)>=1?h.forEach(d=>{var u;d.level=((u=t.level)!==null&&u!==void 0?u:0)+1,this.totalLevel=Math.max(this.totalLevel,d.level+1),this.expandedMaxLevel=Math.max(this.expandedMaxLevel,d.level+1),a+=this.setTreeNode(d,a,t)}):t.hierarchyState===mt.collapse&&(h==null?void 0:h.length)>=1?h.forEach(d=>{var u;d.level=((u=t.level)!==null&&u!==void 0?u:0)+1,this.totalLevel=Math.max(this.totalLevel,d.level+1),this.setTreeNode(d,a,t)}):!t.hierarchyState&&t.level+1<this.setExpandLevel&&((h==null?void 0:h.length)>=1||h===!0)?(!((s=h[0])===null||s===void 0)&&s.indicatorKey&&this.hierarchyType==="grid-tree"||(t.hierarchyState=mt.expand),(h==null?void 0:h.length)>=1&&h.forEach(d=>{var u;d.level=((u=t.level)!==null&&u!==void 0?u:0)+1,this.totalLevel=Math.max(this.totalLevel,d.level+1),this.expandedMaxLevel=Math.max(this.expandedMaxLevel,d.level+1),a+=this.setTreeNode(d,a,t)})):(h==null?void 0:h.length)>=1||h===!0?(!((l=h[0])===null||l===void 0)&&l.indicatorKey&&this.hierarchyType==="grid-tree"||(t.hierarchyState=mt.collapse),(h==null?void 0:h.length)>=1&&h.forEach(d=>{var u;d.level=((u=t.level)!==null&&u!==void 0?u:0)+1,this.totalLevel=Math.max(this.totalLevel,d.level+1),this.setTreeNode(d,a,t)})):(t.hierarchyState=mt.none,a=1),t.size=a,a}getTreePath(t,e=30){const n=[];return this.searchPath(t,this.tree,n,e),n.shift(),n}findNodeById(t,e){return t.find(n=>n.id===e)}searchPath(t,e,n,o){if(!e||t<e.startIndex||t>=e.startIndex+e.size||(n.push(e),!e.children||e.children.length===0||e.level>=o))return;const r=t-e.startIndex;if(this.cache.has(e.level+1)){const a=this.cache.get(e.level+1);if(r>=a.startIndex&&r<a.startIndex+a.size)return void this.searchPath(r,a,n,o)}let s=0,l=e.children.length-1;for(;s<=l;){const a=Math.floor((s+l)/2),h=e.children[a];if(r>=h.startIndex&&r<h.startIndex+h.size){this.cache.set(h.level,h);const d=[];this.cache.forEach((u,c)=>{c>h.level&&d.push(c)}),d.forEach(u=>{this.cache.delete(u)}),this.searchPath(r,h,n,o);break}r<h.startIndex?l=a-1:s=a+1}}movePosition(t,e,n){let o,r,s;const l=(d,u)=>{if(r!==void 0&&s!==void 0)return;d.level===t&&(d.startInTotal===e&&(r=u),d.startInTotal<=n&&n<=d.startInTotal+d.size-1&&(s=u));const c=d.children||d.columns;if(c&&d.level<t){o=d;for(let f=0;f<c.length;f++)(e>=c[f].startInTotal&&e<=c[f].startInTotal+c[f].size||n>=c[f].startInTotal&&n<=c[f].startInTotal+c[f].size)&&l(c[f],f)}};l(this.tree,0);const a=o.children||o.columns,h=a.splice(r,1);h.unshift(s,0),Array.prototype.splice.apply(a,h)}getCopiedTree(){const t=Do(this.tree.children);return Ew(t),t}}function jF(i,t){t==null||t.forEach(e=>{var n,o;const r={dimensionKey:e.dimensionKey,indicatorKey:e.indicatorKey,value:e.value,hierarchyState:e.hierarchyState,children:void 0,virtual:(n=e.virtual)!==null&&n!==void 0&&n,levelSpan:(o=e.levelSpan)!==null&&o!==void 0?o:1};i.push(r),e.children&&(r.children=[],jF(r.children,e.children))})}function UF(i,t){let e=0;return i==null||i.forEach(n=>{t?e++:n.children&&n.children.length!==0||e++,n.children&&(e+=UF(n.children,t))}),e}function TO(i,t,e,n,o,r){var s,l,a,h,d,u,c,f,g,p,v,m,b,C,_,w,y,x,S,R,B,A,M,k;const E=i.id,T=(l=(s=r.rowsDefine)===null||s===void 0?void 0:s.find(L=>typeof L!="string"&&L.dimensionKey===i.dimensionKey))!==null&&l!==void 0?l:(a=r.columnsDefine)===null||a===void 0?void 0:a.find(L=>typeof L!="string"&&L.dimensionKey===i.dimensionKey),P=(h=r.indicatorsDefine)===null||h===void 0?void 0:h.find(L=>typeof L!="string"&&(i.indicatorKey?L.indicatorKey===i.indicatorKey:L.title===i.value&&!i.dimensionKey)),H={id:E,title:(d=i.value)!==null&&d!==void 0?d:P==null?void 0:P.title,field:i.dimensionKey,style:typeof((u=P??T)===null||u===void 0?void 0:u.headerStyle)=="function"?(c=P??T)===null||c===void 0?void 0:c.headerStyle:Object.assign({},(f=P??T)===null||f===void 0?void 0:f.headerStyle),headerType:(p=(g=P==null?void 0:P.headerType)!==null&&g!==void 0?g:T==null?void 0:T.headerType)!==null&&p!==void 0?p:"text",headerIcon:(v=P==null?void 0:P.headerIcon)!==null&&v!==void 0?v:T==null?void 0:T.headerIcon,define:Object.assign({},i,P??Object.assign({},T,{sort:void 0})),fieldFormat:(m=P==null?void 0:P.headerFormat)!==null&&m!==void 0?m:T==null?void 0:T.headerFormat,dropDownMenu:(b=P==null?void 0:P.dropDownMenu)!==null&&b!==void 0?b:T==null?void 0:T.dropDownMenu,pivotInfo:{value:i.value,dimensionKey:i.dimensionKey,isPivotCorner:!1},width:T==null?void 0:T.width,minWidth:T==null?void 0:T.minWidth,maxWidth:T==null?void 0:T.maxWidth,showSort:(C=P==null?void 0:P.showSort)!==null&&C!==void 0?C:T==null?void 0:T.showSort,sort:P==null?void 0:P.sort,description:T==null?void 0:T.description};P?(P.customRender&&(i.customRender=P.customRender),O((_=r._indicators)===null||_===void 0?void 0:_.find(L=>L.indicatorKey===P.indicatorKey))||(w=r._indicators)===null||w===void 0||w.push({id:++r.sharedVar.seqId,indicatorKey:P.indicatorKey,field:P.indicatorKey,fieldFormat:P==null?void 0:P.format,cellType:(x=(y=P==null?void 0:P.cellType)!==null&&y!==void 0?y:P==null?void 0:P.columnType)!==null&&x!==void 0?x:"text",chartModule:"chartModule"in P?P.chartModule:null,chartSpec:"chartSpec"in P?P.chartSpec:null,noDataRenderNothing:"noDataRenderNothing"in P&&P.noDataRenderNothing,sparklineSpec:"sparklineSpec"in P?P.sparklineSpec:null,style:P==null?void 0:P.style,icon:P==null?void 0:P.icon,define:Object.assign({},i,P,{dragHeader:T==null?void 0:T.dragHeader}),width:P==null?void 0:P.width,minWidth:P==null?void 0:P.minWidth,maxWidth:P==null?void 0:P.maxWidth,disableColumnResize:P==null?void 0:P.disableColumnResize})):i.indicatorKey&&(O((S=r._indicators)===null||S===void 0?void 0:S.find(L=>L.indicatorKey===i.indicatorKey))||(R=r._indicators)===null||R===void 0||R.push({id:++r.sharedVar.seqId,indicatorKey:i.indicatorKey,field:i.indicatorKey,cellType:"text",define:Object.assign({},i)})),e[E]=H,r._headerObjects[E]=H;for(let L=o-1;L>=0;L--)t[L][r.colIndex]=n[L];if(t[o][r.colIndex]=E,i.levelSpan>1)for(let L=1;L<i.levelSpan;L++){if(!t[o+L]){t[o+L]=[];for(let F=0;F<r.colIndex;F++)t[o+L][F]=t[o][F]}t[o+L][r.colIndex]=E}if(((B=i.children)===null||B===void 0?void 0:B.length)>=1)r._addHeaders(t,o+((A=i.levelSpan)!==null&&A!==void 0?A:1),(M=i.children)!==null&&M!==void 0?M:[],[...n,...Array((k=i.levelSpan)!==null&&k!==void 0?k:1).fill(E)],e);else{for(let L=o+1;L<t.length;L++)t[L][r.colIndex]=E;r.colIndex++}}function PO(i,t,e,n,o,r,s,l,a,h,d,u){var c,f,g,p,v,m,b,C,_,w,y,x,S,R,B,A,M,k,E,T,P,H,L,F,z,I,N,W,D,j,V,X,K,J,ot,lt,ct,it,nt;const ht=i.id,$=(f=(c=u.rowsDefine)===null||c===void 0?void 0:c.find(tt=>typeof tt!="string"&&tt.dimensionKey===i.dimensionKey))!==null&&f!==void 0?f:(g=u.columnsDefine)===null||g===void 0?void 0:g.find(tt=>typeof tt!="string"&&tt.dimensionKey===i.dimensionKey),Y=(p=u.indicatorsDefine)===null||p===void 0?void 0:p.find(tt=>typeof tt!="string"&&(i.indicatorKey?tt.indicatorKey===i.indicatorKey:tt.title===i.value&&!i.dimensionKey)),_t={id:ht,title:(v=i.value)!==null&&v!==void 0?v:Y==null?void 0:Y.title,field:i.dimensionKey,style:typeof((m=Y??$)===null||m===void 0?void 0:m.headerStyle)=="function"?(b=Y??$)===null||b===void 0?void 0:b.headerStyle:Object.assign({},(C=Y??$)===null||C===void 0?void 0:C.headerStyle),headerType:(w=(_=Y==null?void 0:Y.headerType)!==null&&_!==void 0?_:$==null?void 0:$.headerType)!==null&&w!==void 0?w:"text",headerIcon:(y=Y==null?void 0:Y.headerIcon)!==null&&y!==void 0?y:$==null?void 0:$.headerIcon,define:Object.assign(i,{linkJump:(x=Y??$)===null||x===void 0?void 0:x.linkJump,linkDetect:(S=Y??$)===null||S===void 0?void 0:S.linkDetect,templateLink:(R=Y??$)===null||R===void 0?void 0:R.templateLink,keepAspectRatio:(A=(B=Y??$)===null||B===void 0?void 0:B.keepAspectRatio)!==null&&A!==void 0&&A,imageAutoSizing:(M=Y??$)===null||M===void 0?void 0:M.imageAutoSizing,headerCustomRender:(k=Y??$)===null||k===void 0?void 0:k.headerCustomRender,headerCustomLayout:(E=Y??$)===null||E===void 0?void 0:E.headerCustomLayout,dragHeader:$==null?void 0:$.dragHeader,disableHeaderHover:!!(!((T=Y??$)===null||T===void 0)&&T.disableHeaderHover),disableHeaderSelect:!!(!((P=Y??$)===null||P===void 0)&&P.disableHeaderSelect),showSort:(H=Y==null?void 0:Y.showSort)!==null&&H!==void 0?H:$==null?void 0:$.showSort,hide:Y==null?void 0:Y.hide}),fieldFormat:(L=Y==null?void 0:Y.headerFormat)!==null&&L!==void 0?L:$==null?void 0:$.headerFormat,dropDownMenu:(F=Y==null?void 0:Y.dropDownMenu)!==null&&F!==void 0?F:$==null?void 0:$.dropDownMenu,pivotInfo:{value:i.value,dimensionKey:i.dimensionKey,isPivotCorner:!1},hierarchyLevel:i.level,dimensionTotalLevel:r,hierarchyState:i.hierarchyState,width:$==null?void 0:$.width,minWidth:$==null?void 0:$.minWidth,maxWidth:$==null?void 0:$.maxWidth,showSort:(z=Y==null?void 0:Y.showSort)!==null&&z!==void 0?z:$==null?void 0:$.showSort,sort:Y==null?void 0:Y.sort,description:$==null?void 0:$.description,parentCellId:n[n.length-1]};Y?(Y.customRender&&(i.customRender=Y.customRender),O((I=u._indicators)===null||I===void 0?void 0:I.find(tt=>tt.indicatorKey===Y.indicatorKey))||(N=u._indicators)===null||N===void 0||N.push({id:++u.sharedVar.seqId,indicatorKey:Y.indicatorKey,field:Y.indicatorKey,fieldFormat:Y==null?void 0:Y.format,cellType:(D=(W=Y==null?void 0:Y.cellType)!==null&&W!==void 0?W:Y==null?void 0:Y.columnType)!==null&&D!==void 0?D:"text",chartModule:"chartModule"in Y?Y.chartModule:null,chartSpec:"chartSpec"in Y?Y.chartSpec:null,noDataRenderNothing:"noDataRenderNothing"in Y&&Y.noDataRenderNothing,sparklineSpec:"sparklineSpec"in Y?Y.sparklineSpec:null,style:Y==null?void 0:Y.style,icon:Y==null?void 0:Y.icon,define:Object.assign({},i,Y,{dragHeader:$==null?void 0:$.dragHeader}),width:Y==null?void 0:Y.width,minWidth:Y==null?void 0:Y.minWidth,maxWidth:Y==null?void 0:Y.maxWidth,disableColumnResize:Y==null?void 0:Y.disableColumnResize})):i.indicatorKey&&(O((j=u._indicators)===null||j===void 0?void 0:j.find(tt=>tt.indicatorKey===i.indicatorKey))||(V=u._indicators)===null||V===void 0||V.push({id:++u.sharedVar.seqId,indicatorKey:i.indicatorKey,field:i.indicatorKey,cellType:"text",define:Object.assign({},i)})),e[ht]=_t,u._headerObjects[ht]=_t;for(let tt=o-1;tt>=0;tt--)t[tt][u.colIndex]=n[tt];t[o][u.colIndex]=ht;const et=Math.min((h?d:!d)?s:s-1,(X=i.levelSpan)!==null&&X!==void 0?X:1e3);if(et>0)for(let tt=o+1;tt<et;tt++){if(!t[tt]){t[tt]=[];for(let at=0;at<u.colIndex;at++)t[tt][at]=t[o][at]}t[tt][u.colIndex]=ht}if(((K=(i.hierarchyState===mt.expand&&i).children)===null||K===void 0?void 0:K.length)>=1)u._addHeadersForGridTreeMode(t,o+((J=i.levelSpan)!==null&&J!==void 0?J:1),(ot=i.children)!==null&&ot!==void 0?ot:[],[...n,...Array((lt=i.levelSpan)!==null&&lt!==void 0?lt:1).fill(ht)],r,s,l&&i.hierarchyState===mt.expand,a,e,h);else{const tt=(h?d:!d)?s:s-1;for(let at=o+1;at<tt;at++)t[at]||(t[at]=[]),t[at][u.colIndex]=ht;if(o<=tt-1&&(h&&d===!1||!h&&d===!0)){let at=i;const dt=tt-o;for(;at&&!(!((ct=at.children)===null||ct===void 0)&&ct[0].indicatorKey);)at=at.children[0];u._addHeadersForGridTreeMode(t,s-1,(it=at.children)!==null&&it!==void 0?it:[],[...n,...Array(Math.max(dt,(nt=i.levelSpan)!==null&&nt!==void 0?nt:1)).fill(ht)],r,s,!0,a,e,h)}else u.colIndex++}}function HO(i,t,e,n,o,r,s,l,a){var h,d,u,c,f,g,p,v,m,b,C,_,w,y,x,S,R,B,A,M,k,E,T,P,H,L,F,z,I;const N=i.id,W=l.find(V=>typeof V!="string"&&V.dimensionKey===i.dimensionKey),D=(h=a.indicatorsDefine)===null||h===void 0?void 0:h.find(V=>typeof V!="string"&&(i.indicatorKey?V.indicatorKey===i.indicatorKey:V.title===i.value)),j={id:N,title:(d=i.value)!==null&&d!==void 0?d:D.title,field:i.dimensionKey,style:i.level+1===r||typeof((u=D??W)===null||u===void 0?void 0:u.headerStyle)=="function"?(c=D??W)===null||c===void 0?void 0:c.headerStyle:Object.assign({},(f=D??W)===null||f===void 0?void 0:f.headerStyle,{textAlign:"left"}),headerType:(p=(g=D==null?void 0:D.headerType)!==null&&g!==void 0?g:W==null?void 0:W.headerType)!==null&&p!==void 0?p:"text",headerIcon:(v=D==null?void 0:D.headerIcon)!==null&&v!==void 0?v:W==null?void 0:W.headerIcon,define:Object.assign(i,{linkJump:(m=D??W)===null||m===void 0?void 0:m.linkJump,linkDetect:(b=D??W)===null||b===void 0?void 0:b.linkDetect,templateLink:(C=D??W)===null||C===void 0?void 0:C.templateLink,keepAspectRatio:(w=(_=D??W)===null||_===void 0?void 0:_.keepAspectRatio)!==null&&w!==void 0&&w,imageAutoSizing:(y=D??W)===null||y===void 0?void 0:y.imageAutoSizing,headerCustomRender:(x=D??W)===null||x===void 0?void 0:x.headerCustomRender,headerCustomLayout:(S=D??W)===null||S===void 0?void 0:S.headerCustomLayout,dragHeader:W==null?void 0:W.dragHeader,disableHeaderHover:!!(!((R=D??W)===null||R===void 0)&&R.disableHeaderHover),disableHeaderSelect:!!(!((B=D??W)===null||B===void 0)&&B.disableHeaderSelect),showSort:(A=D==null?void 0:D.showSort)!==null&&A!==void 0?A:W==null?void 0:W.showSort,hide:D==null?void 0:D.hide}),fieldFormat:(M=D==null?void 0:D.headerFormat)!==null&&M!==void 0?M:W==null?void 0:W.headerFormat,dropDownMenu:(k=D==null?void 0:D.dropDownMenu)!==null&&k!==void 0?k:W==null?void 0:W.dropDownMenu,pivotInfo:{value:i.value,dimensionKey:i.dimensionKey,isPivotCorner:!1},hierarchyLevel:i.level,dimensionTotalLevel:r,hierarchyState:i.hierarchyState,width:W==null?void 0:W.width,minWidth:W==null?void 0:W.minWidth,maxWidth:W==null?void 0:W.maxWidth,parentCellId:n[n.length-1]};D?(D.customRender&&(i.customRender=D.customRender),O((E=a._indicators)===null||E===void 0?void 0:E.find(V=>V.indicatorKey===D.indicatorKey))||(T=a._indicators)===null||T===void 0||T.push({id:++a.sharedVar.seqId,indicatorKey:D.indicatorKey,field:D.indicatorKey,fieldFormat:D==null?void 0:D.format,cellType:(H=(P=D==null?void 0:D.cellType)!==null&&P!==void 0?P:D==null?void 0:D.columnType)!==null&&H!==void 0?H:"text",chartModule:"chartModule"in D?D.chartModule:null,chartSpec:"chartSpec"in D?D.chartSpec:null,noDataRenderNothing:"noDataRenderNothing"in D&&D.noDataRenderNothing,sparklineSpec:"sparklineSpec"in D?D.sparklineSpec:null,style:D==null?void 0:D.style,icon:D==null?void 0:D.icon,define:Object.assign({},i,D,{dragHeader:W==null?void 0:W.dragHeader}),width:D==null?void 0:D.width,minWidth:D==null?void 0:D.minWidth,maxWidth:D==null?void 0:D.maxWidth,disableColumnResize:D==null?void 0:D.disableColumnResize})):i.indicatorKey&&(O((L=a._indicators)===null||L===void 0?void 0:L.find(V=>V.indicatorKey===i.indicatorKey))||(F=a._indicators)===null||F===void 0||F.push({id:++a.sharedVar.seqId,indicatorKey:i.indicatorKey,field:i.indicatorKey,cellType:"text",define:Object.assign({},i)})),e[N]=j,a._headerObjects[N]=j,t[o][a.colIndex]=N;for(let V=o-1;V>=0;V--)t[V][a.colIndex]=n[V];if(i.hierarchyState===mt.expand&&((z=i.children)===null||z===void 0?void 0:z.length)>=1)s&&a.colIndex++,a._addHeadersForTreeMode(t,o,(I=i.children)!==null&&I!==void 0?I:[],[...n,N],r,s&&i.hierarchyState===mt.expand,l,e);else{s&&a.colIndex++;for(let V=o+1;V<t.length;V++)t[V][a.colIndex]=N}}function Ew(i){for(let t=0;t<i.length;t++){const e=i[t];delete e.level,delete e.startIndex,delete e.id,delete e.levelSpan,delete e.size,delete e.startInTotal;const n=e.children||e.columns;n&&Ew(n)}}function Lw(i,t,e,n,o){var r;for(let s=i.length-1;s>=0;s--){const l=i[s];if(t.push(l),n&&l.hide)i.splice(s,1);else if(l.indicatorKey){const a=(r=e==null?void 0:e.find(h=>h.indicatorKey===l.indicatorKey))===null||r===void 0?void 0:r.hide;typeof a=="function"?a({dimensionPaths:t,table:o})&&i.splice(s,1):a&&i.splice(s,1)}else l.children&&l.children.length>0&&Lw(l.children,t,e,n,o);t.pop()}}function $F(i){const t=i.columnObjects;for(let e=0;e<t.length;e++){const n=t[e];if(n!=null&&n.aggregation)return!0}return!1}function KF(i){const t=i.columnObjects;let e=0;for(let n=0;n<t.length;n++){const o=t[n];o!=null&&o.aggregation&&(Array.isArray(o==null?void 0:o.aggregation)?e=Math.max(e,o.aggregation.filter(r=>r.showOnTop).length):o.aggregation.showOnTop&&(e=Math.max(e,1)))}return e}function YF(i){const t=i.columnObjects;let e=0;for(let n=0;n<t.length;n++){const o=t[n];o!=null&&o.aggregation&&(Array.isArray(o==null?void 0:o.aggregation)?e=Math.max(e,o.aggregation.filter(r=>!r.showOnTop).length):o.aggregation.showOnTop||(e=Math.max(e,1)))}return e}function XF(i){if(i._table.options.groupBy)return!0;const{columns:t}=i._table.options;if(Q(t)&&t.length>0)for(let e=0;e<t.length;e++){const n=t[e];if(!jt(n)&&n.tree)return!0}return!1}function qF(i){const{columns:t,rows:e,indicators:n}=i.options;if(i.isPivotTable()){if(Q(t)&&t.length>0)for(let o=0;o<t.length;o++){const r=t[o];if(!jt(r)&&(r.headerType==="image"||r.headerType==="video"||typeof r.headerType=="function")&&r.imageAutoSizing)return!0}if(Q(e)&&e.length>0)for(let o=0;o<e.length;o++){const r=e[o];if(!jt(r)&&(r.headerType==="image"||r.headerType==="video"||typeof r.headerType=="function")&&r.imageAutoSizing)return!0}if(Q(n)&&n.length>0)for(let o=0;o<n.length;o++){const r=n[o];if(!jt(r)&&((r.cellType==="image"||r.cellType==="video"||typeof r.cellType=="function")&&r.imageAutoSizing||(r.headerType==="image"||r.headerType==="video"||typeof r.headerType=="function")&&r.imageAutoSizing))return!0}}else if(Q(t)&&t.length>0)for(let o=0;o<t.length;o++){const r=t[o];if((r.cellType==="image"||r.cellType==="video"||typeof r.cellType=="function")&&r.imageAutoSizing||(r.headerType==="image"||r.headerType==="video"||typeof r.headerType=="function")&&r.imageAutoSizing)return!0}return!1}function kO(i,t){var e,n,o,r,s,l,a,h,d,u,c,f,g,p,v;let m,b;t.columnTree&&(i.options.indicatorsAsCol!==!1&&i.options.supplementIndicatorNodes!==!1&&(i.internalProps.columnTree=Ym(i.internalProps.columnTree,t.indicators)),m=new dg((e=i.internalProps.columnTree)!==null&&e!==void 0?e:[],i.layoutNodeId,i.options.columnHierarchyType,i.options.columnHierarchyType!=="grid"?(n=i.options.columnExpandLevel)!==null&&n!==void 0?n:1:void 0)),t.rowTree&&(i.options.indicatorsAsCol===!1&&i.options.supplementIndicatorNodes!==!1&&(i.internalProps.rowTree=Ym(i.internalProps.rowTree,t.indicators)),b=new dg((o=i.internalProps.rowTree)!==null&&o!==void 0?o:[],i.layoutNodeId,i.options.rowHierarchyType,i.options.rowHierarchyType!=="grid"?(r=i.options.rowExpandLevel)!==null&&r!==void 0?r:1:void 0));const C=!((s=b==null?void 0:b.dimensionKeys)===null||s===void 0)&&s.count?b.dimensionKeys.valueArr():(a=(l=t.rows)===null||l===void 0?void 0:l.reduce((y,x)=>(typeof x=="string"?y.push(x):y.push(x.dimensionKey),y),[]))!==null&&a!==void 0?a:[],_=!((h=m==null?void 0:m.dimensionKeys)===null||h===void 0)&&h.count?m.dimensionKeys.valueArr():(u=(d=t.columns)===null||d===void 0?void 0:d.reduce((y,x)=>(typeof x=="string"?y.push(x):y.push(x.dimensionKey),y),[]))!==null&&u!==void 0?u:[],w=(f=(c=t.indicators)===null||c===void 0?void 0:c.reduce((y,x)=>{var S;return typeof x=="string"?y.push(x):(y.push(x.indicatorKey),(x.chartSpec||x.sparklineSpec)&&(!((S=i.internalProps.dataConfig)===null||S===void 0)&&S.aggregationRules?i.internalProps.dataConfig.aggregationRules.find(R=>R.indicatorKey===x.indicatorKey)||i.internalProps.dataConfig.aggregationRules.push({field:x.indicatorKey,indicatorKey:x.indicatorKey,aggregationType:Zt.NONE}):i.internalProps.dataConfig?i.internalProps.dataConfig.aggregationRules=[{field:x.indicatorKey,indicatorKey:x.indicatorKey,aggregationType:Zt.NONE}]:i.internalProps.dataConfig={aggregationRules:[{field:x.indicatorKey,indicatorKey:x.indicatorKey,aggregationType:Zt.NONE}]})),y},[]))!==null&&f!==void 0?f:[];return t.rowHierarchyType!=="grid"&&((p=(g=t.extensionRows)===null||g===void 0?void 0:g.length)!==null&&p!==void 0?p:0)>=1&&((v=t.extensionRows)===null||v===void 0||v.forEach(y=>{const x=[];y.rows.forEach(S=>{typeof S=="string"?x.push(S):x.push(S.dimensionKey)}),C.push(...x)})),{rowKeys:C,columnKeys:_,indicatorKeys:w,columnDimensionTree:m,rowDimensionTree:b}}function Ym(i,t){const e=(n,o)=>{n.forEach(r=>{var s;r.indicatorKey||o||!((s=r.children)===null||s===void 0)&&s.length&&r.children?r.children&&Array.isArray(r.children)&&e(r.children,o||!!r.indicatorKey):r.children=t==null?void 0:t.map(l=>{var a;return typeof l=="string"?{indicatorKey:l,value:l}:{indicatorKey:l.indicatorKey,value:(a=l.title)!==null&&a!==void 0?a:l.indicatorKey}})})};return i!=null&&i.length?e(i,!1):i=t==null?void 0:t.map(n=>{var o;return typeof n=="string"?{indicatorKey:n,value:n}:{indicatorKey:n.indicatorKey,value:(o=n.title)!==null&&o!==void 0?o:n.indicatorKey}}),i}function EO(i,t,e,n){const o=[];for(let r=0;r<(t==null?void 0:t.length);r++){const s=t[r];s!=null&&s.hide&&o.push(s)}(o.length||e)&&Lw(i,[],o,e,n)}function Fw(i,t){var e;return OH(t,i)||((e=of(i,t))!==null&&e!==void 0?e:{top:-1,row:-1,bottom:-1,height:-1})}function zw(i,t){var e;return DH(t,i)||((e=nf(i,t))!==null&&e!==void 0?e:{left:-1,col:-1,right:-1,width:1})}function ZF(i,t,e){const n=Fw(t,e),{row:o,top:r,bottom:s,height:l}=n,a=zw(i,e),{col:h,left:d,right:u,width:c}=a;return{row:o,col:h,rect:{left:d,right:u,top:r,bottom:s,width:c,height:l}}}function nf(i,t){if(i===0)return{left:0,col:0,right:0,width:0};const e=QF(i,t),n=t.getColsWidth(0,e);return i>=n?((o,r)=>{let s=r-t.getColWidth(o);const{colCount:l}=t.internalProps;for(let a=o;a<l;a++){const h=t.getColWidth(a),d=s+h;if(Math.round(s)<=Math.round(i)&&Math.round(i)<Math.round(d))return{left:s,col:a,right:d,width:h};s=d}return null})(e,n):((o,r)=>{let s=r;for(let l=o;l>=0;l--){const a=t.getColWidth(l),h=s-a;if(Math.round(h)<=Math.round(i)&&Math.round(i)<Math.round(s))return{left:h,col:l,right:s,width:a};s=h}return null})(e,n)}function of(i,t){var e;if(i===0)return{top:0,row:0,bottom:0,height:0};const n=((e=t.options.customConfig)===null||e===void 0?void 0:e._disableColumnAndRowSizeRound)===!0?Math.floor:Math.round,o=JF(i,t),r=t.getRowsHeight(0,o);return i>=r?((s,l)=>{let a=l-t.getRowHeight(s);const{rowCount:h}=t.internalProps;for(let d=s;d<h;d++){const u=t.getRowHeight(d),c=a+u;if(n(a)<=n(i)&&n(i)<n(c))return{top:a,row:d,bottom:c,height:u};a=c}return null})(o,r):((s,l)=>{let a=l;for(let h=s;h>=0;h--){const d=t.getRowHeight(h),u=a-d;if(n(u)<=n(i)&&n(i)<n(a))return{top:u,row:h,bottom:a,height:d};a=u}return null})(o,r)}function Iw(i,t,e){if(i===0)return{left:0,col:0,right:0,width:0};if(i-=e.tableX,t&&i>e.tableNoFrameWidth-e.getRightFrozenColsWidth()&&i<e.tableNoFrameWidth&&i<=e.getAllColsWidth()){for(let n=0;n<e.rightFrozenColCount;n++)if(i>e.tableNoFrameWidth-e.getColsWidth(e.colCount-n-1,e.colCount-1))return{col:e.colCount-n-1,left:void 0,right:void 0,width:void 0}}return nf(i,e)}function Ow(i,t,e){if(i===0)return{top:0,row:0,bottom:0,height:0};if(i-=e.tableY,t&&i>e.tableNoFrameHeight-e.getBottomFrozenRowsHeight()&&i<e.tableNoFrameHeight){for(let n=0;n<e.rightFrozenColCount;n++)if(i>e.tableNoFrameHeight-e.getRowsHeight(e.rowCount-n-1,e.rowCount-1))return{row:e.rowCount-n-1,top:void 0,bottom:void 0,height:void 0}}return of(i,e)}function JF(i,t){let e=t.defaultRowHeight;return t._rowRangeHeightsMap.get("$0$"+(t.rowCount-1))&&(e=t._rowRangeHeightsMap.get("$0$"+(t.rowCount-1))/t.rowCount),Math.min(Math.ceil(i/e),t.rowCount-1)}function QF(i,t){if(t._colRangeWidthsMap.get("$0$"+(t.colCount-1))){let e=0,n=t.colCount-1;for(;n-e>1;){const o=Math.floor((e+n)/2);if(i<t._colRangeWidthsMap.get(`$0$${o}`))n=o;else{if(!(i>t._colRangeWidthsMap.get(`$0$${o}`)))return o;e=o}}return n}return Math.min(Math.ceil(i/t.internalProps.defaultColWidth),t.colCount-1)}function tz(i,t,e){i-=e.tableX;let n=!1;(t-=e.tableY)>0&&t<e.getFrozenRowsHeight()&&(n=!0);let o=!1;i>0&&i<e.getFrozenColsWidth()&&(o=!0);let r=!1;t>e.tableNoFrameHeight-e.getBottomFrozenRowsHeight()&&t<e.tableNoFrameHeight&&t<=e.getAllRowsHeight()&&(r=!0);let s=!1;i>e.tableNoFrameWidth-e.getRightFrozenColsWidth()&&i<e.tableNoFrameWidth&&i<=e.getAllColsWidth()&&(s=!0);const l=Iw((o||s?i:i+e.scrollLeft)+e.tableX,s,e),a=Ow((n||r?t:t+e.scrollTop)+e.tableY,r,e);if(l&&a){const{row:h,top:d,bottom:u,height:c}=a,{col:f,left:g,right:p,width:v}=l;return{row:h,col:f,rect:{left:g,right:p,top:d,bottom:u,width:v,height:c}}}return{col:-1,row:-1}}function Xm(i){return i.length===2&&Yt(i[0])&&Yt(i[1])&&i[1]>=i[0]}function qm(i){const t=i[1]-i[0],e=i[1]*i[0]<0;let n=i[0]<=0?0-i[0]:0,o=i[1]>0?i[1]-0:0;return t===0?i[0]<0?(n=1,o=0):i[0]>0&&(n=0,o=1):(n/=t,o/=t),{total:t,negative:n,positive:o,includeZero:e,domain:i,extendable_min:!0,extendable_max:!0}}function Zm(i,t){const{positive:e,negative:n,extendable_min:o,extendable_max:r,domain:s}=i,{positive:l,negative:a,extendable_min:h,extendable_max:d,domain:u}=t;if(l>0){if(!h)return!1;let c=n/e;r&&(c=n/Math.max(e,l),s[1]=-s[0]/c),u[0]=-u[1]*c}else if(a>0){if(!d)return!1;let c=e/n;o&&(c=e/Math.max(n,n),s[0]=-s[1]/c),u[1]=-u[0]*c}return!0}function Jm(i,t){const{extendable_min:e,extendable_max:n,domain:o}=i,{positive:r,negative:s,domain:l}=t;return(r!==0||s!==0)&&!(r>0&&!n)&&!(s>0&&!e)&&(o[0]=l[0],o[1]=l[1],!0)}function Qm(i,t){const{positive:e,negative:n,extendable_max:o,domain:r}=i,{positive:s,negative:l,extendable_min:a,domain:h}=t;if(o&&a){const d=Math.max(n,l)/Math.max(e,s);r[1]=-r[0]/d,h[0]=-h[1]*d}else if(a){const d=n/e;h[0]=-h[1]*d}else{if(!o)return!1;{const d=l/s;r[1]=-r[0]/d}}return!0}function tb(i,t){const{extendable_min:e,domain:n}=i,{extendable_max:o,domain:r}=t;return!(!e||!o)&&(n[0]=-n[1],r[1]=-r[0],!0)}function ez(i,t){const e=[i.min,i.max],n=[t.min,t.max];if(!Xm(e)||!Xm(n))return;const o=qm(e),r=qm(n),{positive:s,negative:l,extendable_max:a,includeZero:h}=o,{positive:d,negative:u,extendable_max:c,includeZero:f}=r;if(s===0&&l===0){if(!Jm(o,r))return}else if(d===0&&u===0){if(!Jm(r,o))return}else if(h||f)if(h&&!f){if(!Zm(o,r))return}else if(f&&!h){if(!Zm(r,o))return}else{if(l===u)return;if(l>u){if(!Qm(o,r))return}else if(!Qm(r,o))return}else{if(l===0&&d===0){if(!tb(o,r))return}else if(u===0&&s===0&&!tb(r,o))return;if(l===0&&u===0)if(e[0]===0&&n[0]>0)n[0]=0;else{if(!(n[0]===0&&e[0]>0))return;e[0]=0}if(s===0&&d===0)if(e[1]===0&&n[1]>0){if(!c)return;n[1]=0}else{if(!(n[1]===0&&e[1]>0)||!a)return;e[1]=0}}return{range1:e,range2:n}}function iz(i,t,e,n,o,r){const s=ut.getFunction("getAxisDomainRangeAndLabels"),{axisOption:l,isZeroAlign:a}=Er(t,e,n===0?"right":"left",r),{ticks:h}=s(i.min,i.max,l,a,o==="bottom"||o==="top"?r._table.getColWidth(t)||r._table.tableNoFrameWidth:r._table.getRowHeight(e)||r._table.tableNoFrameHeight);return h}function ar(i,t,e,n){return n!==0&&i?()=>i.map(o=>{const r=(o-t.min)/(t.max-t.min),s=(e.max-e.min)*r+e.min;return Math.round(100*s)/100}):void 0}function nz(i,t,e){var n,o,r,s,l,a,h;if(e._table.isPivotChart())if(e.indicatorsAsCol){if(e.hasTwoIndicatorAxes&&t===e.columnHeaderLevelCount-1&&i>=e.rowHeaderLevelCount&&i<e.colCount-e.rightFrozenColCount){const d=Kl("top",i,t+1,i,e.columnHeaderLevelCount-1,i,t,1,e);if(!d)return;const u=e._table._getCellStyle(i,t+1),c=xt(q("padding",u,i,t+1,e._table)),{range:f,ticks:g,axisOption:p,targetTicks:v,targetRange:m,index:b,theme:C}=d;return Z(p==null?void 0:p.min)&&(f.min=p.min,f.min>0&&(p.zero=!1)),Z(p==null?void 0:p.max)&&(f.max=p.max,f.max<0&&(p.zero=!1)),rt({range:f},p,{orient:"top",type:(p==null?void 0:p.type)||"linear",label:{flush:!0},tick:{tickMode:ar(v,m,f,b)},__ticksForVTable:g,__vtableChartTheme:C,__vtablePadding:c})}if(t===e.rowCount-e.bottomFrozenRowCount&&i>=e.rowHeaderLevelCount&&i<e.colCount-e.rightFrozenColCount){const d=e.getIndicatorKeyInChartSpec(i,t);let u=null;d==null||d.forEach(y=>{const x=e.getIndicatorInfo(y);x&&(u=x)});const c=Kl("bottom",i,t-1,i,t,i,t,0,e);if(!c)return;const f=e._table._getCellStyle(i,t-1),g=xt(q("padding",f,i,t-1,e._table)),{range:p,ticks:v,axisOption:m,index:b,targetTicks:C,targetRange:_,theme:w}=c;return Z(m==null?void 0:m.min)&&(p.min=m.min,p.min>0&&(m.zero=!1)),Z(m==null?void 0:m.max)&&(p.max=m.max,p.max<0&&(m.zero=!1)),rt({title:{visible:!0,text:u==null?void 0:u.title},range:p},m,{orient:"bottom",type:(m==null?void 0:m.type)||"linear",label:{flush:!0},tick:{tickMode:ar(C,_,p,b)},__ticksForVTable:v,__vtableChartTheme:w,__vtablePadding:g})}if(i===e.rowHeaderLevelCount-1&&t>=e.columnHeaderLevelCount&&t<e.rowCount-e.bottomFrozenRowCount){let d=e.getDimensionKeyInChartSpec(e.rowHeaderLevelCount,t);Q(d)&&(d=d[0]);const u=(n=e.dataset.collectedValues[d])!==null&&n!==void 0?n:[],c=e.getRowKeysPath(i,t),f=(o=u[c??""])!==null&&o!==void 0?o:[],{axisOption:g,theme:p,chartType:v}=Er(i+1,t,"left",e);if((g==null?void 0:g.visible)===!1)return;const m=e._table._getCellStyle(i+1,t),b=xt(q("padding",m,i+1,t,e._table)),C=e.getRawChartSpec(i+1,t);return rt({domain:(g==null?void 0:g.type)==="linear"?void 0:Array.from(f),range:(g==null?void 0:g.type)==="linear"?f:void 0,title:{autoRotate:!0}},g,{orient:"left",type:(r=g==null?void 0:g.type)!==null&&r!==void 0?r:"band",__vtableChartTheme:p,inverse:sz(g,((s=C==null?void 0:C.direction)!==null&&s!==void 0?s:v==="scatter"?"vertical":"horizontal")==="horizontal"),__vtablePadding:b})}}else{if(i===e.rowHeaderLevelCount-1&&t>=e.columnHeaderLevelCount&&t<e.rowCount-e.bottomFrozenRowCount){const d=e.getIndicatorKeyInChartSpec(i,t);let u=null;d==null||d.forEach(y=>{const x=e.getIndicatorInfo(y);x&&(u=x)});const c=Kl("left",i+1,t,i,t,i,t,0,e);if(!c)return;const f=e._table._getCellStyle(i+1,t),g=xt(q("padding",f,i+1,t,e._table)),{range:p,ticks:v,axisOption:m,index:b,targetTicks:C,targetRange:_,theme:w}=c;return Z(m==null?void 0:m.min)&&(p.min=m.min,p.min>0&&(m.zero=!1)),Z(m==null?void 0:m.max)&&(p.max=m.max,p.max<0&&(m.zero=!1)),rt({title:{visible:!0,text:u==null?void 0:u.title,autoRotate:!0},range:p},m,{orient:"left",type:(m==null?void 0:m.type)||"linear",label:{flush:!0},tick:{tickMode:ar(C,_,p,b)},__ticksForVTable:v,__vtableChartTheme:w,__vtablePadding:g})}if(i===e.colCount-e.rightFrozenColCount&&t>=e.columnHeaderLevelCount&&t<e.rowCount-e.bottomFrozenRowCount){const d=Kl("right",i-1,t,e.rowHeaderLevelCount-1,t,i,t,1,e);if(!d)return;const u=e._table._getCellStyle(i-1,t),c=xt(q("padding",u,i-1,t,e._table)),{range:f,ticks:g,axisOption:p,index:v,targetTicks:m,targetRange:b,theme:C}=d;return Z(p==null?void 0:p.min)&&(f.min=p.min,f.min>0&&(p.zero=!1)),Z(p==null?void 0:p.max)&&(f.max=p.max,f.max<0&&(p.zero=!1)),rt({range:f,title:{autoRotate:!0}},p,{orient:"right",type:(p==null?void 0:p.type)||"linear",label:{flush:!0},tick:{tickMode:ar(m,b,f,v)},__ticksForVTable:g,__vtableChartTheme:C,__vtablePadding:c})}if(t===e.rowCount-e.bottomFrozenRowCount&&i>=e.rowHeaderLevelCount&&i<e.colCount-e.rightFrozenColCount){let d=e.getDimensionKeyInChartSpec(i,e.columnHeaderLevelCount);Q(d)&&(d=d[0]);const u=(l=e.dataset.collectedValues[d])!==null&&l!==void 0?l:[],c=e.getColKeysPath(i,t),f=(a=u==null?void 0:u[c??""])!==null&&a!==void 0?a:[],{axisOption:g,isPercent:p,theme:v,chartType:m}=Er(i,t-1,"bottom",e);if((g==null?void 0:g.visible)===!1)return;const b=e._table._getCellStyle(i,t-1),C=xt(q("padding",b,i,t-1,e._table));return rt({domain:(g==null?void 0:g.type)==="linear"?void 0:Array.from(f),range:(g==null?void 0:g.type)==="linear"?f:void 0},g,{orient:"bottom",type:(h=g==null?void 0:g.type)!==null&&h!==void 0?h:"band",__vtableChartTheme:v,__vtablePadding:C})}}}function Er(i,t,e,n){var o,r;const s=n.getRawChartSpec(i,t),l=(o=s.axes)!==null&&o!==void 0?o:[];if(n._table.pivotChartAxes.forEach(u=>{l.findIndex(c=>u.orient===c.orient)===-1&&l.push(u)}),s&&Q(l)){const u=l.find(c=>c.orient===e);if(u){const{seriesIndex:c,seriesId:f}=u;let g,p;O(f)&&Q(s.series)?g=(Q(f)?f:[f]).map(b=>{const C=s.series.findIndex(_=>_.id===b);return C>=0&&(p=s.series[C]),C}):O(c)&&Q(s.series)&&(g=c);const{isZeroAlign:v,isTickAlign:m}=eb(s,e,n);return{axisOption:u,isPercent:s.percent,isZeroAlign:v,isTickAlign:m,seriesIndice:g,theme:s.theme,chartType:(r=p==null?void 0:p.type)!==null&&r!==void 0?r:s.type}}}const a=n._table.pivotChartAxes.find(u=>u.orient===e),{isZeroAlign:h,isTickAlign:d}=eb(s,e,n);return{axisOption:a,isPercent:!1,isZeroAlign:h,isTickAlign:d,theme:s.theme,chartType:s.type}}function eb(i,t,e){const n=[];let o;t==="left"||t==="right"?n.push("left","right"):t!=="top"&&t!=="bottom"||n.push("top","bottom"),o=i&&Q(i.axes)?i.axes:e._table.pivotChartAxes;let r=!1,s=!1;if(Q(o)){const l=[];o.forEach(a=>{n.includes(a.orient)&&l.push(a)});for(let a=0;a<l.length;a++){const h=l[a];h.sync&&h.sync.axisId&&l.find(d=>d.id===h.sync.axisId)&&(r=r||h.sync.zeroAlign,s=s||h.sync.tickAlign)}}return{isZeroAlign:r,isTickAlign:s}}function Dw(i,t,e,n,o){var r;if(Q(o)){const h={min:1/0,max:-1/0};for(let d=0;d<o.length;d++){const u=Dw(i,t,e,n,o[d]);u&&(h.min=Math.min(h.min,u.min),h.max=Math.max(h.max,u.max))}return isFinite(h.min)&&isFinite(h.max)?h:null}let s=t==null?void 0:t[o];if(Q(s)&&(s=s[0]),!s)return null;const l=i[s],a=rt({},(r=l==null?void 0:l[n??""])!==null&&r!==void 0?r:{min:0,max:1});return a.positiveMax&&a.positiveMax>a.max&&(a.max=a.positiveMax),a.negativeMin&&a.negativeMin<a.min&&(a.min=a.negativeMin),a.min===a.max&&(a.min>0?a.min=0:a.max=0),a}function oz(i,t,e){if(!e._table.isPivotChart())return!1;if(e.indicatorsAsCol){if(e.hasTwoIndicatorAxes&&t===e.columnHeaderLevelCount-1&&i>=e.rowHeaderLevelCount&&i<e.colCount-e.rightFrozenColCount||t===e.rowCount-e.bottomFrozenRowCount&&i>=e.rowHeaderLevelCount&&i<e.colCount-e.rightFrozenColCount)return!0}else if(t===e.rowCount-e.bottomFrozenRowCount&&i>=e.rowHeaderLevelCount&&i<e.colCount-e.rightFrozenColCount)return!0;return!1}function rz(i,t,e){if(!e._table.isPivotChart())return!1;if(e.indicatorsAsCol){if(i===e.rowHeaderLevelCount-1&&t>=e.columnHeaderLevelCount&&t<e.rowCount-e.bottomFrozenRowCount)return!0}else if(i===e.rowHeaderLevelCount-1&&t>=e.columnHeaderLevelCount&&t<e.rowCount-e.bottomFrozenRowCount||i===e.colCount-e.rightFrozenColCount&&t>=e.columnHeaderLevelCount&&t<e.rowCount-e.bottomFrozenRowCount)return!0;return!1}var ib;function sz(i,t){let e=i==null?void 0:i.inverse;return t&&!lz(i==null?void 0:i.orient)&&(e=!O(i==null?void 0:i.inverse)||!(i!=null&&i.inverse)),e}function lz(i){return i==="bottom"||i==="top"}(function(i){i.vertical="vertical",i.horizontal="horizontal"})(ib||(ib={}));function LO(i,t,e,n){if(!Q(i.axes)||i.axes.length===0)return e&&n||!e&&!n;for(let o=0;o<i.axes.length;o++){const r=i.axes[o];if(!e&&n&&r.orient==="bottom"&&r.type==="linear"||e&&n&&r.orient==="bottom"&&r.type!=="linear"||!e&&!n&&r.orient==="left"&&r.type!=="linear"||e&&!n&&r.orient==="left"&&r.type==="linear")return!0}if(Q(t)&&t.length>0)for(let o=0;o<t.length;o++){const r=t[o];if(!e&&n&&r.orient==="bottom"&&r.type==="linear"||e&&n&&r.orient==="bottom"&&r.type!=="linear"||!e&&!n&&r.orient==="left"&&r.type!=="linear"||e&&!n&&r.orient==="left"&&r.type==="linear")return!0}return e&&n||!e&&!n}function Kl(i,t,e,n,o,r,s,l,a){const h=a.getIndicatorKeyInChartSpec(n,o);let d;d=i==="top"||i==="bottom"?a.getColKeysPath(r,s):a.getRowKeysPath(r,s);const u=rf(t,e,l,i,h,d,a);if(!u)return;const c=i==="bottom"?"top":i==="top"?"bottom":i==="left"?"right":"left",{targetRange:f,targetTicks:g}=Ww(t,e,u.index,u.isZeroAlign,u.isTickAlign,u.range,h,c,d,a);if(u.index!==0&&g){const p=ut.getFunction("getAxisDomainRangeAndLabels"),{range:v,ticks:m}=p(u.range.min,u.range.max,u.axisOption,u.isZeroAlign,i==="bottom"||i==="top"?a._table.getColWidth(r)||a._table.tableNoFrameWidth:a._table.getRowHeight(s)||a._table.tableNoFrameHeight,{targetTicks:g,targetRange:f});u.range.min=v[0],u.range.max=v[1],u.ticks=m}return u.targetRange=f,u.targetTicks=g,u}function rf(i,t,e,n,o,r,s){const{axisOption:l,isPercent:a,isZeroAlign:h,isTickAlign:d,seriesIndice:u,theme:c,chartType:f}=Er(i,t,n,s),g=Dw(s.dataset.collectedValues,o,h,r,u??e);if(!g)return;let p;if(a&&(g.min=g.min<0?-1:0,g.max=g.max>0?1:0),(l!=null&&l.zero||g.min===g.max)&&(g.min=Math.min(g.min,0),g.max=Math.max(g.max,0)),(l==null?void 0:l.nice)||d){const v=ut.getFunction("getAxisDomainRangeAndLabels"),{range:m,ticks:b}=v(g.min,g.max,l,h,n==="bottom"||n==="top"?s._table.getColWidth(i)||s._table.tableNoFrameWidth:s._table.getRowHeight(t)||s._table.tableNoFrameHeight);l!=null&&l.nice&&(g.min=m[0],g.max=m[1]),p=b}return Z(l==null?void 0:l.min)&&(g.min=l.min),Z(l==null?void 0:l.max)&&(g.max=l.max),{index:u??e,range:g,ticks:p,isZeroAlign:h,isTickAlign:d,axisOption:l,theme:c,chartType:f}}function nb(i,t,e,n,o,r,s,l){const{range:a,isZeroAlign:h,isTickAlign:d,axisOption:u}=rf(i,t,e,n,r,s,l),{targetRange:c,targetTicks:f}=Ww(i,t,e,h,d,a,r,o,s,l);if(e!==0&&f){const g=ut.getFunction("getAxisDomainRangeAndLabels"),{range:p,ticks:v}=g(a.min,a.max,rt({},u,{nice:!0,tick:{forceTickCount:f.length}}),h,n==="bottom"||n==="top"?l._table.getColWidth(i)||l._table.tableNoFrameWidth:l._table.getRowHeight(t)||l._table.tableNoFrameHeight,{targetTicks:f,targetRange:c});a.min=p[0],a.max=p[1]}return{axisOption:u,range:a,targetTicks:f,targetRange:c}}function Ww(i,t,e,n,o,r,s,l,a,h){let d,u;if(!n&&!o)return{targetTicks:d,targetRange:u};const c=rf(i,t,s.length-1-e,l,s,a,h);if(c){const{range:f,ticks:g}=c;if(u=f,n){const p=ez(r,f);p&&(r.min=p.range1[0],r.max=p.range1[1],u.min=p.range2[0],u.max=p.range2[1])}o&&(d=n?iz(u,i,t,e,l,h):g)}return{targetTicks:d,targetRange:u}}class az{constructor(t,e,n){this.table=t,this.customCellStyle=e,this.customCellStyleArrangement=n}getCustomCellStyle(t,e){const n=this.getCustomCellStyleIds(t,e);if(n.length){const o=[];return n.forEach(r=>{const s=this.getCustomCellStyleOption(r);s!=null&&s.style&&o.push(s.style)}),rt({},...o)}}getCustomCellStyleIds(t,e){const n=[],o=this.table.getCellRange(t,e);for(let r=o.start.col;r<=o.end.col;r++)for(let s=o.start.row;s<=o.end.row;s++)this.customCellStyleArrangement.forEach(l=>{l.cellPosition.range?l.cellPosition.range.start.col<=r&&l.cellPosition.range.end.col>=r&&l.cellPosition.range.start.row<=s&&l.cellPosition.range.end.row>=s&&n.push(l.customStyleId):l.cellPosition.col===r&&l.cellPosition.row===s&&n.push(l.customStyleId)});return n}getCustomCellStyleOption(t){return this.customCellStyle.find(e=>e.id===t)}registerCustomCellStyle(t,e){const n=this.customCellStyle.findIndex(o=>o.id===t);n===-1?this.customCellStyle.push({id:t,style:e}):this.customCellStyle[n]={id:t,style:e},this.customCellStyleArrangement.forEach(o=>{const r=o.cellPosition;if(o.customStyleId===t)if(r.range)for(let s=Math.max(0,r.range.start.col);s<=Math.min(this.table.colCount-1,r.range.end.col);s++)for(let l=Math.max(0,r.range.start.row);l<=Math.min(this.table.rowCount-1,r.range.end.row);l++)this.table.scenegraph.updateCellContent(s,l);else this.table.scenegraph.updateCellContent(r.col,r.row)}),this.table.scenegraph.updateNextFrame()}arrangeCustomCellStyle(t,e,n){var o;const r=this.customCellStyleArrangement.findIndex(l=>l.cellPosition.range&&t.range?l.cellPosition.range.start.col===t.range.start.col&&l.cellPosition.range.start.row===t.range.start.row&&l.cellPosition.range.end.col===t.range.end.col&&l.cellPosition.range.end.row===t.range.end.row:l.cellPosition.col===t.col&&l.cellPosition.row===t.row);if(r===-1&&!e)return;if(r===-1&&e)this.customCellStyleArrangement.push({cellPosition:{col:t.col,row:t.row,range:t.range},customStyleId:e});else{if(this.customCellStyleArrangement[r].customStyleId===e)return;e?this.customCellStyleArrangement[r].customStyleId=e:this.customCellStyleArrangement.splice(r,1)}const s=(o=this.getCustomCellStyleOption(e))===null||o===void 0?void 0:o.style;if(s){n=!0;for(const l in s)if($P.indexOf(l)===-1){n=!1;break}}if(t.range)for(let l=Math.max(0,t.range.start.col);l<=Math.min(this.table.colCount-1,t.range.end.col);l++)for(let a=Math.max(0,t.range.start.row);a<=Math.min(this.table.rowCount-1,t.range.end.row);a++){const h=this.table.getCellRange(l,a);for(let d=h.start.col;d<=h.end.col;d++)for(let u=h.start.row;u<=h.end.row;u++)this.table.scenegraph.updateCellContent(d,u,n)}else this.table.scenegraph.updateCellContent(t.col,t.row,n);this.table.scenegraph.updateNextFrame()}updateCustomCell(t,e){this.customCellStyle.length=0,this.customCellStyleArrangement.length=0,t.forEach(n=>{this.registerCustomCellStyle(n.id,n.style)}),e.forEach(n=>{this.arrangeCustomCellStyle(n.cellPosition,n.customStyleId)})}hasCustomCellStyle(t){return this.customCellStyle.some(e=>e.id===t)}}function ns(i,t){i=i.clone();for(const e in t){const n=t[e];O(n)&&(i[`_${e}`]=n)}return i}const hz=()=>{ut.registerComponent("customCellStylePlugin",az)},dz={};function uz(i,t,e){var n,o,r,s,l,a,h,d,u,c;const f=(n=e.customCellStylePlugin)===null||n===void 0?void 0:n.getCustomCellStyle(i,t),{layoutMap:g}=e.internalProps;if(g.isHeader(i,t)){let x;if(!e.isPivotTable()||e.isBottomFrozenRow(t)||e.isRightFrozenColumn(i))x=`${i}-${t}`;else{const M=e.getHeaderDefine(i,t),k=e.isCornerHeader(i,t);x=M!=null&&M.dimensionKey?k?`dim-cor-${M.dimensionKey}`:`dim-${M.dimensionKey}`:M!=null&&M.indicatorKey?`ind-${M.indicatorKey}`:`${i}-${t}`}let S=e.headerStyleCache.get(x);if(S)return f?ns(S,f):S;const R=g.getHeader(i,t);let B;if(e.isPivotChart()&&oz(i,t,g)&&g.isAxisCell(i,t)?B=(r=(o=g.getBody(i,e.rowHeaderLevelCount).style)===null||o===void 0?void 0:o.padding)!==null&&r!==void 0?r:e.theme.bodyStyle.padding:e.isPivotChart()&&rz(i,t,g)&&g.isAxisCell(i,t)&&(B=(l=(s=g.getBody(e.columnHeaderLevelCount,t).style)===null||s===void 0?void 0:s.padding)!==null&&l!==void 0?l:e.theme.bodyStyle.padding),(!R||R.isEmpty)&&(g.isLeftBottomCorner(i,t)||g.isRightBottomCorner(i,t)||g.isCornerHeader(i,t)||g.isRightTopCorner(i,t)))return dz;const A=e.internalProps.headerHelper.getStyleClass((R==null?void 0:R.headerType)||"text");if(g.isBottomFrozenRow(i,t)&&e.theme.bottomFrozenStyle)S=oa(B?{padding:B}:{},e.theme.bottomFrozenStyle,{col:i,row:t,table:e,value:e.getCellValue(i,t),dataValue:e.getCellOriginValue(i,t),cellHeaderPaths:e.getCellHeaderPaths(i,t)},A,e.options.autoWrapText,e.theme);else if(g.isRightFrozenColumn(i,t)&&e.theme.rightFrozenStyle)S=oa(B?{padding:B}:{},e.theme.rightFrozenStyle,{col:i,row:t,table:e,value:e.getCellValue(i,t),dataValue:e.getCellOriginValue(i,t),cellHeaderPaths:e.getCellHeaderPaths(i,t)},A,e.options.autoWrapText,e.theme);else{const M=(R==null?void 0:R.style)||{};B&&(M.padding=B),S=oa(M,g.isColumnHeader(i,t)||g.isBottomFrozenRow(i,t)?e.theme.headerStyle:g.isRowHeader(i,t)||g.isRightFrozenColumn(i,t)?e.theme.rowHeaderStyle:e.theme.cornerHeaderStyle,{col:i,row:t,table:e,value:e.getCellValue(i,t),dataValue:e.getCellOriginValue(i,t),cellHeaderPaths:e.getCellHeaderPaths(i,t)},A,e.options.autoWrapText,e.theme)}return e.headerStyleCache.set(x,S),f?ns(S,f):S}let p,v;!((h=(a=e.internalProps)===null||a===void 0?void 0:a.dataConfig)===null||h===void 0)&&h.mappingRules&&!e.isHeader(i,t)&&((c=(u=(d=e.internalProps)===null||d===void 0?void 0:d.dataConfig)===null||u===void 0?void 0:u.mappingRules)===null||c===void 0||c.forEach((x,S)=>{x.bgColor&&e.internalProps.layoutMap.getIndicatorKey(i,t)===x.bgColor.indicatorKey&&(p=x.bgColor.mapping)}));const m=e.getCellType(i,t),b=e.getCellOriginRecord(i,t);let C;if(v=b!=null&&b.vtableMerge?"merge-title":e.isSeriesNumberInBody(i,t)?`${i}-series-`+m:e.isListTable()&&!e.transpose||e.isPivotTable()&&e.internalProps.layoutMap.indicatorsAsCol?i+m:t+m,C=b!=null&&b.vtableMerge?e.bodyMergeTitleCache.get(v):g.isBottomFrozenRow(t)?e.bodyBottomStyleCache.get(v):e.bodyStyleCache.get(v),C)return f?ns(C,f):C;const _=g.getBody(i,t),w=e.internalProps.bodyHelper.getStyleClass(e.getCellType(i,t)),y=_==null?void 0:_.style;return C=Yg(y,b!=null&&b.vtableMerge&&e.theme.groupTitleStyle?e.theme.groupTitleStyle:g.isBottomFrozenRow(t)&&e.theme.bottomFrozenStyle?e.theme.bottomFrozenStyle:g.isRightFrozenColumn(i)&&e.theme.rightFrozenStyle?e.theme.rightFrozenStyle:e.theme.bodyStyle,{col:i,row:t,table:e,value:e.getCellValue(i,t),dataValue:e.getCellOriginValue(i,t),cellHeaderPaths:e.getCellHeaderPaths(i,t)},w,e.options.autoWrapText,e.theme),p&&(C=ns(C,{bgColor:p})),Mt(y)||(g.isBottomFrozenRow(t)?e.bodyBottomStyleCache.set(v,C):e.bodyStyleCache.set(v,C)),f?ns(C,f):C}function ob(i){return Math.floor(i)===i}class cz extends pC{onUpdate(t,e,n){if(this.from.x!==this.to.x){const o=t?this.to.x:this.from.x+Math.floor((this.to.x-this.from.x)*e);this.params.table.scrollLeft=o}if(this.from.y!==this.to.y){const o=t?this.to.y:this.from.y+Math.floor((this.to.y-this.from.y)*e);this.params.table.scrollTop=o}}}class gz{constructor(t){this.table=t,this.timeline=new Ag,this.ticker=new gC,this.ticker.addTimeline(this.timeline),this.ticker.setFPS(60),this.tempGraphic=qt({})}scrollTo(t,e){var n,o;const r={x:this.table.scrollLeft,y:this.table.scrollTop},{col:s,row:l}=t;let a,h,d=s,u=l;Z(s)&&!ob(s)&&(d=Math.floor(s),a=s-d),Z(l)&&!ob(l)&&(u=Math.floor(l),h=l-u);const c=this.table.getCellRect(d??0,u??0);let{left:f,top:g}=c;a&&(f+=a*c.width),h&&(g+=h*c.height);const p={x:Z(s)?f-this.table.getFrozenColsWidth():this.table.scrollLeft,y:Z(l)?g-this.table.getFrozenRowsHeight():this.table.scrollTop},v=He(e)?e?3e3:0:(n=e==null?void 0:e.duration)!==null&&n!==void 0?n:3e3,m=He(e)?e?"linear":"":(o=e==null?void 0:e.easing)!==null&&o!==void 0?o:"linear";new _n(fe.GenAutoIncrementId(),this.timeline).bind(this.tempGraphic).play(new cz(r,p,v,m,{graphic:this.tempGraphic,table:this.table})),this.ticker.start()}clear(){this.timeline.clear(),this.ticker.stop()}}function rb(i){return Mt(i)?i:Q(i)?(t,e)=>i.find(n=>n.range.start.col<=t&&n.range.end.col>=t&&n.range.start.row<=e&&n.range.end.row>=e):void 0}const{toBoxArray:zn}=P2,{isTouchEvent:fz}=T2,pz=/^\$(\d+)\$(\d+)$/;l2();class vz extends md{static get EVENT_TYPE(){return U}constructor(t,e={}){var n,o,r,s,l,a,h,d,u,c,f,g,p,v;if(super(),this.showFrozenIcon=!0,this.version="1.17.0",this.id=`VTable${Date.now()}`,this.isReleased=!1,this._chartEventMap={},this.throttleInvalidate=v2(this.render.bind(this),200),!t&&e.mode!=="node"&&!e.canvas)throw new Error("vtable's container is undefined");((n=e.customConfig)===null||n===void 0?void 0:n.imageAnonymous)===!1&&(Qt.isImageAnonymous=!1);const{frozenColCount:m=0,unfreezeAllOnExceedsMaxWidth:b,frozenRowCount:C,defaultRowHeight:_=40,defaultHeaderRowHeight:w,defaultColWidth:y=80,defaultHeaderColWidth:x,widthMode:S="standard",heightMode:R="standard",autoFillWidth:B=!1,autoFillHeight:A=!1,widthAdaptiveMode:M="only-body",heightAdaptiveMode:k="only-body",keyboardOptions:E,eventOptions:T,rowSeriesNumber:P,columnResizeMode:H,rowResizeMode:L="none",resize:F,dragHeaderMode:z,showFrozenIcon:I,allowFrozenColCount:N,padding:W,hover:D,menu:j,select:V,customRender:X,pixelRatio:K=po,renderChartAsync:J,renderChartAsyncBatchCount:ot,mode:lt,modeParams:ct,canvasWidth:it,canvasHeight:nt,overscrollBehavior:ht,limitMinWidth:$,limitMinHeight:Y,clearDOM:_t=!0}=e;this.container=t,this.options=e,this._widthMode=S,this._heightMode=R,this._widthAdaptiveMode=M,this._heightAdaptiveMode=k,this._autoFillWidth=B,this._autoFillHeight=A,this.customRender=X,this.padding={top:0,right:0,left:0,bottom:0},W&&(typeof W=="number"?(this.padding.top=W,this.padding.left=W,this.padding.bottom=W,this.padding.right=W):(W.top&&(this.padding.top=W.top),W.bottom&&(this.padding.bottom=W.bottom),W.left&&(this.padding.left=W.left),W.right&&(this.padding.right=W.right))),O(nt)&&O(it)&&(this.canvasSizeSeted=!0),this.tableNoFrameWidth=0,this.tableNoFrameHeight=0,this.canvasWidth=Z(it)?it:void 0,this.canvasHeight=Z(nt)?nt:void 0,this.columnWidthComputeMode=(o=e.columnWidthComputeMode)!==null&&o!==void 0?o:"normal";const et=this.internalProps={};I!==void 0&&(this.showFrozenIcon=I),typeof N=="number"&&N<=0&&(this.showFrozenIcon=!1),this.options.canvas?(Bt.mode!=="node"&&(et.element=this.options.canvas.parentElement,et.element.style.position="relative"),et.focusControl=new $m(this,et.element),et.canvas=this.options.canvas,et.context=et.canvas.getContext("2d")):Bt.mode!=="node"&&(et.element=FH(this.padding),et.focusControl=new $m(this,et.element),et.canvas=document.createElement("canvas"),et.element.appendChild(et.canvas),et.context=et.canvas.getContext("2d"),!((r=e.customConfig)===null||r===void 0)&&r.createReactContainer&&PE(this)),et.handler=new _d,Z(this.options.resizeTime)&&(et.handler.resizeTime=this.options.resizeTime),et.pixelRatio=K,et.frozenColCount=m,et.frozenRowCount=C,et.unfreezeAllOnExceedsMaxWidth=b==null||b,et.defaultRowHeight=_,et.defaultHeaderRowHeight=w??_,et.defaultColWidth=y,et.defaultHeaderColWidth=x??y,et.keyboardOptions=E,et.eventOptions=T,et.rowSeriesNumber=P,et.columnResizeMode=(s=F==null?void 0:F.columnResizeMode)!==null&&s!==void 0?s:H,et.rowResizeMode=(l=F==null?void 0:F.rowResizeMode)!==null&&l!==void 0?l:L,et.dragHeaderMode=z??"none",et.renderChartAsync=J,em(ot),et.overscrollBehavior=ht??"auto",et._rowHeightsMap=new Km(this),et._rowRangeHeightsMap=new Map,et._colRangeWidthsMap=new Map,et._widthResizedColMap=new Set,et._heightResizedRowMap=new Set,this.colWidthsMap=new Kn,this.colContentWidthsMap=new Kn,this.colWidthsLimit={};const tt=this;if(et.calcWidthContext={_:et,get full(){var dt;return Bt.mode==="node"?tt.canvasWidth/(K??1):this._.canvas.width/((dt=this._.context.pixelRatio)!==null&&dt!==void 0?dt:window.devicePixelRatio)}},et.cellTextOverflows={},et.focusedTable=!1,et.theme=Fn.of((a=e.theme)!==null&&a!==void 0?a:Fn.DEFAULT),et.theme.isPivot=this.isPivotTable(),Gl(et.theme.functionalIconsStyle),t?(_t&&(t.innerHTML=""),t.appendChild(et.element),this._updateSize()):this._updateSize(),et.bodyHelper=new HF(this),et.headerHelper=new VF(this),et.rowSeriesNumberHelper=new GF(this),et.autoWrapText=e.autoWrapText,et.enableLineBreak=e.enableLineBreak,et.allowFrozenColCount=(h=e.allowFrozenColCount)!==null&&h!==void 0?h:0,et.limitMaxAutoWidth=(d=e.limitMaxAutoWidth)!==null&&d!==void 0?d:450,et.limitMinWidth=$!=null?typeof $=="number"?$:$?10:0:10,et.limitMinHeight=Y!=null?typeof Y=="number"?Y:Y?10:0:10,this.scenegraph=new gL(this),this.stateManager=new nF(this),this.eventManager=new BF(this),this.animationManager=new gz(this),e.legends){et.legends=[];const dt=ut.getFunction("createLegend");if(Array.isArray(e.legends)){for(let ne=0;ne<e.legends.length;ne++)et.legends.push(dt(e.legends[ne],this));this.scenegraph.tableGroup.setAttributes({x:this.tableX,y:this.tableY})}else et.legends.push(dt(e.legends,this)),this.scenegraph.tableGroup.setAttributes({x:this.tableX,y:this.tableY})}if(et.tooltip=Object.assign({parentElement:this.getElement(),renderMode:"html",isShowOverflowTextTooltip:!1,confine:!0,position:ri.bottom},e.tooltip),et.tooltip.renderMode==="html"){const dt=ut.getComponent("tooltipHandler");dt&&(et.tooltipHandler=new dt(this,et.tooltip.confine))}if(et.menu=Object.assign({renderMode:"html"},e.menu),Array.isArray((u=e.menu)===null||u===void 0?void 0:u.dropDownMenuHighlight)&&this.setDropDownMenuHighlight((c=e.menu)===null||c===void 0?void 0:c.dropDownMenuHighlight),(Array.isArray((f=e.menu)===null||f===void 0?void 0:f.defaultHeaderMenuItems)||typeof((g=e.menu)===null||g===void 0?void 0:g.defaultHeaderMenuItems)=="function")&&(this.globalDropDownMenu=e.menu.defaultHeaderMenuItems),et.menu.renderMode==="html"){const dt=ut.getComponent("menuHandler");et.menuHandler=new dt(this)}this.headerStyleCache=new Map,this.bodyStyleCache=new Map,this.bodyMergeTitleCache=new Map,this.bodyBottomStyleCache=new Map,et.stick={changedCells:new Map},et.customMergeCell=rb(e.customMergeCell);const at=ut.getComponent("customCellStylePlugin");at&&(this.customCellStylePlugin=new at(this,(p=e.customCellStyle)!==null&&p!==void 0?p:[],(v=e.customCellStyleArrangement)!==null&&v!==void 0?v:[])),this._adjustCanvasSizeByOption()}_adjustCanvasSizeByOption(){this.options.canvasHeight!=="auto"&&this.options.canvasWidth!=="auto"||setTimeout(()=>{var t,e,n,o,r,s,l,a,h,d,u,c,f,g,p,v,m,b,C,_,w,y,x,S;let R,B;if(this.options.canvasHeight==="auto"){let A=0;if(!((t=this.theme.frameStyle)===null||t===void 0)&&t.innerBorder)A+=(o=zn((n=(e=this.internalProps.theme.frameStyle)===null||e===void 0?void 0:e.shadowBlur)!==null&&n!==void 0?n:[0])[1])!==null&&o!==void 0?o:0;else if(this.theme.frameStyle){const M=zn((s=(r=this.internalProps.theme.frameStyle)===null||r===void 0?void 0:r.borderLineWidth)!==null&&s!==void 0?s:[null]),k=zn((a=(l=this.internalProps.theme.frameStyle)===null||l===void 0?void 0:l.shadowBlur)!==null&&a!==void 0?a:[0]);A+=((h=M[0])!==null&&h!==void 0?h:0)+((d=k[0])!==null&&d!==void 0?d:0)+(((u=M[2])!==null&&u!==void 0?u:0)+((c=k[2])!==null&&c!==void 0?c:0))}B=Math.min(this.options.maxCanvasHeight?this.options.maxCanvasHeight-A:2e4,this.getAllRowsHeight())+A}else B=this.canvasHeight;if(this.options.canvasWidth==="auto"){let A=0;if(!((f=this.theme.frameStyle)===null||f===void 0)&&f.innerBorder)A+=(v=zn((p=(g=this.internalProps.theme.frameStyle)===null||g===void 0?void 0:g.shadowBlur)!==null&&p!==void 0?p:[0])[2])!==null&&v!==void 0?v:0;else if(this.theme.frameStyle){const M=zn((b=(m=this.internalProps.theme.frameStyle)===null||m===void 0?void 0:m.borderLineWidth)!==null&&b!==void 0?b:[null]),k=zn((_=(C=this.internalProps.theme.frameStyle)===null||C===void 0?void 0:C.shadowBlur)!==null&&_!==void 0?_:[0]);A+=((w=M[1])!==null&&w!==void 0?w:0)+((y=k[1])!==null&&y!==void 0?y:0)+(((x=M[3])!==null&&x!==void 0?x:0)+((S=k[3])!==null&&S!==void 0?S:0))}R=Math.min(this.options.maxCanvasWidth?this.options.maxCanvasWidth-A:2e4,this.getAllColsWidth())+A}else R=this.canvasWidth;this.setCanvasSize(R,B)},0)}getContainer(){return this.container}getElement(){return this.internalProps.element}get canvas(){return this.internalProps.canvas}setCanvasSize(t,e){this.canvasWidth=t,this.canvasHeight=e,this.options.canvasHeight=e,this.options.canvasWidth=t,this.resize()}resize(){var t;this._updateSize(),(t=this.internalProps.legends)===null||t===void 0||t.forEach(e=>{e==null||e.resize()}),this.internalProps.title&&this.internalProps.title.resize(),this.internalProps.emptyTip&&this.internalProps.emptyTip.resize(),this.scenegraph.resize()}get rowCount(){return this.internalProps.rowCount}set rowCount(t){this.internalProps.rowCount=t}get colCount(){var t;return(t=this.internalProps.colCount)!==null&&t!==void 0?t:0}set colCount(t){this.internalProps.colCount=t}get frozenColCount(){var t,e,n,o,r;return(r=(n=(e=(t=this.internalProps)===null||t===void 0?void 0:t.layoutMap)===null||e===void 0?void 0:e.frozenColCount)!==null&&n!==void 0?n:(o=this.internalProps)===null||o===void 0?void 0:o.frozenColCount)!==null&&r!==void 0?r:0}set frozenColCount(t){t>=this.colCount&&(t=0),this.internalProps.frozenColCount=t,this.options.frozenColCount=t;const e=this._getMaxFrozenWidth();if(this.getColsWidth(0,t-1)>e)if(this.internalProps.unfreezeAllOnExceedsMaxWidth)this.internalProps.frozenColCount=0;else{const n=this._getComputedFrozenColCount(t);this.internalProps.frozenColCount=n}this.stateManager.setFrozenCol(this.internalProps.frozenColCount)}setFrozenColCount(t){t>=this.colCount&&(t=0),this.internalProps.frozenColCount=t,this.options.frozenColCount=t;const e=this._getMaxFrozenWidth();if(this.getColsWidth(0,t-1)>e)if(this.internalProps.unfreezeAllOnExceedsMaxWidth)this.internalProps.frozenColCount=0;else{const n=this._getComputedFrozenColCount(t);this.internalProps.frozenColCount=n}this.stateManager.setFrozenCol(this.internalProps.frozenColCount)}_setFrozenColCount(t){t>=this.colCount&&(t=0),this.internalProps.frozenColCount=t}_resetFrozenColCount(){this.options.frozenColCount&&(this.tableNoFrameWidth-this.getColsWidth(0,this.options.frozenColCount-1)<=120?this._setFrozenColCount(0):this.frozenColCount!==this.options.frozenColCount&&this._setFrozenColCount(this.options.frozenColCount))}get frozenRowCount(){var t,e,n,o,r;return(r=(n=(e=(t=this.internalProps)===null||t===void 0?void 0:t.layoutMap)===null||e===void 0?void 0:e.frozenRowCount)!==null&&n!==void 0?n:(o=this.internalProps)===null||o===void 0?void 0:o.frozenRowCount)!==null&&r!==void 0?r:0}set frozenRowCount(t){this.internalProps.frozenRowCount=t,this.stateManager.setFrozenRow(this.internalProps.frozenRowCount)}get rightFrozenColCount(){var t,e,n,o,r;return(r=(n=(e=(t=this.internalProps)===null||t===void 0?void 0:t.layoutMap)===null||e===void 0?void 0:e.rightFrozenColCount)!==null&&n!==void 0?n:(o=this.internalProps)===null||o===void 0?void 0:o.rightFrozenColCount)!==null&&r!==void 0?r:0}set rightFrozenColCount(t){this.scenegraph.dealWidthRightFrozen(t)}get bottomFrozenRowCount(){var t,e,n,o,r;return(r=(n=(e=(t=this.internalProps)===null||t===void 0?void 0:t.layoutMap)===null||e===void 0?void 0:e.bottomFrozenRowCount)!==null&&n!==void 0?n:(o=this.internalProps)===null||o===void 0?void 0:o.bottomFrozenRowCount)!==null&&r!==void 0?r:0}set bottomFrozenRowCount(t){this.scenegraph.dealWidthBottomFrozen(t)}get defaultRowHeight(){return Z(this.internalProps.defaultRowHeight)?this.internalProps.defaultRowHeight:40}set defaultRowHeight(t){this.internalProps.defaultRowHeight=t,this.options.defaultRowHeight=t}get defaultHeaderRowHeight(){return this.internalProps.defaultHeaderRowHeight}set defaultHeaderRowHeight(t){this.internalProps.defaultHeaderRowHeight=t,this.options.defaultHeaderRowHeight=t}get defaultColWidth(){return this.internalProps.defaultColWidth}set defaultColWidth(t){this.internalProps.defaultColWidth=t,this.options.defaultColWidth=t}get defaultHeaderColWidth(){return this.internalProps.defaultHeaderColWidth}set defaultHeaderColWidth(t){this.internalProps.defaultHeaderColWidth=t,this.options.defaultHeaderColWidth=t}get colWidthsMap(){return this.internalProps._colWidthsMap}set colWidthsMap(t){this.internalProps._colWidthsMap=t}get colContentWidthsMap(){return this.internalProps._colContentWidthsMap}set colContentWidthsMap(t){this.internalProps._colContentWidthsMap=t}get _colRangeWidthsMap(){return this.internalProps._colRangeWidthsMap}set _colRangeWidthsMap(t){this.internalProps._colRangeWidthsMap=t}get _rowRangeHeightsMap(){return this.internalProps._rowRangeHeightsMap}set _rowRangeHeightsMap(t){this.internalProps._rowRangeHeightsMap=t}get rowHeightsMap(){return this.internalProps._rowHeightsMap}set rowHeightsMap(t){this.internalProps._rowHeightsMap=t}get colWidthsLimit(){return this.internalProps._colWidthsLimit}set colWidthsLimit(t){this.internalProps._colWidthsLimit=t}get keyboardOptions(){var t;return(t=this.internalProps.keyboardOptions)!==null&&t!==void 0?t:null}set keyboardOptions(t){this.internalProps.keyboardOptions=t??void 0}get eventOptions(){var t;return(t=this.internalProps.eventOptions)!==null&&t!==void 0?t:null}set eventOptions(t){this.internalProps.eventOptions=t??void 0}get widthMode(){return this._widthMode}set widthMode(t){t!==this._widthMode&&(this._widthMode=t,this.options.widthMode=t)}get heightMode(){return this._heightMode}set heightMode(t){t!==this._heightMode&&(this._heightMode=t,this.options.heightMode=t)}get autoFillWidth(){return this._autoFillWidth}set autoFillWidth(t){t!==this._autoFillWidth&&(this._autoFillWidth=t)}get autoFillHeight(){return this._autoFillHeight}set autoFillHeight(t){t!==this._autoFillHeight&&(this._autoFillHeight=t)}get widthAdaptiveMode(){return this._widthAdaptiveMode}set widthAdaptiveMode(t){t!==this._widthAdaptiveMode&&(this._widthAdaptiveMode=t)}get heightAdaptiveMode(){return this._heightAdaptiveMode}set heightAdaptiveMode(t){t!==this._heightAdaptiveMode&&(this._heightAdaptiveMode=t)}_colWidthDefineToPxWidth(t){return t==="auto"?0:Ko(this,t)}_getMaxFrozenWidth(){var t;const e=(t=this.options.maxFrozenWidth)!==null&&t!==void 0?t:"80%";return Ko(this,e)}_getComputedFrozenColCount(t){const e=this._getMaxFrozenWidth();let n=t;for(;this.getColsWidth(0,n-1)>e&&(n--,!(n<=0)););return n}_getColWidthLimits(t){const e=this.colWidthsLimit[t];if(!e)return null;const n={};return e.min&&(n.min=Ko(this,e.min),n.minDef=e.min),e.max&&(n.max=Ko(this,e.max),n.maxDef=e.max),n}_adjustColWidth(t,e){const n=this._getColWidthLimits(t);return Math.max(WH(n,e),0)}get pixelRatio(){return this.internalProps.pixelRatio}setPixelRatio(t){var e;if(t!==((e=this.internalProps)===null||e===void 0?void 0:e.pixelRatio)){this.internalProps.pixelRatio=t;const n=this.canvasWidth;this.internalProps.calcWidthContext={_:this.internalProps,get full(){var o;return Bt.mode==="node"?n/(t??1):this._.canvas.width/((o=this._.context.pixelRatio)!==null&&o!==void 0?o:window.devicePixelRatio)}},this.scenegraph.setPixelRatio(t)}}_updateSize(){var t,e,n,o,r,s,l,a,h,d,u,c,f,g,p,v,m,b,C,_,w,y,x,S,R,B;const{padding:A}=this;let M=0,k=0;if(this.tableX=0,this.tableY=0,this.options.canvas&&this.options.viewBox)M=this.options.viewBox.x2-this.options.viewBox.x1,k=this.options.viewBox.y2-this.options.viewBox.y1,!((t=this==null?void 0:this.scenegraph)===null||t===void 0)&&t.stage&&(this.options.viewBox?this.scenegraph.stage.setViewBox(this.options.viewBox,!1):this.scenegraph.stage.resize(M,k));else if(Bt.mode==="browser"){const P=this.getElement();let H=0,L=0;if(this.canvasSizeSeted)H=this.canvasWidth,L=this.canvasHeight;else if(P.parentElement){const z=P.parentElement.style||window.getComputedStyle(P.parentElement);H=P.parentElement.offsetWidth-parseInt(z.paddingLeft||"0px",10)-parseInt(z.paddingRight||"0px",10),L=P.parentElement.offsetHeight-parseInt(z.paddingTop||"0px",10)-parseInt(z.paddingBottom||"0px",20),H=(H??1)-(this.options.tableSizeAntiJitter?1:0),L=(L??1)-(this.options.tableSizeAntiJitter?1:0)}P.style.width=H&&H-A.left-A.right+"px"||"0px",P.style.height=L&&L-A.top-A.bottom+"px"||"0px";const{canvas:F}=this.internalProps;M=((n=(e=F.parentElement)===null||e===void 0?void 0:e.offsetWidth)!==null&&n!==void 0?n:1)-(this.options.tableSizeAntiJitter?1:0),k=((r=(o=F.parentElement)===null||o===void 0?void 0:o.offsetHeight)!==null&&r!==void 0?r:1)-(this.options.tableSizeAntiJitter?1:0),!((s=this==null?void 0:this.scenegraph)===null||s===void 0)&&s.stage?this.scenegraph.stage.resize(M,k):(F.style.width="",F.style.height="",F.width=M,F.height=k,F.style.width=`${M}px`,F.style.height=`${k}px`)}else Bt.mode==="node"&&(M=this.canvasWidth-1,k=this.canvasHeight-1);const E=Math.floor(M-h2(this.getTheme().scrollStyle)),T=Math.floor(k-a2(this.getTheme().scrollStyle));if(!((l=this.internalProps.theme)===null||l===void 0)&&l.frameStyle){const P=zn((h=(a=this.internalProps.theme.frameStyle)===null||a===void 0?void 0:a.borderLineWidth)!==null&&h!==void 0?h:[null]),H=zn((u=(d=this.internalProps.theme.frameStyle)===null||d===void 0?void 0:d.shadowBlur)!==null&&u!==void 0?u:[0]);!((c=this.theme.frameStyle)===null||c===void 0)&&c.innerBorder?(this.tableX=0,this.tableY=0,this.tableNoFrameWidth=E-((f=H[1])!==null&&f!==void 0?f:0),this.tableNoFrameHeight=T-((g=H[2])!==null&&g!==void 0?g:0)):(this.tableX=((p=P[3])!==null&&p!==void 0?p:0)+((v=H[3])!==null&&v!==void 0?v:0),this.tableY=((m=P[0])!==null&&m!==void 0?m:0)+((b=H[0])!==null&&b!==void 0?b:0),this.tableNoFrameWidth=E-(((C=P[1])!==null&&C!==void 0?C:0)+((_=H[1])!==null&&_!==void 0?_:0))-(((w=P[3])!==null&&w!==void 0?w:0)+((y=H[3])!==null&&y!==void 0?y:0)),this.tableNoFrameHeight=T-(((x=P[0])!==null&&x!==void 0?x:0)+((S=H[0])!==null&&S!==void 0?S:0))-(((R=P[2])!==null&&R!==void 0?R:0)+((B=H[2])!==null&&B!==void 0?B:0)))}}updateViewBox(t){var e,n,o,r,s,l,a,h;const d=(r=(n=(e=this.options)===null||e===void 0?void 0:e.viewBox.x2)!==null&&n!==void 0?n:0-((o=this.options)===null||o===void 0?void 0:o.viewBox.x1))!==null&&r!==void 0?r:0,u=(h=(l=(s=this.options)===null||s===void 0?void 0:s.viewBox.y2)!==null&&l!==void 0?l:0-((a=this.options)===null||a===void 0?void 0:a.viewBox.y1))!==null&&h!==void 0?h:0,c=t.x2-t.x1,f=t.y2-t.y1;this.options.viewBox=t,d!==c||u!==f?this.resize():this.scenegraph.stage.setViewBox(this.options.viewBox,!0)}setViewBoxTransform(t,e,n,o,r,s){this.internalProps.modifiedViewBoxTransform=!0,this.scenegraph.stage.window.setViewBoxTransform(t,e,n,o,r,s)}get rowHierarchyType(){return"grid"}getColsWidth(t,e){var n;if(t>e)return 0;t=Math.max(t,0),e=Math.min(e,((n=this.colCount)!==null&&n!==void 0?n:1/0)-1);const o=this._colRangeWidthsMap.get(`$${t}$${e}`);if(o!=null)return o;const r=this._colRangeWidthsMap.get(`$${t}$${e-1}`);if(r!=null){const l=r+this.getColWidth(e);return t>=0&&e>=0&&!Number.isNaN(l)&&this._colRangeWidthsMap.set(`$${t}$${e}`,Math.round(l)),Math.round(l)}let s=0;for(let l=t;l<=e;l++)s+=this.getColWidth(l);return t>=0&&e>=0&&this._colRangeWidthsMap.set(`$${t}$${e}`,Math.round(s)),Math.round(s)}getRowHeight(t){var e;if(O(this.rowHeightsMap.get(t))){if(!((e=this.options.customConfig)===null||e===void 0)&&e._disableColumnAndRowSizeRound){const o=this.rowHeightsMap.get(t);let r;return r=t<this.frozenRowCount?this.rowHeightsMap.getSumInRange(0,t):t>=this.rowCount-this.bottomFrozenRowCount?this.rowHeightsMap.getSumInRange(t,this.rowCount-1):this.rowHeightsMap.getSumInRange(this.frozenRowCount,t),r=Number(r.toFixed(2)),Number.isInteger(r)?Math.ceil(o):Math.floor(o)}return this.rowHeightsMap.get(t)}const n=this.getDefaultRowHeight(t);return Z(n)?n:this.defaultRowHeight}getDefaultColumnWidth(t){var e,n;return this.isRowHeader(t,0)||this.isCornerHeader(t,0)?Array.isArray(this.defaultHeaderColWidth)?(e=this.defaultHeaderColWidth[t])!==null&&e!==void 0?e:this.defaultColWidth:this.defaultHeaderColWidth:this.isRightFrozenColumn(t,this.columnHeaderLevelCount)&&this.isPivotTable()?Array.isArray(this.defaultHeaderColWidth)?(n=this.defaultHeaderColWidth[this.rowHeaderLevelCount-this.rightFrozenColCount])!==null&&n!==void 0?n:this.defaultColWidth:this.defaultHeaderColWidth:this.defaultColWidth}getDefaultRowHeight(t){var e,n;return this.isColumnHeader(0,t)||this.isCornerHeader(0,t)||this.isSeriesNumberInHeader(0,t)?Array.isArray(this.defaultHeaderRowHeight)?(e=this.defaultHeaderRowHeight[t])!==null&&e!==void 0?e:this.internalProps.defaultRowHeight:this.defaultHeaderRowHeight:this.isBottomFrozenRow(t)?Array.isArray(this.defaultHeaderRowHeight)?(n=this.defaultHeaderRowHeight[this.columnHeaderLevelCount>0?this.columnHeaderLevelCount-this.bottomFrozenRowCount:0])!==null&&n!==void 0?n:this.internalProps.defaultRowHeight:this.defaultHeaderRowHeight:this.internalProps.defaultRowHeight}_setRowHeight(t,e,n){var o;this.rowHeightsMap.put(t,!((o=this.options.customConfig)===null||o===void 0)&&o._disableColumnAndRowSizeRound?e:Math.round(e)),n&&this._clearRowRangeHeightsMap(t)}setRowHeight(t,e){this.scenegraph.setRowHeight(t,e),this.scenegraph.updateChartSizeForResizeRowHeight(t),this.internalProps._heightResizedRowMap.add(t)}getRowsHeight(t,e){var n,o;if(t>e||this.rowCount===0)return 0;t=Math.max(t,0),e=Math.min(e,((n=this.rowCount)!==null&&n!==void 0?n:1/0)-1);let r=0;const s=this.options.defaultRowHeight==="auto";if(this.heightMode!=="standard"||this.options.customComputeRowHeight||this.autoFillHeight||!this.internalProps.layoutMap||this.hasAutoImageColumn()||s||this.internalProps._heightResizedRowMap.size!==0){if(!((o=this.options.customConfig)===null||o===void 0)&&o._disableColumnAndRowSizeRound){const l=this.rowHeightsMap.getSumInRange(t,e);let a;return a=e<this.frozenRowCount?this.rowHeightsMap.getSumInRange(0,e):e>=this.rowCount-this.bottomFrozenRowCount?this.rowHeightsMap.getSumInRange(e,this.rowCount-1):this.rowHeightsMap.getSumInRange(this.frozenRowCount,e),a=Number(a.toFixed(2)),Number.isInteger(a)?Math.ceil(l):Math.floor(l)}r=this.rowHeightsMap.getSumInRange(t,e)}else{for(let l=t;l<Math.min(e+1,this.columnHeaderLevelCount);l++)r+=this.getRowHeight(l);e>=this.columnHeaderLevelCount&&(r+=this.defaultRowHeight*(Math.min(e,this.rowCount-this.bottomFrozenRowCount-1)-Math.max(this.columnHeaderLevelCount,t)+1));for(let l=this.rowCount-this.bottomFrozenRowCount;l<e+1;l++)r+=this.getRowHeight(l)}return Math.round(r)}getColWidthDefined(t){var e;const{layoutMap:n}=this.internalProps;if(this.widthMode==="autoWidth")return"auto";const{width:o}=(e=n==null?void 0:n.getColumnWidthDefined(t))!==null&&e!==void 0?e:{};return typeof o=="number"&&o<=0?0:o||this.getDefaultColumnWidth(t)}getColWidthDefinedNumber(t){const e=this.getColWidthDefined(t);return this._adjustColWidth(t,this._colWidthDefineToPxWidth(e))}isAutoRowHeight(t){return this.heightMode==="autoHeight"||!!this.options.customComputeRowHeight||t>=0&&t<this.columnHeaderLevelCount&&this.getDefaultRowHeight(t)==="auto"}getColWidth(t){var e;const n=(e=this.colWidthsMap.get(t))!==null&&e!==void 0?e:this.getDefaultColumnWidth(t);return this.widthMode==="adaptive"&&typeof n=="number"||this.transpose&&typeof n=="number"?this._colWidthDefineToPxWidth(n):this._adjustColWidth(t,this._colWidthDefineToPxWidth(n))}_setColWidth(t,e,n,o){this.colWidthsMap.put(t,typeof e=="number"?Math.round(e):e),n&&this._clearColRangeWidthsMap(t),o||this.stateManager.checkFrozen()}setColWidth(t,e){this.scenegraph.setColWidth(t,e),this.scenegraph.updateChartSizeForResizeColWidth(t),this.internalProps._widthResizedColMap.add(t)}_clearColRangeWidthsMap(t){if(typeof t!="number")this._colRangeWidthsMap.clear();else{const e=this._colRangeWidthsMap.keys();for(const n of e){const o=pz.exec(n);if(o){const r=Number(o[1]),s=Number(o[2]);t>=r&&t<=s&&this._colRangeWidthsMap.delete(n)}}}}_clearRowRangeHeightsMap(t){this.rowHeightsMap.clearRange()}_getColContentWidth(t){return Number(this.colContentWidthsMap.get(t))}_setColContentWidth(t,e){this.colContentWidthsMap.put(t,e)}getAllRowsHeight(){return this.internalProps.rowCount<=0?0:this.getRowsHeight(0,this.internalProps.rowCount-1)}getAllColsWidth(){return this.internalProps.colCount<=0?0:this.getColsWidth(0,this.internalProps.colCount-1)}getMaxColWidth(t){var e;const n=this.colWidthsLimit[t];let o=(e=n&&n.max)!==null&&e!==void 0?e:1/0;return typeof o=="string"&&(o=Ko(this,o)),o}setMaxColWidth(t,e){(this.colWidthsLimit[t]||(this.colWidthsLimit[t]={})).max=e}getMinColWidth(t){var e;const n=this.colWidthsLimit[t];let o=(e=n&&n.min)!==null&&e!==void 0?e:0;return typeof o=="string"&&(o=Ko(this,o)),o}setMinColWidth(t,e){(this.colWidthsLimit[t]||(this.colWidthsLimit[t]={})).min=e}getCellRect(t,e){var n,o;const r=this.isFrozenCell(t,e);let s;const l=this.getColWidth(t);let a;s=r&&r.col&&this.isRightFrozenColumn(t,e)?this.getAllColsWidth()<=this.tableNoFrameWidth?this.getColsWidth(0,t-1)||0:this.tableNoFrameWidth-((n=this.getColsWidth(t,this.colCount-1))!==null&&n!==void 0?n:0):this.getColsWidth(0,t-1)||0;const h=this.getRowHeight(e);return a=r&&r.row&&this.isBottomFrozenRow(t,e)?this.getAllRowsHeight()<=this.tableNoFrameHeight?this.getRowsHeight(0,e-1):this.tableNoFrameHeight-((o=this.getRowsHeight(e,this.rowCount-1))!==null&&o!==void 0?o:0):this.getRowsHeight(0,e-1),new qi(Math.round(s),Math.round(a),Math.round(l),Math.round(h))}getMergeCellRect(t,e){const n=this.getCellRange(t,e),o=this.getColsWidth(0,n.start.col-1)||0,r=this.getColsWidth(n.start.col,n.end.col),s=this.getRowsHeight(0,n.start.row-1)||0,l=this.getRowsHeight(n.start.row,n.end.row);return new qi(Math.round(o),Math.round(s),Math.round(r),Math.round(l))}getCellRelativeRect(t,e){const n=this.isFrozenCell(t,e);let o=!0,r=!0;n!=null&&n.col&&(n!=null&&n.row)?(o=!1,r=!1):n!=null&&n.col?o=!1:n!=null&&n.row&&(r=!1);const s=this.getCellRect(t,e);return this._toRelativeRect(s,o,r)}getCellRangeRelativeRect(t){if(t.start){const s=this.isFrozenCell(t.start.col,t.start.row);let l=!0,a=!0;return s!=null&&s.col&&(s!=null&&s.row)?(l=!1,a=!1):s!=null&&s.col?l=!1:s!=null&&s.row&&(a=!1),this._toRelativeRect(this.getCellsRect(t.start.col,t.start.row,t.end.col,t.end.row),l,a)}const e=this.getCellRange(t.col,t.row),n=this.isFrozenCell(t.col,t.row);let o=!0,r=!0;return n!=null&&n.col&&(n!=null&&n.row)?(o=!1,r=!1):n!=null&&n.col?o=!1:n!=null&&n.row&&(r=!1),this._toRelativeRect(this.getCellsRect(e.start.col,e.start.row,e.end.col,e.end.row),o,r)}getVisibleCellRangeRelativeRect(t){let e;return e=t.start?t:this.getCellRange(t.col,t.row),this._getVisiableRect(this.getCellRangeRelativeRect(t),e)}_getVisiableRect(t,e){const n=e.start.col>=this.frozenColCount?Math.max(t.left,this.frozenColCount>=1?this.getColsWidth(0,this.frozenColCount-1):0):t.left,o=Math.min(t.right,this.tableNoFrameWidth),r=t.copy();r.left=n,r.right=o;const s=e.start.row>=this.frozenRowCount?Math.max(t.top,this.frozenRowCount>=1?this.getRowsHeight(0,this.frozenRowCount-1):0):t.top,l=Math.min(t.bottom,this.tableNoFrameHeight);return r.top=s,r.bottom=l,r}getCellsRect(t,e,n,o){var r,s,l,a,h,d;let u=this.getColsWidth(0,t-1)||0,c=this.getColsWidth(t,n);const f=this.scrollLeft;this.isLeftFrozenColumn(t)&&this.isRightFrozenColumn(n)?c=this.tableNoFrameWidth-((r=this.getColsWidth(t+1,this.colCount-1))!==null&&r!==void 0?r:0)-u:this.isLeftFrozenColumn(t)&&!this.isLeftFrozenColumn(n)?c=Math.max(c-f,this.getColsWidth(t,this.frozenColCount-1)):!this.isRightFrozenColumn(t)&&this.isRightFrozenColumn(n)?(u=Math.min(u-f,this.tableNoFrameWidth-this.getRightFrozenColsWidth()),c=this.tableNoFrameWidth-((s=this.getColsWidth(t+1,this.colCount-1))!==null&&s!==void 0?s:0)-u):this.isRightFrozenColumn(t)&&(u=this.tableNoFrameWidth-((l=this.getColsWidth(t,this.colCount-1))!==null&&l!==void 0?l:0));let g=this.getRowsHeight(0,e-1),p=this.getRowsHeight(e,o);const v=this.scrollTop;return this.isTopFrozenRow(e)&&this.isBottomFrozenRow(o)?p=this.tableNoFrameHeight-((a=this.getRowsHeight(e+1,this.rowCount-1))!==null&&a!==void 0?a:0)-g:this.isTopFrozenRow(e)&&!this.isTopFrozenRow(o)?p=Math.max(p-v,this.getRowsHeight(e,this.frozenRowCount-1)):!this.isBottomFrozenRow(e)&&this.isBottomFrozenRow(o)?(g=Math.min(g-v,this.tableNoFrameHeight-this.getBottomFrozenRowsHeight()),p=this.tableNoFrameHeight-((h=this.getRowsHeight(e+1,this.rowCount-1))!==null&&h!==void 0?h:0)-g):this.isBottomFrozenRow(e)&&(g=this.tableNoFrameHeight-((d=this.getRowsHeight(e,this.rowCount-1))!==null&&d!==void 0?d:0)),new qi(Math.round(u),Math.round(g),Math.round(c),Math.round(p))}getCellsRectWidth(t,e,n,o){const r=this.isFrozenCell(t,e),s=this.isFrozenCell(n,o);let l=this.getColsWidth(t,n);if(r&&r.col){const a=this.scrollLeft;s&&s.col||(l-=a,l=Math.max(l,this.getColsWidth(t,this.frozenColCount-1)))}return l}getCellRangeRect(t){if(t.start)return this.getCellsRect(t.start.col,t.start.row,t.end.col,t.end.row);const e=this.getCellRange(t.col,t.row);return this.getCellsRect(e.start.col,e.start.row,e.end.col,e.end.row)}getCellRangeRectWidth(t){if(t.start)return this.getCellsRectWidth(t.start.col,t.start.row,t.end.col,t.end.row);const e=this.getCellRange(t.col,t.row);return this.getCellsRectWidth(e.start.col,e.start.row,e.end.col,e.end.row)}isFrozenCell(t,e){const n=this.isFrozenRow(e),o=this.isFrozenColumn(t);return n||o?{row:n,col:o}:null}getRowAt(t){return Fw(t,this)}getColAt(t){return zw(t,this)}getCellAt(t,e){return ZF(t,e,this)}getCellAtRelativePosition(t,e){return tz(t,e,this)}_checkRowCol(t,e){return t>=0&&t<this.colCount&&e>=0&&e<this.rowCount}_makeVisibleCell(t,e){if(this._checkRowCol(t,e)){const n=this.isFrozenCell(t,e);if(n&&n.col&&n.row)return;const o=this.getCellRect(t,e),r=NH(this);if(r.contains(o))return;n&&n.col||this.getColsWidth(0,this.frozenColCount-1)+o.width>this.canvas.width||(o.left<r.left?this.scrollLeft-=r.left-o.left:r.right<o.right&&(this.scrollLeft-=r.right-o.right)),n&&n.row||this.getRowsHeight(0,this.frozenRowCount-1)+o.height>this.canvas.height||(o.top<r.top?this.scrollTop-=r.top-o.top:r.bottom<o.bottom&&(this.scrollTop-=r.bottom-o.bottom))}}render(){this.scenegraph.renderSceneGraph()}renderAsync(){return this.scenegraph.updateNextFrame(),new Promise((t,e)=>{setTimeout(()=>{t()},0)})}_toRelativeRect(t,e=!0,n=!0){var o,r,s,l;const a=t.copy(),h=this.getVisibleRect();return a.offsetLeft(this.tableX-(e?h.left:0)),a.offsetTop(this.tableY-(n?h.top:0)),a.offsetLeft((r=(o=this.options.viewBox)===null||o===void 0?void 0:o.x1)!==null&&r!==void 0?r:0),a.offsetTop((l=(s=this.options.viewBox)===null||s===void 0?void 0:s.y1)!==null&&l!==void 0?l:0),a}getVisibleRect(){const{scrollTop:t,scrollLeft:e}=this,n=this.tableNoFrameWidth,o=this.tableNoFrameHeight;return new qi(e,t,n,o)}get visibleRowCount(){const{frozenRowCount:t}=this,e=this.getVisibleRect(),n=t>0?e.top+this.getRowsHeight(0,t-1):e.top,o=this.getTargetRowAt(n);if(!o)return 0;const r=Math.max(o.top>=n?o.row:o.row+1,t);let s=this.getRowsHeight(0,r-1),l=0;const{rowCount:a}=this;for(let h=r;h<a;h++){const d=s+this.getRowHeight(h);if(e.bottom<d)break;l++,s=d}return l}getBodyVisibleCellRange(){const{scrollTop:t,scrollLeft:e}=this,n=this.getFrozenRowsHeight(),o=this.getFrozenColsWidth(),r=this.getBottomFrozenRowsHeight(),s=this.getRightFrozenColsWidth(),{row:l}=this.getRowAt(t+n+1),{col:a}=this.getColAt(e+o+1),h=this.getAllRowsHeight()>this.tableNoFrameHeight?this.getRowAt(t+this.tableNoFrameHeight-1-r).row:this.rowCount-1,d=this.getAllColsWidth()>this.tableNoFrameWidth?this.getColAt(e+this.tableNoFrameWidth-1-s).col:this.colCount-1;return d<0||h<0?null:{rowStart:l,colStart:a,rowEnd:h,colEnd:d}}getBodyVisibleRowRange(){const{scrollTop:t}=this,e=this.getFrozenRowsHeight(),n=this.getBottomFrozenRowsHeight(),{row:o}=this.getRowAt(t+e+1),r=this.getAllRowsHeight()>this.tableNoFrameHeight?this.getRowAt(t+this.tableNoFrameHeight-1-n).row:this.rowCount-1;return r<0?null:{rowStart:o,rowEnd:r}}getBodyVisibleColRange(){const{scrollLeft:t}=this,e=this.getFrozenColsWidth(),n=this.getRightFrozenColsWidth(),{col:o}=this.getColAt(t+e+1),r=this.getAllColsWidth()>this.tableNoFrameWidth?this.getColAt(t+this.tableNoFrameWidth-1-n).col:this.colCount-1;return r<0?null:{colStart:o,colEnd:r}}get visibleColCount(){const{frozenColCount:t}=this,e=this.getVisibleRect(),n=t>0?e.left+this.getColsWidth(0,t-1):e.left,o=this.getTargetColAt(n);if(!o)return 0;const r=Math.max(o.left>=n?o.col:o.col+1,t);let s=this.getColsWidth(0,r-1),l=0;const{colCount:a}=this;for(let h=r;h<a;h++){const d=s+this.getColWidth(h);if(e.right<d)break;l++,s=d}return l}get scrollTop(){return this.stateManager.scroll.verticalBarPos}set scrollTop(t){this.stateManager.setScrollTop(t)}get scrollLeft(){return this.stateManager.scroll.horizontalBarPos}set scrollLeft(t){this.stateManager.setScrollLeft(t)}getScrollLeft(){return this.scrollLeft}getScrollTop(){return this.scrollTop}setScrollLeft(t){this.scrollLeft=Math.ceil(t)}setScrollTop(t){this.scrollTop=Math.ceil(t)}getCellOverflowText(t,e){return this.scenegraph.getCellOverflowText(t,e)}addReleaseObj(t){if(!t||!t.release||typeof t.release!="function")throw new Error("not releaseObj!");(this.internalProps.releaseList=this.internalProps.releaseList||[]).push(t)}dispose(){this.release()}release(){var t,e,n,o,r,s,l,a,h,d,u,c,f,g,p,v;const m=this.internalProps;if(this.isReleased)return;(e=(t=m.tooltipHandler)===null||t===void 0?void 0:t.release)===null||e===void 0||e.call(t),(o=(n=m.menuHandler)===null||n===void 0?void 0:n.release)===null||o===void 0||o.call(n),X_.clearAll(),(r=super.release)===null||r===void 0||r.call(this),(l=(s=m.handler)===null||s===void 0?void 0:s.release)===null||l===void 0||l.call(s),this.eventManager.release(),(h=(a=m.focusControl)===null||a===void 0?void 0:a.release)===null||h===void 0||h.call(a),(d=m.legends)===null||d===void 0||d.forEach(C=>{C==null||C.release()}),(u=m.title)===null||u===void 0||u.release(),m.title=null,(c=m.emptyTip)===null||c===void 0||c.release(),m.emptyTip=null,m.layoutMap.release(),m.releaseList&&(m.releaseList.forEach(C=>{var _;return(_=C==null?void 0:C.release)===null||_===void 0?void 0:_.call(C)}),m.releaseList=null),this.scenegraph.stage.release(),this.scenegraph.proxy.release(),m.focusControl.release();const{parentElement:b}=m.element;b&&!this.options.canvas&&b.removeChild(m.element),(p=(g=(f=this.editorManager)===null||f===void 0?void 0:f.editingEditor)===null||g===void 0?void 0:g.onEnd)===null||p===void 0||p.call(g),this.isReleased=!0,this.scenegraph=null,this.internalProps=null,(v=this.reactCustomLayout)===null||v===void 0||v.clearCache()}fireListeners(t,e){return super.fireListeners(t,e)}updateOption(t){var e,n,o,r,s,l,a,h,d,u,c,f,g,p,v,m;this.options=t,this._hasAutoImageColumn=void 0;const{frozenColCount:b=0,unfreezeAllOnExceedsMaxWidth:C,defaultRowHeight:_=40,defaultHeaderRowHeight:w,defaultColWidth:y=80,defaultHeaderColWidth:x=80,keyboardOptions:S,eventOptions:R,rowSeriesNumber:B,columnResizeMode:A,rowResizeMode:M="none",resize:k,dragHeaderMode:E,showFrozenIcon:T,allowFrozenColCount:P,padding:H,hover:L,menu:F,select:z,pixelRatio:I,widthMode:N,heightMode:W,autoFillWidth:D,autoFillHeight:j,widthAdaptiveMode:V,heightAdaptiveMode:X,customRender:K,renderChartAsync:J,renderChartAsyncBatchCount:ot,canvasWidth:lt,canvasHeight:ct,overscrollBehavior:it,limitMinWidth:nt,limitMinHeight:ht}=t;I&&I!==this.internalProps.pixelRatio&&(this.internalProps.pixelRatio=I),H&&(typeof H=="number"?(this.padding.top=H,this.padding.left=H,this.padding.bottom=H,this.padding.right=H):(H.top&&(this.padding.top=H.top),H.bottom&&(this.padding.bottom=H.bottom),H.left&&(this.padding.left=H.left),H.right&&(this.padding.right=H.right))),this.showFrozenIcon=typeof T!="boolean"||T,typeof P=="number"&&P<=0&&(this.showFrozenIcon=!1),this.widthMode=N??"standard",this.heightMode=W??"standard",this._widthAdaptiveMode=V??"only-body",this._heightAdaptiveMode=X??"only-body",this.autoFillWidth=D!=null&&D,this.autoFillHeight=j!=null&&j,this.customRender=K,this.canvasWidth=Z(lt)?lt:void 0,this.canvasHeight=Z(ct)?ct:void 0;const $=this.internalProps;if(Bt.mode==="node"||t.canvas||zH($.element,this.padding),this.columnWidthComputeMode=(e=t.columnWidthComputeMode)!==null&&e!==void 0?e:"normal",$.frozenColCount=b,$.unfreezeAllOnExceedsMaxWidth=C==null||C,$.defaultRowHeight=_,$.defaultHeaderRowHeight=w??_,$.defaultColWidth=y,$.defaultHeaderColWidth=x??y,$.keyboardOptions=S,$.eventOptions=R,$.rowSeriesNumber=B,$.columnResizeMode=(n=k==null?void 0:k.columnResizeMode)!==null&&n!==void 0?n:A,$.rowResizeMode=(o=k==null?void 0:k.rowResizeMode)!==null&&o!==void 0?o:M,$.dragHeaderMode=E??"none",$.renderChartAsync=J,em(ot),$.overscrollBehavior=it??"auto",$.cellTextOverflows={},$._rowHeightsMap=new Km(this),$._rowRangeHeightsMap=new Map,$._colRangeWidthsMap=new Map,$._widthResizedColMap=new Set,$._heightResizedRowMap=new Set,this.colWidthsMap=new Kn,this.colContentWidthsMap=new Kn,this.colWidthsLimit={},$.stick.changedCells.clear(),$.theme=Fn.of((r=t.theme)!==null&&r!==void 0?r:Fn.DEFAULT),$.theme.isPivot=this.isPivotTable(),Gl($.theme.functionalIconsStyle),this.scenegraph.updateStageBackground(),$.autoWrapText=t.autoWrapText,$.enableLineBreak=t.enableLineBreak,$.allowFrozenColCount=(s=t.allowFrozenColCount)!==null&&s!==void 0?s:0,$.limitMaxAutoWidth=(l=t.limitMaxAutoWidth)!==null&&l!==void 0?l:450,$.limitMinWidth=nt!=null?typeof nt=="number"?nt:nt?10:0:10,$.limitMinHeight=ht!=null?typeof ht=="number"?ht:ht?10:0:10,(a=$.legends)===null||a===void 0||a.forEach(Y=>{Y==null||Y.release()}),(h=$.title)===null||h===void 0||h.release(),$.title=null,(d=$.emptyTip)===null||d===void 0||d.release(),$.emptyTip=null,$.layoutMap.release(),this.scenegraph.clearCells(),this.scenegraph.updateComponent(),this.stateManager.updateOptionSetState(),this._updateSize(),this.eventManager.updateEventBinder(),t.legends){$.legends=[];const Y=ut.getFunction("createLegend");if(Array.isArray(t.legends)){for(let _t=0;_t<t.legends.length;_t++)$.legends.push(Y(t.legends[_t],this));this.scenegraph.tableGroup.setAttributes({x:this.tableX,y:this.tableY})}else $.legends.push(Y(t.legends,this)),this.scenegraph.tableGroup.setAttributes({x:this.tableX,y:this.tableY})}if($.tooltip=Object.assign({parentElement:this.getElement(),renderMode:"html",isShowOverflowTextTooltip:!1,confine:!0,position:ri.bottom},t.tooltip),$.tooltip.renderMode==="html"&&!$.tooltipHandler){const Y=ut.getComponent("tooltipHandler");$.tooltipHandler=new Y(this,$.tooltip.confine)}if($.menu=Object.assign({renderMode:"html"},t.menu),Array.isArray((u=t.menu)===null||u===void 0?void 0:u.dropDownMenuHighlight)&&this.setDropDownMenuHighlight((c=t.menu)===null||c===void 0?void 0:c.dropDownMenuHighlight),(Array.isArray((f=t.menu)===null||f===void 0?void 0:f.defaultHeaderMenuItems)||typeof((g=t.menu)===null||g===void 0?void 0:g.defaultHeaderMenuItems)=="function")&&(this.globalDropDownMenu=t.menu.defaultHeaderMenuItems),$.menu.renderMode==="html"&&!$.menuHandler){const Y=ut.getComponent("menuHandler");$.menuHandler=new Y(this)}this.clearCellStyleCache(),this.clearColWidthCache(),this.clearRowHeightCache(),$.customMergeCell=rb(t.customMergeCell),(p=this.customCellStylePlugin)===null||p===void 0||p.updateCustomCell((v=t.customCellStyle)!==null&&v!==void 0?v:[],(m=t.customCellStyleArrangement)!==null&&m!==void 0?m:[]),this._adjustCanvasSizeByOption()}renderWithRecreateCells(){this.internalProps.stick.changedCells.clear();const t={col:this.stateManager.hover.cellPos.col,row:this.stateManager.hover.cellPos.row};this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,this.scenegraph.clearCells(),this.clearCellStyleCache(),this.scenegraph.createSceneGraph(),this.stateManager.updateHoverPos(t.col,t.row),this.render()}getFrozenRowsHeight(){return this.getRowsHeight(0,this.frozenRowCount-1)}getFrozenColsWidth(){return this.getColsWidth(0,this.frozenColCount-1)}getBottomFrozenRowsHeight(){if(this.bottomFrozenRowCount>0){let t=0;for(let e=this.rowCount-this.bottomFrozenRowCount;e<=this.rowCount-1;e++)t+=this.getRowHeight(e);return t}return 0}getRightFrozenColsWidth(){if(this.rightFrozenColCount>0){let t=0;for(let e=this.colCount-this.rightFrozenColCount;e<=this.colCount-1;e++)t+=this.getColWidth(e);return t}return 0}getDrawRange(){const t=Math.min(this.tableNoFrameWidth,this.getAllColsWidth()),e=Math.min(this.tableNoFrameHeight,this.getAllRowsHeight());return new qi(this.tableX,this.tableY,t,e)}_getMouseAbstractPoint(t,e=!0){var n,o,r,s;let l;if(!t)return{inTable:!1,x:void 0,y:void 0};l=fz(t)?t.changedTouches[0]:t;const a=l.clientX||l.pageX+window.scrollX,h=l.clientY||l.pageY+window.scrollY,d=this.internalProps.canvas.getBoundingClientRect();let u=!0;d.right<=a&&(u=!1),d.bottom<=h&&(u=!1);const c=d.width,f=c/(this.canvas.offsetWidth||c),g=d.height,p=g/(this.canvas.offsetHeight||g),v={x:(a-d.left)/f+(e?this.scrollLeft:0)-((o=(n=this.options.viewBox)===null||n===void 0?void 0:n.x1)!==null&&o!==void 0?o:0),y:(h-d.top)/p+(e?this.scrollTop:0)-((s=(r=this.options.viewBox)===null||r===void 0?void 0:r.y1)!==null&&s!==void 0?s:0),inTable:u};return this.internalProps.modifiedViewBoxTransform&&this.scenegraph.stage.window.getViewBoxTransform()&&this.scenegraph.stage.window.getViewBoxTransform().transformPoint(v,v),v}getTheme(){return this.internalProps.theme}getTargetColAt(t){return nf(t,this)}getTargetRowAt(t){const e=of(t,this);return e&&(e.row=Math.min(e.row,this.rowCount-1)),e}getTargetColAtConsiderRightFrozen(t,e){return Iw(t,e,this)}getTargetRowAtConsiderBottomFrozen(t,e){return Ow(t,e,this)}clearSelected(){this.stateManager.updateSelectPos(-1,-1)}selectCell(t,e,n,o,r,s=!1){var l,a,h;const d=!!(!((l=this.stateManager.select.ranges)===null||l===void 0)&&l.length);this.stateManager.updateSelectPos(t,e,n,o,!1,(h=r??((a=this.options.select)===null||a===void 0?void 0:a.makeSelectCellVisible))===null||h===void 0||h,s),this.stateManager.endSelectCells(!0,d)}selectCells(t){const{scrollLeft:e,scrollTop:n}=this;t.forEach((o,r)=>{var s,l,a,h,d,u;o.start.col===o.end.col&&o.start.row===o.end.row?this.stateManager.updateSelectPos(o.start.col,o.start.row,!1,r>=1,!1,(l=(s=this.options.select)===null||s===void 0?void 0:s.makeSelectCellVisible)===null||l===void 0||l,!0):(this.stateManager.updateSelectPos(o.start.col,o.start.row,!1,r>=1,!1,(h=(a=this.options.select)===null||a===void 0?void 0:a.makeSelectCellVisible)===null||h===void 0||h,!0),this.stateManager.updateInteractionState(vt.grabing),this.stateManager.updateSelectPos(o.end.col,o.end.row,!1,r>=1,!1,(u=(d=this.options.select)===null||d===void 0?void 0:d.makeSelectCellVisible)===null||u===void 0||u,!0)),this.stateManager.endSelectCells(!1,!1),this.stateManager.updateInteractionState(vt.default)}),this.setScrollTop(n),this.setScrollLeft(e)}get recordsCount(){var t;return(t=this.records)===null||t===void 0?void 0:t.length}get allowFrozenColCount(){return this.internalProps.allowFrozenColCount}get rowHeaderLevelCount(){return this.internalProps.layoutMap.rowHeaderLevelCount}get columnHeaderLevelCount(){return this.internalProps.layoutMap.columnHeaderLevelCount}get records(){return this.internalProps.records}get dataSource(){return this.internalProps.dataSource}set dataSource(t){this.scenegraph.clearCells(),IH(this,t),this.refreshRowColCount(),this.scenegraph.createSceneGraph(),this.render()}get autoWrapText(){return this.internalProps.autoWrapText}set autoWrapText(t){this.internalProps.autoWrapText=t,this.options.autoWrapText=t}get enableLineBreak(){return this.internalProps.enableLineBreak}set enableLineBreak(t){this.internalProps.enableLineBreak=t,this.options.enableLineBreak=t}updateAutoWrapText(t){this.internalProps.autoWrapText!==t&&(this.internalProps.autoWrapText=t,this.options.autoWrapText=t,this.scenegraph.clearCells(),this.clearCellStyleCache(),this.scenegraph.createSceneGraph(),this.render())}get theme(){return this.internalProps.theme}set theme(t){this.internalProps.theme=Fn.of(t??Fn.DEFAULT),this.internalProps.theme.isPivot=this.isPivotTable(),this.options.theme=t,Gl(this.internalProps.theme.functionalIconsStyle)}updateTheme(t){const e={col:this.stateManager.hover.cellPos.col,row:this.stateManager.hover.cellPos.row};this.internalProps.theme=Fn.of(t??Fn.DEFAULT),this.internalProps.theme.isPivot=this.isPivotTable(),Gl(this.internalProps.theme.functionalIconsStyle),this.options.theme=t,this.scenegraph.updateComponent(),this.scenegraph.updateStageBackground(),this.scenegraph.clearCells(),this.clearCellStyleCache(),this.scenegraph.createSceneGraph(),this.stateManager.updateHoverPos(e.col,e.row),this.render()}getBodyField(t,e){return this.internalProps.layoutMap.getBody(t,e).field}getBodyColumnDefine(t,e){const n=this.internalProps.layoutMap.getBody(t,e);return n==null?void 0:n.define}getBodyColumnType(t,e){var n,o;const r=(o=(n=this.internalProps.layoutMap.getBody(t,e))===null||n===void 0?void 0:n.cellType)!==null&&o!==void 0?o:"text";return q("cellType",{cellType:r},t,e,this)}getCellType(t,e){let n;return this.isSeriesNumberInHeader(t,e)?this.internalProps.layoutMap.getSeriesNumberHeader(t,e).cellType:(n=this.isHeader(t,e)?this.internalProps.layoutMap.getHeader(t,e).headerType:this.internalProps.layoutMap.getBody(t,e).cellType,q("cellType",{cellType:n},t,e,this))}getHeaderField(t,e){return this.internalProps.layoutMap.getHeaderField(t,e)}getHeaderDefine(t,e){const n=this.internalProps.layoutMap.getHeader(t,e);return n==null?void 0:n.define}getCellLocation(t,e){return this.internalProps.layoutMap.getCellLocation(t,e)}getCellHeaderPaths(t,e){return this.internalProps.layoutMap.getCellHeaderPaths(t,e)}getHeadersDefine(t,e){const n=[];for(;;){const o=this.getHeaderDefine(t,e);if(!o||!o.field&&!o.columns)break;n.push(o),e++}return n}_getHeaderLayoutMap(t,e){return this.internalProps.layoutMap.getHeader(t,e)}_getBodyLayoutMap(t,e){return this.internalProps.layoutMap.getBody(t,e)}getContext(){return this.internalProps.context}getRecordByCell(t,e){if(!this.internalProps.layoutMap.isHeader(t,e))return this.getCellOriginRecord(t,e)}getRecordByRowCol(t,e){return this.getRecordByCell(t,e)}getRecordStartRowByRecordIndex(t){return this.internalProps.layoutMap.getRecordStartRowByRecordIndex(t)}_getHeaderCellBySortState(t){const{layoutMap:e}=this.internalProps,n=e.headerObjects.find(o=>o&&o.field===t.field);if(n)return e.getHeaderCellAdressById(n.id)}getCellRange(t,e){var n;if(this.internalProps.customMergeCell){const o=this.internalProps.customMergeCell(t,e,this);if(o&&o.range&&(O(o.text)||o.customLayout||o.customRender))return o.range}return(n=this.internalProps.layoutMap)===null||n===void 0?void 0:n.getCellRange(t,e)}hasCustomMerge(){return!!this.internalProps.customMergeCell}getCustomMerge(t,e){if(this.internalProps.customMergeCell){const n=this.internalProps.customMergeCell(t,e,this);if(n&&n.range&&(O(n.text)||n.customLayout||this.customRender)){if(n.style){const o=this.internalProps.bodyHelper.getStyleClass("text"),r=n.style,s=Yg(r,this.theme.bodyStyle,{col:t,row:e,table:this,value:n.text,dataValue:this.getCellOriginValue(t,e),cellHeaderPaths:this.getCellHeaderPaths(t,e)},o,this.options.autoWrapText,this.theme);n.style=s}return n}}}isCellRangeEqual(t,e,n,o){return this.internalProps.layoutMap.isCellRangeEqual(t,e,n,o)}_getLayoutCellId(t,e){return this.internalProps.layoutMap.getCellId(t,e)}getHeaderDescription(t,e){var n;const o=this._getHeaderLayoutMap(t,e),r=o==null?void 0:o.define,s=(n=r==null?void 0:r.description)!==null&&n!==void 0?n:o==null?void 0:o.description;return typeof s=="function"?s({col:t,row:e,value:this.getCellValue(t,e),dataValue:this.getCellOriginValue(t,e)}):s}setDropDownMenuHighlight(t){this.stateManager.setDropDownMenuHighlight(t)}_dropDownMenuIsHighlight(t,e,n){return this.stateManager.dropDownMenuIsHighlight(t,e,n)}isSeriesNumberInBody(t,e){return this.internalProps.layoutMap&&this.internalProps.layoutMap.isSeriesNumberInBody(t,e)}isSeriesNumberInHeader(t,e){return this.internalProps.layoutMap&&this.internalProps.layoutMap.isSeriesNumberInHeader(t,e)}isHeader(t,e){return this.internalProps.layoutMap&&this.internalProps.layoutMap.isHeader(t,e)}isColumnHeader(t,e){var n;return(n=this.internalProps.layoutMap)===null||n===void 0?void 0:n.isColumnHeader(t,e)}isRowHeader(t,e){var n;return(n=this.internalProps.layoutMap)===null||n===void 0?void 0:n.isRowHeader(t,e)}isCornerHeader(t,e){var n;return(n=this.internalProps.layoutMap)===null||n===void 0?void 0:n.isCornerHeader(t,e)}isFrozenColumn(t,e){return this.isLeftFrozenColumn(t,e)||this.isRightFrozenColumn(t,e)}isLeftFrozenColumn(t,e){var n;return(n=this.internalProps.layoutMap)===null||n===void 0?void 0:n.isFrozenColumn(t,e)}isRightFrozenColumn(t,e){var n;return(n=this.internalProps.layoutMap)===null||n===void 0?void 0:n.isRightFrozenColumn(t,e)}isFrozenRow(t,e){return this.isTopFrozenRow(t,e)||this.isBottomFrozenRow(t,e)}isTopFrozenRow(t,e){var n;return(n=this.internalProps.layoutMap)===null||n===void 0?void 0:n.isFrozenRow(t,e)}isBottomFrozenRow(t,e){var n;return(n=this.internalProps.layoutMap)===null||n===void 0?void 0:n.isBottomFrozenRow(t,e)}getCellInfo(t,e){if(t>=0&&e>=0){const n=this.isHeader(t,e)?this.getHeaderDefine(t,e):this.getBodyColumnDefine(t,e);return{col:t,row:e,field:this.getHeaderField(t,e),cellHeaderPaths:this.internalProps.layoutMap.getCellHeaderPaths(t,e),title:n==null?void 0:n.title,cellType:this.getCellType(t,e),originData:this.getCellOriginRecord(t,e),cellRange:this.getCellRangeRelativeRect({col:t,row:e}),value:this.getCellValue(t,e),dataValue:this.getCellOriginValue(t,e),cellLocation:this.getCellLocation(t,e),scaleRatio:this.canvas.getBoundingClientRect().width/this.canvas.offsetWidth}}}_hasField(t,e,n){var o;if(t===null||this.internalProps.layoutMap.isHeader(e,n))return!1;const r=this.getRecordShowIndexByCell(e,n);return(o=this.internalProps.dataSource)===null||o===void 0?void 0:o.hasField(r,t)}_getCellStyle(t,e){return uz(t,e,this)}clearCellStyleCache(){this.headerStyleCache.clear(),this.bodyStyleCache.clear(),this.bodyMergeTitleCache.clear(),this.bodyBottomStyleCache.clear()}clearRowHeightCache(){this.internalProps._rowHeightsMap.clear(),this._clearRowRangeHeightsMap()}clearColWidthCache(){this.internalProps._colWidthsMap.clear(),this._clearColRangeWidthsMap()}_canResizeColumn(t,e){if(!(t>=0&&e>=0)||this.isCellRangeEqual(t,e,t+1,e)||this.internalProps.columnResizeMode==="none")return!1;if(this.internalProps.columnResizeMode==="header"){if(!this.isHeader(t,e))return!1}else if(this.internalProps.columnResizeMode==="body"&&this.isHeader(t,e))return!1;const n=this.colWidthsLimit[t];return!(n&&n.min&&n.max)||n.max!==n.min}_canResizeRow(t,e){if(!(t>=0&&e>=0)||this.isCellRangeEqual(t,e,t,e+1)||this.internalProps.rowResizeMode==="none")return!1;if(this.internalProps.rowResizeMode==="header"){if(!this.isHeader(t,e))return!1}else if(this.internalProps.rowResizeMode==="body"&&this.isHeader(t,e))return!1;return!0}_canDragHeaderPosition(t,e){var n;if(this.isHeader(t,e)&&(this.stateManager.isSelected(t,e)||((n=this.options.select)===null||n===void 0?void 0:n.headerSelectMode)==="body"&&fL(t,e,[this.getCellRange(this.stateManager.select.cellPos.col,this.stateManager.select.cellPos.row)])||Yn(this,t,e))){if(this.internalProps.frozenColDragHeaderMode==="disabled"&&this.isFrozenColumn(t))return!1;if(this.stateManager.isSelected(t,e)){const r=this.stateManager.select.ranges[0];if(this.isColumnHeader(t,e)){if(r.end.row!==this.rowCount-1)return!1}else if(!this.isRowHeader(t,e)||r.end.col!==this.colCount-1)return!1}const o=this.getHeaderDefine(t,e);if(!o)return!1;if(o.dragHeader===void 0){if(this.internalProps.dragHeaderMode==="all")return!0;if(this.internalProps.dragHeaderMode==="column"){if(this.isColumnHeader(t,e))return!0}else if(this.internalProps.dragHeaderMode==="row"&&this.isRowHeader(t,e))return!0;return!1}return o.dragHeader}return!1}getCellIcons(t,e){var n,o,r;let s;if(this.isHeader(t,e))s=this.internalProps.headerHelper.getIcons(t,e);else if(this.internalProps.layoutMap.isSeriesNumber(t,e)){(!this.options.groupBy||!(!((n=this.getCellRawRecord(t,e))===null||n===void 0)&&n.vtableMerge))&&!((r=(o=this.internalProps.layoutMap.getSeriesNumberBody(t,e))===null||o===void 0?void 0:o.define)===null||r===void 0)&&r.dragOrder&&(s=this.internalProps.rowSeriesNumberHelper.getIcons(t,e));const l=this.getCellValue(t,e),a=this.getCellOriginValue(t,e),h=this.internalProps.context,d=this.internalProps.bodyHelper.getIcons(t,e,l,a,h);(s==null?void 0:s.length)>0?s=s.concat(d):(d==null?void 0:d.length)>0&&(s=d)}else{const l=this.getCellValue(t,e),a=this.getCellOriginValue(t,e),h=this.internalProps.context;s=this.internalProps.bodyHelper.getIcons(t,e,l,a,h)}return s}showDropDownMenu(t,e,n){let o="dropdown-menu";n&&(o=Array.isArray(n.content)?"dropdown-menu":"container"),this.internalProps.menu.renderMode==="html"&&(this.stateManager.menu.isShow=!0,this.internalProps.menuHandler._bindToCell(t,e,o,n))}showTooltip(t,e,n){this.internalProps.tooltip.renderMode==="html"&&this.internalProps.tooltipHandler._bindToCell(t,e,n)}getCellStyle(t,e){const n=this._getCellStyle(t,e),o=no(n,this,t,e,q).theme,{autoWrapText:r,lineClamp:s,textOverflow:l}=n;return{textAlign:o.text.textAlign,textBaseline:o.text.textBaseline,bgColor:He(o.group.fill)?q("bgColor",n,t,e,this):o.group.fill,color:He(o.text.fill)?q("color",n,t,e,this):o.text.fill,strokeColor:He(o.text.stroke)?q("strokeColor",n,t,e,this):o.text.stroke,fontFamily:o.text.fontFamily,fontSize:o.text.fontSize,fontWeight:o.text.fontWeight,fontVariant:o.text.fontVariant,fontStyle:o.text.fontStyle,lineHeight:o.text.lineHeight,autoWrapText:r!=null&&r,lineClamp:s??"auto",textOverflow:l,borderColor:He(o.group.stroke)?q("borderColor",n,t,e,this):o.group.stroke,borderLineWidth:o.group.lineWidth,borderLineDash:o.group.lineDash,underline:!!o.text.underline,underlineDash:o.text.underlineDash,underlineOffset:o.text.underlineOffset,lineThrough:!!o.text.lineThrough,padding:o._vtable.padding,underlineWidth:o.text.underline,lineThroughLineWidth:o.text.lineThrough,_strokeArrayWidth:o.group.strokeArrayWidth,_strokeArrayColor:o.group.strokeArrayColor,_linkColor:q("linkColor",n,t,e,this)}}getAllBodyCells(t,e){const n=this.rowHeaderLevelCount,o=this.columnHeaderLevelCount,r=this.colCount-1,s=this.rowCount-1;return Array(Math.min(e??2e3,s-o+1,this.rowCount)).fill(0).map((l,a)=>Array(Math.min(t??2e3,r-n+1,this.colCount)).fill(0).map((h,d)=>this.getCellInfo(d+n,a+o)))}getAllCells(t,e){const r=this.colCount-1,s=this.rowCount-1;return Array(Math.min(e??2e3,s-0+1,this.rowCount)).fill(0).map((l,a)=>Array(Math.min(t??2e3,r-0+1,this.colCount)).fill(0).map((h,d)=>this.getCellInfo(d+0,a+0)))}getAllColumnHeaderCells(){const t=this.rowHeaderLevelCount,e=0,n=this.colCount-1,o=this.columnHeaderLevelCount-1;return Array(o-e+1).fill(0).map((r,s)=>Array(n-t+1).fill(0).map((l,a)=>this.getCellInfo(a+t,s+e)))}getAllRowHeaderCells(){const e=this.columnHeaderLevelCount,n=this.rowHeaderLevelCount-1,o=this.rowCount-1;return Array(o-e+1).fill(0).map((r,s)=>Array(n-0+1).fill(0).map((l,a)=>this.getCellInfo(a+0,s+e)))}getCopyValue(){var t,e,n;if(((e=(t=this.stateManager.select)===null||t===void 0?void 0:t.ranges)===null||e===void 0?void 0:e.length)>0){const o=this.stateManager.select.ranges;let r=Math.min(o[0].start.col,o[0].end.col),s=Math.max(o[0].start.col,o[0].end.col),l=Math.min(o[0].start.row,o[0].end.row),a=Math.max(o[0].start.row,o[0].end.row);o.forEach(g=>{r=Math.min(r,g.start.col,g.end.col),s=Math.max(s,g.start.col,g.end.col),l=Math.min(l,g.start.row,g.end.row),a=Math.max(a,g.start.row,g.end.row)});const h=g=>{let p=!1;return o.forEach(v=>{const m=Math.min(v.start.row,v.end.row),b=Math.max(v.start.row,v.end.row);m<=g&&b>=g&&(p=!0)}),p},d=g=>{let p=!1;return o.forEach(v=>{const m=Math.min(v.start.col,v.end.col),b=Math.max(v.start.col,v.end.col);m<=g&&b>=g&&(p=!0)}),p},u=(g,p)=>{let v;return o.forEach(m=>{const b=Math.min(m.start.row,m.end.row),C=Math.max(m.start.row,m.end.row),_=Math.min(m.start.col,m.end.col),w=Math.max(m.start.col,m.end.col);_<=g&&w>=g&&b<=p&&C>=p&&(v=m)}),v},c=(g,p,v)=>{const m=this.getCellRange(g,p);let b=m.start.col,C=m.start.row;if(v){const _=Math.min(v.start.col,v.end.col),w=Math.min(v.start.row,v.end.row);b=Math.max(_,m.start.col),C=Math.max(w,m.start.row)}return b!==g||C!==p?"":this.getCellValue(g,p)};let f="";for(let g=l;g<=a;g++)if(h(g)){for(let p=r;p<=s;p++)if(d(p)){const v=u(p,g);if(v){const m=c(p,g,v);if(!(typeof Promise<"u"&&m instanceof Promise)){const b=O(m)?`${m}`:"";/^\[object .*\]$/.exec(b)||(f+=b)}(p<v.end.col||p<s)&&(f+="	")}else f+="	"}g<a&&(f+=`\r
`)}return!((n=this.options)===null||n===void 0)&&n.formatCopyValue&&(f=this.options.formatCopyValue(f)),f}return""}getSelectedCellInfos(){var t;if(!(!((t=this.stateManager.select)===null||t===void 0)&&t.ranges))return null;const e=this.stateManager.select.ranges;if(!e.length)return[];let n=Math.min(e[0].start.col,e[0].end.col),o=Math.max(e[0].start.col,e[0].end.col),r=Math.min(e[0].start.row,e[0].end.row),s=Math.max(e[0].start.row,e[0].end.row);e.forEach(u=>{n=Math.min(n,u.start.col,u.end.col),o=Math.max(o,u.start.col,u.end.col),r=Math.min(r,u.start.row,u.end.row),s=Math.max(s,u.start.row,u.end.row)});const l=u=>{let c=!1;return e.forEach(f=>{const g=Math.min(f.start.row,f.end.row),p=Math.max(f.start.row,f.end.row);g<=u&&p>=u&&(c=!0)}),c},a=u=>{let c=!1;return e.forEach(f=>{const g=Math.min(f.start.col,f.end.col),p=Math.max(f.start.col,f.end.col);g<=u&&p>=u&&(c=!0)}),c},h=(u,c)=>{let f;return e.forEach(g=>{const p=Math.min(g.start.row,g.end.row),v=Math.max(g.start.row,g.end.row),m=Math.min(g.start.col,g.end.col),b=Math.max(g.start.col,g.end.col);m<=u&&b>=u&&p<=c&&v>=c&&(f=g)}),f},d=[];for(let u=r;u<=s;u++)if(l(u)){const c=[];for(let f=n;f<=o;f++)if(a(f)&&h(f,u)){const g=this.getCellInfo(f,u);c.push(g)}d.push(c)}return d}getSelectedCellRanges(){const t=this.stateManager.select.ranges;return t.length?Do(t):[]}measureText(t,e){return aw.measureText(t,e)}measureTextBounds(t){return hw(t)}getCustomRender(t,e){let n;if(this.getCellLocation(t,e)!=="body"){const o=this.getHeaderDefine(t,e);n=o==null?void 0:o.headerCustomRender}else{const o=this.getBodyColumnDefine(t,e);n=(o==null?void 0:o.customRender)||this.customRender}return n}getCustomLayout(t,e){let n;if(this.getCellLocation(t,e)!=="body"){const o=this.getHeaderDefine(t,e);n=o==null?void 0:o.headerCustomLayout}else{const o=this.getBodyColumnDefine(t,e);n=o==null?void 0:o.customLayout}return n}hasAutoImageColumn(){return this._hasAutoImageColumn===void 0&&(this._hasAutoImageColumn=qF(this)),this._hasAutoImageColumn}_getActiveChartInstance(){var t,e,n,o,r,s;const l=this.scenegraph.getCell((e=(t=this.stateManager.hover)===null||t===void 0?void 0:t.cellPos)===null||e===void 0?void 0:e.col,(o=(n=this.stateManager.hover)===null||n===void 0?void 0:n.cellPos)===null||o===void 0?void 0:o.row);return((s=(r=l==null?void 0:l.getChildren())===null||r===void 0?void 0:r[0])===null||s===void 0?void 0:s.type)==="chart"?l.getChildren()[0].activeChartInstance:null}cellIsInVisualView(t,e){var n,o,r,s;const l=this.getDrawRange(),a=this.getCellRelativeRect(t,e);if(t<this.frozenColCount&&e<this.frozenRowCount)return!0;let h,d,u,c;return this.frozenRowCount>=1&&(h=this.getCellRangeRelativeRect({start:{col:0,row:0},end:{col:this.colCount-1,row:this.frozenRowCount-1}})),this.frozenColCount>=1&&(d=this.getCellRangeRelativeRect({start:{col:0,row:0},end:{col:this.frozenColCount-1,row:this.rowCount-1}})),this.bottomFrozenRowCount>=1&&(u=this.getCellRangeRelativeRect({start:{col:0,row:this.rowCount-this.bottomFrozenRowCount},end:{col:this.colCount-1,row:this.rowCount-1}})),this.rightFrozenColCount>=1&&(c=this.getCellRangeRelativeRect({start:{col:this.colCount-this.rightFrozenColCount,row:0},end:{col:this.colCount-1,row:this.rowCount-1}})),!!(a.top>=l.top&&a.bottom<=l.bottom&&a.left>=l.left&&a.right<=l.right&&(this.isFrozenCell(t,e)||a.top>=((n=h==null?void 0:h.bottom)!==null&&n!==void 0?n:a.top)&&a.left>=((o=d==null?void 0:d.right)!==null&&o!==void 0?o:a.left)&&a.bottom<=((r=u==null?void 0:u.top)!==null&&r!==void 0?r:a.bottom)&&a.right<=((s=c==null?void 0:c.left)!==null&&s!==void 0?s:a.right)))}getCustomMergeValue(t,e){if(this.internalProps.customMergeCell){const n=this.getCustomMerge(t,e);if(n){const{text:o}=n;return o}}}exportImg(){return this.scenegraph.stage.toCanvas().toDataURL()}exportCellImg(t,e,n){var o,r,s,l;const a=this.cellIsInVisualView(t,e),{scrollTop:h,scrollLeft:d}=this;a||this.scrollToCell({col:t,row:e});const u=this.getCellRelativeRect(t,e);((r=(o=this.stateManager.select)===null||o===void 0?void 0:o.ranges)===null||r===void 0?void 0:r.length)>0&&mm(this.scenegraph);const{col:c,row:f}=this.stateManager.hover.cellPos;let g,p;if(this.stateManager.updateHoverPos(-1,-1),this.scenegraph.component.hideVerticalScrollBar(),this.scenegraph.component.hideHorizontalScrollBar(),this.scenegraph.tableGroup.border.setAttribute("visible",!1),n==null?void 0:n.disableBackground){const b=this.scenegraph.getCell(t,e);g=b.attribute.fill,b.setAttribute("fill","transparent")}if(n!=null&&n.disableBorder){const b=this.scenegraph.getCell(t,e);p=b.attribute.stroke,b.setAttribute("stroke",!1)}this.scenegraph.renderSceneGraph();let v=0;this.theme.cellBorderClipDirection==="bottom-right"&&(v=1);const m=this.scenegraph.stage.toCanvas(!1,new Gt().set(u.left+this.tableX+1,u.top+this.tableY+1,u.right+this.tableX-v,u.bottom+this.tableY-v));return a||(this.setScrollTop(h),this.setScrollLeft(d)),this.scenegraph.tableGroup.border.setAttribute("visible",!0),g&&this.scenegraph.getCell(t,e).setAttribute("fill",g),p&&this.scenegraph.getCell(t,e).setAttribute("stroke",p),((l=(s=this.stateManager.select)===null||s===void 0?void 0:s.ranges)===null||l===void 0?void 0:l.length)>0&&bm(this.scenegraph),this.stateManager.updateHoverPos(c,f),this.scenegraph.updateNextFrame(),m.toDataURL()}exportCellRangeImg(t){var e,n,o,r;const{scrollTop:s,scrollLeft:l}=this,a=Math.min(t.start.col,t.end.col),h=Math.min(t.start.row,t.end.row),d=Math.max(t.start.col,t.end.col),u=Math.max(t.start.row,t.end.row),c=this.cellIsInVisualView(a,h),f=this.cellIsInVisualView(d,u);c&&f||this.scrollToCell({col:a,row:h});const g=this.getCellRangeRelativeRect({start:{col:a,row:h},end:{col:d,row:u}});((n=(e=this.stateManager.select)===null||e===void 0?void 0:e.ranges)===null||n===void 0?void 0:n.length)>0&&mm(this.scenegraph);const{col:p,row:v}=this.stateManager.hover.cellPos;this.stateManager.updateHoverPos(-1,-1),this.scenegraph.component.hideVerticalScrollBar(),this.scenegraph.component.hideHorizontalScrollBar(),this.scenegraph.renderSceneGraph();const m=this.scenegraph.stage.toCanvas(!1,new Gt().set(g.left+this.tableX+1,g.top+this.tableY+1,g.right+this.tableX,g.bottom+this.tableY)).toDataURL();return c&&f||(this.setScrollTop(s),this.setScrollLeft(l)),((r=(o=this.stateManager.select)===null||o===void 0?void 0:o.ranges)===null||r===void 0?void 0:r.length)>0&&bm(this.scenegraph),this.stateManager.updateHoverPos(p,v),m}exportCanvas(){return this.scenegraph.stage.toCanvas()}getImageBuffer(t="image/png"){if(this.options.mode!=="node")return;this.render();const e=this.scenegraph.stage;if(e){const n=this.tableX+this.getAllColsWidth(),o=this.tableY+this.getAllRowsHeight();return n>=this.canvasWidth&&o>=this.canvasHeight?(e.render(),e.window.getImageBuffer(t)):this.scenegraph.stage.toCanvas(!1,new Gt().set(0,0,Math.min(this.canvasWidth,n),Math.min(this.canvasHeight,o))).toBuffer(t)}return null}getBodyIndexByTableIndex(t,e){return{col:t-this.rowHeaderLevelCount,row:e-this.columnHeaderLevelCount}}getTableIndexByBodyIndex(t,e){return{col:t+this.rowHeaderLevelCount,row:e+this.columnHeaderLevelCount}}onVChartEvent(t,e,n){this._chartEventMap[t]||(this._chartEventMap[t]=[]),typeof e=="function"?this._chartEventMap[t].push({callback:e}):this._chartEventMap[t].push({callback:n,query:e})}offVChartEvent(t,e){this._chartEventMap[t]&&(this._chartEventMap[t]=e?this._chartEventMap[t].filter(n=>n.callback!==e):[])}_bindChartEvent(t){if(t)for(const e in this._chartEventMap)(this._chartEventMap[e]||[]).forEach(n=>{n.query?t.on(e,n.query,n.callback):t.on(e,n.callback)})}changeRecordOrder(t,e){}hasCustomCellStyle(t){var e;return(e=this.customCellStylePlugin)===null||e===void 0?void 0:e.hasCustomCellStyle(t)}registerCustomCellStyle(t,e){var n;(n=this.customCellStylePlugin)===null||n===void 0||n.registerCustomCellStyle(t,e)}arrangeCustomCellStyle(t,e,n){var o;(o=this.customCellStylePlugin)===null||o===void 0||o.arrangeCustomCellStyle(t,e,n)}isSeriesNumber(t,e){return this.internalProps.layoutMap.isSeriesNumber(t,e)}isHasSeriesNumber(){var t;return((t=this.internalProps.layoutMap)===null||t===void 0?void 0:t.leftRowSeriesNumberColumnCount)>0}get leftRowSeriesNumberCount(){var t,e;return(e=(t=this.internalProps.layoutMap)===null||t===void 0?void 0:t.leftRowSeriesNumberColumnCount)!==null&&e!==void 0?e:0}setMinMaxLimitWidth(t=!1){var e,n;const o=this.internalProps;for(let r=0;r<o.layoutMap.columnWidths.length;r++){if(this.internalProps._widthResizedColMap.has(r))continue;const{width:s,minWidth:l,maxWidth:a}=(n=(e=o.layoutMap.columnWidths)===null||e===void 0?void 0:e[r])!==null&&n!==void 0?n:{};t&&s&&(typeof s=="string"&&s!=="auto"||typeof s=="number"&&s>0)&&this._setColWidth(r,s),l&&(typeof l=="number"&&l>0||typeof l=="string")&&this.setMinColWidth(r,l),a&&(typeof a=="number"&&a>0||typeof a=="string")&&this.setMaxColWidth(r,a)}}setSortedIndexMap(t,e){var n;(n=this.dataSource)===null||n===void 0||n.setSortedIndexMap(t,e)}checkReactCustomLayout(){this.reactCustomLayout||(this.reactCustomLayout=new jH(this))}get bodyDomContainer(){return this.internalProps.bodyDomContainer}get headerDomContainer(){return this.internalProps.headerDomContainer}get frozenBodyDomContainer(){return this.internalProps.frozenBodyDomContainer}get frozenHeaderDomContainer(){return this.internalProps.frozenHeaderDomContainer}get rightFrozenBodyDomContainer(){return this.internalProps.rightFrozenBodyDomContainer}get rightFrozenHeaderDomContainer(){return this.internalProps.rightFrozenHeaderDomContainer}get frozenBottomDomContainer(){return this.internalProps.frozenBottomDomContainer}get bottomDomContainer(){return this.internalProps.bottomDomContainer}get rightFrozenBottomDomContainer(){return this.internalProps.rightFrozenBottomDomContainer}showMoverLine(t,e){this.scenegraph.component.showMoveCol(t,e,0),this.scenegraph.renderSceneGraph()}hideMoverLine(t,e){this.scenegraph.component.hideMoveCol(),this.scenegraph.renderSceneGraph()}disableScroll(){this.eventManager.disableScroll()}enableScroll(){this.eventManager.enableScroll()}getGroupTitleLevel(t,e){}scrollToRow(t,e){e?this.animationManager.scrollTo({row:t},e):this.scrollToCell({row:t})}scrollToCol(t,e){e?this.animationManager.scrollTo({col:t},e):this.scrollToCell({col:t})}scrollToCell(t,e){if(e)return void this.animationManager.scrollTo(t,e);const n=this.getDrawRange();if(O(t.col)&&t.col>=this.frozenColCount){const o=this.getFrozenColsWidth(),r=this.getColsWidth(0,t.col-1);this.scrollLeft=Math.min(r-o,this.getAllColsWidth()-n.width)}if(O(t.row)&&t.row>=this.frozenRowCount){const o=this.getFrozenRowsHeight(),r=this.getRowsHeight(0,t.row-1);this.scrollTop=Math.min(r-o,this.getAllRowsHeight()-n.height)}this.render()}checkHasColumnAutoWidth(){return GH(this)}}const ug={},Wh={};function mz(i){if(Wh[i])return Wh[i]}function Nw(i,t,e){const n=i[t];return i[t]=e,n}function FO(i,t){return t!=null?Nw(ug,i,t):ug[i]}function zO(i,t){return t!=null?Nw(Wh,i,t):Wh[i]}const Nr=(i,t)=>Object.prototype.toString.call(i)===`[object ${t}]`,Vw=(i,t=!1)=>t?typeof i=="boolean":i===!0||i===!1||Nr(i,"Boolean"),bz=i=>typeof i=="function",Se=i=>i==null,te=i=>i!=null,Cz=i=>typeof i=="object"&&i!==null,_z=function(i){if(!Cz(i)||!Nr(i,"Object"))return!1;if(Object.getPrototypeOf(i)===null)return!0;let t=i;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(i)===t},Gw=(i,t=!1)=>{const e=typeof i;return t?e==="string":e==="string"||Nr(i,"String")},Oo=i=>Array.isArray?Array.isArray(i):Nr(i,"Array"),wz=function(i){return i!==null&&typeof i!="function"&&Number.isFinite(i.length)},jw=i=>Nr(i,"Date"),Ge=(i,t=!1)=>{const e=typeof i;return t?e==="number":e==="number"||Nr(i,"Number")};function Uw(i,t,e){let n;if(!te(i)||typeof i!="object"||t)return i;const o=Oo(i),r=i.length;n=o?new Array(r):typeof i=="object"?{}:Vw(i)||Ge(i)||Gw(i)?i:jw(i)?new Date(+i):void 0;const s=o?void 0:Object.keys(Object(i));let l=-1;if(n)for(;++l<(s||i).length;){const a=s?s[l]:l,h=i[a];n[a]=Uw(h,t)}return n}function $w(i,t,e=!1,n=!1){if(t){if(i===t)return;if(te(t)&&typeof t=="object"){const o=Object(t),r=[];for(const a in o)r.push(a);let{length:s}=r,l=-1;for(;s--;){const a=r[++l];!te(o[a])||typeof o[a]!="object"||n&&Oo(i[a])?Kw(i,a,o[a]):yz(i,t,a,e,n)}}}}function yz(i,t,e,n=!1,o=!1){const r=i[e],s=t[e];let l=t[e],a=!0;if(Oo(s)){if(n)l=[];else if(Oo(r))l=r;else if(wz(r)){l=new Array(r.length);let h=-1;const d=r.length;for(;++h<d;)l[h]=r[h]}}else _z(s)?(l=r??{},typeof r!="function"&&typeof r=="object"||(l={})):a=!1;a&&$w(l,s,n,o),Kw(i,e,l)}function Kw(i,t,e){(e!==void 0&&!Sz(i[t],e)||e===void 0&&!(t in i))&&(i[t]=e)}function Sz(i,t){return i===t||Number.isNaN(i)&&Number.isNaN(t)}function xz(i,...t){let e=-1;const n=t.length;for(;++e<n;)$w(i,t[e],!0);return i}function Rz(i){if(!i)return[];if(Object.keys)return Object.keys(i);const t=[];for(const e in i)i.hasOwnProperty(e)&&t.push(e);return t}function Az(i,t,e){const n=Rz(t);for(let o=0;o<n.length;o++){const r=n[o];(e?t[r]!=null:i[r]==null)&&(i[r]=t[r])}return i}function Yw(i,t,e=!0){if(i="prototype"in i?i.prototype:i,t="prototype"in t?t.prototype:t,Object.getOwnPropertyNames){const n=Object.getOwnPropertyNames(t);for(let o=0;o<n.length;o++){const r=n[o];r!=="constructor"&&(e?t[r]!=null:i[r]==null)&&(i[r]=t[r])}}else Az(i,t,e)}function Bz(i,t,e){te(t)||(t=i,i=0),te(e)||(e=1);let n=-1;const o=0|Math.max(0,Math.ceil((t-i)/e)),r=new Array(o);for(;++n<o;)r[n]=i+n*e;return r}function Mz(i,t){return i<t?-1:i>t?1:i>=t?0:NaN}function gs(i){return Number(i)}const Tz=typeof console<"u";function Yl(i,t,e){const n=[t].concat([].slice.call(e));Tz&&console[i].apply(console,n)}var Ei;(function(i){i[i.None=0]="None",i[i.Error=1]="Error",i[i.Warn=2]="Warn",i[i.Info=3]="Info",i[i.Debug=4]="Debug"})(Ei||(Ei={}));class Ne{static getInstance(t,e){return Ne._instance&&Ge(t)?Ne._instance.level(t):Ne._instance||(Ne._instance=new Ne(t,e)),Ne._instance}static setInstance(t){return Ne._instance=t}static setInstanceLevel(t){Ne._instance?Ne._instance.level(t):Ne._instance=new Ne(t)}static clearInstance(){Ne._instance=null}constructor(t=Ei.None,e){this._onErrorHandler=[],this._level=t,this._method=e}addErrorHandler(t){this._onErrorHandler.find(e=>e===t)||this._onErrorHandler.push(t)}removeErrorHandler(t){const e=this._onErrorHandler.findIndex(n=>n===t);e<0||this._onErrorHandler.splice(e,1)}callErrorHandler(...t){this._onErrorHandler.forEach(e=>e(...t))}canLogInfo(){return this._level>=Ei.Info}canLogDebug(){return this._level>=Ei.Debug}canLogError(){return this._level>=Ei.Error}canLogWarn(){return this._level>=Ei.Warn}level(t){return arguments.length?(this._level=+t,this):this._level}error(...t){var e;return this._level>=Ei.Error&&(this._onErrorHandler.length?this.callErrorHandler(...t):Yl((e=this._method)!==null&&e!==void 0?e:"error","ERROR",t)),this}warn(...t){return this._level>=Ei.Warn&&Yl(this._method||"warn","WARN",t),this}info(...t){return this._level>=Ei.Info&&Yl(this._method||"log","INFO",t),this}debug(...t){return this._level>=Ei.Debug&&Yl(this._method||"log","DEBUG",t),this}}Ne._instance=null;function Pz(i,t,e=0,n){for(Se(n)&&(n=i.length);e<n;){const o=e+n>>>1;Mz(i[o],t)>0?n=o:e=o+1}return e}const Hz=1e-10,kz=1e-10;function Xw(i,t,e=kz,n=Hz){const o=n,r=e*Math.max(i,t);return Math.abs(i-t)<=Math.max(o,r)}function sb(i,t,e,n){return i>t&&!Xw(i,t,e,n)}function lb(i,t,e,n){return i<t&&!Xw(i,t,e,n)}const cl=i=>{let t=null,e=null;return(...n)=>(t&&n.every((o,r)=>o===t[r])||(t=n,e=i(...n)),e)},qw=function(i,t,e){return i<t?t:i>e?e:i};function sf(i,t){let e;return i>t&&(e=i,i=t,t=e),n=>Math.max(i,Math.min(t,n))}function ra(i,t){return e=>i*(1-e)+t*e}function Ez(i,t){return function(e){return Math.round(i*(1-e)+t*e)}}function Lz(i,t){const e=i.valueOf(),n=t.valueOf(),o=new Date;return r=>(o.setTime(e*(1-r)+n*r),o)}function cg(i,t,e){t/=100,e/=100;const n=(1-Math.abs(2*e-1))*t,o=n*(1-Math.abs(i/60%2-1)),r=e-n/2;let s=0,l=0,a=0;return 0<=i&&i<60?(s=n,l=o,a=0):60<=i&&i<120?(s=o,l=n,a=0):120<=i&&i<180?(s=0,l=n,a=o):180<=i&&i<240?(s=0,l=o,a=n):240<=i&&i<300?(s=o,l=0,a=n):300<=i&&i<360&&(s=n,l=0,a=o),s=Math.round(255*(s+r)),l=Math.round(255*(l+r)),a=Math.round(255*(a+r)),{r:s,g:l,b:a}}function lf(i,t,e){i/=255,t/=255,e/=255;const n=Math.min(i,t,e),o=Math.max(i,t,e),r=o-n;let s=0,l=0,a=0;return s=r===0?0:o===i?(t-e)/r%6:o===t?(e-i)/r+2:(i-t)/r+4,s=Math.round(60*s),s<0&&(s+=360),a=(o+n)/2,l=r===0?0:r/(1-Math.abs(2*a-1)),l=+(100*l).toFixed(1),a=+(100*a).toFixed(1),{h:s,s:l,l:a}}const Fz=/^#([0-9a-f]{3,8})$/,ab={transparent:4294967040},sa={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Xl(i){return((i=Math.max(0,Math.min(255,Math.round(i)||0)))<16?"0":"")+i.toString(16)}function Zw(i){return Ge(i)?new Ue(i>>16,i>>8&255,255&i,1):Oo(i)?new Ue(i[0],i[1],i[2]):new Ue(255,255,255)}function zz(i){return Ge(i)?new Ue(i>>>24,i>>>16&255,i>>>8&255,255&i):Oo(i)?new Ue(i[0],i[1],i[2],i[3]):new Ue(255,255,255,1)}function gu(i){return i<.04045?.0773993808*i:Math.pow(.9478672986*i+.0521327014,2.4)}function fu(i){return i<.0031308?12.92*i:1.055*Math.pow(i,.41666)-.055}const hb=(i,t)=>{const e=Fz.exec(i);if(t||e){const n=parseInt(e[1],16),o=e[1].length;return o===3?new Ue((n>>8&15)+((n>>8&15)<<4),(n>>4&15)+((n>>4&15)<<4),(15&n)+((15&n)<<4),1):o===6?Zw(n):o===8?new Ue(n>>24&255,n>>16&255,n>>8&255,(255&n)/255):null}};class Fi{static Brighter(t,e=1){return e===1?t:new Fi(t).brighter(e).toRGBA()}static SetOpacity(t,e=1){return e===1?t:new Fi(t).setOpacity(e).toRGBA()}static getColorBrightness(t,e="hsl"){const n=t instanceof Fi?t:new Fi(t);switch(e){case"hsv":default:return n.getHSVBrightness();case"hsl":return n.getHSLBrightness();case"lum":return n.getLuminance();case"lum2":return n.getLuminance2();case"lum3":return n.getLuminance3()}}static parseColorString(t){if(te(ab[t]))return zz(ab[t]);if(te(sa[t]))return Zw(sa[t]);const e=`${t}`.trim().toLowerCase(),n=hb(e);if(n!==void 0)return n;if(/^(rgb|RGB|rgba|RGBA)/.test(e)){const o=e.replace(/(?:\(|\)|rgba|RGBA|rgb|RGB)*/g,"").split(",");return new Ue(parseInt(o[0],10),parseInt(o[1],10),parseInt(o[2],10),parseFloat(o[3]))}if(/^(hsl|HSL|hsla|HSLA)/.test(e)){const o=e.replace(/(?:\(|\)|hsla|HSLA|hsl|HSL)*/g,"").split(","),r=cg(parseInt(o[0],10),parseInt(o[1],10),parseInt(o[2],10));return new Ue(r.r,r.g,r.b,parseFloat(o[3]))}}constructor(t){const e=Fi.parseColorString(t);e?this.color=e:(console.warn(`Warn: 传入${t}无法解析为Color`),this.color=new Ue(255,255,255))}toRGBA(){return this.color.formatRgb()}toString(){return this.color.formatRgb()}toHex(){return this.color.formatHex()}toHsl(){return this.color.formatHsl()}brighter(t){const{r:e,g:n,b:o}=this.color;return this.color.r=Math.max(0,Math.min(255,Math.floor(e*t))),this.color.g=Math.max(0,Math.min(255,Math.floor(n*t))),this.color.b=Math.max(0,Math.min(255,Math.floor(o*t))),this}add(t){const{r:e,g:n,b:o}=this.color;return this.color.r+=Math.min(255,e+t.color.r),this.color.g+=Math.min(255,n+t.color.g),this.color.b+=Math.min(255,o+t.color.b),this}sub(t){return this.color.r=Math.max(0,this.color.r-t.color.r),this.color.g=Math.max(0,this.color.g-t.color.g),this.color.b=Math.max(0,this.color.b-t.color.b),this}multiply(t){const{r:e,g:n,b:o}=this.color;return this.color.r=Math.max(0,Math.min(255,Math.floor(e*t.color.r))),this.color.g=Math.max(0,Math.min(255,Math.floor(n*t.color.g))),this.color.b=Math.max(0,Math.min(255,Math.floor(o*t.color.b))),this}getHSVBrightness(){return Math.max(this.color.r,this.color.g,this.color.b)/255}getHSLBrightness(){return .5*(Math.max(this.color.r,this.color.g,this.color.b)/255+Math.min(this.color.r,this.color.g,this.color.b)/255)}setHsl(t,e,n){const o=this.color.opacity,r=lf(this.color.r,this.color.g,this.color.b),s=cg(Se(t)?r.h:qw(t,0,360),Se(e)?r.s:e>=0&&e<=1?100*e:e,Se(n)?r.l:n<=1&&n>=0?100*n:n);return this.color=new Ue(s.r,s.g,s.b,o),this}setRGB(t,e,n){return!Se(t)&&(this.color.r=t),!Se(e)&&(this.color.g=e),!Se(n)&&(this.color.b=n),this}setHex(t){const e=`${t}`.trim().toLowerCase(),n=hb(e,!0);return n??this}setColorName(t){const e=sa[t.toLowerCase()];return e!==void 0?this.setHex(e):console.warn("THREE.Color: Unknown color "+t),this}setScalar(t){return this.color.r=t,this.color.g=t,this.color.b=t,this}setOpacity(t=1){return this.color.opacity=t,this}getLuminance(){return(.2126*this.color.r+.7152*this.color.g+.0722*this.color.b)/255}getLuminance2(){return(.2627*this.color.r+.678*this.color.g+.0593*this.color.b)/255}getLuminance3(){return(.299*this.color.r+.587*this.color.g+.114*this.color.b)/255}clone(){return new Fi(this.color.toString())}copyGammaToLinear(t,e=2){return this.color.r=Math.pow(t.color.r,e),this.color.g=Math.pow(t.color.g,e),this.color.b=Math.pow(t.color.b,e),this}copyLinearToGamma(t,e=2){const n=e>0?1/e:1;return this.color.r=Math.pow(t.color.r,n),this.color.g=Math.pow(t.color.g,n),this.color.b=Math.pow(t.color.b,n),this}convertGammaToLinear(t){return this.copyGammaToLinear(this,t),this}convertLinearToGamma(t){return this.copyLinearToGamma(this,t),this}copySRGBToLinear(t){return this.color.r=gu(t.color.r),this.color.g=gu(t.color.g),this.color.b=gu(t.color.b),this}copyLinearToSRGB(t){return this.color.r=fu(t.color.r),this.color.g=fu(t.color.g),this.color.b=fu(t.color.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}}class Ue{constructor(t,e,n,o){this.r=isNaN(+t)?255:Math.max(0,Math.min(255,+t)),this.g=isNaN(+e)?255:Math.max(0,Math.min(255,+e)),this.b=isNaN(+n)?255:Math.max(0,Math.min(255,+n)),te(o)?this.opacity=isNaN(+o)?1:Math.max(0,Math.min(1,+o)):this.opacity=1}formatHex(){return`#${Xl(this.r)+Xl(this.g)+Xl(this.b)+(this.opacity===1?"":Xl(255*this.opacity))}`}formatRgb(){const t=this.opacity;return`${t===1?"rgb(":"rgba("}${this.r},${this.g},${this.b}${t===1?")":`,${t})`}`}formatHsl(){const t=this.opacity,{h:e,s:n,l:o}=lf(this.r,this.g,this.b);return`${t===1?"hsl(":"hsla("}${e},${n}%,${o}%${t===1?")":`,${t})`}`}toString(){return this.formatHex()}}function Iz(i){let t="",e="",n="";const o=i[0]==="#"?1:0;for(let r=o;r<i.length;r++)i[r]!=="#"&&(r<o+2?t+=i[r]:r<o+4?e+=i[r]:r<o+6&&(n+=i[r]));return[parseInt(t,16),parseInt(e,16),parseInt(n,16)]}function Oz(i,t,e){return Number((1<<24)+(i<<16)+(t<<8)+e).toString(16).slice(1)}function Dz(i,t){const e=i.r,n=t.r,o=i.g,r=t.g,s=i.b,l=t.b,a=i.opacity,h=t.opacity;return d=>{const u=Math.round(e*(1-d)+n*d),c=Math.round(o*(1-d)+r*d),f=Math.round(s*(1-d)+l*d);return new Ue(u,c,f,a*(1-d)+h*d)}}const Wz=Object.freeze(Object.defineProperty({__proto__:null,Color:Fi,DEFAULT_COLORS:sa,RGB:Ue,hexToRgb:Iz,hslToRgb:cg,interpolateRgb:Dz,rgbToHex:Oz,rgbToHsl:lf},Symbol.toStringTag,{value:"Module"}));function Nz(i){try{return i instanceof Element}catch{const e=["children","innerHTML","classList","setAttribute","tagName","getBoundingClientRect"],n=Object.keys(i);return e.every(o=>n.includes(o))}}const Vz=(i,t)=>{var e,n;if(!(t!=null&&t.fields)||i.length===0)return i;const o=t.fields,r=i[0],s={},l=[];for(const a in o)if(Object.prototype.hasOwnProperty.call(o,a)){const h=o[a];if(!h.type){let u=r;a in r||(u=(e=i.find(c=>a in c))!==null&&e!==void 0?e:r),h.type=typeof u[a]=="number"?"linear":"ordinal"}let d;if(typeof h.sortIndex=="number"&&(d={key:a,type:h.type,index:h.sortIndex,sortIndex:{},sortIndexCount:0,sortReverse:h.sortReverse===!0},l.push(d)),((n=h.domain)===null||n===void 0?void 0:n.length)>0)if(h.type==="ordinal"){h._domainCache={},s[a]=h;const u={};h.domain.forEach((c,f)=>{u[c]=f,h._domainCache[c]=f}),d&&(d.sortIndex=u,d.sortIndexCount=h.domain.length)}else h.domain.length>=2&&(s[a]=h)}return Object.keys(s).length>0&&(i=i.filter(a=>{for(const h in s){const d=s[h];if(d.type==="ordinal"){if(!(a[h]in d._domainCache))return!1}else if(d.domain[0]>a[h]||d.domain[1]<a[h])return!1}return!0})),l.sort((a,h)=>a.index-h.index),i.sort((a,h)=>Gz(a,h,l)),i};function Gz(i,t,e){for(let n=0;n<e.length;n++){const o=e[n];let r=0;if(o.type==="ordinal"?(o.sortIndex[t[o.key]]===void 0&&(o.sortIndex[t[o.key]]=o.sortIndexCount++),o.sortIndex[i[o.key]]===void 0&&(o.sortIndex[i[o.key]]=o.sortIndexCount++),r=o.sortIndex[i[o.key]]-o.sortIndex[t[o.key]]):o.type==="linear"&&(r=i[o.key]-t[o.key]),o.sortReverse&&(r=-r),r!==0)return r}return 0}let pu=0;const jz=1e8;function Jw(i="dataset"){return pu>jz&&(pu=0),i+"_"+pu++}class Uz{constructor(t){var e;let n;this.options=t,this.isDataSet=!0,this.transformMap={},this.parserMap={},this.dataViewMap={},this.target=new Lr,n=t!=null&&t.name?t.name:Jw("dataset"),this.name=n,this._logger=(e=t==null?void 0:t.logger)!==null&&e!==void 0?e:Ne.getInstance()}setLogger(t){this._logger=t}getDataView(t){return this.dataViewMap[t]}setDataView(t,e){var n;this.dataViewMap[t]&&((n=this._logger)===null||n===void 0||n.error(`Error: dataView ${t} 之前已存在，请重新命名`)),this.dataViewMap[t]=e}removeDataView(t){this.dataViewMap[t]=null,delete this.dataViewMap[t]}registerParser(t,e){var n;this.parserMap[t]&&((n=this._logger)===null||n===void 0||n.warn(`Warn: transform ${t} 之前已注册，执行覆盖逻辑`)),this.parserMap[t]=e}removeParser(t){this.parserMap[t]=null,delete this.parserMap[t]}getParser(t){return this.parserMap[t]||this.parserMap.default}registerTransform(t,e){var n;this.transformMap[t]&&((n=this._logger)===null||n===void 0||n.warn(`Warn: transform ${t} 之前已注册，执行覆盖逻辑`)),this.transformMap[t]=e}removeTransform(t){this.transformMap[t]=null,delete this.transformMap[t]}getTransform(t){return this.transformMap[t]}multipleDataViewAddListener(t,e,n){this._callMap||(this._callMap=new Map);let o=this._callMap.get(n);o||(o=()=>{t.some(r=>r.isRunning)||n()}),t.forEach(r=>{r.target.addListener(e,o)}),this._callMap.set(n,o)}allDataViewAddListener(t,e){this.multipleDataViewAddListener(Object.values(this.dataViewMap),t,e)}multipleDataViewRemoveListener(t,e,n){if(this._callMap){const o=this._callMap.get(n);o&&t.forEach(r=>{r.target.removeListener(e,o)}),this._callMap.delete(n)}}multipleDataViewUpdateInParse(t){t.forEach(e=>{var n;return(n=this.getDataView(e.name))===null||n===void 0?void 0:n.markRunning()}),t.forEach(e=>{var n;return(n=this.getDataView(e.name))===null||n===void 0?void 0:n.parseNewData(e.data,e.options)})}multipleDataViewUpdateInRawData(t){t.forEach(e=>{var n;return(n=this.getDataView(e.name))===null||n===void 0?void 0:n.markRunning()}),t.forEach(e=>{var n;return(n=this.getDataView(e.name))===null||n===void 0?void 0:n.updateRawData(e.data,e.options)})}destroy(){this.transformMap=null,this.parserMap=null,this.dataViewMap=null,this._callMap=null,this.target.removeAllListeners()}}const vu="_data-view-diff-rank";class Bd{constructor(t,e){let n;this.dataSet=t,this.options=e,this.isDataView=!0,this.target=new Lr,this.parseOption=null,this.transformsArr=[],this.isRunning=!1,this.rawData={},this.history=!1,this.parserData={},this.latestData={},this._fields=null,this.reRunAllTransform=(o={pushHistory:!0,emitMessage:!0})=>(this.isRunning=!0,this.resetTransformData(),this.transformsArr.forEach(r=>{this.executeTransform(r,{pushHistory:o.pushHistory,emitMessage:!1}),this.isLastTransform(r)&&this.diffLastData()}),this.isRunning=!1,o.emitMessage!==!1&&this.target.emit("change",[]),this),this.markRunning=()=>{this.isRunning=!0,this.target.emit("markRunning",[])},n=e!=null&&e.name?e.name:Jw("dataview"),this.name=n,e!=null&&e.history&&(this.history=e.history,this.historyData=[]),this.dataSet.setDataView(n,this),this.setFields(e==null?void 0:e.fields)}parse(t,e,n=!1){var o;this.isRunning=!0,n&&this.target.emit("beforeParse",[]),e&&(this.parseOption=e);const r=this.cloneParseData(t,e);if(e!=null&&e.type){const s=((o=this.dataSet.getParser(e.type))!==null&&o!==void 0?o:this.dataSet.getParser("bytejson"))(r,e.options,this);this.rawData=r,this.parserData=s,this.history&&this.historyData.push(r,s),this.latestData=s}else this.parserData=r,this.rawData=r,this.history&&this.historyData.push(r),this.latestData=r;return this.isRunning=!1,n&&this.target.emit("afterParse",[]),this}transform(t,e=!0){if(this.isRunning=!0,t&&t.type){let n=!0;if(t.type==="fields"){this._fields=t.options.fields;const o=this.transformsArr.findIndex(r=>r.type===t.type);o>=0&&(n=!1,this.transformsArr[o].options.fields=this._fields)}if(n&&this.transformsArr.push(t),e){const o=this.isLastTransform(t);this.executeTransform(t),o&&this.diffLastData()}}return this.sortTransform(),this.isRunning=!1,this}isLastTransform(t){return this.transformsArr[this.transformsArr.length-1]===t}sortTransform(){this.transformsArr.length>=2&&this.transformsArr.sort((t,e)=>{var n,o;return((n=t.level)!==null&&n!==void 0?n:0)-((o=e.level)!==null&&o!==void 0?o:0)})}executeTransform(t,e={pushHistory:!0,emitMessage:!0}){const{pushHistory:n,emitMessage:o}=e,r=this.dataSet.getTransform(t.type)(this.latestData,t.options);this.history&&n!==!1&&this.historyData.push(r),this.latestData=r,o!==!1&&this.target.emit("change",[])}resetTransformData(){this.latestData=this.parserData,this.history&&(this.historyData.length=0,this.historyData.push(this.rawData,this.parserData))}enableDiff(t){this._diffData=!0,this._diffKeys=t,this._diffMap=new Map,this._diffRank=0}disableDiff(){this._diffData=!1,this._diffMap=null,this._diffRank=null}resetDiff(){this._diffMap=new Map,this._diffRank=0}diffLastData(){var t;if(!this._diffData||!this.latestData.forEach||!(!((t=this._diffKeys)===null||t===void 0)&&t.length))return;const e=this._diffRank+1;if(this._diffRank===0)this.latestData.forEach(n=>{n[vu]=e,this._diffMap.set(this._diffKeys.reduce((o,r)=>o+n[r],""),n)}),this.latestDataAUD={add:Array.from(this.latestData),del:[],update:[]};else{let n;this.latestDataAUD={add:[],del:[],update:[]},this.latestData.forEach(o=>{o[vu]=e,n=this._diffKeys.reduce((r,s)=>r+o[s],""),this._diffMap.get(n)?this.latestDataAUD.update.push(o):this.latestDataAUD.add.push(o),this._diffMap.set(n,o)}),this._diffMap.forEach((o,r)=>{o[vu]<e&&(this.latestDataAUD.del.push(o),this._diffMap.delete(r))})}this._diffRank=e}cloneParseData(t,e){let n=!1;return t instanceof Bd||(e==null?void 0:e.clone)!==!0||(n=!0),n?Uw(t):t}parseNewData(t,e){this.parse(t,e||this.parseOption),this.reRunAllTransform()}updateRawData(t,e){const n=this.cloneParseData(t,e);this.rawData=n,this.parserData=n,this.latestData=n,this.reRunAllTransform()}getFields(){var t;return this._fields?this._fields:((t=this.parseOption)===null||t===void 0?void 0:t.type)==="dataview"&&this.rawData.length===1&&this.rawData[0].getFields?this.rawData[0].getFields():null}setFields(t,e=!1){this._fields=t&&e?xz({},this._fields,t):t;const n=this.transformsArr.find(o=>o.type==="fields");!Se(this._fields)&&Se(n)?(this.dataSet.registerTransform("fields",Vz),this.transform({type:"fields",options:{fields:this._fields}},!1)):n&&(n.options.fields=this._fields)}destroy(){this.dataSet.removeDataView(this.name),this._diffMap=null,this._diffRank=null,this.latestData=null,this.rawData=null,this.parserData=null,this.transformsArr=null,this.target=null}}function $z(i){return i instanceof Bd}function bo(i,t=["data"]){const e=i;let n;if(!te(e)||typeof e!="object"||$z(e)||Nz(e))return e;const o=Oo(e),r=e.length;n=o?new Array(r):typeof e=="object"?{}:Vw(e)||Ge(e)||Gw(e)?e:jw(e)?new Date(+e):void 0;const s=o?void 0:Object.keys(Object(e));let l=-1;if(n)for(;++l<(s||e).length;){const a=s?s[l]:l,h=e[a];t!=null&&t.includes(a.toString())?n[a]=h:n[a]=bo(h,t)}return n}function Qw(i){var t,e;const n=Object.assign({},i);return wt(i.style)||(n.textStyle=le(i.style)),wt(i.textStyle)||rt(n.textStyle,le(i.textStyle)),!((t=i.shape)===null||t===void 0)&&t.style&&le(n.shape.style),!((e=i.background)===null||e===void 0)&&e.style&&le(n.background.style),n}function le(i){return wt(i)||i.angle&&(i.angle=To(i.angle)),i}function zi(i={}){return wt(i.style)||(i.style=le(i.style)),wt(i.state)||Object.keys(i.state).forEach(t=>{wt(i.state[t])||(i.state[t]=le(i.state[t]))}),i}function so(i){return wt(i)?null:(Object.keys(i).forEach(t=>{wt(i[t])||(i[t]=le(i[t]))}),i)}function Kz(i){return zi(i),zi(i.startSymbol),zi(i.endSymbol),i}const Yz={left:{textAlign:"center",textBaseline:"bottom"},right:{textAlign:"center",textBaseline:"bottom"},radius:{},angle:{}},Cr="PingFang SC,Microsoft Yahei,system-ui,-apple-system,segoe ui,Roboto,Helvetica,Arial,sans-serif, apple color emoji,segoe ui emoji,segoe ui symbol",Ji=14,fs={LABEL_FONT_SIZE:14,AXIS_TICK_SIZE:4},Nh={domainLine:{visible:!0,style:{lineWidth:1,stroke:"#D9DDE4",strokeOpacity:1}},grid:{visible:!0,style:{lineWidth:1,stroke:"#EBEDF2",strokeOpacity:1,lineDash:[]}},subGrid:{visible:!1,style:{lineWidth:1,stroke:"#EBEDF2",strokeOpacity:1,lineDash:[4,4]}},tick:{visible:!0,tickSize:fs.AXIS_TICK_SIZE,style:{lineWidth:1,stroke:"#D9DDE4",strokeOpacity:1}},subTick:{visible:!1,tickSize:fs.AXIS_TICK_SIZE/2,style:{lineWidth:1,stroke:"#D9DDE4",strokeOpacity:1}},label:{visible:!0,space:1,style:{fontSize:fs.LABEL_FONT_SIZE,fill:"#89909D",fontWeight:"normal",fillOpacity:1},autoLimit:!0},title:{space:10,style:{fontSize:fs.LABEL_FONT_SIZE,fill:"#333333",fontWeight:"normal",fillOpacity:1}}};function Xz(i){var t,e;return!((e=(t=i==null?void 0:i.colorScheme)===null||t===void 0?void 0:t.default)===null||e===void 0)&&e.palette?rt({},Nh,{tick:{style:{stroke:i.colorScheme.default.palette.axisDomainColor||"#D9DDE4"}},subTick:{style:{stroke:i.colorScheme.default.palette.axisDomainColor||"#D9DDE4"}},label:{style:{fill:i.colorScheme.default.palette.axisLabelFontColor||"#89909D"}},title:{style:{fill:i.colorScheme.default.palette.secondaryFontColor||"#333333"}}}):Nh}function db(i){var t,e,n,o,r,s,l,a,h,d,u,c,f;const g=rt({},i);let p,v=(e=(t=g.title)===null||t===void 0?void 0:t.angle)!==null&&e!==void 0?e:0;g.orient!=="left"&&g.orient!=="right"||!((n=g.title)===null||n===void 0)&&n.autoRotate&&Pt(g.title.angle)&&(v=g.orient==="left"?-90:90,p=Yz[g.orient]);const m=Hy(g.label,["style","formatMethod","state"]);return{orient:g.orient,select:g.select,hover:g.hover,line:Kz(g.domainLine),label:Object.assign({style:le(g.label.style),formatMethod:g.label.formatMethod?(b,C,_)=>g.label.formatMethod(C.rawValue,C):null,state:so(g.label.state)},m),tick:{visible:g.tick.visible,length:g.tick.tickSize,inside:g.tick.inside,alignWithLabel:g.tick.alignWithLabel,style:le(g.tick.style),state:so(g.tick.state),dataFilter:g.tick.dataFilter},subTick:{visible:g.subTick.visible,length:g.subTick.tickSize,inside:g.subTick.inside,count:g.subTick.tickCount,style:le(g.subTick.style),state:so(g.subTick.state)},grid:{type:"line",visible:g.grid.visible,alternateColor:g.grid.alternateColor,alignWithLabel:g.grid.alignWithLabel,style:le(g.grid.style)},subGrid:{type:"line",visible:g.subGrid.visible,alternateColor:g.subGrid.alternateColor,style:le(g.subGrid.style)},title:{visible:g.title.visible,position:g.title.position,space:g.title.space,autoRotate:!1,angle:v?To(v):null,textStyle:rt({},p,le(g.title.style)),padding:g.title.padding,shape:{visible:(o=g.title.shape)===null||o===void 0?void 0:o.visible,space:(r=g.title.shape)===null||r===void 0?void 0:r.space,style:le((s=g.title.shape)===null||s===void 0?void 0:s.style)},background:{visible:(l=g.title.background)===null||l===void 0?void 0:l.visible,style:le((a=g.title.background)===null||a===void 0?void 0:a.style)},state:{text:so(g.title.state),shape:so((h=g.title.shape)===null||h===void 0?void 0:h.state),background:so((d=g.title.background)===null||d===void 0?void 0:d.state)}},panel:{visible:(u=g.background)===null||u===void 0?void 0:u.visible,style:le((c=g.background)===null||c===void 0?void 0:c.style),state:so((f=g.background)===null||f===void 0?void 0:f.state)}}}const ub="NO_AXISID_FRO_VTABLE";function IO(i,t,e){var n,o;const r=e.getCellHeaderPaths(i,t);let s;if(e.indicatorsAsCol){const a=(n=r.colHeaderPaths.find(h=>h.indicatorKey))===null||n===void 0?void 0:n.indicatorKey;s=e.columnObjects.find(h=>h.indicatorKey===a)}else{const a=(o=r.rowHeaderPaths.find(h=>h.indicatorKey))===null||o===void 0?void 0:o.indicatorKey;s=e.columnObjects.find(h=>h.indicatorKey===a)}const l=s==null?void 0:s.chartSpec;return typeof l=="function"?l({col:i,row:t,dataValue:e._table.getCellOriginValue(i,t)||"",value:e._table.getCellValue(i,t)||"",rect:e._table.getCellRangeRelativeRect(e._table.getCellRange(i,t)),table:e._table}):l}function OO(i,t,e){var n,o;const r=e.getCellHeaderPaths(i,t);let s;if(e.indicatorsAsCol){const l=(n=r.colHeaderPaths.find(a=>a.indicatorKey))===null||n===void 0?void 0:n.indicatorKey;s=e.columnObjects.find(a=>a.indicatorKey===l)}else{const l=(o=r.rowHeaderPaths.find(a=>a.indicatorKey))===null||o===void 0?void 0:o.indicatorKey;s=e.columnObjects.find(a=>a.indicatorKey===l)}return typeof(s==null?void 0:s.chartSpec)!="function"}function DO(i,t,e){var n,o;const r=e.getCellHeaderPaths(i,t);let s;if(e.indicatorsAsCol){const l=(n=r.colHeaderPaths.find(a=>a.indicatorKey))===null||n===void 0?void 0:n.indicatorKey;s=e.columnObjects.find(a=>a.indicatorKey===l)}else{const l=(o=r.rowHeaderPaths.find(a=>a.indicatorKey))===null||o===void 0?void 0:o.indicatorKey;s=e.columnObjects.find(a=>a.indicatorKey===l)}return s==null?void 0:s.noDataRenderNothing}function WO(i){let t=!1;for(let e=0;e<i.length;e++){const n=i[e];if(n.chartSpec&&n.chartSpec.type!=="wordCloud"&&n.chartSpec.type!=="radar"&&n.chartSpec.type!=="gauge"&&n.chartSpec.type!=="pie"&&n.chartSpec.type!=="funnel"&&n.chartSpec.type!=="rose"){t=!0;break}}return t}function NO(i,t,e){let n=!0;const o=e.getRawChartSpec(i,t);return o&&o.type!=="pie"&&o.type!=="radar"&&o.type!=="gauge"&&o.type!=="wordCloud"&&o.type!=="funnel"&&o.type!=="rose"||(n=!1),n}function VO(i,t,e,n){let o=!1;if(n.indicatorsAsCol&&e==="row"||!n.indicatorsAsCol&&e==="col")for(let r=0;r<n.indicatorsDefine.length;r++){const s=n.indicatorsDefine[r];if(s.chartSpec&&s.chartSpec.type!=="pie"&&s.chartSpec.type!=="wordCloud"&&s.chartSpec.type!=="radar"&&s.chartSpec.type!=="gauge"&&s.chartSpec.type!=="funnel"&&s.chartSpec.type!=="rose"){o=!0;break}}else{const r=n.getRawChartSpec(i,t);r?r.type!=="pie"&&r.type!=="radar"&&r.type!=="gauge"&&r.type!=="wordCloud"&&r.type!=="funnel"&&r.type!=="rose"&&(o=!0):o=!1}return o}function GO(i,t,e){let n=e.getRawChartSpec(i,t);return n?(e._table.isPivotChart()&&(n=bo(n),n.sortDataByAxis=!0,Q(n.series)&&n.series.forEach(o=>{o.sortDataByAxis=!0}),n.type!=="gauge"&&n.type!=="rose"&&n.type!=="radar"&&(n.axes=e.getChartAxes(i,t)),n.padding=0,n.dataZoom=[]),n):null}function jO(i,t,e){var n,o,r;const s=[];if(e.indicatorsAsCol){const l=e.getIndicatorKeyInChartSpec(i,t),a=e.getColKeysPath(i,t);l.forEach((v,m)=>{const{range:b,targetTicks:C,targetRange:_,axisOption:w}=nb(i,t,m,m===0?"bottom":"top",m===0?"top":"bottom",l,a,e);Z(w==null?void 0:w.min)&&(b.min=w.min),Z(w==null?void 0:w.max)&&(b.max=w.max),cb(w,s)||s.push(rt({range:b,label:{style:{fontSize:Ji}}},w,{type:(w==null?void 0:w.type)||"linear",orient:m===0?"bottom":"top",label:{visible:!1,flush:!0},title:{visible:!1},domainLine:{visible:!1},seriesIndex:w!=null&&w.seriesId?void 0:m,tick:{tickMode:ar(C,_,b,m)},sync:{axisId:ub}}))});let h=e.getDimensionKeyInChartSpec(e.rowHeaderLevelCount,t);Q(h)&&(h=h[0]);const d=e.dataset.cacheCollectedValues[h]||e.dataset.collectedValues[h]||[],u=e.getRowKeysPath(i,t),c=d[u??""],{axisOption:f,isPercent:g,chartType:p}=Er(i,t,"left",e);s.push(rt({domain:(f==null?void 0:f.type)!=="linear"||Array.isArray(c)?Array.from(c??[]):void 0,range:(f==null?void 0:f.type)!=="linear"||Array.isArray(c)?void 0:c,label:{style:{fontSize:Ji}}},f,{type:(n=f==null?void 0:f.type)!==null&&n!==void 0?n:"band",orient:"left",label:{visible:!1},domainLine:{visible:!1},tick:{visible:!1},subTick:{visible:!1},title:{visible:!1}}))}else{const l=e.getIndicatorKeyInChartSpec(i,t),a=e.getRowKeysPath(i,t);l.forEach((v,m)=>{const{range:b,targetTicks:C,targetRange:_,axisOption:w}=nb(i,t,m,m===0?"left":"right",m===0?"right":"left",l,a,e);Z(w==null?void 0:w.min)&&(b.min=w.min),Z(w==null?void 0:w.max)&&(b.max=w.max),cb(w,s)||s.push(rt({range:b,label:{style:{fontSize:Ji}}},w,{type:(w==null?void 0:w.type)||"linear",orient:m===0?"left":"right",label:{visible:!1,flush:!0},title:{visible:!1},domainLine:{visible:!1},seriesIndex:w!=null&&w.seriesId?void 0:m,tick:{tickMode:ar(C,_,b,m)},sync:{axisId:ub}}))});let h=e.getDimensionKeyInChartSpec(i,e.columnHeaderLevelCount);Q(h)&&(h=h[0]);const d=e.dataset.cacheCollectedValues[h]||e.dataset.collectedValues[h]||[],u=e.getColKeysPath(i,t),c=(o=d==null?void 0:d[u??""])!==null&&o!==void 0?o:[],{axisOption:f,isPercent:g,chartType:p}=Er(i,t,"bottom",e);s.push(rt({domain:(f==null?void 0:f.type)!=="linear"||Array.isArray(c)?Array.from(c??[]):void 0,range:(f==null?void 0:f.type)!=="linear"||Array.isArray(c)?void 0:c,label:{style:{fontSize:Ji}}},f,{type:(r=f==null?void 0:f.type)!==null&&r!==void 0?r:"band",orient:"bottom",visible:!0,label:{visible:!1},domainLine:{visible:!1},tick:{visible:!1},subTick:{visible:!1},title:{visible:!1}}))}return s}function qz(i,t,e){var n;const o=e.getRawChartSpec(i,t);if(o!=null&&o.series){const r={};return!((n=o.data)===null||n===void 0)&&n.id&&(r[o.data.id]=void 0),o==null||o.series.forEach(s=>{var l,a,h,d,u,c,f,g,p,v,m;if(!(!((l=s.data)===null||l===void 0)&&l.fromDataId))if(!((a=s.data)===null||a===void 0)&&a.transforms)r[(m=(p=(g=s.data)===null||g===void 0?void 0:g.id)!==null&&p!==void 0?p:(v=o.data)===null||v===void 0?void 0:v.id)!==null&&m!==void 0?m:"data"]=void 0;else{const b=s.direction==="horizontal"?s.xField:s.yField;r[(c=(d=(h=s.data)===null||h===void 0?void 0:h.id)!==null&&d!==void 0?d:(u=o.data)===null||u===void 0?void 0:u.id)!==null&&c!==void 0?c:"data"]=!((f=s.data)===null||f===void 0)&&f.id?b:void 0}}),r}return o.data.id}function Zz(i){let t=!1;for(let e=0;e<i.columnObjects.length;e++)if(i.columnObjects[e].chartSpec){t=!0;break}return t}function cb(i,t){return!!(i&&Q(i.seriesId)&&i.seriesId.length>0&&t.filter(e=>!(e.orient!==i.orient||!e.seriesId||e.seriesId.length!==i.seriesId.length||!e.seriesId.every((n,o)=>n===i.seriesId[o]))).length>0)}function Jz(i,t,e){var n,o,r;if(i===-1||t===-1)return{start:{col:i,row:t},end:{col:i,row:t}};if(e._cellRangeMap.has(`$${i}$${t}`))return e._cellRangeMap.get(`$${i}$${t}`);let s={start:{col:i,row:t},end:{col:i,row:t}};if(e.transpose)s=tI(i,t,e);else if(e.headerLevelCount<=t){if(e.headerLevelCount<=t&&(!((o=(n=e.columnObjects[i-e.leftRowSeriesNumberColumnCount])===null||n===void 0?void 0:n.define)===null||o===void 0)&&o.mergeCell)){const l=e._table.getCellValue(i,t);for(let a=t-1;a>=e.headerLevelCount;a--){const h=e._table.getCellValue(i,a);if(typeof e.columnObjects[i-e.leftRowSeriesNumberColumnCount].define.mergeCell=="boolean"){if(l!==h)break}else if(!e.columnObjects[i-e.leftRowSeriesNumberColumnCount].define.mergeCell(l,h,{source:{col:i,row:t},target:{col:i,row:a},table:e._table}))break;s.start.row=a}for(let a=t+1;a<e.rowCount;a++){const h=e._table.getCellValue(i,a);if(typeof e.columnObjects[i-e.leftRowSeriesNumberColumnCount].define.mergeCell=="boolean"){if(l!==h)break}else if(!e.columnObjects[i-e.leftRowSeriesNumberColumnCount].define.mergeCell(l,h,{source:{col:i,row:t},target:{col:i,row:a},table:e._table}))break;s.end.row=a}}Qz(i,t,s,e)}else{const l=e.getCellId(i,t);for(let a=i-1;a>=0&&l===e.getCellId(a,t);a--)s.start.col=a;for(let a=i+1;a<((r=e.colCount)!==null&&r!==void 0?r:0)&&l===e.getCellId(a,t);a++)s.end.col=a;for(let a=t-1;a>=0&&l===e.getCellId(i,a);a--)s.start.row=a;for(let a=t+1;a<e.headerLevelCount&&l===e.getCellId(i,a);a++)s.end.row=a}return e._cellRangeMap.set(`$${i}$${t}`,s),s}function Qz(i,t,e,n){var o;if(n.rowHierarchyType!=="tree")return;const r=n._table.getCellRawRecord(i,t);!((o=n._table.internalProps.rowSeriesNumber)===null||o===void 0)&&o.enableTreeCheckbox?r!=null&&r.vtableMerge&&i>=n.leftRowSeriesNumberColumnCount&&(e.start.col=n.rowHeaderLevelCount+n.leftRowSeriesNumberColumnCount,e.end.col=n.colCount-1,e.start.row=e.end.row=t):r!=null&&r.vtableMerge&&(e.start.col=n.rowHeaderLevelCount,e.end.col=n.colCount-1,e.start.row=e.end.row=t)}function tI(i,t,e){var n,o,r,s;const l={start:{col:i,row:t},end:{col:i,row:t}};if(e.headerLevelCount+e.leftRowSeriesNumberColumnCount<=i||i===-1&&t===-1){if(e.headerLevelCount+e.leftRowSeriesNumberColumnCount<=i&&(!((o=(n=e.columnObjects[t])===null||n===void 0?void 0:n.define)===null||o===void 0)&&o.mergeCell)){const h=e._table.getCellValue(i,t);for(let d=i-1;d>=e.headerLevelCount+e.leftRowSeriesNumberColumnCount;d--){const u=e._table.getCellValue(d,t);if(typeof e.columnObjects[t].define.mergeCell=="boolean"){if(h!==u)break}else if(!e.columnObjects[t].define.mergeCell(h,u,{source:{col:i,row:t},target:{col:d,row:t},table:e._table}))break;l.start.col=d}for(let d=i+1;d<((r=e.colCount)!==null&&r!==void 0?r:0);d++){const u=e._table.getCellValue(d,t);if(typeof e.columnObjects[t].define.mergeCell=="boolean"){if(h!==u)break}else if(!e.columnObjects[t].define.mergeCell(h,u,{source:{col:i,row:t},target:{col:d,row:t},table:e._table}))break;l.end.col=d}}return l}const a=e.getCellId(i,t);for(let h=t-1;h>=0&&a===e.getCellId(i,h);h--)l.start.row=h;for(let h=t+1;h<((s=e.rowCount)!==null&&s!==void 0?s:0)&&a===e.getCellId(i,h);h++)l.end.row=h;for(let h=i-1;h>=0&&a===e.getCellId(h,t);h--)l.start.col=h;for(let h=i+1;h<e.headerLevelCount+e.leftRowSeriesNumberColumnCount&&a===e.getCellId(h,t);h++)l.end.col=h;return l}class eI{constructor(t,e,n,o){this.seqId=0,this.leftRowSeriesNumberColumnCount=0,this.rightRowSeriesNumberColumnCount=0,this.bodyRowSpanCount=1,this._transpose=!1,this._showHeader=!0,this._recordsCount=0,this._hasAggregation=!1,this._hasAggregationOnTopCount=0,this._hasAggregationOnBottomCount=0,this._cellRangeMap=new Map,this._showHeader=n,this._table=t,this._columns=[],this._columnsIncludeHided=[],this._headerCellIds=[],this.hierarchyIndent=o??20,this.hierarchyTextStartAlignment=t.options.hierarchyTextStartAlignment,this.columnTree=new dg(e,{seqId:0},null),this._headerObjectsIncludeHided=this._addHeaders(0,e,[]),this._headerObjects=this._headerObjectsIncludeHided.filter(r=>r.define.hide!==!0),this._headerObjectMap=this._headerObjects.reduce((r,s)=>(r[s.id]=s,r),{}),this.rowHierarchyType=XF(this)?"tree":"grid",this._hasAggregation=$F(this),this._hasAggregationOnBottomCount=YF(this),this._hasAggregationOnTopCount=KF(this),this.handleRowSeriesNumber(t.internalProps.rowSeriesNumber)}handleRowSeriesNumber(t){var e,n;t&&(Array.isArray(t)?this.rowSeriesNumberColumn=t.map((o,r)=>{var s,l,a;return{id:this.seqId++,title:o.title,define:rt({field:"_vtable_rowSeries_number_"+r},o),cellType:(s=o.cellType)!==null&&s!==void 0?s:"text",headerType:(l=t.cellType)!==null&&l!==void 0?l:"text",style:o.style,width:o.width,format:o.format,field:(a=o.field)!==null&&a!==void 0?a:"_vtable_rowSeries_number_"+r,icon:o.icon,headerIcon:o.headerIcon,isChildNode:!1}}):this.rowSeriesNumberColumn=[{id:this.seqId++,title:t.title,define:rt({field:"_vtable_rowSeries_number"},t),cellType:(e=t.cellType)!==null&&e!==void 0?e:"text",headerType:(n=t.cellType)!==null&&n!==void 0?n:"text",style:t.style,width:t.width,format:t.format,field:"_vtable_rowSeries_number",icon:t.icon,headerIcon:t.headerIcon,isChildNode:!1}],this.leftRowSeriesNumberColumn=this.rowSeriesNumberColumn.filter(o=>!0),this.rightRowSeriesNumberColumn=this.rowSeriesNumberColumn.filter(o=>!1),this.leftRowSeriesNumberColumnCount=this.leftRowSeriesNumberColumn.length,this.rightRowSeriesNumberColumnCount=this.rightRowSeriesNumberColumn.length)}get transpose(){return this._transpose}set transpose(t){this._transpose=t}get showHeader(){return this._showHeader}set showHeader(t){this._showHeader=t}isSeriesNumberInHeader(t,e){if(this.leftRowSeriesNumberColumnCount>0&&t>=0&&e>=0&&t<this.leftRowSeriesNumberColumnCount){if(this.transpose)return!1;if(e<this.headerLevelCount)return!0}if(this.rightRowSeriesNumberColumnCount>0&&e>=0&&t>=this.colCount-this.rightRowSeriesNumberColumnCount){if(this.transpose)return!1;if(e<this.headerLevelCount)return!0}return!1}isSeriesNumberInBody(t,e){return!!(this.leftRowSeriesNumberColumnCount>0&&t>=0&&t<this.leftRowSeriesNumberColumnCount&&(this.transpose||e>=this.headerLevelCount)||this.rightRowSeriesNumberColumnCount>0&&t>=this.colCount-this.rightRowSeriesNumberColumnCount&&(this.transpose||e>=this.headerLevelCount))}isSeriesNumber(t,e){return!!(O(t)&&O(e)&&(this.leftRowSeriesNumberColumnCount>0&&t>=0&&e>=0&&t<this.leftRowSeriesNumberColumnCount||this.rightRowSeriesNumberColumnCount>0&&e>=0&&t>=this.colCount-this.rightRowSeriesNumberColumnCount))}getSeriesNumberHeader(t,e){if(this.leftRowSeriesNumberColumnCount>0&&t>=0&&t<this.leftRowSeriesNumberColumnCount){if(this.transpose)return;if(e<this.headerLevelCount)return Object.assign({},this.leftRowSeriesNumberColumn[t],{style:Object.assign({},this._table.transpose?this._table.internalProps.theme.rowHeaderStyle:this._table.internalProps.theme.headerStyle,this._table.internalProps.rowSeriesNumber.headerStyle)})}if(this.rightRowSeriesNumberColumnCount>0&&t>=this.colCount-this.rightRowSeriesNumberColumnCount&&e<this.headerLevelCount){if(this.transpose)return;if(e<this.headerLevelCount)return this.rightRowSeriesNumberColumn[t-(this.colCount-this.rightRowSeriesNumberColumnCount)]}}getSeriesNumberBody(t,e){if(this.leftRowSeriesNumberColumnCount>0&&t>=0&&t<this.leftRowSeriesNumberColumnCount){if(this.transpose)return this.leftRowSeriesNumberColumn[t];if(e>=this.headerLevelCount)return this.leftRowSeriesNumberColumn[t]}if(this.rightRowSeriesNumberColumnCount>0&&t>=this.colCount-this.rightRowSeriesNumberColumnCount){if(this.transpose)return this.rightRowSeriesNumberColumn[t-(this.colCount-this.rightRowSeriesNumberColumnCount)];if(e>=this.headerLevelCount)return this.rightRowSeriesNumberColumn[t-(this.colCount-this.rightRowSeriesNumberColumnCount)]}}isHeader(t,e){return!!(this.transpose&&t>=this.leftRowSeriesNumberColumnCount&&t<this.headerLevelCount+this.leftRowSeriesNumberColumnCount)||!this.transpose&&e>=0&&e<this.headerLevelCount}isAggregation(t,e){if(this.hasAggregation){if(this.hasAggregationOnBottomCount){if(this.transpose){if(t>=this.colCount-this.hasAggregationOnBottomCount)return!0}else if(e>=this.rowCount-this.hasAggregationOnBottomCount)return!0}if(this.hasAggregationOnTopCount){if(this.transpose){if(t>=this.rowHeaderLevelCount&&t<this.rowHeaderLevelCount+this.hasAggregationOnTopCount)return!0}else if(e>=this.columnHeaderLevelCount&&e<this.columnHeaderLevelCount+this.hasAggregationOnTopCount)return!0}}return!1}isTopAggregation(t,e){if(this.hasAggregationOnTopCount){if(this.transpose){if(t>=this.rowHeaderLevelCount&&t<this.rowHeaderLevelCount+this.hasAggregationOnTopCount)return!0}else if(e>=this.columnHeaderLevelCount&&e<this.columnHeaderLevelCount+this.hasAggregationOnTopCount)return!0}return!1}isBottomAggregation(t,e){if(this.hasAggregationOnBottomCount){if(this.transpose){if(t>=this.colCount-this.hasAggregationOnBottomCount)return!0}else if(e>=this.rowCount-this.hasAggregationOnBottomCount)return!0}return!1}get hasAggregation(){return this._hasAggregation}get hasAggregationOnTopCount(){return this._hasAggregationOnTopCount}get hasAggregationOnBottomCount(){return this._hasAggregationOnBottomCount}getAggregatorsByCell(t,e){return this.getColumnDefine(t,e).vtable_aggregator}getAggregatorsByCellRange(t,e,n,o){let r=[];if(!this.transpose){for(let s=t;s<=n;s++){const l=this.getColumnDefine(s,e);l.vtable_aggregator&&(r=r.concat(Array.isArray(l.vtable_aggregator)?l.vtable_aggregator:[l.vtable_aggregator]))}return r}for(let s=e;s<=o;s++){const l=this.getColumnDefine(t,s);l.vtable_aggregator&&(r=r.concat(Array.isArray(l.vtable_aggregator)?l.vtable_aggregator:[l.vtable_aggregator]))}return[]}getAggregatorOnTop(t,e){const n=this.getColumnDefine(t,e),o=n.vtable_aggregator,r=n.aggregation;if(Array.isArray(r)){const s=r.reduce((l,a,h)=>(a.showOnTop&&l.push(h),l),[]).map(l=>o[l]);return this.transpose?s[t-this.rowHeaderLevelCount]:s[e-this.columnHeaderLevelCount]}return this.transpose&&t-this.rowHeaderLevelCount==0?r!=null&&r.showOnTop?o:null:this.transpose||e-this.columnHeaderLevelCount!=0?null:r!=null&&r.showOnTop?o:null}getAggregatorOnBottom(t,e){const n=this.getColumnDefine(t,e),o=n.vtable_aggregator,r=n.aggregation;if(Array.isArray(r)){const s=r.reduce((l,a,h)=>(a.showOnTop||l.push(h),l),[]).map(l=>o[l]);return this.transpose?s[t-(this.colCount-this.hasAggregationOnBottomCount)]:s[e-(this.rowCount-this.hasAggregationOnBottomCount)]}return this.transpose&&t-(this.colCount-this.hasAggregationOnBottomCount)==0?r!=null&&r.showOnTop?null:o:this.transpose||e-(this.rowCount-this.hasAggregationOnBottomCount)!=0||r!=null&&r.showOnTop?null:o}getAggregatorCellAddress(t,e,n,o){const r=[],s=this.hasAggregationOnTopCount,l=this.hasAggregationOnBottomCount;if(this.transpose){for(let a=e;a<=o;a++)if(this.getColumnDefine(t,a).vtable_aggregator){for(let h=0;h<s;h++)r.push({col:this.headerLevelCount+h,row:a});for(let h=0;h<l;h++)r.push({col:this.rowCount-l+h,row:a})}}else for(let a=t;a<=n;a++)if(this.getColumnDefine(a,e).vtable_aggregator){for(let h=0;h<s;h++)r.push({col:a,row:this.headerLevelCount+h});for(let h=0;h<l;h++)r.push({col:a,row:this.rowCount-l+h})}return r}getCellLocation(t,e){return this.isHeader(t,e)?this.transpose?"rowHeader":"columnHeader":"body"}isRowHeader(t,e){return!!(this.transpose&&t>=this.leftRowSeriesNumberColumnCount&&t<this.headerLevelCount+this.leftRowSeriesNumberColumnCount)}isColumnHeader(t,e){return!this.transpose&&e>=0&&e<=this.headerLevelCount-1&&t>=this.leftRowSeriesNumberColumnCount&&t<this.colCount-this.rightRowSeriesNumberColumnCount}isFrozenColumn(t,e){if(O(e)){if(t>=0&&t<this.frozenColCount&&e>=this.frozenRowCount&&e<this.rowCount-this.bottomFrozenRowCount)return!0}else if(this.frozenColCount>0&&t>=0&&t<this.frozenColCount)return!0;return!1}isRightFrozenColumn(t,e){if(O(e)){if(t>=this.colCount-this.rightFrozenColCount&&e>=this.frozenRowCount&&e<this.rowCount-this.bottomFrozenRowCount)return!0}else if(this.rightFrozenColCount>0&&t>=this.colCount-this.rightFrozenColCount)return!0;return!1}isFrozenRow(t,e){if(O(e)){if(e>=0&&e<this.frozenRowCount&&t>=this.frozenColCount&&t<this.colCount-this.rightFrozenColCount)return!0}else if(e=t,this.frozenRowCount>0&&e>=0&&e<this.frozenRowCount)return!0;return!1}isBottomFrozenRow(t,e){if(O(e)){if(e>=this.rowCount-this.bottomFrozenRowCount&&t>=this.frozenColCount&&t<this.colCount-this.rightFrozenColCount)return!0}else if(e=t,this.bottomFrozenRowCount>0&&e>=this.rowCount-this.bottomFrozenRowCount)return!0;return!1}isLeftTopCorner(t,e){return t>=0&&t<this.frozenColCount&&e>=0&&e<this.frozenRowCount}isLeftBottomCorner(t,e){return t>=0&&t<this.frozenColCount&&e>=this.rowCount-this.bottomFrozenRowCount}isRightTopCorner(t,e){return t>=this.colCount-this.rightFrozenColCount&&e>=0&&e<this.frozenRowCount}isRightBottomCorner(t,e){return t>=this.colCount-this.rightFrozenColCount&&e>=this.rowCount-this.bottomFrozenRowCount}isCornerHeader(t,e){return!1}getColumnHeaderRange(){var t,e;return this.transpose?{start:{col:0,row:0},end:{col:this._headerCellIds.length-1,row:((t=this.rowCount)!==null&&t!==void 0?t:0)-1}}:{start:{col:0,row:0},end:{col:((e=this.colCount)!==null&&e!==void 0?e:0)-1,row:this._headerCellIds.length-1}}}getRowHeaderRange(){var t,e;return this.transpose?{start:{col:0,row:0},end:{col:this._headerCellIds.length-1,row:((t=this.rowCount)!==null&&t!==void 0?t:0)-1}}:{start:{col:0,row:0},end:{col:((e=this.colCount)!==null&&e!==void 0?e:0)-1,row:this._headerCellIds.length-1}}}getCornerHeaderRange(){}getBodyRange(){var t,e,n,o;return this.transpose?{start:{col:this.headerLevelCount,row:0},end:{col:((t=this.colCount)!==null&&t!==void 0?t:0)-1,row:((e=this.rowCount)!==null&&e!==void 0?e:0)-1}}:{start:{col:0,row:this.headerLevelCount},end:{col:((n=this.colCount)!==null&&n!==void 0?n:0)-1,row:((o=this.rowCount)!==null&&o!==void 0?o:0)-1}}}get headerLevelCount(){return this.showHeader?this._headerCellIds.length:0}get columnHeaderLevelCount(){return this.transpose?0:this.headerLevelCount}get rowHeaderLevelCount(){return this.transpose?this.headerLevelCount:0}get frozenColCount(){return this._table.internalProps.frozenColCount?this.colCount>this._table.internalProps.frozenColCount?this._table.internalProps.frozenColCount:this.colCount:0}get frozenRowCount(){return this._table.internalProps.frozenRowCount?this.rowCount>=this._table.internalProps.frozenRowCount?this._table.internalProps.frozenRowCount:this.rowCount:0}get bottomFrozenRowCount(){return this._table.internalProps.bottomFrozenRowCount?this.rowCount-this.headerLevelCount>=this._table.internalProps.bottomFrozenRowCount?this._table.internalProps.bottomFrozenRowCount:this.rowCount-this.headerLevelCount:0}get rightFrozenColCount(){return this._table.internalProps.rightFrozenColCount?this.colCount-this.frozenColCount>=this._table.internalProps.rightFrozenColCount?this._table.internalProps.rightFrozenColCount:Math.max(0,this.colCount-this.frozenColCount):0}get colCount(){return this.transpose?this.headerLevelCount+this.recordsCount+this.leftRowSeriesNumberColumnCount+this.rightRowSeriesNumberColumnCount:this._columns.length+this.leftRowSeriesNumberColumnCount+this.rightRowSeriesNumberColumnCount}get rowCount(){return this.transpose?this._columns.length:this.headerLevelCount+this.recordsCount}get bodyRowCount(){return this.transpose?this._columns.length:this.rowCount-this.bottomFrozenRowCount-this.headerLevelCount}get bodyColCount(){return this.transpose?this.colCount-this.rightFrozenColCount-this.rowHeaderLevelCount:this._columns.length}get recordsCount(){return this._recordsCount}set recordsCount(t){this._recordsCount=t}get headerObjects(){return this._headerObjects}get columnObjects(){return this._columns}get headerObjectsIncludeHided(){return this._headerObjectsIncludeHided}get columnWidths(){if(this.leftRowSeriesNumberColumnCount){const t=this.leftRowSeriesNumberColumn.map(e=>({width:e.width,minWidth:e.minWidth,maxWidth:e.maxWidth}));return t.push(...this._columns.map(e=>({width:e.width,minWidth:e.minWidth,maxWidth:e.maxWidth}))),t}return this._columns.map(t=>({width:t.width,minWidth:t.minWidth,maxWidth:t.maxWidth}))}getColumnWidthDefined(t){var e;if(t>=0){if(t<this.leftRowSeriesNumberColumnCount)return this.leftRowSeriesNumberColumn[t];if(this.transpose){let n,o,r=0;if(t>=this.rowHeaderLevelCount+this.leftRowSeriesNumberColumnCount){let s;return this.columnObjects.forEach((l,a)=>{typeof l.width=="number"?r=Math.max(l.width,r):l.width==="auto"&&(s=!0),typeof l.minWidth=="number"&&(o=Math.max(l.minWidth,o)),typeof l.maxWidth=="number"&&(n=Math.max(l.maxWidth,n))}),r=r>0?r:s?"auto":void 0,{width:r,minWidth:o,maxWidth:n}}if(this.isRowHeader(t,0)){const s=Array.isArray(this._table.defaultHeaderColWidth)?(e=this._table.defaultHeaderColWidth[t])!==null&&e!==void 0?e:this._table.defaultColWidth:this._table.defaultHeaderColWidth;return s==="auto"?{width:"auto"}:{width:s}}}return this._columns[t-this.leftRowSeriesNumberColumnCount]}}getCellId(t,e){var n,o,r,s;return this.transpose?t>=this.headerLevelCount+this.leftRowSeriesNumberColumnCount?(n=this._columns[e])===null||n===void 0?void 0:n.id:this.isSeriesNumber(t,e)?e+"_series_number":(o=this._headerCellIds[t-this.leftRowSeriesNumberColumnCount])===null||o===void 0?void 0:o[e]:this.isSeriesNumber(t,e)?this.rowSeriesNumberColumn[t].id:this.headerLevelCount<=e?(r=this._columns[t-this.leftRowSeriesNumberColumnCount])===null||r===void 0?void 0:r.id:(s=this._headerCellIds[e])===null||s===void 0?void 0:s[t-this.leftRowSeriesNumberColumnCount]}getHeader(t,e){if(this.isSeriesNumberInHeader(t,e))return this.getSeriesNumberHeader(t,e);const n=this.getCellId(t,e);return this._headerObjectMap[n]}getHeaderField(t,e){var n,o,r;if(this.isSeriesNumberInHeader(t,e))return(n=this.getSeriesNumberHeader(t,e))===null||n===void 0?void 0:n.field;if(this.isSeriesNumberInBody(t,e))return(o=this.getSeriesNumberBody(t,e))===null||o===void 0?void 0:o.field;const s=this.getCellId(t,e);return((r=this._headerObjectMap[s])===null||r===void 0?void 0:r.field)||(this.transpose?this._columns[e]&&this._columns[e].field:this._columns[t-this.leftRowSeriesNumberColumnCount]&&this._columns[t-this.leftRowSeriesNumberColumnCount].field)}getHeaderCellAdressById(t){for(let e=0;e<this._headerCellIds.length;e++){const n=this._headerCellIds[e];for(let o=0;o<n.length;o++)if(n[o]===t)return this.transpose?{col:e,row:o}:{col:o+this.leftRowSeriesNumberColumnCount,row:e}}}getHeaderCellAddressByField(t){const e=this.headerObjects.find(n=>n&&n.field===t);return e&&this.getHeaderCellAdressById(e.id)}getBody(t,e){return this.isSeriesNumber(t,e)?this.getSeriesNumberBody(t,e):this.transpose?this._columns[e]:this._columns[t-this.leftRowSeriesNumberColumnCount]}getBodyLayoutRangeById(t){var e,n;if(this.transpose){for(let o=0;o<((e=this.rowCount)!==null&&e!==void 0?e:0);o++)if(t===this._columns[o].id)return{start:{col:0,row:o},end:{col:0,row:o}}}else for(let o=this.leftRowSeriesNumberColumnCount;o<((n=this.colCount)!==null&&n!==void 0?n:0);o++)if(t===this._columns[o-this.leftRowSeriesNumberColumnCount].id)return{start:{col:o,row:0},end:{col:o,row:0}};return{start:{col:-1,row:-1},end:{col:-1,row:-1}}}getCellRange(t,e){return Jz(t,e,this)}isCellRangeEqual(t,e,n,o){const r=this.getCellRange(t,e),s=this.getCellRange(n,o);return r.start.col===s.start.col&&r.end.col===s.end.col&&r.start.row===s.start.row&&r.end.row===s.end.row}getRecordShowIndexByCell(t,e){const n=this.hasAggregationOnTopCount?this.headerLevelCount+1:this.headerLevelCount;return this.transpose?t<n?-1:t-n:e<n?-1:e-n}getRecordStartRowByRecordIndex(t){return(this.hasAggregationOnTopCount?this.headerLevelCount+1:this.headerLevelCount)+t}_addHeaders(t,e,n,o){const r=[],s=this._newRow(t,o);return e.forEach(l=>{var a,h,d,u;const c=this._columns.length,f=this.seqId++,g={id:f,title:(a=l.title)!==null&&a!==void 0?a:l.caption,headerIcon:l.headerIcon,field:l.field,style:l.headerStyle,headerType:(h=l.headerType)!==null&&h!==void 0?h:"text",dropDownMenu:l.dropDownMenu,define:l,columnWidthComputeMode:l.columnWidthComputeMode};r[f]=g;for(let p=t-1;p>=0;p--)this._headerCellIds[p]&&(this._headerCellIds[p][c]=n[p]);if(o?this._headerCellIds[t-1]&&(s[c]=this._headerCellIds[t-1][c]):s[c]=f,l.columns)!l.columns.every(p=>p.hide)&&this._addHeaders(t+1,l.columns,[...n,f],l.hideColumnsSubHeader||o).forEach(p=>r.push(p));else{const p={id:this.seqId++,field:l.field,fieldFormat:l.fieldFormat,width:l.width,minWidth:l.minWidth,maxWidth:l.maxWidth,icon:l.icon,cellType:(u=(d=l.cellType)!==null&&d!==void 0?d:l.columnType)!==null&&u!==void 0?u:"text",chartModule:"chartModule"in l?l.chartModule:null,chartSpec:"chartSpec"in l?l.chartSpec:null,sparklineSpec:"sparklineSpec"in l?l.sparklineSpec:Z2,style:l.style,define:l,columnWidthComputeMode:l.columnWidthComputeMode,disableColumnResize:l==null?void 0:l.disableColumnResize,aggregation:l.aggregation,isChildNode:t>=1};if(this._columnsIncludeHided.push(p),l.hide!==!0){this._columns.push(p);for(let v=t+1;v<this._headerCellIds.length;v++)this._headerCellIds[v][c]=f}}}),r}_newRow(t,e=!1){if(this._headerCellIds[t]){const r=this._headerCellIds[t-1];if(r.length>this._headerCellIds[t].length)for(let s=this._headerCellIds[t].length;s<r.length;s++)this._headerCellIds[t][s]=r[s];return this._headerCellIds[t]}if(e)return[];const n=this._headerCellIds[t]=[];if(!this._columns.length)return n;const o=this._headerCellIds[t-1];for(let r=0;r<o.length;r++)n[r]=o[r];return n}getCellHeaderPaths(t,e){if(this.isSeriesNumber(t,e))return;let n=[],o=[];return this.transpose?o=[{field:this._columns[e].field}]:n=[{field:this._columns[t-this.leftRowSeriesNumberColumnCount].field}],{colHeaderPaths:n,rowHeaderPaths:o,cellLocation:this.getCellLocation(t,e)}}getParentCellId(t,e){if(e!==0){if(this.isColumnHeader(t,e))return this.getCellId(t,e-1);if(this.isRowHeader(t,e))return this.isSeriesNumberInBody(t-1,e)?void 0:this.getCellId(t-1,e)}}canMoveHeaderPosition(t,e){if(this.isSeriesNumberInHeader(e.col,e.row)||this.isSeriesNumberInHeader(t.col,t.row))return!1;if(!this.transpose&&this.isSeriesNumberInBody(e.col,e.row)&&this.isSeriesNumberInBody(t.col,t.row)){const o=this.getRecordShowIndexByCell(0,t.row),r=this.getRecordShowIndexByCell(0,e.row);return this._table.dataSource.canChangeOrder(o,r)}if(this.transpose&&this.isSeriesNumberInBody(e.col,e.row)&&this.isSeriesNumberInBody(t.col,t.row)&&(this.getBody(t.col+this.leftRowSeriesNumberColumnCount,t.row).isChildNode&&this.getBody(e.col+this.leftRowSeriesNumberColumnCount,e.row).isChildNode?(t.col=t.col+this.leftRowSeriesNumberColumnCount+this.rowHeaderLevelCount-1,e.col=e.col+this.leftRowSeriesNumberColumnCount+this.rowHeaderLevelCount-1):(t.col=t.col+this.leftRowSeriesNumberColumnCount,e.col=e.col+this.leftRowSeriesNumberColumnCount)),t.col<0||t.row<0||e.col<0||e.row<0||this._table.internalProps.frozenColDragHeaderMode==="disabled"&&this._table.isFrozenColumn(e.col))return!1;const n=this.getCellRange(t.col,t.row);return this.isColumnHeader(t.col,t.row)?this.getParentCellId(t.col,n.start.row)===this.getParentCellId(e.col,n.start.row):this.isRowHeader(t.col,t.row)?this.getParentCellId(n.start.col,t.row)===this.getParentCellId(n.start.col,e.row):!1}moveHeaderPosition(t,e){if(this.canMoveHeaderPosition(t,e)){let n=this.getCellRange(t.col,t.row);if(this.isColumnHeader(t.col,t.row)){const o=n.end.col-n.start.col+1;let r;const s=this.getCellRange(e.col,n.start.row);if(r=e.col>=t.col?s.end.col-o+1:s.start.col,r===n.start.col)return null;for(let a=0;a<this._headerCellIds.length;a++){const h=this._headerCellIds[a].splice(n.start.col-this.leftRowSeriesNumberColumnCount,o);h.unshift(r-this.leftRowSeriesNumberColumnCount,0),Array.prototype.splice.apply(this._headerCellIds[a],h)}const l=this._columns.splice(n.start.col-this.leftRowSeriesNumberColumnCount,o);return l.unshift(r-this.leftRowSeriesNumberColumnCount,0),Array.prototype.splice.apply(this._columns,l),this.columnTree.movePosition(n.start.row,n.start.col-this.leftRowSeriesNumberColumnCount,r-this.leftRowSeriesNumberColumnCount),this.columnTree.reset(this.columnTree.tree.children),this._cellRangeMap=new Map,{sourceIndex:n.start.col,targetIndex:r,sourceSize:o,targetSize:s.end.col-s.start.col+1,moveType:"column"}}if(this.isRowHeader(t.col,t.row)||this.isSeriesNumberInBody(t.col,t.row)&&this.transpose){this.isSeriesNumberInBody(t.col,t.row)&&(n=this.getCellRange(t.col+this.leftRowSeriesNumberColumnCount,t.row));const o=n.end.row-n.start.row+1;let r;const s=this.getCellRange(n.start.col,e.row);if(r=e.row>=t.row?s.end.row-o+1:s.start.row,r===n.start.row)return null;for(let a=0;a<this._headerCellIds.length;a++){const h=this._headerCellIds[a].splice(n.start.row,o);h.unshift(r,0),Array.prototype.splice.apply(this._headerCellIds[a],h)}const l=this._columns.splice(n.start.row,o);return l.unshift(r,0),Array.prototype.splice.apply(this._columns,l),this.columnTree.movePosition(n.start.col-this.leftRowSeriesNumberColumnCount,n.start.row,r+(e.row>t.row?n.end.row-n.start.row:0)),this.columnTree.reset(this.columnTree.tree.children),this._cellRangeMap=new Map,{sourceIndex:n.start.row,targetIndex:r,sourceSize:o,targetSize:s.end.row-s.start.row+1,moveType:"row"}}if(this.isSeriesNumberInBody(t.col,t.row))return{sourceIndex:t.row,targetIndex:e.row,sourceSize:1,targetSize:1,moveType:"row"}}return null}toggleHierarchyState(t){return{addCellPositions:t.add.map(e=>({col:0,row:this._table.columnHeaderLevelCount+e})),removeCellPositions:t.remove.map(e=>({col:0,row:this._table.columnHeaderLevelCount+e}))}}setChartInstance(t,e,n){const o=this.transpose?this._columns[e]:this._columns[t-this.leftRowSeriesNumberColumnCount];typeof o.chartSpec!="function"&&(o.chartInstance=n)}getChartInstance(t,e){return(this.transpose?this._columns[e]:this._columns[t-this.leftRowSeriesNumberColumnCount]).chartInstance}checkHasChart(){return Zz(this)}getAxisConfigInPivotChart(t,e){}isEmpty(t,e){return!1}isAxisCell(t,e){return!1}getChartAxes(t,e){return[]}isShareChartSpec(t,e){const n=this.getBody(t,e);return typeof(n==null?void 0:n.chartSpec)!="function"}isNoChartDataRenderNothing(t,e){const n=this.getBody(t,e);return(n==null?void 0:n.define).noDataRenderNothing}getChartSpec(t,e){return this.getRawChartSpec(t,e)}getRawChartSpec(t,e){const n=this.getBody(t,e),o=n==null?void 0:n.chartSpec;return typeof o=="function"?o({col:t,row:e,dataValue:this._table.getCellOriginValue(t,e)||"",value:this._table.getCellValue(t,e)||"",rect:this._table.getCellRangeRelativeRect(this._table.getCellRange(t,e)),table:this._table}):o}getChartDataId(t,e){return qz(t,e,this)}release(){const t=this._table._getActiveChartInstance();t==null||t.release(),this.columnObjects.forEach(e=>{var n;(n=e.chartInstance)===null||n===void 0||n.release()})}clearCellRangeMap(){this._cellRangeMap.clear()}updateColumnTitle(t,e,n){const o=this._table.internalProps.layoutMap.getHeader(t,e);o.title=n,o.define.title=n}getColumnByField(t){var e;return(e=this.columnObjects)===null||e===void 0?void 0:e.reduce((n,o,r)=>(o.field===t&&n.push({col:r,columnDefine:o}),n),[])}getColumnByKey(t){var e;let n;return{columnDefine:(e=this.columnObjects)===null||e===void 0?void 0:e.find((o,r)=>{var s;return((s=o.define)===null||s===void 0?void 0:s.key)===t&&(n=r,!0)}),col:n}}getColumnDefine(t,e){if(t>=0)return t<this.leftRowSeriesNumberColumnCount?this.leftRowSeriesNumberColumn[t].define:this.transpose?this._columns[e].define:this._columns[t-this.leftRowSeriesNumberColumnCount].define}}class iI{constructor(t){this.isValidatingValue=!1,this.listenersId=[],this.table=t,this.bindEvent()}bindEvent(){const t=this.table,e=t.on(U.DBLCLICK_CELL,o=>{var r;const{editCellTrigger:s="doubleclick"}=t.options;if(!s.includes("doubleclick"))return;const{col:l,row:a}=o,h=me(o.federatedEvent),d=t.scenegraph.getResizeColAt(h.abstractPos.x,h.abstractPos.y,(r=h.eventArgs)===null||r===void 0?void 0:r.targetCell);t._canResizeColumn(d.col,d.row)&&d.col>=0||this.startEditCell(l,a)}),n=t.on(U.CLICK_CELL,o=>{const{editCellTrigger:r="doubleclick"}=t.options;if(r==="click"||Array.isArray(r)&&r.includes("click")){const{col:s,row:l}=o;this.startEditCell(s,l)}});this.listenersId.push(e,n)}startEditCell(t,e,n){var o,r,s,l,a;if(this.editingEditor)return;const h=this.table.getEditor(t,e);if(h){if(!((r=(o=this.table.internalProps.layoutMap)===null||o===void 0?void 0:o.isAggregation)===null||r===void 0)&&r.call(o,t,e))return;this.editingEditor||(this.editCell={col:t,row:e}),this.table._makeVisibleCell(t,e),this.editingEditor=h;const d=O(n)?n:this.table.getCellOriginValue(t,e),u=this.table.getCellRangeRelativeRect(this.table.getCellRange(t,e)),c={rect:{left:u.left,top:u.top,width:u.width,height:u.height}};t===this.table.colCount-1&&(c.rect.width=u.width-1),e===this.table.rowCount-1&&(c.rect.height=u.height-1),h.beginEditing,(s=h.beginEditing)===null||s===void 0||s.call(h,this.table.getElement(),c,d),h.bindSuccessCallback,(l=h.bindSuccessCallback)===null||l===void 0||l.call(h,()=>{this.completeEdit()}),(a=h.onStart)===null||a===void 0||a.call(h,{value:d,endEdit:()=>{this.completeEdit()},referencePosition:c,container:this.table.getElement(),col:t,row:e,table:this.table})}}completeEdit(t){var e,n;if(!this.editingEditor)return!0;if(this.isValidatingValue)return!1;const o=t==null?void 0:t.target,{editingEditor:r}=this;if(o){if(r.targetIsOnEditor){if(r.targetIsOnEditor(o))return!1}else if(!r.isEditorElement||r.isEditorElement(o))return!1}if(this.editingEditor.getValue,this.editingEditor.validateValue){this.isValidatingValue=!0;const s=this.editingEditor.getValue(),l=this.table.getCellOriginValue(this.editCell.col,this.editCell.row),a=(n=(e=this.editingEditor).validateValue)===null||n===void 0?void 0:n.call(e,s,l,this.editCell,this.table);return ji(a)?(this.isValidatingValue=!0,new Promise((h,d)=>{a.then(u=>{gb(u,this,l,h)}).catch(u=>{this.isValidatingValue=!1,d(u)})})):gb(a,this,l)}return this.doExit(),!0}doExit(){var t,e,n,o,r,s;const l=(e=(t=this.editingEditor).getValue)===null||e===void 0?void 0:e.call(t),a=this.table.getCellRange(this.editCell.col,this.editCell.row),h=[];for(let d=a.start.row;d<=a.end.row;d++){const u=[];for(let c=a.start.col;c<=a.end.col;c++)u.push(l);h.push(u)}this.table.changeCellValues(a.start.col,a.start.row,h),this.editingEditor.exit,(o=(n=this.editingEditor).exit)===null||o===void 0||o.call(n),(s=(r=this.editingEditor).onEnd)===null||s===void 0||s.call(r),this.editingEditor=null,this.isValidatingValue=!1}cancelEdit(){var t,e,n,o;this.editingEditor&&((e=(t=this.editingEditor).exit)===null||e===void 0||e.call(t),(o=(n=this.editingEditor).onEnd)===null||o===void 0||o.call(n),this.editingEditor=null)}release(){this.listenersId.forEach(t=>{this.table.off(t)})}}function gb(i,t,e,n){return t.isValidatingValue=!1,i==="validate-exit"?(t.doExit(),n==null||n(!0),!0):i==="invalidate-exit"?(t.editingEditor.setValue(e),t.doExit(),n==null||n(!0),!0):i==="validate-not-exit"||i==="invalidate-not-exit"?(n==null||n(!1),!1):i===!0?(t.doExit(),n==null||n(!0),!0):(n==null||n(!1),!1)}function fb(i){return jt(i)?{groupByRules:[i]}:Q(i)?{groupByRules:i.map(t=>jt(t)?t:t.key)}:{}}function nI(i,t,e,n,o){if(n&&o.isHasEditorDefine(i,t)||n===!1){const r=o.getRecordShowIndexByCell(i,t),{field:s}=o.internalProps.layoutMap.getBody(i,t),l=o.getCellRawValue(i,t),a=o.getCellOriginValue(i,t);o.isHeader(i,t)?o.internalProps.layoutMap.updateColumnTitle(i,t,e):o.dataSource.changeFieldValue(e,r,s,i,t,o);const h=o.getCellRange(i,t),d=o.internalProps.layoutMap.getAggregatorsByCell(i,t);if(d){if(Array.isArray(d))for(let f=0;f<(d==null?void 0:d.length);f++)d[f].recalculate();else d.recalculate();const c=o.internalProps.layoutMap.getAggregatorCellAddress(h.start.col,h.start.row,h.end.col,h.end.row);for(let f=0;f<c.length;f++){const g=o.getCellRange(c[f].col,c[f].row);for(let p=g.start.col;p<=g.end.col;p++)for(let v=g.start.row;v<=g.end.row;v++)o.scenegraph.updateCellContent(p,v)}}for(let c=h.start.col;c<=h.end.col;c++)for(let f=h.start.row;f<=h.end.row;f++)o.scenegraph.updateCellContent(c,f);if(o.widthMode==="adaptive"||o.autoFillWidth&&o.getAllColsWidth()<=o.tableNoFrameWidth)o.internalProps._widthResizedColMap.size===0&&o.scenegraph.recalculateColWidths();else if(!o.internalProps._widthResizedColMap.has(i)){const c=o.getColWidth(i),f=br(i,0,o.rowCount-1,o,!1);f!==c&&o.scenegraph.updateColWidth(i,f-c)}if(o.heightMode==="adaptive"||o.autoFillHeight&&o.getAllRowsHeight()<=o.tableNoFrameHeight)o.internalProps._heightResizedRowMap.size===0&&o.scenegraph.recalculateRowHeights();else if(o.isAutoRowHeight()&&!o.internalProps._heightResizedRowMap.has(t)){const c=o.getRowHeight(t),f=yi(t,0,o.colCount-1,o);o.scenegraph.updateRowHeight(t,f-c)}const u=o.getCellOriginValue(i,t);a!==u&&o.fireListeners(U.CHANGE_CELL_VALUE,{col:i,row:t,rawValue:l,currentValue:a,changedValue:u}),o.scenegraph.updateNextFrame()}}function oI(i,t,e,n,o){var r,s;let l=i,a=t;const h=[],d=[];let u;for(let p=0;p<e.length&&!(t+p>o.rowCount-1);p++){const v=e[p],m=[],b=[];h.push(m),d.push(b);for(let C=0;C<v.length&&!(i+C>o.colCount-1);C++){u=rI(i+C,t+p,o,u);const _=o.getCellRawValue(i+C,t+p);m.push(_);const w=o.getCellOriginValue(i+C,t+p);b.push(w)}}for(let p=0;p<e.length&&!(t+p>o.rowCount-1);p++){a=t+p;const v=e[p];let m=i;for(let b=0;b<v.length&&!(i+b>o.colCount-1);b++){m=i+b;let C=!1;if(n===!1)C=!0;else if(o.isHasEditorDefine(i+b,t+p)){const _=o.getEditor(i+b,t+p),w=d[p][b],y=v[b],x=(s=(r=_==null?void 0:_.validateValue)===null||r===void 0?void 0:r.call(_,y,w))===null||s===void 0||s;C=!!ji(x)||x===!0||x==="validate-exit"||x==="invalidate-exit"}if(C){const _=v[b],w=o.getRecordShowIndexByCell(i+b,t+p),{field:y}=o.internalProps.layoutMap.getBody(i+b,t+p),x=h[p][b],S=d[p][b];o.isHeader(i+b,t+p)?o.internalProps.layoutMap.updateColumnTitle(i+b,t+p,_):o.dataSource.changeFieldValue(_,w,y,i+b,t+p,o);const R=o.getCellOriginValue(i+b,t+p);S!==R&&o.fireListeners(U.CHANGE_CELL_VALUE,{col:i+b,row:t+p,rawValue:x,currentValue:S,changedValue:R})}}l=Math.max(l,m)}const c=o.getCellRange(i,t),f=o.getCellRange(l,a),g=o.internalProps.layoutMap.getAggregatorsByCellRange(c.start.col,c.start.row,f.end.col,f.end.row);if(g){for(let p=0;p<(g==null?void 0:g.length);p++)g[p].recalculate();if(u==="normal"){const p=o.internalProps.layoutMap.getAggregatorCellAddress(c.start.col,c.start.row,f.end.col,f.end.row);for(let v=0;v<p.length;v++){const m=o.getCellRange(p[v].col,p[v].row);for(let b=m.start.col;b<=m.end.col;b++)for(let C=m.start.row;C<=m.end.row;C++)o.scenegraph.updateCellContent(b,C)}}}if(u==="group"&&o.dataSource.updateRecordsForGroup([],[]),u==="sort"||u==="group")return o.dataSource.sortedIndexMap.clear(),Qe(o),o.refreshRowColCount(),o.internalProps.layoutMap.clearCellRangeMap(),o.scenegraph.clearCells(),void o.scenegraph.createSceneGraph();for(let p=c.start.col;p<=f.end.col;p++)for(let v=c.start.row;v<=f.end.row;v++)o.scenegraph.updateCellContent(p,v);if(o.widthMode==="adaptive"||o.autoFillWidth&&o.getAllColsWidth()<=o.tableNoFrameWidth)o.internalProps._widthResizedColMap.size===0&&o.scenegraph.recalculateColWidths();else for(let p=i;p<=f.end.col;p++)if(!o.internalProps._widthResizedColMap.has(p)){const v=o.getColWidth(p),m=br(p,0,o.rowCount-1,o,!1);m!==v&&o.scenegraph.updateColWidth(p,m-v)}if(o.heightMode==="adaptive"||o.autoFillHeight&&o.getAllRowsHeight()<=o.tableNoFrameHeight)o.scenegraph.recalculateRowHeights();else if(o.isAutoRowHeight()){const p=[],v=[];for(let m=t;m<=f.end.row;m++)if(o.rowHeightsMap.get(m)){const b=o.getRowHeight(m),C=yi(m,0,o.colCount-1,o);p.push(m),v.push(C-b)}o.scenegraph.updateRowsHeight(p,v)}o.scenegraph.updateNextFrame()}function rI(i,t,e,n){if(n==="group"||n==="sort"&&!e.options.groupBy)return n;let o="normal";return e.options.groupBy?o="group":!e.isHeader(i,t)&&e.dataSource.lastOrderField&&e.getBodyField(i,t)===e.dataSource.lastOrderField&&(o="sort"),o}function Qe(i){let t=i.sortState;t=!t||Array.isArray(t)?t:[t],t&&(t=t.map(e=>{var n;return e.orderFn=(n=i._getSortFuncFromHeaderOption(void 0,e.field))!==null&&n!==void 0?n:ah,e}),i.dataSource.sort(t))}function sI(i,t,e){var n,o,r,s;if(e.options.groupBy)(o=(n=e.dataSource).addRecordsForGroup)===null||o===void 0||o.call(n,[i],t),e.refreshRowColCount(),e.internalProps.layoutMap.clearCellRangeMap(),e.sortState&&Qe(e),e.scenegraph.clearCells(),e.scenegraph.createSceneGraph();else if(e.dataSource.rowHierarchyType==="tree")(s=(r=e.dataSource).addRecordsForTree)===null||s===void 0||s.call(r,[i],t),e.refreshRowColCount(),e.internalProps.layoutMap.clearCellRangeMap(),e.sortState&&Qe(e),e.scenegraph.clearCells(),e.scenegraph.createSceneGraph();else if(e.sortState)e.dataSource.addRecordForSorted(i),Qe(e),e.refreshRowColCount(),e.scenegraph.clearCells(),e.scenegraph.createSceneGraph();else{(t===void 0||t>e.dataSource.sourceLength)&&(t=e.dataSource.sourceLength);const l=e.transpose?e.rowHeaderLevelCount:e.columnHeaderLevelCount;e.dataSource.addRecord(i,t);const a=e.rowCount;if(e.refreshRowColCount(),e.scenegraph.proxy.totalActualBodyRowCount===0)return e.scenegraph.clearCells(),void e.scenegraph.createSceneGraph();const h=e.transpose?e.colCount:e.rowCount;if(e.pagination){const{perPageCount:d,currentPage:u}=e.pagination,c=d*(u||0)+d;if(t<c)if(t<c-d)e.scenegraph.clearCells(),e.scenegraph.createSceneGraph();else{const f=t-(c-d)+l;if(a-l===e.pagination.perPageCount){const g=[];for(let p=f;p<h;p++)e.transpose?g.push({col:p,row:0}):g.push({col:0,row:p});e.transpose?e.scenegraph.updateCol([],[],g):e.scenegraph.updateRow([],[],g)}else{const g=[];for(let p=f;p<Math.min(h,f+1);p++)e.transpose?g.push({col:p,row:0}):g.push({col:0,row:p});e.transpose?e.scenegraph.updateCol([],g,[]):e.scenegraph.updateRow([],g,[])}}}else{const d=[];for(let g=t+l;g<t+l+1;g++)e.transpose?d.push({col:g,row:0}):d.push({col:0,row:g});const u=[],c=e.internalProps.layoutMap.hasAggregationOnTopCount,f=e.internalProps.layoutMap.hasAggregationOnBottomCount;for(let g=l;g<l+c;g++)e.transpose?u.push({col:g,row:0}):u.push({col:0,row:g});for(let g=(e.transpose?e.colCount:e.rowCount)-f;g<(e.transpose?e.colCount:e.rowCount);g++)e.transpose?u.push({col:g,row:0}):u.push({col:0,row:g});e.transpose?e.scenegraph.updateCol([],d,[]):e.scenegraph.updateRow([],d,[])}}}function lI(i,t,e){var n,o,r,s;if(e.options.groupBy)(o=(n=e.dataSource).addRecordsForGroup)===null||o===void 0||o.call(n,i,t),e.refreshRowColCount(),e.internalProps.layoutMap.clearCellRangeMap(),e.sortState&&Qe(e),e.scenegraph.clearCells(),e.scenegraph.createSceneGraph();else if(e.dataSource.rowHierarchyType==="tree")(s=(r=e.dataSource).addRecordsForTree)===null||s===void 0||s.call(r,i,t),e.refreshRowColCount(),e.internalProps.layoutMap.clearCellRangeMap(),e.sortState&&Qe(e),e.scenegraph.clearCells(),e.scenegraph.createSceneGraph();else if(e.sortState)e.dataSource.addRecordsForSorted(i),Qe(e),e.refreshRowColCount(),e.scenegraph.clearCells(),e.scenegraph.createSceneGraph();else{t===void 0||t>e.dataSource.sourceLength?t=e.dataSource.sourceLength:t<0&&(t=0);const l=e.transpose?e.rowHeaderLevelCount:e.columnHeaderLevelCount;e.dataSource.addRecords(i,t);const a=e.transpose?e.colCount:e.rowCount;if(e.refreshRowColCount(),e.scenegraph.proxy.totalActualBodyRowCount===0)return e.scenegraph.clearCells(),void e.scenegraph.createSceneGraph();const h=e.transpose?e.colCount:e.rowCount;if(e.pagination){const{perPageCount:d,currentPage:u}=e.pagination,c=d*(u||0)+d;if(t<c)if(t<c-d)e.scenegraph.clearCells(),e.scenegraph.createSceneGraph();else{const f=t-(c-d)+l;if(a-l===e.pagination.perPageCount){const g=[];for(let p=f;p<h;p++)e.transpose?g.push({col:p,row:0}):g.push({col:0,row:p});e.transpose?e.scenegraph.updateCol([],[],g):e.scenegraph.updateRow([],[],g)}else{const g=[];for(let p=f;p<Math.min(h,f+(Array.isArray(i)?i.length:1));p++)e.transpose?g.push({col:p,row:0}):g.push({col:0,row:p});e.transpose?e.scenegraph.updateCol([],g,[]):e.scenegraph.updateRow([],g,[])}}}else{const d=[];for(let g=t+l;g<t+l+(Array.isArray(i)?i.length:1);g++)e.transpose?d.push({col:g,row:0}):d.push({col:0,row:g});const u=e.internalProps.layoutMap.hasAggregationOnTopCount,c=e.internalProps.layoutMap.hasAggregationOnBottomCount,f=[];for(let g=l;g<l+u;g++)e.transpose?f.push({col:g,row:0}):f.push({col:0,row:g});for(let g=(e.transpose?e.colCount:e.rowCount)-c;g<(e.transpose?e.colCount:e.rowCount);g++)e.transpose?f.push({col:g,row:0}):f.push({col:0,row:g});e.transpose?e.scenegraph.updateCol([],d,f):e.scenegraph.updateRow([],d,f)}}}function aI(i,t){var e,n,o,r,s,l,a,h;if((i==null?void 0:i.length)>0)if(t.options.groupBy)(n=(e=t.dataSource).deleteRecordsForGroup)===null||n===void 0||n.call(e,i),t.refreshRowColCount(),t.internalProps.layoutMap.clearCellRangeMap(),t.sortState&&Qe(t),t.scenegraph.clearCells(),t.scenegraph.createSceneGraph();else if(t.dataSource.rowHierarchyType==="tree")(r=(o=t.dataSource).deleteRecordsForTree)===null||r===void 0||r.call(o,i),t.refreshRowColCount(),t.internalProps.layoutMap.clearCellRangeMap(),t.sortState&&Qe(t),t.scenegraph.clearCells(),t.scenegraph.createSceneGraph();else if(t.sortState)t.dataSource.deleteRecordsForSorted(i),Qe(t),t.refreshRowColCount(),t.scenegraph.clearCells(),t.scenegraph.createSceneGraph();else{const d=t.dataSource.deleteRecords(i);if(d.length===0)return;const u=t.transpose?t.colCount:t.rowCount;t.refreshRowColCount();const c=t.transpose?t.colCount:t.rowCount,f=d.sort((p,v)=>p-v),g=f[0];if(t.pagination){const{perPageCount:p,currentPage:v}=t.pagination,m=p*(v||0)+p;if(g<m)if(g<m-p)t.scenegraph.clearCells(),t.scenegraph.createSceneGraph();else{const b=t.transpose?t.rowHeaderLevelCount:t.columnHeaderLevelCount,C=t.internalProps.layoutMap.hasAggregationOnTopCount,_=[],w=[];for(let y=g-(m-p)+(t.transpose?t.rowHeaderLevelCount:t.columnHeaderLevelCount)+C;y<c;y++)t.transpose?_.push({col:y,row:0}):_.push({col:0,row:y});for(let y=b;y<b+C;y++)t.transpose?_.push({col:y,row:0}):_.push({col:0,row:y});if(c<u)for(let y=c;y<u;y++)t.transpose?w.push({col:y,row:0}):w.push({col:0,row:y});(s=t.reactCustomLayout)===null||s===void 0||s.clearCache(),t.transpose?t.scenegraph.updateCol(w,[],_):t.scenegraph.updateRow(w,[],_),(l=t.reactCustomLayout)===null||l===void 0||l.updateAllCustomCell()}}else{const p=[],v=t.transpose?t.rowHeaderLevelCount:t.columnHeaderLevelCount,m=t.internalProps.layoutMap.hasAggregationOnTopCount,b=t.internalProps.layoutMap.hasAggregationOnBottomCount;for(let _=0;_<f.length;_++){const w=f[_]+v+m;t.transpose?p.push({col:w,row:0}):p.push({col:0,row:w})}const C=[];for(let _=v;_<v+m;_++)t.transpose?C.push({col:_,row:0}):C.push({col:0,row:_});for(let _=(t.transpose?t.colCount:t.rowCount)-b;_<(t.transpose?t.colCount:t.rowCount);_++)t.transpose?C.push({col:_,row:0}):C.push({col:0,row:_});(a=t.reactCustomLayout)===null||a===void 0||a.clearCache(),t.transpose?t.scenegraph.updateCol(p,[],C):t.scenegraph.updateRow(p,[],C),(h=t.reactCustomLayout)===null||h===void 0||h.updateAllCustomCell()}}}function hI(i,t,e){var n,o,r,s;if((t==null?void 0:t.length)>0)if(e.options.groupBy)(o=(n=e.dataSource).updateRecordsForGroup)===null||o===void 0||o.call(n,i,t),e.refreshRowColCount(),e.internalProps.layoutMap.clearCellRangeMap(),e.sortState&&Qe(e),e.scenegraph.clearCells(),e.scenegraph.createSceneGraph();else if(e.dataSource.rowHierarchyType==="tree")(s=(r=e.dataSource).updateRecordsForTree)===null||s===void 0||s.call(r,i,t),e.refreshRowColCount(),e.internalProps.layoutMap.clearCellRangeMap(),e.sortState&&Qe(e),e.scenegraph.clearCells(),e.scenegraph.createSceneGraph();else if(e.sortState)e.dataSource.updateRecordsForSorted(i,t),Qe(e),e.refreshRowColCount(),e.scenegraph.clearCells(),e.scenegraph.createSceneGraph();else{const l=e.dataSource.updateRecords(i,t);if(l.length===0)return;const a=l.map(h=>e.getBodyRowIndexByRecordIndex(h)).sort((h,d)=>h-d);if(e.pagination){const{perPageCount:h,currentPage:d}=e.pagination,u=e.transpose?e.rowHeaderLevelCount:e.columnHeaderLevelCount,c=e.internalProps.layoutMap.hasAggregationOnTopCount,f=h*(d||0)+h,g=[];for(let p=0;p<a.length;p++){const v=a[p];if(v<f&&v>=f-h){const m=v-(f-h)+(e.transpose?e.rowHeaderLevelCount:e.columnHeaderLevelCount)+c;g.push(m)}}if(g.length>=1){const p=[];for(let v=0;v<g.length;v++){const m=g[v];e.transpose?p.push({col:m,row:0}):p.push({col:0,row:m})}for(let v=u;v<u+c;v++)e.transpose?p.push({col:v,row:0}):p.push({col:0,row:v});e.transpose?e.scenegraph.updateCol([],[],p):e.scenegraph.updateRow([],[],p)}}else{const h=[],d=e.transpose?e.rowHeaderLevelCount:e.columnHeaderLevelCount,u=e.internalProps.layoutMap.hasAggregationOnTopCount,c=e.internalProps.layoutMap.hasAggregationOnBottomCount;for(let f=0;f<a.length;f++){const g=a[f]+d+u;e.transpose?h.push({col:g,row:0}):h.push({col:0,row:g})}for(let f=d;f<d+u;f++)e.transpose?h.push({col:f,row:0}):h.push({col:0,row:f});for(let f=(e.transpose?e.colCount:e.rowCount)-c;f<(e.transpose?e.colCount:e.rowCount);f++)e.transpose?h.push({col:f,row:0}):h.push({col:0,row:f});e.transpose?e.scenegraph.updateCol([],[],h):e.scenegraph.updateRow([],[],h)}}}function dI(i,t,e,n){const o=[{col:t,row:e}],r=[],s=[],{addCellPositions:l,removeCellPositions:a}=i,h=n.scenegraph.proxy,{rowStart:d,rowLimit:u}=h;let{rowEnd:c}=h,f=1/0;for(let v=0;v<l.length;v++){const{row:m}=l[v];c-d+1===u?m>=d&&m<=c&&(f=Math.min(f,m)):(r.push({col:t,row:m}),c++)}const g=Math.min(d+u,n.rowCount-1-n.bottomFrozenRowCount),p=g<d+u;for(let v=0;v<a.length;v++){const{row:m}=a[a.length-v-1];m<d||m>c||(m>g||p?(s.push({col:t,row:m}),f--):f=Math.min(f,m))}if(f!==1/0)for(let v=f;v<=c;v++)o.push({col:t,row:v});return n.scenegraph.proxy.refreshRowCount(),{updateCells:o,addCells:r,removeCells:s}}class uI extends vz{constructor(t,e){var n,o,r,s,l,a;Bt.mode==="node"?(e=t,t=null):t instanceof HTMLElement||(e=t,t=t.container?t.container:null),super(t,e),this.showHeader=!0;const h=this.internalProps;if(h.frozenColDragHeaderMode=e.frozenColDragHeaderMode,this.pagination=e.pagination,h.sortState=e.sortState,h.multipleSort=!!e.multipleSort,h.dataConfig=e.groupBy?fb(e.groupBy):{},h.columns=e.columns?bo(e.columns,["children"]):e.header?bo(e.header,["children"]):[],Vl(this),h.enableTreeNodeMerge=(o=(n=e.enableTreeNodeMerge)!==null&&n!==void 0?n:O(e.groupBy))!==null&&o!==void 0&&o,this.internalProps.headerHelper.setTableColumnsEditor(),this.showHeader=(r=e.showHeader)===null||r===void 0||r,this.internalProps.columnWidthConfig=e.columnWidthConfig,this.transpose=(s=e.transpose)!==null&&s!==void 0&&s,Bt.mode!=="node"&&(this.editorManager=new iI(this)),this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,e.dataSource?this.dataSource=e.dataSource:e.records?this.setRecords(e.records,{sortState:h.sortState}):this.setRecords([]),e.title){const d=ut.getComponent("title");h.title=new d(e.title,this),this.scenegraph.resize()}if(this.options.emptyTip)if(this.internalProps.emptyTip)(l=this.internalProps.emptyTip)===null||l===void 0||l.resetVisible();else{const d=ut.getComponent("emptyTip");this.internalProps.emptyTip=new d(this.options.emptyTip,this),(a=this.internalProps.emptyTip)===null||a===void 0||a.resetVisible()}if(e.enableTreeStickCell){const d=ut.getComponent("listTreeStickCellPlugin");this.listTreeStickCellPlugin=new d(this)}setTimeout(()=>{this.fireListeners(U.INITIALIZED,null)},0)}isListTable(){return!0}isPivotTable(){return!1}isPivotChart(){return!1}get sortState(){return this.internalProps.sortState}get records(){var t;return(t=this.dataSource)===null||t===void 0?void 0:t.records}get recordsCount(){return this.dataSource.records.length}updateColumns(t){var e,n,o,r;const s={col:this.stateManager.hover.cellPos.col,row:this.stateManager.hover.cellPos.row};this.internalProps.columns=bo(t,["children"]),Vl(this),this.options.columns=t,this.internalProps.headerHelper.setTableColumnsEditor(),this._hasAutoImageColumn=void 0,this.refreshHeader(),(n=(e=this.dataSource).updateColumns)===null||n===void 0||n.call(e,this.internalProps.columns),this.records&&VH(t)&&this.dataSource.processRecords((r=(o=this.dataSource.dataSourceObj)===null||o===void 0?void 0:o.records)!==null&&r!==void 0?r:this.dataSource.dataSourceObj),this.internalProps.useOneRowHeightFillAll=!1,this.scenegraph.clearCells(),this.headerStyleCache=new Map,this.bodyStyleCache=new Map,this.bodyBottomStyleCache=new Map,this.scenegraph.createSceneGraph(),this.stateManager.updateHoverPos(s.col,s.row),this.renderAsync(),this.eventManager.updateEventBinder()}get columns(){return this.internalProps.layoutMap.columnTree.getCopiedTree()}get header(){return this.internalProps.columns}set header(t){this.internalProps.columns=t,Vl(this),this.options.header=t,this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,this.renderAsync()}get transpose(){var t;return(t=this.internalProps.transpose)!==null&&t!==void 0&&t}set transpose(t){this.internalProps.transpose!==t&&(this.internalProps.transpose=t,this.internalProps.layoutMap&&(this.internalProps.layoutMap.transpose=t,this.refreshRowColCount(),this._resetFrozenColCount(),this.renderAsync()))}getCellValue(t,e,n){if(t===-1||e===-1)return null;if(!n){const l=this.getCustomMergeValue(t,e);if(l)return l}const o=this;if(o.internalProps.layoutMap.isSeriesNumber(t,e)){if(o.internalProps.layoutMap.isSeriesNumberInHeader(t,e)){const{title:h}=o.internalProps.layoutMap.getSeriesNumberHeader(t,e);return h}let l;if(this.options.groupBy){const h=o.getCellRawRecord(t,e);if(h!=null&&h.vtableMerge)return"";l=this.dataSource.getGroupSeriesNumber(e-this.columnHeaderLevelCount)}else l=e-this.columnHeaderLevelCount+1;const{format:a}=o.internalProps.layoutMap.getSeriesNumberBody(t,e);return typeof a=="function"?a(t,e,this,l):l}if(o.internalProps.layoutMap.isHeader(t,e)){const{title:l}=o.internalProps.layoutMap.getHeader(t,e);return typeof l=="function"?l():l}if(o.internalProps.layoutMap.isAggregation(t,e)){if(o.internalProps.layoutMap.isTopAggregation(t,e)){const l=o.internalProps.layoutMap.getAggregatorOnTop(t,e);return l!=null&&l.formatValue?l.formatValue(t,e,this):""}if(o.internalProps.layoutMap.isBottomAggregation(t,e)){const l=o.internalProps.layoutMap.getAggregatorOnBottom(t,e);return l!=null&&l.formatValue?l.formatValue(t,e,this):""}}const{field:r,fieldFormat:s}=o.internalProps.layoutMap.getBody(t,e);return o.getFieldData(s||r,t,e)}getCellOriginValue(t,e){if(t===-1||e===-1)return null;const n=this;if(n.internalProps.layoutMap.isSeriesNumber(t,e)){if(n.internalProps.layoutMap.isSeriesNumberInHeader(t,e)){const{title:s}=n.internalProps.layoutMap.getSeriesNumberHeader(t,e);return s}const{format:r}=n.internalProps.layoutMap.getSeriesNumberBody(t,e);return typeof r=="function"?r(t,e,this):e-this.columnHeaderLevelCount}if(n.internalProps.layoutMap.isHeader(t,e)){const{title:r}=n.internalProps.layoutMap.getHeader(t,e);return typeof r=="function"?r():r}if(n.internalProps.layoutMap.isAggregation(t,e)){if(n.internalProps.layoutMap.isTopAggregation(t,e)){const r=n.internalProps.layoutMap.getAggregatorOnTop(t,e);return r==null?void 0:r.value()}if(n.internalProps.layoutMap.isBottomAggregation(t,e)){const r=n.internalProps.layoutMap.getAggregatorOnBottom(t,e);return r==null?void 0:r.value()}}const{field:o}=n.internalProps.layoutMap.getBody(t,e);return n.getFieldData(o,t,e)}getCellRawValue(t,e){if(t===-1||e===-1)return null;const n=this;if(n.internalProps.layoutMap.isHeader(t,e)){const{title:r}=n.internalProps.layoutMap.getHeader(t,e);return typeof r=="function"?r():r}const{field:o}=n.internalProps.layoutMap.getBody(t,e);return n.getRawFieldData(o,t,e)}getRecordShowIndexByCell(t,e){const{layoutMap:n}=this.internalProps;return n.getRecordShowIndexByCell(t,e)}getRecordIndexByCell(t,e){const{layoutMap:n}=this.internalProps,o=n.getRecordShowIndexByCell(t,e);return this.dataSource.getRecordIndexPaths(o)}getTableIndexByRecordIndex(t){return this.transpose?this.dataSource.getTableIndex(t)+this.rowHeaderLevelCount:this.dataSource.getTableIndex(t)+this.columnHeaderLevelCount}getTableIndexByField(t){const e=this.internalProps.layoutMap.columnObjects.find(o=>o.field===t);if(!e)return-1;const n=this.internalProps.layoutMap.getBodyLayoutRangeById(e.id);return this.transpose?n.start.row:n.start.col}getCellAddrByFieldRecord(t,e){return this.transpose?{col:this.getTableIndexByRecordIndex(e),row:this.getTableIndexByField(t)}:{col:this.getTableIndexByField(t),row:this.getTableIndexByRecordIndex(e)}}getCellOriginRecord(t,e){const n=this,o=n.getRecordShowIndexByCell(t,e);if(o>-1)return n.dataSource.get(o)}getCellRawRecord(t,e){const n=this,o=n.getRecordShowIndexByCell(t,e);if(o>-1)return n.dataSource.getRaw(o)}_canResizeColumn(t,e){const n=super._canResizeColumn(t,e);if(n&&!this.transpose){const o=this.internalProps.layoutMap.getBody(t,this.columnHeaderLevelCount),r=this.internalProps.layoutMap.isSeriesNumber(t,e);if(o!=null&&o.disableColumnResize||r&&this.internalProps.rowSeriesNumber.disableColumnResize===!0)return!1}return n}updateOption(t){var e,n,o,r,s,l;const a=this.internalProps;if(super.updateOption(t),a.frozenColDragHeaderMode=t.frozenColDragHeaderMode,this.pagination=t.pagination,a.sortState=t.sortState,a.dataConfig=t.groupBy?fb(t.groupBy):{},this.showHeader=(e=t.showHeader)===null||e===void 0||e,a.columns=t.columns?bo(t.columns,["children"]):t.header?bo(t.header,["children"]):[],Vl(this),a.enableTreeNodeMerge=(o=(n=t.enableTreeNodeMerge)!==null&&n!==void 0?n:O(t.groupBy))!==null&&o!==void 0&&o,this.internalProps.headerHelper.setTableColumnsEditor(),this.transpose=(r=t.transpose)!==null&&r!==void 0&&r,this.refreshHeader(),this.internalProps.useOneRowHeightFillAll=!1,this.internalProps.columnWidthConfig=t.columnWidthConfig,a.releaseList&&(a.releaseList.forEach(h=>{var d;return(d=h==null?void 0:h.release)===null||d===void 0?void 0:d.call(h)}),a.releaseList=null),t.dataSource?this.dataSource=t.dataSource:t.records?this.setRecords(t.records,{sortState:t.sortState}):(this._resetFrozenColCount(),this.scenegraph.createSceneGraph(),this.render()),t.title){const h=ut.getComponent("title");a.title=new h(t.title,this),this.scenegraph.resize()}if(this.options.emptyTip)if(this.internalProps.emptyTip)(s=this.internalProps.emptyTip)===null||s===void 0||s.resetVisible();else{const h=ut.getComponent("emptyTip");this.internalProps.emptyTip=new h(this.options.emptyTip,this),(l=this.internalProps.emptyTip)===null||l===void 0||l.resetVisible()}return new Promise(h=>{setTimeout(h,0)})}updatePagination(t){this.pagination&&(typeof t.currentPage=="number"&&t.currentPage>=0&&(this.pagination.currentPage=t.currentPage),t.perPageCount&&(this.pagination.perPageCount=t.perPageCount||this.pagination.perPageCount),this.internalProps.layoutMap.clearCellRangeMap(),this.internalProps.useOneRowHeightFillAll=!1,this.scenegraph.clearCells(),this.dataSource.updatePagination(this.pagination),this.refreshRowColCount(),this.stateManager.initCheckedState(this.records),this.scenegraph.createSceneGraph(),this.renderAsync())}refreshHeader(){var t;const e=this.internalProps,n=this.transpose,o=this.showHeader;(e.layoutMap=new eI(this,(t=e.columns)!==null&&t!==void 0?t:[],o,this.options.hierarchyIndent)).transpose=n,n||this.setMinMaxLimitWidth(!0),this.refreshRowColCount()}refreshRowColCount(){var t,e,n,o,r,s,l,a,h,d,u,c,f,g,p,v,m,b;const C=this,{layoutMap:_}=C.internalProps;if(!_)return;const w=(e=(t=C.internalProps.dataSource)===null||t===void 0?void 0:t.length)!==null&&e!==void 0?e:0;_.recordsCount=w+(w>0?_.hasAggregationOnTopCount+_.hasAggregationOnBottomCount:0),C.transpose?(C.rowCount=(n=_.rowCount)!==null&&n!==void 0?n:0,C.colCount=(o=_.colCount)!==null&&o!==void 0?o:0,this.internalProps.frozenColCount=Math.max(((r=_.headerLevelCount)!==null&&r!==void 0?r:0)+_.leftRowSeriesNumberColumnCount,(s=this.options.frozenColCount)!==null&&s!==void 0?s:0),this.internalProps.frozenRowCount=(l=this.options.frozenRowCount)!==null&&l!==void 0?l:0,C.bottomFrozenRowCount!==((a=this.options.bottomFrozenRowCount)!==null&&a!==void 0?a:0)&&(C.bottomFrozenRowCount=(h=this.options.bottomFrozenRowCount)!==null&&h!==void 0?h:0),C.rightFrozenColCount!==((d=this.options.rightFrozenColCount)!==null&&d!==void 0?d:0)&&(C.rightFrozenColCount=(u=this.options.rightFrozenColCount)!==null&&u!==void 0?u:0)):(C.colCount=(c=_.colCount)!==null&&c!==void 0?c:0,C.rowCount=_.recordsCount*_.bodyRowSpanCount+_.headerLevelCount,this.internalProps.frozenColCount=(f=this.options.frozenColCount)!==null&&f!==void 0?f:0,C.frozenRowCount=Math.max(_.headerLevelCount,(g=this.options.frozenRowCount)!==null&&g!==void 0?g:0),C.bottomFrozenRowCount!==((p=this.options.bottomFrozenRowCount)!==null&&p!==void 0?p:0)&&(C.bottomFrozenRowCount=(v=this.options.bottomFrozenRowCount)!==null&&v!==void 0?v:0),C.rightFrozenColCount!==((m=this.options.rightFrozenColCount)!==null&&m!==void 0?m:0)&&(C.rightFrozenColCount=(b=this.options.rightFrozenColCount)!==null&&b!==void 0?b:0)),this.stateManager.setFrozenCol(this.internalProps.frozenColCount)}getFieldData(t,e,n){if(t===null||this.internalProps.layoutMap.isHeader(e,n))return null;const o=this.getRecordShowIndexByCell(this.transpose?e-this.internalProps.layoutMap.leftRowSeriesNumberColumnCount:e,n);return this.internalProps.dataSource.getField(o,t,e,n,this)}getRawFieldData(t,e,n){if(t===null||this.internalProps.layoutMap.isHeader(e,n))return null;const o=this.getRecordShowIndexByCell(e,n);return this.internalProps.dataSource.getRawField(o,t,e,n,this)}_moveHeaderPosition(t,e){const n=this.getCellRange(t.col,t.row),o=this.getCellRange(e.col,e.row),r=this.internalProps.layoutMap.moveHeaderPosition(t,e);return r?(r.moveType==="column"?(this.colWidthsMap.exchangeOrder(n.start.col,n.end.col-n.start.col+1,o.start.col,o.end.col-o.start.col+1,r.targetIndex),this.transpose||(this.colWidthsLimit={},this.setMinMaxLimitWidth())):r.targetIndex>r.sourceIndex?this.rowHeightsMap.exchangeOrder(r.sourceIndex,r.sourceSize,r.targetIndex+r.sourceSize-r.targetSize,r.targetSize,r.targetIndex):this.rowHeightsMap.exchangeOrder(r.sourceIndex,r.sourceSize,r.targetIndex,r.targetSize,r.targetIndex),r):null}changeRecordOrder(t,e){this.transpose?(t=this.getRecordShowIndexByCell(t,0),e=this.getRecordShowIndexByCell(e,0)):(t=this.getRecordShowIndexByCell(0,t),e=this.getRecordShowIndexByCell(0,e)),this.dataSource.changeOrder(t,e)}getCellAddress(t,e){let n;for(let r=0;r<this.internalProps.records.length;r++){const s=this.internalProps.records[r];if(typeof t=="function")t(s)&&(n=r);else{let l=!0;for(const a in t)if(s[a]!==t[a]){l=!1;break}l&&(n=r)}if(O(n))break}const o=this.getCellRangeByField(e,n);if(o)return{row:o.start.row,col:o.start.col}}getCellRangeByField(t,e){const{layoutMap:n}=this.internalProps,o=n.columnObjects.find(r=>r.field===t);if(o){const r=n.getBodyLayoutRangeById(o.id);let s;return O(e)&&(s=n.getRecordStartRowByRecordIndex(e)),this.transpose?{start:{row:r.start.row,col:O(s)?s+r.start.col:void 0},end:{row:r.end.row,col:O(s)?s+r.end.col:void 0}}:{start:{col:r.start.col,row:O(s)?s+r.start.row:void 0},end:{col:r.end.col,row:O(s)?s+r.end.row:void 0}}}return null}getHierarchyState(t,e){if((!this.options.groupBy||Q(this.options.groupBy)&&this.options.groupBy.length===0)&&!this.getBodyColumnDefine(t,e).tree)return mt.none;const n=this.getRecordShowIndexByCell(t,e);return this.dataSource.getHierarchyState(n)}toggleHierarchyState(t,e,n=!0){this.stateManager.updateHoverIcon(t,e,void 0,void 0);const o=this.getHierarchyState(t,e);if(o===mt.expand)this._refreshHierarchyState(t,e,n),this.fireListeners(U.TREE_HIERARCHY_STATE_CHANGE,{col:t,row:e,hierarchyState:mt.collapse});else if(o===mt.collapse){const r=this.getCellOriginRecord(t,e);Array.isArray(r.children)&&this._refreshHierarchyState(t,e,n),this.fireListeners(U.TREE_HIERARCHY_STATE_CHANGE,{col:t,row:e,hierarchyState:mt.expand,originData:r})}}setLoadingHierarchyState(t,e){this.scenegraph.setLoadingHierarchyState(t,e)}_refreshHierarchyState(t,e,n=!0){var o,r;let s=!1,l=!1;const a=this.internalProps.layoutMap.checkHasChart();a&&(this.autoFillWidth&&(s=this.getAllColsWidth()<=this.tableNoFrameWidth),this.autoFillHeight&&(l=this.getAllRowsHeight()<=this.tableNoFrameHeight));const h=this.getRecordShowIndexByCell(t,e),d=this.dataSource.toggleHierarchyState(h,this.scenegraph.proxy.rowStart-this.columnHeaderLevelCount,Math.max(this.scenegraph.proxy.rowEnd-this.columnHeaderLevelCount,this.scenegraph.proxy.rowStart-this.columnHeaderLevelCount+this.scenegraph.proxy.rowLimit-1)),u=this.internalProps.layoutMap.toggleHierarchyState(d);this.refreshRowColCount();for(let p=this.rowCount-this.bottomFrozenRowCount;p<this.rowCount;p++){const v=yi(p,0,this.colCount-1,this);this._setRowHeight(p,v)}this.clearCellStyleCache(),this.internalProps.layoutMap.clearCellRangeMap(),this.internalProps.useOneRowHeightFillAll=!1;const{updateCells:c,addCells:f,removeCells:g}=dI(u,t,e,this);(o=this.reactCustomLayout)===null||o===void 0||o.clearCache(),this.scenegraph.updateRow(g,f,c,n,!0),(r=this.reactCustomLayout)===null||r===void 0||r.updateAllCustomCell(),a&&(this.autoFillWidth&&!s&&(s=this.getAllColsWidth()<=this.tableNoFrameWidth),this.autoFillHeight&&!l&&(l=this.getAllRowsHeight()<=this.tableNoFrameHeight),(this.widthMode==="adaptive"||s||this.heightMode==="adaptive"||l)&&this.scenegraph.updateChartSizeForResizeColWidth(-1))}_hasHierarchyTreeHeader(){var t,e;return(e=(t=this.options.columns)!==null&&t!==void 0?t:this.options.header)===null||e===void 0?void 0:e.some((n,o)=>n.tree)}getMenuInfo(t,e,n){return{field:this.getHeaderField(t,e),value:this.getCellValue(t,e),cellLocation:this.getCellLocation(t,e),event:void 0}}_getSortFuncFromHeaderOption(t,e,n){if(t||(t=this.internalProps.columns),e&&t&&t.length>0)for(let o=0;o<t.length;o++){const r=t[o];if((n&&n===r.fieldKey||!n&&r.field===e)&&r.sort&&typeof r.sort=="function")return r.sort;if(r.columns){const s=this._getSortFuncFromHeaderOption(r.columns,e,n);if(s)return s}}}updateSortState(t,e=!0){var n;if(t)this.internalProps.sortState=t;else if(this.internalProps.sortState)if(Array.isArray(this.internalProps.sortState))for(let o=0;o<this.internalProps.sortState.length;o++)(t=(n=this.internalProps.sortState)===null||n===void 0?void 0:n[o])&&(t.order="normal");else this.internalProps.sortState.order="normal",t=this.internalProps.sortState;(t=Array.isArray(t)?t:[t]).some(o=>o.field)&&e&&this.internalProps.layoutMap.headerObjects.some(o=>o.define.sort!==!1)&&(this.dataSource.sort(t.map(o=>{const r=this._getSortFuncFromHeaderOption(this.internalProps.columns,o.field);return this.internalProps.layoutMap.headerObjects.find(s=>s&&s.field===o.field),{field:o.field,order:o.order,orderFn:r??ah}})),this.internalProps.layoutMap.clearCellRangeMap(),this.internalProps.useOneRowHeightFillAll=!1,this.scenegraph.sortCell()),t.length&&this.stateManager.updateSortState(t)}updateFilterRules(t){this.scenegraph.clearCells(),this.sortState?(this.dataSource.updateFilterRulesForSorted(t),Qe(this)):this.dataSource.updateFilterRules(t),this.refreshRowColCount(),this.stateManager.initCheckedState(this.records),this.scenegraph.createSceneGraph()}getCheckboxState(t){if(this.stateManager.checkedState.size<this.rowCount-this.columnHeaderLevelCount&&this.stateManager.initLeftRecordsCheckState(this.records),O(t)){let e=Array.from(this.stateManager.checkedState.keys()).sort((n,o)=>Number(n)-Number(o)).map(n=>this.stateManager.checkedState.get(n));return this.options.groupBy&&(e=XL(this)),Array.from(e,n=>n[t])}return new Array(...this.stateManager.checkedState.values())}getCellCheckboxState(t,e){var n;const o=this.getBodyColumnDefine(t,e),r=o==null?void 0:o.field,s=this.getCellType(t,e);if(O(r)&&(s==="checkbox"||s==="switch")){const l=this.dataSource.getIndexKey(this.getRecordShowIndexByCell(t,e)).toString();return(n=this.stateManager.checkedState.get(l))===null||n===void 0?void 0:n[r]}}getRadioState(t){return O(t)?this.stateManager.radioState[t]:this.stateManager.radioState}getCellRadioState(t,e){return IL(t,e,this)}setCellCheckboxState(t,e,n){KL(t,e,n,this)}setCellRadioState(t,e,n){DL(t,e,n,this)}getSwitchState(t){return this.getCheckboxState(t)}getCellSwitchState(t,e){return this.getCellCheckboxState(t,e)}setCellSwitchState(t,e,n){this.setCellCheckboxState(t,e,n)}setRecords(t,e){var n,o,r,s;let l;(n=this.internalProps.dataSource)===null||n===void 0||n.release(),this.internalProps.releaseList=(o=this.internalProps.releaseList)===null||o===void 0?void 0:o.filter(h=>!h.dataSourceObj),this.internalProps.dataSource=null,Array.isArray(e)||e!=null&&e.order?l=e:e?l=e.sortState:e===null&&(l=null),typeof window<"u"&&window.performance.now();const a={col:this.stateManager.hover.cellPos.col,row:this.stateManager.hover.cellPos.row};if(this.scenegraph.clearCells(),l!==void 0&&(l===null||!Array.isArray(l)&&O(l.field)||Array.isArray(l))&&(this.internalProps.sortState=this.internalProps.multipleSort?Array.isArray(l)?l:[l]:l,this.stateManager.setSortState(this.sortState)),t){if(Nv(this,t),this.sortState){const h=Array.isArray(this.sortState)?this.sortState:[this.sortState];h.some(d=>d.order&&d.field&&d.order!=="normal")&&this.internalProps.layoutMap.headerObjectsIncludeHided.some(d=>d.define.sort!==!1)&&this.dataSource.sort(h.map(d=>{const u=this._getSortFuncFromHeaderOption(void 0,d.field);return this.internalProps.layoutMap.headerObjectsIncludeHided.find(c=>c&&c.field===d.field),{field:d.field,order:d.order||"asc",orderFn:u??ah}}))}this.refreshRowColCount()}else Nv(this,t);if(this.stateManager.initCheckedState(t),this.clearCellStyleCache(),this.scenegraph.createSceneGraph(),this.stateManager.updateHoverPos(a.col,a.row),this.internalProps.title&&!this.internalProps.title.isReleased&&(this._updateSize(),this.internalProps.title.resize(),this.scenegraph.resize()),this.options.emptyTip)if(this.internalProps.emptyTip)(r=this.internalProps.emptyTip)===null||r===void 0||r.resetVisible();else{const h=ut.getComponent("emptyTip");this.internalProps.emptyTip=new h(this.options.emptyTip,this),(s=this.internalProps.emptyTip)===null||s===void 0||s.resetVisible()}this.render(),O(a.col)&&O(a.row)&&a.col>=0&&a.row>=0&&setTimeout(()=>{var h;(h=this.internalProps)===null||h===void 0||h.tooltipHandler.showTooltip(a.col,a.row)},0)}setRecordChildren(t,e,n,o=!0){const r=this.getCellOriginRecord(e,n);r.children=t;const s=this.getRecordShowIndexByCell(e,n);this.dataSource.setRecord(r,s),this._refreshHierarchyState(e,n,o)}startEditCell(t,e,n){var o;if(O(t)&&O(e))this.eventManager.isDraging=!1,this.selectCell(t,e),this.editorManager.startEditCell(t,e,n);else if(!((o=this.stateManager.select)===null||o===void 0)&&o.cellPos){const{col:r,row:s}=this.stateManager.select.cellPos;O(r)&&O(s)&&this.editorManager.startEditCell(r,s,n)}}completeEditCell(){this.editorManager.completeEdit()}getEditor(t,e){var n,o;const r=this.getBodyColumnDefine(t,e);let s=this.isHeader(t,e)?(n=r==null?void 0:r.headerEditor)!==null&&n!==void 0?n:this.options.headerEditor:(o=r==null?void 0:r.editor)!==null&&o!==void 0?o:this.options.editor;return typeof s=="function"&&(s=s({col:t,row:e,dataValue:this.getCellOriginValue(t,e),value:this.getCellValue(t,e)||"",table:this})),typeof s=="string"?mz(s):s}isHasEditorDefine(t,e){var n,o;const r=this.getBodyColumnDefine(t,e);let s=this.isHeader(t,e)?(n=r==null?void 0:r.headerEditor)!==null&&n!==void 0?n:this.options.headerEditor:(o=r==null?void 0:r.editor)!==null&&o!==void 0?o:this.options.editor;return typeof s=="function"&&(s=s({col:t,row:e,dataValue:this.getCellOriginValue(t,e),value:this.getCellValue(t,e)||"",table:this})),O(s)}changeCellValue(t,e,n,o=!1){return nI(t,e,n,o,this)}changeCellValues(t,e,n,o=!1){return oI(t,e,n,o,this)}addRecord(t,e){var n;sI(t,e,this),(n=this.internalProps.emptyTip)===null||n===void 0||n.resetVisible()}addRecords(t,e){var n;lI(t,e,this),(n=this.internalProps.emptyTip)===null||n===void 0||n.resetVisible()}deleteRecords(t){var e;aI(t,this),(e=this.internalProps.emptyTip)===null||e===void 0||e.resetVisible()}updateRecords(t,e){hI(t,e,this)}_hasCustomRenderOrLayout(){var t,e,n,o;const{headerObjects:r}=this.internalProps.layoutMap;if(this.options.customRender)return!0;for(let s=0;s<r.length;s++){const l=r[s];if(!((t=l==null?void 0:l.define)===null||t===void 0)&&t.customLayout||!((e=l==null?void 0:l.define)===null||e===void 0)&&e.headerCustomLayout||!((n=l==null?void 0:l.define)===null||n===void 0)&&n.customRender||!((o=l==null?void 0:l.define)===null||o===void 0)&&o.headerCustomRender)return!0}return!1}getAggregateValuesByField(t){const e=this.internalProps.layoutMap.getColumnByField(t),n=[];for(let o=0;o<e.length;o++){const r=e[o].columnDefine.aggregator;if(delete e[o].columnDefine,r){const s={col:e[o].col,aggregateValue:null};if(s.aggregateValue=[],Array.isArray(r))for(let l=0;l<r.length;l++)s.aggregateValue.push({aggregationType:r[l].type,value:r[l].value()});else s.aggregateValue.push({aggregationType:r.type,value:r.value()});n.push(s)}}return n}isAggregation(t,e){return this.internalProps.layoutMap.isAggregation(t,e)}getGroupTitleLevel(t,e){var n;if(!this.options.groupBy)return;const o=this.dataSource.getIndexKey(this.getRecordShowIndexByCell(t,e)),r=(n=this.dataSource.getGroupLength())!==null&&n!==void 0?n:0;let s=Q(o)?o.length-1:0;return r>0&&s===r&&(s=void 0),s}getBodyRowIndexByRecordIndex(t){return Array.isArray(t)&&t.length===1&&(t=t[0]),this.dataSource.getTableIndex(t)}_parseColumnWidthConfig(t){for(let e=0;e<(t==null?void 0:t.length);e++){const n=t[e],o=n.key,r=n.width,s=this.internalProps.layoutMap.getColumnByKey(o);if(s.columnDefine){const{col:l}=s;this.internalProps._widthResizedColMap.has(l)||(this._setColWidth(l,r),this.internalProps._widthResizedColMap.add(l))}}}release(){this.editorManager.release(),super.release()}}function gg(i){return i==="bottom"||i==="top"}function cI(i){return i==="left"||i==="right"}var An;(function(i){i.Identity="identity",i.Linear="linear",i.Log="log",i.Pow="pow",i.Sqrt="sqrt",i.Symlog="symlog",i.Time="time",i.Quantile="quantile",i.Quantize="quantize",i.Threshold="threshold",i.Ordinal="ordinal",i.Point="point",i.Band="band"})(An||(An={}));Object.values(An).forEach(i=>{});function Qo(i){return i}const gI=i=>-Math.log(-i),fI=i=>-Math.exp(-i),pI=i=>isFinite(i)?Math.pow(10,i):i<0?0:i,pb=i=>i===10?pI:i===Math.E?Math.exp:t=>Math.pow(i,t),vb=i=>i===Math.E?Math.log:i===10?Math.log10:i===2?Math.log2:(i=Math.log(i),t=>Math.log(t)/i),mb=i=>t=>Math.sign(t)*Math.log1p(Math.abs(t/i)),bb=i=>t=>Math.sign(t)*Math.expm1(Math.abs(t))*i;function fg(i,t){if(i=Number(i),t=Number(t),t-=i)return n=>(n-i)/t;const e=Number.isNaN(t)?NaN:.5;return()=>e}function Cb(i,t,e){const n=i[0],o=i[1],r=t[0],s=t[1];let l,a;return o<n?(l=fg(o,n),a=e(s,r)):(l=fg(n,o),a=e(r,s)),h=>a(l(h))}function af(i,t,e){let n;return n=i===1?i+2*e:i-t+2*e,i?n>0?n:1:0}function vI(i,t,e,n){return e===1&&(e=0),af(i,e,n)*(t/(1-e))}function mI(i,t,e,n,o){const r=af(i,e,n);let s=t/Math.max(1,r||1);o&&(s=Math.floor(s));let l=s*(1-e);return o&&(l=Math.round(l)),l}function ty(i,t){const e=(i[1]-i[0])/(t[1]-t[0]),n=i[0]-e*t[0];return[n,e+n]}function bI(i,t,e){const n=Math.min(i.length,t.length)-1,o=new Array(n),r=new Array(n);let s=-1;for(i[n]<i[0]&&(i=i.slice().reverse(),t=t.slice().reverse());++s<n;)o[s]=fg(i[s],i[s+1]),r[s]=e(t[s],t[s+1]);return function(l){const a=Pz(i,l,1,n)-1;return r[a](o[a](l))}}const CI=(i,t)=>{const e=i.slice();let n=0,o=e.length-1,r=e[n],s=e[o];return s<r&&([n,o]=[o,n],[r,s]=[s,r]),e[n]=t.floor(r),e[o]=t.ceil(s),e},ey=(i,t=!1)=>{const e=Math.floor(Math.log10(i)),n=i/Math.pow(10,e);let o;return o=t?n<1.5?1:n<3?2:n<7?5:10:n<=1?1:n<=2?2:n<=5?5:10,o*Math.pow(10,e)},_I=(i,t)=>{let e,n;return t[0]<t[1]?(e=t[0],n=t[1]):(e=t[1],n=t[0]),Math.min(Math.max(i,e),n)};class iy{constructor(){this._rangeFactorStart=null,this._rangeFactorEnd=null}_calculateWholeRange(t){return this._wholeRange?this._wholeRange:te(this._rangeFactorStart)&&te(this._rangeFactorEnd)&&t.length===2?(this._wholeRange=ty(t,[this._rangeFactorStart,this._rangeFactorEnd]),this._wholeRange):t}rangeFactor(t,e,n){return t?(t.length===2&&t.every(o=>o>=0&&o<=1)&&(this._wholeRange=null,t[0]===0&&t[1]===1?(this._rangeFactorStart=null,this._rangeFactorEnd=null):(this._rangeFactorStart=t[0],this._rangeFactorEnd=t[1])),this):n?(this._wholeRange=null,this._rangeFactorStart=null,this._rangeFactorEnd=null,this):te(this._rangeFactorStart)&&te(this._rangeFactorEnd)?[this._rangeFactorStart,this._rangeFactorEnd]:null}rangeFactorStart(t,e){var n;return Se(t)?this._rangeFactorStart:(t>=0&&t<=1&&(this._wholeRange=null,t!==0||!Se(this._rangeFactorEnd)&&this._rangeFactorEnd!==1?(this._rangeFactorStart=t,this._rangeFactorEnd=(n=this._rangeFactorEnd)!==null&&n!==void 0?n:1):(this._rangeFactorStart=null,this._rangeFactorEnd=null)),this)}rangeFactorEnd(t,e){var n;return Se(t)?this._rangeFactorEnd:(t>=0&&t<=1&&(this._wholeRange=null,t!==0||!Se(this._rangeFactorStart)&&this._rangeFactorStart!==0?(this._rangeFactorEnd=t,this._rangeFactorStart=(n=this._rangeFactorStart)!==null&&n!==void 0?n:0):(this._rangeFactorStart=null,this._rangeFactorEnd=null)),this)}generateFishEyeTransform(){var t;if(!this._fishEyeOptions)return void(this._fishEyeTransform=null);const{distortion:e=2,radiusRatio:n=.1,radius:o}=this._fishEyeOptions,r=this.range(),s=r[0],l=r[r.length-1],a=Math.min(s,l),h=Math.max(s,l),d=qw((t=this._fishEyeOptions.focus)!==null&&t!==void 0?t:0,a,h),u=Se(o)?(h-a)*n:o;let c=Math.exp(e);c=c/(c-1)*u;const f=e/u;this._fishEyeTransform=g=>{const p=Math.abs(g-d);if(p>=u)return g;if(p<=1e-6)return d;const v=c*(1-Math.exp(-p*f))/p*.75+.25;return d+(g-d)*v}}unknown(t){return arguments.length?(this._unknown=t,this):this._unknown}get(t,e){var n;return(n=this==null?void 0:this[t])!==null&&n!==void 0?n:e}}const pg=Symbol("implicit");class hf extends iy{specified(t){var e;return t?(this._specified=Object.assign((e=this._specified)!==null&&e!==void 0?e:{},t),this):Object.assign({},this._specified)}_getSpecifiedValue(t){if(this._specified)return this._specified[t]}constructor(){super(),this.type=An.Ordinal,this._index=new Map,this._domain=[],this._ordinalRange=[],this._unknown=pg}clone(){const t=new hf().domain(this._domain).range(this._ordinalRange).unknown(this._unknown);return this._specified&&t.specified(this._specified),t}calculateVisibleDomain(t){return te(this._rangeFactorStart)&&te(this._rangeFactorEnd)&&t.length===2?[this.invert(t[0]),this.invert(t[1])]:this._domain}scale(t){const e=`${t}`,n=this._getSpecifiedValue(e);if(n!==void 0)return n;let o=this._index.get(e);if(!o){if(this._unknown!==pg)return this._unknown;o=this._domain.push(t),this._index.set(e,o)}const r=this._ordinalRange[(o-1)%this._ordinalRange.length];return this._fishEyeTransform?this._fishEyeTransform(r):r}invert(t){let e=0;for(;e<this._ordinalRange.length&&this._ordinalRange[e]!==t;)e++;return this._domain[(e-1)%this._domain.length]}domain(t){if(!t)return this._domain.slice();this._domain=[],this._index=new Map;for(const e of t){const n=`${e}`;this._index.has(n)||this._index.set(n,this._domain.push(e))}return this}range(t){if(!t)return this._ordinalRange.slice();const e=Array.from(t);return this._ordinalRange=e,this}index(t){var e;return this._index&&(e=this._index.get(`${t}`))!==null&&e!==void 0?e:-1}}function ny(i,t,e,n){const o=[];let r=i;for(;r<=t;)o.push(r),r+=e;return n&&o.reverse(),o}function _b(i,t,e,n){let o,r;if(t=Math.floor(+t),i=Math.floor(+i),!(e=Math.floor(+e)))return[];if(i===t)return[i];if(o=t<i){const l=i;i=t,t=l}let s=sf(1,t-i+1)(e);if(r=Math.floor((t-i+1)/s),!n)for(;Math.ceil((t-i+1)/r)>e&&s>1;)s-=1,r=Math.floor((t-i)/s);return ny(i,t,r,o)}function wI(i,t,e){let n;if(t=Math.floor(+t),i=Math.floor(+i),e=sf(1,t-i+1)(Math.floor(+e)),n=t<i){const o=i;i=t,t=o}return ny(i,t,e,n)}class Md extends hf{constructor(t){super(),this.type=An.Band,this._range=[0,1],this._step=void 0,this._bandwidth=void 0,this._isFixed=!1,this._round=!1,this._paddingInner=0,this._paddingOuter=0,this._align=.5,this._unknown=void 0,delete this.unknown,this.rescale(t)}rescale(t,e){if(t)return this;this._wholeRange=null;const n=this._calculateWholeRange(this._range,e),o=super.domain().length,r=n[1]<n[0];let s=n[Number(r)-0];const l=n[1-Number(r)],a=af(o,this._paddingInner,this._paddingOuter);return this._step=(l-s)/Math.max(1,a||1),this._round&&(this._step=Math.floor(this._step)),s+=(l-s-this._step*(o-this._paddingInner))*this._align,this.isBandwidthFixed()||(this._bandwidth=this._step*(1-this._paddingInner)),this._round&&(s=Math.round(s),this.isBandwidthFixed()||(this._bandwidth=Math.round(this._bandwidth))),this._bandRangeState={reverse:r,start:r?s+this._step*(o-1):s,count:o},this.generateFishEyeTransform(),this}scale(t){if(!this._bandRangeState)return;const e=`${t}`,n=this._getSpecifiedValue(e);if(n!==void 0)return n;let o=this._index.get(e);if(!o){if(this._unknown!==pg)return this._unknown;o=this._domain.push(t),this._index.set(e,o)}const{count:r,start:s,reverse:l}=this._bandRangeState,a=s+(l?-1:1)*((o-1)%r)*this._step;return this._fishEyeTransform?this._fishEyeTransform(a):a}_calculateWholeRange(t,e){if(this._wholeRange)return this._wholeRange;if((this._minBandwidth||this._maxBandwidth)&&!this._isBandwidthFixedByUser()){let n;if(te(this._rangeFactorStart)&&te(this._rangeFactorEnd)&&t.length===2){const r=ty(t,[this._rangeFactorStart,this._rangeFactorEnd]);n=Math.abs(r[1]-r[0])}else n=Math.abs(t[1]-t[0]);const o=mI(super.domain().length,n,this._paddingInner,this._paddingOuter,this._round);o<this._minBandwidth?(this._bandwidth=this._minBandwidth,this._isFixed=!0):o>this._maxBandwidth?(this._bandwidth=this._maxBandwidth,this._isFixed=!0):(this._bandwidth=o,this._isFixed=!1)}if(this.isBandwidthFixed()){const n=vI(super.domain().length,this._bandwidth,this._paddingInner,this._paddingOuter)*Math.sign(t[1]-t[0]),o=Math.min((t[1]-t[0])/n,1);if(te(this._rangeFactorStart)&&te(this._rangeFactorEnd)){if(n>0){const l=t[0]-n*this._rangeFactorStart,a=l+n;this._wholeRange=[l,a]}else{const l=t[1]+n*(1-this._rangeFactorEnd),a=l-n;this._wholeRange=[a,l]}const r=this._rangeFactorStart+o<=1,s=this._rangeFactorEnd-o>=0;e==="rangeFactorStart"&&r?this._rangeFactorEnd=this._rangeFactorStart+o:e==="rangeFactorEnd"&&s?this._rangeFactorStart=this._rangeFactorEnd-o:t[0]<=t[1]?r?this._rangeFactorEnd=this._rangeFactorStart+o:s?this._rangeFactorStart=this._rangeFactorEnd-o:(this._rangeFactorStart=0,this._rangeFactorEnd=o):s?this._rangeFactorStart=this._rangeFactorEnd-o:r?this._rangeFactorEnd=this._rangeFactorStart+o:(this._rangeFactorStart=1-o,this._rangeFactorEnd=1)}else this._rangeFactorStart=0,this._rangeFactorEnd=o,this._wholeRange=[t[0],t[0]+n];return this._wholeRange}return super._calculateWholeRange(t)}calculateWholeRangeSize(){const t=this._calculateWholeRange(this._range);return Math.abs(t[1]-t[0])}calculateVisibleDomain(t){const e=this._domain;if(te(this._rangeFactorStart)&&te(this._rangeFactorEnd)&&e.length){const n=this._getInvertIndex(t[0]),o=this._getInvertIndex(t[1]);return e.slice(Math.min(n,o),Math.max(n,o)+1)}return e}domain(t,e){return t?(super.domain(t),this.rescale(e)):super.domain()}range(t,e){return t?(this._range=[gs(t[0]),gs(t[1])],this.rescale(e)):this._range}rangeRound(t,e){return this._range=[gs(t[0]),gs(t[1])],this._round=!0,this.rescale(e)}ticks(t=10){const e=this.calculateVisibleDomain(this._range);return t===-1?e:_b(0,e.length-1,t,!1).map(n=>e[n])}tickData(t=10){return this.ticks(t).map((e,n)=>({index:n,tick:e,value:(this.scale(e)-this._range[0]+this._bandwidth/2)/(this._range[1]-this._range[0])}))}forceTicks(t=10){const e=this.calculateVisibleDomain(this._range);return _b(0,e.length-1,t,!0).filter(n=>n<e.length).map(n=>e[n])}stepTicks(t){const e=this.calculateVisibleDomain(this._range);return wI(0,e.length-1,t).map(n=>e[n])}_getInvertIndex(t){let e=0;const n=this.step()/2,o=this.bandwidth()/2,r=this._domain.length,s=this.range(),l=s[0]>s[s.length-1];for(e=0;e<r;e++){const a=this.scale(this._domain[e])+o;if(e===0&&(!l&&!sb(t,a+n)||l&&!lb(t,a-n))||e===r-1||!lb(t,a-n)&&!sb(t,a+n))break}return e>=0&&e<=r-1?e:r-1}invert(t){return this._domain[this._getInvertIndex(t)]}padding(t,e){return t!==void 0?(this._paddingOuter=Math.max(0,Math.min(Array.isArray(t)?Math.min.apply(null,t):t)),this._paddingInner=this._paddingOuter,this.rescale(e)):this._paddingInner}paddingInner(t,e){return t!==void 0?(this._paddingInner=Math.max(0,Math.min(1,t)),this.rescale(e)):this._paddingInner}paddingOuter(t,e){return t!==void 0?(this._paddingOuter=Math.max(0,Math.min(1,t)),this.rescale(e)):this._paddingOuter}step(){return this._step}round(t,e){return t!==void 0?(this._round=t,this.rescale(e)):this._round}align(t,e){return t!==void 0?(this._align=Math.max(0,Math.min(1,t)),this.rescale(e)):this._align}rangeFactor(t,e){return t?(super.rangeFactor(t),this.rescale(e)):super.rangeFactor()}rangeFactorStart(t,e){return Se(t)?super.rangeFactorStart():(super.rangeFactorStart(t),this.rescale(e,"rangeFactorStart"))}rangeFactorEnd(t,e){return Se(t)?super.rangeFactorEnd():(super.rangeFactorEnd(t),this.rescale(e,"rangeFactorEnd"))}bandwidth(t,e){return t?(t==="auto"?(this._bandwidth=void 0,this._isFixed=!1):(this._bandwidth=t,this._isFixed=!0),this._userBandwidth=t,this.rescale(e)):this._bandwidth}maxBandwidth(t,e){return t?(this._maxBandwidth=t==="auto"?void 0:t,this.rescale(e)):this._maxBandwidth}minBandwidth(t,e){return t?(this._minBandwidth=t==="auto"?void 0:t,this.rescale(e)):this._minBandwidth}fishEye(t,e,n){return t||n?(this._fishEyeOptions=t,this._fishEyeTransform=null,this.rescale(e)):this._fishEyeOptions}isBandwidthFixed(){return this._isFixed&&!!this._bandwidth}_isBandwidthFixedByUser(){return this._isFixed&&this._userBandwidth&&Ge(this._userBandwidth)}clone(){var t,e,n;return new Md(!0).domain(this._domain,!0).range(this._range,!0).round(this._round,!0).paddingInner(this._paddingInner,!0).paddingOuter(this._paddingOuter,!0).align(this._align,!0).bandwidth((t=this._userBandwidth)!==null&&t!==void 0?t:"auto",!0).maxBandwidth((e=this._maxBandwidth)!==null&&e!==void 0?e:"auto",!0).minBandwidth((n=this._maxBandwidth)!==null&&n!==void 0?n:"auto")}}const{interpolateRgb:mu}=Wz;function yI(i,t){const e=typeof t;let n;if(Se(t)||e==="boolean")return()=>t;if(e==="number")return ra(i,t);if(e==="string"){if(n=Fi.parseColorString(t)){const o=mu(Fi.parseColorString(i),n);return r=>o(r).formatRgb()}return ra(Number(i),Number(t))}return t instanceof Ue?mu(i,t):t instanceof Fi?mu(i.color,t.color):t instanceof Date?Lz(i,t):ra(Number(i),Number(t))}class oy extends iy{constructor(t=Qo,e=Qo){super(),this._unknown=void 0,this.transformer=t,this.untransformer=e,this._forceAlign=!0,this._domain=[0,1],this._range=[0,1],this._clamp=Qo,this._piecewise=Cb,this._interpolate=yI}calculateVisibleDomain(t){var e;return te(this._rangeFactorStart)&&te(this._rangeFactorEnd)&&t.length===2?[this.invert(t[0]),this.invert(t[1])]:(e=this._niceDomain)!==null&&e!==void 0?e:this._domain}fishEye(t,e,n){return t||n?(this._fishEyeOptions=t,this._fishEyeTransform=null,this.rescale(e)):this._fishEyeOptions}scale(t){var e;if(t=Number(t),Number.isNaN(t)||this._domainValidator&&!this._domainValidator(t))return this._unknown;this._output||(this._output=this._piecewise(((e=this._niceDomain)!==null&&e!==void 0?e:this._domain).map(this.transformer),this._calculateWholeRange(this._range),this._interpolate));const n=this._output(this.transformer(this._clamp(t)));return this._fishEyeTransform?this._fishEyeTransform(n):n}invert(t){var e;return this._input||(this._input=this._piecewise(this._calculateWholeRange(this._range),((e=this._niceDomain)!==null&&e!==void 0?e:this._domain).map(this.transformer),ra)),this._clamp(this.untransformer(this._input(t)))}domain(t,e){var n;if(!t)return((n=this._niceDomain)!==null&&n!==void 0?n:this._domain).slice();this._domainValidator=null,this._niceType=null,this._niceDomain=null;const o=Array.from(t,gs);return this._domain=o,this.rescale(e)}range(t,e){if(!t)return this._range.slice();const n=Array.from(t);return this._range=n,this.rescale(e)}rangeRound(t,e){const n=Array.from(t);return this._range=n,this._interpolate=Ez,this.rescale(e)}rescale(t){var e;if(t)return this;const n=(e=this._niceDomain)!==null&&e!==void 0?e:this._domain,o=n.length,r=this._range.length;let s=Math.min(o,r);if(o&&o<r&&this._forceAlign){const l=r-o+1,a=n[o-1],h=o>=2?(a-n[o-2])/l:0;for(let d=1;d<=l;d++)n[o-2+d]=a-h*(l-d);s=r}return this._autoClamp&&(this._clamp=sf(n[0],n[s-1])),this._piecewise=s>2?bI:Cb,this._output=this._input=null,this._wholeRange=null,this.generateFishEyeTransform(),this}clamp(t,e,n){return arguments.length?(e?(this._autoClamp=!1,this._clamp=e):(this._autoClamp=!!t,this._clamp=t?void 0:Qo),this.rescale(n)):this._clamp!==Qo}interpolate(t,e){return arguments.length?(this._interpolate=t,this.rescale(e)):this._interpolate}ticks(t=10){return[]}tickData(t=10){const e=this.ticks(t);return(e??[]).map((n,o)=>({index:o,tick:n,value:(this.scale(n)-this._range[0])/(this._range[1]-this._range[0])}))}rangeFactor(t,e){return t?(super.rangeFactor(t),this._output=this._input=null,this):super.rangeFactor()}rangeFactorStart(t,e){return Se(t)?super.rangeFactorStart():(super.rangeFactorStart(t),this._output=this._input=null,this)}rangeFactorEnd(t,e){return Se(t)?super.rangeFactorEnd():(super.rangeFactorEnd(t),this._output=this._input=null,this)}forceAlignDomainRange(t){return arguments.length?(this._forceAlign=t,this):this._forceAlign}}const SI=Math.sqrt(50),xI=Math.sqrt(10),RI=Math.sqrt(2),ql=[1,2,5,10],wb=(i,t,e)=>{let n=1,o=i;const r=Math.floor((t-1)/2),s=Math.abs(i);return i>=0&&i<=Number.MIN_VALUE?o=0:i<0&&i>=-Number.MIN_VALUE?o=-(t-1):!e&&s<1?n=ry(s).step:(e||s>1)&&(o=Math.floor(i)-r*n),n>0?(i>0?o=Math.max(o,0):i<0&&(o=Math.min(o,-(t-1)*n)),Bz(0,t).map(l=>o+l*n)):i>0?Vh(0,-(t-1)/n,n):Vh((t-1)/n,0,n)},AI=cl((i,t,e,n)=>{let o,r,s,l,a=-1;if(e=+e,(i=+i)==(t=+t))return[i];if(Math.abs(i-t)<=Number.MIN_VALUE&&e>0)return[i];if((o=t<i)&&(r=i,i=t,t=r),l=df(i,t,e).step,!isFinite(l))return[];if(l>0){let h=Math.round(i/l),d=Math.round(t/l);for(h*l<i&&++h,d*l>t&&--d,s=new Array(r=d-h+1);++a<r;)s[a]=(h+a)*l}else if(l<0&&(n!=null&&n.noDecimals)){l=1;const h=Math.ceil(i),d=Math.floor(t);if(!(h<=d))return[];for(s=new Array(r=d-h+1);++a<r;)s[a]=h+a}else{l=-l;let h=Math.round(i*l),d=Math.round(t*l);for(h/l<i&&++h,d/l>t&&--d,s=new Array(r=d-h+1);++a<r;)s[a]=(h+a)/l}return o&&s.reverse(),s}),Vh=(i,t,e)=>{let n,o,r=-1;if(e>0){let s=Math.floor(i/e),l=Math.ceil(t/e);for((s+1)*e<i&&++s,(l-1)*e>t&&--l,o=new Array(n=l-s+1);++r<n;)o[r]=(s+r)*e}else{e=-e;let s=Math.floor(i*e),l=Math.ceil(t*e);for((s+1)/e<i&&++s,(l-1)/e>t&&--l,o=new Array(n=l-s+1);++r<n;)o[r]=(s+r)/e}return o},BI=(i,t,e)=>{let n;const o=i[0],r=i[i.length-1],s=t-i.length;if(r<=0){const h=[];for(n=s;n>=1;n--)h.push(o-n*e);return h.concat(i)}if(o>=0){for(n=1;n<=s;n++)i.push(r+n*e);return i}let l=[];const a=[];for(n=1;n<=s;n++)n%2==0?l=[o-Math.floor(n/2)*e].concat(l):a.push(r+Math.ceil(n/2)*e);return l.concat(i).concat(a)},Gh=cl((i,t,e,n)=>{let o,r,s;if(e=+e,(i=+i)==(t=+t)||Math.abs(i-t)<=Number.MIN_VALUE&&e>0)return wb(i,e,n==null?void 0:n.noDecimals);(o=t<i)&&(s=i,i=t,t=s);const l=df(i,t,e);let a=l.step;if(!isFinite(a))return[];if(a>0){let h=1;const{power:d,gap:u}=l,c=u===10?2*10**d:1*10**d;for(;h<=5&&(r=Vh(i,t,a),r.length>e+1)&&e>2;)a+=c,h+=1;e>2&&r.length<e-1&&(r=BI(r,e,a))}else n!=null&&n.noDecimals&&a<0&&(a=1),r=Vh(i,t,a);return o&&r.reverse(),r}),ry=i=>{const t=Math.floor(Math.log(i)/Math.LN10),e=i/10**t;let n=ql[0];return e>=SI?n=ql[3]:e>=xI?n=ql[2]:e>=RI&&(n=ql[1]),t>=0?{step:n*10**t,gap:n,power:t}:{step:-(10**-t)/n,gap:n,power:t}};function df(i,t,e){const n=(t-i)/Math.max(0,e);return ry(n)}function sy(i,t,e){let n;if(e=+e,(i=+i)==(t=+t)&&e>0)return[i];if(e<=0||(n=MI(i,t,e))===0||!isFinite(n))return[];const o=new Array(e);for(let r=0;r<e;r++)o[r]=i+r*n;return o}function MI(i,t,e){return(t-i)/Math.max(1,e-1)}function TI(i,t,e){let n,o,r=-1;if(e=+e,(o=(t=+t)<(i=+i))&&(n=i,i=t,t=n),!isFinite(e)||t-i<=e)return[i];const s=Math.floor((t-i)/e+1),l=new Array(s);for(;++r<s;)l[r]=i+r*e;return o&&l.reverse(),l}function bu(i,t=10){let e,n,o=0,r=i.length-1,s=i[o],l=i[r],a=10;for(l<s&&(n=s,s=l,l=n,n=o,o=r,r=n);a-- >0;){if(n=df(s,l,t).step,n===e)return i[o]=s,i[r]=l,i;if(n>0)s=Math.floor(s/n)*n,l=Math.ceil(l/n)*n;else{if(!(n<0))break;s=Math.ceil(s*n)/n,l=Math.floor(l*n)/n}e=n}}function ly(i,t){const e=Ge(t.forceMin),n=Ge(t.forceMax);let o=null;const r=[];let s=null;const l=e&&n?a=>a>=t.forceMin&&a<=t.forceMax:e?a=>a>=t.forceMin:n?a=>a<=t.forceMax:null;return e?r[0]=t.forceMin:Ge(t.min)&&t.min<=Math.min(i[0],i[i.length-1])&&(r[0]=t.min),n?r[1]=t.forceMax:Ge(t.max)&&t.max>=Math.max(i[0],i[i.length-1])&&(r[1]=t.max),Ge(r[0])&&Ge(r[1])?(s=i.slice(),s[0]=r[0],s[s.length-1]=r[1]):o=Ge(r[0])||Ge(r[1])?Ge(r[0])?"max":"min":"all",{niceType:o,niceDomain:s,niceMinMax:r,domainValidator:l}}const Cu=(i,t,e)=>Math.abs(t-i)<1?+e.toFixed(1):Math.round(+e),ay=cl((i,t,e,n,o,r,s)=>{let l=i,a=t;const h=a<l;h&&([l,a]=[a,l]);let d,u,c=o(l),f=o(a),g=[];if(!(n%1)&&f-c<e){if(c=Math.floor(c),f=Math.ceil(f),l>0){for(;c<=f;++c)for(d=1;d<n;++d)if(u=c<0?d/r(-c):d*r(c),!(u<l)){if(u>a)break;g.push(u)}}else for(;c<=f;++c)for(d=n-1;d>=1;--d)if(u=c>0?d/r(-c):d*r(c),!(u<l)){if(u>a)break;g.push(u)}2*g.length<e&&(g=Gh(l,a,e))}else g=Gh(c,f,Math.min(f-c,e)).map(r);return g=g.filter(p=>p!==0),s!=null&&s.noDecimals&&(g=Array.from(new Set(g.map(p=>Math.floor(p))))),h?g.reverse():g}),hy=cl((i,t,e,n,o,r)=>{const s=[],l={},a=o(i),h=o(t);let d=[];if(Number.isInteger(n))d=Gh(a,h,e);else{const u=(h-a)/(e-1);for(let c=0;c<e;c++)d.push(a+c*u)}return d.forEach(u=>{const c=r(u),f=Number.isInteger(n)?Cu(i,t,c):Cu(i,t,ey(c)),g=Cu(i,t,_I(f,[i,t]));!l[g]&&!isNaN(g)&&d.length>1&&(l[g]=1,s.push(g))}),s}),jh=cl((i,t,e,n,o)=>sy(n(i),n(t),e).map(r=>ey(o(r))));class Vr extends oy{constructor(){super(...arguments),this.type=An.Linear}clone(){return new Vr().domain(this._domain,!0).range(this._range,!0).unknown(this._unknown).clamp(this.clamp(),null,!0).interpolate(this._interpolate)}tickFormat(){return()=>{}}d3Ticks(t=10,e){const n=this.calculateVisibleDomain(this._range);return AI(n[0],n[n.length-1],t,e)}ticks(t=10,e){var n;if(bz(e==null?void 0:e.customTicks))return e.customTicks(this,t);if(te(this._rangeFactorStart)&&te(this._rangeFactorEnd)&&(this._rangeFactorStart>0||this._rangeFactorEnd<1)&&this._range.length===2||!this._niceType)return this.d3Ticks(t,e);const o=(n=this._niceDomain)!==null&&n!==void 0?n:this._domain,r=this._domain,s=o[0],l=o[o.length-1];let a=Gh(r[0],r[r.length-1],t,e);if(!a.length)return a;if(this._domainValidator)a=a.filter(this._domainValidator);else if((a[0]!==s||a[a.length-1]!==l)&&this._niceType){const h=o.slice();if(this._niceType==="all"?(h[0]=a[0],h[h.length-1]=a[a.length-1],this._niceDomain=h,this.rescale()):this._niceType==="min"&&a[0]!==s?(h[0]=a[0],this._niceDomain=h,this.rescale()):this._niceType==="max"&&a[a.length-1]!==l&&(h[h.length-1]=a[a.length-1],this._niceDomain=h,this.rescale()),this._niceType!=="all"){const d=Math.min(h[0],h[h.length-1]),u=Math.max(h[0],h[h.length-1]);a=a.filter(c=>c>=d&&c<=u)}}return a}forceTicks(t=10){const e=this.calculateVisibleDomain(this._range);return sy(e[0],e[e.length-1],t)}stepTicks(t){const e=this.calculateVisibleDomain(this._range);return TI(e[0],e[e.length-1],t)}nice(t=10,e){var n,o;const r=this._domain;let s=[];if(e){const l=ly(r,e);if(s=l.niceMinMax,this._domainValidator=l.domainValidator,this._niceType=l.niceType,l.niceDomain)return this._niceDomain=l.niceDomain,this.rescale(),this}else this._niceType="all";if(this._niceType){const l=bu(r.slice(),t);this._niceType==="min"?l[l.length-1]=(n=s[1])!==null&&n!==void 0?n:l[l.length-1]:this._niceType==="max"&&(l[0]=(o=s[0])!==null&&o!==void 0?o:l[0]),this._niceDomain=l,this.rescale()}return this}niceMin(t=10){this._niceType="min";const e=this._domain[this._domain.length-1],n=bu(this.domain(),t);return n&&(n[n.length-1]=e,this._niceDomain=n,this.rescale()),this}niceMax(t=10){this._niceType="max";const e=this._domain[0],n=bu(this._domain.slice(),t);return n&&(n[0]=e,this._niceDomain=n,this.rescale()),this}}class dy{nice(t=10,e){var n,o,r,s;const l=this._domain;let a=[],h=null;if(e){const d=ly(l,e);if(a=d.niceMinMax,this._domainValidator=d.domainValidator,h=d.niceType,d.niceDomain)return this._niceDomain=d.niceDomain,this.rescale(),this}else h="all";if(h){const d=CI(l.slice(),(o=(n=this.getNiceConfig)===null||n===void 0?void 0:n.call(this))!==null&&o!==void 0?o:{floor:u=>Math.floor(u),ceil:u=>Math.ceil(u)});return h==="min"?d[d.length-1]=(r=a[1])!==null&&r!==void 0?r:d[d.length-1]:h==="max"&&(d[0]=(s=a[0])!==null&&s!==void 0?s:d[0]),this._niceDomain=d,this.rescale(),this}return this}niceMin(){const t=this._domain[this._domain.length-1];this.nice();const e=this._domain.slice();return this._domain&&(e[e.length-1]=t,this._niceDomain=e,this.rescale()),this}niceMax(){const t=this._domain[0];this.nice();const e=this._domain.slice();return this._domain&&(e[0]=t,this._niceDomain=e,this.rescale()),this}}function yb(i){return t=>-i(-t)}function Sb(i=Number.EPSILON){return t=>Math.max(t,i)}function PI(i=Number.EPSILON){return t=>Math.min(t,-i)}class gl extends oy{constructor(){super(vb(10),pb(10)),this.type=An.Log,this._limit=Sb(),this._logs=this.transformer,this._pows=this.untransformer,this._domain=[1,10],this._base=10}clone(){return new gl().domain(this._domain,!0).range(this._range,!0).unknown(this._unknown).clamp(this.clamp(),null,!0).interpolate(this._interpolate,!0).base(this._base)}rescale(t){var e;if(t)return this;super.rescale();const n=vb(this._base),o=pb(this._base);return((e=this._niceDomain)!==null&&e!==void 0?e:this._domain)[0]<0?(this._logs=yb(n),this._pows=yb(o),this._limit=PI(),this.transformer=gI,this.untransformer=fI):(this._logs=n,this._pows=o,this._limit=Sb(),this.transformer=this._logs,this.untransformer=o),this}scale(t){var e;if(t=Number(t),Number.isNaN(t)||this._domainValidator&&!this._domainValidator(t))return this._unknown;this._output||(this._output=this._piecewise(((e=this._niceDomain)!==null&&e!==void 0?e:this._domain).map(this._limit).map(this.transformer),this._calculateWholeRange(this._range),this._interpolate));const n=this._output(this.transformer(this._limit(this._clamp(t))));return this._fishEyeTransform?this._fishEyeTransform(n):n}base(t,e){return arguments.length?(this._base=t,this.rescale(e)):this._base}tickFormat(){return Qo}d3Ticks(t=10,e){const n=this.domain(),o=this._limit(n[0]),r=this._limit(n[n.length-1]);return ay(o,r,t,this._base,this.transformer,this.untransformer,e)}ticks(t=10){const e=this.calculateVisibleDomain(this._range);return hy(this._limit(e[0]),this._limit(e[e.length-1]),t,this._base,this.transformer,this.untransformer)}forceTicks(t=10){const e=this.calculateVisibleDomain(this._range);return jh(e[0],e[e.length-1],t,this.transformer,this.untransformer)}stepTicks(t){const e=this.calculateVisibleDomain(this._range);return jh(this._limit(e[0]),this._limit(e[e.length-1]),t,this.transformer,this.untransformer)}getNiceConfig(){return{floor:t=>this._pows(Math.floor(this._logs(this._limit(t)))),ceil:t=>Math.abs(t)>=1?Math.ceil(t):this._pows(Math.ceil(this._logs(this._limit(t))))}}}Yw(gl,dy);class HI extends Md{constructor(t){super(!1),this.type=An.Point,this._padding=0,this.paddingInner(1,t),this.padding=this.paddingOuter,this.paddingInner=void 0,this.paddingOuter=void 0}}class fl extends Vr{constructor(){super(mb(1),bb(1)),this.type=An.Symlog,this._const=1}clone(){return new fl().domain(this._domain,!0).range(this._range,!0).unknown(this._unknown).clamp(this.clamp(),null,!0).interpolate(this._interpolate,!0).constant(this._const)}constant(t,e){return arguments.length?(this._const=t,this.transformer=mb(t),this.untransformer=bb(t),this.rescale(e)):this._const}d3Ticks(t=10,e){const n=this.domain(),o=n[0],r=n[n.length-1];return ay(o,r,t,this._const,this.transformer,this.untransformer,e)}ticks(t=10){const e=this.calculateVisibleDomain(this._range);return hy(e[0],e[e.length-1],t,this._const,this.transformer,this.untransformer)}forceTicks(t=10){const e=this.calculateVisibleDomain(this._range);return jh(e[0],e[e.length-1],t,this.transformer,this.untransformer)}stepTicks(t){const e=this.calculateVisibleDomain(this._range);return jh(e[0],e[e.length-1],t,this.transformer,this.untransformer)}}Yw(fl,dy);class kI{constructor(){this._scale=new Md,this._scales=[this._scale]}valueToPosition(t){return this._scale.scale(t)}getPosition(t){let e=0,n=this._scale;if(this._scales.length===1||t.length===1)e=this.valueToPosition(t[0]);else{const o=Math.min(t.length,this._scales.length);for(let r=0;r<o;r++)e+=this._scales[r].scale(t[r]);n=this._scales[o-1]}return{position:e,bandScale:n}}calcScales(t,e){var n,o;const{bandPadding:r,paddingInner:s,paddingOuter:l}=this,a=Q(r),h=Q(s),d=Q(l);for(let u=0;u<this._scales.length;u++){const c=a?r[u]:r,f=h?s[u]:s,g=d?l[u]:l;this._scales[u].paddingInner((n=f??c)!==null&&n!==void 0?n:t,!0).paddingOuter((o=g??c)!==null&&o!==void 0?o:e)}}dataToPosition(t,e={}){var n;if(t.length===0||this._scales.length===0)return 0;const{position:o,bandScale:r}=this.getPosition(t);return o+r.bandwidth()*((n=e.bandPosition)!==null&&n!==void 0?n:.5)}updateScaleDomain(t){for(let e=0;e<this._scales.length;e++)this._scales[e].domain(t)}updateRange(t){const[e,n]=this._scale.range();t[0]===e&&t[1]===n||this._scale.range(t)}}function EI(i,t,e){i.getTransform(t)||i.registerTransform(t,e)}function LI(i,t,e){i.getParser(t)||i.registerParser(t,e)}const FI=Math.sqrt(50),zI=Math.sqrt(10),II=Math.sqrt(2);class OI{constructor(t){this._extend={},this.type=t??"linear",this._scale=t==="log"?new gl:t==="symlog"?new fl:new Vr,this._scales=[this._scale]}setExtraAttrFromSpec(t,e,n,o,r,s){this.nice=!1,this.zero=e,this.zero&&(n.min=Math.min(n.min,0),n.max=Math.max(n.max,0)),this.domain=n,this.expand=o,this.type==="log"?this._scale.base(r??10):this.type==="symlog"&&this._scale.constant(s??10)}transformScaleDomain(){this.type==="symlog"||this.type==="log"||this.setScaleNice()}setScaleNice(){this.type==="log"?this.setLogScaleNice():this.setLinearScaleNice()}setLogScaleNice(){var t,e,n,o,r,s;Pt((t=this.domain)===null||t===void 0?void 0:t.min)&&Pt((e=this.domain)===null||e===void 0?void 0:e.max)?this.nice&&this._scale.nice():O((n=this.domain)===null||n===void 0?void 0:n.min)&&Pt((o=this.domain)===null||o===void 0?void 0:o.max)?this.nice&&this._scale.niceMax():Pt((r=this.domain)===null||r===void 0?void 0:r.min)&&O((s=this.domain)===null||s===void 0?void 0:s.max)&&this.nice&&this._scale.niceMin()}setLinearScaleNice(){var t,e,n,o,r,s,l,a;let h=(e=(t=this.forceTickCount)!==null&&t!==void 0?t:this.tickCount)!==null&&e!==void 0?e:10;this.niceType==="accurateFirst"&&(h=Math.max(10,h)),Pt((n=this.domain)===null||n===void 0?void 0:n.min)&&Pt((o=this.domain)===null||o===void 0?void 0:o.max)?this.nice&&this._scale.nice(h):O((r=this.domain)===null||r===void 0?void 0:r.min)&&Pt((s=this.domain)===null||s===void 0?void 0:s.max)?this.nice&&this._scale.niceMax(h):Pt((l=this.domain)===null||l===void 0?void 0:l.min)&&O((a=this.domain)===null||a===void 0?void 0:a.max)?this.nice&&this._scale.niceMin(h):this.nice&&this._scale.nice(h)}dataToPosition(t){return this.valueToPosition(t[0])}valueToPosition(t){return this._scale.scale(t)}computeLinearDomain(t){const e=[];return t.forEach(n=>{const{min:o,max:r}=n;e[0]=e[0]===void 0?o:Math.min(e[0],o),e[1]=e[1]===void 0?r:Math.max(e[1],r)}),this.expandDomain(e),this.includeZero(e),this.setDomainMinMax(e),e}expandDomain(t){if(!this.expand)return;const e=t[0],n=t[t.length-1];O(this.expand.min)&&(t[0]=e-(n-e)*this.expand.min),O(this.expand.max)&&(t[t.length-1]=n+(n-e)*this.expand.max)}niceDomain(t){if(O(t[0])||O(t[1])||this.type!=="linear")return t;if(Math.abs(Kh(t)-vg(t))<=1e-12){let e=t[0];const n=e>=0?1:-1;if(e=Math.abs(e),e<1)t[0]=0,t[1]=1;else{let o=e/5;const r=Math.floor(Math.log(o)/Math.LN10),s=o/Math.pow(10,r);o=(s>=FI?10:s>=zI?5:s>=II?2:1)*Math.pow(10,r),t[0]=0,t[1]=10*o}n<0&&(t.reverse(),t[0]*=-1,t[1]*=-1)}return t}niceMinMax(){var t,e,n,o,r,s,l,a;if(this.nice){let h=(e=(t=this.forceTickCount)!==null&&t!==void 0?t:this.tickCount)!==null&&e!==void 0?e:10;this.niceType==="accurateFirst"&&(h=Math.max(10,h)),Pt((n=this.domain)===null||n===void 0?void 0:n.min)&&Pt((o=this.domain)===null||o===void 0?void 0:o.max)?this._scale.nice(h):O((r=this.domain)===null||r===void 0?void 0:r.min)&&Pt((s=this.domain)===null||s===void 0?void 0:s.max)?this._scale.niceMax(h):Pt((l=this.domain)===null||l===void 0?void 0:l.min)&&O((a=this.domain)===null||a===void 0?void 0:a.max)?this._scale.niceMin(h):this._scale.nice(h)}}includeZero(t){this.zero&&(t[0]=Math.min(t[0],0),t[t.length-1]=Math.max(t[t.length-1],0))}setExtendDomain(t,e){if(e===void 0)return void delete this._extend[t];this._extend[t]=e;const n=this._scale.domain();this.extendDomain(n),this.includeZero(n),this.setDomainMinMax(n),this.niceDomain(n),this._scale.domain(n,this.nice),this.niceMinMax()}extendDomain(t){let e;const n=t.length-1,o=t[0]-t[n]>0,r=o?n:0,s=o?0:n;for(const l in this._extend)e=this._extend[l],e>t[s]&&(t[s]=e),e<t[r]&&(t[r]=e)}setDomainMinMax(t){if(!this.domain)return;const{min:e,max:n}=this.domain;O(e)&&(t[0]=e),O(n)&&(t[1]=n)}setZero(t){this.zero!==t&&(this.zero=t,this.updateScaleDomain())}updateScaleDomain(){const t=this.computeDomain([this.domain]);this.updateScaleDomainByModel(t)}computeDomain(t){return this.computeLinearDomain(t)}updateScaleDomainByModel(t){t=t??this._scale.domain(),this.extendDomain(t),this.includeZero(t),this.setDomainMinMax(t),this.niceDomain(t),this._scale.domain(t,this.nice),this.niceMinMax()}updateRange(t){const[e,n]=this._scale.range();t[0]===e&&t[1]===n||this._scale.range(t)}}function DI(i,t){const e=i.find(o=>o.name==="axis-label-container-layer-0",!0),n=i.find(o=>o.name==="axis-label-container-layer-1",!0);xb(e?e.getChildren():[],t),xb(n?n.getChildren():[],t)}function WI(i,t){const{width:e,height:n}=t.getLayoutRect(),o=gg(t.orient),r=t.option.inverse===!0,s=i[0],l=Co(i);if(o)if(r){const a=e,h=0,d=s.AABBBounds.x2,u=l.AABBBounds.x1;d>a&&s.setAttributes({x:a,textAlign:"right"}),u<h&&l.setAttributes({x:h,textAlign:"left"})}else{const h=e,d=s.AABBBounds.x1,u=l.AABBBounds.x2;d<0&&s.setAttributes({x:0,textAlign:"left"}),u>h&&l.setAttributes({x:h,textAlign:"right"})}else if(r){const a=s.AABBBounds.y1,h=l.AABBBounds.y2,d=0,u=n;a<d&&s.setAttributes({y:d,textBaseline:"top"}),h>u&&l.setAttributes({y:u,textBaseline:"bottom"})}else{const a=n,h=0,d=s.AABBBounds.y2,u=l.AABBBounds.y1;d>a&&s.setAttributes({y:a,textBaseline:"bottom"}),u<h&&l.setAttributes({y:h,textBaseline:"top"})}}function xb(i,t){var e;const n=t.option;wt(i)||!((e=n==null?void 0:n.label)===null||e===void 0)&&e.flush&&WI(i,t)}const NI=i=>i;class VI{constructor(t,e,n,o,r){var s,l,a;this.x=0,this.y=0,this.padding=o,this.table=r,this.orient=(s=t.orient)!==null&&s!==void 0?s:"left",this.type=(l=t.type)!==null&&l!==void 0?l:"band",this.option=rt({},Xz(t.__vtableChartTheme),GI(this.orient,r.theme),jI(this.orient,this.type,t.__vtableChartTheme),t),this.orient==="left"||this.orient==="right"?(this.width=e,this.height=n-o[0]-o[2]-0,this.y=o[0]+0):(this.orient==="top"||this.orient==="bottom")&&(this.width=e-o[1]-o[3]-0,this.height=n,this.x=o[3]+0),this.visible=(a=t.visible)===null||a===void 0||a,this.inverse="inverse"in t&&!!t.inverse,t.type==="band"&&(this.data=t.domain),this.initScale(),this.initData(),this.createComponent(),this.initEvent()}initScale(){const t=this.option;this.type==="band"||this.type==="point"?(this.scale=new kI,this.scale.bandPadding=t.bandPadding,this.scale.paddingInner=t.paddingInner,this.scale.paddingOuter=t.paddingOuter,this.scale.calcScales(.1,.3),this.scale.updateScaleDomain(this.data),this.updateScaleRange()):this.type!=="linear"&&this.type!=="time"&&this.type!=="log"&&this.type!=="symlog"||(this.scale=new OI(this.type),this.scale.setExtraAttrFromSpec(t.nice,t.zero,t.range,t.expand,t.base,t.constant),this.scale.transformScaleDomain(),this.scale.updateScaleDomain(),this.updateScaleRange())}initData(){this.table._vDataSet||(this.table._vDataSet=new Uz),LI(this.table._vDataSet,"scale",NI),EI(this.table._vDataSet,"ticks",HP);const t=this.option.label||{},e=this.option.tick||{},n=new Bd(this.table._vDataSet).parse(this.scale._scale,{type:"scale"}).transform({type:"ticks",options:{sampling:this.option.sampling!==!1,tickCount:e.tickCount,forceTickCount:e.forceTickCount,tickStep:e.tickStep,tickMode:e.tickMode,noDecimals:e.noDecimals,axisOrientType:this.orient,coordinateType:"cartesian",labelStyle:t.style,labelFormatter:t.formatMethod,labelGap:t.minGap,labelLastVisible:t.lastVisible,labelFlush:t.flush}},!1);this.tickData=n,this.computeData()}computeData(){this.tickData.reRunAllTransform()}initEvent(){}createComponent(){const t=db(this.option),e=this.getUpdateAttribute();e.verticalFactor=this.orient==="top"||this.orient==="right"?-1:1,this.component=new Gs(rt({disableTriggerEvent:this.table.options.disableInteraction},t,e)),this.component.setAttributes(this.setLayoutStartPosition({x:this.x,y:this.y})),this.component.originAxis=this}resize(t,e){this.width=t-(this.orient==="top"||this.orient==="bottom"?this.padding[1]+this.padding[3]:0),this.height=e-(this.orient==="left"||this.orient==="right"?this.padding[2]+this.padding[0]:0),this.updateScaleRange(),this.computeData();const n=db(this.option),o=this.getUpdateAttribute();o.verticalFactor=this.orient==="top"||this.orient==="right"?-1:1,this.component.setAttributes(rt({},n,o)),this.component.setAttributes(this.setLayoutStartPosition({x:this.x,y:this.y})),this.overlap()}overlap(){DI(this.component,this)}getLayoutRect(){return{width:this.width,height:this.height}}getUpdateAttribute(){this.table.tableNoFrameHeight,this.table.tableNoFrameWidth;const{width:t,height:e}=this.getLayoutRect(),n=gg(this.orient),o=cI(this.orient);let r={x:0,y:0},s=0;n?(r={x:t,y:0},s=t):o&&(r={x:0,y:e},s=e);const l=this.orient==="top"||this.orient==="bottom"?e:t;return{start:{x:0,y:0},end:r,title:{text:this.option.title.text,maxWidth:this._getTitleLimit(n)},items:this.getLabelItems(s),verticalLimitSize:l,verticalMinSize:l}}getLabelItems(t){return[this.tickData.latestData.map(e=>({id:e.value,label:e.value,value:t===0?0:this.scale.dataToPosition([e.value])/t,rawValue:e.value})).filter(e=>e.value>=0&&e.value<=1)]}updateScaleRange(){var t,e,n,o,r,s,l,a;const h=(e=(t=this.option.innerOffset)===null||t===void 0?void 0:t.right)!==null&&e!==void 0?e:0,d=(o=(n=this.option.innerOffset)===null||n===void 0?void 0:n.left)!==null&&o!==void 0?o:0,u=(s=(r=this.option.innerOffset)===null||r===void 0?void 0:r.top)!==null&&s!==void 0?s:0,c=(a=(l=this.option.innerOffset)===null||l===void 0?void 0:l.bottom)!==null&&a!==void 0?a:0,{width:f,height:g}=this.getLayoutRect(),p=this.option.inverse||!1;let v=[0,0];gg(this.orient)?Yt(f)&&(v=p?[f-h,d]:[d,f-h]):Yt(g)&&(v=p?[u,g-c]:[g-c,u]),this.scale.updateRange(v)}setLayoutStartPosition(t){let{x:e,y:n}=t;return Yt(e)&&(e+=+(this.orient==="left")*this.getLayoutRect().width),Yt(n)&&(n+=+(this.orient==="top")*this.getLayoutRect().height),{x:e,y:n}}_getTitleLimit(t){var e,n,o;if(this.option.title.visible&&Pt((e=this.option.title.style)===null||e===void 0?void 0:e.maxLineWidth)){let r=((n=this.option.title.style)===null||n===void 0?void 0:n.angle)||0;if(!((o=this.option.title)===null||o===void 0)&&o.autoRotate&&Pt(this.option.title.angle)&&(r=this.option.orient==="left"?-90:90),t){const a=this.getLayoutRect().width,h=Math.abs(Math.cos(To(r)));return h<1e-6?1/0:a/h}const s=this.getLayoutRect().height,l=Math.abs(Math.sin(To(r)));return l<1e-6?1/0:s/l}return null}getScale(){return this.scale._scale}getDomainSpec(){return this.scale.domain}}function GI(i,t){let e;return i==="left"?e=t.axisStyle.leftAxisStyle:i==="right"?e=t.axisStyle.rightAxisStyle:i==="top"?e=t.axisStyle.topAxisStyle:i==="bottom"&&(e=t.axisStyle.bottomAxisStyle),rt({},t.axisStyle.defaultAxisStyle,e)}function jI(i,t,e){if(!e)return{};const n=e.axis;let o,r;return t==="linear"||t==="log"||t==="symlog"?o=e.axisLinear:t==="band"&&(o=e.axisBand),i==="top"||i==="bottom"?r=e.axisX:i!=="left"&&i!=="right"||(r=e.axisY),rt({},n,o,r)}function UI(i,t){var e,n,o,r,s,l,a,h,d,u,c,f,g,p,v,m,b,C;const _=rt({},Nh,i);let w=0;_.tick.visible!==!1&&(w=(e=_.tick.width)!==null&&e!==void 0?e:4);let y=0;if(_.label.visible){if(_.type==="band")_.domain.forEach(S=>{var R,B,A,M,k,E,T,P,H,L,F,z,I,N,W,D;_.label.formatMethod&&(S=_.label.formatMethod(S));const{width:j,height:V}=t.measureText(S,{fontSize:(A=(B=(R=_.label)===null||R===void 0?void 0:R.style)===null||B===void 0?void 0:B.fontSize)!==null&&A!==void 0?A:Ji,fontWeight:(E=(k=(M=_.label)===null||M===void 0?void 0:M.style)===null||k===void 0?void 0:k.fontWeight)!==null&&E!==void 0?E:"normal",fontFamily:(H=(P=(T=_.label)===null||T===void 0?void 0:T.style)===null||P===void 0?void 0:P.fontFamily)!==null&&H!==void 0?H:Cr}),X=((F=(L=_.label)===null||L===void 0?void 0:L.style)===null||F===void 0?void 0:F.maxLineWidth)||1/0,K=((N=(I=(z=_.label)===null||z===void 0?void 0:z.style)===null||I===void 0?void 0:I.angle)!==null&&N!==void 0?N:0)+(((D=(W=_.label)===null||W===void 0?void 0:W.style)===null||D===void 0?void 0:D.direction)==="vertical"?90:0);y=Math.max(y,_r(Math.min(j,X),V,K).width)});else{let S;if(!((n=i.sync)===null||n===void 0)&&n.tickAlign&&Mt((o=i.tick)===null||o===void 0?void 0:o.tickMode))S=i.tick.tickMode();else if(Q(i.__ticksForVTable))S=i.__ticksForVTable;else{const R=_.range,B=Math.abs(R.min)>1?Math.round(R.min):R.min,A=Math.abs(R.max)>1?Math.round(R.max):R.max;S=[Uh(B),Uh(A)]}S.forEach(R=>{var B,A,M,k,E,T,P,H,L,F,z,I,N,W,D,j;_.label.formatMethod&&(R=_.label.formatMethod(R));const{width:V,height:X}=t.measureText(R,{fontSize:(M=(A=(B=_.label)===null||B===void 0?void 0:B.style)===null||A===void 0?void 0:A.fontSize)!==null&&M!==void 0?M:Ji,fontWeight:(T=(E=(k=_.label)===null||k===void 0?void 0:k.style)===null||E===void 0?void 0:E.fontWeight)!==null&&T!==void 0?T:"normal",fontFamily:(L=(H=(P=_.label)===null||P===void 0?void 0:P.style)===null||H===void 0?void 0:H.fontFamily)!==null&&L!==void 0?L:Cr}),K=((z=(F=_.label)===null||F===void 0?void 0:F.style)===null||z===void 0?void 0:z.maxLineWidth)||1/0,J=((W=(N=(I=_.label)===null||I===void 0?void 0:I.style)===null||N===void 0?void 0:N.angle)!==null&&W!==void 0?W:0)+(((j=(D=_.label)===null||D===void 0?void 0:D.style)===null||j===void 0?void 0:j.direction)==="vertical"?90:0);y=Math.max(y,_r(Math.min(V,K),X,J).width)})}y+=(r=_.label.space)!==null&&r!==void 0?r:4}let x=0;if(_.title.visible&&jt(_.title.text)){const{width:S,height:R}=t.measureText(_.title.text,{fontSize:(a=(l=(s=_.title)===null||s===void 0?void 0:s.style)===null||l===void 0?void 0:l.fontSize)!==null&&a!==void 0?a:Ji,fontWeight:(u=(d=(h=_.title)===null||h===void 0?void 0:h.style)===null||d===void 0?void 0:d.fontWeight)!==null&&u!==void 0?u:"normal",fontFamily:(g=(f=(c=_.title)===null||c===void 0?void 0:c.style)===null||f===void 0?void 0:f.fontFamily)!==null&&g!==void 0?g:Cr}),B=((v=(p=_.label)===null||p===void 0?void 0:p.style)===null||v===void 0?void 0:v.maxLineWidth)||1/0,A=_r(Math.min(S,B),R,(b=(m=_.title)===null||m===void 0?void 0:m.style)===null||b===void 0?void 0:b.angle);x=i.orient!=="left"&&i.orient!=="right"||!_.title.autoRotate?A.width:A.height,x+=(C=_.title.space)!==null&&C!==void 0?C:4}return Math.ceil(w+y+x+1)}function $I(i,t){var e,n,o,r,s,l,a,h,d,u,c,f,g,p,v,m,b,C;const _=rt({},Nh,i);let w=0;_.tick.visible!==!1&&(w=(e=_.tick.width)!==null&&e!==void 0?e:4);let y=0;if(_.label.visible){if(_.type==="band")_.domain.forEach(S=>{var R,B,A,M,k,E,T,P,H,L,F,z,I,N,W,D;_.label.formatMethod&&(S=_.label.formatMethod(S));const{width:j,height:V}=t.measureText(S,{fontSize:(A=(B=(R=_.label)===null||R===void 0?void 0:R.style)===null||B===void 0?void 0:B.fontSize)!==null&&A!==void 0?A:Ji,fontWeight:(E=(k=(M=_.label)===null||M===void 0?void 0:M.style)===null||k===void 0?void 0:k.fontWeight)!==null&&E!==void 0?E:"normal",fontFamily:(H=(P=(T=_.label)===null||T===void 0?void 0:T.style)===null||P===void 0?void 0:P.fontFamily)!==null&&H!==void 0?H:Cr}),X=((F=(L=_.label)===null||L===void 0?void 0:L.style)===null||F===void 0?void 0:F.maxLineWidth)||1/0,K=((N=(I=(z=_.label)===null||z===void 0?void 0:z.style)===null||I===void 0?void 0:I.angle)!==null&&N!==void 0?N:0)+(((D=(W=_.label)===null||W===void 0?void 0:W.style)===null||D===void 0?void 0:D.direction)==="vertical"?90:0);y=Math.max(y,_r(Math.min(j,X),V,K).height)});else{let S;if(!((n=i.sync)===null||n===void 0)&&n.tickAlign&&Mt((o=i.tick)===null||o===void 0?void 0:o.tickMode))S=i.tick.tickMode();else if(Q(i.__ticksForVTable))S=i.__ticksForVTable;else{const R=_.range,B=Math.abs(R.min)>1?Math.round(R.min):R.min,A=Math.abs(R.max)>1?Math.round(R.max):R.max;S=[Uh(B),Uh(A)]}S.forEach(R=>{var B,A,M,k,E,T,P,H,L,F,z,I,N,W,D,j;_.label.formatMethod&&(R=_.label.formatMethod(R));const{width:V,height:X}=t.measureText(R,{fontSize:(M=(A=(B=_.label)===null||B===void 0?void 0:B.style)===null||A===void 0?void 0:A.fontSize)!==null&&M!==void 0?M:Ji,fontWeight:(T=(E=(k=_.label)===null||k===void 0?void 0:k.style)===null||E===void 0?void 0:E.fontWeight)!==null&&T!==void 0?T:"normal",fontFamily:(L=(H=(P=_.label)===null||P===void 0?void 0:P.style)===null||H===void 0?void 0:H.fontFamily)!==null&&L!==void 0?L:Cr}),K=((z=(F=_.label)===null||F===void 0?void 0:F.style)===null||z===void 0?void 0:z.maxLineWidth)||1/0,J=((W=(N=(I=_.label)===null||I===void 0?void 0:I.style)===null||N===void 0?void 0:N.angle)!==null&&W!==void 0?W:0)+(((j=(D=_.label)===null||D===void 0?void 0:D.style)===null||j===void 0?void 0:j.direction)==="vertical"?90:0);y=Math.max(y,_r(Math.min(V,K),X,J).height)})}y+=(r=_.label.space)!==null&&r!==void 0?r:4}let x=0;if(_.title.visible&&_.title.text){const{width:S,height:R}=t.measureText(_.title.text,{fontSize:(a=(l=(s=_.title)===null||s===void 0?void 0:s.style)===null||l===void 0?void 0:l.fontSize)!==null&&a!==void 0?a:Ji,fontWeight:(u=(d=(h=_.title)===null||h===void 0?void 0:h.style)===null||d===void 0?void 0:d.fontWeight)!==null&&u!==void 0?u:"normal",fontFamily:(g=(f=(c=_.title)===null||c===void 0?void 0:c.style)===null||f===void 0?void 0:f.fontFamily)!==null&&g!==void 0?g:Cr}),B=((v=(p=_.label)===null||p===void 0?void 0:p.style)===null||v===void 0?void 0:v.maxLineWidth)||1/0,A=_r(Math.min(S,B),R,(b=(m=_.title)===null||m===void 0?void 0:m.style)===null||b===void 0?void 0:b.angle);x=i.orient!=="bottom"&&i.orient!=="top"||!_.title.autoRotate?A.height:A.width,x+=(C=_.title.space)!==null&&C!==void 0?C:4}return w+y+x+1}function Uh(i){return typeof i!="number"&&(i=Number(i)),Number(i.toPrecision(1)).toString()}function _r(i,t,e=0){const n=e*Math.PI/180,o=-i/2,r=-t/2,s=i/2,l=-t/2,a=i/2,h=t/2,d=-i/2,u=t/2,c={x:o*Math.cos(n)-r*Math.sin(n),y:o*Math.sin(n)+r*Math.cos(n)},f={x:s*Math.cos(n)-l*Math.sin(n),y:s*Math.sin(n)+l*Math.cos(n)},g={x:a*Math.cos(n)-h*Math.sin(n),y:a*Math.sin(n)+h*Math.cos(n)},p={x:d*Math.cos(n)-u*Math.sin(n),y:d*Math.sin(n)+u*Math.cos(n)},v=Math.min(c.x,f.x,g.x,p.x),m=Math.max(c.x,f.x,g.x,p.x),b=Math.min(c.y,f.y,g.y,p.y);return{width:m-v,height:Math.max(c.y,f.y,g.y,p.y)-b}}const KI='<svg t="1716726614852" class="icon" viewBox="0 0 1194 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2621" width="200" height="200"><path d="M1038.694079 367.237067c13.265507 23.342857-16.633865-40.004445-63.05621-40.004446H219.018794c-26.558738 0-46.46393 13.334815-63.05621 40.004446S0.006238 607.277601 0.006238 650.608819V940.647979a82.351494 82.351494 0 0 0 82.961402 83.349526H1111.702885a82.337632 82.337632 0 0 0 82.975264-83.349526V650.608819c0-43.331218-155.970208-283.371753-155.970208-283.371752zM730.066575 667.284269a136.328386 136.328386 0 0 1-132.738243 133.33429 133.417459 133.417459 0 0 1-132.738243-133.33429v-6.681269a40.6698 40.6698 0 0 0-36.497473-26.66963H73.015044l119.458874-220.02445s23.231965-40.004445 53.103614-40.004446h713.481918c26.544876 0 29.871649 10.008042 46.436207 40.004446L1128.33675 633.947231H769.904682c-26.184476 0-39.838107 7.623855-39.838107 33.337038zM338.505391 210.559919l-89.601086-86.69016a22.178487 22.178487 0 0 1 0-33.26773 21.984425 21.984425 0 0 1 33.170699 0l89.601087 86.676299a22.317102 22.317102 0 0 1 0 33.26773 24.950798 24.950798 0 0 1-33.1707 0z m252.197118-40.059891a25.532983 25.532983 0 0 1-6.639685-16.633865l-3.326773-126.694606A28.263709 28.263709 0 0 1 603.995739 0.515788c13.251646-3.326773 23.204242 10.021904 26.544877 23.342858V153.866163a28.249847 28.249847 0 0 1-23.259688 26.66963c-6.611961-3.312911-13.279369-3.312911-16.578419-10.035765z m235.646421 33.337038a22.372548 22.372548 0 0 1 0-33.337038l86.288175-90.030795a22.039871 22.039871 0 0 1 33.170699 0 22.289379 22.289379 0 0 1 0 33.364761l-82.961401 90.003072a25.962691 25.962691 0 0 1-36.483611 0z" fill="#8a8a8a" p-id="2622"></path></svg>';class YI{constructor(t,e){this._emptyTipOption={spaceBetweenTextAndIcon:20,text:"no data",textStyle:{fontSize:14,color:"#000"},icon:{image:KI,width:100,height:100}},this.isReleased=!1,this.table=e,this._emptyTipOption=Object.assign(this._emptyTipOption,t===!0?{}:t),O(this._emptyTipOption.displayMode)||(this.table.isListTable()?this._emptyTipOption.displayMode="basedOnTable":this._emptyTipOption.displayMode="basedOnContainer"),this._emptyTipComponent=this._createOrUpdateEmptyTipComponent(this._getEmptyTipAttrs())}_createOrUpdateEmptyTipComponent(t){if(this._emptyTipComponent)mg(t,this._cacheAttrs)||this._emptyTipComponent.setAttributes(t);else{const e=new y_(t);e.name="emptyTip",this.table.scenegraph.stage.defaultLayer.appendChild(e),this._emptyTipComponent=e,this.bindEvents()}return this._emptyTipComponent}bindEvents(){this._emptyTipComponent.on("click",t=>{const e=new Gt;this._emptyTipComponent.forEachChildren(n=>{e.union(n.globalAABBBounds)}),e.contains(t.x,t.y)&&this.table.fireListeners("empty_tip_click",t)}),this._emptyTipComponent.on("dblclick",t=>{const e=new Gt;this._emptyTipComponent.forEachChildren(n=>{e.union(n.globalAABBBounds)}),e.contains(t.x,t.y)&&this.table.fireListeners("empty_tip_dblclick",t)})}resize(){var t;if(!this._emptyTipComponent)return;const{leftHeaderWidth:e,topHeaderHeight:n,width:o,height:r}=this.getWidthAndHeight();this._emptyTipComponent.setAttributes({spaceBetweenTextAndIcon:this._emptyTipOption.spaceBetweenTextAndIcon,x:this.table.tableX+e,y:this.table.tableY+n,width:o,height:r,text:Object.assign(Object.assign({text:this._emptyTipOption.text},this._emptyTipOption.textStyle),{fill:(t=this._emptyTipOption.textStyle)===null||t===void 0?void 0:t.color}),icon:Object.assign({},this._emptyTipOption.icon)})}release(){this._emptyTipComponent&&this.table.scenegraph.stage.defaultLayer.removeChild(this._emptyTipComponent),this._emptyTipComponent=null,this.isReleased=!0}resetVisible(){(this.table.recordsCount&&this.table.recordsCount!==0||this.table.internalProps.layoutMap.rowCount!==this.table.internalProps.layoutMap.columnHeaderLevelCount)&&this.table.internalProps.layoutMap.colCount!==this.table.internalProps.layoutMap.rowHeaderLevelCount?this.table.scenegraph.stage.defaultLayer.children.includes(this._emptyTipComponent)&&this.table.scenegraph.stage.defaultLayer.removeChild(this._emptyTipComponent):this.table.scenegraph.stage.defaultLayer.children.includes(this._emptyTipComponent)||this.table.scenegraph.stage.defaultLayer.appendChild(this._emptyTipComponent)}getWidthAndHeight(){const t=this.table.transpose||this.table.options.indicatorsAsCol===!1?this.table.getFrozenColsWidth():0,e=!this.table.transpose||this.table.options.indicatorsAsCol?this.table.getFrozenRowsHeight():0;return{leftHeaderWidth:t,topHeaderHeight:e,width:(this._emptyTipOption.displayMode!=="basedOnContainer"&&this.table.columnHeaderLevelCount>0&&this.table.colCount>this.table.rowHeaderLevelCount?this.table.getDrawRange().width:this.table.tableNoFrameWidth)-t-this.table.getTheme().scrollStyle.width,height:(this._emptyTipOption.displayMode!=="basedOnContainer"&&this.table.rowHeaderLevelCount>0&&this.table.rowCount>this.table.columnHeaderLevelCount?this.table.getDrawRange().height:this.table.tableNoFrameHeight)-e-this.table.getTheme().scrollStyle.width}}_getEmptyTipAttrs(){var t;const{leftHeaderWidth:e,topHeaderHeight:n,width:o,height:r}=this.getWidthAndHeight();return{spaceBetweenTextAndIcon:this._emptyTipOption.spaceBetweenTextAndIcon,x:this.table.tableX+e,y:this.table.tableY+n,width:o,height:r,text:Object.assign(Object.assign({text:this._emptyTipOption.text},this._emptyTipOption.textStyle),{fill:(t=this._emptyTipOption.textStyle)===null||t===void 0?void 0:t.color}),icon:Object.assign({},this._emptyTipOption.icon)}}}var XI=function(i,t){var e={};for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&t.indexOf(n)<0&&(e[n]=i[n]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function"){var o=0;for(n=Object.getOwnPropertySymbols(i);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(i,n[o])&&(e[n[o]]=i[n[o]])}return e};const qI={orient:"bottom",position:"middle",padding:30,title:{visible:!1,padding:0,textStyle:{fontSize:14,fill:"#000000",fontWeight:"normal"},space:12},item:{visible:!0,spaceCol:10,spaceRow:10,padding:2,background:{state:{selectedHover:{fill:"gray",fillOpacity:.7},unSelectedHover:{fill:"gray",fillOpacity:.2}}},shape:{space:4,state:{unSelected:{fillOpacity:.5}}},label:{space:4,style:{fill:"#89909D",fontSize:14},state:{unSelected:{fillOpacity:.5}}}},allowAllCanceled:!0,visible:!0};function ZI(i,t){const e=rt({},qI,i),{title:n={},item:o={},pager:r={},background:s={},type:l,id:a,visible:h,orient:d,position:u,data:c,filter:f,regionId:g,regionIndex:p,seriesIndex:v,seriesId:m,padding:b}=e,C=XI(e,["title","item","pager","background","type","id","visible","orient","position","data","filter","regionId","regionIndex","seriesIndex","seriesId","padding"]);return n.visible&&(C.title=Qw(n)),wt(o.focusIconStyle)||le(o.focusIconStyle),zi(o.shape),zi(o.label),zi(o.value),zi(o.background),Zd(o.maxWidth)&&(o.maxWidth=Number(o.maxWidth.substring(0,o.maxWidth.length-1))*t.width/100),Zd(o.width)&&(o.width=Number(o.width.substring(0,o.width.length-1))*t.width/100),Zd(o.height)&&(o.height=Number(o.height.substring(0,o.height.length-1))*t.width/100),C.item=o,wt(r.textStyle)||le(r.textStyle),zi(r.handler),C.pager=r,s.visible&&!wt(s.style)&&(rt(C,s.style),O(s.padding)&&(C.padding=s.padding)),C}class JI{constructor(t,e){var n,o,r,s;this.table=e,this.option=Do(t),this.orient=(n=t.orient)!==null&&n!==void 0?n:"left",this.visible=(o=t.visible)===null||o===void 0||o,this.position=(r=t.position)!==null&&r!==void 0?r:"middle",this.selectedData=(s=t.defaultSelected)!==null&&s!==void 0?s:null,this.createComponent(),this.initEvent()}createComponent(){const t=this.getLegendAttributes({width:this.table.tableNoFrameWidth,height:this.table.tableNoFrameHeight}),e=new fd(rt({},t,{defaultSelected:this.selectedData,disableTriggerEvent:this.table.options.disableInteraction}));e.name="legend",this.legendComponent=e,this.visible===!1&&(e.setAttributes({visible:!1,visibleAll:!1}),e.hideAll()),this.table.scenegraph.stage.defaultLayer.appendChild(e),this.adjustTableSize(t)}resize(){this.legendComponent&&this.visible!==!1&&(this.legendComponent.setAttributes({maxWidth:this.table.tableNoFrameWidth,maxHeight:this.table.tableNoFrameHeight}),this.adjustTableSize(this.legendComponent.attribute))}adjustTableSize(t){var e,n;if(!this.legendComponent||this.visible===!1)return;let o=isFinite(this.legendComponent.AABBBounds.width())?this.legendComponent.AABBBounds.width():0,r=isFinite(this.legendComponent.AABBBounds.height())?this.legendComponent.AABBBounds.height():0;if(o<=0||r<=0)return;const s=this.table.tableNoFrameWidth,l=this.table.tableNoFrameHeight,a=xt((n=(e=t.padding)!==null&&e!==void 0?e:this.option.padding)!==null&&n!==void 0?n:10);let h=0,d=0;this.orient==="left"?(h=a[3],d=0,o+=a[1]+a[3]):this.orient==="top"?(h=0,d=a[0],r+=a[0]+a[2]):this.orient==="right"?(h=s-o-a[1],d=0,o+=a[1]+a[3]):this.orient==="bottom"&&(h=0,d=l-r-a[2],r+=a[0]+a[2]);const u=this.orient==="bottom"||this.orient==="top"?"horizontal":"vertical",c=this.position;let f=0,g=0;u==="horizontal"?f=c==="middle"?(s-o)/2:c==="end"?s-o-a[1]:a[3]:g=c==="middle"?(l-r)/2:c==="end"?l-r-a[2]:a[0],this.legendComponent.setAttributes({dx:f,dy:g,x:h,y:d}),this.orient==="left"?(this.table.tableNoFrameWidth=this.table.tableNoFrameWidth-Math.ceil(o),this.table.tableX+=Math.ceil(o)):this.orient==="top"?(this.table.tableNoFrameHeight=this.table.tableNoFrameHeight-Math.ceil(r),this.table.tableY+=Math.ceil(r)):this.orient==="right"?this.table.tableNoFrameWidth=this.table.tableNoFrameWidth-Math.ceil(o):this.orient==="bottom"&&(this.table.tableNoFrameHeight=this.table.tableNoFrameHeight-Math.ceil(r))}getLegendAttributes(t){var e,n;const o=this.orient==="bottom"||this.orient==="top"?"horizontal":"vertical",r=ZI(this.option,t),s=xt((n=(e=r.padding)!==null&&e!==void 0?e:this.option.padding)!==null&&n!==void 0?n:10);return Object.assign({layout:o,items:this.getLegendItems(),maxWidth:t.width-s[1]-s[3],maxHeight:t.height-s[0]-s[2]},r)}getLegendItems(){return this.option.data}initEvent(){this.legendComponent&&(this.legendComponent.addEventListener(wi.legendItemClick,t=>{const e=we(t,"detail.currentSelected");this.table.fireListeners(U.LEGEND_ITEM_CLICK,{model:this,value:e,event:t})}),this.legendComponent.addEventListener(wi.legendItemHover,t=>{const e=we(t,"detail");this.table.fireListeners(U.LEGEND_ITEM_HOVER,{model:this,value:e,event:t})}),this.legendComponent.addEventListener(wi.legendItemUnHover,t=>{const e=we(t,"detail");this.table.fireListeners(U.LEGEND_ITEM_UNHOVER,{model:this,value:e,event:t})}),this.legendComponent.addEventListener("legendItemAttributeUpdate",t=>{this.table.scenegraph.updateNextFrame()}))}getLegendBounds(){return{width:isFinite(this.legendComponent.AABBBounds.width())?this.legendComponent.AABBBounds.width():0,height:isFinite(this.legendComponent.AABBBounds.height())?this.legendComponent.AABBBounds.height():0}}release(){this.legendComponent&&this.table.scenegraph.stage.defaultLayer.removeChild(this.legendComponent),this.legendComponent=null}}var QI=function(i,t){var e={};for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&t.indexOf(n)<0&&(e[n]=i[n]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function"){var o=0;for(n=Object.getOwnPropertySymbols(i);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(i,n[o])&&(e[n[o]]=i[n[o]])}return e};const $h={orient:"right",position:"middle",padding:30,title:{visible:!1,padding:0,textStyle:{fontSize:14,fontWeight:"normal",fill:{type:"palette",key:"titleFontColor"}},space:12},handler:{visible:!0},startText:{style:{fontSize:14,fontWeight:"normal",fill:{type:"palette",key:"labelFontColor"}}},endText:{style:{fontSize:14,fontWeight:"normal",fill:{type:"palette",key:"labelFontColor"}}},handlerText:{style:{fontSize:14,fontWeight:"normal",fill:{type:"palette",key:"labelFontColor"}}}},t3={horizontal:Object.assign(Object.assign({},$h),{rail:{width:200,height:8,style:{fill:"rgba(0,0,0,0.04)"}}}),vertical:Object.assign(Object.assign({},$h),{rail:{width:8,height:200,style:{fill:"rgba(0,0,0,0.04)"}}})},e3={horizontal:Object.assign({sizeBackground:{fill:"#cdcdcd"},track:{style:{fill:"rgba(20,20,20,0.1)"}},rail:{width:200,height:4,style:{fill:"rgba(0,0,0,0.04)"}}},$h),vertical:Object.assign({sizeBackground:{fill:"#cdcdcd"},track:{style:{fill:"rgba(20,20,20,0.1)"}},rail:{width:4,height:200,style:{fill:"rgba(0,0,0,0.04)"}}},$h)};function i3(i,t){const e=rt({},(i.type==="color"?t3:e3)[i.orient==="bottom"||i.orient==="top"?"horizontal":"vertical"],i),{title:n={},handler:o={},rail:r={},track:s={},startText:l,endText:a,handlerText:h,sizeBackground:d,background:u={},type:c,id:f,visible:g,orient:p,position:v,data:m,defaultSelected:b,field:C,filter:_,regionId:w,regionIndex:y,seriesIndex:x,seriesId:S,padding:R}=e,B=QI(e,["title","handler","rail","track","startText","endText","handlerText","sizeBackground","background","type","id","visible","orient","position","data","defaultSelected","field","filter","regionId","regionIndex","seriesIndex","seriesId","padding"]);return n.visible&&(B.title=Qw(n)),B.showHandler=o.visible!==!1,wt(o.style)||(B.handlerStyle=le(o.style)),O(r.width)&&(B.railWidth=r.width),O(r.height)&&(B.railHeight=r.height),wt(r.style)||(B.railStyle=le(r.style)),wt(s.style)||(B.trackStyle=le(s.style)),B.startText=zi(l),B.endText=zi(a),B.handlerText=zi(h),wt(d)||(B.sizeBackground=le(d)),u.visible&&!wt(u.style)&&(rt(B,u.style),O(u.padding)&&(B.padding=u.padding)),B}class n3{constructor(t,e){var n,o,r,s;this.table=e,this.option=Do(t),this.orient=(n=t.orient)!==null&&n!==void 0?n:"left",this.visible=(o=t.visible)===null||o===void 0||o,this.position=(r=t.position)!==null&&r!==void 0?r:"middle",this.selectedData=(s=t.defaultSelected)!==null&&s!==void 0?s:null,this.createComponent(),this.initEvent()}createComponent(){const t=this.getLegendAttributes({width:this.table.tableNoFrameWidth,height:this.table.tableNoFrameHeight});let e;e=this.option.type==="color"?new pd(rt({},t,{slidable:!0})):new vd(rt({},t,{slidable:!0})),e.name="legend",this.legendComponent=e,this.visible===!1&&(e.setAttributes({visible:!1,visibleAll:!1}),e.hideAll()),this.table.scenegraph.stage.defaultLayer.appendChild(e),this.adjustTableSize(t)}resize(){this.legendComponent&&this.visible!==!1&&(this.legendComponent.setAttributes({width:this.table.tableNoFrameWidth,height:this.table.tableNoFrameHeight}),this.adjustTableSize(this.legendComponent.attribute))}adjustTableSize(t){var e,n;if(!this.legendComponent||this.visible===!1)return;let o=isFinite(this.legendComponent.AABBBounds.width())?this.legendComponent.AABBBounds.width():0,r=isFinite(this.legendComponent.AABBBounds.height())?this.legendComponent.AABBBounds.height():0;if(o<=0||r<=0)return;const s=this.table.tableNoFrameWidth,l=this.table.tableNoFrameHeight,a=xt((n=(e=t.padding)!==null&&e!==void 0?e:this.option.padding)!==null&&n!==void 0?n:10);let h=0,d=0;this.orient==="left"?(h=a[3],d=0,o+=a[1]+a[3]):this.orient==="top"?(h=0,d=a[0],r+=a[0]+a[2]):this.orient==="right"?(h=s-o-a[1],d=0,o+=a[1]+a[3]):this.orient==="bottom"&&(h=0,d=l-r-a[2],r+=a[0]+a[2]);const u=this.orient==="bottom"||this.orient==="top"?"horizontal":"vertical",c=this.position;let f=0,g=0;u==="horizontal"?f=c==="middle"?(s-o)/2:c==="end"?s-o-a[1]:a[3]:g=c==="middle"?(l-r)/2:c==="end"?l-r-a[2]:a[0],this.legendComponent.setAttributes({dx:f,dy:g,x:h,y:d}),this.orient==="left"?(this.table.tableNoFrameWidth=this.table.tableNoFrameWidth-Math.ceil(o),this.table.tableX+=Math.ceil(o)):this.orient==="top"?(this.table.tableNoFrameHeight=this.table.tableNoFrameHeight-Math.ceil(r),this.table.tableY+=Math.ceil(r)):this.orient==="right"?this.table.tableNoFrameWidth=this.table.tableNoFrameWidth-Math.ceil(o):this.orient==="bottom"&&(this.table.tableNoFrameHeight=this.table.tableNoFrameHeight-Math.ceil(r))}getLegendAttributes(t){const e=this.orient==="bottom"||this.orient==="top"?"horizontal":"vertical",n=e==="horizontal"?"bottom":this.orient;return Object.assign(Object.assign({},i3(this.option)),{layout:e,align:n,min:this.option.min,max:this.option.max,value:this.option.value,[this.option.type==="color"?"colors":"sizeRange"]:this.option.type==="color"?this.option.colors:this.option.sizeRange})}initEvent(){this.legendComponent&&this.legendComponent.addEventListener("change",t=>{const e=we(t,"detail.value");this.table.fireListeners(U.LEGEND_CHANGE,{model:this,value:e,event:t}),this.table.scenegraph.updateNextFrame()})}getLegendBounds(){return{width:isFinite(this.legendComponent.AABBBounds.width())?this.legendComponent.AABBBounds.width():0,height:isFinite(this.legendComponent.AABBBounds.height())?this.legendComponent.AABBBounds.height():0}}release(){this.legendComponent&&this.table.scenegraph.stage.defaultLayer.removeChild(this.legendComponent),this.legendComponent=null}}function o3(i,t){return i.type==="color"||i.type==="size"?new n3(i,t):new JI(i,t)}class uy{constructor(t){this._table=t}release(){this.unbindMenuElement(),this._menuElement&&this._menuElement.release(),this._menuElement=void 0}_getMenuElement(){return this._menuElement||(this._menuElement=this.createMenuElementInternal()),this._menuElement}bindMenuElement(t,e,n){return this._getMenuElement().bindToCell(this._table,t,e,n)}unbindMenuElement(){this._getMenuElement().unbindFromCell()}pointInMenuElement(t,e){return this._getMenuElement().pointInMenuElement(t,e)}getRootElement(){return this._getMenuElement().rootElement}}const uf="vtable__menu-element",tr=`${uf}--hidden`,_u=`${uf}--shown`;function r3(){return Zi("div",[uf,tr])}class s3{constructor(t){var e,n,o;this._handler=new _d,this._rootElement=r3(),this._rootElement.addEventListener("wheel",r=>{r.stopPropagation()}),(e=this._rootElement)===null||e===void 0||e.addEventListener("mousedown",r=>{r.stopPropagation(),r.preventDefault()}),(n=this._rootElement)===null||n===void 0||n.addEventListener("click",r=>{if(r.stopPropagation(),r.preventDefault(),this._rootElement.classList.contains(tr))return;const{col:s,row:l,dropDownIndex:a,menuKey:h,text:d,hasChildren:u}=r.target;if(typeof a!="number"||u)return void r.stopPropagation();const c=t.isPivotTable()?t.internalProps.layoutMap.getPivotDimensionInfo(s,l):t.getHeaderField(s,l),f=t._dropDownMenuIsHighlight(s,l,a);t.fireListeners(U.DROPDOWN_MENU_CLICK,{col:s,row:l,field:c,menuKey:h,text:d,highlight:f,cellLocation:t.getCellLocation(s,l),event:r}),t.fireListeners(U.DROPDOWN_MENU_CLEAR,null),t.fireListeners(U.HIDE_MENU,null),r.stopPropagation()}),(o=this._rootElement)===null||o===void 0||o.addEventListener("mousemove",r=>{this._rootElement.classList.contains(tr)||r.stopPropagation()})}get rootElement(){return this._rootElement}release(){this.unbindFromCell();const t=this._rootElement;t!=null&&t.parentElement&&t.parentElement.removeChild(t),this._handler.release(),delete this._rootElement}bindToCell(t,e,n,o){const r=this._rootElement;if(this._menuInstanceInfo=o,r==null||r.classList.remove(_u),r==null||r.classList.add(tr),this._canBindToCell(t,e,n)){if(r.innerHTML="",r.appendChild(o.content),this._bindCell(t,e,n,o.position,o.referencePosition))return r==null||r.classList.add(_u),r==null||r.classList.remove(tr),!0}else this.unbindFromCell();return!1}unbindFromCell(){const t=this._rootElement;this._menuInstanceInfo=void 0,t!=null&&t.parentElement&&(t.classList.remove(_u),t.classList.add(tr))}_canBindToCell(t,e,n){var o;const r=t.getCellRangeRelativeRect({col:e,row:n}),s=(o=t.internalProps.menu.parentElement)!==null&&o!==void 0?o:t.getElement(),{top:l,bottom:a,left:h,right:d}=r;if(t.isFrozenCell(e,n))return!0;if(a<t.getFrozenRowsHeight()||d<t.getFrozenColsWidth()||h>t.tableNoFrameWidth-t.getRightFrozenColsWidth()||l>t.tableNoFrameHeight-t.getBottomFrozenRowsHeight())return!1;const{offsetHeight:u,offsetWidth:c}=s;return!(u<l)&&!(c<h)}_bindCell(t,e,n,o,r){var s;const l=this._rootElement,a=(s=t.internalProps.menu.parentElement)!==null&&s!==void 0?s:t.getElement(),{width:h,height:d,left:u,top:c}=a.getBoundingClientRect();if(l){l.parentElement!==a&&a.appendChild(l),l.style.left="0px";const f=.8*h;l.style.maxWidth=`${f}px`;const g=l.clientWidth,p=l.clientHeight;let v,m;o&&(v=o.x,m=o.y),r&&(v=r.rect.right-g,m=r.rect.bottom),m+p>d&&(m=d-p,v+=g-2),m<0&&(m/=2);let b=0,C=0;if(t.getElement()!==a){const{left:_,top:w}=t.getElement().getBoundingClientRect();b=w-c,C=_-u}return l.style.top=`${m+b}px`,v<0?v=0:v+g>h&&(v=h-g),l.style.left=`${v+C}px`,!0}return!1}pointInMenuElement(t,e){const n=this._rootElement,{x:o,y:r,width:s,height:l}=n.getBoundingClientRect();return t>o-5&&t<o+s+5&&e>r-5&&e<r+l+5}}class Rb extends uy{createMenuElementInternal(){return new WF(this._table)}}class l3 extends uy{createMenuElementInternal(){return new s3(this._table)}}const a3={"dropdown-menu":function(i){return new Rb(i)},"context-menu":function(i){return new Rb(i)},container:i=>new l3(i)};function h3(i,t,e,n,o){var r,s;const{lineHeight:l,textBaseline:a,textStick:h}=i._getCellStyle(t,e);let d=i.getCellRangeRelativeRect(i.getCellRange(t,e));h&&(d=i.getVisibleCellRangeRelativeRect({col:t,row:e}));let{left:u,right:c,bottom:f,top:g,width:p,height:v}=d;if(i.isHeader(t,e)&&({left:u,right:c,bottom:f,top:g,width:p,height:v}=i.internalProps.headerHelper.getDropDownIconRect(d,l,a||"middle")),o==null?void 0:o.content)return{type:n,position:o.position,referencePosition:(r=o.referencePosition)!==null&&r!==void 0?r:{rect:{left:u,right:c,top:g,bottom:f,width:p,height:v}},content:o.content};if(n==="dropdown-menu"){let m=i.globalDropDownMenu;const b=i._getHeaderLayoutMap(t,e);m=(s=b.dropDownMenu)!==null&&s!==void 0?s:m;const C=b.pivotInfo;return typeof m=="function"&&(m=m({row:e,col:t,table:i})),{type:n,referencePosition:{rect:{left:u,right:c,top:g,bottom:f,width:p,height:v}},content:m,pivotInfo:C}}return null}class d3{constructor(t){this._table=t,this._menuInstances={},this._bindTableEvent(t)}release(){const t=this._menuInstances;for(const e in t)t[e].release();delete this._menuInstances,this._attachInfo=null}_bindToCell(t,e,n,o){var r;const s=this._attachInfo,l=this._getMenuInstanceInfo(t,e,n,o);if(!s||l&&s.instance===l.instance||((r=s.instance)===null||r===void 0||r.unbindMenuElement(),this._attachInfo=null),!l)return;const{instance:a,info:h}=l;if(a&&a.bindMenuElement(t,e,h)){const d=this._table.getCellRange(t,e);this._attachInfo={range:d,instance:a}}}_unbindFromCell(){const t=this._attachInfo;if(!t)return;const{instance:e}=t;e==null||e.unbindMenuElement(),this._attachInfo=null}_isBindToCell(t,e){const n=this._attachInfo;return!!n&&Bi(n.range,t,e)}pointInMenuElement(t,e){if(!this._attachInfo)return!1;const n=this._attachInfo,{instance:o}=n;return o.pointInMenuElement(t,e)}_bindTableEvent(t){t.on(U.DROPDOWN_ICON_CLICK,e=>{this._attachInfo&&this._isBindToCell(e.col,e.row)?this._unbindFromCell():this._bindToCell(e.col,e.row,"dropdown-menu")}),t.on(U.DROPDOWN_MENU_CLEAR,e=>{this._unbindFromCell()}),t.on(U.CONTEXTMENU_CELL,e=>{var n,o,r,s;if(((n=t.internalProps.menu)===null||n===void 0?void 0:n.renderMode)==="html"){const l=t._getMouseAbstractPoint(e.event,!1);let a=null;l.inTable&&typeof((o=t.internalProps.menu)===null||o===void 0?void 0:o.contextMenuItems)=="function"?a=t.internalProps.menu.contextMenuItems(t.getHeaderField(e.col,e.row),e.row,e.col,t):l.inTable&&Array.isArray((r=t.internalProps.menu)===null||r===void 0?void 0:r.contextMenuItems)&&(a=(s=t.internalProps.menu)===null||s===void 0?void 0:s.contextMenuItems),this._bindToCell(e.col,e.row,"context-menu",{content:a,position:{x:l.x,y:l.y}})}})}_getMenuInstanceInfo(t,e,n,o){const r=this._table,s=this._menuInstances,l=h3(r,t,e,n,o);return l?{instance:s&&s[n]||s&&(s[n]=a3[n](r)),type:n,info:l}:null}containElement(t){var e;for(const n in this._menuInstances)if(!((e=this._menuInstances[n].getRootElement())===null||e===void 0)&&e.contains(t))return!0;return!1}}class u3{constructor(t,e){this.isReleased=!1,this.table=e,this._titleOption=rt({orient:"top"},t),t.visible!==!1&&(this._titleComponent=this._createOrUpdateTitleComponent(this._getTitleAttrs()))}_createOrUpdateTitleComponent(t){if(this._titleComponent)mg(t,this._cacheAttrs)||this._titleComponent.setAttributes(t);else{const e=new __(t);e.name="title",this.table.scenegraph.stage.defaultLayer.appendChild(e),this._titleComponent=e}return this._adjustTableSize(this._titleComponent.attribute),this._titleComponent}resize(){var t,e,n,o,r;if(!this._titleComponent)return;const s=xt((t=this._titleOption.padding)!==null&&t!==void 0?t:10),l=(e=this._titleOption.width)!==null&&e!==void 0?e:(this.table.widthMode==="adaptive"?this.table.tableNoFrameWidth:Math.min(this.table.tableNoFrameWidth,this.table.getDrawRange().width))-s[1]-s[3],a=(n=this._titleOption.height)!==null&&n!==void 0?n:(this.table.heightMode==="adaptive"?this.table.tableNoFrameHeight:Math.min(this.table.tableNoFrameHeight,this.table.getDrawRange().height))-s[0]-s[2];this._titleComponent.setAttributes({x:((o=this._titleOption.x)!==null&&o!==void 0?o:this._titleOption.orient==="right")?this.table.tableX+Math.min(this.table.tableNoFrameWidth,this.table.getDrawRange().width):this.table.tableX,y:((r=this._titleOption.y)!==null&&r!==void 0?r:this._titleOption.orient==="bottom")?this.table.tableY+this.table.tableNoFrameHeight:this.table.tableY,width:this._titleOption.orient==="top"||this._titleOption.orient==="bottom"?l:this._titleOption.width,height:this._titleOption.orient==="left"||this._titleOption.orient==="right"?a:this._titleOption.height,textStyle:Object.assign({width:l},this._titleOption.textStyle),subtextStyle:Object.assign({width:l},this._titleOption.subtextStyle)}),this._adjustTableSize(this._titleComponent.attribute)}_adjustTableSize(t){var e,n,o,r;const s=isFinite((e=this._titleComponent)===null||e===void 0?void 0:e.AABBBounds.width())?this._titleComponent.AABBBounds.width():0,l=isFinite((n=this._titleComponent)===null||n===void 0?void 0:n.AABBBounds.height())?this._titleComponent.AABBBounds.height():0;this._titleOption.orient==="left"?(this.table.tableNoFrameWidth=this.table.tableNoFrameWidth-Math.ceil(s),this.table.tableX+=Math.ceil(s)):this._titleOption.orient==="top"?(this.table.tableNoFrameHeight=this.table.tableNoFrameHeight-Math.ceil(l),this.table.tableY+=Math.ceil(l)):this._titleOption.orient==="right"?this.table.tableNoFrameWidth=this.table.tableNoFrameWidth-Math.ceil(s):this._titleOption.orient==="bottom"&&(this.table.tableNoFrameHeight=this.table.tableNoFrameHeight-Math.ceil(l)),this._cacheAttrs=t,this._titleOption.orient!=="right"&&this._titleOption.orient!=="bottom"||this._titleComponent.setAttributes({x:((o=this._titleOption.x)!==null&&o!==void 0?o:this._titleOption.orient==="right")?this.table.tableX+this.table.tableNoFrameWidth:this.table.tableX,y:((r=this._titleOption.y)!==null&&r!==void 0?r:this._titleOption.orient==="bottom")?this.table.tableY+this.table.tableNoFrameHeight:this.table.tableY})}release(){this._titleComponent&&this.table.scenegraph.stage.defaultLayer.removeChild(this._titleComponent),this._titleComponent=null,this.isReleased=!0}_getTitleAttrs(){var t,e,n,o,r,s,l,a,h,d,u;const c=this._titleOption.text||this._titleOption.subtext?10:0,f=xt((t=this._titleOption.padding)!==null&&t!==void 0?t:c),g=(e=this._titleOption.width)!==null&&e!==void 0?e:Math.min(this.table.tableNoFrameWidth,this.table.getDrawRange().width)-f[1]-f[3],p=(n=this._titleOption.height)!==null&&n!==void 0?n:Math.min(this.table.tableNoFrameHeight,this.table.getDrawRange().height)-f[0]-f[2];return{text:(o=this._titleOption.text)!==null&&o!==void 0?o:"",subtext:(r=this._titleOption.subtext)!==null&&r!==void 0?r:"",x:((s=this._titleOption.x)!==null&&s!==void 0?s:this._titleOption.orient==="right")?this.table.tableX+Math.min(this.table.tableNoFrameWidth,this.table.getDrawRange().width):this.table.tableX,y:((l=this._titleOption.y)!==null&&l!==void 0?l:this._titleOption.orient==="bottom")?this.table.tableY+this.table.tableNoFrameHeight:this.table.tableY,width:this._titleOption.orient==="top"||this._titleOption.orient==="bottom"?g:this._titleOption.width,height:this._titleOption.orient==="left"||this._titleOption.orient==="right"?p:this._titleOption.height,minWidth:this._titleOption.minWidth,maxWidth:this._titleOption.maxWidth,minHeight:this._titleOption.minHeight,maxHeight:this._titleOption.maxHeight,padding:this._titleOption.padding,align:(a=this._titleOption.align)!==null&&a!==void 0?a:"left",verticalAlign:(h=this._titleOption.verticalAlign)!==null&&h!==void 0?h:"top",textStyle:Object.assign({width:g},this._titleOption.textStyle),subtextStyle:Object.assign({width:g},this._titleOption.subtextStyle),dx:(d=this._titleOption.dx)!==null&&d!==void 0?d:0,dy:(u=this._titleOption.dy)!==null&&u!==void 0?u:0}}getComponentGraphic(){return this._titleComponent}}class c3{constructor(t){this._table=t}release(){var t,e;this.unbindTooltipElement(),this._tooltipElement&&((e=(t=this._tooltipElement).release)===null||e===void 0||e.call(t)),this._tooltipElement=void 0}_getTooltipElement(){return this._tooltipElement||(this._tooltipElement=this.createTooltipElementInternal()),this._tooltipElement}bindTooltipElement(t,e,n,o){return this._getTooltipElement().bindToCell(this._table,t,e,n,o)}moveTooltipElement(t,e,n,o){this._getTooltipElement().move(this._table,t,e,n,o)}unbindTooltipElement(){this._getTooltipElement().unbindFromCell()}locateTooltipElement(t,e,n,o,r){this._getTooltipElement()._locate(this._table,t,e,n,o,r)}}function g3(){if(Bt.mode==="node")return;const i=document.createElement("style");i.id="vtable-tooltip-styleSheet",i.textContent=`
@keyframes vtable__bubble-tooltip-element--shown-animation {
	0% {
		opacity: 0;
	}
	100% {
		opacity: 1;
	}
}
.vtable__bubble-tooltip-element {
	position: absolute;
	
	// pointer-events: none;
	//user-select: none;
	max-width: 300px;
	z-index: 99999;

	background: #FFFFFF;
    border: 1px solid #E6E8ED;
    box-sizing: border-box;
    border-radius: 4px;
    box-shadow: 0px 2px 4px rgb(27 31 35 / 8%);
    color: #141414;
    font-size: 13px;
}
.vtable__bubble-tooltip-element--hidden {
	opacity: 0;
  pointer-events: none;
	user-select: none;
	/* transform: translate(-50%, -50%); */
	transition: opacity 75ms linear;
}
.vtable__bubble-tooltip-element--shown {
	opacity: 1;
	/* transform: translate(-50%, -50%); */
	animation: vtable__bubble-tooltip-element--shown-animation 150ms ease-out;
}
.vtable__bubble-tooltip-element__content {
	/* font-size: .75rem; */
	padding: 6px 8px;
	min-height: 1em;
	line-height: 1.5;
	width: 100%;
	display: block;
	white-space: pre-wrap;
	margin: 0;
	box-sizing: border-box;
	overflow: auto;
	word-wrap: break-word;
	position: relative;
	background-color: #FFF;
	z-index: 2;
	border-radius: 4px;
}
/*  WebKit Microsoft Edge（新版）： */
.vtable__bubble-tooltip-element__content::-webkit-scrollbar {
  width: 0;
  height: 0;
  background-color: transparent;
}
/*  Opera Firefox  */
.vtable__bubble-tooltip-element__content > scrollbar-track {
  width: 0;
  height: 0;
  background-color: transparent;
}
/* Internet Explorer 11 和 Microsoft Edge（旧版） */
.vtable__bubble-tooltip-element__content > scrollbar {
  width: 0;
  height: 0;
  background-color: transparent;
}
.vtable__bubble-tooltip-element__triangle {
	/* font-size: .75rem; */
	position: absolute;
	width: 10px;
	height: 10px;
	display: block;
	transform: rotate(45deg);
    transform-origin: 50% 50% 0;
	z-index: 1;
	background-color: #FFF;
	border: 1px solid #E6E8ED;
}
`,document.head.appendChild(i)}g3();const pl="vtable__bubble-tooltip-element",Ab=`${pl}__content`,Bb=`${pl}__triangle`,Zo=`${pl}--hidden`,os=`${pl}--shown`;class f3{constructor(){this._handler=new _d;const t=this._rootElement=Zi("div",[pl,Zo]),e=Zi("div",[Ab]),n=Zi("span",[Bb]);t.appendChild(n),t.appendChild(e),this._messageElement=t.querySelector(`.${Ab}`)||void 0,this._triangleElement=t.querySelector(`.${Bb}`)||void 0,t.addEventListener("mousemove",()=>{this._disappearDelayId&&clearTimeout(this._disappearDelayId)}),t.addEventListener("mouseleave",()=>{this._disappearDelay=void 0,this.unbindFromCell()}),e.addEventListener("wheel",o=>{o.stopPropagation()}),e.addEventListener("copy",o=>{C2(e)&&o.stopPropagation()})}bindToCell(t,e,n,o,r){var s,l,a,h,d,u,c,f,g,p,v,m,b,C,_,w,y,x,S;this._disappearDelay=o==null?void 0:o.disappearDelay,this._disappearDelayId&&clearTimeout(this._disappearDelayId);const R=this._rootElement,B=this._messageElement,A=this._triangleElement;if(R==null||R.classList.remove(os),R==null||R.classList.add(Zo),this._canBindToCell(t,e,n)){if(B.setAttribute("style",""),A.setAttribute("style",""),o!=null&&o.className&&R.classList.add(o.className),!((s=o==null?void 0:o.style)===null||s===void 0)&&s.bgColor&&(B.style.backgroundColor=(l=o==null?void 0:o.style)===null||l===void 0?void 0:l.bgColor),!((a=o==null?void 0:o.style)===null||a===void 0)&&a.bgColor&&(A.style.backgroundColor=(h=o==null?void 0:o.style)===null||h===void 0?void 0:h.bgColor),A.style.display=((d=o==null?void 0:o.style)===null||d===void 0?void 0:d.arrowMark)===!0?"block":"none",!((u=o==null?void 0:o.style)===null||u===void 0)&&u.fontSize&&(B.style.fontSize=((f=(c=o==null?void 0:o.style)===null||c===void 0?void 0:c.fontSize)!==null&&f!==void 0?f:12)+"px"),!((g=o==null?void 0:o.style)===null||g===void 0)&&g.fontFamily&&(B.style.fontFamily=(p=o==null?void 0:o.style)===null||p===void 0?void 0:p.fontFamily),!((v=o==null?void 0:o.style)===null||v===void 0)&&v.color&&(B.style.color=(m=o==null?void 0:o.style)===null||m===void 0?void 0:m.color),!((b=o==null?void 0:o.style)===null||b===void 0)&&b.padding&&(B.style.padding=`${(C=o==null?void 0:o.style)===null||C===void 0?void 0:C.padding.join("px ")}px`),!((_=o==null?void 0:o.style)===null||_===void 0)&&_.maxHeight&&(B.style.maxHeight=`${(w=o==null?void 0:o.style)===null||w===void 0?void 0:w.maxHeight}px`),!((y=o==null?void 0:o.style)===null||y===void 0)&&y.maxWidth&&(B.style.maxWidth=`${(x=o==null?void 0:o.style)===null||x===void 0?void 0:x.maxWidth}px`),B&&(B.textContent=o==null?void 0:o.content),this._bindToCell(t,e,n,o==null?void 0:o.position,o==null?void 0:o.referencePosition,r,(S=o==null?void 0:o.style)===null||S===void 0?void 0:S.arrowMark))return R==null||R.classList.add(os),R==null||R.classList.remove(Zo),!0}else this.unbindFromCell();return!1}release(){var t,e;this.unbindFromCell();const n=this._rootElement;n!=null&&n.parentElement&&n.parentElement.removeChild(n),(e=(t=this._handler)===null||t===void 0?void 0:t.release)===null||e===void 0||e.call(t),delete this._rootElement,delete this._messageElement}move(t,e,n,o,r){const s=this._rootElement;this._canBindToCell(t,e,n)?(this._bindToCell(t,e,n,o==null?void 0:o.position,o==null?void 0:o.referencePosition,r),s==null||s.classList.add(os),s==null||s.classList.remove(Zo)):this.unbindFromCell()}unbindFromCell(){var t;if(this._disappearDelay)this._disappearDelayId=setTimeout(()=>{const e=this._rootElement;e!=null&&e.parentElement&&(e.classList.remove(os),e.classList.add(Zo))},(t=this._disappearDelay)!==null&&t!==void 0?t:0);else{const e=this._rootElement;e!=null&&e.parentElement&&(e.classList.remove(os),e.classList.add(Zo))}}_canBindToCell(t,e,n){const o=t.getCellRangeRelativeRect({col:e,row:n}),r=t.getElement(),{bottom:s,left:l,right:a,top:h}=o;if(t.isFrozenCell(e,n))return!0;if(s<t.getFrozenRowsHeight()||a<t.getFrozenColsWidth()||l>t.tableNoFrameWidth-t.getRightFrozenColsWidth()||h>t.tableNoFrameHeight-t.getBottomFrozenRowsHeight())return!1;const{offsetHeight:d,offsetWidth:u}=r;return!(h>d)&&!(l>u)}_bindToCell(t,e,n,o,r,s,l){const a=this._rootElement,h=t.getCellRangeRelativeRect({col:e,row:n}),d=t.internalProps.tooltip.parentElement,u=t.internalProps.element.offsetWidth,{width:c}=h;if(a){let f,g;a.parentElement!==d&&d.appendChild(a),a.style.left="0px";const p=Math.min(.8*u,4*c);a.style.maxWidth=`${p}px`;const v=a.clientWidth,m=a.clientHeight;if(!o&&!r)return!1;{const B=this.getComputedPosition(t,e,n,o,r,s,l);g=B.x,f=B.y}a.style.left=`${g}px`,a.style.top=`${f}px`,Nc()&&(a.style.fontSize="11px");const{x1:b,x2:C,y1:_,y2:w}=t.stateManager.menu.bounds,y=g,x=y+v,S=f,R=y+m;return!(t.stateManager.menu.isShow&&b<x&&C>y&&w>S&&_<R)}return!1}getComputedPosition(t,e,n,o,r,s,l){var a;const h=this._rootElement,d=t.getCellRangeRelativeRect({col:e,row:n}),{x:u,y:c}=t.internalProps.tooltip.parentElement.getBoundingClientRect(),{width:f,height:g,x:p,y:v}=t.internalProps.element.getBoundingClientRect(),{width:m}=d;let b,C;const _=Math.min(.8*f,4*m);h.style.maxWidth=`${_}px`;const w=h.clientWidth,y=h.clientHeight,x=l?6:0;if(o)C=o.x,b=o.y+x,this._triangleElement.style.left="50%",this._triangleElement.style.marginLeft="-5px",this._triangleElement.style.top="-5px";else if(r){let S=(a=r.placement)!==null&&a!==void 0?a:ri.bottom;const R=r.rect.left+r.rect.width/2,B=r.rect.top+r.rect.height/2,A=r.rect.top,M=r.rect.bottom,k=r.rect.left,E=r.rect.right;let T=0;const P=()=>{T++,T>=4||(this.removeStyleFromTriangle(),S===ri.top?(C=R-w/2,b=A-y-x,this._triangleElement.style.left="50%",this._triangleElement.style.marginLeft="-5px",this._triangleElement.style.bottom="-5px",s&&b<0&&(S=ri.right,P())):S===ri.bottom?(C=R-w/2,b=M+x,this._triangleElement.style.left="50%",this._triangleElement.style.marginLeft="-5px",this._triangleElement.style.top="-5px",s&&b+y>g&&(S=ri.left,P())):S===ri.left?(b=B-y/2,C=k-w-x,this._triangleElement.style.top="50%",this._triangleElement.style.marginTop="-5px",this._triangleElement.style.right="-5px",s&&C<0&&(S=ri.top,P())):S===ri.right&&(b=B-y/2,C=E+x,this._triangleElement.style.top="50%",this._triangleElement.style.marginTop="-5px",this._triangleElement.style.left="-5px",s&&C+w>f&&(S=ri.bottom,P())))};P()}return s&&(C<0?C=0:C+h.offsetWidth>f&&(C=f-h.offsetWidth)),{x:C+p-u,y:b+v-c}}removeStyleFromTriangle(){this._triangleElement.style.left="",this._triangleElement.style.right="",this._triangleElement.style.top="",this._triangleElement.style.bottom="",this._triangleElement.style.marginLeft="",this._triangleElement.style.marginTop=""}_locate(t,e,n,o,r,s){const l=this.getComputedPosition(t,e,n,o,r,s),a=l.x,h=l.y;this._rootElement.style.left=`${a}px`,this._rootElement.style.top=`${h}px`}}class p3 extends c3{createTooltipElementInternal(){return new f3}}const v3={"bubble-tooltip":function(i){return new p3(i)}};class m3{constructor(t,e){this._table=t,this._tooltipInstances={},this._bindTableEvent(t),this.confine=e}release(){var t,e;const n=this._tooltipInstances;for(const o in n)(e=(t=n[o])===null||t===void 0?void 0:t.release)===null||e===void 0||e.call(t);delete this._tooltipInstances,this._attachInfo=null}_bindToCell(t,e,n){var o;const r=this._attachInfo,s=this._getTooltipInstanceInfo(t,e);if(!r||s&&r.instance===s||((o=r.instance)===null||o===void 0||o.unbindTooltipElement(),this._attachInfo=null),!!s&&s&&s.bindTooltipElement(t,e,n,this.confine)){const l=this._table.getCellRange(t,e);this._attachInfo={range:l,instance:s,tooltipOptions:n}}}_move(t,e,n){const o=this._attachInfo;if(!o||!Bi(o.range,t,e))return;const{instance:r}=o;r==null||r.moveTooltipElement(t,e,n,this.confine)}moveToPosition(t,e,n,o){const r=this._attachInfo;if(!r||!Bi(r.range,t,e))return;const{instance:s}=r;this._attachInfo.tooltipOptions.position=n,this._attachInfo.tooltipOptions.referencePosition=o,s==null||s.locateTooltipElement(t,e,n,o,this.confine)}_unbindFromCell(){const t=this._attachInfo;if(!t)return;const{instance:e}=t;e==null||e.unbindTooltipElement(),this._attachInfo=null}_isBindCell(t,e){const n=this._attachInfo;return!!n&&Bi(n.range,t,e)}_bindTableEvent(t){t.on(U.MOUSEENTER_CELL,e=>{if(Nc())return;const{x1:n,x2:o,y1:r,y2:s}=t.stateManager.menu.bounds;if(t.stateManager.menu.isShow&&typeof e.x=="number"&&typeof e.y=="number"&&e.x>n&&e.x<o&&e.y>r&&e.y<s)return;const{col:l,row:a}=e;this.showTooltip(l,a)}),t.on(U.MOUSEMOVE_CELL,e=>{var n,o;if(!Nc()){if(!((o=(n=this._attachInfo)===null||n===void 0?void 0:n.tooltipOptions)===null||o===void 0)&&o.referencePosition){const r=this._attachInfo.tooltipOptions.referencePosition,{event:s}=e,{left:l,right:a,top:h,bottom:d}=r.rect,u=t._getMouseAbstractPoint(s,!1);u.inTable&&u.x>=l-5&&u.x<=a+5&&u.y>=h-5&&u.y<=d+5||this._unbindFromCell()}this._attachInfo&&t.stateManager.menu.isShow&&this._bindToCell(e.col,e.row)}}),t.on(U.MOUSELEAVE_CELL,e=>{this._unbindFromCell()}),t.on(U.SELECTED_CELL,e=>{this._isBindCell(e.col,e.row)&&this._unbindFromCell()}),t.on(U.MOUSELEAVE_TABLE,e=>{this._unbindFromCell()}),t.on(U.SCROLL,e=>{this._unbindFromCell()})}showTooltip(t,e){var n,o,r;let s;const l=this._table,a=l.getHeaderDescription(t,e);if(a){const h=l.getCellRangeRelativeRect({col:t,row:e});s={content:a,referencePosition:{placement:l.internalProps.tooltip.position,rect:h},disappearDelay:(n=l.internalProps.tooltip.overflowTextTooltipDisappearDelay)!==null&&n!==void 0?n:0,style:l.theme.tooltipStyle}}else if(Mt((o=l.internalProps.tooltip)===null||o===void 0?void 0:o.isShowOverflowTextTooltip)?l.internalProps.tooltip.isShowOverflowTextTooltip(t,e,l):l.internalProps.tooltip.isShowOverflowTextTooltip){const h=l.getCellOverflowText(t,e),d=l.getCellRangeRelativeRect({col:t,row:e});h&&(s={content:a?`${a}
  ${h}`:h,referencePosition:{placement:l.internalProps.tooltip.position,rect:d},disappearDelay:(r=l.internalProps.tooltip.overflowTextTooltipDisappearDelay)!==null&&r!==void 0?r:0,style:l.theme.tooltipStyle})}s?this._bindToCell(t,e,s):this._unbindFromCell()}_getTooltipInstanceInfo(t,e){const n=this._table,o=this._tooltipInstances;return o&&o["bubble-tooltip"]||o&&(o["bubble-tooltip"]=v3["bubble-tooltip"](n))}isBinded(t){var e;return JSON.stringify(t)===JSON.stringify((e=this._attachInfo)===null||e===void 0?void 0:e.tooltipOptions)}}const b3=()=>{ut.registerComponent("axis",VI),ut.registerFunction("computeAxisComponentWidth",UI),ut.registerFunction("computeAxisComponentHeight",$I),ut.registerFunction("getAxisConfigInPivotChart",nz)},C3=()=>{ut.registerComponent("emptyTip",YI)},_3=()=>{ut.registerFunction("createLegend",o3)},w3=()=>{ut.registerComponent("menuHandler",d3)},y3=()=>{ut.registerComponent("title",u3)},S3=()=>{ut.registerComponent("tooltipHandler",m3)};class x3{constructor(t){this.titleRows=[],this.showedTitleRows=[],this.rowNow=-1,this.skipStartRow=-1,this.skipEndRow=-1,this.table=t,this.table.on("scroll",e=>{e.scrollDirection==="vertical"&&this.updateGroupTitle()}),this.table.on("tree_hierarchy_state_change",e=>{this.updateGroupTitle()}),this.table.on("resize_column",e=>{this.updateGroupTitle()})}updateGroupTitle(){this.table.scrollTop===0?(this.titleRows=[],this.showedTitleRows=[]):this.skipStartRow!==-1&&this.skipEndRow!==-1&&this.skipStartRow!==this.table.scenegraph.proxy.bodyTopRow-1?(this.table.scenegraph.proxy.screenTopRow<=this.skipStartRow||this.table.scenegraph.proxy.screenTopRow>=this.skipEndRow)&&(this.skipStartRow=-1,this.skipEndRow=-1,this.updateGroupTitleInfo()):(this.skipStartRow=-1,this.skipEndRow=-1,this.updateGroupTitleInfo()),this.updateScenegraph()}updateGroupTitleInfo(){this.rowNow=this.table.scenegraph.proxy.screenTopRow+this.titleRows.length;const t=this.table.getRecordIndexByCell(0,this.rowNow),e=this.table.getRecordIndexByCell(0,this.rowNow+1);this.getTitleRowsByRecordIndex(t,e)}getTitleRowsByRecordIndex(t,e){Q(t)||(t=[t]),Q(e)||(e=[e]);for(let l=0;l<t.length;l++){const a=t.slice(0,l+1);this.table.dataSource.getRaw(a)}const n=[],o=e.length===t.length+1;let r=t.slice(0,o?t.length:t.length-1);const s=this.table.dataSource.currentIndexedData;for(let l=this.rowNow-this.table.columnHeaderLevelCount;l>=0;l--){const a=s[l];if(Q(a)&&r.length===a.length){let h=!0;for(let d=0;d<a.length;d++)if(a[d]!==r[d]){h=!1;break}h&&(n.push(l+this.table.columnHeaderLevelCount),r=r.slice(0,r.length-1))}else if(a===t[0]){n.push(l+this.table.columnHeaderLevelCount);break}}this.titleRows=n.reverse()}updateScenegraph(){const{table:t}=this,{shadowGroup:e,shadowGroupFrozen:n}=A3(t);this.showedTitleRows.length=0;let o=0;for(let r=0;r<t.colCount;r++){let s;r<t.frozenColCount?(s=new Tt({x:t.getColsWidth(0,r-1),y:t.getFrozenRowsHeight()}),n.add(s)):(s=new Tt({x:t.getColsWidth(t.frozenColCount,r-1),y:t.getFrozenRowsHeight()}),e.add(s)),s.col=r;for(let l=0;l<this.titleRows.length;l++){const a=this.titleRows[l];if(R3(a,this.rowNow,t.scenegraph.proxy.screenTopRow,this.titleRows)){r===0&&o++;continue}r===0&&this.showedTitleRows.push(a);const h=t.scenegraph.getCell(r,a);if(h.role==="cell"){const d=cy(h);d.setAttributes({y:40*l}),s.add(d)}else{const d=xi(r,a,t,!0,!0);d.setAttributes({y:40*l}),s.add(d)}}}o>0&&this.skipStartRow===-1&&this.skipEndRow===-1&&(this.skipStartRow=t.scenegraph.proxy.screenTopRow-1,this.skipEndRow=t.scenegraph.proxy.screenTopRow+1)}}function R3(i,t,e,n){return i===t&&i!==e+n.length-1?!0:i===e+n.indexOf(i)+1&&i<t}function cy(i){const t=i.clone();if(t.role=i.role,t.col=i.col,t.row=i.row,t.mergeStartCol=i.mergeStartCol,t.mergeStartRow=i.mergeStartRow,t.mergeEndCol=i.mergeEndCol,t.mergeEndRow=i.mergeEndRow,t.contentWidth=i.contentWidth,t.contentHeight=i.contentHeight,t.role==="cell"){const e=qt({x:0,y:0,width:t.attribute.width,height:t.attribute.height});t.add(e)}if(i.type==="group"){const e=t;i.forEachChildren(n=>{const o=cy(n);e.add(o)})}return t}function A3(i){const t=i.scenegraph.colHeaderGroup,e=i.scenegraph.cornerHeaderGroup;if(!t.border){const r=qt({x:0,y:0,width:0,height:0,cursor:"pointer"});t.add(r),t.border=r,r.attachShadow(r.shadowRoot),r.name="border-rect",r.addEventListener("click",s=>{const l=i.listTreeStickCellPlugin.titleRows,{shadowTarget:a}=s.pickParams,h=zo(a),{col:d,row:u}=h;Mb(u-l.indexOf(u),i)})}if(!e.border){const r=qt({x:0,y:0,width:0,height:0,cursor:"pointer"});e.add(r),e.border=r,r.attachShadow(r.shadowRoot),r.name="border-rect",r.addEventListener("click",s=>{const l=i.listTreeStickCellPlugin.titleRows,{shadowTarget:a}=s.pickParams,h=zo(a),{col:d,row:u}=h;Mb(u-l.indexOf(u),i)})}const n=t.border.shadowRoot,o=e.border.shadowRoot;return n.removeAllChild(),o.removeAllChild(),{shadowGroup:n,shadowGroupFrozen:o}}function Mb(i,t){const e=t.getDrawRange();if(O(i)&&i>=t.frozenRowCount){const n=t.getFrozenRowsHeight(),o=t.getRowsHeight(0,i-1);t.scrollTop=Math.min(o-n,t.getAllRowsHeight()-e.height)-1}t.scenegraph.updateNextFrame()}const B3=()=>{ut.registerComponent("listTreeStickCellPlugin",x3)},M3={};function T3(){return dl(M3,ug)}function P3(i,t,e,n,o,r,s,l,a,h,d,u,c,f,g,p,v,m,b){var C,_,w,y,x,S,R,B,A,M,k,E,T,P,H,L,F,z,I,N,W,D,j,V,X;const K=T3()[d],J=g._getCellStyle(o,r),ot=Rd("padding",J,o,r,g);if(O(ot)&&(a=ot),!i){const lt=rn(o,r,p,g);m&&(i=g.scenegraph.highPerformanceGetCell(o,r,!0))&&i.role==="cell"&&i.setAttributes({x:e,y:n,width:s,height:l,lineWidth:(_=(C=p==null?void 0:p.group)===null||C===void 0?void 0:C.lineWidth)!==null&&_!==void 0?_:void 0,fill:(y=(w=p==null?void 0:p.group)===null||w===void 0?void 0:w.fill)!==null&&y!==void 0?y:void 0,stroke:(S=(x=p==null?void 0:p.group)===null||x===void 0?void 0:x.stroke)!==null&&S!==void 0?S:void 0,strokeArrayWidth:lt,strokeArrayColor:(B=(R=p==null?void 0:p.group)===null||R===void 0?void 0:R.strokeArrayColor)!==null&&B!==void 0?B:void 0,cursor:(M=(A=p==null?void 0:p.group)===null||A===void 0?void 0:A.cursor)!==null&&M!==void 0?M:void 0,lineDash:(E=(k=p==null?void 0:p.group)===null||k===void 0?void 0:k.lineDash)!==null&&E!==void 0?E:void 0,lineCap:"butt",clip:!0,cornerRadius:p.group.cornerRadius}),i&&i.role==="cell"||((i=new Tt({x:e,y:n,width:s,height:l,lineWidth:(P=(T=p==null?void 0:p.group)===null||T===void 0?void 0:T.lineWidth)!==null&&P!==void 0?P:void 0,fill:(L=(H=p==null?void 0:p.group)===null||H===void 0?void 0:H.fill)!==null&&L!==void 0?L:void 0,stroke:(z=(F=p==null?void 0:p.group)===null||F===void 0?void 0:F.stroke)!==null&&z!==void 0?z:void 0,strokeArrayWidth:lt,strokeArrayColor:(N=(I=p==null?void 0:p.group)===null||I===void 0?void 0:I.strokeArrayColor)!==null&&N!==void 0?N:void 0,cursor:(D=(W=p==null?void 0:p.group)===null||W===void 0?void 0:W.cursor)!==null&&D!==void 0?D:void 0,lineDash:(V=(j=p==null?void 0:p.group)===null||j===void 0?void 0:j.lineDash)!==null&&V!==void 0?V:void 0,lineCap:"butt",clip:!0,cornerRadius:p.group.cornerRadius})).role="cell",i.col=o,i.row=r,t==null||t.addCellGroup(i))}if(i.AABBBounds.width(),b&&Array.isArray(g.getCellValue(o,r))||!b){const lt=new mr(v,{stroke:!1,x:a[3],y:a[0],canvas:(X=g.canvas)!==null&&X!==void 0?X:g.scenegraph.stage.window.getContext().canvas,mode:g.options.mode,modeParams:g.options.modeParams,spec:g.options.specTransformInCell?g.options.specTransformInCell(u,o,r):u,ClassType:K,width:s-a[3]-a[1],height:l-a[2]-a[0],chartInstance:c,dataId:f,data:g.getCellValue(o,r)||[],cellPadding:a,dpr:g.internalProps.pixelRatio,axes:g.isPivotChart()?g.internalProps.layoutMap.getChartAxes(o,r):[],tableChartOption:g.options.chartOption,col:o,row:r});i.appendChild(lt),g.internalProps.layoutMap.setChartInstance(o,r,lt.chartInstance)}return i}function H3(i,t,e,n,o,r,s,l,a,h,d,u,c,f,g,p,v,m){var b,C,_,w,y,x,S,R,B,A,M,k,E,T,P,H,L,F,z,I,N,W,D,j;if(!i){const ot=rn(o,r,g,f);m&&(i=f.scenegraph.highPerformanceGetCell(o,r,!0))&&i.role==="cell"&&i.setAttributes({x:e,y:n,width:l,height:a,lineWidth:(C=(b=g==null?void 0:g.group)===null||b===void 0?void 0:b.lineWidth)!==null&&C!==void 0?C:void 0,fill:(w=(_=g==null?void 0:g.group)===null||_===void 0?void 0:_.fill)!==null&&w!==void 0?w:void 0,stroke:(x=(y=g==null?void 0:g.group)===null||y===void 0?void 0:y.stroke)!==null&&x!==void 0?x:void 0,strokeArrayWidth:ot,strokeArrayColor:(R=(S=g==null?void 0:g.group)===null||S===void 0?void 0:S.strokeArrayColor)!==null&&R!==void 0?R:void 0,cursor:(A=(B=g==null?void 0:g.group)===null||B===void 0?void 0:B.cursor)!==null&&A!==void 0?A:void 0,lineDash:(k=(M=g==null?void 0:g.group)===null||M===void 0?void 0:M.lineDash)!==null&&k!==void 0?k:void 0,lineCap:"butt",clip:!0,cornerRadius:g.group.cornerRadius}),i&&i.role==="cell"||((i=new Tt({x:e,y:n,width:l,height:a,lineWidth:(T=(E=g==null?void 0:g.group)===null||E===void 0?void 0:E.lineWidth)!==null&&T!==void 0?T:void 0,fill:(H=(P=g==null?void 0:g.group)===null||P===void 0?void 0:P.fill)!==null&&H!==void 0?H:void 0,stroke:(F=(L=g==null?void 0:g.group)===null||L===void 0?void 0:L.stroke)!==null&&F!==void 0?F:void 0,strokeArrayWidth:ot,strokeArrayColor:(I=(z=g==null?void 0:g.group)===null||z===void 0?void 0:z.strokeArrayColor)!==null&&I!==void 0?I:void 0,cursor:(W=(N=g==null?void 0:g.group)===null||N===void 0?void 0:N.cursor)!==null&&W!==void 0?W:void 0,lineDash:(j=(D=g==null?void 0:g.group)===null||D===void 0?void 0:D.lineDash)!==null&&j!==void 0?j:void 0,lineCap:"butt",clip:!0,cornerRadius:g.group.cornerRadius})).role="cell",i.col=o,i.row=r,t==null||t.addCellGroup(i))}let V;if(c){let ot=o,lt=r;v&&(ot=v.start.col,lt=v.start.row),V=f.getCellIcons(ot,lt)}let X=0,K=0;if(Array.isArray(V)&&V.length!==0){const{leftIconWidth:ot,rightIconWidth:lt,absoluteRightIconWidth:ct}=Dr(V,i,v,f);X=ot+lt,K=ot,i.forEachChildren(it=>{it.role==="icon-left"?it.setAttribute("x",it.attribute.x+h[3]):it.role==="icon-right"?it.setAttribute("x",it.attribute.x+l-lt-h[1]):it.role==="icon-absolute-right"&&it.setAttribute("x",it.attribute.x+l-ct-h[1])}),i.forEachChildren(it=>{u==="middle"?it.setAttribute("y",(a-it.AABBBounds.height())/2):u==="bottom"?it.setAttribute("y",a-it.AABBBounds.height()-h[2]):it.setAttribute("y",h[0])})}const J=k3(o,r,s-X,l,a,h,g,p,f);return J&&i.appendChild(J),J.render(),l-=h[1]+h[3]+X,a-=h[0]+h[2],d==="center"?J.setAttribute("x",h[3]+K+(l-J.AABBBounds.width())/2):d==="right"?J.setAttribute("x",h[3]+K+l-J.AABBBounds.width()):J.setAttribute("x",h[3]+K),u==="middle"?J.setAttribute("y",h[0]+(a-J.AABBBounds.height())/2):u==="bottom"?J.setAttribute("y",h[0]+a-J.AABBBounds.height()):J.setAttribute("y",h[0]),i}function k3(i,t,e,n,o,r,s,l,a){var h,d,u,c;const f=a._getCellStyle(i,t),g=q("size",f,i,t,a),p=q("spaceBetweenTextAndIcon",f,i,t,a),v=q("defaultFill",f,i,t,a),m=q("defaultStroke",f,i,t,a),b=q("disableFill",f,i,t,a),C=q("checkedFill",f,i,t,a),_=q("checkedStroke",f,i,t,a),w=q("disableCheckedFill",f,i,t,a),y=q("disableCheckedStroke",f,i,t,a),x=q("checkIconImage",f,i,t,a),S=q("indeterminateIconImage",f,i,t,a),R=a.getCellValue(i,t),B=a.getCellOriginValue(i,t);let A,M,k=(h=R)!==null&&h!==void 0?h:"";kt(R)?(A=R.checked,M=R.disable,k=(d=R.text)!==null&&d!==void 0?d:""):typeof R=="boolean"&&(A=R,k=""),A=a.stateManager.syncCheckedState(i,t,l.field,A);const E=ui(i,t,a),T=a._getCellStyle(i,t),P=(u=T.autoWrapText)!==null&&u!==void 0?u:a.internalProps.autoWrapText,{lineClamp:H}=T,{checked:L,disable:F}=l;if(A==null||typeof A=="function"){const V=zt(L,{col:i,row:t,table:a,context:null,value:R,dataValue:B});A=a.stateManager.syncCheckedState(i,t,l.field,V)}const z=zt(F,{col:i,row:t,table:a,context:null,value:R,dataValue:B}),I=e==="auto",N=a.isAutoRowHeight(t),W={text:k.length===1?k[0]:k,maxLineWidth:I?1/0:n-(r[1]+r[3]+E)-g-p,textAlign:"left",textBaseline:"top",autoWrapText:P,lineClamp:H,wordBreak:"break-word",heightLimit:N?-1:o-Math.floor(r[0]+r[2]),pickable:!1,dx:E,whiteSpace:k.length!==1||P?"normal":"no-wrap"},D={x:0,y:0,text:s.text?Object.assign({},s.text,W):W,icon:{width:Math.floor(g/1.4),height:Math.floor(g/1.4)},box:{width:g,height:g},spaceBetweenTextAndIcon:p,disabled:(c=M??z)!==null&&c!==void 0&&c};A==="indeterminate"?(D.checked=void 0,D.indeterminate=!0):(D.checked=A,D.indeterminate=void 0),v&&(D.box.fill=v),m&&(D.box.stroke=m),b&&(D.box.disableFill=b),C&&(D.box.checkedFill=C),_&&(D.box.checkedStroke=_),w&&(D.box.disableCheckedFill=w),y&&(D.box.disableCheckedStroke=y),x&&(D.icon.checkIconImage=x),S&&(D.icon.indeterminateIconImage=S);const j=new Pr(D);return j.name="checkbox",j}function E3(i,t,e,n,o,r,s,l,a,h,d,u,c,f,g,p){var v,m,b,C,_,w,y,x,S,R,B,A;if(!i){const E=rn(o,r,f,c);(i=new Tt({x:e,y:n,width:l,height:a,lineWidth:(m=(v=f==null?void 0:f.group)===null||v===void 0?void 0:v.lineWidth)!==null&&m!==void 0?m:void 0,fill:(C=(b=f==null?void 0:f.group)===null||b===void 0?void 0:b.fill)!==null&&C!==void 0?C:void 0,stroke:(w=(_=f==null?void 0:f.group)===null||_===void 0?void 0:_.stroke)!==null&&w!==void 0?w:void 0,strokeArrayWidth:E,strokeArrayColor:(x=(y=f==null?void 0:f.group)===null||y===void 0?void 0:y.strokeArrayColor)!==null&&x!==void 0?x:void 0,cursor:(R=(S=f==null?void 0:f.group)===null||S===void 0?void 0:S.cursor)!==null&&R!==void 0?R:void 0,lineDash:(A=(B=f==null?void 0:f.group)===null||B===void 0?void 0:B.lineDash)!==null&&A!==void 0?A:void 0,lineCap:"butt",clip:!0,cornerRadius:f.group.cornerRadius})).role="cell",i.col=o,i.row=r,t==null||t.addCellGroup(i)}const{width:M,height:k}=L3(o,r,s,l,a,h,f,g,i,p,c);return l-=h[1]+h[3],a-=h[0]+h[2],i.forEachChildren(E=>{d==="center"?E.setAttribute("x",h[3]+E.attribute.x+(l-M)/2):d==="right"?E.setAttribute("x",h[3]+E.attribute.x+l-M):E.setAttribute("x",h[3]+E.attribute.x),u==="middle"?E.setAttribute("y",h[0]+E.attribute.y+(a-k)/2):u==="bottom"?E.setAttribute("y",h[0]+E.attribute.y+a-k):E.setAttribute("y",h[0]+E.attribute.y)}),i}function L3(i,t,e,n,o,r,s,l,a,h,d){var u,c,f,g;const p=d._getCellStyle(i,t);let v=q("size",p,i,t,d),m=q("innerRadius",p,i,t,d),b=q("outerRadius",p,i,t,d);const C=q("spaceBetweenTextAndIcon",p,i,t,d),_=q("spaceBetweenRadio",p,i,t,d),w=q("defaultFill",p,i,t,d),y=q("defaultStroke",p,i,t,d),x=q("disableFill",p,i,t,d),S=q("checkedFill",p,i,t,d),R=q("checkedStroke",p,i,t,d),B=q("disableCheckedFill",p,i,t,d),A=q("disableCheckedStroke",p,i,t,d);Z(b)?v=2*b:b=Math.round(v/2),(!Z(m)||m<0)&&(m=Math.round(b/7*3));const M=d.getCellValue(i,t),k=d.getCellOriginValue(i,t),E=ui(i,t,d),T=d._getCellStyle(i,t),P=(u=T.autoWrapText)!==null&&u!==void 0?u:d.internalProps.autoWrapText,{lineClamp:H}=T,L=e==="auto",F=d.isAutoRowHeight(),z={maxLineWidth:L?1/0:n-(r[1]+r[3]+E)-v-C,textAlign:"left",textBaseline:"top",autoWrapText:P,lineClamp:H,wordBreak:"break-word",heightLimit:F?-1:o-Math.floor(r[0]+r[2]),pickable:!1,dx:E},I={x:0,y:0,text:s.text?Object.assign({},s.text,z):z,circle:{innerRadius:m,outerRadius:b},spaceBetweenTextAndIcon:C};w&&(I.circle.fill=w),y&&(I.circle.stroke=y),x&&(I.circle.disableFill=x),S&&(I.circle.checkedFill=S),R&&(I.circle.checkedStroke=R),B&&(I.circle.disableCheckedFill=B),A&&(I.circle.disableCheckedStroke=A);let N=0,W=0;const D=(c=l.radioDirectionInCell)!==null&&c!==void 0?c:"vertical";if(Q(M))M.forEach((j,V)=>{var X,K;const J=Tb(j,k,V,i,t,l,P,I,d);J&&a.appendChild(J),J.id=`radio-${(X=h==null?void 0:h.start.col)!==null&&X!==void 0?X:i}-${(K=h==null?void 0:h.start.row)!==null&&K!==void 0?K:t}-${V}`,J.render();const ot=J.AABBBounds;D==="vertical"?(J.setAttribute("y",W),W+=ot.height()+(V!==M.length-1?_:0),N=Math.max(N,ot.width())):D==="horizontal"&&(J.setAttribute("x",N),N+=ot.width()+(V!==M.length-1?_:0),W=Math.max(W,ot.height()))});else{const j=Tb(M,k,void 0,i,t,l,P,I,d);j&&a.appendChild(j),j.id=`radio-${(f=h==null?void 0:h.start.col)!==null&&f!==void 0?f:i}-${(g=h==null?void 0:h.start.row)!==null&&g!==void 0?g:t}`,j.render();const V=j.AABBBounds;N=V.width(),W=V.height()}return{width:N,height:W}}function Tb(i,t,e,n,o,r,s,l,a){const h=F3(i,t,e,n,o,r,a),d=z3(i,t,n,o,r,a),u=kt(i)?i.text:He(i)?"":i??"",c=rt({},l,{checked:h,disabled:d,text:{text:u.length===1?u[0]:u,whiteSpace:u.length!==1||s?"normal":"no-wrap"},boundsPadding:0}),f=new Hr(c);return f.name="radio",f}function F3(i,t,e,n,o,r,s){var l,a;const h=(l=r.radioCheckType)!==null&&l!==void 0?l:"column";let d,u;return kt(i)?d=i.checked:typeof i=="boolean"&&(d=i),d=s.stateManager.syncRadioState(n,o,r.field,h,e,d),d!=null&&typeof d!="function"||(u=zt(r.checked,{col:n,row:o,table:s,context:null,value:i,dataValue:t}),d=s.stateManager.syncRadioState(n,o,r.field,h,e,u)),(a=d??u)!==null&&a!==void 0&&a}function z3(i,t,e,n,o,r){var s;let l;kt(i)&&(l=i.disable);const a=zt(o.disable,{col:e,row:n,table:r,context:null,value:i,dataValue:t});return(s=l??a)!==null&&s!==void 0&&s}function I3(i,t,e,n,o,r,s,l,a,h,d,u,c,f,g,p,v,m){var b,C,_,w,y,x,S,R,B,A,M,k,E,T,P,H,L,F,z,I,N,W,D,j;if(!i){const ot=rn(o,r,g,f);m&&(i=f.scenegraph.highPerformanceGetCell(o,r,!0))&&i.role==="cell"&&i.setAttributes({x:e,y:n,width:l,height:a,lineWidth:(C=(b=g==null?void 0:g.group)===null||b===void 0?void 0:b.lineWidth)!==null&&C!==void 0?C:void 0,fill:(w=(_=g==null?void 0:g.group)===null||_===void 0?void 0:_.fill)!==null&&w!==void 0?w:void 0,stroke:(x=(y=g==null?void 0:g.group)===null||y===void 0?void 0:y.stroke)!==null&&x!==void 0?x:void 0,strokeArrayWidth:ot,strokeArrayColor:(R=(S=g==null?void 0:g.group)===null||S===void 0?void 0:S.strokeArrayColor)!==null&&R!==void 0?R:void 0,cursor:(A=(B=g==null?void 0:g.group)===null||B===void 0?void 0:B.cursor)!==null&&A!==void 0?A:void 0,lineDash:(k=(M=g==null?void 0:g.group)===null||M===void 0?void 0:M.lineDash)!==null&&k!==void 0?k:void 0,lineCap:"butt",clip:!0,cornerRadius:g.group.cornerRadius}),i&&i.role==="cell"||((i=new Tt({x:e,y:n,width:l,height:a,lineWidth:(T=(E=g==null?void 0:g.group)===null||E===void 0?void 0:E.lineWidth)!==null&&T!==void 0?T:void 0,fill:(H=(P=g==null?void 0:g.group)===null||P===void 0?void 0:P.fill)!==null&&H!==void 0?H:void 0,stroke:(F=(L=g==null?void 0:g.group)===null||L===void 0?void 0:L.stroke)!==null&&F!==void 0?F:void 0,strokeArrayWidth:ot,strokeArrayColor:(I=(z=g==null?void 0:g.group)===null||z===void 0?void 0:z.strokeArrayColor)!==null&&I!==void 0?I:void 0,cursor:(W=(N=g==null?void 0:g.group)===null||N===void 0?void 0:N.cursor)!==null&&W!==void 0?W:void 0,lineDash:(j=(D=g==null?void 0:g.group)===null||D===void 0?void 0:D.lineDash)!==null&&j!==void 0?j:void 0,lineCap:"butt",clip:!0,cornerRadius:g.group.cornerRadius})).role="cell",i.col=o,i.row=r,t==null||t.addCellGroup(i))}let V;if(c){let ot=o,lt=r;v&&(ot=v.start.col,lt=v.start.row),V=f.getCellIcons(ot,lt)}let X=0,K=0;if(Array.isArray(V)&&V.length!==0){const{leftIconWidth:ot,rightIconWidth:lt,absoluteRightIconWidth:ct}=Dr(V,i,v,f);X=ot+lt,K=ot,i.forEachChildren(it=>{it.role==="icon-left"?it.setAttribute("x",it.attribute.x+h[3]):it.role==="icon-right"?it.setAttribute("x",it.attribute.x+l-lt-h[1]):it.role==="icon-absolute-right"&&it.setAttribute("x",it.attribute.x+l-ct-h[1])}),i.forEachChildren(it=>{u==="middle"?it.setAttribute("y",(a-it.AABBBounds.height())/2):u==="bottom"?it.setAttribute("y",a-it.AABBBounds.height()-h[2]):it.setAttribute("y",h[0])})}const J=O3(o,r,s-X,l,a,h,g,p,f);return J&&i.appendChild(J),J.render(),l-=h[1]+h[3]+X,a-=h[0]+h[2],d==="center"?J.setAttribute("x",h[3]+K+(l-J.AABBBounds.width())/2):d==="right"?J.setAttribute("x",h[3]+K+l-J.AABBBounds.width()):J.setAttribute("x",h[3]+K),u==="middle"?J.setAttribute("y",h[0]+(a-J.AABBBounds.height())/2):u==="bottom"?J.setAttribute("y",h[0]+a-J.AABBBounds.height()):J.setAttribute("y",h[0]),i}function O3(i,t,e,n,o,r,s,l,a){var h,d,u,c;const f=a._getCellStyle(i,t),g=q("spaceBetweenTextAndCircle",f,i,t,a),p=q("circleRadius",f,i,t,a),v=q("boxWidth",f,i,t,a),m=q("boxHeight",f,i,t,a),b=q("checkedFill",f,i,t,a),C=q("uncheckedFill",f,i,t,a),_=q("disableCheckedFill",f,i,t,a),w=q("disableUncheckedFill",f,i,t,a),y=q("circleFill",f,i,t,a),x=a.getCellValue(i,t),S=a.getCellOriginValue(i,t);let R,B,A=(h=x)!==null&&h!==void 0?h:"";kt(x)?(R=x.checked,B=x.disable,A=(d=x.text)!==null&&d!==void 0?d:""):typeof x=="boolean"&&(R=x,A=""),R=a.stateManager.syncCheckedState(i,t,l.field,R);const M=ui(i,t,a),k=a._getCellStyle(i,t),E=(u=k.autoWrapText)!==null&&u!==void 0?u:a.internalProps.autoWrapText,{lineClamp:T}=k,{checked:P,disable:H,uncheckedText:L,checkedText:F}=l;if(R==null||typeof R=="function"){const K=zt(P,{col:i,row:t,table:a,context:null,value:x,dataValue:S});R=a.stateManager.syncCheckedState(i,t,l.field,K)}const z=zt(H,{col:i,row:t,table:a,context:null,value:x,dataValue:S}),I=zt(F,{col:i,row:t,table:a,context:null,value:x,dataValue:S}),N=zt(L,{col:i,row:t,table:a,context:null,value:x,dataValue:S}),W=e==="auto",D=a.isAutoRowHeight(t),j={text:A.length===1?A[0]:A,maxLineWidth:W?1/0:n-(r[1]+r[3]+M)-2*p-g,textAlign:"left",textBaseline:"top",autoWrapText:E,lineClamp:T,wordBreak:"break-word",heightLimit:D?-1:o-Math.floor(r[0]+r[2]),pickable:!1,dx:M,whiteSpace:A.length!==1||E?"normal":"no-wrap",checkedText:I,uncheckedText:N},V={x:0,y:0,text:s.text?Object.assign({},s.text,j):j,circle:{radius:p},box:{width:v,height:m},spaceBetweenTextAndCircle:g,disabled:(c=B??z)!==null&&c!==void 0&&c};V.checked=R,C&&(V.box.uncheckedFill=C),w&&(V.box.disableUncheckedFill=w),b&&(V.box.checkedFill=b),_&&(V.box.disableCheckedFill=_),y&&(V.circle.fill=y);const X=new Us(V);return X.name="switch",X}const In=new HI,On=new Vr;function D3(i,t,e,n,o,r,s,l,a,h,d,u){var c,f,g,p,v,m,b,C,_,w,y,x,S,R,B,A,M,k,E,T,P,H,L,F;if(!i){const I=rn(o,r,d,h);u&&(i=h.scenegraph.highPerformanceGetCell(o,r,!0))&&i.role==="cell"&&i.setAttributes({x:e,y:n,width:s,height:l,lineWidth:(f=(c=d==null?void 0:d.group)===null||c===void 0?void 0:c.lineWidth)!==null&&f!==void 0?f:void 0,fill:(p=(g=d==null?void 0:d.group)===null||g===void 0?void 0:g.fill)!==null&&p!==void 0?p:void 0,stroke:(m=(v=d==null?void 0:d.group)===null||v===void 0?void 0:v.stroke)!==null&&m!==void 0?m:void 0,strokeArrayWidth:I,strokeArrayColor:(C=(b=d==null?void 0:d.group)===null||b===void 0?void 0:b.strokeArrayColor)!==null&&C!==void 0?C:void 0,cursor:(w=(_=d==null?void 0:d.group)===null||_===void 0?void 0:_.cursor)!==null&&w!==void 0?w:void 0,lineDash:(x=(y=d==null?void 0:d.group)===null||y===void 0?void 0:y.lineDash)!==null&&x!==void 0?x:void 0,lineCap:"butt",clip:!0,cornerRadius:d.group.cornerRadius}),i&&i.role==="cell"||((i=new Tt({x:e,y:n,width:s,height:l,lineWidth:(R=(S=d==null?void 0:d.group)===null||S===void 0?void 0:S.lineWidth)!==null&&R!==void 0?R:void 0,fill:(A=(B=d==null?void 0:d.group)===null||B===void 0?void 0:B.fill)!==null&&A!==void 0?A:void 0,stroke:(k=(M=d==null?void 0:d.group)===null||M===void 0?void 0:M.stroke)!==null&&k!==void 0?k:void 0,strokeArrayWidth:I,strokeArrayColor:(T=(E=d==null?void 0:d.group)===null||E===void 0?void 0:E.strokeArrayColor)!==null&&T!==void 0?T:void 0,cursor:(H=(P=d==null?void 0:d.group)===null||P===void 0?void 0:P.cursor)!==null&&H!==void 0?H:void 0,lineDash:(F=(L=d==null?void 0:d.group)===null||L===void 0?void 0:L.lineDash)!==null&&F!==void 0?F:void 0,lineCap:"butt",clip:!0,cornerRadius:d.group.cornerRadius})).role="cell",i.col=o,i.row=r,t==null||t.addCellGroup(i))}const z=W3(o,r,s,l,a,h);return z&&i.appendChild(z),i}function W3(i,t,e,n,o,r){let s,l;const a=r.internalProps.layoutMap.getBody(i,t).sparklineSpec,h=r.getCellValue(i,t);if(!Array.isArray(h))return;const d=o[3],u=o[0];e-=o[1]+o[3];const c=n-=o[0]+o[2];if(typeof a=="function"){const C={col:i,row:t,dataValue:r.getCellOriginValue(i,t)||"",value:r.getCellValue(i,t)||"",rect:r.getCellRangeRelativeRect(r.getCellRange(i,t)),table:r};s=a(C),l=Pb(s,d,u,e,n)}else s=a,l=Pb(a,d,u,e,n);const f=[],g=[];let p,v;if(typeof s.xField=="object")In.domain(s.xField.domain),p=s.xField.field;else if(typeof s.xField=="string"){const C=h.map(_=>_[s.xField]);In.domain(C),p=s.xField}else Array.isArray(h)&&(In.domain(Array.from({length:h.length},(C,_)=>_)),p=s.xField);if(In.range([0,e]),typeof s.yField=="object")On.domain(s.yField.domain),v=s.yField.field;else if(typeof s.yField=="string"){const C=Hb(h,s.yField);On.domain([Math.min(...C),Math.max(...C)]),v=s.yField}else if(Array.isArray(h)){const C=Hb(h);On.domain([Math.min(...C),Math.max(...C)]),v=s.yField}if(On.range([0,n]),typeof s.xField=="object"&&Array.isArray(s.xField.domain)){const C=h.map(w=>w[s.xField.field]),_=s.xField.domain;for(let w=0;w<_.length;w++){let y=!1;for(let x=0;x<C.length;x++)if(_[w]===C[x]){const S=h[x];if(!O(S[p])||!O(S[v]))break;f.push({x:0+In.scale(S[p]),y:c-On.scale(S[v]),defined:O(S[v])}),g.push(S),y=!0;break}y||(f.push({x:0+In.scale(_[w]),y:0,defined:!1}),g.push({[p]:_[w],[v]:null}))}}else for(let C=0;C<h.length;C++){const _=h[C];f.push({x:0+In.scale(p?_[p]:C),y:c-On.scale(v?_[v]:_),defined:O(v?_[v]:_),rawData:_}),g.push(_)}const m=l.getChildByName("sparkline-line");m&&m.setAttribute("points",f),m.bandwidth=In.step(),m.min=On.range()[0],m.max=On.range()[1];const b=l.getChildByName("sparkline-symbol-group");if(b){const C=s.pointShowRule==="isolatedPoint";if(s.pointShowRule==="all")for(let _=0;_<f.length;_++){const{x:w,y,defined:x}=f[_];if(x){const S=zs({x:w,y});b.appendChild(S)}}else if(C)for(let _=0;_<f.length;_++){const{x:w,y,defined:x}=f[_];if(x&&(!f[_-1]||!f[_-1].defined)&&(!f[_+1]||!f[_+1].defined)){const S=zs({x:w,y});b.appendChild(S)}}}return l}function Pb(i,t,e,n,o){var r,s,l,a,h,d,u,c,f,g,p,v,m,b,C,_,w,y,x,S,R,B;let A;A=typeof i=="function"?i(null):i;const M=new Tt({x:t,y:e,width:n,height:o,stroke:!1,fill:!1});if(M.name="sparkline",A.type==="line"){const k=hi({x:0,y:0,curveType:A.smooth?"monotoneX":"linear",stroke:(l=(s=(r=A.line)===null||r===void 0?void 0:r.style)===null||s===void 0?void 0:s.stroke)!==null&&l!==void 0?l:"blue",lineWidth:(d=(h=(a=A.line)===null||a===void 0?void 0:a.style)===null||h===void 0?void 0:h.strokeWidth)!==null&&d!==void 0?d:2});k.name="sparkline-line",M.addChild(k),A.crosshair&&(k.hover=(c=(u=A.crosshair)===null||u===void 0?void 0:u.style)!==null&&c!==void 0?c:{stroke:"#000",interpolate:"linear"});const E=new Tt({x:0,y:0,width:n,height:o,stroke:!1,fill:!1});E.name="sparkline-symbol-group",E.setTheme({symbol:{stroke:(p=(g=(f=A.point)===null||f===void 0?void 0:f.style)===null||g===void 0?void 0:g.stroke)!==null&&p!==void 0?p:"#000",lineWidth:(b=(m=(v=A.point)===null||v===void 0?void 0:v.style)===null||m===void 0?void 0:m.strokeWidth)!==null&&b!==void 0?b:1,fill:(w=(_=(C=A.point)===null||C===void 0?void 0:C.style)===null||_===void 0?void 0:_.fill)!==null&&w!==void 0?w:"#000",size:2*((S=(x=(y=A.point)===null||y===void 0?void 0:y.style)===null||x===void 0?void 0:x.size)!==null&&S!==void 0?S:3),symbolType:"circle"}}),M.addChild(E),E.hover=(B=(R=A.point)===null||R===void 0?void 0:R.hover)!==null&&B!==void 0&&B}return M}function Hb(i,t){const e=[];for(let n=0;n<i.length;n++){const o=i[n];O(t)&&O(o[t])?e.push(o[t]):!O(t)&&O(o)&&e.push(o)}return e}const wu=Ni();function N3(i,t,e,n,o,r,s,l,a,h,d,u,c,f,g,p,v){var m,b,C,_,w,y,x,S,R,B,A,M,k,E,T,P,H,L,F,z,I,N,W,D,j,V,X,K,J,ot;const lt=f._getCellStyle(n,o),ct=Rd("padding",lt,n,o,f);!((m=f.options.customConfig)===null||m===void 0)&&m.imageMargin?h=xt((b=f.options.customConfig)===null||b===void 0?void 0:b.imageMargin):O(ct)&&(h=ct),!((C=g==null?void 0:g.text)===null||C===void 0)&&C.textAlign&&(d=(_=g==null?void 0:g.text)===null||_===void 0?void 0:_.textAlign),!((w=g==null?void 0:g.text)===null||w===void 0)&&w.textBaseline&&(u=(y=g==null?void 0:g.text)===null||y===void 0?void 0:y.textBaseline);const it=rn(n,o,g,f);let nt,ht;if(v&&(nt=f.scenegraph.highPerformanceGetCell(n,o,!0),nt&&nt.role==="cell"&&nt.setAttributes({x:t,y:e,width:r,height:s,lineWidth:(S=(x=g==null?void 0:g.group)===null||x===void 0?void 0:x.lineWidth)!==null&&S!==void 0?S:void 0,fill:(B=(R=g==null?void 0:g.group)===null||R===void 0?void 0:R.fill)!==null&&B!==void 0?B:void 0,stroke:(M=(A=g==null?void 0:g.group)===null||A===void 0?void 0:A.stroke)!==null&&M!==void 0?M:void 0,strokeArrayWidth:it,strokeArrayColor:(E=(k=g==null?void 0:g.group)===null||k===void 0?void 0:k.strokeArrayColor)!==null&&E!==void 0?E:void 0,cursor:(P=(T=g==null?void 0:g.group)===null||T===void 0?void 0:T.cursor)!==null&&P!==void 0?P:void 0,lineDash:(L=(H=g==null?void 0:g.group)===null||H===void 0?void 0:H.lineDash)!==null&&L!==void 0?L:void 0,lineCap:"butt",clip:!0,cornerRadius:g.group.cornerRadius})),nt&&nt.role==="cell"||(nt=new Tt({x:t,y:e,width:r,height:s,lineWidth:(z=(F=g==null?void 0:g.group)===null||F===void 0?void 0:F.lineWidth)!==null&&z!==void 0?z:void 0,fill:(N=(I=g==null?void 0:g.group)===null||I===void 0?void 0:I.fill)!==null&&N!==void 0?N:void 0,stroke:(D=(W=g==null?void 0:g.group)===null||W===void 0?void 0:W.stroke)!==null&&D!==void 0?D:void 0,strokeArrayWidth:it,strokeArrayColor:(V=(j=g==null?void 0:g.group)===null||j===void 0?void 0:j.strokeArrayColor)!==null&&V!==void 0?V:void 0,cursor:(K=(X=g==null?void 0:g.group)===null||X===void 0?void 0:X.cursor)!==null&&K!==void 0?K:void 0,lineDash:(ot=(J=g==null?void 0:g.group)===null||J===void 0?void 0:J.lineDash)!==null&&ot!==void 0?ot:void 0,lineCap:"butt",clip:!0,cornerRadius:g.group.cornerRadius}),nt.role="cell",nt.col=n,nt.row=o,i==null||i.addCellGroup(nt)),c){let at=n,dt=o;p&&(at=p.start.col,dt=p.start.row),ht=f.getCellIcons(at,dt)}let $=0,Y=0;if(Array.isArray(ht)&&ht.length!==0){const{leftIconWidth:at,rightIconWidth:dt,absoluteRightIconWidth:ne}=Dr(ht,nt,p,f);$=at,Y=dt,nt.forEachChildren(gt=>{gt.role==="icon-left"?gt.setAttribute("x",gt.attribute.x+h[3]):gt.role==="icon-right"?gt.setAttribute("x",gt.attribute.x+r-dt-h[1]):gt.role==="icon-absolute-right"&&gt.setAttribute("x",gt.attribute.x+r-ne-h[1])}),nt.forEachChildren(gt=>{u==="middle"?gt.setAttribute("y",(s-gt.AABBBounds.height())/2):u==="bottom"?gt.setAttribute("y",s-gt.AABBBounds.height()-h[2]):gt.setAttribute("y",h[0])}),nt._cellLeftIconWidth=$,nt._cellRightIconWidth=Y}const _t=f.getCellValue(n,o),et=document.createElement("video");et.addEventListener("loadeddata",()=>{a&&ow(n,o,et.videoWidth,et.videoHeight,f.scenegraph,h,nt);const{width:at,height:dt,isMerge:ne}=kr(nt,f);if(l){const{width:ml,height:Gr}=xd(et.videoWidth,et.videoHeight,at-h[1]-h[3],dt-h[0]-h[2]),bl=Zg(0,0,at,dt,ml,Gr,d,u,h);tt.setAttributes({width:ml,height:Gr,x:bl.x,y:bl.y,dx:0})}else tt.setAttributes({x:h[3],y:h[0],width:at-h[1]-h[3],height:dt-h[2]-h[0],dy:0});ne&&Jg(nt.mergeStartCol,nt.mergeEndCol,nt.mergeStartRow,nt.mergeEndRow,f);const{width:gt,height:pe}=kr(nt,f),De=Math.floor(Math.min(gt-h[1]-h[3],pe-h[2]-h[0])/2),kn=0+(gt>tt.attribute.width?tt.attribute.x-0+tt.attribute.width/2:gt/2),oe=0+(pe>tt.attribute.height?tt.attribute.y-0+tt.attribute.height/2:pe/2),vl=new Fo({x:kn-De/2,y:oe-De/2,width:De,height:De,image:wu.play.svg,cursor:wu.play.cursor});vl.name="play-icon",nt.appendChild(vl),f.scenegraph.updateNextFrame()}),et.onerror=()=>{tt.image=wu.damage_pic.svg},et.src=_t,et.setAttribute("preload","auto");const tt=ad({x:h[3],y:h[0],width:r-h[1]-h[3],height:s-h[2]-h[0],image:et,cursor:"pointer"});return tt.name="image",tt.keepAspectRatio=l,tt.textAlign=d,tt.textBaseline=u,nt.appendChild(tt),nt}function V3(i,t,e,n,o,r,s,l,a,h,d,u,c,f,g,p,v,m,b){var C,_,w,y,x,S,R,B,A,M,k,E,T,P,H,L,F,z,I,N,W,D,j,V,X,K,J,ot,lt,ct,it,nt;const ht=i._getCellStyle(r,s),$=Rd("padding",ht,r,s,i);O($)&&(d=$),!((C=v==null?void 0:v.text)===null||C===void 0)&&C.textAlign&&(u=(_=v==null?void 0:v.text)===null||_===void 0?void 0:_.textAlign),!((w=v==null?void 0:v.text)===null||w===void 0)&&w.textBaseline&&(c=(y=v==null?void 0:v.text)===null||y===void 0?void 0:y.textBaseline);const Y=i.isAutoRowHeight(s),_t=l==="auto",et=(x=ht.autoWrapText)!==null&&x!==void 0?x:i.internalProps.autoWrapText,tt=ht.lineClamp,at=rn(r,s,v,i);let dt;if(b&&(dt=i.scenegraph.getCell(r,s,!0),dt&&dt.role==="cell"&&dt.setAttributes({x:n,y:o,width:a,height:h,lineWidth:(R=(S=v==null?void 0:v.group)===null||S===void 0?void 0:S.lineWidth)!==null&&R!==void 0?R:void 0,fill:(A=(B=v==null?void 0:v.group)===null||B===void 0?void 0:B.fill)!==null&&A!==void 0?A:void 0,stroke:(k=(M=v==null?void 0:v.group)===null||M===void 0?void 0:M.stroke)!==null&&k!==void 0?k:void 0,strokeArrayWidth:at??void 0,strokeArrayColor:(T=(E=v==null?void 0:v.group)===null||E===void 0?void 0:E.strokeArrayColor)!==null&&T!==void 0?T:void 0,cursor:(H=(P=v==null?void 0:v.group)===null||P===void 0?void 0:P.cursor)!==null&&H!==void 0?H:void 0,lineDash:(F=(L=v==null?void 0:v.group)===null||L===void 0?void 0:L.lineDash)!==null&&F!==void 0?F:void 0,lineCap:"butt",clip:!0,cornerRadius:v.group.cornerRadius})),dt&&dt.role==="cell"||(dt=new Tt({x:n,y:o,width:a,height:h,lineWidth:(I=(z=v==null?void 0:v.group)===null||z===void 0?void 0:z.lineWidth)!==null&&I!==void 0?I:void 0,fill:(W=(N=v==null?void 0:v.group)===null||N===void 0?void 0:N.fill)!==null&&W!==void 0?W:void 0,stroke:(j=(D=v==null?void 0:v.group)===null||D===void 0?void 0:D.stroke)!==null&&j!==void 0?j:void 0,strokeArrayWidth:at??void 0,strokeArrayColor:(X=(V=v==null?void 0:v.group)===null||V===void 0?void 0:V.strokeArrayColor)!==null&&X!==void 0?X:void 0,cursor:(J=(K=v==null?void 0:v.group)===null||K===void 0?void 0:K.cursor)!==null&&J!==void 0?J:void 0,lineDash:(lt=(ot=v==null?void 0:v.group)===null||ot===void 0?void 0:ot.lineDash)!==null&&lt!==void 0?lt:void 0,lineCap:"butt",clip:!0,cornerRadius:v.group.cornerRadius}),dt.role="cell",dt.col=r,dt.row=s,e==null||e.addCellGroup(dt)),g&&dt.appendChild(g),p){const ne=t;let gt;if(f){let pe=r,De=s;m&&(pe=m.start.col,De=m.start.row),gt=i.getCellIcons(pe,De)}if(nk(dt,gt,ne,d,_t,Y,et,typeof tt=="number"?tt:void 0,dt.attribute.width,dt.attribute.height,u,c,i,v,m),(ct=v==null?void 0:v._vtable)===null||ct===void 0?void 0:ct.marked){const pe=Og({x:dt.attribute.width,y:0,startAngle:Math.PI/2,endAngle:Math.PI,outerRadius:6,fill:"#3073F2",pickable:!1});pe.name="mark",dt.appendChild(pe)}}return g&&dt.setAttributes({width:Math.max(dt.attribute.width,(it=g.attribute.width)!==null&&it!==void 0?it:0),height:Math.max(dt.attribute.height,(nt=g.attribute.height)!==null&&nt!==void 0?nt:0)}),dt}function G3(i,t,e,n,o,r,s,l,a,h){var d,u,c,f,g;if(i.dependField){const ot=zt(i.dependField,{col:r,row:s,table:a,value:n,dataValue:o,cellHeaderPaths:void 0});o=(u=(d=a.getCellOriginRecord(r,s))===null||d===void 0?void 0:d[ot])!==null&&u!==void 0?u:o}const p=(c=zt(i.barType,{col:r,row:s,table:a,value:n,dataValue:o,cellHeaderPaths:void 0}))!==null&&c!==void 0?c:"default",v=(f=zt(i.min,{col:r,row:s,table:a,value:n,dataValue:o,cellHeaderPaths:void 0}))!==null&&f!==void 0?f:0,m=(g=zt(i.max,{col:r,row:s,table:a,value:n,dataValue:o,cellHeaderPaths:void 0}))!==null&&g!==void 0?g:v+100;let b=0;b=h?a.getRowsHeight(h.start.row,h.end.row):a.getRowHeight(s);let C=e,_=b,w=0;Z(a.theme._contentOffset)&&(w=a.theme._contentOffset);const y=new Tt({x:-w,y:-w,width:C,height:_});y.name="progress-bar";const{showBar:x,barColor:S,barBgColor:R,barPositiveColor:B,barNegativeColor:A,barAxisColor:M,barRightToLeft:k,showBarMark:E,barMarkPositiveColor:T,barMarkNegativeColor:P,barMarkWidth:H,barMarkPosition:L}=t;let{barHeight:F,barBottom:z,barPadding:I}=t;I.length===1?I=[I[0],I[0],I[0],I[0]]:I.length===2?I=[I[0],I[1],I[0],I[1]]:I.length===3&&(I=[I[0],I[1],I[2],I[1]]),I=I.map((ot,lt)=>{if(typeof ot=="string"&&Ol.endsWith(ot,"%")){const ct=Number(ot.substr(0,ot.length-1));return lt===0||lt===2?b*ct/100:e*ct/100}return Number(ot)});const N=xt(q("borderLineWidth",t,r,s,a)),W=Math.max(I[0],Math.ceil(N[0]/2)),D=Math.max(I[1],Math.floor(N[1]/2)),j=Math.max(I[2],Math.floor(N[2]/2)),V=Math.max(I[3],Math.ceil(N[3]/2));C-=D+V,_-=j+W,s===a.rowCount-1&&[0,"0"].includes(z)&&(_-=1);const X=W,K=V,J=C;if(typeof F=="string"&&Ol.endsWith(F,"%")?(F=Number(F.substr(0,F.length-1)),F=_*F/100):F=Number(F),typeof z=="string"&&Ol.endsWith(z,"%")?(z=Number(z.substr(0,z.length-1)),z=_*z/100):z=Number(z),zt(x,{col:r,row:s,table:a,context:null,value:n,dataValue:o})){let ot=`${o}`;Ol.endsWith(ot,"%")&&(ot=ot.substr(0,ot.length-1));const lt=Number(ot);if(isNaN(lt))return y;if((p??"default")==="default"){const ct=lt<v?0:lt>m?1:(lt-v)/(m-v),it=C,nt=X+_-F-z;let ht=Math.min(it*ct,it);const $=k?K+J-ht:K;r!==a.colCount-1||ct!==1||k||(ht-=1);const Y=zt(R,{col:r,row:s,table:a,context:null,value:n,dataValue:o,percentile:ct});if(Y){const tt=qt({x:$,y:nt,width:it,height:F,fill:Y});y.addChild(tt)}const _t=zt(S,{col:r,row:s,table:a,context:null,value:n,dataValue:o,percentile:ct})||"#20a8d8",et=qt({x:$,y:nt,width:ht,height:F,fill:_t});y.addChild(et)}else if(p==="negative"){const ct=v<0?-v:0,it=m>0?m:0,nt=ct/(ct+it),ht=1-nt,$=lt>0?lt/it:0,Y=lt<0?-lt/ct:0,_t=C,et=X+_-F-z,tt=K,at=zt(R,{col:r,row:s,table:a,context:null,value:n,dataValue:o,percentile:$});if(at){const Td=qt({x:tt,y:et,width:_t,height:F,fill:at});y.addChild(Td)}const dt=k?ht*_t:nt*_t,ne=Math.min(_t*nt*Y,_t),gt=k?{left:tt+dt,top:et,width:ne,height:F}:{left:tt+dt-ne,top:et,width:ne,height:F},pe=zt(A,{col:r,row:s,table:a,context:null,value:n,dataValue:o,percentile:Y})||"#20a8d8",De=qt({x:gt.left,y:gt.top,width:gt.width,height:gt.height,fill:pe});y.addChild(De);let kn=Math.min(_t*ht*$,_t);r!==a.colCount-1||$!==1||k||(kn-=1);const oe=k?{left:tt+dt-kn,top:et,width:kn,height:F}:{left:tt+dt,top:et,width:kn,height:F},vl=zt(B,{col:r,row:s,table:a,context:null,value:n,dataValue:o,percentile:$})||"#20a8d8",ml=qt({x:oe.left,y:oe.top,width:oe.width,height:oe.height,fill:vl});y.addChild(ml);const Gr=k?gt.left:oe.left,bl=zt(M,{col:r,row:s,table:a,context:null,value:n,dataValue:o,percentile:$}),gy=hi({x:0,y:0,stroke:bl,lineWidth:1,lineDash:[2,2],points:[{x:Gr,y:0},{x:Gr,y:b}]});if(y.addChild(gy),E&&($||Y)){const Td=H,sn=[];let Pd;if($>0)if(Pd=zt(T,{col:r,row:s,table:a,context:null,value:n,dataValue:o,percentile:$})||"#20a8d8",L==="right"){const jr=k?oe.left+H/2:oe.left+oe.width-H/2;sn.push({x:jr,y:oe.top}),sn.push({x:jr,y:oe.top+oe.height})}else L==="bottom"&&(sn.push({x:oe.left,y:oe.top+oe.height-H/2}),sn.push({x:oe.left+oe.width,y:oe.top+oe.height-H/2}));else if(Y>0)if(Pd=zt(P,{col:r,row:s,table:a,context:null,value:n,dataValue:o,percentile:Y})||"#20a8d8",L==="right"){const jr=k?gt.left+gt.width-H/2:gt.left+H/2;sn.push({x:jr,y:gt.top}),sn.push({x:jr,y:gt.top+gt.height})}else L==="bottom"&&(sn.push({x:gt.left,y:gt.top+gt.height-H/2}),sn.push({x:gt.left+gt.width,y:gt.top+gt.height-H/2}));const fy=hi({x:0,y:0,stroke:Pd,lineWidth:Td,points:sn});y.addChild(fy)}}else if(p==="negative_no_axis"){const ct=v<0?-v:0,it=m>0?m:0,nt=Math.max(ct,it),ht=nt===0?0:Math.abs(lt)/nt,$=C;let Y=Math.min($*ht,$);r!==a.colCount-1||ht!==1||k||(Y-=1);const _t=X+_-F-z,et=k?K+J-Y:K,tt=zt(R,{col:r,row:s,table:a,context:null,value:n,dataValue:o,percentile:ht});if(tt){const gt=qt({x:et,y:_t,width:$,height:F,fill:tt});y.addChild(gt)}const at={left:et,top:_t,width:Y,height:F};let dt;dt=lt>=0?zt(B,{col:r,row:s,table:a,context:null,value:n,percentile:ht,dataValue:o})||"#20a8d8":zt(A,{col:r,row:s,table:a,context:null,value:n,dataValue:o,percentile:ht})||"#20a8d8";const ne=qt({x:at.left,y:at.top,width:at.width,height:at.height,fill:dt});if(y.addChild(ne),E&&lt){const gt=H,pe=[];let De;if(De=lt>=0?zt(T,{col:r,row:s,table:a,context:null,value:n,dataValue:o,percentile:ht})||"#20a8d8":zt(P,{col:r,row:s,table:a,context:null,value:n,dataValue:o,percentile:ht})||"#20a8d8",L==="right"){const oe=k?at.left+H/2:at.left+at.width-H/2;pe.push({x:oe,y:at.top}),pe.push({x:oe,y:at.top+at.height})}else L==="bottom"&&(pe.push({x:at.left,y:at.top+at.height-H/2}),pe.push({x:at.left+at.width,y:at.top+at.height-H/2}));const kn=hi({x:0,y:0,stroke:De,lineWidth:gt,points:pe});y.addChild(kn)}}}return y}function j3(i,t,e,n,o,r){var s,l,a,h,d,u,c,f,g,p,v,m,b,C,_,w;if(e!=null&&e.zero&&(i=Math.min(i,0),t=Math.max(t,0)),e==null?void 0:e.expand){const S=i,R=t;O(e.expand.min)&&(i=S-(R-S)*e.expand.min),O(e.expand.max)&&(t=R+(R-S)*e.expand.max)}let y,x;if(Z(e==null?void 0:e.min)&&(i=e.min),Z(e==null?void 0:e.max)&&(t=e.max),(e==null?void 0:e.type)==="log"?(y=new gl,y.base((s=e==null?void 0:e.base)!==null&&s!==void 0?s:10)):(e==null?void 0:e.type)==="symlog"?(y=new fl,y.constant((l=e==null?void 0:e.constant)!==null&&l!==void 0?l:10)):y=new Vr,y.domain([i,t],!!(e!=null&&e.nice)),r)U3(y,r);else if(e!=null&&e.nice){let S=(u=(h=(a=e.tick)===null||a===void 0?void 0:a.forceTickCount)!==null&&h!==void 0?h:(d=e.tick)===null||d===void 0?void 0:d.tickCount)!==null&&u!==void 0?u:10;Mt(S)&&(S=S({axisLength:o,labelStyle:(f=(c=e==null?void 0:e.label)===null||c===void 0?void 0:c.style)!==null&&f!==void 0?f:{fontSize:fs.LABEL_FONT_SIZE}})),e.niceType==="accurateFirst"&&(S=Math.max(10,S)),Pt(e.min)&&Pt(e.max)?y.nice(S):O(e.min)&&Pt(e.max)?y.niceMax(S):Pt(e.min)&&O(e.max)&&y.niceMin(S)}return delete y._niceType,x=((p=(g=r==null?void 0:r.targetTicks)===null||g===void 0?void 0:g.length)!==null&&p!==void 0?p:!((v=e==null?void 0:e.tick)===null||v===void 0)&&v.forceTickCount)?y.forceTicks((b=(m=r==null?void 0:r.targetTicks)===null||m===void 0?void 0:m.length)!==null&&b!==void 0?b:(C=e==null?void 0:e.tick)===null||C===void 0?void 0:C.forceTickCount):y.ticks(Z((_=e==null?void 0:e.tick)===null||_===void 0?void 0:_.tickCount)?e.tick.tickCount:5,{noDecimals:(w=e==null?void 0:e.tick)===null||w===void 0?void 0:w.noDecimals}),{range:y.domain(),ticks:x}}function U3(i,t){i.niceMax(t.targetTicks.length)}function $3(i,t,e,n,o,r,s,l,a,h,d,u,c,f,g,p,v,m){var b,C,_,w,y,x,S,R,B,A,M,k,E,T,P,H,L,F,z,I,N,W,D,j;if(!i){const ot=rn(o,r,g,f);m&&(i=f.scenegraph.highPerformanceGetCell(o,r,!0))&&i.role==="cell"&&i.setAttributes({x:e,y:n,width:l,height:a,lineWidth:(C=(b=g==null?void 0:g.group)===null||b===void 0?void 0:b.lineWidth)!==null&&C!==void 0?C:void 0,fill:(w=(_=g==null?void 0:g.group)===null||_===void 0?void 0:_.fill)!==null&&w!==void 0?w:void 0,stroke:(x=(y=g==null?void 0:g.group)===null||y===void 0?void 0:y.stroke)!==null&&x!==void 0?x:void 0,strokeArrayWidth:ot,strokeArrayColor:(R=(S=g==null?void 0:g.group)===null||S===void 0?void 0:S.strokeArrayColor)!==null&&R!==void 0?R:void 0,cursor:(A=(B=g==null?void 0:g.group)===null||B===void 0?void 0:B.cursor)!==null&&A!==void 0?A:void 0,lineDash:(k=(M=g==null?void 0:g.group)===null||M===void 0?void 0:M.lineDash)!==null&&k!==void 0?k:void 0,lineCap:"butt",clip:!0,cornerRadius:g.group.cornerRadius}),i&&i.role==="cell"||((i=new Tt({x:e,y:n,width:l,height:a,lineWidth:(T=(E=g==null?void 0:g.group)===null||E===void 0?void 0:E.lineWidth)!==null&&T!==void 0?T:void 0,fill:(H=(P=g==null?void 0:g.group)===null||P===void 0?void 0:P.fill)!==null&&H!==void 0?H:void 0,stroke:(F=(L=g==null?void 0:g.group)===null||L===void 0?void 0:L.stroke)!==null&&F!==void 0?F:void 0,strokeArrayWidth:ot,strokeArrayColor:(I=(z=g==null?void 0:g.group)===null||z===void 0?void 0:z.strokeArrayColor)!==null&&I!==void 0?I:void 0,cursor:(W=(N=g==null?void 0:g.group)===null||N===void 0?void 0:N.cursor)!==null&&W!==void 0?W:void 0,lineDash:(j=(D=g==null?void 0:g.group)===null||D===void 0?void 0:D.lineDash)!==null&&j!==void 0?j:void 0,lineCap:"butt",clip:!0,cornerRadius:g.group.cornerRadius})).role="cell",i.col=o,i.row=r,t==null||t.addCellGroup(i))}let V;if(c){let ot=o,lt=r;v&&(ot=v.start.col,lt=v.start.row),V=f.getCellIcons(ot,lt)}let X=0,K=0;if(Array.isArray(V)&&V.length!==0){const{leftIconWidth:ot,rightIconWidth:lt,absoluteRightIconWidth:ct}=Dr(V,i,v,f);X=ot+lt,K=ot,i.forEachChildren(it=>{it.role==="icon-left"?it.setAttribute("x",it.attribute.x+h[3]):it.role==="icon-right"?it.setAttribute("x",it.attribute.x+l-lt-h[1]):it.role==="icon-absolute-right"&&it.setAttribute("x",it.attribute.x+l-ct-h[1])}),i.forEachChildren(it=>{u==="middle"?it.setAttribute("y",(a-it.AABBBounds.height())/2):u==="bottom"?it.setAttribute("y",a-it.AABBBounds.height()-h[2]):it.setAttribute("y",h[0])})}const J=K3(o,r,s-X,l,a,h,g,p,f);return J&&i.appendChild(J),l-=h[1]+h[3]+X,a-=h[0]+h[2],d==="center"?J.setAttribute("x",h[3]+K+(l-J.AABBBounds.width())/2):d==="right"?J.setAttribute("x",h[3]+K+l-J.AABBBounds.width()):J.setAttribute("x",h[3]+K),u==="middle"?J.setAttribute("y",h[0]+(a-J.AABBBounds.height())/2):u==="bottom"?J.setAttribute("y",h[0]+a-J.AABBBounds.height()):J.setAttribute("y",h[0]),i}function K3(i,t,e,n,o,r,s,l,a){var h,d;const u=a._getCellStyle(i,t),c=q("buttonColor",u,i,t,a),f=q("buttonBorderColor",u,i,t,a),g=q("buttonLineWidth",u,i,t,a),p=q("buttonBorderRadius",u,i,t,a),v=q("buttonHoverColor",u,i,t,a),m=q("buttonHoverBorderColor",u,i,t,a),b=q("buttonPadding",u,i,t,a),C=q("buttonTextHoverColor",u,i,t,a),_=q("buttonDisableColor",u,i,t,a),w=q("buttonDisableBorderColor",u,i,t,a),y=q("buttonTextDisableColor",u,i,t,a),x=a.getCellValue(i,t),S=a.getCellOriginValue(i,t),R=ui(i,t,a),B=a._getCellStyle(i,t),A=(h=B.autoWrapText)!==null&&h!==void 0?h:a.internalProps.autoWrapText,{lineClamp:M}=B,k=e==="auto",E=a.isAutoRowHeight(t),{disable:T,text:P}=l,H=zt(T,{col:i,row:t,table:a,context:null,value:x,dataValue:S}),L=zt(P,{col:i,row:t,table:a,context:null,value:x,dataValue:S}),F=(d=L??x)!==null&&d!==void 0?d:"",z={maxLineWidth:k?1/0:n-(r[1]+r[3]+R),textAlign:"left",textBaseline:"top",autoWrapText:A,lineClamp:M,wordBreak:"break-word",heightLimit:E?-1:o-Math.floor(r[0]+r[2]),pickable:!1,dx:R,whiteSpace:F.length!==1||A?"normal":"no-wrap"},I=s.text?Object.assign({},s.text,z):z,N={x:0,y:0,cursor:H?"not-allowed":"pointer",disable:H,childrenPickable:!1,text:F.length===1?F[0]:F,textStyle:I,padding:b,panel:{visible:!0,fill:H?_:c,stroke:H?w:f,lineWidth:g,cornerRadius:p},state:{text:{},panel:{hover:{fill:v,stroke:m}}}};y&&(N.state.text.fill=y),C&&(N.state.text.hover.fill=C);const W=new ll(N);return W.name="button",H||(W.addEventListener("mouseenter",()=>{W.addState("hover",!0,!1),W.stage.renderNextFrame()}),W.addEventListener("mouseleave",()=>{W.removeState("hover",!1),W.stage.renderNextFrame()})),W}const Y3=()=>{ut.registerFunction("createChartCellGroup",P3),ut.registerFunction("getAxisDomainRangeAndLabels",j3)},X3=()=>{ut.registerFunction("createCheckboxCellGroup",H3)},q3=()=>{ut.registerFunction("createImageCellGroup",sk)},Z3=()=>{ut.registerFunction("createProgressBarCell",G3)},J3=()=>{ut.registerFunction("createRadioCellGroup",E3)},Q3=()=>{ut.registerFunction("createSwitchCellGroup",I3)},tO=()=>{ut.registerFunction("createButtonCellGroup",$3)},eO=()=>{ut.registerFunction("createSparkLineCellGroup",D3)},iO=()=>{ut.registerFunction("createTextCellGroup",V3)},nO=()=>{ut.registerFunction("createVideoCellGroup",N3)};b3(),C3(),_3(),w3(),y3(),S3(),B3(),hz(),Y3(),X3(),q3(),Z3(),J3(),Q3(),tO(),eO(),iO(),nO();class UO extends uI{}x_();export{vO as $,qz as A,Et as B,Ar as C,L_ as D,DO as E,xt as F,Gi as G,mt as H,ko as I,jF as J,UF as K,GC as L,ut as M,Zt as N,qP as O,Ds as P,ZP as Q,KP as R,Eo as S,xe as T,QP as U,t2 as V,JP as W,YP as X,fO as Y,XP as Z,gO as _,qt as a,pO as a0,e2 as a1,vz as a2,Bt as a3,bo as a4,kO as a5,EO as a6,Ym as a7,iI as a8,U as a9,AO as aA,Ik as aB,ll as aC,Pr as aD,Hr as aE,FO as aF,us as aa,Je as ab,Bi as ac,mz as ad,br as ae,yi as af,b2 as ag,b3 as ah,C3 as ai,_3 as aj,w3 as ak,y3 as al,S3 as am,Y3 as an,X3 as ao,q3 as ap,Z3 as aq,J3 as ar,eO as as,iO as at,nO as au,MO as av,LO as aw,xO as ax,lg as ay,BO as az,ec as b,hi as c,Ct as d,ki as e,nB as f,bt as g,UO as h,st as i,zO as j,H_ as k,Dl as l,TO as m,HO as n,PO as o,dg as p,WO as q,Zz as r,VO as s,CO as t,NO as u,Qt as v,jO as w,IO as x,GO as y,OO as z};
