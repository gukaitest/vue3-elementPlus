import{aq as H,t as _,v as c,y as m,r as z,J as i,P as u,A as B,K as v,f as L,D as p,F as j,al as P,bz as S,O as V,bA as M,E as R,an as F,g as O,cy as h,cz as W,bj as x,bC as $}from"./vue-vendor-DLKW-W3j.js";import{b as w,a as k}from"./business-Dnq1J6Fs.js";import{$ as a}from"./index-C1YnPq5G.js";import{e as A}from"./system-manage-FZM6wr1c.js";import{u as D}from"./table-DZiYh2Mz.js";const K={class:"inline-block",viewBox:"0 0 512 512",width:"1em",height:"1em"};function q(o,l){return c(),_("svg",K,l[0]||(l[0]=[m("path",{fill:"currentColor",d:"M453.547 273.449H372.12v-40.714h81.427zm0 23.264H372.12v40.714h81.427zm0-191.934H372.12v40.713h81.427zm0 63.978H372.12v40.713h81.427zm0 191.934H372.12v40.714h81.427zm56.242 80.264c-2.326 12.098-16.867 12.388-26.58 12.796H302.326v52.345h-36.119L0 459.566V52.492L267.778 5.904h34.548v46.355h174.66c9.83.407 20.648-.291 29.197 5.583c5.991 8.608 5.41 19.543 5.817 29.43l-.233 302.791c-.29 16.925 1.57 34.2-1.978 50.892m-296.51-91.256c-16.052-32.57-32.395-64.909-48.39-97.48c15.82-31.698 31.408-63.512 46.937-95.327c-13.203.64-26.406 1.454-39.55 2.385c-9.83 23.904-21.288 47.169-28.965 71.888c-7.154-23.323-16.634-45.774-25.3-68.515c-12.796.698-25.592 1.454-38.387 2.21c13.493 29.78 27.86 59.15 40.946 89.104c-15.413 29.081-29.837 58.57-44.785 87.825c12.737.523 25.475 1.047 38.212 1.221c9.074-23.148 20.357-45.424 28.267-69.038c7.096 25.359 19.135 48.798 29.023 73.051c14.017.99 27.976 1.862 41.993 2.676M484.26 79.882H302.326v24.897h46.53v40.713h-46.53v23.265h46.53v40.713h-46.53v23.265h46.53v40.714h-46.53v23.264h46.53v40.714h-46.53v23.264h46.53v40.714h-46.53v26.897H484.26z"},null,-1)]))}const J=H({name:"file-icons-microsoft-excel",render:q}),U={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"},I={class:"flex items-center justify-between"},Q={class:"h-[calc(100%-50px)]"};function y(o){return typeof o=="function"||Object.prototype.toString.call(o)==="[object Object]"&&!$(o)}const te=z({name:"plugin_excel",__name:"index",setup(o){const{columns:l,data:b,loading:E}=D({apiFn:A,apiParams:{current:1,size:999,status:void 0,userName:void 0,userGender:void 0,nickName:void 0,userPhone:void 0,userEmail:void 0},columns:()=>[{type:"selection",width:48},{prop:"index",label:a("common.index"),width:64},{prop:"userName",label:a("page.manage.user.userName"),minWidth:100},{prop:"userGender",label:a("page.manage.user.userGender"),width:100,formatter:e=>{if(e.userGender===void 0)return"";const n={1:"primary",2:"danger"},t=a(k[e.userGender]);return i(x,{type:n[e.userGender]},y(t)?t:{default:()=>[t]})}},{prop:"nickName",label:a("page.manage.user.nickName"),minWidth:100},{prop:"userPhone",label:a("page.manage.user.userPhone"),width:120},{prop:"userEmail",label:a("page.manage.user.userEmail"),minWidth:200},{prop:"status",label:a("page.manage.user.userStatus"),width:100,formatter:e=>{if(e.status===void 0)return"";const n={1:"success",2:"warning"},t=a(w[e.status]);return i(x,{type:n[e.status]},y(t)?t:{default:()=>[t]})}}]});function C(){const e=l.value.slice(2),n=b.value.map(s=>e.map(f=>G(f,s))),t=e.map(s=>T(s)&&s.label||void 0);n.unshift(t);const r=h.book_new(),d=h.aoa_to_sheet(n);d["!cols"]=e.map(s=>({width:Math.round(Number(s.width)/10||20)})),h.book_append_sheet(r,d,"用户列表"),W(r,"用户数据.xlsx")}function G(e,n){if(!N(e))return"";const{prop:t}=e;return t==="operate"||t===void 0?"":t==="userRoles"?n.userRoles.map(r=>r).join(","):t==="status"?n.status&&a(w[n.status])||void 0:t==="userGender"?n.userGender&&a(k[n.userGender])||void 0:t in n?n[t]:""}function N(e){return!!e.prop}function T(e){return!!e.label}return(e,n)=>{const t=J,r=S,d=L,s=O,f=M;return c(),_("div",U,[i(s,{class:"sm:flex-1-hidden card-wrapper"},{header:u(()=>[m("div",I,[n[1]||(n[1]=m("p",null,"Excel导出",-1)),i(p(R),{plain:"",type:"primary",onClick:C},{icon:u(()=>[i(t,{class:"text-icon"})]),default:u(()=>[n[0]||(n[0]=F(" 导出excel "))]),_:1})])]),default:u(()=>[m("div",Q,[B((c(),v(d,{height:"100%",border:"",class:"sm:h-full",data:p(b),"row-key":"id"},{default:u(()=>[(c(!0),_(j,null,P(p(l),g=>(c(),v(r,V({key:g.prop,ref_for:!0},g),null,16))),128))]),_:1},8,["data"])),[[f,p(E)]])])]),_:1})])}}});export{te as default};
